define("ControllerModule",["DataModule","ViewModule"],function(c,a){var b=function(){this._active=false;this._visible=false;this._view=a;this._model=c;this._canvas=null;this._name="ControllerModule";this._activeListeners=false;this.myMouseListener=function(){};this.myTouchListener=function(){};document.addEventListener("init",this.init)};b.prototype={init:function(d){this._canvas=window.gameObj.getCanvas()},set visible(d){this._visible=d;if(this._visible){window.DisplayList.registerView(this._view)}else{this.close()}},get visible(){return(this._visible)},close:function(d){this._visible=false;this.isActive=false;window.DisplayList.deleteView(this._view)},get isActive(){return(this._active)},set isActive(d){if(d&&this._model._loaded==undefined){this.setUpLoadListener();return}this._active=d;if(this._active){console.log("Module is active ---- Line 67 ControllerModule.js");if(!this._visible){this.visible=true}this.addListeners()}else{console.log(" --> is now inactive line 72 ControllerModule.js");this.removeListeners();this._view.eraseScreenElements()}},testListener:function(){console.log("TestListener called")},addListeners:function(){console.log("Adding Event Listeners");if(!this._activeListeners){this.myMouseListener=this.canvasListener.bind(this);this.myTouchListener=this.touch.bind(this);document.body.addEventListener("mousedown",this.myMouseListener,false);document.body.addEventListener("touchstart",this.myTouchListener,false);document.body.addEventListener("mouseup",this.myMouseListener,false);document.body.addEventListener("touchend",this.myTouchListener,false);this._activeListeners=true}},removeListeners:function(){console.log("Removing Event Listeners");document.body.removeEventListener("mousedown",this.myMouseListener,false);document.body.removeEventListener("touchstart",this.myTouchListener,false);document.body.removeEventListener("mouseup",this.myMouseListener,false);document.body.removeEventListener("touchend",this.myTouchListener,false);this._activeListeners=false},setUpLoadListener:function(){this.listenerInt=setInterval((function(){if(this._model._loaded){clearInterval(this.listenerInt);this.isActive=true}}).bind(this),1000)},touch:function(e){var d=this._canvas.getBoundingClientRect();var f=e.changedTouches[0];x=Math.round((f.pageX-d.left)/(d.right-d.left)*this._canvas.width);y=Math.round((f.pageY-d.top)/(d.bottom-d.top)*this._canvas.height);this._view.testHit(x,y,e)},canvasListener:function(e){var d=HUDCanvas.getBoundingClientRect();x=Math.round((e.clientX-d.left)/(d.right-d.left)*HUDCanvas.width);y=Math.round((e.clientY-d.top)/(d.bottom-d.top)*HUDCanvas.height);console.log("Going to test due to an event of type "+e.type+"  this is "+this._name);this._view.testHit(x,y,e)},draw:function(d){window.DisplayList.draw()}};console.log("ControllerModule loaded");return(b)});define("DataModule",function(){var a=function(){console.log("Instantiating DataModule");this._data="empty";this._controller=null;this._name="DataModule";this._loaded=false;this._status=null};a.prototype={loadData:function(c){this.callBack=c;var b=[];this.status=0;me=this;$.getJSON(this._retrievalURL,function(d){me.dataReturned(d)})},dataReturned:function(b){this._data=b;this._status=1;this.digestData()},digestData:function(){console.log("Digest Data called on Super Class DataModule")}};a.prototype.constructor=a;console.log("DataModule.js loaded");return(a)});define("ViewModule",[],function(){var b="1.1";var a=function(){this.controller;this._context;this.screenElements=[];this.buttons=[];this._displayNum,this._top=60;this._left=0;this.imgWidth=160;this.imgHeight=120;this.colMax=3;this.imagePadding=5;this.active=false;this._visible=false;this._yOffset=0;this._name="ViewModule";this._displayState="";this.testHit=this.testHitFunc;this._clickedButton=null;this._imagesNeedingLoaded=[]};a.prototype={eraseScreenElements:function(){console.log("--------- Erasing Screen Elements");this.screenElements=[];this.buttons=[]},init:function(){this._context=HUDctx;this._left=(HUDCanvas.width-this.bgWidth)/2},testHitFunc:function(c,f,d){var e=this;console.log("ViewModule testHitFunc");if(this.controller.isActive&&window.globalActive){this.buttons.forEach(function(g){if(f>g._y&&f<g._y+g._height&&c>g._x&&c<g._x+g._width){if(d.type=="mousedown"||d.type=="touchstart"){window._clickedButton=g._name}if(d.type=="mouseup"||d.type=="touchstart"){if(window._clickedButton==g._name){g.callBack(g.props)}}return}})}},loadView:function(){},draw:function(){console.log("Calling Draw on Superclass")},imageLoaded:function(c){console.log("IMG loaded [ "+c+"]  _name ["+c._name+"]");for(i=0;i<this._imagesNeedingLoaded.length;i++){if(this._imagesNeedingLoaded[i]._name==c._name){this._imagesNeedingLoaded.splice(i,1);console.log("Removing "+c._name+" from imagesNeedingLoaded array.  "+this._imagesNeedingLoaded.length+" left to load.");c.draw()}}}};window.trace("ViewModule Loaded  version "+b);return(a)});