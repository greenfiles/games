(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Common          		 = require("./Common");
var GameScreen      		 = require("./screens/GameScreen");
var EditorScreen    		 = require("./screens/EditorScreen");
var SplashScreen    		 = require("./screens/SplashScreen");
var DailyBonusScreen		 = require("./screens/DailyBonusScreen");
var IntroScreen     		 = require("./screens/IntroScreen");
var LevelSelectScreen     	 = require("./screens/LevelSelectScreen");
var CharacterSelectScreen    = require("./screens/CharacterSelectScreen");
var PauseOverlay    		 = require("./overlays/PauseOverlay");
var GameOverOverlay 		 = require("./overlays/GameOverOverlay");
var HelpOverlay 			 = require("./overlays/HelpOverlay");
var CodeOverlay 			 = require("./overlays/CodeOverlay");
var EndlessOverlay 			 = require("./overlays/EndlessOverlay");
var PowerupPurchaseOverlay 	 = require("./overlays/PowerupPurchaseOverlay");
var GenericPopupOverlay 	 = require("./overlays/GenericPopupOverlay");
var CharacterUnlockedOverlay = require("./overlays/CharacterUnlockedOverlay");
var RewardOverlay            = require("./overlays/RewardOverlay");
var EndGameOverlay           = require("./overlays/EndGameOverlay");
var PromoOverlay             = require("./overlays/PromoOverlay");
var InstructionsOverlay      = require("./overlays/InstructionsOverlay");
var ExitOverlay              = require("./overlays/ExitOverlay");
var Transition      		 = require("./lib/Transition");
var CutoutTransition         = require("./lib/CutoutTransition");
var SavedData       		 = require("./SavedData");
var Goals            		 = require("./Goals");

//===================================================
// CONSTRUCTOR
//===================================================

function Application()
{
	/**
	 * @type {AssetManager}
	 * @private
	 */
	this._assetManager = null;

	/**
	 * @type {ScreenManager}
	 * @private
	 */
	this._screenManager = null;

	/**
	 * @type {p3.Screen}
	 */
	this._currentScreen = null;

	/**
	 * @type {p3.Transition}
	 * @private
	 */
	this._transition = null;
}
module.exports = Application;

//===================================================
// PUBLIC METHODS
//===================================================

Application.prototype.init = function()
{
	console.log("APPLICATION INITIALIZED");

	this._assetManager = p3.AssetManager.instance;
	this._screenManager = Common.sceneManager;

	TweenMax.defaultOverwrite = "none";

	//Texture generation: black square
	if(Common.generatedTextures['blackSquare'] == undefined)
	{
		var gr = new PIXI.Graphics();
		gr.beginFill(0x000000);
		gr.drawRect(0, 0, 1, 1);
		Common.generatedTextures['blackSquare'] = gr.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);
	}

	//Texture generation: white square
	if(Common.generatedTextures['whiteSquare'] == undefined)
	{
		var gr = new PIXI.Graphics();
		gr.beginFill(0xffffff);
		gr.drawRect(0, 0, 1, 1);
		Common.generatedTextures['whiteSquare'] = gr.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);
	}

	Common.savedData = new SavedData();
	Common.savedData.init();

	Common.goalsManager = new Goals();
	Common.goalsManager.init();

	p3.Button.audio = p3.AudioManager.instance;

	if(!!window.og.mode && window.og.mode == "editor")
	{
		this.showEditor();
	}
	else if(Common.savedData.levelDebug != "")
	{
		if(Common.savedData.characterDebug != "")
		{
			Common.savedData.character = Common.savedData.characterDebug;
			Common.savedData.characterDebug = "";
		}

		this.showGame();
	}
	else if(Common.savedData.canAwardDailyBonus())
	{
		this.showDailyBonus();
	}
	else
	{
		// this.showDailyBonus();
		this.showSplash();
		// this.showLevelSelect();
		// this.showIntro();
		// this.showOutro();
		// this.showCharacterSelect();
		// this.showGame();
	}
};


/**
 * SPLASH
 */
Application.prototype.showSplash = function()
{
	var screen = new SplashScreen();
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{

	}, this);

	screen.signals.requestedNextScreen.addOnce(function(id)
	{
		if(id == 'story')
		{
			this.showLevelSelect();
		}
		else if(id == 'endless')
		{
			this.showCharacterSelect();
		}
		else if(id == 'tutorial')
		{
			this.showGame();
		}
		else if(id == 'intro')
		{
			this.showIntro();
		}
	}, this);

	screen.signals.GUIButtonClicked.add(function(id)
	{
        if(id == 'help')
        {
            this.showHelpOverlay("splash");
        }
		else if(id == 'endless')
        {
            this.showEndlessOverlay(true);
        }
		else if(id == 'endless_unlocked')
        {
            this.showEndlessOverlay(false);
        }
		else if(id == 'code')
        {
            this.showCodeOverlay();
        }
    }, this);

	screen.signals.linkClick.add(function(link, isDisneySite)
	{
		this.showExitOverlay(link, isDisneySite);
	}, this);

	this._currentScreen = screen;
};

/**
 * DAILY BONUS
 */
Application.prototype.showDailyBonus = function()
{
	var screen = new DailyBonusScreen();
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedNextScreen.addOnce(function()
	{
		this.showSplash();
	}, this);

	this._currentScreen = screen;
};

/**
 * LEVEL SELECT
 */
Application.prototype.showLevelSelect = function()
{
	var screen = new LevelSelectScreen();
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{
		this.showSplash();
	}, this);

	screen.signals.requestedNextScreen.addOnce(function(level)
	{
		this.showCharacterSelect(level);
	}, this);

	screen.signals.GUIButtonClicked.add(function(id)
	{
        if(id == 'help')
        {
            this.showHelpOverlay("levelSelect");
        }
		else if(id == 'reward')
        {
            this.showRewardOverlay();
        }
		else if(id == 'endgame')
        {
            this.showEndGameOverlay("endgame");
        }
		else if(id == 'promo')
        {
            this.showPromoOverlay();
        }
    }, this);

	this._currentScreen = screen;
};

/**
 * CHARACTER SELECT
 */
Application.prototype.showCharacterSelect = function(level)
{
	var screen = new CharacterSelectScreen(level);
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{
		if(!Common.savedData.endless)
			this.showLevelSelect();
		else
			this.showSplash();
	}, this);

	screen.signals.requestedNextScreen.addOnce(function()
	{
		this.showGame();
	}, this);

	screen.signals.buyPressed.add(function(prevScreen, cost)
	{
		this.showPowerupPurchase(prevScreen, cost);
	}, this);

	screen.signals.characterUnlocked.addOnce(function(character)
	{
		this.showUnlockedCharacter(character);
	}, this);


	screen.signals.GUIButtonClicked.add(function(id)
	{
        if(id == 'help')
        {
            this.showHelpOverlay("characterSelect");
        }
    }, this);

	this._currentScreen = screen;
};

	Application.prototype.showPowerupPurchase = function(prevScreen, cost)
	{
		var t = new Transition();
		t.replace = false;
		t.push = true;

		var screen = new PowerupPurchaseOverlay(prevScreen, cost);
		this._screenManager.add(screen, t);

		screen.signals.requestedPreviousScreen.addOnce(function(id)
		{
			this._screenManager.remove();
		}, this);
	};

	Application.prototype.showUnlockedCharacter = function(character)
	{
		var t = new Transition();
		t.replace = false;
		t.push = true;

		var screen = new CharacterUnlockedOverlay(character);
		this._screenManager.add(screen, t);

		screen.signals.requestedPreviousScreen.addOnce(function(id)
		{
			this._screenManager.remove();
		}, this);
	};

/**
 * INTRO
 */
Application.prototype.showIntro = function()
{
	Common.savedData.hasSeenIntro = true;
	Common.savedData.save();

	var screen = new IntroScreen("intro");
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{
	}, this);

	screen.signals.requestedNextScreen.addOnce(function()
	{
		this.showGame();
	}, this);

	this._currentScreen = screen;

	return screen;
};

/**
 * OUTRO
 */
Application.prototype.showOutro = function()
{
	Common.savedData.hasSeenOutro = true;
	Common.savedData.save();

	var screen = new IntroScreen("outro");
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{
	}, this);

	screen.signals.requestedNextScreen.addOnce(function()
	{
		this.showLevelSelect();
	}, this);

	this._currentScreen = screen;

	return screen;
};


/**
 * GAME
 */
Application.prototype.showGame = function()
{
	var screen = new GameScreen();
	this._screenManager.add(screen, this._getTransition());

	screen.signals.requestedPreviousScreen.addOnce(function()
	{
		screen.animateOut(this.showGame, this);
	}, this);

	screen.signals.requestedNextScreen.addOnce(function(level)
	{
		this.showGameOver(level);
	}, this);

	screen.signals.pausePressed.add(function(level)
	{
		this.showPause(level);
	}, this);

	screen.signals.showInstructions.add(function(what)
	{
		this.showInstructionsOverlay(what);
	}, this);

	this._currentScreen = screen;

	// if(showPause && !Common.savedData.hasViewedInstructions)
	// {
		// this._currentScreen._showPause = true;
		// Common.animator.setTimeout(function()
		// {
			// this.showPause(true);
		// }, 0, this);
	// }

	return screen;
};

Application.prototype.showEditor = function()
{
	var screen = new EditorScreen();
	this._screenManager.add(screen, this._getTransition());

	this._currentScreen = screen;

	return screen;
};

Application.prototype.showHelpOverlay = function(section)
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new HelpOverlay(section);
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
};

Application.prototype.showCodeOverlay = function()
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new CodeOverlay();
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
};

Application.prototype.showInstructionsOverlay = function(what)
{
    // var t = new Transition();
    // t.replace = false;
    // t.push = true;

    // var screen = new InstructionsOverlay();
    // this._screenManager.add(screen, t);

    // screen.signals.requestedPreviousScreen.addOnce(function(id)
	// {
        // this._screenManager.remove();
    // }, this, true);


	var t     = new Transition();
	t.replace = false;
	t.push    = true;

	this._currentScreen.hideGUI(function()
	{
		var screen = new InstructionsOverlay(what);
		this._screenManager.add(screen, t);

		// Resume
		screen.signals.requestedNextScreen.addOnce(function()
		{
			this._screenManager.remove();
			this._currentScreen.showGUI();
		}, this);

	}, this, true);

};

Application.prototype.showEndlessOverlay = function(isLocked)
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new EndlessOverlay(isLocked);
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
};

Application.prototype.showRewardOverlay = function()
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new RewardOverlay();
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
};

Application.prototype.showEndGameOverlay = function()
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new EndGameOverlay();
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
};

Application.prototype.showPromoOverlay = function()
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new PromoOverlay();
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);

	screen.signals.linkClick.add(function(link, isDisneySite)
	{
		this.showExitOverlay(link, isDisneySite);
	}, this);
};


Application.prototype.showGenericPopupOverlay = function(content, callback, scope)
{
	var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new GenericPopupOverlay(content, callback, scope);
    this._screenManager.add(screen, t);

    screen.signals.requestedNextScreen.addOnce(function(){
        this._screenManager.remove();
    }, this);
};

/**
 * PAUSE
 */
Application.prototype.showPause = function(level)
{
	var t     = new Transition();
	t.replace = false;
	t.push    = true;

	this._currentScreen.hideGUI(function()
	{
		var screen = new PauseOverlay(level);
		this._screenManager.add(screen, t);

		// Resume
		screen.signals.requestedNextScreen.addOnce(function()
		{
			this._screenManager.remove();
			this._currentScreen.showGUI();
		}, this);

		// Return to splash
		screen.signals.requestedPreviousScreen.addOnce(function()
		{
			this.showSplash();
		}, this);

		// Restart
		screen.signals.requestedCurrentScreen.addOnce(function()
		{
			this.showGame();
		}, this);

	}, this, true);
};

/**
 * GAMEOVER
 */
Application.prototype.showGameOver = function(level)
{
	var t = new Transition();
	t.replace = false;
	t.push = true;

	var screen = new GameOverOverlay(level);
	this._screenManager.add(screen, t);

	screen.signals.requestedNextScreen.addOnce(function(id)
	{
		if(!Common.savedData.hasSeenOutro && Common.savedData.getCrystalCount() == Common.savedData.getCollectedCrystalCount())
		{
			this.showOutro();
		}
		else
		{
			if(!Common.savedData.endless)
				this.showLevelSelect();
			else
				this.showSplash();
		}
	}, this);

	screen.signals.requestedCurrentScreen.addOnce(function()
	{
		if(!Common.savedData.hasSeenOutro && Common.savedData.getCrystalCount() == Common.savedData.getCollectedCrystalCount())
			this.showOutro();
		else
			this.showGame();
	}, this);

	screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
		if(!Common.savedData.hasSeenOutro && Common.savedData.getCrystalCount() == Common.savedData.getCollectedCrystalCount())
			this.showOutro();
		else
			this.showSplash();
	}, this);
};

/**
 * EXTERNAL LINK OVERLAY
 */
Application.prototype.showExitOverlay = function(link, isDisneySite)
{
    var t = new Transition();
    t.replace = false;
    t.push = true;

    var screen = new ExitOverlay(link, isDisneySite);
    this._screenManager.add(screen, t);

    screen.signals.requestedPreviousScreen.addOnce(function(id)
	{
        this._screenManager.remove();
    }, this);
}

//===================================================
// PRIVATE METHODS
//===================================================

/**
 */
Application.prototype._getTransition = function()
{
	// var transition = new Transition();
	// transition.replace = true;
	// transition.push = false;

    var transition      = new CutoutTransition(this._assetManager.getTexture("transition"), Common.TRANSITION_COLOR);
    // transition.wait     = true;
	// transition.replace = true;
	// transition.push = false;

    // transition.signals.in.addOnce(function() {
        // Common.animator.paused = false;
    // }, this);

	return transition;
}

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"./Common":2,"./Goals":4,"./SavedData":7,"./lib/CutoutTransition":47,"./lib/Transition":52,"./overlays/CharacterUnlockedOverlay":53,"./overlays/CodeOverlay":54,"./overlays/EndGameOverlay":55,"./overlays/EndlessOverlay":56,"./overlays/ExitOverlay":57,"./overlays/GameOverOverlay":58,"./overlays/GenericPopupOverlay":59,"./overlays/HelpOverlay":60,"./overlays/InstructionsOverlay":61,"./overlays/PauseOverlay":62,"./overlays/PowerupPurchaseOverlay":63,"./overlays/PromoOverlay":64,"./overlays/RewardOverlay":65,"./screens/CharacterSelectScreen":66,"./screens/DailyBonusScreen":67,"./screens/EditorScreen":68,"./screens/GameScreen":69,"./screens/IntroScreen":70,"./screens/LevelSelectScreen":71,"./screens/SplashScreen":74}],2:[function(require,module,exports){
/**
 *  Common
 *
 *  Created by Legman on 30/04/2015.
 *
 */

//===================================================
// CONSTRUCTOR
//===================================================

function Common() {}
module.exports = Common;


/* ------GENERIC------ */

/**
 * @type {Number}
 * @const
 */
Common.STAGE_WIDTH = 1900.0;

/**
 * @type {Number}
 * @const
 */
Common.STAGE_HEIGHT = 768.0;

/**
 * @type {PIXI.Container}
 * @static
 */
Common.stage = null;

/**
 * @type {PIXI.CanvasRenderer|PIXI.WebGLRenderer}
 * @static
 */
Common.renderer = null;

/**
 * @type {p3.Timestep}
 * @static
 */
Common.timestep = null;

/**
 * @type {p3.Animator}
 * @static
 */
Common.animator = null;

/**
 * @type {PIXI.Point}
 * @static
 */
Common.touch = new PIXI.Point(0.0, 0.0);

/**
 * @type {Number}
 * @static
 */
Common.paused = false;

/**
 * @type {Boolean}
 * @static
 */
Common.isWebGL = false;

/**
 * @type {Number}
 * @const
 */
Common.DEBUG_PAINT_MODE = 0;

/**
 * @type {Number}
 * @static
 */
Common.frameCount = 0;

/**
 * @type {Number}
 * @const
 */
Common.FPS = 60;

/**
 * @type {SavedData}
 * @static
 */
Common.sceneManager = null;

/**
 * @type {String}
 * @static
 */
Common.generatedTextures = {};

/**
 * @type {String}
 * @static
 */
Common.COUNTRY_CODE = 'en';

/**
 * @type {Object}
 * @static
 */
Common.animationData = {};

/**
 * @type {SavedData}
 * @static
 */
Common.savedData = null;

/**
 * @type {Goals}
 * @static
 */
Common.goalsManager = null;

/**
 * @type {Object}
 * @static
 */
Common.characterAnimationData = [];

Common.bgMusicVolume = 0.3;
Common.bgMusic = null;

//===================================================
},{}],3:[function(require,module,exports){
var Common = require("./Common");

//===================================================
// CONSTRUCTOR
//===================================================
function Ctow()
{

	this.ctow = null;

	if(typeof(CTOW) != "undefined")
		this.ctow = new CTOW();

	this.defaultEventData =
	{
		event          : null,
		page_name      : "emea:uk:games:sws:play:{Game name}",
		page_url       : "{URL}",
		game_name      : "{Game name}",
		game_id        : "{CMS ID}",
		game_source_id : "{CMS Name}",
		game_tier4     : "FrozenNorthernLights"
	};
}
module.exports = Ctow;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
Ctow.prototype.init = function()
{
	if(this.ctow == null) return;

	console.info("CTOW Init");
	this.ctow.trackPage();
};

Ctow.prototype.trackEvent = function(data)
{
	if(this.ctow == null) return;
	if(!data.event)
	{
		console.error("Field missing: 'event'")
		return;
	}

	var eventData = JSON.parse(JSON.stringify(this.defaultEventData));

	eventData.event = data.event;
	if(!!data.game_level) eventData.game_level = data.game_level;
	if(!!data.game_tier1) eventData.game_tier1 = data.game_tier1;
	if(!!data.game_tier2) eventData.game_tier2 = data.game_tier2;
	if(!!data.game_tier3) eventData.game_tier3 = data.game_tier3;
	if(!!data.game_tier4) eventData.game_tier4 = data.game_tier4;
	if(!!data.game_tier5) eventData.game_tier5 = data.game_tier5;
	if(!!data.game_tier6) eventData.game_tier6 = data.game_tier6;
	if(!!data.game_meta)  eventData.game_meta  = data.game_meta;

	console.group("Event tracked");
	console.info(data);
	console.info(eventData);
	console.groupEnd();

	// this.ctow.trackGame(eventData);
}
},{"./Common":2}],4:[function(require,module,exports){
var Common = require("./Common");

//===================================================
// CONSTRUCTOR
//===================================================

function Goals()
{
	this._assetManager = p3.AssetManager.instance;
	this._activeGoalsCount = 3;
	this._activeGoals = null;
	this._activeGoalsCompleted = null;
	this._gameScreen = null;
}
module.exports = Goals;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
Goals.prototype.init = function()
{
	var json = this._assetManager.getJSON("config");

	this.goals  = json.goals;

	for(var i = 0; i < this.goals.length; i++)
	{
		if(this.goals[i].value > 1 && !!this._assetManager.getJSON("strings").goal_labels[this.goals[i].type + "_plural"])
		{
			this.goals[i].label = this._assetManager.getJSON("strings").goal_labels[this.goals[i].type + "_plural"][Common.COUNTRY_CODE].replace("{value}", this.goals[i].value);
		}
		else
		{
			this.goals[i].label = this._assetManager.getJSON("strings").goal_labels[this.goals[i].type][Common.COUNTRY_CODE].replace("{value}", this.goals[i].value);
		}
		this.goals[i].icon  = json.goal_icons[this.goals[i].type];
	}
};

/**
 */
Goals.prototype.startRun = function(gameScreen)
{
	this._gameScreen = gameScreen;
	this._activeGoals = this.getActiveGoals();
	this._activeGoalsCompleted = [];
	this._events = [];
}

/**
 */
Goals.prototype.getGoalById = function(id)
{
	for(var i = 0; i < this.goals.length; i++)
	{
		if(this.goals[i].id == id)
			return this.goals[i];
	}
}

/**
 */
Goals.prototype.getGoalStatus = function(id)
{
	if(!Common.savedData.goals[id])
		return 0;

	var goal = this.getGoalById(id);
	return Math.min(1, Common.savedData.goals[id]/goal.value);
}

/**
 */
Goals.prototype.getActiveGoals = function()
{
	var goals = [];

	for(var i = 0; i < this.goals.length && goals.length < this._activeGoalsCount; i++)
	{
		if(this.getGoalStatus(this.goals[i].id) < 1)
		{
			goals.push(this.goals[i]);
		}
	}

	return goals;
}

/**
 */
Goals.prototype.trackEvent = function(event, amount)
{
	amount = !!amount ? amount : 1;
	save = false;

	// Run events count
	if(!this._events[event])
		this._events[event] = amount;
	else
		this._events[event] += amount;

	// Update active goals
	for(var i = 0; i < this._activeGoals.length; i++)
	{
		var goal = this._activeGoals[i];

		if(!Common.savedData.goals[goal.id])
			Common.savedData.goals[goal.id] = 0;


		if(goal.type == event)
		{
			if(Common.savedData.goals[goal.id] >= goal.value) break;

			Common.savedData.goals[goal.id]++;
			// console.log("Goal %s %i/%i", goal.id, Common.savedData.goals[goal.id], goal.value);

			if(Common.savedData.goals[goal.id] >= goal.value)
			{
				console.log("Goal %s completed", goal.id);
				this.goalCompleted(goal);
				save = true;
			}

		}
		else if(goal.type == event + "_run")
		{
			if(this._events[event] > goal.value) break;

			// console.log("Goal %s %i/%i", goal.id, this._events[event], goal.value);

			if(this._events[event] > Common.savedData.goals[goal.id])
				Common.savedData.goals[goal.id] = this._events[event];

			if(this._events[event] == goal.value)
			{
				console.log("Goal %s completed", goal.id);
				this.goalCompleted(goal);
				save = true;
			}
		}
	}

	if(save)
		Common.savedData.save();
}

/**
 * Return an array of the ids of the goals completed during a level
 * @returns {Array}
 */
Goals.prototype.getRunCompletedGoalsIds = function()
{
	var ids = [];

	for(var i = 0; i < this._activeGoalsCompleted.length; i++)
	{
		ids.push(this._activeGoalsCompleted[i].id);
	}

	return ids;
}

/**
 */
Goals.prototype.goalCompleted = function(goal)
{
	Common.savedData.coins += goal.reward;
	this._gameScreen.gameUI.queueGoal(goal.label, goal.reward);

	this._activeGoalsCompleted.push(goal);
}
},{"./Common":2}],5:[function(require,module,exports){
"use strict";

/**
 * Keyboard class
 * ===========================
 * @constructor
 */

function Keyboard()
{
}
module.exports = Keyboard;

var Keyboard = Keyboard.prototype;

/**
 * @type {Signal.Signal}
 */
Keyboard.signalKeyDown = new signals.Signal();
Keyboard.signalKeyUp = new signals.Signal();

/**
 * @type {Object.<boolean>}
 */
Keyboard._keysDown    = null;
Keyboard._keysPressed = null;
Keyboard._keysUp      = null;

/**
 * @const @type {number}
 */
Keyboard.KEY_TAB   = 9;
Keyboard.KEY_ENTER = 13;
Keyboard.KEY_SHIFT = 16;
Keyboard.KEY_CTRL  = 17;
Keyboard.KEY_SPACE = 32;
Keyboard.KEY_LEFT  = 37;
Keyboard.KEY_UP    = 38;
Keyboard.KEY_RIGHT = 39;
Keyboard.KEY_DOWN  = 40;
Keyboard.KEY_A     = 65;
Keyboard.KEY_B     = 66;
Keyboard.KEY_C     = 67;
Keyboard.KEY_D     = 68;
Keyboard.KEY_E     = 69;
Keyboard.KEY_F     = 70;
Keyboard.KEY_G     = 71;
Keyboard.KEY_H     = 72;
Keyboard.KEY_I     = 73;
Keyboard.KEY_J     = 74;
Keyboard.KEY_K     = 75;
Keyboard.KEY_L     = 76;
Keyboard.KEY_M     = 77;
Keyboard.KEY_N     = 78;
Keyboard.KEY_O     = 79;
Keyboard.KEY_P     = 80;
Keyboard.KEY_Q     = 81;
Keyboard.KEY_R     = 82;
Keyboard.KEY_S     = 83;
Keyboard.KEY_T     = 84;
Keyboard.KEY_U     = 85;
Keyboard.KEY_V     = 86;
Keyboard.KEY_W     = 87;
Keyboard.KEY_X     = 88;
Keyboard.KEY_Y     = 89;
Keyboard.KEY_Z     = 90;
Keyboard.KEY_PLUs  = 187;
Keyboard.KEY_MINUS = 189;


/**
 * Initialization
 */
Keyboard.init = function()
{
	this.reset();

	// Key events
	document.body.onkeydown = function(e)
	{
		var code;
		if(window.event) code = e.keyCode;
		else             code = e.which;

		Keyboard._keysDown[code]    = !Keyboard._keysPressed[code];
		Keyboard._keysPressed[code] = true;

		Keyboard.signalKeyDown.dispatch(code);
	}

	document.body.onkeyup = function(e)
	{
		var code;
		if(window.event) code = e.keyCode;
		else             code = e.which;

		Keyboard._keysDown[code]    = false;
		Keyboard._keysPressed[code] = false;
		Keyboard._keysUp[code]      = true;

		Keyboard.signalKeyUp.dispatch(code);
	}
}

/**
 * Update
 */
Keyboard.update = function()
{
	Keyboard._keysDown = {};
	Keyboard._keysUp   = {};
}

/**
 * Reset
 */
Keyboard.reset = function()
{
	Keyboard._keysDown    = {};
	Keyboard._keysPressed = {};
	Keyboard._keysUp      = {};
}

/**
 * Return if the given keyCode is currently pressed
 *
 * @param {Number} keyCode
 * @returns {boolean}
 */
Keyboard.getKeyPressed = function(keyCode)
{
	return Keyboard._keysPressed[keyCode];
}

/**
 * Return if the given keyCode or the given combination of keys has just been pressed
 *
 * @param {Number} keyCode
 * @returns {Boolean}
 */
Keyboard.getKeyJustPressed = function(keyCode)
{
	return Keyboard._keysDown[keyCode];
}

/**
 * Return if the given keyCode or the given combination of keys has just been released
 *
 * @param {Number} keyCode
 * @returns {Boolean}
 */
Keyboard.getKeyJustReleased = function(keyCode)
{
	return Keyboard._keysUp[keyCode];
}
},{}],6:[function(require,module,exports){
/**
 *  Main
 */

var Application   = require("./Application");
var Common        = require("./Common");
var Preloader     = require("./screens/Preloader");
var SceneManager  = require("./lib/SceneManager");
var Keyboard      = require("./Keyboard");
var Ctow          = require("./Ctow");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @param {!Number} width
 * @param {!Number} height
 * @constructor
 */
function Main(width, height)
{
	/**
	 * @type {!Number}
	 * @private
	 */
	this._width  = width;
	this._height = height;

	/**
	 * @type {p3.AssetManager}
	 * @private
	 */
	this._assetManager = null;

	/**
	 * @type {p3.ScreenManager}
	 * @private
	 */
	this._screenManager = null;

	/**
	 * @type {Preloader}
	 * @private
	 */
	this._preloader = null;

	/**
	 * @type {Application}
	 * @private
	 */
	this._game = null;

	/**
	 * @type {Number}
	 * @private
	 */
	this._resolution = 1.0;

	/**
	 * @type {String}
	 * @private
	 */
	this._scale      = "hd/";
	this._renderFPS  = 60.0;
	this._frameCount = 0;

}
window.Main = Main;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
Main.prototype.init = function()
{
  	this._assetManager  = p3.AssetManager.instance;
	this._screenManager = new SceneManager();

	Common.COUNTRY_CODE = window.og.language;

	var elementId   = "og-game-holder";
	var params      = new p3.ViewParams();
	params.width    = this._width;
	params.height   = this._height;
	params.holderId = elementId;
	params.rotateImageUrl   = "assets/images/system/" + Common.COUNTRY_CODE + "/rotate_device.jpg";
	params.rotateImageColor = "#000000";

	PIXI.RETINA_PREFIX = /\_(?=[^_]*$)(.+)x/;

	p3.Tracking.DEBUG = true;
	Common.tracking = new p3.Tracking();
	Common.tracking.init(new p3.TrackingModuleEcho(window.stats));

	p3.Device.init(window["bowser"]);

	TweenMax.defaultOverwrite = "none";
	TweenMax.ticker.fps(Common.FPS);

	var canvas = new p3.View(params);
	canvas.signals.ready.addOnce(function(canvas)
	{
		var options = {};
		options.view = canvas;
		options.transparent = false;
		options.antialias = false;
		options.preserveDrawingBuffer = false;
		options.resolution = this._resolution;
		this._assetManager.scaleFactor = this._resolution;

		var stage = new PIXI.Container();
		Common.stage = stage;

		var renderer = PIXI.autoDetectRenderer(this._width, this._height, options);
		Common.renderer = renderer;

		this._screenManager.init(stage, renderer);
		Common.sceneManager = this._screenManager;

		Common.isWebGL = (renderer instanceof PIXI.WebGLRenderer);
		Common.DEBUG_PAINT_MODE = p3.Utils.getURLParameter("paint", 0);

		var timestep = new p3.Timestep();
		timestep.init(this.update, this.render, this);
		Common.timestep = timestep;

		Common.animator = new p3.Animator();
		Common.animator.init();

		Common.keyboard = new Keyboard();
		Common.keyboard.init();

		Common.ctow = new Ctow();
		Common.ctow.init();

		this.loadPreloader();

	}, this);
	canvas.signals.resize.add(this.onCanvasResize, this);

	var hidden;
	"undefined" != typeof document.hidden ? (hidden = "hidden",
		this.visibilityChange = "visibilitychange")    : "undefined" != typeof document.mozHidden ? (hidden = "mozHidden",
		this.visibilityChange = "mozvisibilitychange") : "undefined" != typeof document.msHidden ? (hidden = "msHidden",
		this.visibilityChange = "msvisibilitychange")  : "undefined" != typeof document.webkitHidden && (hidden = "webkitHidden",
		this.visibilityChange = "webkitvisibilitychange");

	document.addEventListener(this.visibilityChange, function(){
		document[hidden] ? Howler.volume(0) : Howler.volume(1);
	}, false);
	
	// Regain focus for keyboard events
	document.onclick = function(event) 
	{
        window.focus();
    };


	// Stats
	// this._stats = new Stats();
	// this._stats.domElement.style.position	= 'absolute';
	// this._stats.domElement.style.bottom		= '0px';
	// document.body.appendChild(this._stats.domElement);
};

/**
 */
Main.prototype.loadPreloader = function()
{
	var scale  = this._scale;
	var prefix = (scale === "sd/" ? "_0.5x" : "");
	var files =
	[
		{name:"preloader_0",  url:"images/" + scale + "preloader" + prefix + ".json"},
		{name:"preloader_bg", url:"images/" + scale + "titles_" + Common.COUNTRY_CODE + "/preloader" + prefix + ".jpg"}
	];
	var sounds = [
	];

	if (files.length)
	{
		this._assetManager.addFiles(files, window.og.gameDir + "assets/");
		this._assetManager.signalCompleted.addOnce(function() {this.loadAssets();}, this);
		this._assetManager.load();

		p3.AudioManager.instance.addSounds(sounds, [".mp3", ".ogg"], "");
	}
	else
	{
		this.loadAssets();
	}
};


/**
 */
Main.prototype.loadAssets = function()
{
	var scale  = this._scale;
	var prefix = (scale === "sd/" ? "_0.5x" : "");
	var files =
	[
		{name:"config",     url:"strings/config.json"},
		{name:"strings",    url:"strings/strings.json"},
		{name:"ui0",        url:"images/" + scale + "ui0" + prefix + ".json"},
		{name:"ui1",        url:"images/" + scale + "ui1" + prefix + ".json"},
		{name:"ui2",        url:"images/" + scale + "ui2" + prefix + ".json"},
		{name:"map0",       url:"images/" + scale + "map0" + prefix + ".json"},
		{name:"ingame_0",   url:"images/" + scale + "ingame_0" + prefix + ".json"},
		{name:"theme_01_0", url:"images/" + scale + "theme_01_0" + prefix + ".json"},
		{name:"theme_02_0", url:"images/" + scale + "theme_02_0" + prefix + ".json"},
		{name:"theme_03_0", url:"images/" + scale + "theme_03_0" + prefix + ".json"},
		{name:"northern_lights_0", url:"images/" + scale + "northern_lights_0" + prefix + ".json"},

		// Levels
		//{name:"level_bg_0",    url:"images/" + scale + "level_00_bg_0" + prefix + ".json"},
		//{name:"level_bg_1",    url:"images/" + scale + "level_01_bg_0" + prefix + ".json"},
		//{name:"level_bg_2",    url:"images/" + scale + "level_02_bg_0" + prefix + ".json"},
		//{name:"level_00_bg_0", url:"images/" + scale + "level_00_bg_0" + prefix + ".json"},
		//{name:"level_01_bg_0", url:"images/" + scale + "level_01_bg_0" + prefix + ".json"},
		//{name:"level_02_bg_0", url:"images/" + scale + "level_02_bg_0" + prefix + ".json"},


		{name:"editorConfig",      url:"images/hd/editor/config.json"},
		{name:"test_000",          url:"data/test_000.json"},
		{name:"test_001",          url:"data/test_001.json"},
		{name:"test_002",          url:"data/test_002.json"},
		{name:"endless_start_000", url:"data/endless_start_000.json"},
		{name:"endless_part_000",  url:"data/endless_part_000.json"},
		{name:"endless_part_001",  url:"data/endless_part_001.json"},
		{name:"endless_part_002",  url:"data/endless_part_002.json"},
		{name:"endless_part_003",  url:"data/endless_part_003.json"},
		{name:"endless_part_004",  url:"data/endless_part_004.json"},
		{name:"endless_part_005",  url:"data/endless_part_005.json"},
		{name:"endless_part_006",  url:"data/endless_part_006.json"},
		{name:"endless_part_007",  url:"data/endless_part_007.json"},
		{name:"endless_part_008",  url:"data/endless_part_008.json"},
		{name:"endless_part_009",  url:"data/endless_part_009.json"},
		{name:"endless_part_010",  url:"data/endless_part_010.json"},
		{name:"endless_part_011",  url:"data/endless_part_011.json"},
		{name:"endless_part_012",  url:"data/endless_part_012.json"},
		{name:"endless_part_013",  url:"data/endless_part_013.json"},
		{name:"endless_part_014",  url:"data/endless_part_014.json"},
		{name:"endless_part_015",  url:"data/endless_part_015.json"},
		{name:"endless_part_016",  url:"data/endless_part_016.json"},
		{name:"endless_part_017",  url:"data/endless_part_017.json"},
		{name:"endless_part_018",  url:"data/endless_part_018.json"},
		{name:"endless_part_019",  url:"data/endless_part_019.json"},
		{name:"endless_part_020",  url:"data/endless_part_020.json"},
		{name:"endless_part_021",  url:"data/endless_part_021.json"},
		{name:"endless_part_022",  url:"data/endless_part_022.json"},
		{name:"endless_part_023",  url:"data/endless_part_023.json"},
		{name:"endless_part_024",  url:"data/endless_part_024.json"},
		{name:"endless_part_025",  url:"data/endless_part_025.json"},
		{name:"level_00",          url:"data/level_00_tutorial.json"},
		{name:"level_01",          url:"data/level_01.json"},
		{name:"level_02",          url:"data/level_02.json"},
		{name:"level_03",          url:"data/level_03.json"},
		{name:"level_04",          url:"data/level_04.json"},
		{name:"level_05",          url:"data/level_05.json"},
		{name:"level_06",          url:"data/level_06.json"},
		{name:"level_07",          url:"data/level_07.json"},
		{name:"level_08",          url:"data/level_08.json"},
		{name:"level_09",          url:"data/level_09.json"},
		{name:"level_10",          url:"data/level_10.json"},
		{name:"level_11",          url:"data/level_11.json"},

		// Bg
		{name:"ui_bg_characters",  url:"images/hd/ui_bg_characters.jpg"},
		{name:"ui_bg_daily_bonus", url:"images/hd/ui_bg_daily_bonus.jpg"},
		{name:"ui_bg_main_menu",   url:"images/hd/ui_bg_main_menu.jpg"},
		{name:"transition",        url:"images/hd/transition.png"},

		// Particle systems
		{name: "particle_barrel_explosion",        url:"particles/particle_barrel_explosion.json"},
		{name: "particle_ice_explosion",           url:"particles/particle_ice_explosion.json"},
		{name: "particle_coin_collect_burst",      url:"particles/particle_coin_collect_burst.json"},
		{name: "particle_snow_emitter_v1",         url:"particles/particle_snow_emitter_v1.json"},
		{name: "particle_doublejump",              url:"particles/particle_doublejump.json"},
		{name: "particle_ice_bridge",              url:"particles/particle_ice_bridge.json"},
		{name: "particle_marshmallow_land",        url:"particles/particle_marshmallow_land.json"},
		{name: "particle_snowball",                url:"particles/particle_snowball.json"},
		{name: "particle_char_upgrade",            url:"particles/particle_emitter_snow_char_upgrade_00.json"},
		{name: "particle_menu_snow",               url:"particles/particle_emitter_menu_snow.json"},
		{name: "particle_level_unlock",            url:"particles/particle_level_unlock_icemagic3.json"},
		{name: "particle_character_unlock",        url:"particles/particle_snowstorm_char_unlock_00.json"},
		{name: "particle_reward",                  url:"particles/particle_emitter_snowburst_reward_00.json"},
		{name: "particle_troll_magic",             url:"particles/particle_emitter_troll_magic_00.json"},
		{name: "particle_magic_trail",             url:"particles/particle_emitter_trollmagic_trail_01.json"},
		{name: "particle_death",                   url:"particles/particle_emitter_fall_offscreen_00.json"},
		{name: "particle_sparkle_results_blue",    url:"particles/particle_sparkle_results_blue.json"},
		{name: "particle_sparkle_results_green",   url:"particles/particle_sparkle_results_green.json"},
		{name: "particle_sparkle_results_pink",    url:"particles/particle_sparkle_results_pink.json"},
		{name: "particle_sparkle_results_purple",  url:"particles/particle_sparkle_results_purple.json"},
		{name: "particle_sled_shine",              url:"particles/particle_sled_shine_01.json"},
		{name: "particle_map_ripples_lower",       url:"particles/particle_map_ripples_lower_00.json"},
		{name: "particle_map_ripples_upper",       url:"particles/particle_map_ripples_upper_00.json"},
		{name: "particle_map_ripples_bridge",      url:"particles/particle_map_ripples_bridge.json"},
		{name: "particle_map_troll_pool_sparkles", url:"particles/particle_map_troll_pool_sparkles.json"},
		{name: "particle_end_swirltrail_00", 	   url:"particles/particle_end_swirltrail_00.json"},
		{name: "particle_gem_cyan_ending", 	   	   url:"particles/particle_gem_cyan_ending.json"},
		{name: "particle_gem_green_ending", 	   url:"particles/particle_gem_green_ending.json"},
		{name: "particle_gem_pink_ending", 	   	   url:"particles/particle_gem_pink_ending.json"},
		{name: "particle_gem_purple_ending", 	   url:"particles/particle_gem_purple_ending.json"},

		// Fx
		{name:"shockwave",     url:"images/hd/shockwave.png"},

		// Fonts
		{name:"mikadan_title_64pt",          url:"fonts/mikadan_title_64pt.xml"},
		{name:"mikadan_white_64pt",          url:"fonts/mikadan_white_64pt.xml"},
		{name:"superclarendon_level_32pt",   url:"fonts/superclarendon_level_32pt.xml"},
		{name:"superclarendon_numbers_60pt", url:"fonts/superclarendon_numbers_60pt.xml"},
		{name:"superclarendon_results_32pt", url:"fonts/superclarendon_results_32pt.xml"},
		{name:"superclarendon_title_50pt",   url:"fonts/superclarendon_title_50pt.xml"},
		{name:"superclarendon_title_64pt",   url:"fonts/superclarendon_title_64pt.xml"},

		// Level elements
		{name:"theme_01_fill",           url:"images/hd/editor/theme_01_fill.png"},
		{name:"theme_01_ground",         url:"images/hd/editor/theme_01_ground.png"},
		{name:"theme_01_ground_edge",    url:"images/hd/editor/theme_01_ground_edge.png"},
		{name:"theme_01_wall",           url:"images/hd/editor/theme_01_wall.png"},
		{name:"theme_02_fill",           url:"images/hd/editor/theme_02_fill.png"},
		{name:"theme_02_ground",         url:"images/hd/editor/theme_02_ground.png"},
		{name:"theme_02_ground_edge",    url:"images/hd/editor/theme_02_ground_edge.png"},
		{name:"theme_02_wall",           url:"images/hd/editor/theme_02_wall.png"},
		{name:"theme_03_fill",           url:"images/hd/editor/theme_03_fill.png"},
		{name:"theme_03_ground",         url:"images/hd/editor/theme_03_ground.png"},
		{name:"theme_03_ground_edge",    url:"images/hd/editor/theme_03_ground_edge.png"},
		{name:"theme_03_wall",           url:"images/hd/editor/theme_03_wall.png"},
		{name:"theme_04_fill",           url:"images/hd/editor/theme_04_fill.png"},
		{name:"theme_04_ground",         url:"images/hd/editor/theme_04_ground.png"},
		{name:"theme_05_fill",           url:"images/hd/editor/theme_05_fill.png"},
		{name:"theme_05_ground",         url:"images/hd/editor/theme_05_ground.png"},
		{name:"theme_06_fill",           url:"images/hd/editor/theme_06_fill.png"},
		{name:"theme_06_ground",         url:"images/hd/editor/theme_06_ground.png"},
		{name:"elsa_ice_flow_capl_00",   url:"images/hd/editor/elsa_ice_flow_capl_00.png"},
		{name:"elsa_ice_flow_ground_00", url:"images/hd/editor/elsa_ice_flow_ground_00.png"},

		{name:"jump_platform",  url:"images/hd/editor/jump_platform.png"},
		{name:"camera_zoom",    url:"images/hd/editor/camera_zoom.png"},
		{name:"level_end",      url:"images/hd/editor/level_end.png"},
		{name:"level_gameover", url:"images/hd/editor/level_gameover.png"},
		{name:"shrink_unlock",  url:"images/hd/editor/shrink_unlock.png"},
		{name:"shrink_lock",    url:"images/hd/editor/shrink_lock.png"},
		{name:"tutorial",       url:"images/hd/editor/tutorial.png"},
		{name:"sven",           url:"images/hd/editor/sven.png"},
		{name:"marshmallow",    url:"images/hd/editor/marshmallow.png"},
		{name:"troll",          url:"images/hd/editor/troll.png"},
		{name:"troll_pabbie",   url:"images/hd/editor/troll_pabbie.png"}

		// Spine (does it cache?)
		// {name: "char_female",            url:"spine/" + scale + 'char_female' + ".json"},
		// {name:"char_female",      url:"spine/hd/char_female.png"},
		// {name:"char_elsa",        url:"spine/hd/char_elsa.png"},
		// {name:"char_kristoff",    url:"spine/hd/char_kristoff.png"},
		// {name:"char_olaf",        url:"spine/hd/char_olaf.png"},
		// {name:"char_pabbie",      url:"spine/hd/char_pabbie.png"},
		// {name:"char_sven",        url:"spine/hd/char_sven.png"},
		// {name:"sled",             url:"spine/hd/sled.png"},
		// {name:"char_marshmallow", url:"spine/hd/char_marshmallow.png"},
		// {name:"intro",            url:"spine/hd/intro.png"},
		// {name:"intro2",           url:"spine/hd/intro2.png"}
	];


	var sounds =
	[
		"mx_frozen_01_gameplay_lp",
		"mx_frozen_01_gameplay_tension_lp",
		"mx_frozen_02_character_selection",
		"mx_frozen_03_main_menu_edit",
		"mx_frozen_04_pause_lp",
		"mx_frozen_05_map_lp",
		"mx_frozen_05_score_lp",
		"sfx_intro_audio_01",
		"sfx_outro_audio_01",

		"sfx_btn_press_00",
		"sfx_btn_rollover_00",
		"sfx_ui_buy_upgrade_02",
		"sfx_pulley_down_loop_04",
		"sfx_ui_map_level_unlock_02",

		"sfx_pickup_snowflake_00",
		"sfx_pickup_gem_tinkle_01",
		"sfx_pickup_troll_01",
		"sfx_generic_hit_obstacle_00",
		"sfx_iceblock_smash_00",
		"sfx_iceblock_smash_01",
		"sfx_iceblock_smash_02",
		"sfx_iceblock_smash_03",
		"sfx_iceblock_smash_04",
		"sfx_iceblock_smash_05",
		"sfx_iceblock_smash_06",
		"sfx_kristoff_smash_ice_00",
		"sfx_kristoff_smash_ice_01",
		"sfx_kristoff_smash_ice_02",
		"sfx_kristoff_smash_ice_03",
		"sfx_kristoff_smash_ice_04",
		"sfx_kristoff_smash_ice_05",
		"sfx_kristoff_smash_ice_06",
		"sfx_generic_hit_obstacle_00",
		"sfx_generic_fall_offscreen_01",
		"sfx_kristoff_swing_axe_02",
		"sfx_elsa_ice_magic_platform_00",
		"sfx_elsa_ice_magic_platform_01",
		"sfx_elsa_ice_magic_platform_02",
		"sfx_elsa_ice_magic_platform_03",
		"sfx_elsa_ice_magic_platform_fail_00",
		"mx_troll_magic_rush_loop_02",
		"sfx_troll_notify_00",
		"sfx_sven_hitobstacle_stop_00",
		"sfx_sven_jump_00",
		"sfx_sven_jump_01",
		"sfx_sven_jump_02",
		"sfx_sven_jump_03",
		"sfx_sven_jump_04",
		"sfx_sven_run_stop_00",
		"sfx_goals_screen_spotfx_00",
		"sfx_main_screen_spotfx_01",
		"sfx_promo_screen_spotfx_00",
		"sfx_ui_character_unlock_01",

		"sfx_anna_snow_runvsoft_00",
		"sfx_kristoff_snow_runvsoft_00",
		"sfx_generic_olaf_snow_runvsoft_00",
		"sfx_sven_run_02",
		"sfx_snow_slide_loop_00",

		"sfx_generic_jump_00",
		"sfx_generic_jump_01",
		"sfx_generic_jump_02",
		"sfx_generic_land_soft_00",
		"sfx_generic_land_heavy_00",

		"sfx_marshmallow_fall_00",
		"sfx_marshmallow_move_00",
		"sfx_marshmallow_end_00",
		"sfx_marshmallow_grunt_00"
	];
	if (files.length)
	{
		this._assetManager.addFiles(files, window.og.gameDir + "assets/");
		this._assetManager.signalProgress.add(this.onLoadingProgress, this);
		this._assetManager.signalCompleted.addOnce(this.onLoadingCompleted, this);
		this._assetManager.load();

		this._preloader = new Preloader();
		this._screenManager.add(this._preloader);

		p3.AudioManager.instance.addSounds(sounds, [".mp3", ".ogg"], window.og.gameDir + "assets/audio/");
	}
	else
	{
		this.startGame();
	}
};

/**
 */
Main.prototype.startGame = function()
{
	var that = this;
	that._game = new Application();
	that._game.init();
};

/**
 */
Main.prototype.update = function()
{
	// this._stats.begin();

	if(p3.Timestep.deltaTime >= 1/30)
		p3.Timestep.deltaTime = 1/30;

	this._screenManager.update();
	Common.animator.update();
	Common.keyboard.update();

	if (Common.DEBUG_PAINT_MODE > 0)
	{
		this.paintBadImage(Common.stage);
	}

	this._frameCount++;
	Common.frameCount = this._frameCount;
};

/**
 */
Main.prototype.render = function()
{
	Common.renderer.render(Common.stage);

	// this._stats.end();
};

/**
 * @param {!PIXI.DisplayObject} display
 * @param {Number=} color
 */
Main.prototype.paintBadImage = function(display, color)
{
	color = color || 0xAA00FF;

	var child;
	for (var i = 0; i < display.children.length; ++ i) {
		child = display.children[i];
		if (child instanceof PIXI.Sprite) {
			if (Common.DEBUG_PAINT_MODE == 1) {
				if (child.texture.width % 2 != 0 || child.texture.height % 2 != 0) {
					child.tint = color;
				} else {
					child.tint = 0xFFFFFF;
				}
			}
			if (Common.DEBUG_PAINT_MODE == 2) {
				if (child.position.x !== parseInt(child.position.x) || child.position.y !== parseInt(child.position.y)) {
					child.tint = color;
				} else {
					child.tint = 0xFFFFFF;
				}
			}
		}
		this.paintBadImage(child, color);
	}
};

//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

/**
 */
Main.prototype.onLoadingProgress = function(event)
{
	this._preloader.loadedPercentage = event.progress;
};

// Main.prototype.onLoadingSpineProgress = function(event)
// {
	// this._preloader.loadedPercentage = 0.5 + event.progress/200;
// };

/**
 */
Main.prototype.onLoadingCompleted = function()
{
    var that = this;

	var loader =  new PIXI.loaders.Loader();
	
	// loader.on("progress", function(event)
	// {
		// that.onLoadingSpineProgress(event)
	// })	
	
	loader.add('char_female',      "assets/spine/" + that._scale + 'char_female' + ".json")
				.add('char_elsa',        "assets/spine/" + that._scale + 'char_elsa' + ".json")
				.add('char_kristoff',    "assets/spine/" + that._scale + 'char_kristoff' + ".json")
				.add('char_olaf',        "assets/spine/" + that._scale + 'char_olaf' + ".json")
				.add('char_pabbie',      "assets/spine/" + that._scale + 'char_pabbie' + ".json")
				.add('char_sven',        "assets/spine/" + that._scale + 'char_sven' + ".json")
				.add('sled',             "assets/spine/" + that._scale + 'sled' + ".json")
				.add('char_marshmallow', "assets/spine/" + that._scale + 'char_marshmallow' + ".json")
				.add('char_troll',       "assets/spine/" + that._scale + 'char_troll_sign' + ".json")
				.add('intro',            "assets/spine/" + that._scale + 'intro' + ".json")
				.add('outro',            "assets/spine/" + that._scale + 'outro' + ".json")
				.add('anna',             "assets/spine/" + that._scale + 'anna' + ".json")
				.add('kristoff',         "assets/spine/" + that._scale + 'kristoff' + ".json")
				.add('olaf',             "assets/spine/" + that._scale + 'olaf' + ".json")
				.add('elsa',             "assets/spine/" + that._scale + 'elsa' + ".json")
				.add('pabbie',           "assets/spine/" + that._scale + 'pabbie' + ".json")
				.load(function(loader, resources)
				{
					Common.characterAnimationData.char_female      = resources.char_female.spineData;
					Common.characterAnimationData.char_elsa        = resources.char_elsa.spineData;
					Common.characterAnimationData.char_kristoff    = resources.char_kristoff.spineData;
					Common.characterAnimationData.char_olaf        = resources.char_olaf.spineData;
					Common.characterAnimationData.char_pabbie      = resources.char_pabbie.spineData;
					Common.characterAnimationData.char_sven        = resources.char_sven.spineData;
					Common.characterAnimationData.char_sled        = resources.sled.spineData;
					Common.characterAnimationData.char_marshmallow = resources.char_marshmallow.spineData;
					Common.characterAnimationData.char_troll       = resources.char_troll.spineData;
					Common.introAnimationData                      = resources.intro.spineData;
					Common.outroAnimationData                      = resources.outro.spineData;
					Common.characterAnimationData.anna             = resources.anna.spineData;
					Common.characterAnimationData.kristoff         = resources.kristoff.spineData;
					Common.characterAnimationData.olaf             = resources.olaf.spineData;
					Common.characterAnimationData.elsa             = resources.elsa.spineData;
					Common.characterAnimationData.pabbie           = resources.pabbie.spineData;

					that._preloader.loadedPercentage = 100.0;
					that._preloader.animateOut(null, this);
					that._preloader = null;

					that._assetManager.signalProgress.removeAll();
					that._assetManager.signalCompleted.removeAll();

					window.r2l          = that._assetManager.getJSON("config").r2l;
					window.webfont      = that._assetManager.getJSON("config").webfont;
					Common.COUNTRY_CODE = that._assetManager.getJSON("config").locale;

					// Event Tracking
					Common.ctow.trackEvent(
					{
						event : "game_load"
					});

					that.startGame();
				});
};

/**
 * @param {!Boolean} correct
 */
Main.prototype.onCanvasResize = function(correct)
{
	if (correct)
	{
		Common.renderer.resize(p3.View.width, p3.View.height);

		if (this._screenManager)
		{
			this._screenManager.resize();
		}
	}
};

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"./Application":1,"./Common":2,"./Ctow":3,"./Keyboard":5,"./lib/SceneManager":51,"./screens/Preloader":72}],7:[function(require,module,exports){
var Common = require("./Common");

//===================================================
// CONSTRUCTOR
//===================================================

function SavedData()
{
	this._assetManager = p3.AssetManager.instance;

	this.SAVE_NAME    = "frozen_lights_north";
	this.SAVE_VERSION = "16.09.09";
	this.SAVE_SEED    = "y5k0Eo6R177mUkb";

	// Just loaded
	this.showSplashIntro = true;

	// Current level / character
	this.character    = 'anna';
	this.levels       = 12; // (readonly)
	this.level        = 0;  // 0-11
	this.endless      = false;
	this.unit         = 100; // px/m (readonly)

	// Debug
	this.levelDebug     = "";
	this.characterDebug = "";

	// Coins
	this.coins          = 0;
	this.dailyBonusDate = null;

	// Levels unlocked
	this.levelsUnlocked    = 1; // [1-this.levels]
	this.showUnlockedLevel = false;

	// Tutorial
	this.hasSeenIntro    = false;
	this.hasSeenOutro    = false;
	this.hasSeenTutorial =
	{
		anna         : false,
		kristoff     : false,
		olaf         : false,
		elsa         : false,
		pabbie       : false,
		endless      : false
	}

	// Characters unlocked
	this.charactersUnlocked =
	{
		anna         : true, // Always true
		kristoff     : false,
		olaf         : false,
		elsa         : false,
		pabbie       : false
	}
	this.showUnlockedCharacter = "";

	// Characters powerups (flip, magnet, magic)
	this.charactersPower =
	{
		anna         : [0, 0, 0],
		kristoff     : [0, 0, 0],
		olaf         : [0, 0, 0],
		elsa         : [0, 0, 0],
		pabbie       : [0, 0, 0]
	}

	// Crystals
	this.crystals = [];
	for(var level = 0; level < this.levels; level++)
	{
		this.crystals[level] = {};
		this.crystals[level].anna     = [false, false, false];
		this.crystals[level].kristoff = [false, false, false];
		this.crystals[level].olaf     = [false, false, false];
		this.crystals[level].elsa     = [false, false, false];
	}

	// Trolls
	this.trolls = [];
	for(var level = 0; level < this.levels; level++)
	{
		this.trolls[level] = [false, false, false];
	}

	// Goals
	this.goals = {};

	// Highscore
	this.highscore = {};

	// Loss streak reward
	this.lossStreak =
	{
		count   : 0,
		awarded : false
	}

	// All level completed
	this.endGameMessage =
	{
		endless : // When the required amount of levels to unlockendless mode have been completed
		{
			show  : false,
			shown : false
		},
		levels : // When all levels have been completed
		{
			show  : false,
			shown : false
		},
		crystals : // when all crystals have been collected / pabbie unlocked
		{
			show  : false,
			shown : false
		},
		trolls : // when all trolls have been collected
		{
			show  : false,
			shown : false
		}
	}

	// Promo
	this.promoTime  = Math.floor(Date.now() / 1000) + this._assetManager.getJSON("config").promo.time;
	this.promoShown = [];
	
	// Codes
	this.codesUsed = [];
}
module.exports = SavedData;

//===================================================
// PUBLIC METHODS
//===================================================

SavedData.prototype.init = function()
{
	if(!window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION])
	{
		console.log('reset');
		this.reset();
		this.save();
	}
	else
	{
		console.log('load');
		this.load();
	}
};

/**
 * Reset
 */
SavedData.prototype.reset = function()
{

};

/**
 * Load
 */
SavedData.prototype.load = function()
{
	var data = window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION];
	data = JSON.parse(data);

	this.coins                    = parseInt(data.coins),
	this.levelsUnlocked           = parseInt(data.levelsUnlocked),
	this.hasSeenIntro             = data.hasSeenIntro,
	this.hasSeenOutro             = data.hasSeenOutro,
	this.showUnlockedLevel        = data.showUnlockedLevel;
	this.showUnlockedCharacter    = data.showUnlockedCharacter;
	this.hasSeenTutorial          = data.hasSeenTutorial;
	this.charactersUnlocked       = data.charactersUnlocked;
	this.charactersPower          = data.charactersPower;
	this.goals                    = data.goals;
	this.dailyBonusDate           = data.dailyBonusDate;
	this.crystals                 = data.crystals;
	this.trolls                   = data.trolls;
	this.highscore                = data.highscore;
	this.lossStreak               = data.lossStreak;
	this.endGameMessage           = data.endGameMessage;
	this.promoShown               = !!data.promoShown ? data.promoShown : this.promoShown;
	this.codesUsed                = !!data.codesUsed  ? data.codesUsed : this.codesUsed;
	this.levelDebug               = data.levelDebug;
	this.characterDebug           = data.characterDebug;
};

/**
 * Save
 */
SavedData.prototype.save = function()
{
	console.log('save');
	var data =
	{
		coins                    : this.coins,
		levelsUnlocked           : this.levelsUnlocked,
		hasSeenIntro             : this.hasSeenIntro,
		hasSeenOutro             : this.hasSeenOutro,
		showUnlockedLevel        : this.showUnlockedLevel,
		showUnlockedCharacter    : this.showUnlockedCharacter,
		hasSeenTutorial          : this.hasSeenTutorial,
		charactersUnlocked       : this.charactersUnlocked,
		charactersPower          : this.charactersPower,
		goals                    : this.goals,
		dailyBonusDate           : this.dailyBonusDate,
		crystals                 : this.crystals,
		trolls                   : this.trolls,
		highscore                : this.highscore,
		lossStreak               : this.lossStreak,
		endGameMessage           : this.endGameMessage,
		levelDebug               : this.levelDebug,
		characterDebug           : this.characterDebug,
		promoShown               : this.promoShown,
		codesUsed                : this.codesUsed
	};

	var json = JSON.stringify(data);
	data.hash = md5(json + this.SAVE_SEED);

	window.localStorage[this.SAVE_NAME + "_" + this.SAVE_VERSION] = JSON.stringify(data);
};

/**
 * Return how many character have been unlocked
 * @returns {Number}
 */
SavedData.prototype.getUnlockedCharacterCount = function()
{
	var count = 0;

	for (var key in this.charactersUnlocked)
	{
		count += !!this.charactersUnlocked[key] ? 1 : 0;
	}

	return count;
};

/**
 * Return true if it's the first time the player plays today
 * @returns {Boolean}
 */
SavedData.prototype.canAwardDailyBonus = function()
{
	var date = new Date();

	if(this.dailyBonusDate == null)
	{
		this.awardDailyBonus(0);
	}

	return this.dailyBonusDate != null && this.dailyBonusDate != (date.getFullYear() + "_" + date.getMonth() + "_" + date.getDay());
}

/**
 * Award daily bonus points
 * @param {Number} amount
 */
SavedData.prototype.awardDailyBonus = function(amount)
{
	var date = new Date();

	this.coins += amount;
	this.dailyBonusDate = date.getFullYear() + "_" + date.getMonth() + "_" + date.getDay();

	this.save();
}

/**
 * Return the total amout of crystals collected
 * @returns {Number}
 */
SavedData.prototype.getCollectedCrystalCount = function()
{
	var count = 0;

	for(var level = 0; level < this.crystals.length; level++)
	{
		for(var key in this.crystals[level])
		{
			for(var i = 0; i < this.crystals[level][key].length; i++)
			{
				if(this.crystals[level][key][i])
					count++;
			}
		}
	}

	return count;
}

/**
 * Return the total amout of crystals that can be collected
 * @returns {Number}
 */
SavedData.prototype.getCrystalCount = function()
{
	var count = 0;

	for(var level = 0; level < this.crystals.length; level++)
	{
		for(var key in this.crystals[level])
		{
			count += this.crystals[level][key].length;
		}
	}

	return count;
}

/**
 * Return the total amout of crystals collected in a level by a character
 * @param {Number} level
 * @param {String} character
 * @returns {Number}
 */
SavedData.prototype.getLevelCharacterCrystalCount = function(level, character)
{
	var count = 0;

	if(!!this.crystals[level][character])
	{
		for(var crystal = 0; crystal < this.crystals[level][character].length; crystal++)
		{
			if(!!this.crystals[level][character][crystal]) count++;
		}
	}
	return count;
}

/**
 * Return true if a specific crystal has been collected
 * @param {Number} level
 * @param {String} character
 * @param {Number} index
 */
SavedData.prototype.isCrystalCollected = function(level, character, index)
{
	return this.crystals[level][character][index];
}

/**
 * Return the total amout of trolls collected
 * @returns {Number}
 */
SavedData.prototype.getCollectedTrollCount = function()
{
	var count = 0;

	for(var level = 0; level < this.trolls.length; level++)
	{
		for(var troll = 0; troll < this.trolls[level].length; troll++)
		{
			if(!!this.trolls[level][troll])
				count++;
		}
	}

	return count;
}

/**
 * Return the total amout of trolls that can be collected
 * @returns {Number}
 */
SavedData.prototype.getTrollCount = function()
{
	var count = 0;

	for(var level = 0; level < this.trolls.length; level++)
	{
		count += this.trolls[level].length;
	}

	return count;
}

/**
 * Return true if a specific troll has been collected
 * @param {Number} level
 * @param {Number} index
 */
SavedData.prototype.isTrollCollected = function(level, index)
{
	return this.trolls[level][index];
}

/**
 * Return the total amout of trolls collected
 * @param {Number} level
 * @returns {Number}
 */
SavedData.prototype.getLevelCollectedTrollCount = function(level)
{
	var count = 0;

	for(var troll = 0; troll < this.trolls[level].length; troll++)
	{
		if(!!this.trolls[level][troll])
			count++;
	}
	return count;
}


/**
 * Return the color assigned to a character
 * @param {String} character
 * @returns {String}
 */
SavedData.prototype.getColorByCharacter = function(character)
{
	var characterData = this._assetManager.getJSON("config").characters;
	return characterData[character].color;
}

/**
 * Return the character assigned to a color
 * @param {String} color
 * @returns {String}
 */
SavedData.prototype.getCharacterByColor = function(color)
{
	var data = this._assetManager.getJSON("config");
	for(var i = 0; i < data.playableCharacters.length; i++)
	{
		if(data.characters[data.playableCharacters[i]].color == color)
		{
			return data.playableCharacters[i];
		}
	}
}

/**
 * Save the highscore for the given level, if higher
 * @param {String} mode
 * @param {Number} score
 */
SavedData.prototype.recordHighscore = function(mode, score)
{
	if(!this.highscore[mode] || this.highscore[mode] < score)
	{
		this.highscore[mode] = score;
	}
}

/**
 * Return the highscore for the given level
 * @returns {Number}
 */
SavedData.prototype.getHighscore = function(mode)
{
	return !!this.highscore[mode] ? this.highscore[mode] : 0;
}

/**
 * Return if enough time has passed to show a promo and there are still promos to show
 * @returns {bool}
 */
SavedData.prototype.canShowPromo = function()
{
	return (Math.floor(Date.now() / 1000) > this.promoTime) && (this.getNewPromo() != null);
}

/**
 * Return if the given promo has been shown
 * @returns {bool}
 */
SavedData.prototype.hasShownPromo = function(promo)
{
	for(var i = 0; i < this.promoShown.length; i++)
	{
		if(promo.image == this.promoShown[i])
		{
			return true;
		}
	}
	return false;
}

/**
 * Return a promo that has not been shown yet
 * @returns {Object}
 */
SavedData.prototype.getNewPromo = function()
{
	for(var i = 0; i < this._assetManager.getJSON("strings").promos.length; i++)
	{
		if(!this.hasShownPromo(this._assetManager.getJSON("strings").promos[i][Common.COUNTRY_CODE]))
		{
			return this._assetManager.getJSON("strings").promos[i][Common.COUNTRY_CODE];
		}
	}
	return null;
}

/**
 * Set the given promo as shown
 * @param {Objects}
 */
SavedData.prototype.setPromoAsShown = function(promo)
{
	this.promoTime = Math.floor(Date.now() / 1000) + this._assetManager.getJSON("config").promo.time;
	Common.savedData.promoShown.push(promo.image);
}

/**
 * Return if the code is valid
 * @param {string}
 * @returns {bool}
 */
SavedData.prototype.isCodeValid = function(code)
{
	return !!this._assetManager.getJSON("config").codes[code];
}

/**
 * Return if the code has been redeemed
 * @param {string}
 * @returns {bool}
 */
SavedData.prototype.isCodeRedeemed = function(code)
{
	return this.codesUsed.indexOf(code) != -1;
}

/**
 * Set the given code as used
 * @param {string}
 */
SavedData.prototype.setCodeAsUsed = function(code)
{
	Common.savedData.codesUsed.push(code);
}

/**
 * Return a code's reward
 * @param {string}
 */
SavedData.prototype.getCodeValue = function(code)
{
	return parseInt(this._assetManager.getJSON("config").codes[code]);
}
},{"./Common":2}],8:[function(require,module,exports){
var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function BezierPath()
{
	this.points                = [];
	this.quadWidth             = 96;
	this.cacheDrawingPoints    = true;
	this._drawingPoints        = null;
	this._drawingPointsNormals = null;
}
module.exports = BezierPath;

/**
 *
 */
BezierPath.prototype.addPoint = function(x, y, index)
{
	if(!index)
		this.points.push({x:x, y:y});
	else
		this.points.splice(index, 0, {x:x, y:y})
}

/**
 *
 */
BezierPath.prototype.deletePoint = function(index)
{
	this.points.splice(index, 1);
}

/**
 *
 */
BezierPath.prototype.getFirstPoint = function()
{
	return this.points[0];
}

/**
 *
 */
BezierPath.prototype.getLastPoint = function()
{
	return this.points[this.points.length-1];
}

BezierPath.prototype.getPenultimatePoint = function()
{
	return this.points[this.points.length-2];
}

/**
 *
 */
BezierPath.prototype.getWidth = function()
{
	return this.getLastPoint().x - this.getFirstPoint().x;
}

/**
 *
 */
BezierPath.prototype.calculateBezierPoint = function(t, p0, p1, p2, p3)
{
	var u   = 1 - t;
	var tt  = t*t;
	var uu  = u*u;
	var uuu = uu * u;
	var ttt = tt * t;

	p = {x: uuu * p0.x, y: uuu * p0.y}; //first term
	p.x += 3 * uu * t * p1.x; //second term
	p.y += 3 * uu * t * p1.y;
	p.x += 3 * u * tt * p2.x; //third term
	p.y += 3 * u * tt * p2.y;
	p.x += ttt * p3.x; //fourth term
	p.y += ttt * p3.y;

	return p;
}

/**
 *
 */
BezierPath.prototype.getDrawingPoints = function()
{
	if(this.cacheDrawingPoints && this._drawingPoints != null) return this._drawingPoints;

	this._drawingPoints = [];
	for(var i = 0; i < this.points.length - 3; i+=3)
    {
		var p0 = this.points[i];
		var p1 = this.points[i + 1];
		var p2 = this.points[i + 2];
		var p3 = this.points[i + 3];

		var tentativeLength = Math.sqrt(Math.pow(p0.x  - p3.x, 2) + Math.pow(p0.y - p3.y, 2));
		var nSegments       = Math.ceil(tentativeLength/this.quadWidth);

		if(i == 0) // First endpoint
		{
			this._drawingPoints.push(this.calculateBezierPoint(0, p0, p1, p2, p3));
		}

		for(var j = 1; j <= nSegments; j++)
		{
			var t = j / nSegments;
			this._drawingPoints.push(this.calculateBezierPoint(t, p0, p1, p2, p3));
		}
	}

	return this._drawingPoints;
}

/**
 *
 */
BezierPath.prototype.getDrawingPointsNormals = function()
{
	if(this.cacheDrawingPoints && this._drawingPointsNormals != null) return this._drawingPointsNormals;

	var drawingPoints = this.getDrawingPoints();

	this._drawingPointsNormals = [];

	for(var i = 1; i < drawingPoints.length - 1; i++)
	{
		var prevPoint = drawingPoints[i-1];
		var nextPoint = drawingPoints[i+1];
		var line = {x:nextPoint.x - prevPoint.x, y:nextPoint.y - prevPoint.y};
		var perp = {x:-line.y, y:line.x};
		var perpLength = Math.sqrt(perp.x * perp.x + perp.y * perp.y);
		var perpNorm = {x: perp.x/perpLength, y: perp.y/perpLength};
		this._drawingPointsNormals[i] = perpNorm;
	}

	// TODO: can be improved
	this._drawingPointsNormals[0] = {x:0, y:1};
	this._drawingPointsNormals[drawingPoints.length-1] = {x:0, y:1};

	return this._drawingPointsNormals;
}


BezierPath.prototype.getGroundSegments = function(minAngle, maxAngle)
{
	var segments = [];
	var segment  = null;

	var drawingPoints        = this.getDrawingPoints();
	var drawingPointsNormals = this.getDrawingPointsNormals();

	for(var i = 0; i < drawingPoints.length - 1; i++)
	{
		 var angle = Math.abs(Math.atan2(drawingPoints[i+1].y - drawingPoints[i].y, drawingPoints[i+1].x - drawingPoints[i].x) * PIXI.RAD_TO_DEG);

		 if(angle < minAngle || angle > maxAngle)
		 {
			 if(segment == null) continue;
			 segments.push(segment);
			 segment = null;
		 }
		 else
		 {
			 if(segment == null)
			 {
				 segment =
				 {
					 points  : [drawingPoints[i]],
					 normals : [drawingPointsNormals[i]]
				 }
			 }
			 segment.points.push(drawingPoints[i+1]);
			 segment.normals.push(drawingPointsNormals[i+1]);
		 }
	}

	if(segment != null)
	{
		segments.push(segment);
	}

	for(var i = 0; i < segments.length; i++)
	{
		if(segments[i].normals.length > 2)
		{
			segments[i].normals[0] = segments[i].normals[1];
			segments[i].normals[segments[i].normals.length-1] = segments[i].normals[segments[i].normals.length-2];
			// segments[i].normals[0] = {x:0, y:1};
			// segments[i].normals[segments[i].normals.length-1] = {x:0, y:1};
		}
	}

	return segments;
}


},{"../Common":2}],9:[function(require,module,exports){
var Common     = require("../Common");
var Level      = require("../editor/Level");
var LevelLayer = require("../editor/LevelLayer");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Editor()
{
	PIXI.Container.call(this);
	this.assetManager = p3.AssetManager.instance;

	// Level list
	this.levels = [];
	this.level  = null;

	// Grid
	this.snapGrid = 16;
	this.grid     = null;

	// Panning
	this.cmb = false;
	this.panMousePosition = null;

	// Config
	this.config = this.assetManager.getJSON("editorConfig");
	var side = 33;

	for(var i = 0; i < this.config.objects.length; i++)
	{
		var sprite = new PIXI.Sprite(this.assetManager.getTexture(this.config.objects[i].texture));
		var scale  = Math.min(1/(sprite.width/side), 1/(sprite.height/side));

		var texture = new PIXI.RenderTexture(Common.renderer, side, side);

			var matrix = new PIXI.Matrix();
			matrix.translate(sprite.width < sprite.height ? (sprite.height - sprite.width)/2 : 1, sprite.height < sprite.width ? (sprite.width - sprite.height)/2 : 1);
			matrix.scale(scale, scale);
			texture.render(sprite, matrix);

		this.config.objects[i].textureBase64 = texture.getBase64();
	}

	// History
	this.history    = [];
	this.historyIndex = 0;

	// Test
	this.character = "anna";

	// Gui
	this.gui =
	{
		selector       : "#controls",
		levelTemplate  : _.template($("#template-level").html(),  {variable: 'editor'}),
		layerTemplate  : _.template($("#template-layer").html(),  {variable: 'editor'}),
		pathTemplate   : _.template($("#template-path").html(),   {variable: 'editor'}),
		objectTemplate : _.template($("#template-object").html(), {variable: 'editor'})
	}
}
module.exports = Editor;
Editor.prototype = Object.create(PIXI.Container.prototype);
Editor.prototype.constructor = Editor;

/**
 * TODO
 */
Editor.prototype.init = function()
{
	this.renderGrid();

	this.newLevel();

	// Zoom
	document.addEventListener("mousewheel", function(e)
	{
		if($('#canvas:hover').length != 0)
		{
			this.zoomDelta(-0.05 * Math.sign(e.wheelDelta));
		}
	}.bind(this), false);

	// Save/Load
	$("body").on("click", ".level_new", function(e)
	{
		this.newLevel();
	}.bind(this));

	$("body").on("click", ".level_export", function(e)
	{
		this.export();
	}.bind(this));

	$("body").on("click", ".level_import", function(e)
	{
		this.load($("textarea[name=level_import_text]").val());
	}.bind(this));

	// $("#level_import").on("change", function(e)
	// {
		// var location = $(e.currentTarget).val();
		// console.log(readTextFile(location));
	// }.bind(this));

	// Export image
	$("body").on("click", ".level_image", function(e)
	{
		var base64 = this.level.toImage();
		if(!!base64)
		{
			var win = window.open(base64, 'level_image');
			win.focus();
		}
	}.bind(this));

	// Level debug
	$("body").on("change", "select[name=level_character]", function(e)
	{
		this.character = $(e.currentTarget).val();
	}.bind(this));

	$("body").on("click", ".level_debug", function(e)
	{
		Common.savedData.characterDebug = this.character;
		Common.savedData.levelDebug = JSON.stringify(this.level.export());
		Common.savedData.save();

		var win = window.open("index.html", 'level_debug');
		win.focus();
	}.bind(this));

	// Level
	$("body").on("change", "input[name=level_name]", function(e)
	{
		this.level.setName($(e.currentTarget).val());
		$("textarea[name=level_import_text]").val(JSON.stringify(this.level.export()));

	}.bind(this));

	$("body").on("click", ".new_layer", function(e)
	{
		this.level.newLayer();
	}.bind(this));

	$("body").on("click", ".edit_layer", function(e)
	{
		var index = parseInt($(e.currentTarget).attr("data-index"));
		this.level.selectLayer(this.level.getLayerAtIndex(index));
	}.bind(this));

	$("body").on("click", ".back", function(e)
	{
		this.back();
	}.bind(this));


	// Layer
	$("body").on("change", "input[name=layer_name]", function(e)
	{
		this.level.layer.setName($(e.currentTarget).val());
	}.bind(this));

	$("body").on("click", ".delete_layer", function(e)
	{
		this.level.deleteLayer(this.level.layer);
		this.back();
	}.bind(this));

	$("body").on("change", "input[name=layer_depth]", function(e)
	{
		this.level.layer.setDepth(parseInt($(e.currentTarget).val()));
		this.render();
	}.bind(this));

	$("body").on("click", ".objects li:not(.selected)", function(e)
	{
		$(".objects li.selected").removeClass("selected");
		// this.level.layer.idObject = $(e.currentTarget).attr("data-id");
		this.level.layer.setIdObject($(e.currentTarget).attr("data-id"));
		$(e.currentTarget).addClass("selected");
	}.bind(this));

	// Path
	$("body").on("change", "select[name=path_open]", function(e)
	{
		this.level.layer.selected.setConfig("closed", !parseInt($(e.currentTarget).val()), e.type == "change");
		this.render();
	}.bind(this));

	$("body").on("click", ".delete_path", function(e)
	{
		this.level.layer.deletePath(this.level.layer.selected);
		this.back();
	}.bind(this));

	$("body").on("change", "input[name=path_depth], input[name=object_depth]", function(e)
	{
		this.level.layer.setSelectedDepth(parseInt($(e.currentTarget).val()));
		this.render();
	}.bind(this));

	$("body").on("change", "select[name=path_collisions]", function(e)
	{
		this.level.layer.selected.setConfig("collisions", parseInt($(e.currentTarget).val()), e.type == "change");
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_walls_angle]", function(e)
	{
		this.level.layer.selected.setConfig("texWallAngle", parseInt($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_fill_size]", function(e)
	{
		this.level.layer.selected.setConfig("texFillSize", parseInt($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_fill_padding]", function(e)
	{
		this.level.layer.selected.setConfig("texFillPadding", parseInt($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_ground_size]", function(e)
	{
		this.level.layer.selected.setConfig("texGroundSize", parseInt($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_ground_delta]", function(e)
	{
		this.level.layer.selected.setConfig("texGroundDelta", parseFloat($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_walls_size]", function(e)
	{
		this.level.layer.selected.setConfig("texWallSize", parseInt($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "input[name=path_texture_walls_delta]", function(e)
	{
		this.level.layer.selected.setConfig("texWallDelta", parseFloat($(e.currentTarget).val()), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change", "select[name=path_texture_fill]", function(e)
	{
		this.level.layer.selected.setConfig("texFill", $(e.currentTarget).val(), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change", "select[name=path_texture_ground]", function(e)
	{
		this.level.layer.selected.setConfig("texGround", $(e.currentTarget).val(), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change", "select[name=path_texture_ground_edge]", function(e)
	{
		this.level.layer.selected.setConfig("texGroundEdge", $(e.currentTarget).val(), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change", "select[name=path_texture_ground_edge_side]", function(e)
	{
		this.level.layer.selected.setConfig("texGroundEdgeSide", $(e.currentTarget).val(), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change", "select[name=path_texture_wall]", function(e)
	{
		this.level.layer.selected.setConfig("texWall", $(e.currentTarget).val(), e.type == "change");
		this.level.layer.selected.render();
	}.bind(this));

	$("body").on("change input", "textarea[name=path_data], textarea[name=object_data]", function(e)
	{
		this.level.layer.selected.setConfig("data", $(e.currentTarget).val(), e.type == "change");
		// if(e.type == "change")
			// this.render();
	}.bind(this));

	// Object
	$("body").on("click", ".delete_object", function(e)
	{
		this.level.layer.deleteObject(this.level.layer.selected);
		this.back();
	}.bind(this));

	$("body").on("change input", "input[name=object_scale]", function(e)
	{
		this.level.layer.selected.setScale(parseFloat($(e.currentTarget).val()), e.type == "change");
	}.bind(this));

	$("body").on("change input", "input[name=object_rotation]", function(e)
	{
		this.level.layer.selected.setRotation(parseFloat($(e.currentTarget).val()), e.type == "change");
	}.bind(this));

	// Make range input lose focus after change
	$("body").on("change", "input[type=range]", function(e)
	{
		$(this).blur();
	});
}

/**
 * TODO
 */
Editor.prototype.update = function()
{
	// Pan
	if(this.mouse.centerPressed)
	{
		if(!this.cmb)
		{
			this.cmb = true;
			this.panMousePosition = new PIXI.Point(this.mouse.position.x, this.mouse.position.y);
		}
		else
		{
			this.level.x += (this.mouse.position.x - this.panMousePosition.x) *  (1/this.scale.x);
			this.level.y += (this.mouse.position.y - this.panMousePosition.y) *  (1/this.scale.y);
			this.panMousePosition = new PIXI.Point(this.mouse.position.x, this.mouse.position.y);

			this.updateGridPosition();
		}
	}
	else if(this.cmb)
	{
		this.cmb = false;
	}

	// Level update
	if(this.level != null)
	{
		if(
			(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_CTRL) && Common.keyboard.getKeyPressed(Common.keyboard.KEY_Z) && Common.keyboard.getKeyPressed(Common.keyboard.KEY_SHIFT)) ||
			(Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_Z) && Common.keyboard.getKeyPressed(Common.keyboard.KEY_SHIFT)) ||
			(Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && Common.keyboard.getKeyPressed(Common.keyboard.KEY_Z) && Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_SHIFT)))
		{
			this.historyRedo();
		}
		else if(
			(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_CTRL) && Common.keyboard.getKeyPressed(Common.keyboard.KEY_Z)) ||
			(Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_Z)))
		{
			this.historyUndo();
		}


		this.level.update();
	}
}

/**
 * TODO
 */
Editor.prototype.updateGridPosition = function()
{
	this.grid.tilePosition = new PIXI.Point(this.level.x % this.snapGrid, this.level.y % this.snapGrid);
}

/**
 * TODO
 */
Editor.prototype.render = function()
{
	if(this.level == null) return;

	this.level.render();
	this.level.renderGUI();
}

/**
 * TODO
 */
Editor.prototype.getMousePosition = function()
{
	return new PIXI.Point
	(
		Common.STAGE_WIDTH/2  + ((this.mouse.position.x - Common.STAGE_WIDTH/2)/this.scale.x)  - this.level.x,
		Common.STAGE_HEIGHT/2 + ((this.mouse.position.y - Common.STAGE_HEIGHT/2)/this.scale.y) - this.level.y
	);
}

/**
 * TODO
 */
Editor.prototype.zoomDelta = function(deltaZoom)
{
	if(this.scale.x - deltaZoom < 0.01) return;

	var oldWidth = Common.STAGE_WIDTH * this.scale.x;
	var oldHeight = Common.STAGE_HEIGHT * this.scale.y;

	this.scale = new PIXI.Point(this.scale.x - deltaZoom, this.scale.y - deltaZoom);

	var newWidth = Common.STAGE_WIDTH * this.scale.x;
	var newHeight = Common.STAGE_HEIGHT * this.scale.y;

	this.x += (oldWidth - newWidth) /2;
	this.y += (oldHeight - newHeight) /2;
}

/**
 * TODO
 */
Editor.prototype.renderGUI = function(what)
{
	switch(what)
	{
		case "level":
			var html = this.gui.levelTemplate(this);
			break;
		case "layer":
			var html = this.gui.layerTemplate(this);
			break;
		case "path":
			var html = this.gui.pathTemplate(this);
			break;
		case "object":
			var html = this.gui.objectTemplate(this);
			break;
		default:
			console.error("GUI level not found");
			break;
	}

	$(this.gui.selector).html(html);
}

/**
 * TODO
 */
Editor.prototype.back = function(what)
{
	if(!this.level) return;

	this.level.back();
	this.render();
}

/**
 * TODO
 */
Editor.prototype.renderGrid = function()
{
	// BG
	var canvas = document.createElement('canvas');
	canvas.width  = this.snapGrid;
	canvas.height = this.snapGrid;
	var ctx = canvas.getContext("2d");

	ctx.beginPath();
	ctx.strokeStyle = "#666666";
	ctx.lineWidth = 1;
	ctx.moveTo(0,0);
	ctx.lineTo(0,this.snapGrid);
	ctx.lineTo(this.snapGrid,this.snapGrid);
	ctx.stroke();

	this.grid   = new PIXI.extras.TilingSprite(PIXI.Texture.fromCanvas(canvas), this.snapGrid, this.snapGrid);
	this.grid.x = Common.STAGE_WIDTH/2;
	this.grid.y = Common.STAGE_HEIGHT/2;
	this.grid.anchor = new PIXI.Point(0.5, 0.5);
	this.grid.width  = Common.STAGE_WIDTH * 2;
	this.grid.height = Common.STAGE_HEIGHT * 2;
	this.addChild(this.grid);
}

/**
 * TODO
 */
Editor.prototype.newLevel = function()
{
	if(this.level != null)
	{
		this.removeChild(this.level);
	}

	var level = new Level(this);
	this.level = level;
	this.level.init();
	this.levels.push(level);
	this.addChild(this.level);

	this.render();

	// Update panMousePosition
	this.updateGridPosition();

	// Reset history
	this.historyReset();
}

/**
 * TODO
 */
Editor.prototype.getObject = function(id)
{
	for(var i = 0; i < this.config.objects.length ; i++)
	{
		if(this.config.objects[i].id == id)
		{
			return this.config.objects[i];
		}
	}

	return null;
}

/**
 * TODO
 */
// Editor.prototype.save = function()
// {
	// var json = JSON.stringify(this.level.export());
	// return json;
// }

/**
 * TODO
 */
Editor.prototype.load = function(json)
{
	var save = JSON.parse(json);

	this.newLevel();
	this.level.import(save);
	this.render();
}


// function readTextFile(file)
// {
    // var rawFile = new XMLHttpRequest();
    // rawFile.open("GET", file, false);
    // rawFile.onreadystatechange = function ()
    // {
        // if(rawFile.readyState === 4)
        // {
            // if(rawFile.status === 200 || rawFile.status == 0)
            // {
                // var allText = rawFile.responseText;
                // alert(allText);
            // }
        // }
    // }
    // rawFile.send(null);
// }

/**
 * TODO
 */
Editor.prototype.import = function()
{
	$("#level_import").replaceWith($("#level_import").val('').clone(true));
	$("#level_import").trigger("click");
}

/**
 * TODO
 */
Editor.prototype.export = function()
{
	var json = JSON.stringify(this.level.export());
	var filename = this.level.name + "_" + Math.floor(Date.now() / 1000) + ".json";

	var element = document.createElement('a');
	element.setAttribute('href', 'data:application/json;charset=utf-8,' + encodeURIComponent(json));
	element.setAttribute('download', filename);

	element.style.display = 'none';
	document.body.appendChild(element);

	element.click();

	document.body.removeChild(element);
}




/**
 * TODO
 */
Editor.prototype.historyReset = function()
{
	console.info("Resetting history");
	this.history = [JSON.stringify(this.level.export())];
	this.historyIndex = 0;
}

/**
 * TODO
 */
Editor.prototype.historyAddState = function()
{
	var state = JSON.stringify(this.level.export());

	// Remove future exports
	if(this.historyIndex < this.history.length -1)
	{
		this.history.splice(this.historyIndex+1, 10000);
	}

	if(state != this.history[this.history.length-1])
	{
		this.history.push(state);
		this.historyIndex++;

		console.info("Add state %i", this.historyIndex);
	}
}

/**
 * TODO
 */
Editor.prototype.historyUndo = function()
{
	if(this.historyIndex == 0) return;

	this.historyIndex--;

	console.info("Undo state %i", this.historyIndex);
	this.historyRestore();
}

/**
 * TODO
 */
Editor.prototype.historyRedo = function()
{
	if(this.historyIndex == this.history.length-1) return;

	this.historyIndex++;

	console.info("Redo state %i", this.historyIndex);
	this.historyRestore();
}

/**
 * TODO
 */
Editor.prototype.historyRestore = function()
{
	this.level.reset();
	this.level.import(JSON.parse(this.history[this.historyIndex]));
	this.render();
}
},{"../Common":2,"../editor/Level":10,"../editor/LevelLayer":11}],10:[function(require,module,exports){
var Common     = require("../Common");
var LevelLayer = require("../editor/Editor");
var LevelLayer = require("../editor/LevelLayer");

//===================================================
// CONSTRUCTOR
//===================================================


/**
 * @constructor
 */
function Level(editor)
{
	this.editor = editor;
	this.name   = "New level";
	this.layers = [];
	this.layer  = null;

	this.lmb = false;
	this.rmb = false;
	this.dragMovement = null;

	PIXI.Container.call(this);
}
module.exports = Level;
Level.prototype = Object.create(PIXI.Container.prototype);
Level.prototype.constructor = Level;

/**
 * TODO
 */
Level.prototype.init = function()
{
	// Focus
	this.x = Common.STAGE_WIDTH/4;
	this.y = Common.STAGE_HEIGHT/2

	this.startingPoint = new PIXI.Graphics();
	this.startingPoint.beginFill(0x00ff00);
	this.startingPoint.drawCircle(0, 0, 5);
	this.startingPoint.endFill();
	this.addChild(this.startingPoint);
}

/**
 * TODO
 */
Level.prototype.reset = function()
{
	for(var i = this.children.length-1; i >= 0; i--)
	{
		this.removeChild(this.children[i]);
	}

	this.addChild(this.startingPoint);

	this.layers = [];
	this.layer  = null;
}

/**
 * TODO
 */
Level.prototype.update = function()
{
	if(this.layer != null)
	{
		this.layer.update();
	}
	else
	{
		// Right Click: move everything
		if(this.editor.mouse.rightPressed)
		{
			var mousePosition = this.editor.getMousePosition();

			if(!this.rmb)
			{
				this.rmb = true;
				this.dragMovement = new PIXI.Point(0,0);
			}
			else
			{
				// Restore the old position to make an accurate snapping
				for(var i = 0; i < this.layers.length; i++)
				{
					this.layers[i].moveAll(new PIXI.Point(-this.dragMovement.x, -this.dragMovement.y));
				}

				// Move paths and objects to the closest snap point
				var mouseMovement = this.editor.mouse.movement;
				mouseMovement.multiply(1/this.editor.scale.x);

				this.dragMovement.x += mouseMovement.x;
				this.dragMovement.y += mouseMovement.y;

				for(var i = 0; i < this.layers.length; i++)
				{
					this.layers[i].moveAll(new PIXI.Point(this.dragMovement.x, this.dragMovement.y));
					this.layers[i].render();
				}
			}
		}
		else if(this.rmb)
		{
			this.rmb = false;
			this.renderGUI();

			// Add history state
			this.editor.historyAddState();
		}
	}
}

/**
 * TODO
 */
Level.prototype.render = function()
{
	for(var i = 0; i < this.layers.length; i++)
	{
		this.layers[i].render();
	}
}

/**
 * TODO
 */
Level.prototype.renderGUI = function()
{
	if(!!this.layer)
		this.layer.renderGUI();
	else
		this.editor.renderGUI("level");
}

/**
 * TODO
 */
Level.prototype.back = function(what)
{
	if(!!this.layer)
	{
		this.layer.back();
	}
}

/**
 * TODO
 */
Level.prototype.newLayer = function(name)
{
	this.layer = new LevelLayer(this, name);
	this.layers.push(this.layer);
	this.layer.init();
	this.addChild(this.layer);
	this.selectLayer(this.layer);

	// History
	this.editor.historyAddState();
}

/**
 * TODO
 */
Level.prototype.deleteLayer = function(layer)
{
	var index = this.layers.indexOf(layer);
	if (index > -1)
	{
		this.removeChild(this.layers[index]);
		this.layers.splice(index, 1);

		// History
		this.editor.historyAddState();
	}
}

/**
 * TODO
 */
Level.prototype.selectLayer = function(layer)
{
	this.layer = layer;
	this.render();
	this.renderGUI();
}

/**
 * TODO
 */
Level.prototype.getLayerAtIndex = function(index)
{
	return !!this.layers[index] ? this.layers[index] : null
}

/**
 * TODO
 */
Level.prototype.export = function()
{
	var output =
	{
		name   : this.name,
		layers : [],
		length : this.getLength()
	}

	for(var i = 0; i < this.layers.length; i++)
	{
		output.layers.push(this.layers[i].export());
	}

	return output;
}

/**
 * TODO
 */
Level.prototype.getLength = function()
{
	for(var i = 0; i < this.layers.length; i++)
	{
		for(var o = 0; o < this.layers[i].objects.length; o++)
		{
			if(this.layers[i].objects[o].config.id == "level_end")
			{
				return  Math.round(this.layers[i].objects[o].x - this.layers[i].objects[o].width);
			}
		}
	}
	return 0;
}

/**
 * TODO
 */
Level.prototype.getBounds = function()
{
	var x0 = 0;
	var x1 = 0;
	var y0 = 0;
	var y1 = 0;


	for(var i = 0; i < this.layers.length; i++)
	{
		for(var o = 0; o < this.layers[i].paths.length; o++)
		{
			for(var p = 0; p < this.layers[i].paths[o].bezier.points.length; p++)
			{
				if(this.layers[i].paths[o].bezier.points[p].x < x0)      x0 = this.layers[i].paths[o].bezier.points[p].x;
				else if(this.layers[i].paths[o].bezier.points[p].x > x1) x1 = this.layers[i].paths[o].bezier.points[p].x;
				if(this.layers[i].paths[o].bezier.points[p].y < y0)      y0 = this.layers[i].paths[o].bezier.points[p].y;
				else if(this.layers[i].paths[o].bezier.points[p].y > y1) y1 = this.layers[i].paths[o].bezier.points[p].y;
			}
		}
	}

	return [x0, y0, x1, y1];
}

/**
 * TODO
 */
Level.prototype.setName  = function(name)
{
	name = $.trim(name);
	if(name == "") return;

	this.name = name;

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
Level.prototype.import = function(save)
{
	this.name = save.name;

	for(var i = 0; i < save.layers.length; i++)
	{
		var layer = new LevelLayer(this, "");
		layer.import(save.layers[i]);
		this.layers.push(layer);
		this.addChild(layer);
	}
}

/**
 * TODO
 */
Level.prototype.toImage = function()
{
	var bounds = this.getBounds();
	if(bounds[2] == bounds[0]) return;

	// Add some padding
	bounds[0] -= 128;
	bounds[1] -= 256;
	bounds[2] += 128;
	bounds[3] += 256;

	var width  = bounds[2]-bounds[0];
	var height = bounds[3]-bounds[1];

	// Set the scale so it doesn't exceed a certain width
	var scale = Math.min(0.5, 8000/width);

	// Render
	var renderTexture = new PIXI.RenderTexture(Common.renderer, width*scale, height*scale);

	for(var i = 0; i < this.layers.length; i++)
	{
		this.layers[i].moveAll(new PIXI.Point(-bounds[0], -bounds[1]));
		this.layers[i].scale.set(scale)
		this.layers[i].render();
	}

	renderTexture.render(this);

	for(var i = 0; i < this.layers.length; i++)
	{
		this.layers[i].moveAll(new PIXI.Point(bounds[0], bounds[1]));
		this.layers[i].scale.set(1)
		this.layers[i].render();
	}

	// Return a base64 string of the texture
	var img = renderTexture.getBase64();
	return img;
}
},{"../Common":2,"../editor/Editor":9,"../editor/LevelLayer":11}],11:[function(require,module,exports){
var Common      = require("../Common");
var Editor      = require("../editor/Editor");
var Level       = require("../editor/Level");
var LevelPath   = require("../editor/LevelPath");
var LevelObject = require("../editor/LevelObject");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelLayer(level, name)
{
	this.editor  = level.editor;
	this.level   = level;
	this.name    = !!name ? name : "New layer #" + (this.level.layers.length+1);
	this.paths   = [];
	this.objects = [];
	this.depth   = 0;

	this.idObject = "";
	this.selected = null;

	this.lmb = false;
	this.rmb = false;
	this.dragMovement = null;

	PIXI.Container.call(this);
}
module.exports = LevelLayer;
LevelLayer.prototype = Object.create(PIXI.Container.prototype);
LevelLayer.prototype.constructor = LevelLayer;

/**
 * TODO
 */
LevelLayer.prototype.init = function()
{
}

/**
 * TODO
 */
LevelLayer.prototype.update = function()
{
	if(this.selected != null)
	{
		this.selected.update();
	}
	else
	{
		// Left click: select path or object
		if(this.editor.mouse.leftPressed)
		{
			var mousePosition = this.editor.getMousePosition();


			if(!this.lmb)
			{
				this.lmb = true;

				var obj = this.getObjectAtPoint(mousePosition);

				if(obj != null)
				{
					this.selectObject(obj);
				}
				else
				{
					var path = this.getPathAtPoint(mousePosition, 50);

					if(path != null)
					{
						this.selectObject(path);
					}
					else
					{
						if(this.idObject == "")
						{
							this.newPath(mousePosition);
						}
						else
						{
							this.newObject(this.idObject, mousePosition);
						}
					}
				}
			}
		}
		else if(this.lmb)
		{
			this.lmb = false;
		}

		// Right Click: move everything
		if(this.editor.mouse.rightPressed)
		{
			var mousePosition = this.editor.getMousePosition();

			if(!this.rmb)
			{
				this.rmb = true;
				this.dragMovement = new PIXI.Point(0,0);
			}
			else
			{
				// Restore the old position to make an accurate snapping
				this.moveAll(new PIXI.Point(-this.dragMovement.x, -this.dragMovement.y));

				// Move paths and objects to the closest snap point
				var mouseMovement = this.editor.mouse.movement;
				mouseMovement.multiply(1/this.editor.scale.x);

				this.dragMovement.x += mouseMovement.x;
				this.dragMovement.y += mouseMovement.y;

				this.moveAll(new PIXI.Point(this.dragMovement.x, this.dragMovement.y));

				this.render();
			}
		}
		else if(this.rmb)
		{
			this.rmb = false;

			// Add history state
			this.editor.historyAddState();
		}
	}

	var inputFocus = $("input:focus, textarea:focus").length > 0;
}

/**
 * TODO
 */
LevelLayer.prototype.render = function()
{
	// Find the minimum and maximum depth values
	var minDepth = 0;
	var maxDepth = 0;

	for(var i = 0; i < this.paths.length; i++)
	{
		this.removeChild(this.paths[i]);
		minDepth = Math.min(this.paths[i].config.depth, minDepth);
		maxDepth = Math.max(this.paths[i].config.depth, maxDepth);
	}

	for(var i = 0; i < this.objects.length; i++)
	{
		this.removeChild(this.objects[i]);
		minDepth = Math.min(this.objects[i].config.depth, minDepth);
		maxDepth = Math.max(this.objects[i].config.depth, maxDepth);
	}

	// Render the objects and paths in order
	for(var depth = minDepth; depth <= maxDepth; depth++)
	{
		for(var i = 0; i < this.paths.length; i++)
		{
			if(this.paths[i].config.depth != depth) continue;
			this.addChild(this.paths[i]);
			this.paths[i].render();
		}

		for(var i = 0; i < this.objects.length; i++)
		{
			if(this.objects[i].config.depth != depth) continue;
			this.addChild(this.objects[i]);
			this.objects[i].render();
		}
	}

	// If this is not the current layers, fade it
	if(this.level.layer != null && this.level.layer != this)
		this.alpha = 0.5;
	else
		this.alpha = 1;
}

/**
 * TODO
 */
LevelLayer.prototype.renderGUI = function()
{
	if(!!this.selected)
		this.selected.renderGUI();
	else
		this.editor.renderGUI("layer");
}

/**
 * TODO
 */
LevelLayer.prototype.back = function(what)
{
	if(!!this.selected)
		this.selected.back();
	else
	{
		this.level.layer = null;
		this.idObject = "";

		// Add history state
		this.editor.historyAddState();
	}
}

/**
 * TODO
 */
LevelLayer.prototype.setIdObject = function(id)
{
	if(this.level.layer.idObject == id) return;

	this.level.layer.idObject = id;

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelLayer.prototype.selectObject = function(obj)
{
	this.selected = obj;
	this.render();
	this.renderGUI();

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelLayer.prototype.newObject = function(id, point)
{
	var objDB = this.editor.getObject(id);
	if(objDB == null) return;

	// Create new object
	var obj = new LevelObject(this);
	obj.init(objDB);
	obj.x = point.x;
	obj.y = point.y;
	this.objects.push(obj);
	this.addChild(obj);

	// Select it
	this.selectObject(obj);
}

/**
 * TODO
 */
LevelLayer.prototype.newPath = function(point)
{
	// Create new path
	var path = new LevelPath(this);
	path.init();
	path.addPoint(point.x, point.y);
	this.paths.push(path);
	this.addChild(path);

	// Select it
	this.selectObject(path);

	// History
	this.editor.historyAddState();
}


/**
 * TODO
 */
LevelLayer.prototype.deleteObject = function(obj)
{
	var index = this.objects.indexOf(obj);
	if (index > -1)
	{
		this.removeChild(this.objects[index]);
		this.objects.splice(index, 1);

		// History
		this.editor.historyAddState();
	}
}

/**
 * TODO
 */
LevelLayer.prototype.deletePath = function(path)
{
	var index = this.paths.indexOf(path);
	if (index > -1)
	{
		this.removeChild(this.paths[index]);
		this.paths.splice(index, 1);

		// History
		this.editor.historyAddState();
	}
}

/**
 * TODO
 */
LevelLayer.prototype.moveAll = function(v)
{
	for(var i = 0; i < this.paths.length; i++)
	{
		this.paths[i].move
		(
			Math.round(v.x/this.editor.snapGrid) * this.editor.snapGrid,
			Math.round(v.y/this.editor.snapGrid) * this.editor.snapGrid
		)
	}

	for(var i = 0; i < this.objects.length; i++)
	{
		this.objects[i].x += Math.round(v.x/this.editor.snapGrid) * this.editor.snapGrid;
		this.objects[i].y += Math.round(v.y/this.editor.snapGrid) * this.editor.snapGrid;
	}
}


/**
 * TODO
 */
LevelLayer.prototype.getObjectAtPoint  = function(point)
{
	var obj = null;

	for(var i = this.objects.length-1; i >= 0; i--)
	{
		if(this.objects[i].isPointInside(point) && (obj == null || obj.depth < this.objects[i].depth))
		{
			obj = this.objects[i];
		}
	}

	return obj;
}

/**
 * TODO
 */
LevelLayer.prototype.getPathAtPoint  = function(point, maxDistance)
{
	var path     = null;
	var distance = null;

	/*
	if(this.wireframe)
	{
		this.removeChild(this.wireframe);
	}
	this.wireframe = new PIXI.Graphics();
	this.addChild(this.wireframe);
	*/

	for(var i = 0; i < this.paths.length; i++)
	{
		var points = this.paths[i].bezier.getDrawingPoints();

		for(var p = 0; p < points.length-1; p++)
		{
			// Segment of the bezier curve
			var segment = new PIXI.Point(points[p+1].x - points[p].x, points[p+1].y - points[p].y);

			// Normalized segment
			var segmentNormalized = new PIXI.Point(segment.x, segment.y);
			segmentNormalized.normalize();

			// Mouse vector, starts from the first point of the segment
			var vMouse = new PIXI.Point(point.x - points[p].x, point.y - points[p].y);

			// Calculate the projection of vMouse onto the segment
			var vProjLength = vMouse.dotProduct(segment) / segment.getLength();
			var vProj       = new PIXI.Point(segmentNormalized.x * vProjLength, segmentNormalized.y * vProjLength);

			// Calculate the distance
			if(((vProj.x/segment.x < 0 || vProj.x/segment.x > 1) && (vProj.x != segment.x)) || (vProj.y/segment.y < 0 || vProj.y/segment.y > 1))
			{
				// If the projection doens't end on the segment vector, calculate the distance between the segment's ends
				var v1 = new PIXI.Point(point.x - points[p].x,   point.y - points[p].y);
				var v2 = new PIXI.Point(point.x - points[p+1].x, point.y - points[p+1].y);
				var currentDistance = Math.min(v1.getLength(), v2.getLength());

				/*
				var index = v1.getLength() < v2.getLength() ? 0 : 1;
				this.wireframe.lineStyle(2, 0x00ff00, 1);
				this.wireframe.moveTo(points[p+index].x, points[p+index].y);
				this.wireframe.lineTo(x, y);
				*/
			}
			else
			{
				// Calculating the perpendicular of the segment ending on the the mouse position
				var perp  = new PIXI.Point(vMouse.x - vProj.x, vMouse.y - vProj.y);
				var currentDistance = perp.getLength();

				/*
				this.wireframe.lineStyle(2, 0x00ff00, 1);
				this.wireframe.moveTo(points[p].x + vProj.x, points[p].y + vProj.y);
				this.wireframe.lineTo(points[p].x + vProj.x + perp.x, points[p].y + vProj.y + perp.y);
				*/
			}

			if((path == null || distance > currentDistance) && (currentDistance < maxDistance))
			{
				path = this.paths[i];
				distance = currentDistance;
			}

			/*
			this.wireframe.lineStyle(2, 0xff0000, 1);
			this.wireframe.moveTo(points[p].x, points[p].y);
			this.wireframe.lineTo(points[p+1].x, points[p+1].y);
			*/
		}
	}

	return path;
}

/**
 * TODO
 */
LevelLayer.prototype.setName  = function(name)
{
	name = $.trim(name);
	if(name == "") return;

	this.name = name;

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelLayer.prototype.setDepth  = function(depth)
{
	this.depth = depth;

	this.level.children.sort(function(a, b)
	{
		if(a.depth < b.depth) return -1;
		if(a.depth > b.depth) return 1;
		return 0;
	});

	this.level.layers.sort(function(a, b)
	{
		if(a.depth < b.depth) return -1;
		if(a.depth > b.depth) return 1;
		return 0;
	});

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelLayer.prototype.setSelectedDepth  = function(depth)
{
	if(this.selected == null) return;

	this.selected.config.depth = depth;

	this.children.sort(function(a, b)
	{
		if(a.config.depth < b.config.depth) return -1;
		if(a.config.depth > b.config.depth) return 1;
		return 0;
	});

	this.paths.sort(function(a, b)
	{
		if(a.depth < b.depth) return -1;
		if(a.depth > b.depth) return 1;
		return 0;
	});

	this.objects.sort(function(a, b)
	{
		if(a.depth < b.depth) return -1;
		if(a.depth > b.depth) return 1;
		return 0;
	});

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelLayer.prototype.export = function()
{
	var output =
	{
		name     : this.name,
		depth    : this.depth,
		paths    : [],
		objects  : [],
	}

	if(this.level.layer == this)
	{
		output.selected = true;
		output.idObject = this.idObject;
	}

	for(var i = 0; i < this.objects.length; i++)
	{
		output.objects.push(this.objects[i].export());
	}

	for(var i = 0; i < this.paths.length; i++)
	{
		output.paths.push(this.paths[i].export());
	}

	output.objects.sort(function(a, b)
	{
		if(a.x < b.x) return -1;
		if(a.x > b.x) return 1;
		return 0;
	});

	output.paths.sort(function(a, b)
	{
		if(a.bounds[0] < b.bounds[0]) return -1;
		if(a.bounds[0] > b.bounds[0]) return 1;
		return 0;
	});

	return output;
}

/**
 * TODO
 */
LevelLayer.prototype.import = function(save)
{
	this.name  = save.name;
	this.depth = save.depth;

	for(var i = 0; i < save.objects.length; i++)
	{
		var obj = new LevelObject(this);
		obj.import(save.objects[i]);
		this.objects.push(obj);
	}

	for(var i = 0; i < save.paths.length; i++)
	{
		var path = new LevelPath(this);
		path.import(save.paths[i]);
		this.paths.push(path);
	}

	if(!!save.selected)
	{
		this.level.layer = this;
		this.idObject = save.idObject;
	}
}
},{"../Common":2,"../editor/Editor":9,"../editor/Level":10,"../editor/LevelObject":12,"../editor/LevelPath":13}],12:[function(require,module,exports){
var Common     = require("../Common");
var Editor     = require("../editor/Editor");
var Level      = require("../editor/Level");
var LevelLayer = require("../editor/LevelLayer");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelObject(layer)
{
	this.editor = layer.editor;
	this.layer  = layer;
	this.assetManager = p3.AssetManager.instance;

	this.config =
	{
		id       : "",
		texture  : "",
		anchor   : {x:0.5, y:0.5},
		scale    : {x:1,   y:1},
		rotation : 0,
		depth    : 0,
		data     : ""
	}

	this.sprite     = null;
	this.wireframe  = null;
	this.isDragging = false;
	this.lmb        = false;

	PIXI.Container.call(this);
}
module.exports = LevelObject;
LevelObject.prototype = Object.create(PIXI.Container.prototype);
LevelObject.prototype.constructor = LevelObject;

/**
 * TODO
 */
LevelObject.prototype.init = function(objDB)
{
	this.config.id      = objDB.id;
	this.config.texture = objDB.texture;
	this.config.anchor  = objDB.anchor;
	if(!!objDB.scale)
		this.config.scale = {x:objDB.scale, y:objDB.scale};
	if(!!objDB.data)
		this.config.data = objDB.data;
	if(!!objDB.depth)
		this.config.depth = objDB.depth;

	this.lmb = true;
	this.isDragging = true;
}

/**
 * TODO
 */
LevelObject.prototype.update = function()
{
	// Left Click
	if(this.editor.mouse.leftPressed)
	{
		var mousePosition = this.editor.getMousePosition();

		if(!this.lmb)
		{
			var mousePosition = this.editor.getMousePosition();
			var obj = this.layer.getObjectAtPoint(mousePosition);

			if(!this.isPointInside(mousePosition) && obj != this)
			{
				if(obj != null)
				{
					var obj = this.layer.getObjectAtPoint(mousePosition);
					if(obj != null)
					{
						this.layer.selectObject(obj);
						return;
					}
				}
				else
				{
					this.layer.newObject(this.config.id, mousePosition);
					return;
				}
			}
			else
			{
				this.isDragging = true;
			}

			this.lmb = true;
		}
		else
		{
			if(this.isDragging)
			{
				var mouseMovement = this.editor.mouse.movement;
				mouseMovement.multiply(1/this.editor.scale.x);

				this.x += mouseMovement.x;
				this.y += mouseMovement.y;
			}
		}
	}
	else if(this.lmb)
	{
		// End dragging
		this.lmb = false;
		this.isDragging = false;

		// History
		this.editor.historyAddState();
	}

	var inputFocus = $("input:focus, textarea:focus").length > 0;

	// Delete
	if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_C) && !Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && !inputFocus)
	{
		$(".delete_object").trigger("click");
	}

	// Back
	if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_B) && !Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && !inputFocus)
	{
		$(".back").trigger("click");
	}


}

/**
 * TODO
 */
LevelObject.prototype.render = function()
{
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;
	this.scale    = new PIXI.Point(this.config.scale.x, this.config.scale.y);

	if(this.sprite != null)    this.removeChild(this.sprite);
	if(this.wireframe != null) this.removeChild(this.wireframe);

	this.sprite          = new PIXI.Sprite(this.assetManager.getTexture(this.config.texture));
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.addChild(this.sprite);

	this.wireframe = new PIXI.Graphics();
	this.wireframe.lineStyle(1, 0xff0000, 1);
	this.wireframe.moveTo(- this.sprite.anchor.x * this.sprite.width,     - this.sprite.anchor.y * this.sprite.height);     // Top left
	this.wireframe.lineTo(+ (1-this.sprite.anchor.x) * this.sprite.width, - this.sprite.anchor.y * this.sprite.height);     // Top right
	this.wireframe.lineTo(+ (1-this.sprite.anchor.x) * this.sprite.width, + (1-this.sprite.anchor.y) * this.sprite.height); // Bottom right
	this.wireframe.lineTo(- this.sprite.anchor.x * this.sprite.width,     + (1-this.sprite.anchor.y) * this.sprite.height); // Bottom left
	this.wireframe.lineTo(- this.sprite.anchor.x * this.sprite.width,     - this.sprite.anchor.y * this.sprite.height);     // Top left

	this.wireframe.beginFill(0xff0000);
	this.wireframe.drawCircle(0, 0, 5);
	this.wireframe.endFill;

	this.wireframe.visible = this.layer.selected == this;

	this.addChild(this.wireframe);
}

/**
 * TODO
 */
LevelObject.prototype.renderGUI = function()
{
	this.editor.renderGUI("object");
}

/**
 * TODO
 */
LevelObject.prototype.back = function()
{
	this.layer.selected = null;

	// Add history state
	this.editor.historyAddState();
}

/**
 * TODO
 */
LevelObject.prototype.setScale = function(scale, saveState)
{
	this.config.scale.x = scale;
	this.config.scale.y = scale;
	this.scale.set(scale);
	
	// Add history state
	if(saveState)
	{
		this.editor.historyAddState();	
	}
}

/**
 * TODO
 */
LevelObject.prototype.setRotation = function(degrees, saveState)
{
	this.config.rotation = degrees;
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;
	
	// Add history state
	if(saveState)
	{	
		this.editor.historyAddState();	
	}
}

/**
 * TODO
 */
LevelObject.prototype.setConfig = function(parameter, value, saveState)
{
	this.config[parameter] = value;

	if(saveState)
		this.editor.historyAddState();
}

/**
 * TODO
 */
LevelObject.prototype.isPointInside = function(point)
{
	var p = new PIXI.Point(point.x, point.y);

	if(this.rotation != 0)
	{
		p.rotateAround(new PIXI.Point(this.x, this.y), -this.rotation);
	}

	if(p.x < this.x - this.sprite.width  * this.scale.x * this.sprite.anchor.x)     return false;
	if(p.x > this.x + this.sprite.width  * this.scale.x * (1-this.sprite.anchor.x)) return false;
	if(p.y < this.y - this.sprite.height * this.scale.y * this.sprite.anchor.y)     return false;
	if(p.y > this.y + this.sprite.height * this.scale.y * (1-this.sprite.anchor.y)) return false;

	return true;
}

/**
 * TODO
 */
LevelObject.prototype.export = function()
{
	var output = jQuery.extend(true, {}, this.config);
	output.position = {x:Math.round(this.x), y:Math.round(this.y)};

	if(this.layer.selected == this)
	{
		output.selected = true;
	}

	return output;
}

LevelObject.prototype.import = function(save)
{
	this.x               = save.position.x;
	this.y               = save.position.y;
	this.config.id       = save.id;
	this.config.texture  = save.texture;
	this.config.anchor   = {x:save.anchor.x, y:save.anchor.y};
	this.config.scale    = {x:save.scale.x, y:save.scale.y};
	this.config.rotation = save.rotation;
	this.config.depth    = save.depth;
	this.config.data     = save.data;
	
	if(!!save.selected)
	{
		this.layer.selected = this;	
	}
}
},{"../Common":2,"../editor/Editor":9,"../editor/Level":10,"../editor/LevelLayer":11}],13:[function(require,module,exports){
var Common     = require("../Common");
var Editor     = require("../editor/Editor");
var Level      = require("../editor/Level");
var LevelLayer = require("../editor/LevelLayer");
var BezierPath = require("../editor/BezierPath");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelPath(layer)
{
	this.editor = layer.editor;
	this.layer  = layer;
	this.assetManager = p3.AssetManager.instance;

	this.config =
	{
		closed            : false,
		depth             : 0,
		collisions        : 1, //0: no, 1: yes, 2: ground only
		texFill           : "theme_01_fill",
		texGround         : "theme_01_ground",
		texGroundEdge     : "theme_01_ground_edge",
		texWall           : "theme_01_wall",
		texFillPadding    : 512,
		texFillSize       : 256,
		texGroundSize     : 160,
		texGroundDelta    : 0.1,
		texWallSize       : 160,
		texWallDelta      : 0.1,
		texWallAngle      : 70,
		texGroundEdgeSide : "",
		data              : ""
	}

	this.bezier     = new BezierPath();
	this.bezier.cacheDrawingPoints = false;
	this.pointIndex = -1;

	this.wireframe = null;
	this.textures  = null;

	this.lmb = false;
	this.rmb = false;
	this.dragMovement = null;

	PIXI.Container.call(this);
}
module.exports = LevelPath;
LevelPath.prototype = Object.create(PIXI.Container.prototype);
LevelPath.prototype.constructor = LevelPath;

/**
 * TODO
 */
LevelPath.prototype.init = function()
{

}

/**
 * TODO
 */
LevelPath.prototype.update = function()
{
	// Left Click
	if(this.editor.mouse.leftPressed)
	{
		var mousePosition = this.editor.getMousePosition();

		if(!this.lmb && this.editor.mouse.leftJustPressed)
		{
			this.lmb = true;

			// Get point
			this.pointIndex = this.getPointAt(mousePosition.x, mousePosition.y);

			if(this.pointIndex == -1)
			{
				// Add new point
				var prevPoint = this.bezier.points[this.bezier.points.length-1];
				var newPoint  = mousePosition;

				if(this.config.closed || prevPoint.x < newPoint.x)
				{
					// Add point at the end if closed or open and after the last point
					this.addPoint(prevPoint.x + (newPoint.x - prevPoint.x)/2, prevPoint.y);
					this.addPoint(newPoint.x - (newPoint.x - prevPoint.x)/2, newPoint.y);
					this.addPoint(newPoint.x, newPoint.y);
					this.pointIndex = this.bezier.points.length - 1;
				}
				else
				{
					// Add point in the middle of two points if the path is open if the new position is not after the last point
					if(this.bezier.points.length > 1 && newPoint.x > this.bezier.getFirstPoint().x)
					{
						for(var i = 3; i < this.bezier.points.length; i+= 3)
						{
							if(this.bezier.points[i].x > newPoint.x)
							{
								var prevPoint = this.bezier.points[i-3];
								var nextPoint = this.bezier.points[i];

								this.addPoint(nextPoint.x - (nextPoint.x - newPoint.x)/2, newPoint.y, i-1);
								this.addPoint(newPoint.x, newPoint.y, i-1);
								this.addPoint(prevPoint.x + (newPoint.x - prevPoint.x)/2, newPoint.y, i-1);

								this.pointIndex = i;
								break;
							}
						}
					}
				}

				this.render();
			}
		}
		else if(this.lmb)
		{
			if(this.pointIndex != -1)
			{
				var moved = this.movePoint(this.pointIndex, mousePosition.x, mousePosition.y);

				if(moved)
				{
					this.render();
				}
			}
		}
	}
	else if(this.lmb)
	{
		this.lmb = false;
		this.render();

		// Add history state
		this.editor.historyAddState();
	}


	// Right Click
	if(this.editor.mouse.rightPressed)
	{
		var mousePosition = this.editor.getMousePosition();

		if(!this.rmb)
		{
			this.rmb = true;
			this.dragMovement = new PIXI.Point(0,0);
		}
		else
		{
			var mouseMovement = this.editor.mouse.movement;
			mouseMovement.multiply(1/this.editor.scale.x);

			this.move
			(
				-Math.round(this.dragMovement.x/this.editor.snapGrid) * this.editor.snapGrid,
				-Math.round(this.dragMovement.y/this.editor.snapGrid) * this.editor.snapGrid
			);

			this.dragMovement.x += mouseMovement.x;
			this.dragMovement.y += mouseMovement.y;

			this.move
			(
				Math.round(this.dragMovement.x/this.editor.snapGrid) * this.editor.snapGrid,
				Math.round(this.dragMovement.y/this.editor.snapGrid) * this.editor.snapGrid
			);

			this.render();
		}
	}
	else if(this.rmb)
	{
		this.rmb = false;

		// History
		this.editor.historyAddState();
	}

	var inputFocus = $("input:focus, textarea:focus").length > 0;

	// Delete point
	if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_C) && !Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && !inputFocus)
	{
		if(this.pointIndex % 3 == 0 && this.bezier.points.length > 1)
		{
			var isLastPoint = this.pointIndex == (this.bezier.points.length-1);
			this.deletePoint(this.pointIndex);
			if(isLastPoint) this.pointIndex-=3;

			this.render();
		}
	}

	// Back
	if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_B) && !Common.keyboard.getKeyPressed(Common.keyboard.KEY_CTRL) && !inputFocus)
	{
		$(".back").trigger("click");
	}

	// Toggle wireframe
	if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_W) && !inputFocus)
	{
		this.wireframe.visible = !this.wireframe.visible;
	}
}

/**
 * TODO
 */
LevelPath.prototype.render = function()
{
	if(this.wireframe != null)
	{
		this.removeChild(this.wireframe);
	}

	if(this.textures != null)
	{
		this.removeChild(this.textures);
	}


	this.wireframe = new PIXI.Graphics();
	this.textures = new PIXI.Container();


	if(this.bezier.points.length > 1)
	{
		var drawingPoints = this.bezier.getDrawingPoints();
		var drawingPointsNormals = this.bezier.getDrawingPointsNormals();

		// Draw fill texture
		if(this.config.texFill != "" )
		{
			var lowerPoint = null;
			var contour = [];
			for(var i = 0; i < drawingPoints.length; i++)
			{
				contour.push(new poly2tri.Point(drawingPoints[i].x, drawingPoints[i].y));

				if(lowerPoint == null || lowerPoint < drawingPoints[i].y)
					lowerPoint = drawingPoints[i].y;
			}

			if(!this.config.closed)
			{
				contour.push({x: drawingPoints[drawingPoints.length-1].x, y: lowerPoint + this.config.texFillPadding});
				contour.push({x: drawingPoints[0].x, y: lowerPoint + this.config.texFillPadding});
			}
			else
			{
				// Remove last point if coincides with the first, otherwise the triangulation will fail
				if(contour[0].x == contour[contour.length-1].x && contour[0].y == contour[contour.length-1].y)
				{
					contour.splice(contour.length-1, 1);
				}
			}

			try
			{
				var swctx = new poly2tri.SweepContext(contour);
				swctx.triangulate();
				var triangles = swctx.getTriangles();
			}
			catch(e)
			{
				console.log("Triangulation failed")
			}


			if(!!triangles)
			{
				// Draw the filling mesh
				var texture    = this.assetManager.getTexture(this.config.texFill);
				var vertices   = new Float32Array(6 * triangles.length);
				var uvs        = new Float32Array(6 * triangles.length);
				var indices    = new Uint16Array(3 * triangles.length);

				var size = this.config.texFillSize;

				for(var i = 0; i < triangles.length; i++)
				{
					var points = triangles[i].getPoints();

					vertices.set(
					[
						points[0].x, points[0].y,
						points[1].x, points[1].y,
						points[2].x, points[2].y
					], i*6)

					uvs.set(
					[
						points[0].x/size, points[0].y/size,
						points[1].x/size, points[1].y/size,
						points[2].x/size, points[2].y/size
					], i * 6);

					indices.set([0 + 3*i, 1 + 3*i, 2 + 3*i], i * 3);

					// Wireframe
					/*
					this.wireframe.lineStyle(1, 0x00ff00, 0.5);
					var points = triangles[i].getPoints();

					this.wireframe.moveTo(points[0].x, points[0].y);
					for(var p = 1; p < points.length; p++)
					{
						this.wireframe.lineTo(points[p].x, points[p].y);
					}
					this.wireframe.lineTo(points[0].x, points[0].y);
					*/
				}

				var mesh = new PIXI.mesh.Mesh
				(
					texture,
					vertices,
					uvs,
					indices,
					PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
				);

				/*
				var shader = new PIXI.AbstractFilter('',
				[
					'precision mediump float;',

					'varying vec2 vTextureCoord;',
					'uniform sampler2D uSampler;',
					'uniform vec4 uUVS;',

					'void main(void)',
					'{',
						'vec2 coords = vTextureCoord;',
						// 'coords.x = uUVS.x + coords.x * (uUVS.z - uUVS.x);',
						// 'coords.y = uUVS.y + coords.y * (uUVS.w - uUVS.y);',
						'gl_FragColor = texture2D(uSampler, coords);',
						'gl_FragColor.r = coords.x;',
						'gl_FragColor.g = coords.y;',
					'}',
				].join('\n'),
				{
					uUVS : {type: '4fv', value : [texture._uvs.x0, texture._uvs.y0, texture._uvs.x1, texture._uvs.y1]}
				});
				mesh.filters = [shader];
				*/

				this.textures.addChild(mesh);
			}
		}


		// Draw the inclined terrain
		if(this.config.texWall != "")
		{
			var segments       = this.bezier.getGroundSegments(this.config.texWallAngle, 360);
			var textureSize    = this.config.texWallSize;
			var textureTopPerc = this.config.texWallDelta

			var segmentsSize = 0;
			for(var s = 0; s < segments.length; s++)
			{
				segmentsSize += segments[s].points.length-1;
			}

			var texture    = this.assetManager.getTexture(this.config.texWall);
			var vertices   = new Float32Array(8 * segmentsSize);
			var uvs        = new Float32Array(8 * segmentsSize);
			var indices    = new Uint16Array(6 * segmentsSize);
			var arrayIndex = 0;

			for(var s = 0; s < segments.length; s++)
			{
				var totalLength  = 0;
				var segmentLength = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					vertices.set(
					[
							segments[s].points[i].x   - segments[s].normals[i].x   * (textureSize * textureTopPerc),     segments[s].points[i].y   - segments[s].normals[i].y   * (textureSize * textureTopPerc),
							segments[s].points[i+1].x - segments[s].normals[i+1].x * (textureSize * textureTopPerc),     segments[s].points[i+1].y - segments[s].normals[i+1].y * (textureSize * textureTopPerc),
							segments[s].points[i+1].x + segments[s].normals[i+1].x * (textureSize * (1-textureTopPerc)), segments[s].points[i+1].y + segments[s].normals[i+1].y * (textureSize * (1-textureTopPerc)),
							segments[s].points[i].x   + segments[s].normals[i].x   * (textureSize * (1-textureTopPerc)), segments[s].points[i].y   + segments[s].normals[i].y   * (textureSize * (1-textureTopPerc))
					], arrayIndex*8)

					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength = v.getLength();

					uvs.set(
					[
						totalLength/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 1,
						totalLength/textureSize, 1
					], arrayIndex * 8);


					indices.set(
					[
						0 + 4*arrayIndex,
						1 + 4*arrayIndex,
						2 + 4*arrayIndex,
						0 + 4*arrayIndex,
						2 + 4*arrayIndex,
						3 + 4*arrayIndex
					], arrayIndex * 6);

					totalLength += segmentLength;

					// Wireframe
					this.wireframe.lineStyle(1, 0x00ff00, 0.5);
					this.wireframe.moveTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[arrayIndex*8+1*2], vertices[arrayIndex*8+1*2+1]); // 1
					this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
					this.wireframe.lineTo(vertices[arrayIndex*8+3*2], vertices[arrayIndex*8+3*2+1]); // 3
					this.wireframe.lineTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2

					arrayIndex++;
				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);

			this.textures.addChild(mesh);
		}

		// Draw the terrain
		var segments       = this.bezier.getGroundSegments(0, this.config.texWallAngle, this.config.texGroundEdge == "");
		var textureSizeOr  = this.config.texGroundSize;
		var textureTopPerc = this.config.texGroundDelta

		if(this.config.texGround != "")
		{
			var segmentsSize = 0;
			for(var s = 0; s < segments.length; s++)
			{
				segmentsSize += segments[s].points.length-1;
			}

			var texture    = this.assetManager.getTexture(this.config.texGround);
			var vertices   = new Float32Array(8 * segmentsSize);
			var uvs        = new Float32Array(8 * segmentsSize);
			var indices    = new Uint16Array(6 * segmentsSize);
			var arrayIndex = 0;

			for(var s = 0; s < segments.length; s++)
			{
				// Make the normals perpendicular if the left/right-most segments don't have a cap
				if(s == 0 && (this.config.texGroundEdgeSide == "right" || this.config.texGroundEdgeSide == "none"))
					segments[s].normals[0] = {x:0, y:1};
				if(s == segments.length-1 && (this.config.texGroundEdgeSide == "left" || this.config.texGroundEdgeSide == "none"))
					segments[s].normals[segments[s].normals.length-1] = {x:0, y:1};

				// Calculate the total length of the segment
				var segmentLength  = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength += v.getLength();
				}

				// Count how many times the texture can fit in the segment length, then round it to adjust the texture size
				var textureSize = segmentLength/ Math.max(1, Math.round(segmentLength / textureSizeOr));

				// Draw the segment
				var totalLength   = 0;
				var segmentLength = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					vertices.set(
					[
							segments[s].points[i].x   - segments[s].normals[i].x   * (textureSize * textureTopPerc),     segments[s].points[i].y   - segments[s].normals[i].y   * (textureSizeOr * textureTopPerc),
							segments[s].points[i+1].x - segments[s].normals[i+1].x * (textureSize * textureTopPerc),     segments[s].points[i+1].y - segments[s].normals[i+1].y * (textureSizeOr * textureTopPerc),
							segments[s].points[i+1].x + segments[s].normals[i+1].x * (textureSize * (1-textureTopPerc)), segments[s].points[i+1].y + segments[s].normals[i+1].y * (textureSizeOr * (1-textureTopPerc)),
							segments[s].points[i].x   + segments[s].normals[i].x   * (textureSize * (1-textureTopPerc)), segments[s].points[i].y   + segments[s].normals[i].y   * (textureSizeOr * (1-textureTopPerc))
					], arrayIndex*8)

					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength = v.getLength();

					uvs.set(
					[
						totalLength/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 1,
						totalLength/textureSize, 1
					], arrayIndex * 8);


					indices.set(
					[
						0 + 4*arrayIndex,
						1 + 4*arrayIndex,
						2 + 4*arrayIndex,
						0 + 4*arrayIndex,
						2 + 4*arrayIndex,
						3 + 4*arrayIndex
					], arrayIndex * 6);

					totalLength += segmentLength;

					// Wireframe
					this.wireframe.lineStyle(1, 0x00ff00, 0.5);
					this.wireframe.moveTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[arrayIndex*8+1*2], vertices[arrayIndex*8+1*2+1]); // 1
					this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
					this.wireframe.lineTo(vertices[arrayIndex*8+3*2], vertices[arrayIndex*8+3*2+1]); // 3
					this.wireframe.lineTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2

					arrayIndex++;
				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);

			this.textures.addChild(mesh);
		}

		// Draw the terrain edges
		if(this.config.texGroundEdge != "")
		{
			var texture    = this.assetManager.getTexture(this.config.texGroundEdge);
			var vertices   = new Float32Array(2 * 8 * segments.length);
			var uvs        = new Float32Array(2 * 8 * segments.length);
			var indices    = new Uint16Array (2 * 6 * segments.length);

			for(var s = 0; s < segments.length; s++)
			{
				// Calculate the total length of the segment
				var segmentLength  = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength += v.getLength();
				}

				// Count how many times the texture can fit in the segment length, then round it to adjust the texture size
				var textureSize = segmentLength/ Math.round(segmentLength / textureSizeOr);

				// Left edge
				if(s > 0 || (this.config.texGroundEdgeSide == "left" || this.config.texGroundEdgeSide == ""))
				{
					var p = segments[s].points[0];
					var n = segments[s].normals[0];
					var v = new PIXI.Point(segments[s].points[0].x - segments[s].points[1].x, segments[s].points[0].y - segments[s].points[1].y);
					v.normalize();

					vertices.set(
					[
						p.x - n.x * (textureSize * textureTopPerc) +(v.x * textureSize),     p.y - n.y * (textureSizeOr * textureTopPerc     -(v.y * textureSizeOr)),
						p.x - n.x * (textureSize * textureTopPerc),                          p.y - n.y * (textureSizeOr * textureTopPerc),
						p.x + n.x * (textureSize * (1-textureTopPerc)),                      p.y + n.y * (textureSizeOr * (1-textureTopPerc)),
						p.x + n.x * (textureSize * (1-textureTopPerc)) +(v.x * textureSize), p.y + n.y * (textureSizeOr * (1-textureTopPerc) +(v.y * textureSizeOr))
					], s*8*2);

					uvs.set(
					[
						0, 0,
						1, 0,
						1, 1,
						0, 1
					], s*8*2);

					indices.set(
					[
						0 + (s*2) *4,
						1 + (s*2) *4,
						2 + (s*2) *4,
						0 + (s*2) *4,
						2 + (s*2) *4,
						3 + (s*2) *4
					], s*6*2);

					// Wireframe
					this.wireframe.lineStyle(1, 0x00ff00, 0.5);
					this.wireframe.moveTo(vertices[s*2*8+0*2], vertices[s*2*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[s*2*8+1*2], vertices[s*2*8+1*2+1]); // 1
					this.wireframe.lineTo(vertices[s*2*8+2*2], vertices[s*2*8+2*2+1]); // 2
					this.wireframe.lineTo(vertices[s*2*8+3*2], vertices[s*2*8+3*2+1]); // 3
					this.wireframe.lineTo(vertices[s*2*8+0*2], vertices[s*2*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[s*2*8+2*2], vertices[s*2*8+2*2+1]); // 2
				}

				// Right edge
				if(s < segments.length-1 || (this.config.texGroundEdgeSide == "right" || this.config.texGroundEdgeSide == ""))
				{
					var l = segments[s].normals.length-1;
					var p = segments[s].points[segments[s].normals.length-1];
					var n = segments[s].normals[segments[s].normals.length-1];
					var v = new PIXI.Point(segments[s].points[l].x - segments[s].points[l-1].x, segments[s].points[l].y - segments[s].points[l-1].y);
					v.normalize();

					vertices.set(
					[
						p.x - n.x * (textureSize * textureTopPerc) +(v.x * textureSize),     p.y - n.y * (textureSizeOr * textureTopPerc -(v.y * textureSizeOr)),
						p.x - n.x * (textureSize * textureTopPerc),                          p.y - n.y * (textureSizeOr * textureTopPerc),
						p.x + n.x * (textureSize * (1-textureTopPerc)),                      p.y + n.y * (textureSizeOr * (1-textureTopPerc)),
						p.x + n.x * (textureSize * (1-textureTopPerc)) +(v.x * textureSize), p.y + n.y * (textureSizeOr * (1-textureTopPerc)+(v.y * textureSizeOr))
					], (s*2+1)*8);

					uvs.set(
					[
						0, 0,
						1, 0,
						1, 1,
						0, 1
					], (s*2+1)*8);

					indices.set(
					[
						0 + (s*2+1) *4,
						1 + (s*2+1) *4,
						2 + (s*2+1) *4,
						0 + (s*2+1) *4,
						2 + (s*2+1) *4,
						3 + (s*2+1) *4
					], (s*2+1)*6);

					// Wireframe
					this.wireframe.lineStyle(1, 0x00ff00, 0.5);
					this.wireframe.moveTo(vertices[(s*2+1)*8+0*2], vertices[(s*2+1)*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[(s*2+1)*8+1*2], vertices[(s*2+1)*8+1*2+1]); // 1
					this.wireframe.lineTo(vertices[(s*2+1)*8+2*2], vertices[(s*2+1)*8+2*2+1]); // 2
					this.wireframe.lineTo(vertices[(s*2+1)*8+3*2], vertices[(s*2+1)*8+3*2+1]); // 3
					this.wireframe.lineTo(vertices[(s*2+1)*8+0*2], vertices[(s*2+1)*8+0*2+1]); // 0
					this.wireframe.lineTo(vertices[(s*2+1)*8+2*2], vertices[(s*2+1)*8+2*2+1]); // 2
				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);
			this.textures.addChild(mesh);
		}
	}

	// Draw bezier
	this.wireframe.moveTo(this.bezier.points[0].x, this.bezier.points[0].y);
	this.wireframe.lineStyle(2, 0xff0000);
	for(var i = 1; i < this.bezier.points.length; i +=3)
	{
		this.wireframe.bezierCurveTo(this.bezier.points[i].x, this.bezier.points[i].y, this.bezier.points[i+1].x, this.bezier.points[i+1].y, this.bezier.points[i+2].x, this.bezier.points[i+2].y);
	}

	// Draw ancors
	this.wireframe.lineStyle(2, 0x990000, 0.5);
	for(var i = 0; i < this.bezier.points.length-1; i += 3)
	{
		this.wireframe.moveTo(this.bezier.points[i].x, this.bezier.points[i].y);
		this.wireframe.lineTo(this.bezier.points[i+1].x, this.bezier.points[i+1].y);

		this.wireframe.moveTo(this.bezier.points[i+2].x, this.bezier.points[i+2].y);
		this.wireframe.lineTo(this.bezier.points[i+3].x, this.bezier.points[i+3].y);
	}

	// Draw main points
	for(var i = 0; i < this.bezier.points.length; i ++)
	{
		if(i%3 != 0) continue;

		if(i == this.pointIndex)
			this.wireframe.lineStyle(2, 0x00ff00 , 1);
		else
			this.wireframe.lineStyle(0, 0xff0000, 0);

		this.wireframe.beginFill(0xff0000);
		this.wireframe.drawCircle(this.bezier.points[i].x,  this.bezier.points[i].y, 5);
		this.wireframe.endFill();
	}

	// Draw anchor points
	for(var i = 0; i < this.bezier.points.length; i ++)
	{
		if(i%3 == 0) continue;

		if(i == this.pointIndex)
			this.wireframe.lineStyle(2, 0x00ff00 , 1);
		else
			this.wireframe.lineStyle(0, 0xff0000, 0);

		this.wireframe.beginFill(0x990099);
		this.wireframe.drawCircle(this.bezier.points[i].x,  this.bezier.points[i].y, 3);
		this.wireframe.endFill();
	}

	this.addChild(this.textures);
	this.addChild(this.wireframe);

	// Status
	this.wireframe.visible = this.layer.selected == this;
}

/**
 * TODO
 */
LevelPath.prototype.renderGUI = function()
{
	this.editor.renderGUI("path");
}

/**
 * TODO
 */
LevelPath.prototype.back = function()
{
	this.layer.selected = null;

	if(this.bezier.points.length <= 1)
	{
		this.layer.deletePath(this);
	}

	// Reset history
	this.editor.historyAddState();
}


/**
 * TODO
 */
LevelPath.prototype.addPoint = function(x, y, index)
{
	x = Math.round(x/this.editor.snapGrid) * this.editor.snapGrid;
	y = Math.round(y/this.editor.snapGrid) * this.editor.snapGrid;
	this.bezier.addPoint(x,y,index);
}

/**
 * TODO
 */
LevelPath.prototype.deletePoint = function(index)
{
	var firstPoint = index == 0;
	var lastPoint  = index == this.bezier.points.length-1;

	if(firstPoint)
	{
		this.bezier.deletePoint(index+2);
	}

	if(!lastPoint)
	{
		this.bezier.deletePoint(index+1);
	}

	this.bezier.deletePoint(index);

	if(!firstPoint)
	{
		this.bezier.deletePoint(index-1);
	}

	if(lastPoint)
	{
		this.bezier.deletePoint(index-2);
	}
}

/**
 * TODO
 */
LevelPath.prototype.movePoint = function(index, x, y)
{
	var oldPosition = new PIXI.Point(this.bezier.points[index].x, this.bezier.points[index].y);

	this.bezier.points[index].x = Math.round(x/this.editor.snapGrid) * this.editor.snapGrid;
	this.bezier.points[index].y = Math.round(y/this.editor.snapGrid) * this.editor.snapGrid;

	// Not moved
	if(this.bezier.points[index].x == oldPosition.x && this.bezier.points[index].y == oldPosition.y) return false;

	// Move the handles if main point
	if(index % 3 == 0)
	{
		if(index > 0)
		{
			this.bezier.points[index-1].x += this.bezier.points[index].x - oldPosition.x;
			this.bezier.points[index-1].y += this.bezier.points[index].y - oldPosition.y;
		}

		if(index < this.bezier.points.length-1)
		{
			this.bezier.points[index+1].x += this.bezier.points[index].x - oldPosition.x;
			this.bezier.points[index+1].y += this.bezier.points[index].y - oldPosition.y;
		}
	}

	return true;
}

/**
 * TODO
 */
LevelPath.prototype.getPointAt = function(x, y)
{
	x = Math.round(x/this.editor.snapGrid) * this.editor.snapGrid;
	y = Math.round(y/this.editor.snapGrid) * this.editor.snapGrid;

	// Check anchor points first
	for(var i = this.bezier.points.length-1; i >= 0; i--)
	{
		if(i%3 == 0) continue;
		if(this.bezier.points[i].x == x && this.bezier.points[i].y == y) return i;
	}

	// If no anchor points have been found look at the main points
	for(var i = this.bezier.points.length-1; i >= 0; i--)
	{
		if(i%3 != 0) continue;
		if(this.bezier.points[i].x == x && this.bezier.points[i].y == y) return i;
	}

	return -1;
}

/**
 * TODO
 */
LevelPath.prototype.move = function(x, y)
{
	for(var i = 0; i < this.bezier.points.length; i++)
	{
		this.bezier.points[i].x += x;
		this.bezier.points[i].y += y;
	}
}

/**
 * TODO
 */
LevelPath.prototype.setConfig = function(parameter, value, saveState)
{
	this.config[parameter] = value;

	if(saveState)
		this.editor.historyAddState();
}

/**
 * TODO
 */
LevelPath.prototype.export = function()
{
	var output      = jQuery.extend(true, {}, this.config);
	output.points   = this.bezier.points;
	output.bounds   = [null, null];

	for(var i = 0; i < this.bezier.points.length; i++)
	{
		output.bounds[0] = output.bounds[0] === null ? this.bezier.points[i].x : Math.min(output.bounds[0], this.bezier.points[i].x);
		output.bounds[1] = output.bounds[1] === null ? this.bezier.points[i].x : Math.max(output.bounds[1], this.bezier.points[i].x);
	}

	if(this.layer.selected == this)
	{
		output.selected = true;
		output.pointIndex = this.pointIndex;
	}

	return output;
}


/**
 * TODO
 */
LevelPath.prototype.import = function(save)
{
	this.config.closed            = save.closed;
	this.config.depth             = save.depth;
	this.config.collisions        = save.collisions;
	this.config.texFill           = save.texFill;
	this.config.texGround         = save.texGround;
	this.config.texGroundEdge     = save.texGroundEdge;
	this.config.texGroundEdgeSide = save.texGroundEdgeSide;
	this.config.texWall           = save.texWall;
	this.config.texFillPadding    = save.texFillPadding;
	this.config.texFillSize       = save.texFillSize;
	this.config.texGroundSize     = save.texGroundSize;
	this.config.texGroundDelta    = save.texGroundDelta;
	this.config.texWallSize       = save.texWallSize;
	this.config.texWallDelta      = save.texWallDelta;
	this.config.texWallAngle      = save.texWallAngle;
	this.config.data              = save.data;

	if(!!save.selected)
	{
		this.layer.selected = this;
		this.pointIndex = save.pointIndex;
	}

	for(var i = 0; i < save.points.length; i++)
	{
		this.bezier.addPoint(save.points[i].x, save.points[i].y);
	}
}
},{"../Common":2,"../editor/BezierPath":8,"../editor/Editor":9,"../editor/Level":10,"../editor/LevelLayer":11}],14:[function(require,module,exports){
var Common         = require("../Common");
var RunningEntity  = require("./RunningEntity");
var Emitter        = require("../general/Emitter");
var SoundSFX       = require("../general/SoundSFX");
var ObjectAxe       = require("../game/ObjectAxe");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Avatar()
{
	RunningEntity.call(this, "avatar");

	this.level               = null;
	this.allowPathCollisions = true;

	this.spineData = Common.characterAnimationData.char_female;
	this.currentAnimation	= "";
	this.spineSpeed = 1;

	this._characterData = this._assetManager.getJSON("config").characters[Common.savedData.character];
	this._powerupsData  = this._assetManager.getJSON("config").powerups;

	this.config =
	{
		depth : 0,
	}

	this.abilities =
	{
		doubleJump      : false,
		bridge          : false,
		slash           : false,
		shrink          : false,
		invulnerability : false
	}

	this.areInputActive = true;

	this.isDead     = false;
	this.isImmortal = false;
	this.isGrounded = false;
	this.velocity   = new p3.Vector2(0.0, 0.0);

	this.jumpTime              = 0.45;
	this.jumpHeightMin         = 125;
	this.jumpHeight            = 300;
	this.doubleJumpHeightMin   = 100;
	this.doubleJumpHeight      = 200;
	this.jumpSlopeAngleMax     = 65;

	this.runSpeedMin           = 600.0;
	this.runSpeedMax           = 900.0;
	this.slidingSpeedMax       = 1200.0;
	this.accelerationSliding   = 350;
	this.accelerationSlopeDown = 100;
	this.accelerationSlopeUp   = -500;
	this.accelerationNormal    = -200;
	this.runSpeed              = this.runSpeedMin;

	this.fallTime              = 0;
	this.fallTimeToLand        = 0.7;

	this.isSliding             = false;
	this.timeUnsliding         = 0;
	this.timeUnslidingEnd      = 0.4;
	this.slidingAngleStart     = 35;
	this.slidingAngleEnd       = 15;
	this.slidingSFX            = null;

	this.canTumble             = false;
	this.isTumbling            = false;
	this.tumbleSpeed           = 0;
	this.tumbleSpeedMin        = 180;
	this.tumbleSpeedMax        = 720;
	this.tumbleSpeedTime       = 0.4;
	this.tumbleAngle           = 0;
	this.tumbleSpeedYStart     = 0; // The vertical speed at which the tumbling starts
	this.tumbleDeathAngle      = {min:130, max:130}; // Disabled because it's too hard, poor things

	this.canCreateBridge       = false;
	this.ignoreArtificialPaths = false;

	this.isSlashing            = false;
	this.slashTime             = 0;
	this.slashTimeMax          = 1.5;
	this.slashSFX              = null;
	this.axe                   = null;

	this.isShrinking              = false;
	this.isUnshrinking            = false;
	this.shrinkTime               = 0;
	this.shrinkTimeMax            = 5;
	this.shrinkTransitionTime     = 0.25;
	this.isShrinkLocked           = false;
	this.positionCache            = [];
	this.shrinkPieceDelay         = 0.075;
	this.shrinkPieceRotationSpeed = 1440;

	this.isInvulnerable           = false;
	this.invulnerabilityTime      = 0;
	this.invulnerabilityTimeMax   = 1.5;

	this.isRidingVehicle       = false;
	this.vehicle               = null;

	this.runUpAngle            = -50;
	this.runDownAngle          = 10;

	this.rotation              = 0;
	this.angleTarget           = 0;
	this.angleSpeed            = 0.1;

	this.headbobTime           = 0;
	this.headbobFrequency      = 11;
	this.headbobHeight         = 15;

	this.collisionCircleRadius = 55;
	this.pickupCircle          = null;
	this.pickupCircleRadius    = 70;
	this.axeCircle             = null;

	this.isTrollMagic       = false;
	this.trollMagicTime     = 0;
	this.trollMagicDuration = 10;

	this.focusPointLand        = {point: new PIXI.Point(0.30, 0.60), time : 1.4, delay: 0};
	this.focusPointJump        = {point: new PIXI.Point(0.32, 0.45), time : 0.4, delay: 0};
	this.focusPointFall        = {point: new PIXI.Point(0.32, 0.35), time : 0.4, delay: 0.1};
	this.focusPointTumble      = {point: new PIXI.Point(0.32, 0.25), time : 0.4, delay: 0};
	this.focusPointSlide       = {point: new PIXI.Point(0.28, 0.50), time : 1, delay: 0};
	this.focusPointDeath       = {point: new PIXI.Point(0.4, 0.60),  time : 2, delay: 0};
	this.zoomSlide             = {zoom:-0.25, time: 1};
	this.zoomSlideEnd          = {zoom:0,     time: 1.5};
	this.zoomDeath             = {zoom:+0.4,  time: 2};

	this.kJumpStart            = false;
	this.kJumpPressed          = false;
	this.kJumpEnd              = false;
	this.kAbility              = false;

	this.snowTrailPS           = null;
	this.doubleJumpPS          = null;
	this.trollMagicPS          = null;
	this.bridgeFailMagicPS     = null;

	this.walkLoop = "";
}
module.exports = Avatar;
Avatar.prototype = Object.create(RunningEntity.prototype);
Avatar.prototype.constructor = Avatar;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
Avatar.prototype.init = function(level)
{
	this.level = level;

	this.initCharacter(Common.savedData.character);

	this.zoomSlide.zoom    += this.level.defaultZoom;
	this.zoomSlideEnd.zoom += this.level.defaultZoom;
	this.zoomDeath.zoom    += this.level.defaultZoom;

	// Collision mask
	this.collisionCircle   = new PIXI.Circle(0, 0, this.collisionCircleRadius);
	this.pickupCircle      = new PIXI.Circle(-20, -20, this.pickupCircleRadius);
	this.axeCircle         = new PIXI.Circle(40, -30, 110);

	// Jump
	this.jumpSpeed     = (2 * this.jumpHeight) / this.jumpTime;
	this.gravity       = this.jumpSpeed/this.jumpTime;
	this.jumpTimeMin   = Math.sqrt(2 * this.jumpHeightMin/this.gravity);
	this.jumpSpeedMin  = this.gravity * this.jumpTimeMin;

	this.doubleJumpTimeMin  = Math.sqrt(2 * this.doubleJumpHeightMin/this.gravity);
	this.doubleJumpSpeedMin = this.gravity * this.doubleJumpTimeMin;
	this.doubleJumpTime     = Math.sqrt(2 * this.doubleJumpHeight/this.gravity);
	this.doubleJumpSpeed    = this.gravity * this.doubleJumpTime;

	// Animations
	this.animationHolder = new PIXI.Container();
	this.addChild(this.animationHolder);

	// Spine
	this.spine = new PIXI.spine.Spine(this.spineData);
	this.spine.skeleton.setToSetupPose();
	this.spine.skeleton.setSkin(null);
	this.spine.skeleton.setSkinByName(Common.savedData.character);
	this.spine.x = 0;
	this.spine.y = this.collisionCircle.radius;
	this.spine.autoUpdate = false;
	this.spine.scale.set(0.5);
	this.animationHolder.addChild(this.spine);
	this.setAnimation('fall', true);

    var animations =
	[
		'run_flat',
		'run_flat_magic',
		'run_up2',
		'run_down',
		'run_down_steep',
		'slide_down_steep',
		'slide_down_exit',
		'jump_normal',
		'jump_double',
		'jump_tuck2',
		'fall',
		'land',
		'land_bad',
		'ride_sven',
		'ride_sven_fall',
		'ride_sled',
		'ride_sled_down',
		'run_roll',
		'run_down_steep_rolling_ball'
	];

	for(var i = 0; i < animations.length; i++)
	{
		var found = false;
		for(var t = 0; t < this.spine.spineData.animations.length; t++)
		{
			if(this.spine.spineData.animations[t].name == animations[i])
			{
				found = true;
				break;
			}
		}

		if(!found)
		{
			console.info("Animation %s missing", animations[i]);
			animations.splice(i,1);
			i--;
			continue;
		}
	}

	for(var i = 0; i < animations.length; i++)
	{
		for(var j = 0; j < animations.length; j++)
		{
			if(i == j) continue;

			if(animations[i] == "jump_tuck2" || animations[j] == "land_bad" || animations[j] == "jump_double" || (animations[j] == "run_flat_magic" && this.isKristoff()))
				this.spine.stateData.setMixByName(animations[i], animations[j], 0.1);
			else if(animations[j] == "land")
				this.spine.stateData.setMixByName(animations[i], animations[j], 0);
			else
				this.spine.stateData.setMixByName(animations[i], animations[j], 0.2);
        }
    }

	// Particles
	this.snowTrailPS = new cloudkid.Emitter(this.level,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_snow_emitter_v1"));
	this.snowTrailPS.emit = false;

	if(this.level.debug)
	{
		this._particleOrigin = new PIXI.Graphics();
		this._particleOrigin.beginFill(0xff0000);
		this._particleOrigin.drawCircle(0, 0, 4);
		this._particleOrigin.endFill();
		this.addChild(this._particleOrigin);
	}

	this.doubleJumpPS = new cloudkid.Emitter(this.level,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_doublejump"));
	this.doubleJumpPS.emit = false;

	this.bridgeFailMagicPS = new cloudkid.Emitter(this.level,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_doublejump"));
	this.bridgeFailMagicPS.emit = false;

	this.trollMagicPS = new cloudkid.Emitter(this.level,
	[
		this._assetManager.getTexture("particle_sparkle_offset_00"),
		this._assetManager.getTexture("particle_sparkle_offset_01"),
		this._assetManager.getTexture("particle_sparkle_offset_02"),
		this._assetManager.getTexture("particle_sparkle_offset_03")
	], this._assetManager.getJSON("particle_magic_trail"));
	this.trollMagicPS.emit = false;

	// Debug
	if(this.level.debug)
	{
		this.drawCollision();

		var pickupCollisionCircle = new PIXI.Graphics();
		this.addChild(pickupCollisionCircle);
		pickupCollisionCircle.lineStyle(1, 0xF7111D);
		pickupCollisionCircle.drawCircle(0, 0, this.pickupCircle.radius);
		pickupCollisionCircle.x = this.pickupCircle.x;
		pickupCollisionCircle.y = this.pickupCircle.y;

		var axeCollisionCircle = new PIXI.Graphics();
		this.addChild(axeCollisionCircle);
		axeCollisionCircle.lineStyle(1, 0x00ff00);
		axeCollisionCircle.drawCircle(0, 0, this.axeCircle.radius);
		axeCollisionCircle.x = this.axeCircle.x;
		axeCollisionCircle.y = this.axeCircle.y;
	}
};

/**
 * Initialize character
 */
Avatar.prototype.initCharacter = function(character)
{
	switch(character)
	{
		case "anna":
			this.abilities.doubleJump = true;
			this.spineData = Common.characterAnimationData.char_female;
			break;

		case "elsa":
			this.abilities.bridge = true;
			this.spineData = Common.characterAnimationData.char_elsa;
			break;

		case "kristoff":
			this.abilities.slash = true;
			this.spineData = Common.characterAnimationData.char_kristoff;
			break;

		case "olaf":
			this.abilities.shrink = true;
			this.spineData = Common.characterAnimationData.char_olaf;

			this.shrinkPieces = [];

			// Debug pieces
			var pieces = ["olaf_chest_upper_01", "olaf_hip_01", "olaf_ankle_r_01", "olaf_ankle_l_01"]

			for(var i = pieces.length-1; i >= 0; i--)
			{
				var piece = new PIXI.Sprite(this._assetManager.getTexture(pieces[i]));
				piece.anchor.set(0.5);
				piece.alpha = 0;
				this.addChild(piece);
				this.shrinkPieces.push(piece);
			}

			/*
			var pieces =
			[
				{color:0xFF0000, size:20},
				{color:0x00ff00, size:15},
				{color:0x0000FF, size:20}
			];

			for(var i = 0; i < pieces.length; i++)
			{
				var piece = new PIXI.Graphics();
				this.addChild(piece);
				piece.beginFill(pieces[i].color);
				piece.drawCircle(0, 0, pieces[i].size);
				this.shrinkPieces.push(piece);
				piece.alpha = 0;
				piece.endFill();
			}
			*/
			break;

		case "pabbie":
			this.abilities.invulnerability = true;
			this.spineData = Common.characterAnimationData.char_pabbie;
			this.collisionCircleRadius = 40;
			break;
	}


	// Apply character modifiers
	if(!!this._characterData.jumpHeight)         this.jumpHeight         = this._characterData.jumpHeight;
	if(!!this._characterData.doubleJumpHeight)   this.doubleJumpHeight   = this._characterData.doubleJumpHeight;
	if(!!this._characterData.tumbleSpeedMin)     this.tumbleSpeedMin     = this._characterData.tumbleSpeedMin;
	if(!!this._characterData.tumbleSpeedMax)     this.tumbleSpeedMax     = this._characterData.tumbleSpeedMax;
	if(!!this._characterData.tumbleSpeedTime)    this.tumbleSpeedTime    = this._characterData.tumbleSpeedTime;
	if(!!this._characterData.pickupCircleRadius) this.pickupCircleRadius = this._characterData.pickupCircleRadius;
	if(!!this._characterData.trollMagicDuration) this.trollMagicDuration = this._characterData.trollMagicDuration;

	// Apply power ups
	this.tumbleSpeedMax     *= this._powerupsData[0].power[Common.savedData.charactersPower[this._characterData.id][0]];
	this.pickupCircleRadius *= this._powerupsData[1].power[Common.savedData.charactersPower[this._characterData.id][1]];
	this.trollMagicDuration *= this._powerupsData[2].power[Common.savedData.charactersPower[this._characterData.id][2]];
}

/**
 * Dispose
 */
Avatar.prototype.dispose = function()
{
	this.stopLoops();
}

/**
 * Update
 */
Avatar.prototype.update = function()
{
	var prevDistance = this.distance;

	// Animation speed update
	if(this.isRidingVehicle)
		this.spine.update(p3.Timestep.deltaTime);
	else
		this.spine.update(p3.Timestep.deltaTime * this.spineSpeed);

	// Animation update
	if(this.isDead)
	{
		// Do nothing
	}
	else if(this.isShrinking && !this.isRidingVehicle)
	{
		this.setAnimation("run_roll", true);
	}
	else if(this.isInvulnerable && !this.isRidingVehicle)
	{
		this.setAnimation("run_down_steep_rolling_ball", true);
	}
	else if(this.isRidingVehicle)
	{
		console.log('isRidingVehicle');
		if(!this.isGrounded && this.velocity.y > 0)
			this.setAnimation(this.vehicle.riderFallAnimation, true);
		else
			this.setAnimation(this.vehicle.riderAnimation, true);

		if(!this.isGrounded && this.velocity.y > 0)
			this.vehicle.setAnimation('fall', true);
		if(this.isGrounded && !this.isSliding)
			this.vehicle.setAnimation('run_flat', true);
	}
	else if(this.isSlashing)
	{
		// Do nothing
	}
	else if(this.isTumbling)
	{
		// Tumble animation
		this.tumbleSpeed += (this.tumbleSpeedMax - this.tumbleSpeedMin) * (p3.Timestep.deltaTime/this.tumbleSpeedTime);
		if(this.tumbleSpeed > this.tumbleSpeedMax)
			this.tumbleSpeed = this.tumbleSpeedMax;

		if(!this.kJumpPressed)
		{
			this.isTumbling = false;
		}
		else
		{
			if(this.currentAnimation != 'jump_tuck2' && this.currentAnimation != '')
			{
				this.level.changeFocusPoint(this.focusPointFall.point, this.focusPointFall.time, this.focusPointFall.delay);
			}

			this.setAnimation('jump_tuck2', true);
			this.tumbleAngle += this.tumbleSpeed * p3.Timestep.deltaTime * PIXI.DEG_TO_RAD;
		}
	}
	else if(this.isGrounded && !this.isSliding && !!this.collisionPoint)
	{
		// Climbing/run animation
		if(this.isGrounded && this.collisionPoint.angle * PIXI.RAD_TO_DEG <  this.runUpAngle)
			this.setAnimation('run_up2', true);
		// else if(this.isGrounded && this.collisionPoint.angle * PIXI.RAD_TO_DEG <  this.runUpAngle)
			// this.setAnimation('run_up', true);
		else if(this.isGrounded && !!this.collisionPoint.path.config.artificial)
			this.setAnimation('run_flat_magic', true);
		else
			this.setAnimation('run_flat', true);
	}
	else if(!this.isGrounded && this.velocity.y > 0)
	{
		// Fall animation
		if(this.currentAnimation != 'fall' && this.currentAnimation != '')
		{
			this.level.changeFocusPoint(this.focusPointFall.point, this.focusPointFall.time, this.focusPointFall.delay);
		}

		this.setAnimation('fall', true);
	}

	// Slash power update
	if(this.isSlashing)
	{
		this.slashTime += p3.Timestep.deltaTime;

		if(this.slashTime > this.slashTimeMax)
		{
			this.isSlashing = false;
		}
	}

	// Invulnerability update
	if(this.isInvulnerable)
	{
		this.invulnerabilityTime += p3.Timestep.deltaTime;

		if(this.invulnerabilityTime > this.invulnerabilityTimeMax)
		{
			this.isInvulnerable = false;
			this.canTumble = true;
		}
	}

	// Increment animation speed relative to the running speed
	if(this.currentAnimation == "run_flat" && this.runSpeed > this.runSpeedMin)
		this.spineSpeed = 1 + 0.5 * ((this.runSpeed-this.runSpeedMin)/(this.runSpeedMax-this.runSpeedMin));
	else
		this.spineSpeed = 1;

	// Movement
	var oldVelocity = new p3.Vector2(this.velocity.x, this.velocity.y);
	var wasSliding  = this.isSliding;
	var wasGrounded = this.isGrounded;
	var wasRiding   = this.isRidingVehicle;

	if(!this.isDead)
	{
		// When touching real ground reset the canCreateBridge flag
		if(!this.canCreateBridge && this.isGrounded)
		{
			if(!this.collisionPoint.path.config.artificial)
			{
				this.canCreateBridge = true;
			}
		}

		// Input
		this.kJumpStart = this.kJumpStart || Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_UP);
		this.kJumpEnd   = this.kJumpEnd   || Common.keyboard.getKeyJustReleased(Common.keyboard.KEY_UP);
		this.kAbility   = this.kAbility   || (Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_Z) || Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_ENTER));

		if(this.areInputActive)
		{
			if(this.kJumpStart)
			{
				this.jump();
				this.kJumpPressed = true;
			}
			else if(this.kJumpEnd)
			{
				this.jumpEnd();
				this.kJumpPressed = false;
			}
			if(this.kAbility)
			{
				if(this.isRidingVehicle)
				{
					this.vehicle.dismount(false);
				}
				else
				{
					if(this.abilities.bridge)
						this.powerBridge();
					else if(this.abilities.slash)
						this.powerSlash();
					else if(this.abilities.shrink)
						this.powerShrink();
					else if(this.abilities.invulnerability)
						this.powerInvulnerability();
				}
			}
		}

		this.kJumpStart = false;
		this.kJumpEnd   = false;
		this.kAbility   = false;

		// Speed increase/decrease
		if(this.isSliding)
			this.runSpeed += this.accelerationSliding * p3.Timestep.deltaTime;
		else if(this.isGrounded && this.collisionPoint.angle * PIXI.RAD_TO_DEG > this.runDownAngle)
			this.runSpeed += this.accelerationSlopeDown * p3.Timestep.deltaTime;
		else if(this.isGrounded && this.collisionPoint.angle * PIXI.RAD_TO_DEG < this.runUpAngle)
			this.runSpeed += this.accelerationSlopeUp * p3.Timestep.deltaTime;
		else
			this.runSpeed += this.accelerationNormal * p3.Timestep.deltaTime;

		this.runSpeed = Math.max(Math.min(this.runSpeed, this.isSliding ? this.slidingSpeedMax : this.runSpeedMax), this.runSpeedMin);
		this.velocity.x = this.runSpeed;

		// Sliding
		if(!this.isSliding && this.isGrounded && this.collisionPoint.angle * PIXI.RAD_TO_DEG >  this.slidingAngleStart && !this.isSlashing)
		{
			this.isSliding     = true;
			this.timeUnsliding = 0;

			if(this.isRidingVehicle)
				this.vehicle.setAnimation('slide_down_steep', true);
			else if(this.isOlaf())
				this.setAnimation('run_down_steep', true);
			else if(this.isPabbie())
				this.setAnimation('run_down_steep_rolling_ball', true);
			else
			{
				this.setAnimation('slide_down_steep', true);
				this.angleTarget = 0;
			}

			// Zoom in while sliding
			this.level.changeZoom(this.zoomSlide.zoom, this.zoomSlide.time);
			this.level.changeFocusPoint(this.focusPointSlide.point, this.focusPointSlide.time, this.focusPointSlide.delay);
		}
		else if(this.isSliding && (!this.collisionPoint || (this.collisionPoint.angle * PIXI.RAD_TO_DEG < this.slidingAngleEnd)))
		{
			this.timeUnsliding += p3.Timestep.deltaTime;

			 if(this.isRidingVehicle)
				this.vehicle.setAnimation('slide_down_exit', true);
			else
				this.setAnimation('slide_down_exit', true);

			if(this.timeUnsliding >= this.timeUnslidingEnd)
			{
				this.isSliding = false;
				this.setAnimation('run_flat', true);
			}
		}

		// Manual movement
		/* if(Common.keyboard.getKeyPressed(Common.keyboard.KEY_A))
		{
			this.velocity.x = -800;
			this.animationHolder.scale.x = -1;
		}
		else if(Common.keyboard.getKeyPressed(Common.keyboard.KEY_D))
		{
			this.velocity.x = +800;
			this.animationHolder.scale.x = 1;
		}
		else
			this.velocity.x = 0; */

	}

	// Gravity
	this.velocity.y += this.gravity * p3.Timestep.deltaTime;
	if(this.velocity.y >= this.gravity/2) this.velocity.y = this.gravity/2;

	// Rotation update
	if(this.isShrinking)
	{
		this.animationHolder.rotation = 0;
	}
	else if(this.isTumbling)
	{
		this.animationHolder.rotation = this.angleTarget;
	}
	else
	{
		var angleDiff = Math.atan2(Math.sin(this.angleTarget - this.animationHolder.rotation), Math.cos(this.angleTarget - this.animationHolder.rotation));
		this.animationHolder.rotation = this.animationHolder.rotation + (angleDiff * this.angleSpeed);
	}


	// Collision Check
	this.move(this.velocity);


	// Shrink power update
	if(this.isShrinking || this.isUnshrinking)
	{
		this.shrinkTime += p3.Timestep.deltaTime;

		// Update old position's timer
		for(var i = 0; i < this.positionCache.length; i++)
		{
			this.positionCache[i].time += p3.Timestep.deltaTime;

			if(this.positionCache[i].time > this.shrinkPieces.length * this.shrinkPieceDelay)
			{
				this.positionCache.splice(i+1, 100);
				break;
			}
		}

		// Add the current position
		this.positionCache.unshift({time:0, position:new PIXI.Point(this.x, this.y)});

		// Update the pieces position
		for(var p = 0; p < this.shrinkPieces.length; p++)
		{
			var targetTime = (this.shrinkPieces.length-p) * this.shrinkPieceDelay;

			// When unshrinking, move the pieces to the characters
			if(this.isUnshrinking)
			{
				targetTime *= (1 - this.shrinkTime/this.shrinkTransitionTime);
			}

			// If there aren't enough points yet keep the pieces to the starting location
			if(this.positionCache[this.positionCache.length-1].time < targetTime)
			{
				this.shrinkPieces[p].x = this.positionCache[this.positionCache.length-1].position.x - this.x;
				this.shrinkPieces[p].y = this.positionCache[this.positionCache.length-1].position.y - this.y;
			}
			else
			{
				for(var i = this.positionCache.length-1; i > 0; i--)
				{
					if(this.positionCache[i-1].time < targetTime)
					{
						var p0 = this.positionCache[i-1];
						var p1 = this.positionCache[i];
						var t0 = p0.time;
						var t1 = p1.time - t0;
						var perc = Math.max(0, Math.min(1, (targetTime - t0) / t1));

						this.shrinkPieces[p].x = p0.position.x + (p1.position.x-p0.position.x)*perc - this.x;
						this.shrinkPieces[p].y = p0.position.y + (p1.position.y-p0.position.y)*perc - this.y + 20;

						break;
					}
				}
			}

			// Update the rotation
			this.shrinkPieces[p].rotation += this.shrinkPieceRotationSpeed * PIXI.DEG_TO_RAD * p3.Timestep.deltaTime;
		}

		// At the end of the shrink delay, unshrink
		if(this.isShrinking && this.shrinkTime > this.shrinkTimeMax && !this.isShrinkLocked)
		{
			this.powerUnshrink();
		}
	}

	// Undo gravity when touching ground
	if(this.isGrounded)
	{
		this.velocity.y = 0;

		if(!wasGrounded && !this.isDead)
		{
			this.land();
		}
	}

	// Falling time
	if(!this.isGrounded && this.velocity.y > 0)
		this.fallTime += p3.Timestep.deltaTime;
	else if(this.fallTime != 0)
		this.fallTime = 0;

	// Collisions with objects
	this.collisions();


	if(!this.isDead)
	{
		// Zoom
		if(wasSliding && !this.isSliding)
		{
			// Zoom out when not sliding anymore
			this.level.changeZoom(this.zoomSlideEnd.zoom, this.zoomSlideEnd.time);

			// Reset the focus point
			if(this.isGrounded)
			{
				this.level.changeFocusPoint(this.focusPointLand.point, this.focusPointLand.time, this.focusPointLand.delay);
			}

			SoundSFX.stop("sfx_snow_slide_loop_00");
		}

		if(this.canTumble && !this.isGrounded && !this.isRidingVehicle && oldVelocity.y <= this.tumbleSpeedYStart && this.velocity.y > this.tumbleSpeedYStart && this.kJumpPressed)
		{
			this.isTumbling    = true;
			this.tumbleAngle   = 0;
			this.canTumble     = false;
			this.canDoubleJump = false;
			this.tumbleSpeed   = this.tumbleSpeedMin;
		}

		// Headbob
		/* if(this.isSliding || !this.isGrounded || this.isDead)
		{
			this.headbobTime = 0;
		}
		else
		{
			this.headbobTime += p3.Timestep.deltaTime;
		} */
	}

	// Running sounds
	if(this.isDead)
	{
		this.stopLoops();
	}
	else if(this.isGrounded && this.isRidingVehicle)
	{
		if(this.isSliding && this.timeUnsliding > 0)
			this.playLoop("sfx_snow_slide_loop_00");
		else if(this.vehicle.type == "sven")
			this.playLoop("sfx_sven_run_02");
	}
	else if(this.isGrounded && (this.isSliding || this.isShrinking))
	{
		this.playLoop("sfx_snow_slide_loop_00");
	}
	else if(this.isGrounded)
	{
		switch(Common.savedData.character)
		{
			case "anna":
			case "elsa":
				this.playLoop("sfx_anna_snow_runvsoft_00");
				break;

			case "kristoff":
				this.playLoop("sfx_kristoff_snow_runvsoft_00");
				break;

			case "olaf":
				this.playLoop("sfx_generic_olaf_snow_runvsoft_00");
				break;
		}
	}
	else
	{
		this.stopLoops();
	}

	// Axe sound
	if(!!this.slashSFX && !this.isSlashing)
	{
		this.slashSFX.stop();
		this.slashSFX = null;
	}

	// Kristoff's axe
	// if(this.axe)
		// this.axe.update();


	// Troll Magic
	if(this.isTrollMagic)
	{
		this.trollMagicTime -= p3.Timestep.deltaTime;

		if(this.trollMagicTime < 0)
		{
			this.trollMagicEnd();
			this.animationHolder.alpha = 1;
		}
		else if(this.trollMagicTime < 2.5 && this.trollMagicTime > 0.5)
		{
			// Blink when the effect is almost ended
			this.animationHolder.alpha = (((this.trollMagicTime-0.5) % 0.2) < 0.1) ? 0.25 : 1;
		}
		else
		{
			this.animationHolder.alpha = 1;
		}
	}

	// Particles
	if(this.isRidingVehicle && this.isGrounded)
	{
		var v1 = new PIXI.Point(this.collisionCircle.radius * Math.cos(this.collisionPoint.angle), this.collisionCircle.radius * Math.sin(this.collisionPoint.angle));
		var v2 = new PIXI.Point(this.collisionCircle.radius * Math.sin(this.collisionPoint.angle), this.collisionCircle.radius * Math.cos(this.collisionPoint.angle));
		this.snowTrailPS.updateSpawnPos(this.x + v1.x - v2.x, this.y + v1.y + v2.y);
	}
	else if(this.timeUnsliding < 0.1)
	{
		this.snowTrailPS.updateSpawnPos(this.x - 10 + p3.Utils.randomInt(-5,5), this.y + this.collisionCircle.radius + 30);
	}
	else
	{
		this.snowTrailPS.updateSpawnPos(this.x + 10, this.y + this.collisionCircle.radius - 10);
	}

	this.snowTrailPS.emit = this.isSliding;
	this.snowTrailPS.update(p3.Timestep.deltaTime);


	this.doubleJumpPS.updateSpawnPos(this.x, this.y + this.collisionCircle.radius);
	this.doubleJumpPS.update(p3.Timestep.deltaTime);

	this.bridgeFailMagicPS.updateSpawnPos(this.x + this.collisionCircle.radius, this.y - this.collisionCircle.radius);
	this.bridgeFailMagicPS.update(p3.Timestep.deltaTime);

	this.trollMagicPS.updateSpawnPos(this.x, this.y);
	this.trollMagicPS.update(p3.Timestep.deltaTime);

	if(this.level.debug)
		this._particleOrigin.position.set(this.snowTrailPS.spawnPos.x - this.x, this.snowTrailPS.spawnPos.y - this.y)

	// Goals: movement
	if(!this.isDead && this.areInputActive && prevDistance < this.distance)
	{
		if(this.isSliding)
			Common.goalsManager.trackEvent("slide", this.distance - prevDistance);

		if(this.isRidingVehicle)
		{
			Common.goalsManager.trackEvent("ride_" + this.vehicle.type, this.distance - prevDistance);
		}

		Common.goalsManager.trackEvent("run", this.distance - prevDistance);
	}
};

/**
 * Stop the current loops
 */
Avatar.prototype.stopLoops = function()
{
	if(this.walkLoop != "")
	{
		SoundSFX.stop(this.walkLoop);
		this.walkLoop = "";
	}
}

/**
 * Stop the current loop and play a new one, if different
 * @param {String} audio
 */
Avatar.prototype.playLoop = function(audio)
{
	if(this.walkLoop == audio) return;

	this.stopLoops();
	this.walkLoop = audio;
	SoundSFX.play(this.walkLoop, {loop:true});
}

/**
 * Handle collisions with objects
 */
Avatar.prototype.collisions = function()
{
	var avatarObstacleCollisionCircle = new PIXI.Circle(this.x + this.collisionCircle.x,  this.y + this.collisionCircle.y, this.collisionCircle.radius);
	var avatarPickupCollisionCircle   = new PIXI.Circle(this.x + this.pickupCircle.x,     this.y + this.pickupCircle.y,    this.pickupCircle.radius);
	var avatarAxeCollisionCircle      = new PIXI.Circle(this.x + this.axeCircle.x,        this.y + this.axeCircle.y,       this.axeCircle.radius);


	// End of level
	var level_end = this.level.objectManager.getObjectsOfType("level_end");

	for(var i = 0; i < level_end.length; i++)
	{
		if(!level_end[i].interactive) continue;
		if(this.checkCollision(avatarObstacleCollisionCircle, level_end[i]))
		{
			level_end[i].hit();
		}
	}

	if(!this.isDead)
	{
		// Zoom
		var camera_zoom = this.level.objectManager.getObjectsOfType("camera_zoom");

		for(var i = 0; i < camera_zoom.length; i++)
		{
			if(!camera_zoom[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, camera_zoom[i]))
			{
				camera_zoom[i].hit();
			}
		}

		// Coins
		var coins = this.level.objectManager.getObjectsOfType("coin");

		for(var i = 0; i < coins.length; i++)
		{
			if(!coins[i].interactive) continue;
			if(this.checkCollision(avatarPickupCollisionCircle, coins[i]))
			{
				 if(coins[i].pickup(this))
				 {
					 // Score
					 this.level.snowflakes++;

					 // Goals: coins
					 Common.goalsManager.trackEvent("coins");
				 }
			}
		}

		// Crystals
		var crystals = this.level.objectManager.getObjectsOfType("crystal");

		for(var i = 0; i < crystals.length; i++)
		{
			if(!crystals[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, crystals[i]))
			{
				 if(crystals[i].pickup(this))
				 {
					 // Goals: crystals
					 Common.goalsManager.trackEvent("crystals");
				 }
			}
		}

		// Troll
		if(Common.savedData.character == "pabbie")
		{
			var trolls = this.level.objectManager.getObjectsOfType("troll");

			for(var i = 0; i < trolls.length; i++)
			{
				if(!trolls[i].interactive) continue;
				if(this.checkCollision(avatarObstacleCollisionCircle, trolls[i]))
				{
					 if(trolls[i].pickup(this))
					 {
						 // Goals: trolls
						 // Common.goalsManager.trackEvent("trolls");
					 }
				}
			}
		}

		// Troll magic
		var powerups = this.level.objectManager.getObjectsOfType("powerup");

		for(var i = 0; i < powerups.length; i++)
		{
			if(!powerups[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, powerups[i]))
			{
				 if(powerups[i].pickup(this))
				 {
					 this.trollMagic();

					 // Goals: powerups
					 Common.goalsManager.trackEvent("powerups");
				 }
			}
		}

		// Obstacles
		var obstacles = this.level.objectManager.getObjectsOfType("obstacle");

		for(var i = 0; i < obstacles.length; i++)
		{
			if(!obstacles[i].interactive) continue;
			if(this.isSlashing && obstacles[i].iceBlock && this.checkCollision(avatarAxeCollisionCircle, obstacles[i]))
			{
				obstacles[i].destroy("axe");
			}
			else if(this.checkCollision(avatarObstacleCollisionCircle, obstacles[i]))
			{
				if(this.isTrollMagic)
				{
					obstacles[i].destroy("magic");
				}
				else if(this.isInvulnerable)
				{
					obstacles[i].destroy("invulnerability");
				}
				else
				{
					obstacles[i].hit(this)
					this.death();
				}
			}
		}

		// Snowballs
		var snowballs = this.level.objectManager.getObjectsOfType("snowball");

		for(var i = 0; i < snowballs.length; i++)
		{
			if(!snowballs[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, snowballs[i]))
			{
				if(!this.isInvulnerable)
				{
					snowballs[i].hit(this);
					this.level.shake(0.5, new PIXI.Point(8,12));
					this.death();
				}
				else
				{
					snowballs[i].destroy(false);
				}
			}
		}

		// Platforms
		var jump_platforms = this.level.objectManager.getObjectsOfType("jump_platform");

		for(var i = 0; i < jump_platforms.length; i++)
		{
			if(!jump_platforms[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, jump_platforms[i]))
			{
				jump_platforms[i].hit(this)
			}
		}

		// Vehicles
		if(!this.isShrinking && !this.isUnshrinking && !this.isRidingVehicle)
		{
			var vehicles = this.level.objectManager.getObjectsOfType("sven");

			for(var i = 0; i < vehicles.length; i++)
			{
				if(!vehicles[i].interactive) continue;
				if(this.checkCollision(avatarObstacleCollisionCircle, vehicles[i]))
				{
					vehicles[i].hit(this);
					// Score
					this.level.styleScore += this._assetManager.getJSON("config").score.vehicle;
				}
			}
		}

		if(!this.isShrinking && !this.isUnshrinking && !this.isRidingVehicle)
		{
			var vehicles = this.level.objectManager.getObjectsOfType("sled");

			for(var i = 0; i < vehicles.length; i++)
			{
				if(!vehicles[i].interactive) continue;
				if(this.checkCollision(avatarObstacleCollisionCircle, vehicles[i]))
				{
					vehicles[i].hit(this);

					// Score
					this.level.styleScore += this._assetManager.getJSON("config").score.vehicle;
				}
			}
		}

		// Shrink locks
		if(this.abilities.shrink)
		{
			if(this.isShrinking)
			{
				var locks = this.level.objectManager.getObjectsOfType("shrink_lock");

				for(var i = 0; i < locks.length; i++)
				{
					if(!locks[i].interactive) continue;
					if(this.checkCollision(avatarObstacleCollisionCircle, locks[i]))
					{
						locks[i].hit(this)
					}
				}
			}
		}

		// Tutorial
		var tutorials = this.level.objectManager.getObjectsOfType("tutorial");

		for(var i = 0; i < tutorials.length; i++)
		{
			if(!tutorials[i].interactive) continue;
			if(this.checkCollision(avatarObstacleCollisionCircle, tutorials[i]))
			{
				tutorials[i].hit(this)
			}
		}
	}
}

/**
 * Jump
 */
Avatar.prototype.jump = function()
{
	if(this.isDead) return;

	if(this.isGrounded)
	{
		// Avoid jumping on steep slopes (only works when going right)
		if(this.collisionPoint && (this.collisionPoint.angle * PIXI.RAD_TO_DEG) < -this.jumpSlopeAngleMax) return;

		this.canDoubleJump = true;
		this.isSliding     = false;
		this.rotation      = 0;
		this.angleTarget   = 0;
		this.isGrounded    = false;

		this.velocity.y    = -this.jumpSpeed;
		this.canTumble     = true;

		if(!this.isRidingVehicle)
			this.setAnimation('jump_normal', false);
		else
			this.vehicle.setAnimation('jump_normal', false);

		// Particles
		this.doubleJumpPS.emit = true;

		// Audio
		this.stopLoops();

		if(this.isRidingVehicle && this.vehicle.type == "sven")
			SoundSFX.playRandomFrom(["sfx_sven_jump_00", "sfx_sven_jump_01", "sfx_sven_jump_02", "sfx_sven_jump_03", "sfx_sven_jump_04"]);
		else
			SoundSFX.playRandomFrom(["sfx_generic_jump_00", "sfx_generic_jump_01", "sfx_generic_jump_02"]);
	}
	else if(this.canDoubleJump && !this.isRidingVehicle && this.abilities.doubleJump)
	{
		this.canDoubleJump = false;

		this.velocity.y = -this.doubleJumpSpeed;

		this.setAnimation('jump_double', false);

		// Particles
		this.doubleJumpPS.emit = true;

		// Audio
		this.stopLoops();
		SoundSFX.playRandomFrom(["sfx_generic_jump_00", "sfx_generic_jump_01", "sfx_generic_jump_02"]);
	}

	// Focus Point
	 this.level.changeFocusPoint(this.focusPointJump.point, this.focusPointJump.time, this.focusPointJump.delay);
};

/**
 * Jump end, when the player stops pressing the jump button
 * Allows variable height jumps
 */
Avatar.prototype.jumpEnd = function()
{
	if(this.isDead) return;
	if(this.isGrounded) return;

	if(this.canDoubleJump || !this.abilities.doubleJump)
	{
		// console.info("Jump end");
		if(this.velocity.y < -this.jumpSpeedMin && this.velocity.y >= -this.jumpSpeed)
		{
			this.velocity.y = -this.jumpSpeedMin;
		}
	}
	else
	{
		// console.info("Double jump end");
		if(this.velocity.y < -this.doubleJumpSpeedMin && this.velocity.y >= -this.doubleJumpSpeed)
		{
			this.velocity.y = -this.doubleJumpSpeedMin;
		}
	}
}

/**
 * Land
 */
Avatar.prototype.land = function()
{
	this.canDoubleJump = false;

	// Land animation and screen shake if falling from high
	if(this.fallTime >= this.fallTimeToLand)
	{
		if(!this.isRidingVehicle)
			this.setAnimation('land', false);
		else
			this.vehicle.setAnimation('land', false);

		this.level.shake(0.25, new PIXI.Point(8,12));

		// Audio
		if(this.distance > 5) // Don't play the sound right at the start of the level
		SoundSFX.playRandomFrom(["sfx_generic_land_heavy_00"]);
	}
	else
	{
		// Audio
		if(this.distance > 5) // Don't play the sound right at the start of the level
		SoundSFX.playRandomFrom(["sfx_generic_land_soft_00"]);
	}

	// Tumble
	this.isTumbling = false;
	var tumbleTimes = Math.floor((this.animationHolder.rotation * PIXI.RAD_TO_DEG + 180) /360);

	this.animationHolder.rotation = this.animationHolder.rotation % (Math.PI * 2);
	var angle = this.animationHolder.rotation * PIXI.RAD_TO_DEG;

	if((this.tumbleDeathAngle.min != this.tumbleDeathAngle.max) && (angle > this.tumbleDeathAngle.min) && (angle < this.tumbleDeathAngle.max) && !this.isImmortal)
	{
		// Tumble death
		this.death();
	}
	else if(tumbleTimes > 0)
	{
		// Tumble bonus
		// console.log("Tumble %i", tumbleTimes);

		// Goals: tumble
		Common.goalsManager.trackEvent("tumble");

		if(tumbleTimes >= 2)
			Common.goalsManager.trackEvent("tumble_double");

		if(tumbleTimes >= 3)
			Common.goalsManager.trackEvent("tumble_triple");

		// Score
		//this.level.styleScore += Math.pow(this._assetManager.getJSON("config").score.tumble, tumbleTimes);
		this.level.styleScore += this._assetManager.getJSON("config").score.tumble * Math.pow(2, tumbleTimes-1);
	}
	else
	{
		// Goals: jump
		if(this.distance > 5) // Ignore fall at the start of the level
		Common.goalsManager.trackEvent("jump");
	}

	// Focus Point
	this.level.changeFocusPoint(this.focusPointLand.point, this.focusPointLand.time, this.focusPointLand.delay);

	// Particles
	if(this.distance > 5) // Ignore fall at the start of the level
		this.doubleJumpPS.emit = true;
}


/**
 * Death
 */
Avatar.prototype.death = function()
{
	if(this.isDead) return;
	if(this.isImmortal) return;
	if(this.isRidingVehicle)
	{
		this.vehicle.dismount(true);
		return;
	}

	this.isDead     = true;
	this.isSliding  = false;
	this.isTumbling = false;
	this.isSlashing = false;

	this.powerUnshrink();
	this.trollMagicEnd();

	this.velocity.x = -1000;

	this.deathTween = new TimelineMax();
	this.deathTween.to(this.velocity, 0.5, {x: 0, ease:Bounce.easeOut},  0);
	Common.animator.add(this.deathTween);


	this.setAnimation('land_bad', false);

	this.level.changeFocusPoint(this.focusPointDeath.point, this.focusPointDeath.time, this.focusPointDeath.delay);
	this.level.changeZoom(this.zoomDeath.zoom, this.zoomDeath.time);

	this.level.gameOver();
	this.stopLoops();
}


/**
 * Bridge power
 */
Avatar.prototype.powerBridge = function()
{

	// if(this.isGrounded) console.log(this.collisionPoint.angle);

	// if(this.isGrounded) return;
	if(this.isTumbling)       return;
	if(!this.canCreateBridge) return;

	if(this.isGrounded && (this.collisionPoint.angle * PIXI.RAD_TO_DEG) < -5)
	{
		// Fails
		this.bridgeFailMagicPS.emit = true;
		SoundSFX.playRandomFrom(["sfx_elsa_ice_magic_platform_fail_00"]);
		return;
	}

	this.isTumbling      = false;
	this.canTumble       = false;
	this.canCreateBridge = false;

	// Create an artificial path
	var points = [];
	points.push({x:this.x, y:this.y + this.collisionCircle.radius + (this.isGrounded ? 10 : 50)});

	var segments      = 4;
	var segmentLength = 200;

	for(var i = 0; i < segments; i++)
	{
		points[i*3+1+2] = {x:this.x + segmentLength * (i+1), y: points[0].y + (i % 2 == 0 ? 10 : -10)};

		points[i*3+1] = {x:this.x + segmentLength * (i+0.33), y: points[i*3].y};
		points[i*3+1+1] = {x:this.x + segmentLength * (i+0.66), y: points[(i+1)*3].y};
	}

	var path =
	{
		bounds            : [points[0].x, points[points.length-1].x],
		closed            : false,
		collisions        : 2,
		data              : "",
		depth             : -1,
		points            : points,
		texFill           : "",
		texFillPadding    : 0,
		texFillSize       : 256,
		texGround         : "elsa_ice_flow_ground_00",
		texGroundDelta    : 0.3,
		texGroundEdge     : "elsa_ice_flow_capl_00",
		texGroundEdgeSide : "",
		texGroundSize     : 64,
		texWall           : "",
		texWallAngle      : 70,
		texWallDelta      : 0,
		texWallSize       : 64,
		artificial        : true
	}

	this.level.getLayer("bridge").queuePaths([path]);

	// Audio
	SoundSFX.playRandomFrom(["sfx_elsa_ice_magic_platform_00", "sfx_elsa_ice_magic_platform_01", "sfx_elsa_ice_magic_platform_02", "sfx_elsa_ice_magic_platform_03"]);
}

/**
 * Slash power
 */
Avatar.prototype.powerSlash = function()
{
	if(this.isTumbling) return;
	if(this.isSlashing) return;

	this.slashSFX = SoundSFX.play("sfx_kristoff_swing_axe_02", {loop:true});

	this.setAnimation('run_flat_magic', true);
	this.isSlashing = true;
	this.slashTime = 0;
}

/**
 * Invulnerability power
 */
Avatar.prototype.powerInvulnerability = function()
{
	if(this.isTumbling) return;
	if(this.isInvulnerable) return;
	// if(this.isSliding) return;

	this.setAnimation('run_down_steep_rolling_ball', true);
	this.isInvulnerable = true;
	this.invulnerabilityTime = 0;

	this.canTumble = false;
}

/**
 * Shrink power
 */
Avatar.prototype.powerShrink = function()
{
	if(this.isShrinking)    return;
	if(this.isUnshrinking)  return;
	if(this.isShrinkLocked) return;
	if(this.isTumbling)     return;

	this.isShrinking    = true;
	this.shrinkTime     = 0;
	this.isShrinkLocked = false;
	this.canTumble      = false;
	this.positionCache  = [];

	var tl = new TimelineMax();
	tl.to(this.collisionCircle, this.shrinkTransitionTime, {radius:35, ease:Linear.easeNone, onUpdate:function(){this.spine.y = this.collisionCircle.radius; if(this.level.debug){this.drawCollision();}}, onUpdateScope:this},0);
	// tl.to(this.animationHolder.scale, this.shrinkTransitionTime, {x:0.5, y:0.5, ease:Linear.easeNone},0);

	for(var p = 0; p < this.shrinkPieces.length; p++)
	{
		this.shrinkPieces[p].x = 0;
		this.shrinkPieces[p].y = 0;
		tl.to(this.shrinkPieces[p], this.shrinkTransitionTime, {alpha:1, ease:Sine.easeOut},0);
	}

	Common.animator.add(tl);
}

/**
 * Unshrink
 */
Avatar.prototype.powerUnshrink = function()
{
	if(!this.isShrinking)  return;
	if(this.isUnshrinking) return;

	this.isShrinking    = false;
	this.isUnshrinking  = true;
	this.shrinkTime     = 0;
	this.isShrinkLocked = false;
	this.canTumble      = true;

	var tl = new TimelineMax({onCompleteScope:this, onComplete:function(){this.isUnshrinking = false}});
	tl.to(this.collisionCircle, this.shrinkTransitionTime, {radius:55, ease:Linear.easeNone, onUpdate:function(){this.spine.y = this.collisionCircle.radius; if(this.level.debug){this.drawCollision();}}, onUpdateScope:this},0);
	// tl.to(this.animationHolder.scale, this.shrinkTransitionTime, {x:1, y:1, ease:Linear.easeNone},0);

	for(var p = 0; p < this.shrinkPieces.length; p++)
	{
		tl.to(this.shrinkPieces[p], this.shrinkTransitionTime, {alpha:0, ease:Sine.easeIn},0);
	}

	Common.animator.add(tl);
}


/**
 * Troll magic
 */
Avatar.prototype.trollMagic = function()
{
	this.isTrollMagic      = true;
	this.trollMagicTime    += this.trollMagicDuration;
	this.trollMagicPS.emit = true;

	Common.bgMusic.stop();
	Common.bgMusic.fadeOut(0, 200);
	Common.bgMusic = SoundSFX.play("mx_troll_magic_rush_loop_02", {loop:true});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 200);
}

Avatar.prototype.trollMagicEnd = function()
{
	if(!!this.isTrollMagic)
	{
		this.isTrollMagic      = false;
		this.trollMagicTime = 0;
		this.trollMagicPS.emit = false;

		Common.bgMusic.stop();
		Common.bgMusic.fadeOut(0, 200);
		Common.bgMusic = SoundSFX.play("mx_frozen_01_gameplay_lp");
		Common.bgMusic.fadeIn(Common.bgMusicVolume, 100);
	}
}


/**
 * Set a spine animation
 * @param {String} id
 * @param {Boolean} loop
 */
Avatar.prototype.setAnimation = function(id, loop)
{
	if(loop && id == this.currentAnimation) return;

	if(this.isShrinking && id != "run_roll" && id != "ride_sven" && id != "ride_sled" ) return;

	if(this.currentAnimation == "land")
		this.spine.state.addAnimationByName(0, id, loop, 0.2);
	else
		this.spine.state.setAnimationByName(0, id, loop, 0);

	this.currentAnimation = id;
}

/**
 * @returns {Boolean}
 */
Avatar.prototype.isOlaf = function()
{
	return Common.savedData.character == "olaf";
}

/**
 * @returns {Boolean}
 */
Avatar.prototype.isKristoff = function()
{
	return Common.savedData.character == "kristoff";
}

/**
 * @returns {Boolean}
 */
Avatar.prototype.isPabbie = function()
{
	return Common.savedData.character == "pabbie";
}


//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================



//===================================================
// GETTERS/SETTERS
//===================================================

Object.defineProperty(Avatar.prototype, "direction", {

	get: function() {
		return Math.sign(this.scale.x);
	}
});

Object.defineProperty(Avatar.prototype, "distance", {

	get: function() {
		return Math.floor(this.x/Common.savedData.unit);
	}
});


//===================================================
},{"../Common":2,"../game/ObjectAxe":21,"../general/Emitter":41,"../general/SoundSFX":44,"./RunningEntity":38}],15:[function(require,module,exports){
var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

function GameObject(type, removeIfOutsideBoundary)
{
    this._assetManager    = p3.AssetManager.instance;

    this.signals          = {};
    this.signals.disposed = new signals.Signal();

    this.id                = null;
	this.type              = type;
	this.collisionRect     = null;
	this.collisionCircle   = null;
	this.areaRect          = null;
	this.interactive       = false;
	this.removeWhenOutside = true;
	
	this.collisionGraphic = null;

	PIXI.Container.call(this);
}
module.exports = GameObject;
GameObject.prototype = Object.create(PIXI.Container.prototype);
GameObject.prototype.constructor = GameObject;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
GameObject.prototype.init = function()
{

};

/**
 */
GameObject.prototype.update = function()
{
    
};

/**
 */
GameObject.prototype.reset = function()
{
	this.x = 0;
	this.y = 0;
    this.removeMe = false;
};

/**
 */
GameObject.prototype.dispose = function()
{
	this.signals.disposed.dispatch(this);
    this.removed = true;
}

/**
 */
GameObject.prototype.pause = function()
{
    
}

/**
 */
GameObject.prototype.resume = function()
{
    
}

/**
 */
GameObject.prototype.drawCollision = function()
{
	if(!!this.collisionGraphic)
		this.removeChild(this.collisionGraphic);
	
    this.collisionGraphic = new PIXI.Graphics();
    this.addChild(this.collisionGraphic);
    this.collisionGraphic.lineStyle(2, 0xF7111D);
	
	if(this.collisionRect != null)
		this.collisionGraphic.drawRect(this.collisionRect.x, this.collisionRect.y, this.collisionRect.width, this.collisionRect.height);
	else if(this.collisionCircle != null)
		this.collisionGraphic.drawCircle(this.collisionCircle.x, this.collisionCircle.y, this.collisionCircle.radius);
}







//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================




//===================================================


},{"../Common":2}],16:[function(require,module,exports){
var Common        = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

function GameUI(level)
{
	this._assetManager = p3.AssetManager.instance;
	PIXI.Container.call(this);

	this.level = level;

	this._canShowGoal      = false;
	this._goalsQueue       = [];
	this._progressBarWidth = 0;
	this._characterData    = this._assetManager.getJSON("config").characters[Common.savedData.character];
	this._crystals         = [];
	this._crystalParticles = [];
	this._crystalSwirlParticle = null;

	this._characters = ["anna", "kristoff", "olaf", "elsa"];

	this._goals = Common.goalsManager.getActiveGoals();

	this._topContainerTween = null;
	this._tutorialTween = null;
}
module.exports = GameUI;
GameUI.prototype = Object.create(PIXI.Container.prototype);
GameUI.prototype.constructor = GameUI;

/**
 * Init
 */
GameUI.prototype.init = function()
{
	// Side stats - coins
	this._coinsContainer = new PIXI.Container();
	this._coinsContainer.y = 60;
	this.addChild(this._coinsContainer);

		this._coinsContainer._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_snowflake_bg"));
		this._coinsContainer._bg.anchor.set(0, 0.5);
		this._coinsContainer._bg.scale.set(0.8);
		this._coinsContainer._bg.x += 10;
		this._coinsContainer.addChild(this._coinsContainer._bg);

		this._coinsContainer._text = new PIXI.extras.BitmapText("0", {font: "28px Superclarendon Numbers", align: "center"});
		this._coinsContainer._text.x = -this._coinsContainer._text.textWidth/2  + this._coinsContainer.width/2 + 18;
		this._coinsContainer._text.y = -this._coinsContainer._text.textHeight/2;
		this._coinsContainer.addChild(this._coinsContainer._text);

		// this._coinsContainer._text = new PIXI.Text("?", {font:"24px Arial", fill:0xffffff, align:'center'});
		// this._coinsContainer._text.x = this._coinsContainer.width/2 + 17;
		// this._coinsContainer._text.anchor.set(0.5);
		// this._coinsContainer.addChild(this._coinsContainer._text);

		this._coinsContainer._snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_gameplay_snowflake"));
		this._coinsContainer._snowflake.x = 15;
		this._coinsContainer._snowflake.anchor.set(0.5);
		this._coinsContainer.addChild(this._coinsContainer._snowflake);

	// Side stats - style
	this._styleContainer = new PIXI.Container();
	this._styleContainer.y = this._coinsContainer.y + 65;
	this.addChild(this._styleContainer);

		this._styleContainer._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_snowflake_bg"));
		this._styleContainer._bg.anchor.set(0, 0.5);
		this._styleContainer._bg.scale.set(0.8);
		this._styleContainer._bg.x += 10;
		this._styleContainer.addChild(this._styleContainer._bg);

		this._styleContainer._text = new PIXI.extras.BitmapText("0", {font: "28px Superclarendon Numbers", align: "center"});
		this._styleContainer._text.x = -this._styleContainer._text.textWidth/2  + this._styleContainer.width/2 + 18;
		this._styleContainer._text.y = -this._styleContainer._text.textHeight/2;
		this._styleContainer.addChild(this._styleContainer._text);

		// this._styleContainer._text = new PIXI.Text("?", {font:"24px Arial", fill:0xffffff, align:'center'});
		// this._styleContainer._text.x = this._styleContainer.width/2 + 17;
		// this._styleContainer._text.anchor.set(0.5);
		// this._styleContainer.addChild(this._styleContainer._text);

		var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_gameplay_style"));
		snowflake.x = 15;
		snowflake.anchor.set(0.5);
		this._styleContainer.addChild(snowflake);

	// Side stats - distance
	if(this.level.endless)
	{
		this._distanceContainer = new PIXI.Container();
		this._distanceContainer.y = this._coinsContainer.y + 130;
		this.addChild(this._distanceContainer);

			this._distanceContainer._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_snowflake_bg"));
			this._distanceContainer._bg.anchor.set(0, 0.5);
			this._distanceContainer._bg.scale.set(0.8);
			this._distanceContainer._bg.x += 10;
			this._distanceContainer.addChild(this._distanceContainer._bg);

			this._distanceContainer._text = new PIXI.extras.BitmapText("0", {font: "28px Superclarendon Numbers", align: "center"});
			this._distanceContainer._text.x = -this._distanceContainer._text.textWidth/2  + this._distanceContainer.width/2 + 18;
			this._distanceContainer._text.y = -this._distanceContainer._text.textHeight/2;
			this._distanceContainer.addChild(this._distanceContainer._text);

			// this._distanceContainer._text = new PIXI.Text("?", {font:"24px Arial", fill:0xffffff, align:'center'});
			// this._distanceContainer._text.x = this._distanceContainer.width/2 + 17;
			// this._distanceContainer._text.anchor.set(0.5);
			// this._distanceContainer.addChild(this._distanceContainer._text);

			var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_gameplay_distance"));
			snowflake.x = 15;
			snowflake.anchor.set(0.5);
			this._distanceContainer.addChild(snowflake);
	}


	// Level - Crystals
	if(!this.level.endless)
	{
		this._topContainer = new PIXI.Container();
		this._topContainer.x = Common.STAGE_WIDTH/2;
		this._topContainer.y = 70;
		this.addChild(this._topContainer);

		if(Common.savedData.character != "pabbie")
		{
			var levelBg = new PIXI.Sprite(this._assetManager.getTexture("ingame_level_bg"));
			levelBg.anchor.set(0.5);
			this._topContainer.addChild(levelBg);

				var copy = this._assetManager.getJSON("strings")["LEVEL"][Common.COUNTRY_CODE];

				if(!webfont)
				{
					var text = new PIXI.extras.BitmapText(copy.replace("{value}", (Common.savedData.level+1)), {font: "24px Superclarendon Level", align: "center"});
					text.x = -text.textWidth/2;
					text.y = -text.textHeight/2 - 8;
					text.alpha = 0.65;
					levelBg.addChild(text);
				}
				else
				{
					var text = new PIXI.Text(copy.replace("{value}", (Common.savedData.level+1)), {font:"24px Arial", fill:0x6d534a, align:'center'});
					text.anchor.set(0.5);
					text.y -= 4;
					levelBg.addChild(text);
				}

				// Crystal container
				this._crystalsContainer = new PIXI.Sprite(this._assetManager.getTexture("ui_loading_crystals_bg"));
				this._crystalsContainer.anchor.set(0.5);
				this._crystalsContainer.y = 60
				this._topContainer.addChild(this._crystalsContainer);

				var crystalsPosition =
				[
					{x:73,  y:161},
					{x:137, y:157},
					{x:204, y:170},
					{x:266, y:180},
					{x:336, y:180},
					{x:405, y:191},
					{x:465, y:180},
					{x:526, y:170},
					{x:578, y:183},
					{x:644, y:174},
					{x:715, y:152},
					{x:790, y:129}
				];

				for(var i = 1; i <= 12; i++)
				{
					// Sprite
					var crystal = new PIXI.Sprite(this._assetManager.getTexture("ui_loading_crystals_" + i));
					crystal.anchor = new PIXI.Point(0.5, 0.5);
					crystal.alpha = Common.savedData.isCrystalCollected(Common.savedData.level, this._characters[Math.floor((i-1)/3)], (i-1)%3) ? 1 : 0;
					this._crystalsContainer.addChild(crystal);
					this._crystals.push(crystal);

					// Particle effect
					var colour = Common.savedData.getColorByCharacter(this._characters[Math.floor((i-1)/3)]);

					var particle = new cloudkid.Emitter(this._crystalsContainer,
					[
						this._assetManager.getTexture("particle_sparkle_00"),
						this._assetManager.getTexture("particle_sparkle_01"),
						this._assetManager.getTexture("particle_sparkle_02"),
						this._assetManager.getTexture("particle_sparkle_03"),
					],
					this._assetManager.getJSON("particle_gem_" + colour + "_ending"));

					particle.emit = false;
					particle.updateSpawnPos(-this._crystalsContainer.width/2 + crystalsPosition[i-1].x/2, -this._crystalsContainer.height/2 + crystalsPosition[i-1].y/2);
					this._crystalParticles.push(particle);
				}

				// Swirl
				// this._crystalSwirlParticle = new cloudkid.Emitter(this._crystalsContainer,
				// [
					// this._assetManager.getTexture("particle_sparkle_00"),
					// this._assetManager.getTexture("particle_sparkle_01"),
					// this._assetManager.getTexture("particle_sparkle_02"),
					// this._assetManager.getTexture("particle_sparkle_03"),
				// ],
				// this._assetManager.getJSON("particle_end_swirltrail_00"));
				// this._crystalSwirlParticle.emit = false;
				// this._crystalSwirlParticle.updateSpawnPos(crystal.x - (crystal.width/2) + ((crystal.width/12)*(this._characters.indexOf(Common.savedData.character)*3)), crystal.height - 50);
		}
		else
		{
			// Current level
			var level_bg = new PIXI.Sprite(this._assetManager.getTexture("ui_level_bg_troll"));
			level_bg.anchor.set(0.5);
			this._topContainer.addChild(level_bg);

				var copy = this._assetManager.getJSON("strings")["LEVEL"][Common.COUNTRY_CODE];

				if(!webfont)
				{
					var text = new PIXI.extras.BitmapText(copy.replace("{value}", (Common.savedData.level+1)), {font: "26px Superclarendon Level", align: "center"});
					text.x = -text.textWidth/2  - 40;
					text.y = -text.textHeight/2 - 8;
					level_bg.addChild(text);
				}
				else
				{
					var text = new PIXI.Text("Level " + (Common.savedData.level+1), {font:"24px Arial", fill:0x000000, align:'center'});
					text.x = - 40;
					text.y = -6;
					text.anchor.set(0.5);
					level_bg.addChild(text);
				}

				var trollCollected = Common.savedData.getLevelCollectedTrollCount(Common.savedData.level);
				var trollCount = 3;

				if(!webfont)
				{
					this._trollCount = new PIXI.extras.BitmapText(trollCollected + "/" + trollCount, {font: "32px Superclarendon Level", align: "center"});
					this._trollCount.x = -this._trollCount.textWidth/2  + 120;
					this._trollCount.y = -this._trollCount.textHeight/2 - 12;
					level_bg.addChild(this._trollCount);
				}
				else
				{
					this._trollCount = new PIXI.Text(trollCollected + "/" + trollCount, {font:"32px Arial", fill:0xffffff, align:'center'});
					this._trollCount.anchor.set(0.5);
					this._trollCount.x += 120;
					this._trollCount.y += -12;
					level_bg.addChild(this._trollCount);
				}

				this._trollCount.trollCollected = trollCollected;
		}

		// Hide crystals UI after a while
		this._topContainerTween = new TimelineMax();
		this._topContainerTween.to(this._topContainer, .5, {alpha:0, ease:Sine.easeInOut}, 2);
		Common.animator.add(this._topContainerTween);
	}

	// Progress bar
	if(!this.level.endless)
	{
		this.progressBar = new PIXI.Container();
		this.progressBar.x = Common.STAGE_WIDTH/2 - this.progressBar.width/2;
		this.progressBar.y = Common.STAGE_HEIGHT - 60;
		this.addChild(this.progressBar)

			this.progressBar.capLeft = new PIXI.Sprite(this._assetManager.getTexture("ingame_progress_cap_" + this._characterData.color + "_l"));
			this.progressBar.capLeft.anchor.set(1, 0.5);
			this.progressBar.addChild(this.progressBar.capLeft);

			this.progressBar.capRight = new PIXI.Sprite(this._assetManager.getTexture("ingame_progress_cap_" + this._characterData.color + "_r"));
			this.progressBar.capRight.anchor.set(0, 0.5);
			this.progressBar.addChild(this.progressBar.capRight);

			var texture = this._assetManager.getTexture("ingame_progress_bar_" + this._characterData.color + "_off");
			this.progressBar.barBg = new PIXI.extras.TilingSprite(texture, 0, texture.height);
			this.progressBar.barBg.anchor.set(0, 0.5);
			this.progressBar.addChild(this.progressBar.barBg);

			var texture = this._assetManager.getTexture("ingame_progress_bar_" + this._characterData.color + "_on");
			this.progressBar.bar = new PIXI.extras.TilingSprite(texture, 0, texture.height);
			this.progressBar.bar.anchor.set(0, 0.5);
			this.progressBar.addChild(this.progressBar.bar);

			this.progressBar.chara = new PIXI.Sprite(this._assetManager.getTexture("ingame_progress_char_" + Common.savedData.character));
			this.progressBar.chara.anchor.set(0.5);
			this.progressBar.chara.scale.set(0.5);
			this.progressBar.bar.addChild(this.progressBar.chara);
	}

	// Tutorial
	this._tutorial = new PIXI.Container();
	this._tutorial.x = Common.STAGE_WIDTH/2;
	this._tutorial.y = 100;
	this._tutorial.scale.set(0);
	this.addChild(this._tutorial);

		this._tutorial.bg = new PIXI.Sprite(this._assetManager.getTexture("ingame_tutorial_text_bg"));
		this._tutorial.bg.anchor.set(0.5);
		this._tutorial.addChild(this._tutorial.bg);

		if(!webfont)
		{
			this._tutorial.label = new PIXI.extras.BitmapText("Test", {font: "24px Superclarendon Level", align: "center"});
			this._tutorial.label.x = -this._tutorial.label.textWidth/2;
			this._tutorial.label.y = -this._tutorial.label.textHeight/2 -6;
			this._tutorial.addChild(this._tutorial.label);
		}
		else
		{
			this._tutorial.label = new PIXI.Text("Text", {font:"24px Arial", fill:0x000000, align:'center', wordWrap:false, lineHeight:32, wordWrapWidth:400});
			this._tutorial.label.anchor.set(0.5);
			this._tutorial.addChild(this._tutorial.label);
		}


	// Goal achieved
	this._goal = new PIXI.Container();
	this._goal.x = Common.STAGE_WIDTH/2;
	this._goal.y = Common.STAGE_HEIGHT/2+250;
	this._goal.scale.set(0);
	this.addChild(this._goal);

		var goal = new PIXI.Sprite(this._assetManager.getTexture("ingame_goal_bg"));
		goal.anchor.set(0.5);
		this._goal.addChild(goal);

		if(!webfont)
		{
			this._goal.label = new PIXI.extras.BitmapText("Text", {font: "24px Mikadan Title", align: "left"});
			this._goal.label.x = -270;
			this._goal.label.y = -this._goal.label.textHeight/2;
			goal.addChild(this._goal.label);
		}
		else
		{
			this._goal.label = new PIXI.Text("Text", {font:"24px Arial", fill:0x58EBD2, align:'left', wordWrap:true, wordWrapWidth:400});
			this._goal.label.x = -260;
			this._goal.label.anchor.set(0, 0.5);
			goal.addChild(this._goal.label);
		}

		this._goal.snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
		this._goal.snowflake.x = 220;
		this._goal.snowflake.anchor.set(0.5);
		this._goal.snowflake.scale.set(0.75);
		this._goal.addChild(this._goal.snowflake);

		this._goal.reward = new PIXI.extras.BitmapText("0", {font: "24px Superclarendon Numbers", align: "center"});
		this._goal.reward.x = -this._goal.reward.textWidth/2 + 285;
		this._goal.reward.y = -this._goal.reward.textHeight/2;
		goal.addChild(this._goal.reward);

		// this._goal.reward = new PIXI.Text("?", {font:"30px Arial", fill:0x58EBD2, align:'center'});
		// this._goal.reward.x = 285
		// this._goal.reward.anchor.set(0.5);
		// this._goal.addChild(this._goal.reward);

		var progress = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_complete"));
		progress.x = -310;
		progress.anchor.set(0.5);
		progress.scale.set(0.6);
		goal.addChild(progress);

	// Snowflakes
	this._goalSnowflakes = [];
	for(var i = 0; i < 30; i++)
	{
		var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
		snowflake.anchor.set(0.5);
		snowflake.alpha = 0;
		this.addChild(snowflake);

		this._goalSnowflakes.push(snowflake);
	}
}

/**
 * Update
 */
GameUI.prototype.update = function()
{
	// Coins, update the position only if the number of characters changes
	if(this._coinsContainer._text.text.length != this.level.snowflakes.toString().length)
	{
		this._coinsContainer._text.x += this._coinsContainer._text.textWidth/2;
		this._coinsContainer._text.text = this.level.snowflakes;
		this._coinsContainer._text.validate();
		this._coinsContainer._text.x -= this._coinsContainer._text.textWidth/2;
	}
	else if(this._coinsContainer._text.text != this.level.snowflakes)
	{
		this._coinsContainer._text.text = this.level.snowflakes;
	}

	// Style
	if(this._styleContainer._text.text.length != this.level.styleScore.toString().length)
	{
		this._styleContainer._text.x += this._styleContainer._text.textWidth/2;
		this._styleContainer._text.text = this.level.styleScore;
		this._styleContainer._text.validate();
		this._styleContainer._text.x -= this._styleContainer._text.textWidth/2;
	}
	else if(this._styleContainer._text.text != this.level.styleScore)
	{
		this._styleContainer._text.text = this.level.styleScore;
	}

	// Distance
	if(this.level.endless)
	{
		var newDistance = this.level.avatar.distance + "m";
		if(this._distanceContainer._text.text.length != newDistance.length)
		{
			this._distanceContainer._text.x += this._distanceContainer._text.textWidth/2;
			this._distanceContainer._text.text = newDistance;
			this._distanceContainer._text.validate();
			this._distanceContainer._text.x -= this._distanceContainer._text.textWidth/2;
		}
		else if(this._distanceContainer._text.text != newDistance)
		{
			this._distanceContainer._text.text = newDistance;
		}
	}

	// Progress bar
	if(!this.level.endless)
	{
		this.progressBar.bar.width = Math.max(0, Math.min(1, (this.level.avatar.x / this.level.config.length))) * this._progressBarWidth;
		this.progressBar.chara.x = this.progressBar.bar.width;
	}

	// Goals
	if(this._goalsQueue.length > 0 && this._canShowGoal)
	{
		this.showGoal();
	}

	for(var i = 0; i < this._crystalParticles.length; i++)
	{
		this._crystalParticles[i].update(p3.Timestep.deltaTime)
	}

	// if(this._crystalSwirlParticle)
	// {
		// this._crystalSwirlParticle.update(p3.Timestep.deltaTime);
	// }
}

/**
 * Resize
 */
GameUI.prototype.resize = function()
{
	if(this._coinsContainer)
		this._coinsContainer.x = this.parent._getFirstButtonPositionLeft() - 40;

	if(this._styleContainer)
		this._styleContainer.x = this.parent._getFirstButtonPositionLeft() - 40;

	if(this._distanceContainer)
		this._distanceContainer.x = this.parent._getFirstButtonPositionLeft() - 40;

	if(!this.level.endless)
	{
		this._progressBarWidth        = Math.round(Math.min(Common.STAGE_WIDTH, p3.View.width) - 100);
		this.progressBar.capLeft.x   = -this._progressBarWidth/2;
		this.progressBar.capRight.x  = this._progressBarWidth/2;
		this.progressBar.barBg.x     = -this._progressBarWidth/2;
		this.progressBar.barBg.width = this._progressBarWidth;
		this.progressBar.bar.x       = -this._progressBarWidth/2;
	}
}

/**
 * Add a goal to the display queueGoal
 * @param {String} text
 * @param {Number} reward
 */
GameUI.prototype.queueGoal = function(text, reward)
{
	this._goalsQueue.push({text:text, reward:reward});
}

/**
 * Show a goal from the queue
 */
GameUI.prototype.showGoal = function()
{
	this._canShowGoal = false;
	var goal = this._goalsQueue.splice(0,1)[0];

	this._goal.label.text = goal.text;

	this._goal.reward.x += this._goal.reward.textWidth;
	this._goal.reward.text = goal.reward.toString();
	this._goal.reward.validate();
	this._goal.reward.x -= this._goal.reward.textWidth;

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function(){this._canShowGoal = true;}
	});

	tl.to(this._goal.scale, .5, {x:1, y:1, ease:Back.easeOut},0);
	tl.to(this._goal.scale, .5, {x:0, y:0, ease:Back.easeIn},2);
	Common.animator.add(tl);

	// Snowflakes animation
	/*
	var count    = 0;
	var countMax = 10;
	var tl = new TimelineMax();
	for(var i = 0; i < this._goalSnowflakes.length && count < countMax; i++)
	{
		var s = this._goalSnowflakes[i];
		if(s.alpha > 0) continue;

		s.position.set(this._goal.x + this._goal.snowflake.x, this._goal.y + this._goal.snowflake.y);
		s.scale.set(0);
		s.alpha = 1;

		tl.to(s.scale, 1, {x: 1, y: 1, ease:Quart.easeOut}, count * 0.1);
		tl.to(s, 1, {x: this._coinsContainer.x + this._coinsContainer._snowflake.x, y: this._coinsContainer.y + this._coinsContainer._snowflake.y, ease : Sine.easeInOut}, count * 0.1);
		tl.to(s, 0.01, {alpha: 0, ease:Linear.easeNone});

		count++;
	}
	Common.animator.add(tl);
	*/
}

/**
 * Show the list of all the goal for the current level
 * @param {Boolean} showRewards
 */
GameUI.prototype.showGoals = function(showRewards)
{
	// Goals
	var goalsContainer = new PIXI.Container();
	goalsContainer.x = Common.STAGE_WIDTH/2;
	goalsContainer.y = Common.STAGE_HEIGHT/2+150;
	this.addChildAt(goalsContainer, 0);

	var totalReward = 0;

	for(var i = 0; i < this._goals.length; i++)
	{
		var id = this._goals[i].id;
		var goalStatus = Common.goalsManager.getGoalStatus(id);
		var goalReward = this._goals[i].reward;

		var goal = new PIXI.Container();
		goal.y = 55 * i;
		goalsContainer.addChild(goal);

		var bg = new PIXI.Sprite(this._assetManager.getTexture("ingame_goal_bg"));
		bg.anchor.set(0.5);
		goal.addChild(bg);

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(this._goals[i].label, {font: "24px Mikadan Title", align: "left"});
			text.x = -270;
			text.y = -text.textHeight/2;
			goal.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(this._goals[i].label, {font:"24px Arial", fill:(goalStatus == 1 ? 0x58EBD2 : 0xFFFFFF), align:'left'});
			text.x = -270;
			text.anchor.set(0, 0.5);
			goal.addChild(text);
		}

		var progress = new PIXI.Container();
		progress.x = -310;
		progress.scale.set(0.6);
		goal.addChild(progress);

			var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_bar"));
			progressBg.anchor.set(0.5);
			progress.addChild(progressBg);

			if(goalStatus == 1)
			{
				var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_complete"));
				progressBg.anchor.set(0.5);
				progress.addChild(progressBg);
			}
			else
			{
				var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_bar"));
				progressBg.anchor.set(0.5);
				progress.addChild(progressBg);

				if(goalStatus > 0)
				{
					var progressBar = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_fill"));
					progressBar.anchor.set(0.5);
					progress.addChild(progressBar);

						var canvas = document.createElement('canvas');
						canvas.width  = 128;
						canvas.height = 128;
						var ctx = canvas.getContext("2d");

						ctx.moveTo(canvas.width/2, canvas.height/2);
						ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2, -Math.PI/2, 2*Math.PI*goalStatus-Math.PI/2);
						ctx.lineTo(canvas.width/2, canvas.height/2);
						ctx.fillStyle = 'white';
						ctx.fill();

						var mask = new PIXI.Sprite(PIXI.Texture.fromCanvas(canvas));
						mask.anchor.set(0.5);
						progressBar.addChild(mask);
						progressBar.mask = mask;
				}
			}

		if(showRewards && goalStatus == 1)
		{
			totalReward += goalReward;

			var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
			snowflake.x = 220;
			snowflake.anchor.set(0.5);
			snowflake.scale.set(0.75);
			goal.addChild(snowflake);

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(goalReward.toString(), {font: "24px Superclarendon Numbers", align: "center"});
				text.x = -text.textWidth/2 + 285;
				text.y = -text.textHeight/2;
				goal.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(goalReward, {font:"24px Arial", fill: (goalStatus == 1 ? 0x58EBD2 : 0xFFFFFF), align:'center'});
				text.x = 285;
				text.anchor.set(0.5);
				goal.addChild(text);
			}

			// Snowflakes particles
			var count    = 0;
			var countMax = 10;
			var tl = new TimelineMax();
			for(var p = 0; p < this._goalSnowflakes.length && count < countMax; p++)
			{
				var s = this._goalSnowflakes[p];
				if(s.alpha > 0) continue;

				s.position.set(goalsContainer.x + goal.x + snowflake.x, goalsContainer.y + goal.y + snowflake.y);
				s.scale.set(0);
				s.alpha = 1;

				tl.to(s.scale, 1,    {x: 1, y: 1, ease:Quart.easeOut}, (count + i/3) * 0.1);
				tl.to(s,       1,    {x: this._coinsContainer.x + this._coinsContainer._snowflake.x, y: this._coinsContainer.y + this._coinsContainer._snowflake.y, ease : Sine.easeInOut}, (count + i/3) * 0.1);
				tl.to(s,       1,    {rotation:2 * Math.PI, ease:Sine.easeInOut}, (count + i/3) * 0.1);
				tl.to(s,       0.01, {alpha: 0, ease:Linear.easeNone});

				count++;
			}
		}
	}

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function()
		{
			this.removeChild(goalsContainer);
			this._canShowGoal = true;
		}
	});

	// Show goals
	tl.to(goalsContainer, .3, {alpha:1, ease:Sine.easeOut}, 0);
	tl.to(goalsContainer, .3, {y:goalsContainer.y, ease:Sine.easeOut}, 0);

	// Hide goals
	tl.to(goalsContainer, .3, {alpha:0, ease:Sine.easeOut},                  2.5);
	tl.to(goalsContainer, .3, {y:goalsContainer.y + 100, ease:Sine.easeOut}, 2.5);
	Common.animator.add(tl);


	// Increment snowflake score
	if(totalReward != 0)
	{
		var tl = new TimelineMax();
		tl.to(this.level, 1, {snowflakes:this.level.snowflakes + totalReward, ease:Linear.easeNone, onUpdateScope:this, onUpdate:function()
		{
			this.level.snowflakes = Math.floor(this.level.snowflakes);
			console.log(this.level.snowflakes);
		}}, 0.9);

		Common.animator.add(tl);
	}


	goalsContainer.alpha = 0;
	goalsContainer.y += 100;

	this._canShowGoal = false;
}

/**
 * Show a crystal
 * @param {String} character
 * @param {Number} index
 */
GameUI.prototype.crystalCollected = function(character, index)
{
	var tl = new TimelineMax();
		tl.to(this._crystals[this._characters.indexOf(character)*3+index], .25, {alpha:1, ease:Linear.easeNone}, 0.25);
	Common.animator.add(tl);

	// Show and hide the crystal container
	this._topContainerTween.kill();
	this._topContainerTween = new TimelineMax();
		this._topContainerTween.to(this._topContainer, .25, {alpha:1, ease:Sine.easeInOut}, 0);
		this._topContainerTween.to(this._topContainer, .5, {alpha:0, ease:Sine.easeInOut}, 2);
	Common.animator.add(this._topContainerTween);

	if(Common.savedData.getLevelCharacterCrystalCount(Common.savedData.level, character) == 3)
	{
		for(var i = 0; i < 3; i++)
		{
			TweenMax.to(this._crystalParticles[i], 0, {delay:i*.3, onCompleteScope:this, onCompleteParams:[i], onComplete:function(i){
				this._crystalParticles[this._characters.indexOf(character)*3+i].emit = true;
			}});
		}
		// this._crystalSwirlParticle.emit = true;
	}

}

/**
 * Show the troll count
 * @param {String} character
 * @param {Number} index
 */
GameUI.prototype.trollCollected = function()
{
	this._trollCount.trollCollected++;
	var trollCount = 3;
	this._trollCount.text = this._trollCount.trollCollected + "/" + trollCount;

	// Show and hide the crystal container
	this._topContainerTween.kill();
	this._topContainerTween = new TimelineMax();
		this._topContainerTween.to(this._topContainer, .25, {alpha:1, ease:Sine.easeInOut}, 0);
		this._topContainerTween.to(this._topContainer, .5, {alpha:0, ease:Sine.easeInOut}, 2);
	Common.animator.add(this._topContainerTween);
}


/**
 * Show a tutorial message
 * @param {String} text
 */
GameUI.prototype.tutorial = function(text)
{
	if(!webfont)
	{
		this._tutorial.label.x += this._tutorial.label.textWidth/2;
		this._tutorial.label.y += this._tutorial.label.textHeight/2;
		this._tutorial.label.text = text;
		this._tutorial.label.validate();
		this._tutorial.label.x -= this._tutorial.label.textWidth/2;
		this._tutorial.label.y -= this._tutorial.label.textHeight/2;
	}
	else
	{
		this._tutorial.label.text = text;
	}

	// Show and hide the tutorial container
	this._tutorialTween = new TimelineMax();
		this._tutorialTween.to(this._tutorial.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0);
		this._tutorialTween.to(this._tutorial.scale, .5, {x:0, y:0, ease:Back.easeIn}, 2);
	Common.animator.add(this._tutorial);
}

/**
 * Highlight a UI element
 * @param {String} text
 */
GameUI.prototype.highlight = function(what)
{
	if(!this._highlight)
	{
		this._highlight = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_nav_play"));
		this._highlight.anchor.set(0.5);
		this.addChild(this._highlight);
	}

	// Position
	switch(what)
	{
		case "style":
			this._highlight.position.set(this._styleContainer.x + 200, this._styleContainer.y);
			this._highlight.scale.set(-1, 1);
			break;

		default:
			return;
			this._highlight.scale.set(0, 0);
			break;
	}

	// Animation
	if(!!this._highlightTween)
		this._highlightTween.kill();

	this._highlightTween = new TimelineMax();
		this._highlightTween.to(this._highlight.scale, .3, {x:this._highlight.scale.x, y:this._highlight.scale.y, ease:Back.easeOut}, 0);
		this._highlightTween.to(this._highlight.scale, .3, {x:0, y:0, ease:Back.easeIn}, 2);
	Common.animator.add(this._highlightTween);

	this._highlight.scale.set(0, 0);

}

/**
 * Hide the UI when the game's over
 */
GameUI.prototype.gameOver = function()
{
	var tl = new TimelineMax();

		// Show the goals list
		tl.to(this._goal, .5, {alpha:0, ease:Linear.easeNone}, 0);

		// Hide the progress bar
		if(!this.level.endless)
			tl.to(this.progressBar, .5, {alpha:0, ease:Linear.easeNone}, 0);

	Common.animator.add(tl);

	// Show and hide the crystal container
	if(!this.level.endless && this.level.completed)
	{
		this._topContainerTween.kill();
		this._topContainerTween = new TimelineMax();
		this._topContainerTween.to(this._topContainer, .25, {alpha:1, ease:Sine.easeInOut}, 0);
		Common.animator.add(this._topContainerTween);
	}
}
},{"../Common":2}],17:[function(require,module,exports){
var Common        = require("../Common");

var BezierPath         = require("../editor/BezierPath");
var LevelLayer         = require("../game/LevelLayer");
var LevelPath          = require("../game/LevelPath");
var Avatar             = require("../game/Avatar");
var ObjectManager      = require("../game/ObjectManager");
var ObjectCoin         = require("../game/ObjectCoin");
var ObjectPowerup      = require("../game/ObjectPowerup");
var ObjectCrystal      = require("../game/ObjectCrystal");
var ObjectObstacle     = require("../game/ObjectObstacle");
var ObjectDecoration   = require("../game/ObjectDecoration");
var ObjectCameraZoom   = require("../game/ObjectCameraZoom");
var ObjectJumpPlatform = require("../game/ObjectJumpPlatform");
var ObjectLevelEnd     = require("../game/ObjectLevelEnd");
var ObjectShrinkLock   = require("../game/ObjectShrinkLock");
var ObjectTutorial     = require("../game/ObjectTutorial");
var ObjectSven         = require("../game/ObjectSven");
var ObjectSled         = require("../game/ObjectSled");
var ObjectMarshmallow  = require("../game/ObjectMarshmallow");
var ObjectTroll        = require("../game/ObjectTroll");
var ObjectSnowball     = require("../game/ObjectSnowball");
var Shockwave          = require("../game/Shockwave");
var LevelRecord        = require("../game/LevelRecord");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Level(endless, data, backgroundPrefix)
{
	this._assetManager = p3.AssetManager.instance;
	PIXI.Container.call(this);

	this.debug            = false;
	this.data             = data;
	this.backgroundPrefix = backgroundPrefix;
	this.layerContainer   = null;
	this.layers           = [];
	this.objectManager    = null;
	this.endless          = endless;
	this.completed        = false;
	this.snowflakes       = 0;
	this.score            = 0;
	this.styleScore       = 0;
	this.defaultZoom      = 0.8;

	if(data != "")
	{
		if(!this.endless)
		{
			console.log(this._assetManager.getJSON(data));
			this.config = this._assetManager.getJSON(data);
		}
		else
		{
			console.log(this._assetManager.getJSON(data.start[0]));
			this.config  = this._assetManager.getJSON(data.start[0]);
		}
	}

	// Avatar
	this.avatar     = new Avatar();
	this.focusPoint = new PIXI.Point(this.avatar.focusPointLand.point.x, this.avatar.focusPointLand.point.y);
	this.focusXActive = true;
	this.focusYActive = true;
	this.focusPosition = new PIXI.Point(0,0);
	this.focusPointTween = null;

	// Zoom
	this.zoom       = 1;
	this.zoomTarget = 1;
	this.zoomTween  = null;

	// Shake
	this._isShake       = false;
	this._shakeTime     = 0;
	this._shakeTimeEnd  = 1;
	this._shakeStrength = new PIXI.Point(10,10);

	// Shockwave effect
	this._shockwave = null;
	this._shockwaveTexture = this._assetManager.getTexture("shockwave");
}
module.exports = Level;
Level.prototype = Object.create(PIXI.Container.prototype);
Level.prototype.constructor = Level;

/**
 * Init
 */
Level.prototype.init = function()
{
	// Load objects
	var pools =
	[
		{id:"default",         pool:"default",         base:ObjectDecoration,    args:[], quantity: 20},
		{id:"coin",            pool:"coin",            base:ObjectCoin,          args:[], quantity: 20},
		{id:"troll_magic",     pool:"troll_magic",     base:ObjectPowerup,       args:[]},
		{id:"crystal_cyan",    pool:"crystal_cyan",    base:ObjectCrystal,       args:["cyan"]},
		{id:"crystal_green",   pool:"crystal_green",   base:ObjectCrystal,       args:["green"]},
		{id:"crystal_pink",    pool:"crystal_pink",    base:ObjectCrystal,       args:["pink"]},
		{id:"crystal_purple",  pool:"crystal_purple",  base:ObjectCrystal,       args:["purple"]},
		{id:"jump_platform",   pool:"jump_platform",   base:ObjectJumpPlatform,  args:[]},
		{id:"level_end",       pool:"level_end",       base:ObjectLevelEnd,      args:[true]},
		{id:"level_gameover",  pool:"level_gameover",  base:ObjectLevelEnd,      args:[false]},
		{id:"camera_zoom",     pool:"camera_zoom",     base:ObjectCameraZoom,    args:[]},
		{id:"shrink_lock",     pool:"shrink_lock",     base:ObjectShrinkLock,    args:[true]},
		{id:"shrink_unlock",   pool:"shrink_unlock",   base:ObjectShrinkLock,    args:[false]},
		{id:"tutorial",        pool:"tutorial",        base:ObjectTutorial,      args:[]},
		{id:"sven",            pool:"sven",            base:ObjectSven,          args:[]},
		{id:"sled",            pool:"sled",            base:ObjectSled,          args:[]},
		{id:"troll",           pool:"troll",           base:ObjectTroll,         args:[false]},
		{id:"troll_pabbie",    pool:"troll_pabbie",    base:ObjectTroll,         args:[true]},
		{id:"marshmallow",     pool:"marshmallow",     base:ObjectMarshmallow,   args:[]},
		{id:"snowball",        pool:"snowball",        base:ObjectSnowball,      args:[]},
		{id:"crate_01_00",     pool:"obstacle",        base:ObjectObstacle,      args:[], quantity: 6},
		{id:"crate_01_01",     pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"snowman_01_00",   pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"snowman_02_00",   pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"snowman_03_00",   pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_01_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_02_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_03_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_01_01",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_02_01",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_03_01",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_01_02",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_02_02",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"stones_03_02",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"barrel_01_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"barrel_02_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"barrel_03_00",    pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"wood_01_00",      pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"wood_02_00",      pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"wood_03_00",      pool:"obstacle",        base:ObjectObstacle,      args:[]},
		// {id:"carriage_01_00",  pool:"obstacle",        base:ObjectObstacle,      args:[]},
		// {id:"carriage_02_00",  pool:"obstacle",        base:ObjectObstacle,      args:[]},
		// {id:"carriage_03_00",  pool:"obstacle",        base:ObjectObstacle,      args:[]},
		{id:"iceblock_01_00",  pool:"obstacle_ice",    base:ObjectObstacle,      args:[true], quantity: 10},
		{id:"iceblock_02_00",  pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"iceblock_03_00",  pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_00",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_00",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_00",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_01",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_01",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_01",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_02",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_02",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_02",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_03",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_03",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_03",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_04",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_04",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_04",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_01_05",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_02_05",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]},
		{id:"icecube_03_05",   pool:"obstacle_ice",    base:ObjectObstacle,      args:[true]}
	];

	this.objectManager = new ObjectManager(pools);
	this.objectManager.init();

	// Layers
	this.layerContainer = new PIXI.Container();
	this.addChild(this.layerContainer);


	// Background
	this.createBackgroundLayers();

	// Map layers
	for(var i = 0; i < this.config.layers.length; i++)
	{
		var layer = this.addLayer(this.config.layers[i].name, new PIXI.Point(0,0), this.config.layers[i]);
		layer.init();
	}

	// Character
	this.addLayer("avatar", new PIXI.Point(0,0), {name:"avatar", depth:9.5});
	this.getLayer("avatar").addChild(this.avatar);
	this.avatar.init(this);
	this.avatar.x = 0;
	this.avatar.y = 0;

	// Bridge layer
	if(this.avatar.abilities.bridge)
		this.addLayer("bridge", new PIXI.Point(0,0), {name:"bridge", depth:-0.5});

	// Record
	if(this.endless && Common.savedData.getHighscore("endless_distance") > 0)
	{
		this.record = new LevelRecord(Common.savedData.getHighscore("endless_distance"));
		this.record.init(this);
		this.addChild(this.record);
	}

	// Sort layers
	this.sortChildren();

	// Reset crystal and troll cache
	ObjectCrystal.prototype.indexes   = {};
	ObjectCrystal.prototype.collected = {};
	ObjectTroll.prototype.indexes   = 0;
	ObjectTroll.prototype.collected = [];

	// Zoomed at start
	this.zoom = 1.5;
	this.changeZoom(this.defaultZoom, 3);
}

/**
 * Update
 */
Level.prototype.update = function()
{
	var oldPosition = new PIXI.Point(this.avatar.x, this.avatar.y);

	this.avatar.update();

	// Shake
	if(this._isShake)
	{
		this._shakeTime += p3.Timestep.deltaTime;
		if(this._shakeTime >= this._shakeTimeEnd)
		{
			this._shakeTime = 0;
			this._isShake = false;
		}
	}

	// Focus the camera
	if(this.focusXActive) this.focusPosition.x = this.avatar.x;
	if(this.focusYActive) this.focusPosition.y = this.avatar.y;

	this.x = Common.STAGE_WIDTH  * this.focusPoint.x - this.focusPosition.x * this.zoom;
	this.y = Common.STAGE_HEIGHT * this.focusPoint.y - this.focusPosition.y * this.zoom;
	// this.y += this.avatar.headbobHeight * Math.sin(this.avatar.headbobTime * this.avatar.headbobFrequency);

	if(this._isShake)
	{
		this.x += p3.Utils.randomInt(-1,1) * (this._shakeStrength.x * (1 - this._shakeTime/this._shakeTimeEnd));
		this.y += p3.Utils.randomInt(-1,1) * (this._shakeStrength.y * (1 - this._shakeTime/this._shakeTimeEnd));
	}

	// Zoom
	this.scale.x = this.zoom;
	this.scale.y = this.zoom;

	// Move the layers
	var deltaMovement = new PIXI.Point(this.focusXActive ? (this.avatar.x - oldPosition.x) : 0, this.focusYActive ? (this.avatar.y - oldPosition.y) : 0);
	for(var i = 0; i < this.layers.length; i++)
	{
		this.layers[i].update(deltaMovement);
	}

	// Endless mode, add new parts if needed
	if(this.endless)
	{
		// Update the record
		if(!!this.record)
			this.record.update();

		var layer = this.getLayer("path"); // Hardcoded, for now

		if(layer.paths.length == 0)
		{
			var lastPoint = new PIXI.Point();

			for(var i = 0; i < layer.childrenPaths.length; i++)
			{
				if(layer.childrenPaths[i].config.closed) continue;

				if(lastPoint.x < layer.childrenPaths[i].config.points[layer.childrenPaths[i].config.points.length-1].x)
				{
					lastPoint = layer.childrenPaths[i].config.points[layer.childrenPaths[i].config.points.length-1];
				}
			}

			// Pick a random piece
			if(this.data.parts.length > 0)
				var piece = this._assetManager.getJSON(this.data.parts[p3.Utils.randomInt(0, this.data.parts.length-1)]);
			else if(this.data.partDebug != "")
				var piece = this.data.partDebug;

			for(var l = 0; l < piece.layers.length; l++)
			{
				var layer = this.getLayer(piece.layers[l].name);

				if(layer == null)
				{
					var layer = this.addLayer(piece.layers[l].name, new PIXI.Point(0,0), piece.layers[l]);
					this.sortChildren();
				}

				var clone = JSON.parse(JSON.stringify(piece.layers[l]));
				layer.queuePaths(clone.paths, lastPoint);
				layer.queueObjects(clone.objects, lastPoint);
			}
		}
	}
}

/**
 * Dispose
 */
Level.prototype.dispose = function()
{
	this.avatar.dispose();
}

/**
 * Add a layer
 * @param {String} id
 * @param {PIXI.Point} parallax
 * @param {Object} config
 * @returns {LevelLayer}
 */
Level.prototype.addLayer = function(id, parallax, config)
{
	var layer = new LevelLayer(id, parallax, config ? config : {name:id, depth:0});
	layer.level = this;

	this.layers.push(layer);
	this.layerContainer.addChild(layer);

	return layer;
}

/**
 * Return a layer or null if not found
 * @param {String} id
 * @returns {LevelLayer}
 */
Level.prototype.getLayer = function(id)
{
	for(var i = 0; i < this.layers.length; i++)
	{
		if(this.layers[i].id == id)
		{
			return this.layers[i];
		}
	}
	return null;
}

/**
 * Create background layers
 */
Level.prototype.createBackgroundLayers = function()
{
	var layers = [];
	// layers.push({id:"sky",        image:this.backgroundPrefix + "sky_gradients_00", scale:1, xSpeed:0.00, y:0});
	// layers.push({id:"clouds",     image:this.backgroundPrefix + "m1clouds",         scale:1, xSpeed:0.08, y:0});
	//layers.push({id:"mountains",  image:this.backgroundPrefix + "m1bg00",           scale:1, xSpeed:0.05, y:200});
	//layers.push({id:"farFields",  image:this.backgroundPrefix + "m1bg01",           scale:2, xSpeed:0.07, y:350});
	//layers.push({id:"MidFields1", image:this.backgroundPrefix + "m1bg02",           scale:2, xSpeed:0.1,  y:350});

	var lightsAlpha = Common.savedData.getCollectedCrystalCount() / Common.savedData.getCrystalCount();

	layers.push({id:"sky",          image:this.backgroundPrefix + "bg_00",          xScale:1,   yScale:1,   xSpeed:0.00, y:-150,  alpha: 1});
	layers.push({id:"stars",        image:"night_stars",                            xScale:1,   yScale:1,   xSpeed:0.00, y:0,     alpha: 1});
	layers.push({id:"lights_blue",  image:"northern_lights_blue",                   xScale:4,   yScale:2,   xSpeed:0.00, y:-180,  alpha: lightsAlpha, xTiling:15,});
	layers.push({id:"lights_green", image:"northern_lights_green",                  xScale:4,   yScale:2,   xSpeed:0.00, y:-215,  alpha: lightsAlpha, xTiling:-20});
	layers.push({id:"lights_pink",  image:"northern_lights_pink",                   xScale:4,   yScale:2,   xSpeed:0.00, y:-250,  alpha: lightsAlpha, xTiling:10, });
	layers.push({id:"mountains",    image:this.backgroundPrefix + "mountains_00",   xScale:1,   yScale:1,   xSpeed:0.05, y:280,   alpha: 1});
	layers.push({id:"farFields",    image:this.backgroundPrefix + "hills_00",       xScale:1.5, yScale:1.5, xSpeed:0.09, y:300, alpha: 1});
	layers.push({id:"farFields",    image:this.backgroundPrefix + "hills_01",       xScale:1.5, yScale:1.5, xSpeed:0.12, y:300, alpha: 1});

	for(var i = 0; i < layers.length; i++)
	{
		var layer = this.addLayer(layers[i].id, new PIXI.Point(layers[i].xSpeed, 0), {name:layers[i].id, depth:-1000 + i});
		layer.setBackground(layers[i].image, layers[i].y, new PIXI.Point(layers[i].xScale, layers[i].yScale), layers[i].alpha);

		if(layers[i].xTiling)
			layer.xTiling = layers[i].xTiling;
	}
}

/**
 * Reorder layers in canvas using their depth value
 */
Level.prototype.sortChildren = function()
{
	this.layerContainer.children.sort(function(a, b)
	{
		// if(!a.config || !b.config) return 0; // Skip particles when adding layers during endless mode

		if(a.config.depth < b.config.depth) return -1;
		if(a.config.depth > b.config.depth) return 1;
		return 0;
	});
}

/**
 * Change zoom over time
 * @param {Number} zoom (1: 100%)
 * @param {Number} time
 * @param {Number} delay
 */
Level.prototype.changeZoom = function(zoom, time, delay)
{
	if(this.zoomTween != null)
		this.zoomTween.kill();

	if(zoom == this.zoom) return;

	this.zoomTween = new TimelineMax();
	this.zoomTween.to(this, time, {zoom: zoom, ease:Sine.easeInOut}, !!delay ? delay : 0);
	Common.animator.add(this.zoomTween);

	this.zoomTarget = zoom;
}

/**
 * Change the focus point over time
 * @param {PIXI.Point} focusPoint
 * @param {Number} time
 * @param {Number} delay
 */
Level.prototype.changeFocusPoint = function(focusPoint, time, delay)
{
	if(this.focusPointTween != null)
		this.focusPointTween.kill();

	if(this.focusPoint.equal(focusPoint)) return;

	this.focusPointTween = new TimelineMax();
	this.focusPointTween.to(this.focusPoint, time, {x: focusPoint.x, y:focusPoint.y, ease:Sine.easeInOut}, !!delay ? delay : 0);
	Common.animator.add(this.focusPointTween);
}


/**
 * Execute a shake effect
 * @param {Number} time
 * @param {Number} amount
 */
Level.prototype.shake = function(time, amount)
{
	this._isShake       = true;
	this._shakeTime     = 0;
	this._shakeTimeEnd  = time;
	this._shakeStrength = amount;
}

/**
 * Execute a shockwave effect
 * @param {Object} gameobject
 * @param {Number} time
 */
Level.prototype.shockwave = function(gameobject, time)
{
	this._shockwave = new Shockwave(this, this._shockwaveTexture);
	this._shockwave.animate(time);
	gameobject.addChild(this._shockwave);
}

/**
 * Exectuted when the game ends, either by colliding with a ObjectLevelEnd entity
 */
Level.prototype.gameOver = function()
{
	// SCORE
	// ====================

	// Score
	this.score += this.avatar.distance * this._assetManager.getJSON("config").score.distance;
	this.score += this.snowflakes      * this._assetManager.getJSON("config").score.snowflake;
	this.score += this.styleScore;

	// Highscore
	if(!this.endless)
	{
		Common.savedData.recordHighscore(Common.savedData.level, this.score);
	}
	else
	{
		Common.savedData.recordHighscore("endless", this.score);
		Common.savedData.recordHighscore("endless_distance", this.avatar.distance);
	}
	
	// SNOWFLAKES
	// ====================
	Common.savedData.coins += this.snowflakes;

	// CRYSTALS
	// ====================
	// Save collected crystals (even when the player has lost)
	for(var character in ObjectCrystal.prototype.collected)
	{
		for(var i = 0; i < ObjectCrystal.prototype.collected[character].length; i++)
		{
			Common.savedData.crystals[Common.savedData.level][character][ObjectCrystal.prototype.collected[character][i]] = true;
		}
	}

	// All crystals collected message
	if(!Common.savedData.endGameMessage.crystals.shown && Common.savedData.getCrystalCount() == Common.savedData.getCollectedCrystalCount())
	{
		Common.savedData.endGameMessage.crystals.show = true;
	}

	// TROLLS
	// ====================

	// Save collected trolls
	for(var i = 0; i < ObjectTroll.prototype.collected.length; i++)
	{
		Common.savedData.trolls[Common.savedData.level][ObjectTroll.prototype.collected[i]] = true;
	}

	// All trolls collected message
	if(!Common.savedData.endGameMessage.trolls.shown && Common.savedData.getCollectedTrollCount() == Common.savedData.getTrollCount())
	{
		Common.savedData.endGameMessage.trolls.show = true;
	}

	// UNLOCKABLES
	// ====================
	if(!this.endless)
	{
		if(this.completed)
		{
			// Unlock new levels
			if(Common.savedData.level == Common.savedData.levelsUnlocked-1)
			{
				if(Common.savedData.level < (Common.savedData.levels-1))
				{
					Common.savedData.levelsUnlocked++;
					Common.savedData.showUnlockedLevel = true;
				}
				else
				{
					if(!Common.savedData.endGameMessage.levels.shown)
					{
						Common.savedData.endGameMessage.levels.show = true;
					}
				}
			}

			// Unlock endless
			if(!Common.savedData.endGameMessage.endless.shown && Common.savedData.level == this._assetManager.getJSON("config").endless.levelRequired-1)
			{
				Common.savedData.endGameMessage.endless.show = true;
			}

			// Unlock new characters
			if(Common.savedData.level == 0 && !Common.savedData.charactersUnlocked.kristoff)
			{
				Common.savedData.charactersUnlocked.kristoff = true;
				Common.savedData.showUnlockedCharacter = "kristoff";
			}
			if(Common.savedData.level == 2 && !Common.savedData.charactersUnlocked.olaf)
			{
				Common.savedData.charactersUnlocked.olaf = true;
				Common.savedData.showUnlockedCharacter = "olaf";
			}
			if(Common.savedData.level == 4 && !Common.savedData.charactersUnlocked.elsa)
			{
				Common.savedData.charactersUnlocked.elsa = true;
				Common.savedData.showUnlockedCharacter = "elsa";
			}
		}

		// Unlock pabbie
		if((Common.savedData.getCollectedCrystalCount() == Common.savedData.getCrystalCount()) && !Common.savedData.charactersUnlocked.pabbie)
		{
			Common.savedData.charactersUnlocked.pabbie = true;
			Common.savedData.showUnlockedCharacter = "pabbie";
		}

		// Event Tracking
		if(Common.savedData.showUnlockedCharacter != "")
		{
			Common.ctow.trackEvent(
			{
				event      : "game_action",
				game_level : (Common.savedData.level+1),
				game_tier1 : "character_unlocked",
				game_tier2 : Common.savedData.showUnlockedCharacter
			});
		}
	}

	// Loss Streak
	if(!this.endless)
	{
		if(this.completed)
			Common.savedData.lossStreak.count = 0;
		else
			Common.savedData.lossStreak.count++;
	}

	// SAVE
	// ====================
	Common.savedData.save();

	this.parent.gameOver();
}

/**
 * Exectuted when the game is paused
 */
Level.prototype.stopLoops = function()
{
	// Stop loops
	this.avatar.stopLoops();

	var marshmallows = this.objectManager.getObjectsOfType("marshmallow");
	for(var i = 0; i < marshmallows.length; i++)
	{
		marshmallows[i].stopLoops();
	}
}
},{"../Common":2,"../editor/BezierPath":8,"../game/Avatar":14,"../game/LevelLayer":18,"../game/LevelPath":19,"../game/LevelRecord":20,"../game/ObjectCameraZoom":22,"../game/ObjectCoin":23,"../game/ObjectCrystal":24,"../game/ObjectDecoration":25,"../game/ObjectJumpPlatform":26,"../game/ObjectLevelEnd":27,"../game/ObjectManager":28,"../game/ObjectMarshmallow":29,"../game/ObjectObstacle":30,"../game/ObjectPowerup":31,"../game/ObjectShrinkLock":32,"../game/ObjectSled":33,"../game/ObjectSnowball":34,"../game/ObjectSven":35,"../game/ObjectTroll":36,"../game/ObjectTutorial":37,"../game/Shockwave":39}],18:[function(require,module,exports){
var Common     = require("../Common");
var LevelPath  = require("../game/LevelPath");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelLayer(id, parallax, config)
{
	this.level      = null;

	this.id              = id;
	this.parallax        = typeof(parallax) != "undefined" ? parallax : new PIXI.Point(1,1);
	this.bg              = null;
	this.config          = !!config ? config : null;
	this.paths           = [];
	this.objects         = [];
	this.childrenPaths   = [];
	this.childrenObjects = [];

	this.assetManager = p3.AssetManager.instance;
	PIXI.Container.call(this);
}
module.exports = LevelLayer;
LevelLayer.prototype = Object.create(PIXI.Container.prototype);
LevelLayer.prototype.constructor = LevelLayer;

/**
 * Init
 */
LevelLayer.prototype.init = function()
{
	if(this.config == null) return;

	this.queuePaths(this.config.paths);
	this.queueObjects(this.config.objects);
}

/**
 * Update
 */
LevelLayer.prototype.update = function(deltaMovement)
{
	if(!this.bg)
	{
		if(this.parallax.x != 0)
			this.x += deltaMovement.x * this.parallax.x;

		if(this.parallax.y != 0)
			this.y += deltaMovement.y * this.parallax.y;

		var newElements = false;

		// Update paths
		for(var i = 0; i < this.childrenPaths.length; i++)
		{
			this.childrenPaths[i].update();
		}

		// Add new paths
		while(this.paths.length > 0 && (this.paths[0].bounds[0] < (Common.STAGE_WIDTH - this.level.x) * (1/this.level.zoom)) && (this.paths[0].bounds[1] > - this.level.x * (1/this.level.zoom)))
		{
			var levelPath = new LevelPath(this, this.paths[0]);
			levelPath.init();
			levelPath.render();
			this.addChild(levelPath)
			this.childrenPaths.push(levelPath);

			this.paths.splice(0, 1);

			newElements = true;
		}

		// Remove paths outside
		for(var i = 0; i < this.childrenPaths.length; i++)
		{
			if(this.childrenPaths[i].config.bounds[1] < - this.level.x * (1/this.level.zoom))
			{
				this.childrenPaths[i].dispose();
				this.removeChild(this.childrenPaths[i]);
				this.childrenPaths.splice(i, 1);
			}
		}

		// Add new objects
		while(this.objects.length > 0 && (this.objects[0].position.x < (Common.STAGE_WIDTH - this.level.x) * (1/this.level.zoom)) && (this.objects[0].position.x > - this.level.x * (1/this.level.zoom)))
		{
			// Hardcoded troll behaviour
			// Hide signs and troll for pabbie and collectable trolls for other characters
			if((Common.savedData.character == "pabbie" && (this.objects[0].id == "troll_sign" || this.objects[0].id == "troll_sign_arrow" || this.objects[0].id == "troll")
			//|| (Common.savedData.character != "pabbie" && (this.objects[0].id == "troll_pabbie")))
			|| (!Common.savedData.endGameMessage.crystals.shown && (this.objects[0].id == "troll_pabbie")))
			)
			{
				this.objects.splice(0, 1);
				continue;
			}

			// Add object
			this.addObject(this.objects[0].id, this.objects[0]);
			this.objects.splice(0, 1);
			newElements = true;
		}

		// Remove objects outside
		for(var i = 0; i < this.childrenObjects.length; i++)
		{
			if(this.childrenObjects[i].removeWhenOutside && this.childrenObjects[i].x < - this.level.x * (1/this.level.zoom))
			{
				this.childrenObjects[i].dispose();
				this.level.objectManager.dispose(this.childrenObjects[i]); // Free the resource from the pool
				this.removeChild(this.childrenObjects[i]);
				this.childrenObjects.splice(i, 1);
			}
		}

		// Sort objects and paths if new ones have been added
		if(newElements)
			this.sortChildren();
	}
	else
	{
		this.x = -this.level.x * 1/this.level.zoom;
		this.y = -this.level.y * 1/this.level.zoom;// + (Common.STAGE_HEIGHT * (1-this.level.zoom)/2) * 1/this.level.zoom;
		this.bg.tilePosition.x -= deltaMovement.x * this.parallax.x;
		this.bg.tilePosition.y -= deltaMovement.y * this.parallax.y;
		// this.bg.width = Common.STAGE_WIDTH * 1/this.level.zoom;
		// this.bg.tileScale = new PIXI.Point(this.bgScale * 1/this.level.zoom, this.bgScale * 1/this.level.zoom);
		this.bg.scale = new PIXI.Point(1/this.level.zoom, 1/this.level.zoom);
		this.bg.y = this.bg.yOr * 1/this.level.zoom;
		
		if(this.xTiling)
		{
			this.bg.tilePosition.x += p3.Timestep.deltaTime * this.xTiling;	
		}
	}

	// Update children
	for(var i = 0; i < this.childrenObjects.length; i++)
	{
		this.childrenObjects[i].update();
	}
}

/**
 * Store a list of paths that will be added to the level once they are close enough
 * @param {Array} paths
 * @param {PIXI.Point} delta
 */
LevelLayer.prototype.queuePaths = function(paths, delta)
{
	for(var i = 0; i < paths.length; i++)
	{
		if(typeof(delta) != "undefined")
		{
			for(var p = 0; p < paths[i].points.length; p++)
			{
				paths[i].points[p].x += delta.x;
				paths[i].points[p].y += delta.y;
			}
			paths[i].bounds[0] += delta.x;
			paths[i].bounds[1] += delta.x;
		}

		this.paths.push(paths[i])
	}

	this.paths.sort(function(a, b)
	{
		if(a.bounds[0] < b.bounds[0]) return -1;
		if(a.bounds[0] > b.bounds[0]) return 1;
		return 0;
	});
}

/**
 * Store a list of objects that will be added to the level once they are close enough
 * @param {Array} objects
 * @param {PIXI.Point} delta
 */
LevelLayer.prototype.queueObjects = function(objects, delta)
{
	if(!delta) delta = new PIXI.Point(0,0);

	for(var i = 0; i < objects.length; i++)
	{
		if(typeof(delta) != "undefined")
		{
			objects[i].position.x += delta.x;
			objects[i].position.y += delta.y;
		}

		this.objects.push(objects[i]);
	}

	this.objects.sort(function(a, b)
	{
		if(a.position.x < b.position.x) return -1;
		if(a.position.x > b.position.x) return 1;
		return 0;
	});
}

/**
 * Add an object to the level
 * @param {String} id
 * @param {Object} config
 */
LevelLayer.prototype.addObject = function(id, config)
{
	var obj = this.level.objectManager.generate(id);
	obj.configure(this.level, config);
	this.addChild(obj)
	this.childrenObjects.push(obj);
}

/**
 * Initialize a background layerX
 * @param {String} image
 * @param {Number} y
 * @param {PIXI.Point} scale
 */
LevelLayer.prototype.setBackground = function(image, y, scale, alpha)
{
	var texture       = this.assetManager.getTexture(image);
	this.bg           = new PIXI.extras.TilingSprite(texture, Common.STAGE_WIDTH, texture.crop.height * scale.y);
	this.bg.tileScale = new PIXI.Point(scale.x, scale.y);
	this.bg.y         = y;
	this.bg.alpha     = alpha;
	this.addChild(this.bg);

	this.bg.yOr = y;
}


/**
 * Reorder the children in canvas using their depth value
 * If the value is the same render objects on top of paths
 * If both are paths order them using their starting position
 */
LevelLayer.prototype.sortChildren = function()
{
	this.children.sort(function(a, b)
	{
		if(a.config.depth < b.config.depth)
			return -1;
		else if(a.config.depth > b.config.depth)
			return +1;
		else if(!!a.config.bounds && !b.config.bounds)
			return -1;
		else if(!a.config.bounds && !!b.config.bounds)
			return +1;
		else if(!!a.config.bounds && !!b.config.bounds)
			return a.config.bounds[0] < b.config.bounds[0] ? -1 : +1;
		return 0;
	});
}
},{"../Common":2,"../game/LevelPath":19}],19:[function(require,module,exports){
var Common     = require("../Common");
var BezierPath = require("../editor/BezierPath");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelPath(layer, config)
{
	this._assetManager = p3.AssetManager.instance;

	this.layer     = layer;
	this.level     = layer.level;
	this.config    = config;
	this.bezier    = new BezierPath();
	this.wireframe = null;
	this.textures  = null;
	this.toDelete  = false;

	this.iceBridgePS = null;

	this.assetManager = p3.AssetManager.instance;
	PIXI.Container.call(this);
}
module.exports = LevelPath;
LevelPath.prototype = Object.create(PIXI.Container.prototype);
LevelPath.prototype.constructor = LevelPath;

/**
 * Init
 */
LevelPath.prototype.init = function()
{
	for(var i = 0; i < this.config.points.length; i++)
	{
		this.bezier.addPoint(this.config.points[i].x, this.config.points[i].y);
	}

	if(this.config.data != "")
	{
		// TODO: parse the json only the first time
		try
		{
			this.config.data = JSON.parse(this.config.data);
		}
		catch(e)
		{
			console.error("Couldn't parse path JSON");
			console.info(e);
		}
	}
}

/**
 * Update
 */
LevelPath.prototype.update = function()
{
	if(!!this.iceBridgePS)
	{
		this.iceBridgePS.updateSpawnPos(this.textures.mask.x + this.textures.mask.bounds.width , this.textures.mask.y+ 50);
		this.iceBridgePS.update(p3.Timestep.deltaTime);
	}
}


/**
 * Render
 */
LevelPath.prototype.render = function()
{
	if(this.textures != null)
	{
		this.removeChild(this.textures);
	}
	this.textures  = new PIXI.Container();

	if(this.level.debug)
	{
		if(this.wireframe != null)
		{
			this.removeChild(this.wireframe);
		}
		this.wireframe = new PIXI.Graphics();
	}

	if(this.bezier.points.length > 1)
	{
		var drawingPoints = this.bezier.getDrawingPoints();

		// Draw fill texture
		if(this.config.texFill != "" && !this.isHidden())
		{
			var lowerPoint = null;
			var contour = [];
			for(var i = 0; i < drawingPoints.length; i++)
			{
				contour.push(new poly2tri.Point(drawingPoints[i].x, drawingPoints[i].y));

				if(lowerPoint == null || lowerPoint < drawingPoints[i].y)
					lowerPoint = drawingPoints[i].y;
			}

			if(!this.config.closed)
			{
				contour.push({x: drawingPoints[drawingPoints.length-1].x, y: lowerPoint + this.config.texFillPadding});
				contour.push({x: drawingPoints[0].x, y: lowerPoint + this.config.texFillPadding});
			}
			else
			{
				// Remove last point if coincides with the first, otherwise the triangulation will fail
				if(contour[0].x == contour[contour.length-1].x && contour[0].y == contour[contour.length-1].y)
				{
					contour.splice(contour.length-1, 1);
				}
			}

			try
			{
				var swctx = new poly2tri.SweepContext(contour);
				swctx.triangulate();
				var triangles = swctx.getTriangles();
			}
			catch(e)
			{
				console.log("Triangulation failed")
			}


			if(!!triangles)
			{
				// Draw the filling mesh
				var texture    = this.assetManager.getTexture(this.config.texFill);
				var vertices   = new Float32Array(6 * triangles.length);
				var uvs        = new Float32Array(6 * triangles.length);
				var indices    = new Uint16Array(3 * triangles.length);

				var size = this.config.texFillSize;

				for(var i = 0; i < triangles.length; i++)
				{
					var points = triangles[i].getPoints();

					vertices.set(
					[
						points[0].x, points[0].y,
						points[1].x, points[1].y,
						points[2].x, points[2].y
					], i*6)

					uvs.set(
					[
						points[0].x/size, points[0].y/size,
						points[1].x/size, points[1].y/size,
						points[2].x/size, points[2].y/size
					], i * 6);

					indices.set([0 + 3*i, 1 + 3*i, 2 + 3*i], i * 3);

					// Wireframe
					if(this.level.debug)
					{
						/*
						this.wireframe.lineStyle(1, 0x0000ff, 1);
						var points = triangles[i].getPoints();

						this.wireframe.moveTo(points[0].x, points[0].y);
						for(var p = 1; p < points.length; p++)
						{
							this.wireframe.lineTo(points[p].x, points[p].y);
						}
						this.wireframe.lineTo(points[0].x, points[0].y);
						*/
					}
				}

				var mesh = new PIXI.mesh.Mesh
				(
					texture,
					vertices,
					uvs,
					indices,
					PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
				);
				this.textures.addChild(mesh);
			}
		}


		// Draw the inclined terrain
		if(this.config.texWall != "" && !this.isHidden())
		{
			var segments       = this.bezier.getGroundSegments(this.config.texWallAngle, 360);
			var textureSize    = this.config.texWallSize;
			var textureTopPerc = this.config.texWallDelta

			var segmentsSize = 0;
			for(var s = 0; s < segments.length; s++)
			{
				segmentsSize += segments[s].points.length-1;
			}

			var texture    = this.assetManager.getTexture(this.config.texWall);
			var vertices   = new Float32Array(8 * segmentsSize);
			var uvs        = new Float32Array(8 * segmentsSize);
			var indices    = new Uint16Array(6 * segmentsSize);
			var arrayIndex = 0;

			for(var s = 0; s < segments.length; s++)
			{
				var totalLength  = 0;
				var segmentLength = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					vertices.set(
					[
							segments[s].points[i].x   - segments[s].normals[i].x   * (textureSize * textureTopPerc),     segments[s].points[i].y   - segments[s].normals[i].y   * (textureSize * textureTopPerc),
							segments[s].points[i+1].x - segments[s].normals[i+1].x * (textureSize * textureTopPerc),     segments[s].points[i+1].y - segments[s].normals[i+1].y * (textureSize * textureTopPerc),
							segments[s].points[i+1].x + segments[s].normals[i+1].x * (textureSize * (1-textureTopPerc)), segments[s].points[i+1].y + segments[s].normals[i+1].y * (textureSize * (1-textureTopPerc)),
							segments[s].points[i].x   + segments[s].normals[i].x   * (textureSize * (1-textureTopPerc)), segments[s].points[i].y   + segments[s].normals[i].y   * (textureSize * (1-textureTopPerc))
					], arrayIndex*8)

					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength = v.getLength();

					uvs.set(
					[
						totalLength/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 1,
						totalLength/textureSize, 1
					], arrayIndex * 8);

					indices.set(
					[
						0 + 4*arrayIndex,
						1 + 4*arrayIndex,
						2 + 4*arrayIndex,
						0 + 4*arrayIndex,
						2 + 4*arrayIndex,
						3 + 4*arrayIndex
					], arrayIndex * 6);

					totalLength += segmentLength;

					// Wireframe
					if(this.level.debug)
					{
						this.wireframe.lineStyle(1, 0x00ff00, 0.5);
						this.wireframe.moveTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[arrayIndex*8+1*2], vertices[arrayIndex*8+1*2+1]); // 1
						this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
						this.wireframe.lineTo(vertices[arrayIndex*8+3*2], vertices[arrayIndex*8+3*2+1]); // 3
						this.wireframe.lineTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
					}

					arrayIndex++;

				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);
			this.textures.addChild(mesh);
		}

		// Draw the terrain
		var segments       = this.bezier.getGroundSegments(0, this.config.texWallAngle, this.config.texGroundEdge == "");
		var textureSizeOr  = this.config.texGroundSize;
		var textureTopPerc = this.config.texGroundDelta

		if(this.config.texGround != "" && !this.isHidden())
		{
			var segmentsSize = 0;
			for(var s = 0; s < segments.length; s++)
			{
				segmentsSize += segments[s].points.length-1;
			}

			var texture    = this.assetManager.getTexture(this.config.texGround);
			var vertices   = new Float32Array(8 * segmentsSize);
			var uvs        = new Float32Array(8 * segmentsSize);
			var indices    = new Uint16Array(6 * segmentsSize);
			var arrayIndex = 0;

			for(var s = 0; s < segments.length; s++)
			{
				// Make the normals perpendicular if the left/right-most segments don't have a cap
				if(s == 0 && (this.config.texGroundEdgeSide == "right" || this.config.texGroundEdgeSide == "none"))
					segments[s].normals[0] = {x:0, y:1};
				if(s == segments.length-1 && (this.config.texGroundEdgeSide == "left" || this.config.texGroundEdgeSide == "none"))
					segments[s].normals[segments[s].normals.length-1] = {x:0, y:1};

				// Calculate the total length of the segment
				var segmentLength  = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength += v.getLength();
				}

				// Count how many times the texture can fit in the segment length, then round it to adjust the texture size
				var textureSize = segmentLength/ Math.max(1, Math.round(segmentLength / textureSizeOr));

				// Draw the segment
				var totalLength   = 0;
				var segmentLength = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					vertices.set(
					[
							segments[s].points[i].x   - segments[s].normals[i].x   * (textureSize * textureTopPerc),     segments[s].points[i].y   - segments[s].normals[i].y   * (textureSizeOr * textureTopPerc),
							segments[s].points[i+1].x - segments[s].normals[i+1].x * (textureSize * textureTopPerc),     segments[s].points[i+1].y - segments[s].normals[i+1].y * (textureSizeOr * textureTopPerc),
							segments[s].points[i+1].x + segments[s].normals[i+1].x * (textureSize * (1-textureTopPerc)), segments[s].points[i+1].y + segments[s].normals[i+1].y * (textureSizeOr * (1-textureTopPerc)),
							segments[s].points[i].x   + segments[s].normals[i].x   * (textureSize * (1-textureTopPerc)), segments[s].points[i].y   + segments[s].normals[i].y   * (textureSizeOr * (1-textureTopPerc))
					], arrayIndex*8)

					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength = v.getLength();

					uvs.set(
					[
						totalLength/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 0,
						(totalLength+segmentLength)/textureSize, 1,
						totalLength/textureSize, 1
					], arrayIndex * 8);

					indices.set(
					[
						0 + 4*arrayIndex,
						1 + 4*arrayIndex,
						2 + 4*arrayIndex,
						0 + 4*arrayIndex,
						2 + 4*arrayIndex,
						3 + 4*arrayIndex
					], arrayIndex * 6);

					totalLength += segmentLength;

					// Wireframe
					if(this.level.debug)
					{
						this.wireframe.lineStyle(1, 0x00ff00, 0.5);
						this.wireframe.moveTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[arrayIndex*8+1*2], vertices[arrayIndex*8+1*2+1]); // 1
						this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
						this.wireframe.lineTo(vertices[arrayIndex*8+3*2], vertices[arrayIndex*8+3*2+1]); // 3
						this.wireframe.lineTo(vertices[arrayIndex*8+0*2], vertices[arrayIndex*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[arrayIndex*8+2*2], vertices[arrayIndex*8+2*2+1]); // 2
					}

					arrayIndex++;
				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);

			this.textures.addChild(mesh);
		}

		// Draw the terrain edges
		if(this.config.texGroundEdge != "" && !this.isHidden())
		{
			var texture    = this.assetManager.getTexture(this.config.texGroundEdge);
			var vertices   = new Float32Array(2 * 8 * segments.length);
			var uvs        = new Float32Array(2 * 8 * segments.length);
			var indices    = new Uint16Array(2 * 6 * segments.length);

			for(var s = 0; s < segments.length; s++)
			{
				// Calculate the total length of the segment
				var segmentLength  = 0;

				for(var i = 0; i < segments[s].normals.length -1; i++)
				{
					var v = new PIXI.Point(segments[s].points[i].x  - segments[s].points[i+1].x, segments[s].points[i].y - segments[s].points[i+1].y);
					segmentLength += v.getLength();
				}

				// Count how many times the texture can fit in the segment length, then round it to adjust the texture size
				var textureSize = segmentLength/ Math.max(1, Math.round(segmentLength / textureSizeOr));

				// Left edge
				if(s > 0 || (this.config.texGroundEdgeSide == "left" || this.config.texGroundEdgeSide == ""))
				{
					var p = segments[s].points[0];
					var n = segments[s].normals[0];
					var v = new PIXI.Point(segments[s].points[0].x - segments[s].points[1].x, segments[s].points[0].y - segments[s].points[1].y);
					v.normalize();

					vertices.set(
					[
						p.x - n.x * (textureSize * textureTopPerc) +(v.x * textureSize),     p.y - n.y * (textureSizeOr * textureTopPerc     -(v.y * textureSizeOr)),
						p.x - n.x * (textureSize * textureTopPerc),                          p.y - n.y * (textureSizeOr * textureTopPerc),
						p.x + n.x * (textureSize * (1-textureTopPerc)),                      p.y + n.y * (textureSizeOr * (1-textureTopPerc)),
						p.x + n.x * (textureSize * (1-textureTopPerc)) +(v.x * textureSize), p.y + n.y * (textureSizeOr * (1-textureTopPerc) +(v.y * textureSizeOr))
					], s*8*2);

					uvs.set(
					[
						0, 0,
						1, 0,
						1, 1,
						0, 1
					], s*8*2);

					indices.set(
					[
						0 + (s*2) *4,
						1 + (s*2) *4,
						2 + (s*2) *4,
						0 + (s*2) *4,
						2 + (s*2) *4,
						3 + (s*2) *4
					], s*6*2);

					// Wireframe
					if(this.level.debug)
					{
						this.wireframe.lineStyle(1, 0x00ff00, 0.5);
						this.wireframe.moveTo(vertices[s*2*8+0*2], vertices[s*2*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[s*2*8+1*2], vertices[s*2*8+1*2+1]); // 1
						this.wireframe.lineTo(vertices[s*2*8+2*2], vertices[s*2*8+2*2+1]); // 2
						this.wireframe.lineTo(vertices[s*2*8+3*2], vertices[s*2*8+3*2+1]); // 3
						this.wireframe.lineTo(vertices[s*2*8+0*2], vertices[s*2*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[s*2*8+2*2], vertices[s*2*8+2*2+1]); // 2
					}
				}

				// Right edge
				if(s < segments.length-1 || (this.config.texGroundEdgeSide == "right" || this.config.texGroundEdgeSide == ""))
				{
					var l = segments[s].normals.length-1;
					var p = segments[s].points[segments[s].normals.length-1];
					var n = segments[s].normals[segments[s].normals.length-1];
					var v = new PIXI.Point(segments[s].points[l].x - segments[s].points[l-1].x, segments[s].points[l].y - segments[s].points[l-1].y);
					v.normalize();

					vertices.set(
					[
						p.x - n.x * (textureSize * textureTopPerc) +(v.x * textureSize),     p.y - n.y * (textureSizeOr * textureTopPerc -(v.y * textureSizeOr)),
						p.x - n.x * (textureSize * textureTopPerc),                          p.y - n.y * (textureSizeOr * textureTopPerc),
						p.x + n.x * (textureSize * (1-textureTopPerc)),                      p.y + n.y * (textureSizeOr * (1-textureTopPerc)),
						p.x + n.x * (textureSize * (1-textureTopPerc)) +(v.x * textureSize), p.y + n.y * (textureSizeOr * (1-textureTopPerc)+(v.y * textureSizeOr))
					], (s*2+1)*8);

					uvs.set(
					[
						0, 0,
						1, 0,
						1, 1,
						0, 1
					], (s*2+1)*8);

					indices.set(
					[
						0 + (s*2+1) *4,
						1 + (s*2+1) *4,
						2 + (s*2+1) *4,
						0 + (s*2+1) *4,
						2 + (s*2+1) *4,
						3 + (s*2+1) *4
					], (s*2+1)*6);

					// Wireframe
					if(this.level.debug)
					{
						this.wireframe.lineStyle(1, 0x00ff00, 0.5);
						this.wireframe.moveTo(vertices[(s*2+1)*8+0*2], vertices[(s*2+1)*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[(s*2+1)*8+1*2], vertices[(s*2+1)*8+1*2+1]); // 1
						this.wireframe.lineTo(vertices[(s*2+1)*8+2*2], vertices[(s*2+1)*8+2*2+1]); // 2
						this.wireframe.lineTo(vertices[(s*2+1)*8+3*2], vertices[(s*2+1)*8+3*2+1]); // 3
						this.wireframe.lineTo(vertices[(s*2+1)*8+0*2], vertices[(s*2+1)*8+0*2+1]); // 0
						this.wireframe.lineTo(vertices[(s*2+1)*8+2*2], vertices[(s*2+1)*8+2*2+1]); // 2
					}
				}
			}

			var mesh = new PIXI.mesh.Mesh
			(
				texture,
				vertices,
				uvs,
				indices,
				PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES
			);
			this.textures.addChild(mesh);
		}
	}

	this.addChild(this.textures);

	if(this.level.debug)
	{
		// Draw bezier
		this.wireframe.moveTo(this.bezier.points[0].x, this.bezier.points[0].y);
		this.wireframe.lineStyle(2, 0xff0000);
		for(var i = 1; i < this.bezier.points.length; i +=3)
		{
			this.wireframe.bezierCurveTo(this.bezier.points[i].x, this.bezier.points[i].y, this.bezier.points[i+1].x, this.bezier.points[i+1].y, this.bezier.points[i+2].x, this.bezier.points[i+2].y);
		}

		// Draw main points
		for(var i = 0; i < this.bezier.points.length; i ++)
		{
			if(i%3 != 0) continue;

			if(i == this.pointIndex)
				this.wireframe.lineStyle(2, 0x00ff00 , 1);
			else
				this.wireframe.lineStyle(0, 0xff0000, 0);

			this.wireframe.beginFill(0xff0000);
			this.wireframe.drawCircle(this.bezier.points[i].x,  this.bezier.points[i].y, 5);
			this.wireframe.endFill();
		}

		this.addChild(this.wireframe);
	}

	// Artificial: created by the avatar
	if(!!this.config.artificial)
	{
		var bounds = this.textures.getBounds();

		this.textures.mask = new PIXI.Graphics();
		this.textures.mask.beginFill();
		this.textures.mask.drawRect(0, 0, bounds.width, bounds.height);
		this.textures.mask.endFill();
		this.textures.mask.x = bounds.x - bounds.width;
		this.textures.mask.y = bounds.y;
		this.textures.mask.bounds = bounds;
		this.addChild(this.textures.mask);

		this.maskTween = new TimelineMax(
		{
			onComplete: function()
			{
				this.config.collisions = 0
			},
			onCompleteScope: this
		});
		this.maskTween.to(this.textures.mask, 0.5, {x: bounds.x, ease:Sine.easeOut, onComplete:function(){this.iceBridgePS.emit = false;}, onCompleteScope:this},  0);
		this.maskTween.to(this.textures, 0.5, {alpha: 0, ease:Sine.easeIn},  0.9);
		// this.maskTween.to(this.mask, 0.5, {x: bounds.x + bounds.width, ease:Sine.easeIn},  0.75);
		Common.animator.add(this.maskTween);

		// Particles
		this.iceBridgePS = new cloudkid.Emitter(this.level,
		[
			this._assetManager.getTexture("particle_snowflake_00"),
			this._assetManager.getTexture("particle_snowflake_01"),
			this._assetManager.getTexture("particle_snowflake_02"),
			this._assetManager.getTexture("particle_snowflake_03")
		], this._assetManager.getJSON("particle_ice_bridge"));

		this.iceBridgePS.emit = true;
	}
}

/**
 * Dispose
 */
LevelPath.prototype.dispose = function()
{
	if(!!this.iceBridgePS)
	{
		this.iceBridgePS.destroy();
	}
}

/**
 * Return true if the path is invisible
 * @return {Boolean}
 */
LevelPath.prototype.isHidden = function()
{
	return (this.config.data != "" && !!this.config.data.hidden);
}

/**
 * Return true if it's a path that should be ignored when the avatar is using the shrink power
 * @return {Boolean}
 */
LevelPath.prototype.isShrinkPath = function()
{
	return (this.config.data != "" && !!this.config.data.shrinkPath);
}

/**
 * Return true if it's a path that has been created by the player and should be ignored by other entities
 * @return {Boolean}
 */
LevelPath.prototype.isArtificialPath = function()
{
	return !!this.config.artificial;
}
},{"../Common":2,"../editor/BezierPath":8}],20:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelRecord(record)
{
	this._assetManager = p3.AssetManager.instance;
	PIXI.Container.call(this);

	this.level  = null;
	this.record = record;

	this.config =
	{
		depth : 100
	}

	this.layers =
	[
		{texture: "ingame_personal_best_01", speed : -160},
		{texture: "ingame_personal_best_01", speed : -120},
		{texture: "ingame_personal_best_00", speed : -80}
	];
	
	this.visible = false;
}
module.exports = LevelRecord;
LevelRecord.prototype = Object.create(GameObject.prototype);
LevelRecord.prototype.constructor = LevelRecord;


//===================================================
// PUBLIC METHODS
//===================================================

LevelRecord.prototype.init = function(level)
{
	this.level = level;

	this.x = this.record * Common.savedData.unit;

	// Sparks
	for(var i = 0; i < this.layers.length; i++)
	{
		var texture   = this._assetManager.getTexture(this.layers[i].texture);
		var sprite    = new PIXI.extras.TilingSprite(texture, texture.width, texture.height);
		sprite.width  = texture.width;
		sprite.height = Common.STAGE_HEIGHT;
		sprite.anchor.set(0.5, 0);
		sprite.scale.x = i % 2 == 0 ? 1 : -1;
		this.addChild(sprite);
		this.layers[i].sprite = sprite;
	}

	// Icon
	var sprite = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_gameplay_distance_record"));
	sprite.anchor.set(0.5);
	sprite.y = 100;
	this.addChild(sprite);
};


LevelRecord.prototype.dispose = function()
{

}

LevelRecord.prototype.update = function()
{
	this.visible = (this.x > this.level.avatar.x - Common.STAGE_WIDTH) && (this.x < this.level.avatar.x + Common.STAGE_WIDTH);
	
	if(!this.visible) return;
	
	var oldY = this.y;

	this.y = -this.level.y * 1/this.level.zoom;
	this.scale.set(1/this.level.zoom);

	for(var i = 0; i < this.layers.length; i++)
	{
		this.layers[i].sprite.tilePosition.y += this.layers[i].speed * p3.Timestep.deltaTime - (this.y - oldY);
	}
};
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],21:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectAxe(avatar)
{
	GameObject.call(this, "axe", false);

	this.avatar  = avatar;
	this.level   = null;
	this.sprite  = null;

	this.velocity = new PIXI.Point(0,0);
	this.gravity  = 0;

	this.active   = false;
	this.timeline = null;
}
module.exports = ObjectAxe;
ObjectAxe.prototype = Object.create(GameObject.prototype);
ObjectAxe.prototype.constructor = ObjectAxe;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
ObjectAxe.prototype.init = function(l)
{
	this.level = l;
	this.gravity = this.level.avatar.gravity;

	this.sprite = new PIXI.Sprite(this._assetManager.getTexture("kristoff_axe_00"));
	this.sprite.anchor.set(.5);
	this.addChild(this.sprite);


	this.collisionCircle = new PIXI.Circle(0, 0, 65);

	if(this.level.debug)
		this.drawCollision();
};

/**
 * Update
 */
ObjectAxe.prototype.update = function()
{
	if(!this.active) return;

	// Update velocity and position
	this.velocity.x -= 100 * p3.Timestep.deltaTime;
	this.velocity.y += this.gravity * p3.Timestep.deltaTime;
	if(this.velocity.x < 0) this.velocity.x = 0;

	this.x += this.velocity.x * p3.Timestep.deltaTime;
	this.y += this.velocity.y * p3.Timestep.deltaTime;

	this.rotation += 360 * PIXI.DEG_TO_RAD * p3.Timestep.deltaTime;

	// Collisions with obstacles
	var collisionCircle = new PIXI.Circle(this.x + this.collisionCircle.x,  this.y + this.collisionCircle.y,    this.collisionCircle.radius);
	var obstacles = this.level.objectManager.getObjectsOfType("obstacle");

	for(var i = 0; i < obstacles.length; i++)
	{
		if(!obstacles[i].interactive) continue;
		if(!obstacles[i].destroyable) continue;

		if(this.avatar.checkCollision(collisionCircle, obstacles[i]))
		{
			obstacles[i].destroy();
		}
	}
};

/**
 * Throw
 */
ObjectAxe.prototype.throw = function()
{
	this.active = true;
	this.sprite.alpha = 1;
	this.velocity.set(1800, -400);

	if(!!this.timeline)
		this.timeline.kill();

	this.timeline = new TimelineMax({onCompleteScope:this, onComplete:function(){this.active = false;}});
		this.timeline.to(this.sprite, 2, {alpha: 0, ease:Quart.easeIn},  0);
	Common.animator.add(this.timeline);
};
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],22:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectCameraZoom()
{
	GameObject.call(this, "camera_zoom", false);

	this.level        = null;
	this.config       = null;
	this.cameraZoom =
	{
		zoom  : 1,
		time  : 0.4,
		delay : 0
	}

}
module.exports = ObjectCameraZoom;
ObjectCameraZoom.prototype = Object.create(GameObject.prototype);
ObjectCameraZoom.prototype.constructor = ObjectCameraZoom;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectCameraZoom.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectCameraZoom.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

ObjectCameraZoom.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	if(this.config.data != "")
	{
		try
		{
			var data = JSON.parse(this.config.data);
			this.cameraZoom.zoom  = !!data.zoom ? data.zoom   : this.cameraZoom.zoom;
			this.cameraZoom.time  = !!data.time ? data.time   : this.cameraZoom.time;
			this.cameraZoom.delay = !!data.delay ? data.delay : this.cameraZoom.delay;
		}
		catch(e)
		{
			console.error("Camera zoom object data error %s", this.config.data);
		}
	}
		
	// Init code
	this.interactive    = true;
	this.sprite.visible = this.level.debug;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);
}

ObjectCameraZoom.prototype.dispose = function()
{

}

ObjectCameraZoom.prototype.update = function()
{

};

ObjectCameraZoom.prototype.hit = function()
{
	if(!this.interactive) return;

	this.interactive = false;
	this.level.changeZoom(this.cameraZoom.zoom, this.cameraZoom.time, this.cameraZoom.delay);
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],23:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectCoin()
{
	GameObject.call(this, "coin", false);

	this.level              = null;
	this.config             = null;

	this.sprite             = null;
	this.attracted          = false;
	this.attractionTimeMax  = 0.3;
	this.attractionPosition = new PIXI.Point();

	this.timeline = null;

	// Particles
	this.pickupPS      = new cloudkid.Emitter(this, [this._assetManager.getTexture("particle_snowflake_00")], this._assetManager.getJSON("particle_coin_collect_burst"));
	this.pickupPS.emit = false;
}
module.exports = ObjectCoin;
ObjectCoin.prototype = Object.create(GameObject.prototype);
ObjectCoin.prototype.constructor = ObjectCoin;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectCoin.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectCoin.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.explosionTween = null;
	if(!!this.explosionTween)
	{
		this.explosionTween.kill();
	}
}

/**
 * Configure
 * @param {Level} level
 * @param {Object} config
 */
ObjectCoin.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture("ui_icon_gameplay_snowflake");
	this.sprite.anchor.set(0.5);
	this.sprite.scale .set(1);
	this.sprite.visible = true;

	// Init code
	this.interactive      = true;
	this.sprite.visible   = true;
	this.attracted        = false;
	this.attractionTarget = 0;
	this.attractionTime   = 0;
	this.rotation  = Math.random(0,360) * PIXI.DEG_TO_RAD;
	this.collisionCircle = new PIXI.Circle(0, 0, 55);

	// Animation
	if(!this.timeline)
	{
		this.sprite.position.set(0, -10)
		this.timeline = new TimelineMax();
			this.timeline.to(this.sprite, 0.75, {y: 10, ease:Sine.easeInOut, repeat:-1, yoyo:true},  Math.random());
			this.timeline.to(this.sprite.scale, 0.5, {x: 1.3, y: 1.3, ease:Sine.easeInOut, repeat:-1, yoyo:true},  0);
		Common.animator.add(this.timeline);
	}
	else
	{
		this.timeline.resume();
	}


	// Explosion
	if(!!config.explosion)
		this.explosion(config.explosion.angle, config.explosion.distance, config.explosion.time)

	// Debug
	if(this.level.debug)
		this.drawCollision();
}

/**
 * Dispose
 */
ObjectCoin.prototype.dispose = function()
{
	if(!!this.timeline)
		this.timeline.pause();
}

/**
 * Update
 */
ObjectCoin.prototype.update = function()
{
	this.pickupPS.update(p3.Timestep.deltaTime);

	if(this.attracted)
	{
		this.attractionTime += p3.Timestep.deltaTime;

		if(this.attractionTime > this.attractionTimeMax)
		{
			this.sprite.visible = false;
			this.attracted      = false;
			return;
		}

		this.x = this.attractionPosition.x + (this.attractionTarget.x - 20 - this.attractionPosition.x) * this.attractionTime/this.attractionTimeMax;
		this.y = this.attractionPosition.y + (this.attractionTarget.y - 20 - this.attractionPosition.y) * this.attractionTime/this.attractionTimeMax;
		this.sprite.scale.x = 1-this.attractionTime/this.attractionTimeMax;
		this.sprite.scale.y = 1-this.attractionTime/this.attractionTimeMax;
	}
};

/**
 * An entity has picked up the coin
 * @param {GameObject} target
 */
ObjectCoin.prototype.pickup = function(target)
{
	if(!this.interactive) return;

	this.interactive      = false;
	this.attracted        = true;
	this.attractionTarget = target;
	this.attractionPosition.set(this.x, this.y);
	this.pickupPS.emit    = true;

	if(!!this.explosionTween)
		this.explosionTween.kill();

	SoundSFX.play("sfx_pickup_snowflake_00");

	return true;
};

/**
 * Move the snoflake in a certain direction from the spawn position
 */
ObjectCoin.prototype.explosion = function(angle, distance, time)
{
	this.explosionTween = new TimelineMax();
	this.explosionTween.to(this, time,
	{
		x: this.x + Math.cos(angle * PIXI.DEG_TO_RAD) * distance, ease:Quad.easeOut,
		y: this.y + Math.sin(angle * PIXI.DEG_TO_RAD) * distance, ease:Quad.easeOut
	},  0);
	Common.animator.add(this.explosionTween);

}
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],24:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectCrystal(color)
{
	GameObject.call(this, "crystal", false);

	this.level        = null;
	this.config       = null;
	this.color        = color;
	this.character    = Common.savedData.getCharacterByColor(this.color);
	this.index        = 0;

	this.highlight = null;
	this.sprite    = null;
	this.attracted = false;
	this.attractionTimeMax = 0.3;
	this.attractionPosition = new PIXI.Point();

	this.canBePickedUp = true;
	this.pickupPS      = new cloudkid.Emitter(this, [this._assetManager.getTexture("particle_snowflake_00")], this._assetManager.getJSON("particle_coin_collect_burst"));
	this.pickupPS.emit = false;

	this.glow     = null;
	this.timeline = null;
}
module.exports = ObjectCrystal;
ObjectCrystal.prototype = Object.create(GameObject.prototype);
ObjectCrystal.prototype.constructor = ObjectCrystal;

ObjectCrystal.prototype.indexes    = {};
ObjectCrystal.prototype.collected  = {};

//===================================================
// PUBLIC METHODS
//===================================================

ObjectCrystal.prototype.init = function()
{
	if(this.glow == null)
	{
		this.glow = new PIXI.Sprite(this._assetManager.getTexture("ingame_crystal_glow"));
		this.glow.anchor.set(0.5);
		this.addChild(this.glow);
	}

	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectCrystal.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.canBePickedUp = true;

	if(this.character == "kristoff")
		this.canBePickedUp = false;
	else
		this.canBePickedUp = true;
}

ObjectCrystal.prototype.configure = function(level, config)
{
	this.reset();
	
	// Current index, shared among all crystals (static)
	if(!this.indexes[this.character])
		this.indexes[this.character] = 1;
	else
		this.indexes[this.character]++;

	// Index of the current colored crystal
	this.index = this.indexes[this.character]-1;

	// Config
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.alpha = 1;
	this.sprite.texture  = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.rotation = this.config.rotation * PIXI.DEG_TO_RAD;
	this.sprite.scale.set(1);
	this.sprite.alpha = 1;

	this.glow.rotation = 0;
	this.glow.scale.set(1);
	this.glow.visible = true;
	this.glow.alpha = 1;

	// Init code
	this.interactive      = true;
	this.sprite.visible   = true;
	this.attracted        = false;
	this.attractionTarget = 0;
	this.attractionTime   = 0;
	this.attractionPosition = new PIXI.Point(this.x, this.y);
	this.rotation  = Math.random(0,360) * PIXI.DEG_TO_RAD;

	this.collisionCircle = new PIXI.Circle(0, 0, 150);

	if(this.level.debug)
		this.drawCollision();

	// Animation
	if(!!this.glow && this.character == Common.savedData.character)
	{
		this.sprite.position.set(0, -10)

		this.timeline = new TimelineMax();
			if(this.character != "kristoff")
				this.timeline.to(this.sprite, 1,    {y: 20, ease:Sine.easeInOut, repeat:-1, yoyo:true, onUpdateScope:this, onUpdate:function(){this.glow.y = this.sprite.y}},  0);
			this.timeline.to(this.glow, 8, {rotation: Math.PI * 2, ease:Linear.easeNone, repeat:-1},  0);
			this.timeline.to(this.glow.scale, 0.5, {x: 1.5, y: 1.5, ease:Quad.easeInOut, repeat:-1, yoyo:true},  0);
		Common.animator.add(this.timeline);
	}

	// Already picked up?
	if(Common.savedData.isCrystalCollected(Common.savedData.level, this.character, this.index))
	{
		if(this.character != Common.savedData.character)
		{
			this.alpha = 0;
		}
		else
		{
			this.interactive = false;
			this.sprite.alpha = 0.5;

			if(!!this.glow)
				this.glow.visible = false;
		}
	}

	// Don't pick up other characters' crystals
	if(!!this.chara)
		this.removeChild(this.chara);

	if(this.character != Common.savedData.character)
	{
		if(Common.savedData.character != "pabbie")
		{
			this.interactive = false;
			this.sprite.alpha = 0.5;

			if(!!this.glow)
				this.glow.visible = false;

			// Add head
			this.chara = new PIXI.Sprite(this._assetManager.getTexture("ingame_progress_char_" + this.character));
			this.chara.anchor.set(0.5);
			this.chara.y = this.character == "kristoff" ? -120 : -90;
			this.chara.x = +10;
			this.addChild(this.chara);
		}
		else
		{
			this.interactive = false;
			this.visible = false;
		}
	}
	else if(Common.savedData.character == "kristoff")
	{
		this.sprite.alpha = this.interactive ? 0.75 : 0;
		// this.glow.alpha   = 0;
	}
}

/**
 */
ObjectCrystal.prototype.dispose = function()
{
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = null;
	}
}

/**
 */
ObjectCrystal.prototype.update = function()
{
	this.pickupPS.update(p3.Timestep.deltaTime);

	if(this.attracted)
	{
		this.attractionTime += p3.Timestep.deltaTime;

		if(this.attractionTime > this.attractionTimeMax)
		{
			this.sprite.visible = false;
			return;
		}

		this.x = this.attractionPosition.x + (this.attractionTarget.x - 20 - this.attractionPosition.x) * this.attractionTime/this.attractionTimeMax;
		this.y = this.attractionPosition.y + (this.attractionTarget.y - 20 - this.attractionPosition.y) * this.attractionTime/this.attractionTimeMax;
		this.sprite.scale.x = 1-this.attractionTime/this.attractionTimeMax;
		this.sprite.scale.y = 1-this.attractionTime/this.attractionTimeMax;
	}

	// this.highlight.rotation += 90 * PIXI.DEG_TO_RAD * p3.Timestep.deltaTime;
};

/**
 * Item collected
 * @param {Object} target
 */
ObjectCrystal.prototype.pickup = function(target)
{
	if(!this.interactive) return;
	if(!this.canBePickedUp) return;

	this.interactive      = false;
	this.attracted        = true;
	this.attractionTarget = target;
	this.pickupPS.emit    = true;

	// Store in the static field that this crystal has been collected
	if(!ObjectCrystal.prototype.collected[this.character])
		ObjectCrystal.prototype.collected[this.character] = [];

	ObjectCrystal.prototype.collected[this.character].push(this.index);

	Common.savedData.crystals[Common.savedData.level][this.character][this.index] = true;
	Common.savedData.save();

	this.level.parent.gameUI.crystalCollected(this.character, this.index);

	// Hide the glow
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = new TimelineMax();
			this.timeline.to(this.glow.scale, this.attractionTimeMax, {x: 0, y: 0, ease:Quad.easeOut},  0);
		Common.animator.add(this.timeline);
	}

	SoundSFX.play("sfx_pickup_gem_tinkle_01");

	return true;
};
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],25:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectDecoration()
{
	this.level  = null;
	this.config = null;

	this.sprite    = null;
	this.character = null;
	this.crystal   = null;

	GameObject.call(this, "decoration", false);
}
module.exports = ObjectDecoration;
ObjectDecoration.prototype = Object.create(GameObject.prototype);
ObjectDecoration.prototype.constructor = ObjectDecoration;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectDecoration.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectDecoration.prototype.reset = function()
{
	this.level     = null;
	this.config    = null;
	this.visible   = true;
	this.character = null;
}

ObjectDecoration.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.sprite.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	if(this.config.data != "")
	{
		try
		{
			var data = JSON.parse(this.config.data);
			this.character = !!data.character ? data.character : null;
			this.crystal   = !!data.crystal ? (parseInt(data.crystal)-1) : null;
		}
		catch(e)
		{
			console.error("Decoration data error %s", this.config.data);
		}
	}

	// Hide if character is different than the one set
	if(this.character != null && this.character != Common.savedData.character)
	{
		this.visible = false;
	}
	
	// Hide if character is the one set but the crystal has been collected
	if(this.character != null && this.crystal != null && this.character == Common.savedData.character && Common.savedData.isCrystalCollected(Common.savedData.level, this.character, this.crystal))
	{
		this.visible = false;
	}	
}

ObjectDecoration.prototype.dispose = function()
{

}

ObjectDecoration.prototype.update = function()
{

};
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],26:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectJumpPlatform()
{
	GameObject.call(this, "jump_platform", false);

	this.level        = null;
	this.config       = null;
	this.jumpPlatform =
	{
		speed  : 1800
	}
}
module.exports = ObjectJumpPlatform;
ObjectJumpPlatform.prototype = Object.create(GameObject.prototype);
ObjectJumpPlatform.prototype.constructor = ObjectJumpPlatform;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectJumpPlatform.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectJumpPlatform.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

ObjectJumpPlatform.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Init code
	this.interactive = true;
	var width        = this.sprite.width  * 0.6;
	var height       = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);
}

ObjectJumpPlatform.prototype.dispose = function()
{

}

ObjectJumpPlatform.prototype.update = function()
{

};

ObjectJumpPlatform.prototype.hit = function(target)
{
	if(target.velocity < 0) return;

	target.velocity.y = -this.jumpPlatform.speed;

	if(!!target.isRidingVehicle)
		target.vehicle.setAnimation('jump_normal', false);
	else
		target.setAnimation('jump_normal', false);
	target.y -= 10;
	target.isGrounded = false;
	target.isTumbling = false;
	target.canTumble  = true;
	
	// Audio
	SoundSFX.playRandomFrom(["sfx_generic_jump_00", "sfx_generic_jump_01", "sfx_generic_jump_02"]);
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],27:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectLevelEnd(args)
{
	GameObject.call(this, "level_end", false);

	this.level    = null;
	this.config   = null;
	this.gameOver = !args;
}
module.exports = ObjectLevelEnd;
ObjectLevelEnd.prototype = Object.create(GameObject.prototype);
ObjectLevelEnd.prototype.constructor = ObjectLevelEnd;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectLevelEnd.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectLevelEnd.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

ObjectLevelEnd.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Init code
	this.interactive    = true;
	this.sprite.visible = this.level.debug;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);
}

ObjectLevelEnd.prototype.dispose = function()
{

}

ObjectLevelEnd.prototype.update = function()
{
	if(!!this.deathPS)
		this.deathPS.update(p3.Timestep.deltaTime)
};

ObjectLevelEnd.prototype.hit = function()
{
	if(!this.interactive) return;
	this.interactive = false;

	// If the character was already dead (by failing a tumble for example)
	if(this.level.avatar.isDead)
	{
		this.level.focusYActive = false;
	}
	else
	{
		if(!this.gameOver)
		{
			this.level.completed = true;
			this.level.avatar.isImmortal = true;
		}
		if(this.gameOver)
		{
			this.level.avatar.isDead = true;
			this.level.avatar.velocity.x = 0;

			this.level.focusYActive = false;
			this.level.changeFocusPoint(new PIXI.Point(0.43, 0.5), 1.25);
			// this.level.avatar.deathPS.emit = true;
			// this.level.avatar.alpha = 0;

			// Death animation
			Common.animator.setTimeout(function()
			{
				this.deathPS = new cloudkid.Emitter(this.level,
				[
					this._assetManager.getTexture("particle_snowflake_00"),
					this._assetManager.getTexture("particle_snowflake_01"),
					this._assetManager.getTexture("particle_snowflake_02"),
					this._assetManager.getTexture("particle_snowflake_03")
				], this._assetManager.getJSON("particle_death"));

				this.deathPS.updateSpawnPos(this.level.avatar.x, (-this.level.y + Common.STAGE_HEIGHT) * (1/this.level.zoom));
				this.deathPS.emit = true;
				
			}, 0.5, this);
			
			Common.animator.setTimeout(function()
			{
				SoundSFX.play("sfx_generic_fall_offscreen_01");
			}, 0.2, this);
		}
		else
		{
			this.level.avatar.areInputActive = false;
			this.level.focusXActive = false;

			if(this.level.avatar.isShrinking)
			{
				this.level.avatar.powerUnshrink();
			}
		}

		this.level.gameOver();
	}
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],28:[function(require,module,exports){
var Common           = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectManager(pools)
{
	this.assetManager = p3.AssetManager.instance;

	this._poolData = pools;
	this._pools    = null;
	this._objects  = [];
	this._id2Pool  = [];

	PIXI.Container.call(this);
}
module.exports = ObjectManager;
ObjectManager.prototype = Object.create(PIXI.Container.prototype);
ObjectManager.prototype.constructor = ObjectManager;

/**
 * TODO
 */
ObjectManager.prototype.init = function()
{
	this._pools = {};
	for(var i = 0; i < this._poolData.length; i++)
	{
		if(!this._pools[this._poolData[i].pool])
		{
			this._pools[this._poolData[i].pool] = new p3.ObjectPool(this._poolData[i].base, !!this._poolData[i].quantity ? this._poolData[i].quantity : 1, this._poolData[i].args);
		}
		this._id2Pool[this._poolData[i].id] = this._poolData[i].pool;
	}
}

/**
 * TODO
 */
ObjectManager.prototype.generate = function(id)
{
	if(!!this._id2Pool[id] && !!this._pools[this._id2Pool[id]])
		var pool = this._pools[this._id2Pool[id]];
	else
		var pool = this._pools["default"];

	// Get one free entity from the pool
	var obj = pool.create();

	// If there are no free entities create some
	if(obj == null)
	{
		pool.expand(2);
		obj = pool.create();
	}

	// Cache it in an array by type
	if(!this._objects[obj.type])
	{
		this._objects[obj.type] = [];
	}
	this._objects[obj.type].push(obj);

	return obj;
};

/**
 * TODO
 */
ObjectManager.prototype.dispose = function(obj)
{
	for(var i in this._pools)
    {
    	if(this._pools[i]._used.indexOf(obj) > -1)
    	{
    		this._pools[i].free(obj);

			var index = this._objects[obj.type].indexOf(obj);
			if(index != -1)
				this._objects[obj.type].splice(index, 1);
    	}
	}
};

/**
 * TODO
 */
ObjectManager.prototype.getObjectsOfType = function(type)
{
	return !!this._objects[type] ? this._objects[type] : [];
};
},{"../Common":2}],29:[function(require,module,exports){
var Common         = require("../Common");
var RunningEntity  = require("./RunningEntity");
var Emitter		   = require("../general/Emitter");
var SoundSFX       = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectMarshmallow()
{
	RunningEntity.call(this, "marshmallow");

	this.level        = null;
	this.avatar       = null;
	this.config       = null;
	this.removeWhenOutside = true;

	this.spine            = null;

	this.currentBodyAnimation = "";
	this.currentLegsAnimation = "";

	this.isJobStarted = false;
	this.isJobDone    = false;
	this.time    = 0;
	this.timeEnd = 7;

	this.isAttacking         = false;
	this.attackTime          = 0;
	this.attackTimeEnd       = 1;
	this.attackCollisionTime = 0.3;
	
	this.walkLoop = "";
}
module.exports = ObjectMarshmallow;
ObjectMarshmallow.prototype = Object.create(RunningEntity.prototype);
ObjectMarshmallow.prototype.constructor = ObjectMarshmallow;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
ObjectMarshmallow.prototype.init = function(l)
{
	// Collider
	this.collisionCircle    = new PIXI.Circle(0, 0, 100);


	// Init spine animation
	if(this.spine == null)
	{
		this.animationHolder = new PIXI.Container();
		this.addChild(this.animationHolder);

		this.spineData = Common.characterAnimationData.char_marshmallow;
		this.spine = new PIXI.spine.Spine(this.spineData);
		this.spine.skeleton.setToSetupPose();
		this.spine.skeleton.setSkin(null);
		this.spine.skeleton.setSkinByName("olaf");
		this.spine.autoUpdate = false;
		this.spine.y = this.collisionCircle.radius;
		this.animationHolder.addChild(this.spine);

		var animations =
		[
			'idle_body',
			'idle_legs',
			'idle_legs',
			'run_flat_body',
			'run_flat_body_swipe',
			'run_flat_legs',
			// 'jump_normal',
			'fall_body',
			'fall_legs',
			'land_body',
			'land_legs',
			'end_wave'
		];

		for(var i = 0; i < animations.length; i++)
		{
			for(var j = 0; j < animations.length; j++)
			{
				if(i == j) continue;

				if(animations[i] == "fall_body" || animations[i] == "fall_legs")
					this.spine.stateData.setMixByName(animations[i], animations[j], 0.1);
				else if(animations[j] == "run_flat_body_swipe")
					this.spine.stateData.setMixByName(animations[i], animations[j], 0.1);
				else
					this.spine.stateData.setMixByName(animations[i], animations[j], 0.4);
			}
		}
	}

	this.attackCollisionCircle = new PIXI.Circle(300, -50, 300);

	// var debugCircle = new PIXI.Graphics();
	// this.addChild(debugCircle);
	// debugCircle.lineStyle(1, 0xF7111D);
	// debugCircle.drawCircle(0, 0, this.attackCollisionCircle.radius);
	// debugCircle.x = this.attackCollisionCircle.x;
	// debugCircle.y = this.attackCollisionCircle.y;
};

/**
 * Reset
 */
ObjectMarshmallow.prototype.reset = function()
{
	this.level  = null;
	this.config = null;

	this.currentAnimation = "";

	this.velocity.set(0);
	this.gravity        = 0;
	this.isGrounded     = false;
	this.collisionPoint = null;

	this.isJobStarted = false;
	this.isJobDone    = false;
	this.time         = 0;
}

/**
 * Configure
 * @param {Level} level
 * @param {Object} config
 */
ObjectMarshmallow.prototype.configure = function(level, config)
{
	this.level   = level;
	this.avatar  = level.avatar;
	this.config  = config;
	this.gravity = this.avatar.gravity;

	// Position
	this.interactive = true;
	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Animation
	this.spine.state.addAnimationByName(0, 'fall_body', true, 0.2);
	this.spine.state.addAnimationByName(1, 'fall_legs', true, 0.2);

	// Particles
	if(!this.snowLandPS)
	{
		this.snowLandPS = new cloudkid.Emitter(this.level, 
		[
			this._assetManager.getTexture("particle_snowflake_00"), 
			this._assetManager.getTexture("particle_snowflake_01"), 
			this._assetManager.getTexture("particle_snowflake_02"), 
			this._assetManager.getTexture("particle_snowflake_03")
		], this._assetManager.getJSON("particle_marshmallow_land"));
	}
	this.snowLandPS.emit = false;

	// Debug
	if(this.level.debug)
		this.drawCollision();
}

/**
 * Dispose
 */
ObjectMarshmallow.prototype.dispose = function()
{
	this.stopLoops();
}

/**
 * Update
 */
ObjectMarshmallow.prototype.update = function()
{
	// Particles update
	this.snowLandPS.update(p3.Timestep.deltaTime);

	// Animation update
	this.spine.update(p3.Timestep.deltaTime);

	// Animation
	if(this.isGrounded && !!this.collisionPoint && !this.isJobStarted)
	{
		this.setBodyAnimation('idle_body', true);
		this.setLegsAnimation('idle_legs', true);
	}
	else if(this.isGrounded && !!this.collisionPoint && this.isJobStarted && !this.isJobDone)
	{
		this.setBodyAnimation('run_flat_body', true);
		this.setLegsAnimation('run_flat_legs', true);
	}
	else if(!this.isGrounded && this.velocity.y > 0)
	{
		this.setBodyAnimation('fall_body', true);
		this.setLegsAnimation('fall_legs', true);
	}

	// Speed
	if(this.isJobDone || !this.isJobStarted)
		this.velocity.x = 0;
	else
		this.velocity.x = this.avatar.velocity.x;

	// Gravity
	this.velocity.y += this.gravity * p3.Timestep.deltaTime;
	if(this.velocity.y >= this.gravity/2) this.velocity.y = this.gravity/2;

	// Rotation update
	// var angleDiff = Math.atan2(Math.sin(this.angleTarget - this.animationHolder.rotation), Math.cos(this.angleTarget - this.animationHolder.rotation));
	// this.animationHolder.rotation = this.animationHolder.rotation + (angleDiff * 0.01);

	// Movement
	var wasGrounded = this.isGrounded;
	this.move(this.velocity);

	// Undo gravity when touching ground
	if(this.isGrounded)
	{
		this.velocity.y = 0;

		if(!wasGrounded && !this.isDead)
		{
			this.land();
		}
	}

	// When close to the character starts walking
	if(!this.isJobStarted)
	{
		// var distance = Math.sqrt(Math.pow(this.x - this.avatar.x, 2) + Math.pow(this.y - this.avatar.y, 2));
		var distance = Math.abs(this.x - this.avatar.x);
		if(distance < 350)
		{
			this.isJobStarted = true;
			
			// Goals: marshmallow
			Common.goalsManager.trackEvent("marshmallow");
		}
	}
	// When the timer ends or the character dies, stop
	else if(!this.isJobDone)
	{
		this.time += p3.Timestep.deltaTime;
		if(this.time >= this.timeEnd || this.avatar.isDead)
		{
			this.stop();
		}
	}

	var attack = false;
	if(this.isAttacking)
	{
		this.attackTime += p3.Timestep.deltaTime;
		if(this.attackTime > this.attackTimeEnd)
		{
			this.attackTime = 0;
			this.isAttacking = false;

		}

		if(this.attackTime > this.attackCollisionTime && this.attackTime-p3.Timestep.deltaTime <= this.attackCollisionTime) attack = true;
	}

	// Collisions with objects
	this.collisions(attack);
	
	// Audio
	if(this.isJobStarted && !this.isJobDone && this.isGrounded)
		this.playLoop("sfx_marshmallow_move_00");
	else
		this.stopLoops();
}

/**
 * Handle collisions with objects
 * @param {Bool} attack
 */
ObjectMarshmallow.prototype.collisions = function(attack)
{
	// Check if enemies nearby to attack
	if(this.isJobStarted && !this.isJobDone && !this.isAttacking)
	{
		// Snowballs
		var snowballs = this.level.objectManager.getObjectsOfType("snowball");

		for(var i = 0; i < snowballs.length; i++)
		{
			if(snowballs[i].x < this.x)   continue;
			if(!snowballs[i].interactive) continue;
			var distance = Math.sqrt(Math.pow(this.x - snowballs[i].x, 2), Math.pow(this.y - snowballs[i].y, 2));

			if(distance < 700)
			{
				this.isAttacking = true;
				this.setBodyAnimation('run_flat_body_swipe', false);
				SoundSFX.play("sfx_marshmallow_grunt_00");
				break;
			}
		}
	}

	// Attack
	if(attack)
	{
		var attackCollisionCircle = new PIXI.Circle(this.x + this.attackCollisionCircle.x,  this.y + this.attackCollisionCircle.y,  this.attackCollisionCircle.radius);

		// Snowballs
		var snowballs = this.level.objectManager.getObjectsOfType("snowball");

		for(var i = 0; i < snowballs.length; i++)
		{
			if(!snowballs[i].interactive) continue;

			if(this.checkCollision(attackCollisionCircle, snowballs[i]))
			{
				snowballs[i].destroy(true)
				this.level.shake(0.4, new PIXI.Point(8,12));
			}
		}
	}

	/*
	var obstacleCollisionCircle = new PIXI.Circle(this.x + this.collisionCircle.x,  this.y + this.collisionCircle.y,    this.collisionCircle.radius);

	// Obstacles
	var obstacles = this.level.objectManager.getObjectsOfType("obstacle");

	for(var i = 0; i < obstacles.length; i++)
	{
		if(!obstacles[i].interactive) continue;
		if(this.checkCollision(obstacleCollisionCircle, obstacles[i]))
		{
			obstacles[i].hit(this)
		}
	}

	// Platforms
	var jump_platforms = this.level.objectManager.getObjectsOfType("jump_platform");

	for(var i = 0; i < jump_platforms.length; i++)
	{
		if(!jump_platforms[i].interactive) continue;
		if(this.checkCollision(obstacleCollisionCircle, jump_platforms[i]))
		{
			jump_platforms[i].hit(this)
		}
	}*/
}

/**
 * Land
 */
ObjectMarshmallow.prototype.land = function()
{
	this.setBodyAnimation('land_body', false);
	this.setLegsAnimation('land_legs', false);

	this.level.shake(0.8, new PIXI.Point(16,30));

	this.snowLandPS.updateSpawnPos(this.x, this.y + this.collisionCircle.radius - 10);
	this.snowLandPS.emit = true;

	SoundSFX.play("sfx_marshmallow_fall_00");
}

/**
 * Stop
 */
ObjectMarshmallow.prototype.stop = function()
{
	if(this.isJobDone) return;

	this.isJobDone = true;

	this.setBodyAnimation('end_wave', true);
	this.setLegsAnimation('idle_legs', false);

	this.stopLoops();
	SoundSFX.play("sfx_marshmallow_end_00");
}

/**
 * Hit
 * @param {GameObject} target
 */
ObjectMarshmallow.prototype.hit = function(target)
{
};

/**
 * Set the animation for the body
 * @param {String} id
 * @param {Bool} loop
 */
ObjectMarshmallow.prototype.setBodyAnimation = function(id, loop)
{
	if(loop && id == this.currentBodyAnimation) return;

	if(id == '')
		this.spine.state.clearTrack(1);
	else if(this.currentBodyAnimation == "land_body") // Delays animation after landing
		this.spine.state.addAnimationByName(1, id, loop, 0.2);
	else if(this.currentBodyAnimation == "run_flat_body_swipe") // Delays animation after attacking
		this.spine.state.addAnimationByName(1, id, loop, 0.7);
	else
		this.spine.state.setAnimationByName(1, id, loop, 0);

	this.currentBodyAnimation = id;
}


/**
 * Set the animation for the legs
 * @param {String} id
 * @param {Bool} loop
 */
ObjectMarshmallow.prototype.setLegsAnimation = function(id, loop)
{
	if(loop && id == this.currentLegsAnimation) return;

	if(id == '')
		this.spine.state.clearTrack(0);
	else if(this.currentLegsAnimation == "land_legs") // Delays animation after landing
		this.spine.state.addAnimationByName(0, id, loop, 0.2);
	else
		this.spine.state.setAnimationByName(0, id, loop, 0);

	this.currentLegsAnimation = id;
}

/**
 * Stop the current loops
 */
ObjectMarshmallow.prototype.stopLoops = function()
{
	if(this.walkLoop != "")
	{		
		SoundSFX.stop(this.walkLoop);
		this.walkLoop = "";
	}
}

/**
 * Stop the current loop and play a new one, if different
 * @param {String} audio
 */
ObjectMarshmallow.prototype.playLoop = function(audio)
{
	if(this.walkLoop == audio) return;
	
	this.stopLoops();
	this.walkLoop = audio;
	SoundSFX.play(this.walkLoop, {loop:true});
}

},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./RunningEntity":38}],30:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectObstacle(iceBlock, explodes)
{
	GameObject.call(this, "obstacle", false);

	this.level       = null;
	this.config      = null;
	this.iceBlock    = !!iceBlock;
	this.explodes    = !!explodes;
}
module.exports = ObjectObstacle;
ObjectObstacle.prototype = Object.create(GameObject.prototype);
ObjectObstacle.prototype.constructor = ObjectObstacle;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
ObjectObstacle.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

/**
 */
ObjectObstacle.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

/**
 */
ObjectObstacle.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Init code
	this.interactive    = true;
	this.sprite.visible = true;
	var width  = this.sprite.width  * 0.6;
	var height = this.sprite.height * 0.7;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);

	// Custom sprite colliders
	if(this.config.id.match(/carriage\_([0-9]{2})\_([0-9]{2})/i))
	{
		var width  = this.sprite.width * 0.3;
		this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x*2, (-this.sprite.anchor.y) * height, width, height);
	}

	// Explosion effect
	if(this.explodes)
	{
		if(!!this.explosionPS)
			this.explosionPS.destroy();

		this.explosionPS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("particle_barrel_0"),
			this._assetManager.getTexture("particle_barrel_1"),
			this._assetManager.getTexture("particle_barrel_2"),
			this._assetManager.getTexture("particle_barrel_3"),
			this._assetManager.getTexture("m1dust3"),
			this._assetManager.getTexture("m1dust3")
		],
		this._assetManager.getJSON("particle_barrel_explosion"));

		this.explosionPS.emit = false;
		this.explosionPS.updateSpawnPos(0, -this.sprite.height/3);
	}

	// Destroy effect
	if(!!this.destroyPS)
	{
		this.destroyPS.destroy();
		this.destroyPS = null;
	}

	var theme = this.config.texture.match(/theme\_([0-9]{2})\_([a-z0-9\_]+)/i)[1];

	if(this.iceBlock)
	{
		this.destroyPS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("theme_" + theme + "_ice_block_01"),
			this._assetManager.getTexture("theme_" + theme + "_ice_block_02"),
			this._assetManager.getTexture("theme_" + theme + "_ice_block_03"),
			this._assetManager.getTexture("theme_" + theme + "_ice_block_04")
		], 
		this._assetManager.getJSON("particle_ice_explosion"));
	}
	else if(this.config.id.match(/crate\_([0-9]{2})\_([0-9]{2})/i) ||
			this.config.id.match(/barrel\_([0-9]{2})\_([0-9]{2})/i) ||
			this.config.id.match(/wood\_([0-9]{2})\_([0-9]{2})/i))
	{
		this.destroyPS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("particle_wood_00"),
			this._assetManager.getTexture("particle_wood_01"),
			this._assetManager.getTexture("particle_wood_02")
		], 
		this._assetManager.getJSON("particle_ice_explosion"));			
	}
	else if(this.config.id.match(/snowman\_([0-9]{2})\_([0-9]{2})/i))
	{
		this.destroyPS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("particle_snowflake_00")
		], 
		this._assetManager.getJSON("particle_ice_explosion"));	
	}
	else if(this.config.id.match(/stones\_([0-9]{2})\_([0-9]{2})/i))
	{
		this.destroyPS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("particle_rock_00"),
			this._assetManager.getTexture("particle_rock_01"),
			this._assetManager.getTexture("particle_rock_02")
		],
		this._assetManager.getJSON("particle_ice_explosion"));	
	}
		
	if(this.destroyPS != null)
	{
		this.destroyPS.emit = false;
		this.destroyPS.updateSpawnPos(0, -this.sprite.height/2);
	}


	if(this.level.debug)
		this.drawCollision();
}

/**
 */
ObjectObstacle.prototype.dispose = function()
{
	if(!!this.explosionPS)
	{
		this.explosionPS.destroy();
		this.explosionPS = null;
	}

	if(!!this.destroyPS)
	{
		this.destroyPS.destroy();
		this.destroyPS = null;
	}
}

/**
 */
ObjectObstacle.prototype.update = function()
{
	if(!!this.explosionPS)
		this.explosionPS.update(p3.Timestep.deltaTime);

	if(!!this.destroyPS)
		this.destroyPS.update(p3.Timestep.deltaTime);
};

/**
 */
ObjectObstacle.prototype.hit = function(target)
{
	if(!this.interactive) return;

	this.interactive = false;

	if(this.explodes)
	{
		this.sprite.visible = false;
		this.level.shake(0.6, new PIXI.Point(60,40));
		this.level.shockwave(this,1);

		this.explosionPS.emit = true;
	}
	
	if(this.iceBlock)
		SoundSFX.playRandomFrom(["sfx_iceblock_smash_00", "sfx_iceblock_smash_01", "sfx_iceblock_smash_02", "sfx_iceblock_smash_03", "sfx_iceblock_smash_04", "sfx_iceblock_smash_05", "sfx_iceblock_smash_06"]);
	else
		SoundSFX.playRandomFrom(["sfx_generic_hit_obstacle_00"]);
};

/**
 */
ObjectObstacle.prototype.destroy = function(source)
{
	if(!this.interactive) return;
	if(source == "axe" && !this.iceBlock) return;

	this.interactive = false;
	
	if(this.destroyPS == null) return;
	
	this.sprite.visible = false;
	this.level.shake(0.4, new PIXI.Point(20,10));
	this.destroyPS.emit = true;
	
	// Free crystals from within
	if(Common.savedData.character == "kristoff")
	{
		if(this.config.id.match(/iceblock\_([0-9]{2})\_([0-9]{2})/i))
		{
			var crystals = this.level.objectManager.getObjectsOfType("crystal");
			for(var i = 0; i < crystals.length; i++)
			{
				if(!crystals[i].interactive) continue;
				
				var distance = Math.abs(this.x - crystals[i].x);
				
				if(distance < 40)
				{
					crystals[i].canBePickedUp = true;
					crystals[i].sprite.alpha     = 1;
					crystals[i].glow.alpha       = 1;
					// crystals[i].pickup(this.avatar);
				}
			}
		}
	}
	
	switch(source)
	{
		case "axe":
			SoundSFX.playRandomFrom(["sfx_kristoff_smash_ice_00", "sfx_kristoff_smash_ice_01", "sfx_kristoff_smash_ice_02", "sfx_kristoff_smash_ice_03", "sfx_kristoff_smash_ice_04", "sfx_kristoff_smash_ice_05", "sfx_kristoff_smash_ice_06"]);
			break;
			
		case "magic":
		case "invulnerability":
			SoundSFX.playRandomFrom(["sfx_iceblock_smash_00", "sfx_iceblock_smash_01", "sfx_iceblock_smash_02", "sfx_iceblock_smash_03", "sfx_iceblock_smash_04", "sfx_iceblock_smash_05", "sfx_iceblock_smash_06"]);
			break;
	}
}
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],31:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
// var Emitter     = require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectPowerup()
{
	GameObject.call(this, "powerup", false);

	this.level              = null;
	this.config             = null;

	this.sprite             = null;
	this.timeline           = null;
	this.duration           = 10;

	// Particles
	this.fxPS = new cloudkid.Emitter(this,
	[
		this._assetManager.getTexture("particle_sparkle_offset_00"),
		this._assetManager.getTexture("particle_sparkle_offset_01"),
		this._assetManager.getTexture("particle_sparkle_offset_02"),
		this._assetManager.getTexture("particle_sparkle_offset_03")
	], this._assetManager.getJSON("particle_troll_magic"));
	this.fxPS.emit = false;
}
module.exports = ObjectPowerup;
ObjectPowerup.prototype = Object.create(GameObject.prototype);
ObjectPowerup.prototype.constructor = ObjectPowerup;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectPowerup.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectPowerup.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.explosionTween = null;
	if(!!this.explosionTween)
	{
		this.explosionTween.kill();
	}
}

/**
 * Configure
 * @param {Level} level
 * @param {Object} config
 */
ObjectPowerup.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;

	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(0.5);
	this.sprite.scale.set(1);
	this.sprite.rotation = 0;
	this.sprite.visible = true;
	this.sprite.blendMode = PIXI.BLEND_MODES.SCREEN;

	// Init code
	this.interactive      = true;
	this.collisionCircle = new PIXI.Circle(0, 0, 70);

	// Particles
	this.fxPS.emit = true;

	// Animation
	if(!!this.timeline)
		this.timeline.kill();

	this.timeline = new TimelineMax();
		this.timeline.to(this.sprite.scale, 0.5, {x: 1.3, y: 1.3, ease:Sine.easeInOut, repeat:-1, yoyo:true},  0);
		this.timeline.to(this.sprite, 0.75, {rotation: 360 * PIXI.DEG_TO_RAD, ease:Linear.easeNone, repeat:-1},  0);
	Common.animator.add(this.timeline);

	// Debug
	if(this.level.debug)
		this.drawCollision();
}

/**
 * Dispose
 */
ObjectPowerup.prototype.dispose = function()
{
	if(!!this.timeline)
		this.timeline.kill();
}

/**
 * Update
 */
ObjectPowerup.prototype.update = function()
{
	// Particles update
	this.fxPS.update(p3.Timestep.deltaTime);
};

/**
 * An entity has picked up the coin
 * @param {GameObject} target
 */
ObjectPowerup.prototype.pickup = function(target)
{
	if(!this.interactive) return;

	this.interactive      = false;
	this.fxPS.emit        = false;

	if(!!this.timeline)
		this.timeline.kill();
	
	this.timeline = new TimelineMax();
		this.timeline.to(this.sprite.scale, 0.25, {x: 0, y: 0, ease:Sine.easeInOut},  0);
	Common.animator.add(this.timeline);	
	
	return true;
};
},{"../Common":2,"../general/SoundSFX":44,"./GameObject":15}],32:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectShrinkLock(args)
{
	GameObject.call(this, "shrink_lock", false);

	this.level        = null;
	this.config       = null;
	this.lock         = args;
}
module.exports = ObjectShrinkLock;
ObjectShrinkLock.prototype = Object.create(GameObject.prototype);
ObjectShrinkLock.prototype.constructor = ObjectShrinkLock;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectShrinkLock.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectShrinkLock.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

ObjectShrinkLock.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Init code
	this.interactive    = true;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.sprite.visible = this.level.debug;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);
}

ObjectShrinkLock.prototype.dispose = function()
{

}

ObjectShrinkLock.prototype.update = function()
{

};

ObjectShrinkLock.prototype.hit = function(avatar)
{
	if(!this.interactive) return;
	this.interactive = false;

	if(avatar.isShrinking)
	{
		if(this.lock)
		{
			avatar.isShrinkLocked = true;
		}
		else if(!this.lock && avatar.isShrinkLocked)
		{
			avatar.powerUnshrink();
		}
	}
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],33:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectSled()
{
	GameObject.call(this, "sled", false);

	this.removeWhenOutside = true;

	this.level        = null;
	this.config       = null;
	this.avatar       = null;

	this.spine        = null;
	this.time         = 0;
	this.timeMax      = 15;
	this.oldParent    = null;
	this.speedBoost   = 400;
	this.magnetBoost  = 1.25;
	this.jumpSpeed    = -1500;

	this.mountTween     = null;
	this.mountSpineX    = 0;
	this.mountSpineY    = 0;
	this.mountSpineTime = 0.6;
	this.mountSpinePerc = 0;

	this.fadeTime = 0.75;
	this.isFading = false;

	this.riderAnimation     = "ride_sled_down";
	this.riderFallAnimation = "ride_sled";

	// Particles
	// this.fxPS = new cloudkid.Emitter(this,
	// [
		// this._assetManager.getTexture("particle_sparkle_offset_02"),
		// this._assetManager.getTexture("particle_sparkle_offset_03")
	// ], this._assetManager.getJSON("particle_sled_shine"));
	// this.fxPS.emit = false;
}
module.exports = ObjectSled;
ObjectSled.prototype = Object.create(GameObject.prototype);
ObjectSled.prototype.constructor = ObjectSled;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectSled.prototype.init = function(l)
{
	if(this.glow == null)
	{
		this.glow = new PIXI.Sprite(this._assetManager.getTexture("ingame_crystal_glow"));
		this.glow.anchor.set(0.5);
		this.glow.position.set(0, -20);
		this.glow.tint = 0xfff495;
		this.addChild(this.glow);
	}
	
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
	}

	// Init spine animation
	if(this.spine == null)
	{
		this.spineData = Common.characterAnimationData.char_sled;
		this.spine = new PIXI.spine.Spine(this.spineData);
		// this.spine.skeleton.setToSetupPose();
		// this.spine.skeleton.setSkin(null);
		// this.spine.skeleton.setSkinByName("sled");
		this.spine.autoUpdate = false;
		this.spine.scale.set(0.5);
		this.addChild(this.spine);

		var animations =
		[
		];

		for(var i = 0; i < animations.length; i++)
		{
			for(var j = 0; j < animations.length; j++)
			{
				if(i == j) continue;

				this.spine.stateData.setMixByName(animations[i], animations[j], 0.2);
			}
		}
	}

	// this.fxPS.emit = true;
};

ObjectSled.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.currentAnimation = "";
	this.time = 0;
}

ObjectSled.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale.set(this.config.scale.x/2, this.config.scale.y/2);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	this.glow.rotation = 0;
	this.glow.scale.set(1);
	this.glow.visible = true;
	this.glow.alpha = 1;	
	
	// Init animation
	// this.spine.state.addAnimationByName(0, 'idle', true, 0.2);
	this.alpha = 1;
	this.isFading = false;

	// Init code
	this.interactive    = true;
	this.sprite.visible = false;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(20, (-this.sprite.anchor.y) * height, 20, height);

	// Debug
	if(this.level.debug)
		this.drawCollision();
	
	// Animation
	this.timeline = new TimelineMax();
		this.timeline.to(this.glow, 8, {rotation: Math.PI * 2, ease:Linear.easeNone, repeat:-1},  0);
		this.timeline.to(this.glow.scale, 0.5, {x: 1.5, y: 1.5, ease:Quad.easeInOut, repeat:-1, yoyo:true},  0);
	Common.animator.add(this.timeline);

}

ObjectSled.prototype.dispose = function()
{
	// this.fxPS.emit = false;
	
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = null;
	}	
}

ObjectSled.prototype.update = function()
{
	// Particles update
	// this.fxPS.update(p3.Timestep.deltaTime);

	// Animation update
	this.spine.update(p3.Timestep.deltaTime);

	// Mount update
	if(this.avatar)
	{
		// Automatic dismout countdown
		// this.time += p3.Timestep.deltaTime;

		// if(this.time >= this.timeMax && this.avatar.isGrounded)
		// {
			// this.dismount();
		// }
		if(this.avatar.isGrounded && this.avatar.collisionPoint.angle < 0)
		{
			this.dismount();
		}
		else
		{
			if(this.mountSpinePerc < 1)
			{
				// Tween the mounting
				this.avatar.spine.x = this.mountSpineX + ((this.spineRiderLock.worldX * this.spine.scale.x)-this.mountSpineX) * this.mountSpinePerc;
				this.avatar.spine.y = this.mountSpineY + ((this.spineRiderLock.worldY * this.spine.scale.y + this.avatar.collisionCircle.radius)-this.mountSpineY)* this.mountSpinePerc;
			}
			else
			{
				// Update the mount position
				this.avatar.spine.x = this.spineRiderLock.worldX * this.spine.scale.x;
				this.avatar.spine.y = this.spineRiderLock.worldY * this.spine.scale.y + this.avatar.collisionCircle.radius;
			}

			if(!this.avatar.isGrounded)
			{
				this.avatar.angleSpeed = 0.05;
				if(this.avatar.velocity.y < 50)
					this.avatar.angleTarget = -20 * PIXI.DEG_TO_RAD;
				else
					this.avatar.angleTarget = +20 * PIXI.DEG_TO_RAD;
			}
			else
			{
				this.avatar.angleSpeed = 0.1;
			}

		}
	}
	// Fade out
	else if(this.isFading)
	{
		this.alpha -= p3.Timestep.deltaTime/this.fadeTime;
		if(this.alpha < 0)
		{
			this.alpha = 0;
			this.isFading = false;
		}
	}
};

ObjectSled.prototype.hit = function(target)
{
	if(!this.interactive) return;

	this.interactive = false;
	this.mount(target);
};

ObjectSled.prototype.mount = function(avatar)
{
	this.removeWhenOutside = false;

	// Save a reference of the layer
	this.oldParent = this.parent;

	// Make the character riding the vehicle
	this.avatar = avatar;
	this.avatar.vehicle = this;
	this.avatar.isRidingVehicle = true;

	// Parent the vehicle inside the characte
	this.avatar.animationHolder.addChildAt(this,0);
	this.rotation = 0;
	this.x = 0;
	this.y = this.avatar.collisionCircle.radius;

	// Powerup the character
	this.avatar.runSpeed            += this.speedBoost;
	this.avatar.runSpeedMin         += this.speedBoost;
	this.avatar.runSpeedMax         += this.speedBoost*2;
	this.avatar.slidingSpeedMax     += this.speedBoost*2;
	this.avatar.pickupCircle.radius *= this.magnetBoost;
	this.avatar.isTumbling = false;
	this.avatar.tumbleAngle = 0;
	this.avatar.slidingAngleStart -= 30;

	// Get a reference to the bone where the character has to sit on
	this.spineRiderLock = this.spine.skeleton.findBone("rider_lock");

	// Ease the movement of the character when mounting the vehicle
	this.mountSpineX    = this.avatar.spine.x;
	this.mountSpineY    = this.avatar.spine.y;
	this.mountSpinePerc = 0;

	// this.fxPS.emit = false;
	
	// Hide the glow
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = new TimelineMax();
			this.timeline.to(this.glow.scale, 0.3, {x: 0, y: 0, ease:Quad.easeOut},  0);
		Common.animator.add(this.timeline);
	}

	this.mountTween = new TimelineMax();
	this.mountTween.to(this, this.mountSpineTime, {mountSpinePerc: 1, ease:Back.easeOut}, 0);
	Common.animator.add(this.mountTween);
}

ObjectSled.prototype.dismount = function()
{
	// Remove the vehicle from the avatar and add it back to its layer
	this.removeWhenOutside = true;
	this.x = this.avatar.x;
	this.y = this.avatar.y + this.avatar.collisionCircle.radius;
	this.avatar.animationHolder.removeChild(this);
	this.oldParent.addChild(this);

	// If the vehicle was on ground show the sliding animation, otherwise, to avoid collision checks with the ground, gravity and such just fade it out
	if(this.avatar.isGrounded)
		this.setAnimation("slide_down_exit", true);
	else
		this.isFading = true;

	// Dismount the chracter
	this.avatar.vehicle = false;
	this.avatar.isRidingVehicle = false;
	this.avatar.y -= -this.avatar.spine.y;
	this.avatar.spine.x = 0;
	this.avatar.spine.y = this.avatar.collisionCircle.radius;

	// Make the character jump
	this.avatar.isGrounded = false;
	this.avatar.isTumbling = false;
	this.avatar.isSliding  = false;
	this.avatar.canTumble  = true;
	this.avatar.velocity.y = this.jumpSpeed;
	this.avatar.y -= 10;
	this.avatar.setAnimation('jump_normal', false);
	this.avatar.slidingAngleStart += 30;

	// Audio
	SoundSFX.playRandomFrom(["sfx_generic_jump_00", "sfx_generic_jump_01", "sfx_generic_jump_02"]);

	// Restore speed and magnet radius
	this.avatar.runSpeed            -= this.speedBoost;
	this.avatar.runSpeedMin         -= this.speedBoost;
	this.avatar.runSpeedMax         -= this.speedBoost*2;
	this.avatar.slidingSpeedMax     -= this.speedBoost*2;
	this.avatar.pickupCircle.radius  = this.avatar.pickupCircle.radius/this.magnetBoost;

	this.avatar = null;
}

ObjectSled.prototype.setAnimation = function(id, loop)
{
	return;
	if(loop && id == this.currentAnimation) return;

	this.currentAnimation = id;
	this.spine.state.setAnimationByName(0, id, loop, 0);
}
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],34:[function(require,module,exports){
var Common         = require("../Common");
var RunningEntity  = require("./RunningEntity");
var Emitter		   = require("../general/Emitter");
var SoundSFX       = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectSnowball()
{
	RunningEntity.call(this, "snowball");

	this.level        = null;
	this.config       = null;
	this.removeWhenOutside = true;

	this.speed = 500;
	this.destroyed = false;
}
module.exports = ObjectSnowball;
ObjectSnowball.prototype = Object.create(RunningEntity.prototype);
ObjectSnowball.prototype.constructor = ObjectSnowball;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Init
 */
ObjectSnowball.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite(this._assetManager.getTexture("ingame_obstacle_snowball_1"));
		this.sprite.anchor.set(0.5);
		this.sprite.scale .set(1);
		this.sprite.rotation = 0;
		this.addChild(this.sprite);

		this.sprite.shading = new PIXI.Sprite(this._assetManager.getTexture("ingame_obstacle_snowball_2"));
		this.sprite.shading.anchor.set(0.5);
		this.sprite.addChild(this.sprite.shading);
	}
};

/**
 * Reset
 */
ObjectSnowball.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.velocity.set(0);
	this.gravity        = 0;
	this.isGrounded     = false;
	this.collisionPoint = null;

	this.sprite.rotation = 0;
	this.sprite.shading.rotation = 0;
	this.sprite.alpha = 1;
	this.alpha = 1;
}

/**
 * Configure
 * @param {Level} level
 * @param {Object} config
 */
ObjectSnowball.prototype.configure = function(level, config)
{
	this.level   = level;
	this.config  = config;
	this.gravity = level.avatar.gravity;

	this.x = this.config.position.x;
	this.y = this.config.position.y;

	// Init code
	this.interactive      = true;
	this.sprite.visible   = true;
	this.sprite.scale.set(this.config.scale.x, this.config.scale.y)
	this.destroyed        = false;

	// Collider
	this.collisionCircle = new PIXI.Circle(0, 0, this.sprite.width*0.425);

	// Particles
	if(!this.trailPS)
	{
		this.trailPS = new cloudkid.Emitter(this.level,
		[
			this._assetManager.getTexture("particle_snowflake_00"),
			this._assetManager.getTexture("particle_snowflake_01"),
			this._assetManager.getTexture("particle_snowflake_02"),
			this._assetManager.getTexture("particle_snowflake_03")
		], this._assetManager.getJSON("particle_snowball"));
	}
	this.trailPS.emit = true;

	this.destroyPS = new cloudkid.Emitter(this,
	[
		this._assetManager.getTexture("particle_snowflake_00")
	],
	this._assetManager.getJSON("particle_ice_explosion"));
	this.destroyPS.updateSpawnPos(0, -this.sprite.height/2);
	this.destroyPS.emit = false;

	// Debug
	if(this.level.debug)
		this.drawCollision();
}

/**
 * Dispose
 */
ObjectSnowball.prototype.dispose = function()
{
	// Stop particles
	this.trailPS.emit = false;
	this.destroyPS.emit = false;
}

/**
 * Update
 */
ObjectSnowball.prototype.update = function()
{
	// Particles update
	this.trailPS.updateSpawnPos(this.x, this.y);
	this.trailPS.update(p3.Timestep.deltaTime);
	this.destroyPS.update(p3.Timestep.deltaTime);

	// Update position
	if(!this.destroyed)
	{
		if(this.isGrounded)
			this.velocity.x = -this.speed;
		else
			this.velocity.x = 0;

		// Gravity
		this.velocity.y += this.gravity * p3.Timestep.deltaTime;
		if(this.velocity.y >= this.gravity/2) this.velocity.y = this.gravity/2;

		// Movement
		var wasGrounded = this.isGrounded;
		this.move(this.velocity);

		// Undo gravity when touching ground
		if(this.isGrounded)
		{
			this.velocity.y = 0;
		}

		this.sprite.rotation -= 360 * PIXI.DEG_TO_RAD * p3.Timestep.deltaTime;
		this.sprite.shading.rotation = -this.sprite.rotation;
	}
}

/**
 * Hit
 * @param {GameObject} target
 */
ObjectSnowball.prototype.hit = function(target)
{
	if(!this.interactive) return;
	this.interactive = false;

	this.destroyPS.emit = true;

	SoundSFX.playRandomFrom(["sfx_generic_hit_obstacle_00"]);
};

/**
 * Destroy
 * @param {bool} reward
 */
ObjectSnowball.prototype.destroy = function(reward)
{
	if(!this.interactive) return;
	this.interactive = false;
	this.destroyed   = true;

	// Stop particles
	this.trailPS.emit   = false;
	this.destroyPS.emit = true;

	// Fade out
	var tl = new TimelineMax();
	tl.to(this.sprite, 0.15, {alpha: 0, ease:Linear.easeNone},  0);
	Common.animator.add(tl);

	// Generate snowflakes
	if(reward)
	{
		for(var i = 0; i < 5; i++)
		{
			this.parent.addObject("coin",
			{
				position : {x:this.x, y:this.y},
				explosion : {angle : -60 - 20 * i, distance: 300, time: 0.5}
			});
		}
	}


	SoundSFX.playRandomFrom(["sfx_iceblock_smash_00", "sfx_iceblock_smash_01", "sfx_iceblock_smash_02", "sfx_iceblock_smash_03", "sfx_iceblock_smash_04", "sfx_iceblock_smash_05", "sfx_iceblock_smash_06"]);
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./RunningEntity":38}],35:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectSven()
{
	GameObject.call(this, "sven", false);

	this.removeWhenOutside = true;

	this.level        = null;
	this.config       = null;
	this.avatar       = null;

	this.spine        = null;
	this.time         = 0;
	this.timeMax      = 10;
	this.oldParent    = null;
	this.speedBoost   = 200;
	this.magnetBoost  = 1.25;
	this.jumpSpeed    = -1500;

	this.mountTween     = null;
	this.mountSpineX    = 0;
	this.mountSpineY    = 0;
	this.mountSpineTime = 0.6;
	this.mountSpinePerc = 0;

	this.fadeTime = 0.75;
	this.isFading = false;
	
	this.riderAnimation     = "ride_sven";
	this.riderFallAnimation = "ride_sven_fall";
}
module.exports = ObjectSven;
ObjectSven.prototype = Object.create(GameObject.prototype);
ObjectSven.prototype.constructor = ObjectSven;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectSven.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
	}

	// Init spine animation
	if(this.spine == null)
	{
		this.spineData = Common.characterAnimationData.char_sven;
		this.spine = new PIXI.spine.Spine(this.spineData);
		this.spine.skeleton.setToSetupPose();
		this.spine.skeleton.setSkin(null);
		this.spine.skeleton.setSkinByName("sven");
		this.spine.autoUpdate = false;
		this.spine.scale.set(0.5);
		this.addChild(this.spine);

		var animations =
		[
			'idle',
			'run_flat',
			'jump_normal',
			'slide_down_steep',
			'slide_down_exit',
			'fall',
			'land_bad'
		];

		for(var i = 0; i < animations.length; i++)
		{
			for(var j = 0; j < animations.length; j++)
			{
				if(i == j) continue;

				if(animations[i] == "fall")
					this.spine.stateData.setMixByName(animations[i], animations[j], 0.1);
				else
					this.spine.stateData.setMixByName(animations[i], animations[j], 0.2);
			}
		}
	}
};

ObjectSven.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;

	this.currentAnimation = "";
	this.time = 0;
}

ObjectSven.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale.set(this.config.scale.x/2, this.config.scale.y/2);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	// Init animation
	this.spine.state.addAnimationByName(0, 'idle', true, 0.2);
	this.alpha = 1;
	this.isFading = false;

	// Init code
	this.interactive    = true;
	this.sprite.visible = false;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(55, (-this.sprite.anchor.y) * height/2, 20, height/2);

	// Is there already another Sven? Disable it if so
	if(this.level.avatar.isRidingVehicle && this.level.avatar.vehicle.type == this.type)
	{
		this.interactive = false;
		this.alpha = 0;
	}
	
	// Debug
	if(this.level.debug)
		this.drawCollision();
}

ObjectSven.prototype.dispose = function()
{

}

ObjectSven.prototype.update = function()
{
	// Animation update
	this.spine.update(p3.Timestep.deltaTime);

	// Mount update
	if(this.avatar)
	{
		// Automatic dismout countdown
		this.time += p3.Timestep.deltaTime;

		if(this.time >= this.timeMax && this.avatar.isGrounded)
		{
			this.dismount(false);
		}
		else
		{
			if(this.mountSpinePerc < 1)
			{
				// Tween the mounting
				this.avatar.spine.x = this.mountSpineX + ((this.spineRiderLock.worldX * this.spine.scale.x)-this.mountSpineX) * this.mountSpinePerc;
				this.avatar.spine.y = this.mountSpineY + ((this.spineRiderLock.worldY * this.spine.scale.y + this.avatar.collisionCircle.radius)-this.mountSpineY)* this.mountSpinePerc;
			}
			else
			{
				// Update the mount position
				this.avatar.spine.x = this.spineRiderLock.worldX * this.spine.scale.x;
				this.avatar.spine.y = this.spineRiderLock.worldY * this.spine.scale.y + this.avatar.collisionCircle.radius;
			}
		}
	}
	// Fade out
	else if(this.isFading)
	{
		this.alpha -= p3.Timestep.deltaTime/this.fadeTime;
		if(this.alpha < 0)
		{
			this.alpha = 0;
			this.isFading = false;
		}
	}
};

ObjectSven.prototype.hit = function(target)
{
	if(!this.interactive) return;

	this.interactive = false;
	this.mount(target);
};

ObjectSven.prototype.mount = function(avatar)
{
	this.removeWhenOutside = false;

	// Save a reference of the layer
	this.oldParent = this.parent;

	// Make the character riding the vehicle
	this.avatar = avatar;
	this.avatar.vehicle = this;
	this.avatar.isRidingVehicle = true;

	// Parent the vehicle inside the characte
	this.avatar.animationHolder.addChildAt(this,0);
	this.rotation = 0;
	this.x = 0;
	this.y = this.avatar.collisionCircle.radius;

	// Powerup the character
	this.avatar.runSpeed            += this.speedBoost;
	this.avatar.runSpeedMin         += this.speedBoost;
	this.avatar.runSpeedMax         += this.speedBoost;
	this.avatar.slidingSpeedMax     += this.speedBoost;
	this.avatar.pickupCircle.radius *= this.magnetBoost;
	this.avatar.isTumbling = false;
	this.avatar.tumbleAngle = 0;
	this.avatar.animationHolder.rotation = 0;

	// Get a reference to the bone where the character has to sit on
	this.spineRiderLock = this.spine.skeleton.findBone("rider_lock");

	// Ease the movement of the character when mounting the vehicle
	this.mountSpineX    = this.avatar.spine.x;
	this.mountSpineY    = this.avatar.spine.y;
	this.mountSpinePerc = 0;

	this.mountTween = new TimelineMax();
	this.mountTween.to(this, this.mountSpineTime, {mountSpinePerc: 1, ease:Back.easeOut}, 0);
	Common.animator.add(this.mountTween);
}

ObjectSven.prototype.dismount = function(hitByObstacle)
{
	// Remove the vehicle from the avatar and add it back to its layer
	this.removeWhenOutside = true;
	this.x = this.avatar.x;
	this.y = this.avatar.y + this.avatar.collisionCircle.radius;
	this.avatar.animationHolder.removeChild(this);
	this.oldParent.addChild(this);

	// If the vehicle was on ground show the sliding animation, otherwise, to avoid collision checks with the ground, gravity and such just fade it out
	if(this.avatar.isGrounded)
		this.setAnimation("land_bad", false);
	else
		this.isFading = true;
	
	// Audio
	if(hitByObstacle)
		SoundSFX.play("sfx_sven_hitobstacle_stop_00");
	else
		SoundSFX.play("sfx_sven_run_stop_00");		

	// Dismount the character
	this.avatar.vehicle = false;
	this.avatar.isRidingVehicle = false;
	this.avatar.y -= -this.avatar.spine.y;
	this.avatar.spine.x = 0;
	this.avatar.spine.y = this.avatar.collisionCircle.radius;

	// Make the character jump
	this.avatar.isGrounded = false;
	this.avatar.isTumbling = false;
	this.avatar.isSliding  = false;
	this.avatar.canTumble  = true;
	this.avatar.velocity.y = this.jumpSpeed;
	this.avatar.setAnimation('jump_normal', false);

	// Audio
	SoundSFX.playRandomFrom(["sfx_generic_jump_00", "sfx_generic_jump_01", "sfx_generic_jump_02"]);

	// Restore speed and magnet radius
	this.avatar.runSpeed            -= this.speedBoost;
	this.avatar.runSpeedMin         -= this.speedBoost;
	this.avatar.runSpeedMax         -= this.speedBoost;
	this.avatar.slidingSpeedMax     -= this.speedBoost;
	this.avatar.pickupCircle.radius  = this.avatar.pickupCircle.radius/this.magnetBoost;

	this.avatar = null;
}

ObjectSven.prototype.setAnimation = function(id, loop)
{
	if(loop && id == this.currentAnimation) return;

	this.currentAnimation = id;
	this.spine.state.setAnimationByName(0, id, loop, 0);
}
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],36:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectTroll(isCollectable)
{
	GameObject.call(this, "troll", false);

	this.removeWhenOutside = true;

	this.level        = null;
	this.config       = null;
	this.avatar       = null;

	this.spine        = null;
	this.time         = 0;
	this.timeMax      = 10;

	this.isCollectable = isCollectable;
	this.isCollected   = false;

	this.fadeTime = 0.75;
	this.isFading = false;

	this.glow     = null;
	this.timeline = null;

	this.character = "";
	this.crystal   = "";
	this.hasBlinked = false;

	this.pickupPS      = new cloudkid.Emitter(this, [this._assetManager.getTexture("particle_snowflake_00")], this._assetManager.getJSON("particle_coin_collect_burst"));
	this.pickupPS.emit = false;
}
module.exports = ObjectTroll;
ObjectTroll.prototype = Object.create(GameObject.prototype);
ObjectTroll.prototype.constructor = ObjectTroll;

ObjectTroll.prototype.indexes    = 0;
ObjectTroll.prototype.collected  = [];


//===================================================
// PUBLIC METHODS
//===================================================

ObjectTroll.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
	}

	// Init spine animation
	if(this.spine == null)
	{
		this.spineData = Common.characterAnimationData.char_troll;
		this.spine = new PIXI.spine.Spine(this.spineData);
		this.spine.skeleton.setToSetupPose();
		this.spine.skeleton.setSkin(null);
		this.spine.skeleton.setSkinByName("troll_sign");
		this.spine.autoUpdate = false;
		this.spine.scale.set(0.5);
		this.addChild(this.spine);

		var animations =
		[
			'idle1',
			'idle2',
			'idle3'
		];

		for(var i = 0; i < animations.length; i++)
		{
			for(var j = 0; j < animations.length; j++)
			{
				if(i == j) continue;
				this.spine.stateData.setMixByName(animations[i], animations[j], 0.2);
			}
		}
	}
};

ObjectTroll.prototype.reset = function()
{
	this.level     = null;
	this.config    = null;
	this.visible   = true;
	this.character = "";

	this.currentAnimation = "";
	this.time = 0;
}

ObjectTroll.prototype.configure = function(level, config)
{
	if(this.isCollectable)
	{
		// Current index, shared among all trplls (static)
		this.indexes++;

		// Index of the current troll
		this.index = this.indexes-1;

		// Collected
		this.isCollected = Common.savedData.isTrollCollected(Common.savedData.level, this.index)

		// Glow
		if(this.glow == null)
		{
			this.glow = new PIXI.Sprite(this._assetManager.getTexture("ingame_crystal_glow"));
			this.glow.anchor.set(0.5);
			this.glow.y -= 20;
			this.addChildAt(this.glow, 0);
		}

		this.glow.rotation = 0;
		this.glow.scale.set(1);

		// Animation
		this.timeline = new TimelineMax();
			this.timeline.to(this.glow, 8, {rotation: Math.PI * 2, ease:Linear.easeNone, repeat:-1},  0);
			this.timeline.to(this.glow.scale, 0.5, {x: 1.5, y: 1.5, ease:Quad.easeInOut, repeat:-1, yoyo:true},  0);
		Common.animator.add(this.timeline);
	}

	// Config
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale.set(this.config.scale.x/2, this.config.scale.y/2);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;
	this.hasBlinked = false;

	// Init animation
	this.alpha = 1;
	this.isFading = false;

	if(this.isCollectable)
	{
		if(this.isCollected)
		{
			this.spine.state.addAnimationByName(0, 'idle2', true, 0.2);
			this.glow.visible = false;
			this.visible = false;
		}
		else
		{
			if(Common.savedData.character == 'pabbie')
			{
				this.spine.state.addAnimationByName(0, 'idle3', true, 0.2);
				this.glow.visible = true;
			}
			else
			{
				this.glow.visible = false;
				this.spine.alpha = 0.5;

				// Add head
				this.chara = new PIXI.Sprite(this._assetManager.getTexture("ingame_progress_char_pabbie"));
				this.chara.anchor.set(0.5);
				this.chara.y = -120;
				this.chara.x = 10;
				this.addChild(this.chara);
			}
		}
	}
	else
	{
		this.spine.state.addAnimationByName(0, 'idle1', true, 0.2);

		if(this.config.data != "")
		{
			try
			{
				var data = JSON.parse(this.config.data);
				this.character = !!data.character ? data.character : null;
				this.crystal   = !!data.crystal ? (parseInt(data.crystal)-1) : null;
			}
			catch(e)
			{
				console.error("Decoration data error %s", this.config.data);
			}
		}

		if(this.character != null && this.character != Common.savedData.character)
		{
			this.visible = false;
		}

		if(this.character != null && this.crystal != null && this.character == Common.savedData.character && Common.savedData.isCrystalCollected(Common.savedData.level, this.character, this.crystal))
		{
			this.visible = false;
		}
	}

	// Init code
	this.interactive    = this.isCollectable && !this.isCollected;
	this.sprite.visible = false;
	var width  = this.sprite.width;
	var height = this.sprite.height;

	this.collisionCircle = new PIXI.Circle(0, -this.sprite.height/2, 100);

	// Debug
	if(this.level.debug)
		this.drawCollision();
}

ObjectTroll.prototype.dispose = function()
{
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = null;
	}
}

ObjectTroll.prototype.update = function()
{
	this.pickupPS.update(p3.Timestep.deltaTime);

	// Animation update
	this.spine.update(p3.Timestep.deltaTime);

	// Fade out
	if(this.isFading)
	{
		this.alpha -= p3.Timestep.deltaTime/this.fadeTime;
		if(this.alpha < 0)
		{
			this.alpha = 0;
			this.isFading = false;
		}
	}

	// Blink when close enough
	if(!this.hasBlinked && this.visible)
	{
		if(Math.sqrt(Math.pow(this.level.avatar.x - this.x, 2) + Math.pow(this.level.avatar.y - this.y, 2)) < 1000)
		{
			SoundSFX.play("sfx_troll_notify_00");
			this.hasBlinked = true;
		}
	}
};

ObjectTroll.prototype.pickup = function(target)
{
	if(!this.interactive) return;
	if(!this.isCollectable) return;

	this.interactive   = false;
	this.pickupPS.emit = true;

	// Store in the static field that this troll has been collected
	ObjectTroll.prototype.collected.push(this.index);

	Common.savedData.trolls[Common.savedData.level][this.index] = true;
	Common.savedData.save();

	this.setAnimation("idle2");

	// Show the top container
	this.level.parent.gameUI.trollCollected();

	this.spine.state.addAnimationByName(0, 'collected', true, 0.2);
	SoundSFX.play("sfx_pickup_troll_01");

	// Hide the glow
	if(!!this.timeline)
	{
		this.timeline.kill();
		this.timeline = new TimelineMax();
			this.timeline.to(this.glow.scale, 0.3, {x: 0, y: 0, ease:Quad.easeOut},  0);
		Common.animator.add(this.timeline);
	}
};

ObjectTroll.prototype.setAnimation = function(id, loop)
{
	if(loop && id == this.currentAnimation) return;

	this.currentAnimation = id;
	this.spine.state.setAnimationByName(0, id, loop, 0);
}
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],37:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ObjectTutorial()
{
	GameObject.call(this, "tutorial", false);

	this.level        = null;
	this.config       = null;
	this.text         = "";
}
module.exports = ObjectTutorial;
ObjectTutorial.prototype = Object.create(GameObject.prototype);
ObjectTutorial.prototype.constructor = ObjectTutorial;


//===================================================
// PUBLIC METHODS
//===================================================

ObjectTutorial.prototype.init = function(l)
{
	if(this.sprite == null)
	{
		this.sprite = new PIXI.Sprite();
		this.addChild(this.sprite);
	}
};

ObjectTutorial.prototype.reset = function()
{
	this.level    = null;
	this.config   = null;
}

ObjectTutorial.prototype.configure = function(level, config)
{
	this.level  = level;
	this.config = config;

	this.x = this.config.position.x;
	this.y = this.config.position.y;
	this.sprite.texture = this._assetManager.getTexture(this.config.texture);
	this.sprite.anchor.set(this.config.anchor.x, this.config.anchor.y);
	this.sprite.scale .set(this.config.scale.x, this.config.scale.y);
	this.rotation = this.config.rotation * PIXI.DEG_TO_RAD;

	if(this.config.data != "")
	{
		try
		{
			var data = JSON.parse(this.config.data);
			this.text  = !!data.text ? data.text : "WELL_DONE";
		}
		catch(e)
		{
			console.error("Tutorial object data error %s", this.config.data);
		}
	}
		
	// Init code
	this.interactive    = Common.savedData.character != "pabbie";
	this.sprite.visible = this.level.debug;
	var width  = this.sprite.width;
	var height = this.sprite.height;
	this.collisionRect = new PIXI.Rectangle(-width * this.sprite.anchor.x, (-this.sprite.anchor.y) * height, width, height);
}

ObjectTutorial.prototype.dispose = function()
{

}

ObjectTutorial.prototype.update = function()
{

};

ObjectTutorial.prototype.hit = function()
{
	if(!this.interactive) return;

	this.interactive = false;
	this.level.parent.gameUI.tutorial(this._assetManager.getJSON("strings")[this.text][Common.COUNTRY_CODE]);
	
	if(this.text == "TUTORIAL_TUMBLE")
	{
		this.level.parent.gameUI.highlight("style")
	}
};
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],38:[function(require,module,exports){
var Common      = require("../Common");
var GameObject  = require("./GameObject");
var Emitter		= require("../general/Emitter");
var SoundSFX    = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function RunningEntity(name)
{
	GameObject.call(this, name, false);

	this.allowPathCollisions   = true;
	this.isGrounded            = false;
	this.collisionPoint        = null;
	this.angleTarget           = 0;
	this.velocity              = new PIXI.Point();
	this.ignoreArtificialPaths = true;
}
module.exports = RunningEntity;
RunningEntity.prototype = Object.create(GameObject.prototype);
RunningEntity.prototype.constructor = RunningEntity;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Move the character and handle collisions
 * @param {PIXI.Point} velocity
 */
RunningEntity.prototype.move = function(velocity)
{
	var directionY = Math.sign(velocity.y);
	
	// Calculate speed
	var velocity = new PIXI.Point
	(
		velocity.x * p3.Timestep.deltaTime,
		velocity.y * p3.Timestep.deltaTime
	);

	// Quickfix: Limit vertical speed to diameter to avoid passing through collision lines
	if(velocity.y > 0 && velocity.y >= this.collisionCircle.radius)
	{
		// console.log("speed limit activated")
		velocity.y = this.collisionCircle.radius * 0.99;
	}

	// Adjust speed to slope angle
	if(this.isGrounded && !!this.collisionPoint)
	{
		velocity.x *=  Math.cos(this.collisionPoint.angle)
	}

	// Apply movement
	this.x += velocity.x;
	this.y += velocity.y;

	// Collisions
	if(this.allowPathCollisions)
	{
		var wasGrounded     = this.isGrounded;
		this.collisionPoint = null;
		this.isGrounded     = false;

		if(this.level.debug)
		{
			if(!!this.wireframe)
				this.level.removeChild(this.wireframe)

			this.wireframe = new PIXI.Graphics();
			this.wireframe.config = {depth:1000};
			this.level.addChild(this.wireframe)
		}

		// Top collisions
		for(var i = 0; i < this.level.layers.length; i++)
		{
			for(var j = 0; j < this.level.layers[i].childrenPaths.length; j++)
			{
				// Collide only with closed paths
				// if(!this.level.layers[i].childrenPaths[j].config.closed) continue;

				// Check if the path is relevant
				if(this.level.layers[i].childrenPaths[j].config.collisions != 1) continue;
				if(this.level.layers[i].childrenPaths[j].config.bounds[0] > this.x + this.collisionCircle.x + this.collisionCircle.radius * 2) continue;
				if(this.level.layers[i].childrenPaths[j].config.bounds[1] < this.x + this.collisionCircle.x - this.collisionCircle.radius * 2) continue;
				if(this.isShrinking && this.level.layers[i].childrenPaths[j].isShrinkPath()) continue;
				if(this.ignoreArtificialPaths && this.level.layers[i].childrenPaths[j].isArtificialPath()) continue;

				// Loop through the path segments
				var points = this.level.layers[i].childrenPaths[j].bezier.getDrawingPoints();

				for(var p = 0; p < points.length-1; p++)
				{
					// Segment points
					var p1 = points[p+1];
					var p2 = points[p];

					// Skip segments facing up
					if(p1.x > p2.x) continue;

					// Circle collider center
					var pAvatar = new PIXI.Point(this.x + this.collisionCircle.x, this.y + this.collisionCircle.y);

					// Is the segment close to the collider?
					if(p1.x > pAvatar.x + this.collisionCircle.radius) continue;
					if(p2.x < pAvatar.x - this.collisionCircle.radius) continue;
					if(p1.y > pAvatar.y + this.collisionCircle.radius && p2.y > pAvatar.y + this.collisionCircle.radius) continue;
					if(p1.y < pAvatar.y - this.collisionCircle.radius && p2.y < pAvatar.y - this.collisionCircle.radius) continue;

					// Segment of the bezier curve
					var segment = new PIXI.Point(points[p+1].x - points[p].x, points[p+1].y - points[p].y);
					var segmentNormalized = new PIXI.Point(segment.x, segment.y);
					segmentNormalized.normalize();

					// Avatar-segment vector
					var vAvatar = new PIXI.Point(this.x + this.collisionCircle.x - points[p].x, this.y + this.collisionCircle.y - points[p].y);

					// Calculate the projection of vAvatar onto the segment
					var vProjLength = vAvatar.dotProduct(segment) / segment.getLength();
					var vProj       = new PIXI.Point(segmentNormalized.x * vProjLength, segmentNormalized.y * vProjLength);

					// Clamp the projection vector
					if(vProj.x != segment.x)
					{
						if(vProj.x/segment.x < 0)
							vProj = new PIXI.Point(0,0);
						if(vProj.x/segment.x > 1)
							vProj = new PIXI.Point(segment.x, segment.y);
					}
					else
					{
						if(vProj.y/segment.y < 0)
							vProj = new PIXI.Point(0,0);
						if(vProj.y/segment.y > 1)
							vProj = new PIXI.Point(segment.x, segment.y);
					}

					// Calculate the perpendicular
					var perp = new PIXI.Point(vProj.x - vAvatar.x, vProj.y - vAvatar.y);
					var perpLength = perp.getLength();

					if(this.level.debug)
					{
						this.wireframe.lineStyle(8, 0xffffff, 1);
						this.wireframe.moveTo(p1.x, p1.y);
						this.wireframe.lineTo(p2.x, p2.y);

						this.wireframe.lineStyle(6, 0x0000ff, 1);
						this.wireframe.moveTo(pAvatar.x, pAvatar.y);
						this.wireframe.lineTo(pAvatar.x - vAvatar.x, pAvatar.y - vAvatar.y);
					}

					// If the length of the perpendicular is less than the radius the segment collides with the circle
					if(perpLength < this.collisionCircle.radius)
					{
						if(this.level.debug)
						{
							this.wireframe.lineStyle(3, 0xff00ff, 1);
							this.wireframe.moveTo(points[p].x, points[p].y);
							this.wireframe.lineTo(points[p].x + vProj.x, points[p].y + vProj.y);

							this.wireframe.lineStyle(5, 0x00ff00, 1);
							this.wireframe.moveTo(points[p].x + vProj.x, points[p].y + vProj.y);
							this.wireframe.lineTo(points[p].x + vProj.x - perp.x, points[p].y + vProj.y - perp.y);
						}

						// If the character was moving against the wall, push it back
						if(velocity.x != 0)
						{
							this.x += -Math.sign(velocity.x) * (this.collisionCircle.radius - perpLength);
						}

						// If the character was jumping make it fall
						if(this.velocity.y < 0)
						{
							this.y -= velocity.y;
							this.velocity.y = 200;
						}
					}
				}
			}
		}

		// Ground collision
		var slopeAngleMax = 80;

		for(var i = 0; i < this.level.layers.length; i++)
		{
			for(var j = 0; j < this.level.layers[i].childrenPaths.length; j++)
			{
				// Check if the path is relevant
				if(this.level.layers[i].childrenPaths[j].config.collisions == 0) continue;
				if(this.level.layers[i].childrenPaths[j].config.collisions == 2 && directionY < 0) continue;
				if(this.level.layers[i].childrenPaths[j].config.bounds[0] > this.x + this.collisionCircle.x + this.collisionCircle.radius * 2) continue;
				if(this.level.layers[i].childrenPaths[j].config.bounds[1] < this.x + this.collisionCircle.x - this.collisionCircle.radius * 2) continue;
				if(this.isShrinking && this.level.layers[i].childrenPaths[j].isShrinkPath()) continue;
				if(this.ignoreArtificialPaths && this.level.layers[i].childrenPaths[j].isArtificialPath()) continue;

				// Loop through the path segments
				var points = this.level.layers[i].childrenPaths[j].bezier.getDrawingPoints();

				do
				{
					var repeat = false;

					for(var p = 0; p < points.length-1; p++)
					{
						// Segment points
						var p1 = points[p];
						var p2 = points[p+1];

						// Skip segments facing down
						if(p1.x > p2.x) continue;

						// Circle collider center
						var pAvatar = new PIXI.Point(this.x + this.collisionCircle.x, this.y + this.collisionCircle.y);

						// Is the segment close to the collider?
						if(p1.x > pAvatar.x + this.collisionCircle.radius) continue;
						if(p2.x < pAvatar.x - this.collisionCircle.radius) continue;
						if(p1.y > pAvatar.y + this.collisionCircle.radius && p2.y > pAvatar.y + this.collisionCircle.radius) continue;
						if(p1.y < pAvatar.y - this.collisionCircle.radius && p2.y < pAvatar.y - this.collisionCircle.radius) continue;

						// Skip slopes that are too inclined
						var segmentAngle = Math.atan2((p2.y - p1.y), (p2.x - p1.x));
						if(Math.abs(segmentAngle * PIXI.RAD_TO_DEG) >= slopeAngleMax) continue;

						// Jumpthrough paths
						if(this.level.layers[i].childrenPaths[j].config.collisions == 2)
						{
							if(!wasGrounded)
							{
								// If it's a path that can be jumped through, make sure that the bottom of the circle collider is close enough to the path before attempting to stick to it
								var dX = (pAvatar.x - p1.x)/(p2.x - p1.x);
								dX = Math.min(Math.max(dX, 0), 1);
								var sY = p1.y + (p2.y - p1.y) * dX;

								if(pAvatar.y > sY) continue;
							} 

							if(Math.abs(segmentAngle * PIXI.RAD_TO_DEG) >= this.level.layers[i].childrenPaths[j].config.texWallAngle) continue;
						}

						// Segment of the bezier curve
						var segment = new PIXI.Point(points[p+1].x - points[p].x, points[p+1].y - points[p].y);
						var segmentNormalized = new PIXI.Point(segment.x, segment.y);
						segmentNormalized.normalize();

						// Avatar-segment vector
						var vAvatar = new PIXI.Point(this.x + this.collisionCircle.x - points[p].x, this.y + this.collisionCircle.y - points[p].y);

						// Calculate the projection of vAvatar onto the segment
						var vProjLength = vAvatar.dotProduct(segment) / segment.getLength();
						var vProj       = new PIXI.Point(segmentNormalized.x * vProjLength, segmentNormalized.y * vProjLength);

						// Clamp the projection vector
						if(vProj.x != segment.x)
						{
							if(vProj.x/segment.x < 0 && !wasGrounded) continue; // Test fix: don't extrapolate the projection point if jumping

							if(vProj.x/segment.x < 0)
								vProj = new PIXI.Point(0,0);
							if(vProj.x/segment.x > 1)
								vProj = new PIXI.Point(segment.x, segment.y);
						}
						else
						{
							if(vProj.y/segment.y < 0)
								vProj = new PIXI.Point(0,0);
							if(vProj.y/segment.y > 1)
								vProj = new PIXI.Point(segment.x, segment.y);
						}

						// Calculate the perpendicular
						var perp = new PIXI.Point(vProj.x - vAvatar.x, vProj.y - vAvatar.y);
						var perpLength = perp.getLength();

						if(this.level.debug)
						{
							this.wireframe.lineStyle(8, 0xffffff, 1);
							this.wireframe.moveTo(p1.x, p1.y);
							this.wireframe.lineTo(p2.x, p2.y);

							this.wireframe.lineStyle(6, 0x0000ff, 1);
							this.wireframe.moveTo(pAvatar.x, pAvatar.y);
							this.wireframe.lineTo(pAvatar.x - vAvatar.x, pAvatar.y - vAvatar.y);
						}

						// If the length of the perpendicular is less than the radius the segment collides with the circle
						if(perpLength < this.collisionCircle.radius)
						{
							if(this.level.debug)
							{
								this.wireframe.lineStyle(3, 0xff00ff, 1);
								this.wireframe.moveTo(points[p].x, points[p].y);
								this.wireframe.lineTo(points[p].x + vProj.x, points[p].y + vProj.y);

								this.wireframe.lineStyle(5, 0xff0000, 1);
								this.wireframe.moveTo(points[p].x + vProj.x, points[p].y + vProj.y);
								this.wireframe.lineTo(points[p].x + vProj.x - perp.x, points[p].y + vProj.y - perp.y);
							}

							// Collision!
							velocity.y = 0;
							this.isGrounded = true;

							// Move the character up by the vertical distance between the projection end point and the point on the circumference
							perp.normalize();
							var angleDown = perp.angle(new PIXI.Point(0,1))
							var delta     = (Math.sin(Math.acos(Math.sin(angleDown))) * this.collisionCircle.radius) - (Math.abs(Math.cos(angleDown)) * perpLength);
							this.y        -= delta;

							this.collisionPoint =
							{
								path : this.level.layers[i].childrenPaths[j],
								position:
								{
									x: points[p].x + vProj.x,
									y: points[p].y + vProj.y
								},
								angle: segmentAngle
							}

							if(delta >= 1)
							{
								repeat = true;
							}
						}
					}
				} while(repeat);
			}
		}

		// When descending a slope, stick to it
		if(!this.isGrounded && wasGrounded && velocity.y > 0)
		{
			var slopeAngleMax   = 80;
			var slopeTollerance = 50;
			var slopeDistance   = slopeTollerance;

			for(var i = 0; i < this.level.layers.length; i++)
			{
				for(var j = 0; j < this.level.layers[i].childrenPaths.length; j++)
				{
					// Check if the path is relevant
					if(this.level.layers[i].childrenPaths[j].config.collisions == 0) continue;
					if(this.level.layers[i].childrenPaths[j].config.collisions == 2 && directionY < 0) continue;
					if(this.level.layers[i].childrenPaths[j].config.bounds[0] > this.x + this.collisionCircle.x + this.collisionCircle.radius * 2) continue;
					if(this.level.layers[i].childrenPaths[j].config.bounds[1] < this.x + this.collisionCircle.x - this.collisionCircle.radius * 2) continue;
					if(this.isShrinking && this.level.layers[i].childrenPaths[j].isShrinkPath()) continue;
					if(this.ignoreArtificialPaths && this.level.layers[i].childrenPaths[j].isArtificialPath()) continue;

					// Loop through the path segments
					var points = this.level.layers[i].childrenPaths[j].bezier.getDrawingPoints();

					for(var p = 0; p < points.length-1; p++)
					{
						// Segment points
						var p1 = points[p];
						var p2 = points[p+1];

						// Skip segments facing down
						if(p1.x > p2.x) continue;

						// Circle collider center
						var pAvatar = new PIXI.Point(this.x + this.collisionCircle.x, this.y + this.collisionCircle.y);

						// Is the segment close to the collider?
						if(p1.x > pAvatar.x + this.collisionCircle.radius) continue;
						if(p2.x < pAvatar.x - this.collisionCircle.radius) continue;
						if(p1.y < pAvatar.y - this.collisionCircle.radius && p2.y < pAvatar.y - this.collisionCircle.radius) continue;
						if(p1.y > pAvatar.y + this.collisionCircle.radius + 50 && p2.y > pAvatar.y + this.collisionCircle.radius + 50) continue;

						// Skip slopes that are too inclined
						var segmentAngle = Math.atan2((p2.y - p1.y), (p2.x - p1.x));
						if(Math.abs(segmentAngle * PIXI.RAD_TO_DEG) > slopeAngleMax) continue;

						// Segment of the bezier curve
						var segment = new PIXI.Point(points[p+1].x - points[p].x, points[p+1].y - points[p].y);
						var segmentNormalized = new PIXI.Point(segment.x, segment.y);
						segmentNormalized.normalize();

						// Avatar-segment vector
						var vAvatar = new PIXI.Point(this.x + this.collisionCircle.x - points[p].x, this.y + this.collisionCircle.y - points[p].y);

						// Calculate the projection of vAvatar onto the segment
						var vProjLength = vAvatar.dotProduct(segment) / segment.getLength();
						var vProj       = new PIXI.Point(segmentNormalized.x * vProjLength, segmentNormalized.y * vProjLength);

						// Clamp the projection vector
						if(vProj.x != segment.x)
						{
							if(vProj.x/segment.x < 0)
								vProj = new PIXI.Point(0,0);
							if(vProj.x/segment.x > 1)
								vProj = new PIXI.Point(segment.x, segment.y);
						}
						else
						{
							if(vProj.y/segment.y < 0)
								vProj = new PIXI.Point(0,0);
							if(vProj.y/segment.y > 1)
								vProj = new PIXI.Point(segment.x, segment.y);
						}

						// Calculate the perpendicular
						var perp  = new PIXI.Point(vProj.x - vAvatar.x, vProj.y - vAvatar.y);
						var perpLength = perp.getLength();

						if(this.level.debug)
						{
							this.wireframe.lineStyle(8, 0xffffff, 1);
							this.wireframe.moveTo(p1.x, p1.y);
							this.wireframe.lineTo(p2.x, p2.y);

							this.wireframe.lineStyle(6, 0x0000ff, 1);
							this.wireframe.moveTo(pAvatar.x, pAvatar.y);
							this.wireframe.lineTo(pAvatar.x - vAvatar.x, pAvatar.y - vAvatar.y);
						}

						// If the length of the perpendicular is less than the radius the segment collides with the circle
						if(perp.y > 0 && perpLength > this.collisionCircle.radius)
						{
							if(this.level.debug)
							{
								this.wireframe.lineStyle(3, 0xff00ff, 1);
								this.wireframe.moveTo(points[p].x, points[p].y);
								this.wireframe.lineTo(points[p].x + vProj.x, points[p].y + vProj.y);

								this.wireframe.lineStyle(5, 0xff6600, 1);
								this.wireframe.moveTo(points[p].x + vProj.x, points[p].y + vProj.y);
								this.wireframe.lineTo(points[p].x + vProj.x - perp.x, points[p].y + vProj.y - perp.y);
							}

							perp.normalize();
							var angleDown = perp.angle(new PIXI.Point(0,1));

							var cosLength = perpLength - this.collisionCircle.radius;
							var sinLength = (cosLength * Math.sin(angleDown)) / Math.cos(angleDown);
							var distance  = Math.sqrt(Math.pow(cosLength,2) + Math.pow(sinLength,2));

							if(distance < slopeDistance)
							{
								slopeDistance = distance;

								this.collisionPoint =
								{
									path : this.level.layers[i].childrenPaths[j],
									position:
									{
										x: points[p].x + vProj.x,
										y: points[p].y + vProj.y
									},
									angle: segmentAngle
								}
							}
						}
					}
				}
			}

			if(slopeDistance < slopeTollerance)
			{
				velocity.y = 0;
				this.y += slopeDistance;
				this.isGrounded = true;
			}
		}

		// Sprite angle
		if(this.isGrounded &&  (!((this.isSliding && this.timeUnsliding == 0)) || ((this.isOlaf() || this.isRidingVehicle) && this.isSliding)))
			this.angleTarget = this.collisionPoint.angle;
		else if(this.isTumbling)
			this.angleTarget = 0 + this.tumbleAngle;
		else
			this.angleTarget = 0;
	}
}


/**
 * TODO
 */
RunningEntity.prototype.checkCollision = function(c1, obj)
{
	if(obj.collisionRect != null)
	{
		var points = [];
		points.push(new PIXI.Point(obj.x + obj.collisionRect.x,                           obj.y + obj.collisionRect.y));
		points.push(new PIXI.Point(obj.x + obj.collisionRect.x + obj.collisionRect.width, obj.y + obj.collisionRect.y));
		points.push(new PIXI.Point(obj.x + obj.collisionRect.x + obj.collisionRect.width, obj.y + obj.collisionRect.y + obj.collisionRect.height));
		points.push(new PIXI.Point(obj.x + obj.collisionRect.x,                           obj.y + obj.collisionRect.y + obj.collisionRect.height));

		var pivot = new PIXI.Point(obj.x, obj.y);

		for(var  i = 0; i < points.length; i++)
		{
			points[i].rotateAround(pivot, obj.rotation);
		}


		// if(!!obj.test)
			// this.level.removeChild(obj.test)

		// obj.test = new PIXI.Graphics();
		// this.level.addChild(obj.test);
		// obj.test.lineStyle(2, 0x00ff00);

		// obj.test.moveTo(points[0].x, points[0].y);
		// obj.test.lineTo(points[1].x, points[1].y);
		// obj.test.lineTo(points[2].x, points[2].y);
		// obj.test.lineTo(points[3].x, points[3].y);
		// obj.test.lineTo(points[0].x, points[0].y);
		
		for(var i = 0; i < points.length; i++)
		{
			if(Math.sqrt(Math.pow(points[i].x - c1.x,2) + Math.pow(points[i].y - c1.y,2)) < c1.radius)
			{
				return true;
			}
		}

		for(var p = 0; p < points.length; p++)
		{
			var segment = new PIXI.Point(points[(p+1)%points.length].x - points[p].x, points[(p+1)%points.length].y - points[p].y);
			var segmentNormalized = new PIXI.Point(segment.x, segment.y);
			segmentNormalized.normalize();

			// Avatar-segment vector
			var vAvatar = new PIXI.Point(c1.x - points[p].x, c1.y - points[p].y);

			// Calculate the projection of vAvatar onto the segment
			var vProjLength = vAvatar.dotProduct(segment) / segment.getLength();
			var vProj       = new PIXI.Point(segmentNormalized.x * vProjLength, segmentNormalized.y * vProjLength);

			// Make sure the projection vector is within the segment
			if(vProj.x != segment.x)
			{
				if(vProj.x/segment.x < 0) continue;
				if(vProj.x/segment.x > 1) continue;
			}
			else
			{
				if(vProj.y/segment.y < 0) continue;
				if(vProj.y/segment.y > 1) continue;
			}

			// Calculate the perpendicular
			var perp  = new PIXI.Point(vProj.x - vAvatar.x, vProj.y - vAvatar.y);
			var perpLength = perp.getLength();

			if(perpLength < c1.radius)
			{
				// obj.test.lineStyle(1, 0x0000ff, 1);
				// obj.test.moveTo(c1.x, c1.y);
				// obj.test.lineTo(c1.x - vAvatar.x, c1.y - vAvatar.y);

				// obj.test.lineStyle(2, 0xff00ff, 1);
				// obj.test.moveTo(points[p].x, points[p].y);
				// obj.test.lineTo(points[p].x + vProj.x, points[p].y + vProj.y);

				// obj.test.lineStyle(3, 0xff6600, 1);
				// obj.test.moveTo(points[p].x + vProj.x, points[p].y + vProj.y);
				// obj.test.lineTo(points[p].x + vProj.x - perp.x, points[p].y + vProj.y - perp.y);

				return true;
			}
		}
	}
	else if(obj.collisionCircle != null)
	{
		var c2 = new PIXI.Circle(obj.x, obj.y, obj.collisionCircle.radius)

		// Circle-circle collision
		var diff = new PIXI.Point(c1.x - c2.x, c1.y - c2.y);
		return ((Math.pow(diff.x, 2) + Math.pow(diff.y, 2)) <= Math.pow(c1.radius + c2.radius, 2));
	}

	return false;
}
},{"../Common":2,"../general/Emitter":41,"../general/SoundSFX":44,"./GameObject":15}],39:[function(require,module,exports){
/**
 *  Shockwave
 *
 *  Created by Legman on 10/05/2016.
 *
 */

"use strict";

var Common = require("../Common");

/**
 * @param {!PIXI.DisplayObject} view
 * @param {!PIXI.Texture} texture
 * @constructor
 */
function Shockwave(view, texture)
{
	/**
	 * @type {PIXI.DisplayObject}
	 * @private
	 */
	this._view = view;

	/**
	 * @type {null}
	 * @private
	 */
	this._filter = null;

	PIXI.Sprite.call(this, texture);

	this.anchor = new PIXI.Point(0.5, 0.5);

	this._filter = new PIXI.filters.DisplacementFilter(this);

	if (this._view.filters) {
		this._view.filters.push(this._filter);
	} else {
		this._view.filters = [this._filter];
	}
}
module.exports		= Shockwave;
Shockwave.prototype	= Object.create(PIXI.Sprite.prototype);
Shockwave.prototype.constructor = Shockwave;

Shockwave.prototype.destroy = function()
{
	if (this._view.filters) {
		var index = this._view.filters.indexOf(this._filter);
		if (index != -1) {
			if (this._view.filters.length > 1) {
				this._view.filters.splice(index, 1);
			} else {
				this._view.filters = null;
			}
		}
	}

	this.parent.removeChild(this);
	PIXI.Sprite.prototype.destroy.call(this);
};

/**
 * @param {number=} duration
 */
Shockwave.prototype.animate = function(duration)
{
	duration = duration || 1.4;

	var tl = new TimelineMax({
		onComplete: this.destroy,
		onCompleteScope: this
	});

	this.scale.x = 0.01;
	this.scale.y = 0.01;
	tl.insert(TweenMax.to(this.scale, duration, {
		x: 5.0,
		y: 5.0,
		ease: Power1.easeOut
	}));

	tl.insert(TweenMax.to(this.filter.scale, duration * 0.3, {
		delay: duration - duration * 0.3,
		x: 0.1,
		y: 0.1,
		ease: Power1.easeInOut
	}));
};

Object.defineProperty(Shockwave.prototype, "view",
{
	/**
	 * @returns {DisplayObject}
	 */
	get: function() {
		return this._view;
	}
});

Object.defineProperty(Shockwave.prototype, "filter",
{
	/**
	 * @returns {PIXI.filters.DisplacementFilter}
	 */
	get: function() {
		return this._filter;
	}
});

},{"../Common":2}],40:[function(require,module,exports){
var Common              = require("../Common");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function CharacterSelectPanel(screen, data)
{
	this._screen         = screen;
	this._assetManager   = p3.AssetManager.instance;
	this._powerupData    = $.extend(true, this._assetManager.getJSON("config").powerups, this._assetManager.getJSON("strings").powerups);
	this._powerupKeys    = ["tumble_speed", "snow_magnet", "troll_magic"];
	this._data           = data;
	this._subPanelActive = false;
	this._subPanelPower  = 0;

	PIXI.Container.call(this);
    this.init();
}
module.exports = CharacterSelectPanel;
CharacterSelectPanel.prototype = Object.create(PIXI.Container.prototype);
CharacterSelectPanel.prototype.constructor = CharacterSelectPanel;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Initialization
 */
CharacterSelectPanel.prototype.init = function()
{
	// var character = new PIXI.Sprite(this._assetManager.getTexture("ui_char_" + this._data.id));
	// character.anchor.set(0.5, 1);
	// character.x = 200;
	// character.y = Common.STAGE_HEIGHT/2;
    // this.addChild(character);

	this.spine = new PIXI.spine.Spine(Common.characterAnimationData[this._data.id]);
	this.spine.skeleton.setToSetupPose();
	this.spine.skeleton.setSkin(null);
	this.spine.skeleton.setSkinByName("default");
	this.spine.x = 200;
	this.spine.y = Common.STAGE_HEIGHT/2;
	this.spine.autoUpdate = true;
	this.spine.scale.set(0.5);
	this.spine.state.setAnimationByName(0, "look_left", true, 0);
	this.addChild(this.spine);
	
		this.upgradePS = new cloudkid.Emitter(this,
		[
			this._assetManager.getTexture("particle_snowflake_00"),
			this._assetManager.getTexture("particle_snowflake_01"),
			this._assetManager.getTexture("particle_snowflake_02"),
			this._assetManager.getTexture("particle_snowflake_03")
		], this._assetManager.getJSON("particle_char_upgrade"));

		this.upgradePS.updateSpawnPos(this.spine.x, this.spine.y -200);
		this.upgradePS.emit = false;


	// Upgrade subpanel
	var upgrade_panel = new PIXI.Sprite(this._assetManager.getTexture("ui_upgrade_panel"));
	upgrade_panel.x = -350;
	upgrade_panel.y = -110;
    this.addChild(upgrade_panel);

		this._upgrade_info = new PIXI.Sprite(this._assetManager.getTexture("ui_upgrade_info_2"));
		this._upgrade_info.xStart = 50;
		this._upgrade_info.xEnd   = 370;
		this._upgrade_info.x      = this._upgrade_info.xStart;
		this._upgrade_info.y      = 40;
		this._upgrade_info.alpha  = 0;
		upgrade_panel.addChild(this._upgrade_info);

			// Close button
			var buyClose = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_upgrade_close_out"),
				this._assetManager.getTexture("ui_btn_upgrade_close_over"),
				this._assetManager.getTexture("ui_btn_upgrade_close_down")
			);
			buyClose.position.set(280, 40);
			buyClose.signals.down.add(this.onUpgradeCloseClicked, this);
			buyClose.overSoundName = "sfx_btn_rollover_00";
			this._upgrade_info.addChild(buyClose);

			// Power icon
			this._buyIcon = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_upgrade_tumble"));
			this._buyIcon.anchor.set(0.5);
			this._buyIcon.position.set(168, 70);
			this._upgrade_info.addChild(this._buyIcon);

			// Power-up text
			if(!webfont)
			{
				this._buyDescription = new PIXI.extras.BitmapText("Description", {font: "30px Mikadan White", align: "center", tint: 0x6d38ab});
				this._buyDescription.x = -this._buyDescription.textWidth/2  + 168;
				this._buyDescription.y = -this._buyDescription.textHeight/2 + 175;
				this._upgrade_info.addChild(this._buyDescription);
			}
			else
			{
				this._buyDescription = new PIXI.Text("Description", {font:"30px Arial", fill:0x6d38ab, align:'center'});
				this._buyDescription.position.set(168, 175);
				this._buyDescription.anchor.set(0.5);
				this._upgrade_info.addChild(this._buyDescription);
			}

			// Buy button
			this._buyButton = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_buy_out"),
				this._assetManager.getTexture("ui_btn_buy_over"),
				this._assetManager.getTexture("ui_btn_buy_down")
			);
			this._buyButton.position.set(175, 290);
			this._buyButton.scale.set(0);
			this._buyButton.signals.down.add(this.onBuyClick, this);
			this._buyButton.overSoundName = "sfx_btn_rollover_00";
			this._upgrade_info.addChild(this._buyButton);

				var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
				snowflake.anchor.set(0.5);
				snowflake.position.set(-92, 0);
				this._buyButton.addChild(snowflake);

				if(!webfont)
				{
					this._buyButton._price = new PIXI.extras.BitmapText("0", {font: "40px Superclarendon Numbers", align: "center"});
					this._buyButton._price.x = -this._buyButton._price.textWidth/2 + 5;
					this._buyButton._price.y = -this._buyButton._price.textHeight/2;
					this._buyButton.addChild(this._buyButton._price);
				}
				else
				{
					this._buyButton._price = new PIXI.Text("?", {font:"36px Arial", fill:0xffffff, align:'center'});
					this._buyButton._price.position.set(5, 0);
					this._buyButton._price.anchor.set(0.5);
					this._buyButton.addChild(this._buyButton._price);
				}

			// Disabled buy button without rollover or events
			this._buyDisabledButton = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_buy_out_inactive")
			);
			this._buyDisabledButton.position = this._buyButton.position;
			this._buyDisabledButton.scale.set(0);
			this._buyDisabledButton.signals.down.add(this.onBuyDisabledClick, this);
			this._upgrade_info.addChild(this._buyDisabledButton);

				var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
				snowflake.anchor.set(0.5);
				snowflake.position.set(-92, 0);
				snowflake.filters = [new PIXI.filters.GrayFilter()];
				this._buyDisabledButton.addChild(snowflake);

				if(!webfont)
				{
					this._buyDisabledButton._price = new PIXI.extras.BitmapText("0", {font: "40px Superclarendon Numbers", align: "center"});
					this._buyDisabledButton._price.x = -this._buyDisabledButton._price.textWidth/2 + 5;
					this._buyDisabledButton._price.y = -this._buyDisabledButton._price.textHeight/2;
					this._buyDisabledButton.addChild(this._buyDisabledButton._price);

					var colorMatrix = new PIXI.filters.ColorMatrixFilter();
					colorMatrix.desaturate();
					this._buyDisabledButton._price.filters = [colorMatrix];
				}
				else
				{
					this._buyDisabledButton._price = new PIXI.Text("?", {font:"36px Arial", fill:0xffffff, align:'center'});
					this._buyDisabledButton._price.position.set(5, 0);
					this._buyDisabledButton._price.anchor.set(0.5);
					this._buyDisabledButton.addChild(this._buyDisabledButton._price);
				}

		// Panel
		var panel_bg = new PIXI.Sprite(this._assetManager.getTexture("ui_upgrade_info_1"));
		upgrade_panel.addChild(panel_bg);

		// Powers
		for(var i = 0; i < 3; i++)
		{
			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(this._powerupData[this._powerupKeys[i]].text[Common.COUNTRY_CODE], {font: "24px Mikadan White", align: "left", tint: 0x6d38ab});
				text.x = 120;
				text.y = -text.textHeight/2 + 58 + 100 * i;
				upgrade_panel.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(this._powerupData[this._powerupKeys[i]].text[Common.COUNTRY_CODE], {font:"24px Arial", fill:0x6d38ab, align:'left'});
				text.anchor.set(r2l ? 1 : 0, 0.5);
				text.position.set(r2l ? 370 : 120, 58 + 100 * i);
				upgrade_panel.addChild(text);
			}
		}

		this._gems = [];
		this._gemsButton = [];

		for(var p = 0; p < 3; p++)
		{
			this._gems[p] = [];

			for(var i = 0; i < 3; i++)
			{
				var gem = new PIXI.Sprite(this._assetManager.getTexture("ui_upgrade_gem"));
				gem.anchor.set(0.5);
				gem.x = 170 + 83 * i;
				gem.y = 102 + 99 * p;
				upgrade_panel.addChild(gem);

				if(Common.savedData.charactersPower[this._data.id][p] <= i)
					gem.visible = false;

				this._gems[p].push(gem);
			}

			if(Common.savedData.charactersPower[this._data.id][p] < 3)
			{
				var plus = new p3.Button
				(
					this._assetManager.getTexture("ui_btn_upgrade_out"),
					this._assetManager.getTexture("ui_btn_upgrade_over"),
					this._assetManager.getTexture("ui_btn_upgrade_down")
				);
				plus.x = 170 + 84  * Common.savedData.charactersPower[this._data.id][p];
				plus.y = 102 + 100 * p;
				plus.id = p;
				plus.signals.down.add(this.onPlusClicked, this);
				plus.overSoundName = "sfx_btn_rollover_00";
				upgrade_panel.addChild(plus);

				this._gemsButton[p] = plus;
				
				// Plus pulse animation
				var cost = this._powerupData[p].cost[Common.savedData.charactersPower[this._data.id][p]];
				if(cost <= Common.savedData.coins)
				{
					plus.timeline =  new TimelineMax();
					plus.timeline.to(plus.scale, 0.5, {x:1.15, y:1.15, ease:Sine.easeInOut, yoyo:true, repeat:-1});
					Common.animator.add(plus.timeline);
				}
				else
				{
					var colorMatrix = new PIXI.filters.ColorMatrixFilter();
					colorMatrix.desaturate();
					plus.filters = [colorMatrix];
				}
			}
		}

	// Current level
	var level_bg = new PIXI.Sprite(this._assetManager.getTexture(this._data.id == "pabbie" ? "ui_level_bg_troll" : "ui_level_bg"));
	level_bg.position.set(upgrade_panel.x, -220);

	if(!Common.savedData.endless) this.addChild(level_bg);

		var copy = this._assetManager.getJSON("strings")["LEVEL"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy.replace("{value}", (Common.savedData.level+1)), {font: "26px Superclarendon Level", align: "center"});
			text.x = -text.textWidth/2  + level_bg.width/2 - 40;
			text.y = -text.textHeight/2 + 55;
			level_bg.addChild(text);
		}
		else
		{
			var text = new PIXI.Text("Level " + (Common.savedData.level+1), {font:"24px Arial", fill:0x000000, align:'center'});
			text.x = level_bg.width/2 - 50;
			text.y = 57;
			text.anchor.set(0.5);
			level_bg.addChild(text);
		}

		if(this._data.id == "pabbie")
		{
			var trollCollected = Common.savedData.getLevelCollectedTrollCount(Common.savedData.level);
			var trollCount     = 3;

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(trollCollected + "/" + trollCount, {font: "32px Superclarendon Level", align: "center"});
				text.x = -text.textWidth/2  + 340;
				text.y = -text.textHeight/2 + 50;
				level_bg.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(trollCollected + "/" + trollCount, {font:"32px Arial", fill:0xffffff, align:'center'});
				text.anchor.set(0.5);
				text.x += 340;
				text.y += 57;
				level_bg.addChild(text);
			}
		}
		else
		{
			// Character crystals for the level
			if(!!Common.savedData.crystals[Common.savedData.level][this._data.id])
			{
				for(var i = 0; i < 3; i++)
				{
					if(!Common.savedData.crystals[Common.savedData.level][this._data.id][i]) continue;

					var crystal = new PIXI.Sprite(this._assetManager.getTexture("ui_level_crystal_" + this._data.color + "_" + (i+1)));
					level_bg.addChild(crystal);
				}
			}
		}
};

/**
 * Function called when a plus button is clicked, will open the subpanel
 * @param {Number} plus - the index of the power (0,1,2)
 */
CharacterSelectPanel.prototype.onPlusClicked = function(plus)
{
	// Skip if the panel for that power is already open
	if(this._subPanelActive && this._subPanelPower == plus.id) return;

	this._subPanelPower  = plus.id;

	if(!!this._subPanelTimeline)
		this._subPanelTimeline.kill();

	this._subPanelTimeline = new TimelineMax();

		// Hide previous panel if open
		if(this._subPanelActive)
		{
			this._subPanelTimeline.to(this._buyButton.scale,         .15, {x:0, y:0, ease:Sine.easeIn});
			this._subPanelTimeline.to(this._buyDisabledButton.scale, .15, {x:0, y:0, ease:Sine.easeIn});
			this._subPanelTimeline.to(this._upgrade_info,            .30, {x:this._upgrade_info.xStart, alpha:0, ease:Sine.easeInOut},0.05);
		}

		// Show the new one
		this._subPanelActive = true;
		var cost = this._powerupData[this._subPanelPower].cost[Common.savedData.charactersPower[this._data.id][this._subPanelPower]];

		this._subPanelTimeline.to(this._upgrade_info, .40, {x:this._upgrade_info.xEnd, alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function()
		{
			this._buyIcon.texture = this._assetManager.getTexture(this._powerupData[this._subPanelPower].texture);

			if(!webfont)
			{
				this._buyDescription.x += this._buyDescription.textWidth/2;
				this._buyDescription.y += this._buyDescription.textHeight/2;
				this._buyDescription.text = this._powerupData[this._powerupKeys[this._subPanelPower]].description[Common.COUNTRY_CODE];
				this._buyDescription.validate();
				this._buyDescription.x -= this._buyDescription.textWidth/2;
				this._buyDescription.y -= this._buyDescription.textHeight/2;

				this._buyButton._price.x += this._buyButton._price.textWidth/2;
				this._buyButton._price.text = cost;
				this._buyButton._price.validate();
				this._buyButton._price.x -= this._buyButton._price.textWidth/2;

				this._buyDisabledButton._price.x += this._buyDisabledButton._price.textWidth/2;
				this._buyDisabledButton._price.text = cost;
				this._buyDisabledButton._price.validate();
				this._buyDisabledButton._price.x -= this._buyDisabledButton._price.textWidth/2;

				this._buyDisabledButton._price.x += this._buyButton._price.textWidth/2;
				this._buyDisabledButton._price.text = cost;
				this._buyDisabledButton._price.validate();
				this._buyDisabledButton._price.x -= this._buyButton._price.textWidth/2;
			}
			else
			{
				this._buyDescription.text = this._powerupData[this._powerupKeys[this._subPanelPower]].description[Common.COUNTRY_CODE];
				this._buyButton._price.text = cost;
				this._buyDisabledButton._price.text = cost;
			}
		}});

		if(Common.savedData.coins >= cost)
		{
			this._subPanelTimeline.to(this._buyButton.scale, .25, {x:1, y:1, ease:Back.easeOut});
			this._subPanelTimeline.to(this._buyButton.scale, 1, {x:0.93, y:0.93, ease:Sine.easeInOut, yoyo:true, repeat:-1});
		}
		else
		{
			this._subPanelTimeline.to(this._buyDisabledButton.scale, .25, {x:1, y:1, ease:Back.easeOut});
		}

	Common.animator.add(this._subPanelTimeline);

	SoundSFX.play("sfx_btn_press_00");
}


/**
 * Function called when the close button of the subpanel is clicked
 */
CharacterSelectPanel.prototype.onUpgradeCloseClicked = function()
{
	this.closeSubPanel();

	SoundSFX.play("sfx_btn_press_00");
}

/**
 * Closes the subpanel, if it was active
 */
CharacterSelectPanel.prototype.closeSubPanel = function(onCompleteScope, onComplete)
{
	if(!this._subPanelActive) return;

	if(!!this._subPanelTimeline)
		this._subPanelTimeline.kill();

	this._subPanelTimeline = new TimelineMax({onCompleteScope:onCompleteScope, onComplete:onComplete});
	this._subPanelTimeline.to(this._buyButton.scale,         .15, {x:0, y:0, ease:Sine.easeIn});
	this._subPanelTimeline.to(this._buyDisabledButton.scale, .15, {x:0, y:0, ease:Sine.easeIn});
	this._subPanelTimeline.to(this._upgrade_info,            .30, {x:this._upgrade_info.xStart, alpha:0, ease:Sine.easeInOut},0.05);
	Common.animator.add(this._subPanelTimeline);

	this._subPanelActive = false;

	SoundSFX.play("sfx_btn_press_00");
}


/**
 * Show the confirmation screen when the buy panel is pressed
 */
CharacterSelectPanel.prototype.onBuyClick = function()
{
	var cost = this._powerupData[this._subPanelPower].cost[Common.savedData.charactersPower[this._data.id][this._subPanelPower]];
	this._screen.signals.buyPressed.dispatch(this, cost);

	SoundSFX.play("sfx_btn_press_00");
}

/**
 * Show that the coins are insufficient
 */
CharacterSelectPanel.prototype.onBuyDisabledClick = function()
{
	// Make the snowflake in the coins container shake
	var tl = new TimelineMax();
	tl.to(this.parent.parent._coinsContainer._snowflake, .1, {rotation:PIXI.DEG_TO_RAD * 18, ease:Sine.easeOut},0);
	tl.to(this.parent.parent._coinsContainer._snowflake, .1, {rotation:PIXI.DEG_TO_RAD * -12, ease:Sine.easeOut});
	tl.to(this.parent.parent._coinsContainer._snowflake, .1, {rotation:PIXI.DEG_TO_RAD * 6, ease:Sine.easeOut});
	tl.to(this.parent.parent._coinsContainer._snowflake, .1, {rotation:PIXI.DEG_TO_RAD * 0, ease:Sine.easeOut});
	Common.animator.add(tl);

	SoundSFX.play("sfx_elsa_ice_magic_platform_fail_00");
}

/**
 * Buy the powerup and close the subpanel when the purchase is confirmed
 */
CharacterSelectPanel.prototype.buy = function()
{
	var cost = this._powerupData[this._subPanelPower].cost[Common.savedData.charactersPower[this._data.id][this._subPanelPower]];
	Common.savedData.coins -= cost;
	Common.savedData.charactersPower[this._data.id][this._subPanelPower]++;
	Common.savedData.save();

	// Update the status of the plus buttons of ALL the panels
	for(var c = 0; c < this.parent.parent._characterPanels.length; c++)
	{
		var panel = this.parent.parent._characterPanels[c];
		
		for(var i = 0; i < Common.savedData.charactersPower[panel._data.id].length; i++)
		{
			if(Common.savedData.charactersPower[panel._data.id][i] >= 3)
			{
				panel._gemsButton[i].visible = false;
				
				// Stop animating the plus
				if(!!panel._gemsButton[i].timeline)
					panel._gemsButton[i].timeline.kill();
			}
			else
			{
				if(panel == this && i == panel._subPanelPower)
				{
					panel._gemsButton[i].x += 84;
				}
				
				// Stop animating the plus if insufficient coins
				var cost = panel._powerupData[i].cost[Common.savedData.charactersPower[panel._data.id][i]];
				if(cost > Common.savedData.coins)
				{
					// Stop animating the plus
					if(!!panel._gemsButton[i].timeline)
						panel._gemsButton[i].timeline.kill();
					
					var colorMatrix = new PIXI.filters.ColorMatrixFilter();
					colorMatrix.desaturate();
					panel._gemsButton[i].filters = [colorMatrix];				
				}
			}	
		}
	}
	
	
	// Show the gem
	this._gems[this._subPanelPower][Common.savedData.charactersPower[this._data.id][this._subPanelPower]-1].visible = true;

	// Update coin value
	this.parent.parent._coinsContainer._text.text = Common.savedData.coins;

	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_action",
		game_tier1 : "shop",
		game_tier2 : "character_screen",
		game_meta  : "{" +
						 "CharacterName="  + Common.savedData.character + "," +
						 "tumble="          + Common.savedData.charactersPower[Common.savedData.character][0] + "," +
						 "magnet="          + Common.savedData.charactersPower[Common.savedData.character][1] + "," +
						 "magic="           + Common.savedData.charactersPower[Common.savedData.character][2] + "," +
						 "remaining_coins=" + Common.savedData.coins +
					 "}"
	});

	// Close the subpanel
	this.closeSubPanel
	(
		this,
		function()
		{
			this.upgradePS.emit = true;
			SoundSFX.play("sfx_ui_buy_upgrade_02");
		}
	);
}
},{"../Common":2,"../general/SoundSFX":44}],41:[function(require,module,exports){

var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Emitter() {
}
module.exports = Emitter;

//===================================================
// PUBLIC METHODS
//===================================================


/**
 * @param {!PIXI.Container} parent
 * @param {!Array<String>} textures
 * @param {!String} json
 * @param {Number=} x
 * @param {Number=} y
 * @param {Number=} removeTime
 * @param {Boolean=} autoEmit
 * @returns {cloudkid.Emitter} emitter
 */
Emitter.add = function(parent, textures, json, x, y, removeTime, autoEmit, destroyTime)
{
    if(autoEmit == undefined) autoEmit = true;
    if(destroyTime == undefined) destroyTime = 1;

    x = x || 0;
    y = y || 0;

    var assetManager = p3.AssetManager.instance;

    for(var i = 0; i < textures.length; i++)
    {
        textures[i] = assetManager.getTexture(textures[i]);
    }    

    var emitter = new cloudkid.Emitter(
        parent,
        textures,
        assetManager.getJSON(json)
    );
    if(autoEmit)
        emitter.emit = true;
    else
        emitter.emit = false;

    emitter.updateOwnerPos(x, y);

    Common.animator.add(emitter);

    if(removeTime != null)
    {    
        Common.animator.setTimeout(function(){
            Emitter.destroy(emitter, destroyTime);
        }, removeTime, this);
    }

    return emitter;
};

Emitter.destroy = function(emitter, destroyDelay)
{
    if(emitter != null)
    {    
        destroyDelay = destroyDelay || 0;

        emitter.emit = false;
        Common.animator.setTimeout(function(){
            Common.animator.remove(emitter);
            emitter.destroy();
        }, destroyDelay, this);
    }
}




//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================
},{"../Common":2}],42:[function(require,module,exports){
var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelSelectButton(level, active)
{
	this._assetManager = p3.AssetManager.instance;

	this._id = level;

	this.signals          = {};
	this.signals.clicked  = new signals.Signal();
	this.signals.down     = new signals.Signal();
	this.signals.up       = new signals.Signal();

	this.active           = active;

	PIXI.Container.call(this);

    this.init();
}
module.exports = LevelSelectButton;
LevelSelectButton.prototype = Object.create(PIXI.Container.prototype);
LevelSelectButton.prototype.constructor = LevelSelectButton;


//===================================================
// PUBLIC METHODS
//===================================================

LevelSelectButton.prototype.init = function()
{
	if(this.active)
	{
		// Bg
		var crystals_bg = new PIXI.Sprite(this._assetManager.getTexture("ui_map_crystals_bg"));
		crystals_bg.anchor = new PIXI.Point(0.5, 0);
		crystals_bg.y = 38;
		this.addChild(crystals_bg);

		// Crystals
		var characters = ["anna", "kristoff", "olaf", "elsa"]
		var textures   = ["ui_map_crystals_pink", "ui_map_crystals_green", "ui_map_crystals_cyan", "ui_map_crystals_purple"]

		for(var i = 0; i < characters.length; i++)
		{
			if(Common.savedData.getLevelCharacterCrystalCount(this._id, characters[i]) < 3) continue;

			var crystal = new PIXI.Sprite(this._assetManager.getTexture(textures[i]));
			crystal.anchor = new PIXI.Point(0.5, 0);
			crystals_bg.addChild(crystal);
		}

		// Button
		this._button = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_map_out"),
			this._assetManager.getTexture("ui_btn_map_over"),
			this._assetManager.getTexture("ui_btn_map_down"),
			this._assetManager.getTexture("ui_icon_map_play")
		);
		this._button.signals.down.add(this.onClick, this);
		this._button.overSoundName = "sfx_btn_rollover_00";
		this.addChild(this._button);

		// Level number
		// var text = new PIXI.Text(this._id+1, {font:"24px Arial", fill:0x000000, align:'center'});
		// text.anchor = new PIXI.Point(0.5, 0.5);
		var text = new PIXI.extras.BitmapText("" + (this._id+1), {font: "28px Superclarendon Title Purple", align: "center"});
		text.x = - text.textWidth/2 - 2;
		text.y = - 96;
		this.addChild(text);

		if(Common.savedData.endGameMessage.crystals.shown)
		{
			var trollsCounter = new PIXI.Sprite(this._assetManager.getTexture("ui_map_trolls_bg"));
			trollsCounter.anchor = new PIXI.Point(0.5, 0.5);
			trollsCounter.y = 57;
			this.addChild(trollsCounter);

			var trollsText = new PIXI.extras.BitmapText(Common.savedData.getLevelCollectedTrollCount(this._id) + "/3", {font: "20px Superclarendon Level", align: "left"});
			trollsText.x = 0;
			trollsText.y = -19;
			trollsCounter.addChild(trollsText);
		}
	}
	else
	{
		this._button = new p3.MuteButton
		(
			this._assetManager.getTexture("ui_btn_map_out_inactive"),
			this._assetManager.getTexture("ui_btn_map_out_inactive"),
			this._assetManager.getTexture("ui_btn_map_out_inactive"),
			this._assetManager.getTexture("ui_icon_map_lock")
		);
		this._button.interactive = false;
		this.addChild(this._button);
	}
};

LevelSelectButton.prototype.disable = function()
{
	this._button.alpha = 0.5;
	this.disabled = true;
};

//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

LevelSelectButton.prototype.onClick = function()
{
	this.signals.clicked.dispatch(this);
};


//===================================================
// GETTERS/SETTERS
//===================================================



//===================================================
},{"../Common":2}],43:[function(require,module,exports){
var Common          = require("../Common");
var SoundSFX        = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function NextButton(buttonString, delay)
{
	/**
     * @type {p3.AssetManager}
     */
    this._assetManager = p3.AssetManager.instance;

	/**
     * @type {signals.Signal}
     */
    this.signals = {};
	this.signals.clicked = new signals.Signal();
	this.signals.clickFinish = new signals.Signal();

	/**
     * @type {PIXI.Sprite}
     */
    this._banner = null;

    /**
     * @type {p3.BitmapText}
     */
    this._button = null;

    /**
     * @type {String}
     */
    this._buttonString = buttonString || "next";

    /**
     * @type {Number}
     */
    this._delay = delay || 0;

	PIXI.Container.call(this);
}
module.exports = NextButton;
NextButton.prototype = Object.create(PIXI.Container.prototype);
NextButton.prototype.constructor = NextButton;


//===================================================
// PUBLIC METHODS
//===================================================


/**
 */
NextButton.prototype.init = function()
{
	Common.animator.setTimeout(function(){

		this._banner = new PIXI.Sprite(this._assetManager.getTexture("ui"));
		this._banner.anchor = new PIXI.Point(0.5, 0.5);
		// this._banner.scale.x = 0;
		this.addChild(this._banner);

		this._button = new p3.Button(
			this._assetManager.getTexture("but_big_def"),
			this._assetManager.getTexture("but_big_over"),
			this._assetManager.getTexture("but_big_press"),
			this._assetManager.getTexture(this._buttonString));
		
		// this._button.scale = new PIXI.Point(0, 0);
        this._button.signals.down.addOnce(this.onButtonClick, this);
		this._button.signals.over.add(this.onButtonOver, this);
		this._button.animate = false;
		this.addChild(this._button);

		// var tl = new TimelineMax();
		// tl.to(this._banner.scale, 1, {x:1, ease:Back.easeOut});
		// tl.to(this._button.scale, 1.3, {x:1, ease:Elastic.easeOut}, 0);
		// tl.to(this._button.scale, 1.3, {y:1, ease:Elastic.easeOut}, 0.1);
		// Common.animator.add(tl);

	}, this._delay, this);
};



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

/**
 */
NextButton.prototype.onButtonClick = function()
{
/*     TweenMax.killTweensOf(this._button.scale);
    Common.animator.add(TweenMax.to(this._button.scale, .2, {x:0.6, y:0.6, ease:Sine.easeInOut, onComplete:function(){
        Common.animator.add(TweenMax.to(this._button.scale, 1, {x:1, y:1, ease:Elastic.easeOut, onComplete:function(){
        	this.signals.clickFinish.dispatch();
        }, onCompleteScope:this}));
    }, onCompleteScope:this})); */

    // SoundSFX.play("sfx_button_play");
	this.signals.clicked.dispatch();
}

NextButton.prototype.onButtonOver = function()
{
    // SoundSFX.play("sfx_btn_rollover_00");
}


//===================================================
// GETTERS/SETTERS
//===================================================


//===================================================




},{"../Common":2,"../general/SoundSFX":44}],44:[function(require,module,exports){
/**
 *  SoundSFX
 *
 *  Created by Legman on 11/06/2015.
 *
 */

var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function SoundSFX() {
}
module.exports = SoundSFX;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 * @param {!p3.Button} button
 * @param {Boolean=} enableClickSound
 * @param {Boolean=} enableOverSound
 */
SoundSFX.button = function(button, enableClickSound, enableOverSound) {
    enableClickSound = enableClickSound == undefined ? true : enableClickSound;
    enableOverSound = enableOverSound == undefined ? true : enableOverSound;

    if(enableClickSound)
    {    
        button.signals.click.add(function(button) {
            p3.AudioManager.instance.playSound("sfx_btn_press_reverb");
        }, this);
    }

    if(enableOverSound)
    {    
        button.signals.over.add(function(button) {
            p3.AudioManager.instance.playSound("sfx_btn_rollover_reverb");
        }, this);
    }
};

/**
 * @param {!String} sound
 * @param {Object=} params
 * @param {Number=} delay
 */
SoundSFX.play = function(sound, params, delay) {

    if(delay == null)
    {    
        return p3.AudioManager.instance.playSound(sound, params);
    }
    else
    {    
        setTimeout(function(){
            p3.AudioManager.instance.playSound(sound, params);
        }, delay);
    }
};

SoundSFX.playMusic = function(sound, params, delay) {

    if(delay == null)
    {    
        p3.AudioManager.instance.playMusic(sound, params);
    }
    else
    {    
        setTimeout(function(){
            p3.AudioManager.instance.playMusic(sound, params);
        }, delay);
    }
};

/**
 * @param {!String} sound
 */
SoundSFX.stop = function(sound) {
    var currentSounds = p3.AudioManager.instance.soundsSFX;
    for(var i = 0; i < currentSounds.length; i++)
    {
        if(currentSounds[i].name == sound)
        {
           p3.AudioManager.instance.stopSound(sound);
        }   
    }
};

/**
 * @param {!Array <String>} sounds
 */
SoundSFX.playRandomFrom = function(sounds) {
	p3.AudioManager.instance.playSound(sounds[Math.floor(Math.random()*sounds.length)]);
};




//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2}],45:[function(require,module,exports){
var Common          = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function WireframeButton(text)
{
	this._text				= text;

	this._button			= null;

	this.signals 			= {};
	this.signals.clicked 	= new signals.Signal();
	this.signals.down 		= new signals.Signal();
	this.signals.up	 		= new signals.Signal();

	this.disabled			= false;

	this.texture 			= null;

	PIXI.Container.call(this);

    this.init();
}
module.exports = WireframeButton;
WireframeButton.prototype = Object.create(PIXI.Container.prototype);
WireframeButton.prototype.constructor = WireframeButton;


//===================================================
// PUBLIC METHODS
//===================================================

WireframeButton.prototype.init = function()
{
	var container = new PIXI.Container();
	var graphic = new PIXI.Graphics();
	graphic.beginFill(0xFFFFFF);
	graphic.drawRect(0, 0, 200, 100);
	container.addChild(graphic);
	var text = new PIXI.Text(this._text, {font:'30px Tahoma', fill:0x000000, align:'center'});
	text.x = 100 - (text.width/2);
	text.y = 30;
	container.addChild(text);
	var texture = container.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);

	this.texture = texture;

	this._button = new p3.Button(texture, texture, texture);
	this._button.animate = false;
	this._button.signals.click.add(this.buttonClicked, this);
	this._button.signals.down.add(this.buttonDown, this);
	this._button.signals.up.add(this.buttonUp, this);
	this.addChild(this._button);
};

WireframeButton.prototype.disable = function()
{
	this._button.alpha = 0.5;
	this.disabled = true;
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

WireframeButton.prototype.buttonClicked = function()
{
	this.signals.clicked.dispatch(this);
};

WireframeButton.prototype.buttonDown = function()
{
	this.signals.down.dispatch(this);
	console.log('down');
};

WireframeButton.prototype.buttonUp = function()
{
	this.signals.up.dispatch(this);
	console.log('up');
};

//===================================================
// GETTERS/SETTERS
//===================================================



//===================================================








},{"../Common":2}],46:[function(require,module,exports){
/**
 * @param {!PIXI.Texture} texture
 * @param {Number=} scale
 * @param {PIXI.Point=} ratio
 * @constructor
 */
function CutoutShader(texture, scale, ratio) {
    scale   = scale || 0.5;
    ratio   = ratio || new PIXI.Point(1.0, 1.0);

    PIXI.AbstractFilter.call(
        this,
        null,
        "precision highp float;" +

        "varying vec2 vTextureCoord;" +
        "varying vec4 vColor;" +

        "uniform sampler2D uCutoutMap;" +
        "uniform float uScale;" +
        "uniform vec2 uRatio;" +

        "void main(void) {" +
            "vec2 textureCoord  = (((vTextureCoord - vec2(0.5, 0.5)) * uRatio) * uScale) + vec2(0.5, 0.5);" +
            "vec4 mask          = texture2D(uCutoutMap, textureCoord);" +
            "float alpha        = 1.0 - mask.a;" +
            "gl_FragColor       = vec4(vColor.r * alpha, vColor.g * alpha, vColor.b * alpha, vColor.a * alpha);" +
        "}",
        {
            uCutoutMap:     {type: "sampler2D",     value: texture},
            uScale:         {type: "f",             value: 1.0 / Math.max(0.001, scale)},
            uRatio:         {type: "v2",            value: {x: ratio.x, y: ratio.y}}
        }
    );

    texture.baseTexture.isPowerOfTwo = false;
}
module.exports                          = CutoutShader;
CutoutShader.prototype                  = Object.create(PIXI.AbstractFilter.prototype);
CutoutShader.prototype.constructor      = CutoutShader;

Object.defineProperty(CutoutShader.prototype, "scale", {
    /**
     * @returns {Number}
     */
    get: function() {
        return 1.0 / this.uniforms.uScale.value;
    },
    /**
     * @param {!Number} value
     */
    set: function(value) {
        this.uniforms.uScale.value = 1.0 / Math.max(0.001, value);
    }
});

Object.defineProperty(CutoutShader.prototype, "ratio", {
    /**
     * @returns {PIXI.Point}
     */
    get: function() {
        return new PIXI.Point(this.uniforms.uRatio.value.x, this.uniforms.uRatio.value.y);
    },
    /**
     * @param {!PIXI.Point} value
     */
    set: function(value) {
        this.uniforms.uRatio.value.x = value.x;
        this.uniforms.uRatio.value.y = value.y;
    }
});
},{}],47:[function(require,module,exports){
var CutoutShader    = require("./CutoutShader");
var FadeTransition  = require("./FadeTransition");
var Transition      = require("./Transition");

/**
 * @param {!PIXI.Texture} texture
 * @param {!Number} color
 * @param {!Number} duration
 * @constructor
 */
function CutoutTransition(texture, color, duration) {
    /**
     * @type {Number}
     */
    this.startScale = 3;

    /**
     * @type {Number}
     */
    this.endScale = 0.0;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._texture = texture;

    /**
     * @type {Number}
     * @private
     */
    this._color = 0xDDF7FD;

    /**
     * @type {Number}
     * @private
     */
    this._duration = duration || 1.2;

    /**
     * @type {PIXI.Sprite}
     * @private
     */
    this._cutout = null;

    Transition.call(this);

    this.requiresWebGL = true;
}
module.exports                              = CutoutTransition;
CutoutTransition.prototype                  = Object.create(Transition.prototype);
CutoutTransition.prototype.constructor      = CutoutTransition;

CutoutTransition.prototype.init = function() {
    var quad = new PIXI.Graphics();
    quad.drawRect(0.0, 0.0, 1.0, 1.0);

    var ratio           = new PIXI.Point(0.0, 0.0);
    var canvasRatio     = p3.View.width / p3.View.height;
    var textureRatio    = this._texture.width / this._texture.height;

    if (canvasRatio / textureRatio > 1.0) {
        ratio.x = 1.0;
        ratio.y = 1.0 / (canvasRatio / textureRatio);
    } else {
        ratio.x = 1.0 / (canvasRatio / textureRatio);
        ratio.y = 1.0;
    }

    this._cutout        = new PIXI.Sprite(quad.generateTexture());
    this._cutout.scale  = new PIXI.Point(p3.View.width, p3.View.height);
    this._cutout.tint   = this._color;
    this._cutout.shader = new CutoutShader(this._texture, 0.0, ratio);
	this._cutout.interactive = true; // Avoid triggering other transitions if one is already active
    this.addChild(this._cutout);
};

CutoutTransition.prototype.in = function() {
    this._cutout.shader.scale = this.startScale;
    TweenMax.to(this._cutout.shader, this._duration * 0.5, {
        scale: this.endScale,
        ease: Power2.easeOut,
        onComplete: function() {
            Transition.prototype.in.call(this, this);
        },
        onCompleteScope: this
    });
};

CutoutTransition.prototype.out = function() {
    this._cutout.shader.scale = this.endScale;
    TweenMax.to(this._cutout.shader, this._duration * 0.5, {
        scale: this.startScale,
        ease: Power2.easeIn,
        onComplete: function() {
            Transition.prototype.out.call(this, this);
        },
        onCompleteScope: this
    });
};

CutoutTransition.prototype.resize = function() {
    var ratio           = new PIXI.Point(0.0, 0.0);
    var canvasRatio     = p3.View.width / p3.View.height;
    var textureRatio    = this._texture.width / this._texture.height;

    if (canvasRatio / textureRatio > 1.0) {
        ratio.x = 1.0;
        ratio.y = 1.0 / (canvasRatio / textureRatio);
    } else {
        ratio.x = 1.0 / (canvasRatio / textureRatio);
        ratio.y = 1.0;
    }

    this._cutout.scale          = new PIXI.Point(p3.View.width, p3.View.height);
    this._cutout.shader.ratio   = ratio;
};

/**
 * @returns {Transition}
 */
CutoutTransition.prototype.fallback = function() {
    return new FadeTransition(this._color);
};
},{"./CutoutShader":46,"./FadeTransition":48,"./Transition":52}],48:[function(require,module,exports){
var Common          = require("../Common");
var Transition      = require("./Transition");

/**
 * @param {!Number} color
 * @param {!Number} duration
 * @constructor
 */
function FadeTransition(color, duration) {
    /**
     * @type {Number}
     * @private
     */
    this._color = color || 0x0;

    /**
     * @type {Number}
     * @private
     */
    this._duration = duration || 0.8;

    /**
     * @type {PIXI.Graphics}
     * @private
     */
    this._quad = null;

    Transition.call(this);
}
module.exports                              = FadeTransition;
FadeTransition.prototype                    = Object.create(Transition.prototype);
FadeTransition.prototype.constructor        = FadeTransition;

FadeTransition.prototype.init = function() {
    this._quad          = new PIXI.Graphics();
    this._quad.visible  = false;
    this._quad.beginFill(this._color);
    this._quad.drawRect(0.0, 0.0, p3.View.width, p3.View.height);
    this._quad.endFill();
    this.addChild(this._quad);
};

FadeTransition.prototype.in = function() {
    this._quad.alpha    = 0.0;
    this._quad.visible  = true;
    TweenMax.to(this._quad, this._duration * 0.5, {
        alpha: 1.0,
        ease: Power2.easeInOut,
        onComplete: function() {
            Transition.prototype.in.call(this, this);
        },
        onCompleteScope: this
    });
};

FadeTransition.prototype.out = function() {
    TweenMax.to(this._quad, this._duration * 0.5, {
        alpha: 0.0,
        ease: Power2.easeInOut,
        onComplete: function() {
            this._quad.visible = false;
            Transition.prototype.out.call(this, this);
        },
        onCompleteScope: this
    });
};

FadeTransition.prototype.resize = function() {
    this._quad.clear();
    this._quad.beginFill(this._color);
    this._quad.drawRect(0.0, 0.0, p3.View.width, p3.View.height);
    this._quad.endFill();
};
},{"../Common":2,"./Transition":52}],49:[function(require,module,exports){
/**
 *  MuteButton
 *
 *  Created by Legman on 16/09/2015.
 *
 */

/**
 * @param {!PIXI.Texture} onNormalTexture
 * @param {!PIXI.Texture} offNormalTexture
 * @param {PIXI.Texture=} onOverTexture
 * @param {PIXI.Texture=} offOverTexture
 * @param {PIXI.Texture=} onDownTexture
 * @param {PIXI.Texture=} offDownTexture
 * @param {PIXI.Texture=} onDisabledTexture
 * @param {PIXI.Texture=} offDisabledTexture
 * @constructor
 */
function MuteButton(
    onNormalTexture,
    offNormalTexture,
    onOverTexture,
    offOverTexture,
    onDownTexture,
    offDownTexture
) {
    var audio = p3.AudioManager.instance;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._onNormalTexture = onNormalTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._offNormalTexture = offNormalTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._onOverTexture = onOverTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._offOverTexture = offOverTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._onDownTexture = onDownTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._offDownTexture = offDownTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._normalTexture = audio.isMute ? offNormalTexture : onNormalTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._overTexture = audio.isMute ? offOverTexture : onOverTexture;

    /**
     * @type {PIXI.Texture}
     * @private
     */
    this._downTexture = audio.isMute ? offOverTexture : onDownTexture;


    p3.Button.call(
        this,
        this._normalTexture,
        this._overTexture,
        this._downTexture
    );
}
module.exports                      = MuteButton;
MuteButton.prototype                = Object.create(p3.Button.prototype);
MuteButton.prototype.constructor    = MuteButton;

/**
 * @param {!Event} event
 */
MuteButton.prototype.onMouseClick = function(event) {
    var audio = p3.AudioManager.instance;
    audio.mute(!audio.isMute);

    this._normalTexture     = audio.isMute ? this._offNormalTexture    : this._onNormalTexture;
    this._overTexture       = audio.isMute ? this._offOverTexture      : this._onOverTexture;
    this._downTexture       = audio.isMute ? this._offDownTexture      : this._onDownTexture;
    this._disabledTexture   = audio.isMute ? this._offDisabledTexture  : this._onDisabledTexture;

    p3.Button.prototype.onMouseClick.call(this, event);
};

},{}],50:[function(require,module,exports){
/**
 *  Scene
 *
 *  Created by Legman on 4/09/2015.
 *
 */

/**
 * @constructor
 */
function Scene() {
    this.signals            = {};
    this.signals.next       = new signals.Signal();
    this.signals.previous   = new signals.Signal();
    this.signals.home       = new signals.Signal();
    this.signals.pause      = new signals.Signal();

    PIXI.Container.call(this);
}
module.exports                  = Scene;
Scene.prototype                 = Object.create(PIXI.Container.prototype);
Scene.prototype.constructor     = Scene;

/**
 * This method is called when a scene is initialized.
 */
Scene.prototype.init = function() {
    // override
};

/**
 * This method is called when a scene is destroyed.
 */
Scene.prototype.dispose = function() {
    this.signals.next.dispose();
    this.signals.previous.dispose();
    this.signals.home.dispose();
    this.signals.pause.dispose();

    this.removeChildren();
};

/**
 * This method is called when the device dimensions are changed.
 */
Scene.prototype.resize = function() {
    // override
};

/**
 * This method is called when the scene is 'top' of the stack.
 */
Scene.prototype.update = function() {
    // override
};

/**
 * This method is called when the scene is shown for the first time.
 */
Scene.prototype.appear = function() {
    this.animateIn();
};

/**
 * This method is called when the scene is shown - regardless of actual visibility.
 */
Scene.prototype.show = function() {
    this.animateIn();
};

/**
 * This method is called when the scene is hidden - regardless of actual visibility.
 */
Scene.prototype.hide = function() {
    // override
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
Scene.prototype.animateIn = function(callback, scope) {
    scope = scope || window;
    if (callback) {
        callback.call(scope);
    }
};

/**
 * @param {!Function} callback
 * @param {*=} scope
 */
Scene.prototype.animateOut = function(callback, scope) {
    scope = scope || window;
    if (callback) {
        callback.call(scope);
    }
};
},{}],51:[function(require,module,exports){
/**
 *  SceneManager
 *
 *  Created by Legman on 4/09/2015.
 *
 */

var Scene       = require("./Scene");
var Transition  = require("./Transition");

/**
 * @constructor
 */
function SceneManager() {
    /**
     * @type {PIXI.DisplayObject}
     * @private
     */
    this._stage = null;

    /**
     * @type {PIXI.CanvasRenderer | PIXI.WebGLRenderer}
     * @private
     */
    this._renderer = null;

    /**
     * @type {Array.<Scene>}
     * @private
     */
    this._stack = [];

    /**
     * @type {Transition}
     * @private
     */
    this._transition = null;
}
module.exports = SceneManager;

/**
 * @param {!PIXI.DisplayObject} stage
 * @param {!PIXI.CanvasRenderer | !PIXI.WebGLRenderer} renderer
 */
SceneManager.prototype.init = function(stage, renderer) {
    this._stage         = stage;
    this._renderer      = renderer;
};

/**
 */
SceneManager.prototype.update = function() {
    if (this._stack.length) {
        this.top.update();
    }
};

/**
 * @param {!Scene} scene
 * @param {Transition=} transition
 */
SceneManager.prototype.add = function(scene, transition) {
    if (this.transitionInProgress) return;

    this._transition = transition || new Transition();
    if (this._transition.requiresWebGL && !(this._renderer instanceof PIXI.WebGLRenderer)) {
        this._transition            = transition.fallback();
        this._transition.push       = transition.push;
        this._transition.replace    = transition.replace;
        this._transition.wait       = transition.wait;
    }
    this._transition.init();
    this._stage.addChild(this._transition);

    this._transition.signals.in.addOnce(function(transition) {
        p3.Timestep.queueCall(swap, [scene], this);
    }, this);
    this._transition.signals.out.addOnce(function(transition) {
        this._transition = null;

        transition.parent.removeChild(transition);
        transition.dispose();

        if (transition.wait) {
            p3.Timestep.queueCall(scene.appear, null, scene);
        }
    }, this);
    this._transition.in();

    function swap(scene) {
        if (this.top) {
            this.top.hide();
            if (!this._transition.push) {
                while (this.top) {
                    this.top.parent.removeChild(this.top);
                    this.top.dispose();
                    this._stack.pop();
                }
            } else if (this._transition.replace) {
                var temp;
                for (var i = 0; i < this._stack.length; ++ i) {
                    temp = this._stack[i];
                    if (temp.parent) {
                        temp.parent.removeChild(temp);
                    }
                }
            }
        }

        scene.init();
        scene.resize();
        if (!scene.parent) {
            this.stage.addChildAt(scene, this._transition.parent.getChildIndex(this._transition));
        }
        this._stack.push(scene);

        if (!this._transition.wait) {
            p3.Timestep.queueCall(scene.appear, null, scene);
        }
        this._transition.out();

        console.log(this._stack);
    }
};

/**
 * @param {Transition=} transition
 * @param {Number=} count
 */
SceneManager.prototype.remove = function(transition, count) {
    if (this.transitionInProgress) return;

    this._transition    = transition || new Transition();
    count               = Math.max(1, count) || 1;
    if (this._transition.requiresWebGL && !(this._renderer instanceof PIXI.WebGLRenderer)) {
        this._transition            = transition.fallback();
        this._transition.push       = transition.push;
        this._transition.replace    = transition.replace;
        this._transition.wait       = transition.wait;
    }
    this._transition.init();
    this._stage.addChild(this._transition);

    this._transition.signals.in.addOnce(function(transition) {
        p3.Timestep.queueCall(swap, [count], this);
    }, this);
    this._transition.signals.out.addOnce(function(transition) {
        this._transition = null;

        transition.parent.removeChild(transition);
        transition.dispose();

        if (transition.wait) {
            this.top.show();
        }
    }, this);
    this._transition.in();

    function swap(count) {
        for (var i = 0; i < count; ++ i) {
            this.top.hide();
            this.top.parent.removeChild(this.top);
            this.top.dispose();
            this._stack.pop();
        }

        var scene = this.top;
        scene.resize();
        if (!scene.parent) {
            this.stage.addChildAt(scene, this._transition.parent.getChildIndex(this._transition));
        }

        if (!this._transition.wait) {
            scene.show();
        }
        this._transition.out();

        console.log(this._stack);
    }
};

/**
 */
SceneManager.prototype.clear = function() {
};

/**
 */
SceneManager.prototype.resize = function() {
    var scene;
    for (var i = 0; i < this._stack.length; ++ i) {
        scene = this._stack[i];
        scene.resize();
    }
    if (this._transition) {
        this._transition.resize();
    }
};

Object.defineProperty(SceneManager.prototype, "stage", {
    /**
     * @returns {PIXI.DisplayObject}
     */
    get: function() {
        return this._stage;
    }
});

Object.defineProperty(SceneManager.prototype, "top", {
    /**
     * @returns {Scene}
     */
    get: function() {
        return this._stack.length ? this._stack[this._stack.length - 1] : null;
    }
});

Object.defineProperty(SceneManager.prototype, "transitionInProgress", {
    /**
     * @returns {Boolean}
     */
    get: function() {
        return (this._transition != null ? true : false);
    }
});

},{"./Scene":50,"./Transition":52}],52:[function(require,module,exports){
/**
 *  Transition
 *
 *  Created by Legman on 4/09/2015.
 *
 */

/**
 * @constructor
 */
function Transition() {
    /**
     * @type {*}
     */
    this.signals        = {};
    this.signals.in     = new signals.Signal();
    this.signals.out    = new signals.Signal();

    /**
     * @type {Boolean}
     */
    this.push = false;

    /**
     * @type {Boolean}
     */
    this.replace = true;

    /**
     * @type {Boolean}
     */
    this.wait = true;

    /**
     * @type {Boolean}
     */
    this.requiresWebGL = false;

    PIXI.Container.call(this);
}
module.exports                      = Transition;
Transition.prototype                = Object.create(PIXI.Container.prototype);
Transition.prototype.constructor    = Transition;

Transition.prototype.init = function() {
    // override
};

Transition.prototype.dispose = function() {
    this.signals.in.dispose();
    this.signals.out.dispose();

    this.removeChildren();
};

Transition.prototype.in = function() {
    this.signals.in.dispatch(this);
};

Transition.prototype.out = function() {
    this.signals.out.dispatch(this);
};

/**
 * @returns {Transition}
 */
Transition.prototype.resize = function() {
    // override
};

Transition.prototype.fallback = function() {
    // override
};
},{}],53:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function CharacterUnlockedOverlay(character)
{
	this._character   = character;
    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = CharacterUnlockedOverlay;
CharacterUnlockedOverlay.prototype = Object.create(SimpleScreen.prototype);
CharacterUnlockedOverlay.prototype.constructor = CharacterUnlockedOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
CharacterUnlockedOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);


	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["UNLOCKED"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor.set(0.5);
			title.y = -6;
			this._title.addChild(title);
		}

    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.x = Common.STAGE_WIDTH/2;
	this._messageBox.y = Common.STAGE_HEIGHT/2 + 70;
    this.addChild(this._messageBox);

		// Character
		// this._char = new PIXI.Sprite(this._assetManager.getTexture("ui_char_" + this._character));
		// this._char.position.set(250,340);
		// this._char.anchor.set(0.5, 1);
		// this._char.scale.x = -1;
		// this._messageBox.addChild(this._char);
		
		this._char = new PIXI.spine.Spine(Common.characterAnimationData[this._character]);
		this._char.skeleton.setToSetupPose();
		this._char.skeleton.setSkin(null);
		this._char.skeleton.setSkinByName("default");
		this._char.x = 200;
		this._char.y = 340;
		this._char.autoUpdate = true;
		this._char.scale.set(0.5);
		this._char.state.setAnimationByName(0, "look_left", true, 0);
		this._messageBox.addChild(this._char);				

		// Text
		var data = this._assetManager.getJSON("config").characters[this._character];

		var deco = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_deco"));
		deco.anchor.set(0.5);
		deco.position.set(-160, -130);
		this._messageBox.addChild(deco);

		var lock = new PIXI.Sprite(this._assetManager.getTexture(this._character != "pabbie" ? "ui_icon_char_crystal_" + data.color : "ui_icon_results_trolls"));
		lock.anchor.set(0.5);
		lock.position = deco.position;
		this._messageBox.addChild(lock);

		// Name
		var copy = data.name[Common.COUNTRY_CODE];

		if(!webfont)
		{
			this._name = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			this._name.x = - this._name.textWidth/2 - 160;
			this._name.y = - this._name.textHeight/2 - 5;
			this._messageBox.addChild(this._name);
		}
		else
		{
			this._name = new PIXI.Text(data.name[Common.COUNTRY_CODE], {font:"36px Arial", fill:0x000000, align:'center'});
			this._name.position.set(-160,-10);
			this._name.anchor.set(0.5);
			this._messageBox.addChild(this._name);
		}

		// Desc
		var copy = data.description[Common.COUNTRY_CODE];

		if(!webfont)
		{
			this._description = new PIXI.extras.BitmapText(copy, {font: "24px Mikadan White", align: "center", tint: 0x6d38ab});
			this._description.x = - this._description.textWidth/2 - 160;
			this._description.y = + 40;
			this._messageBox.addChild(this._description);
		}
		else
		{
			this._description = new PIXI.Text(data.description[Common.COUNTRY_CODE].replace(/\n/gi, ""), {font:"24px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:300});
			this._description.position.set(-160,100);
			this._description.anchor.set(0.5);
			this._messageBox.addChild(this._description);
		}

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onCloseClick, this);
	this._messageBox.addChild(this._closeButton);
	
	// Intro
	SoundSFX.play("sfx_ui_character_unlock_01");

	this.snowPSContainer = new PIXI.Container();
	this.snowPSContainer.x = this._getBorderButtonPositionRight();
	this.snowPSContainer.y = Common.STAGE_HEIGHT/2;
	this.addChild(this.snowPSContainer);
	
	this.snowPS = new cloudkid.Emitter(this.snowPSContainer,
	[
		this._assetManager.getTexture("particle_snowflake_offset_00"),
		this._assetManager.getTexture("particle_snowflake_offset_01"),
		this._assetManager.getTexture("particle_snowflake_offset_02"),
		this._assetManager.getTexture("particle_snowflake_offset_03")
	], this._assetManager.getJSON("particle_character_unlock"));
	this.snowPS.emit = true;	
	
	
};

/**
 */
CharacterUnlockedOverlay.prototype.update = function()
{
	this.snowPS.update(p3.Timestep.deltaTime);
};

/**
 */
CharacterUnlockedOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
CharacterUnlockedOverlay.prototype.dispose = function()
{

}

CharacterUnlockedOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

CharacterUnlockedOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

CharacterUnlockedOverlay.prototype.onCloseClick = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],54:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function CodeOverlay()
{
	this._code        = "";
	this._maxLength   = 10;
    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = CodeOverlay;
CodeOverlay.prototype = Object.create(SimpleScreen.prototype);
CodeOverlay.prototype.constructor = CodeOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
CodeOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);


	// Code screen
	this._codeScreen = new PIXI.Container();
	this.addChild(this._codeScreen);

		// Title
		this._codeScreen._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
		this._codeScreen._title.anchor.set(0.5);
		this._codeScreen._title.x = Common.STAGE_WIDTH/2;
		this._codeScreen._title.y = 100;
		this._codeScreen.addChild(this._codeScreen._title);

			var copy = this._assetManager.getJSON("strings")["ENTER_CODE"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
				title.x = -title.textWidth/2;
				title.y = -title.textHeight/2 - 4;
				this._codeScreen._title.addChild(title);
			}
			else
			{
				var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
				title.anchor.set(0.5);
				title.y = -6;
				this._codeScreen._title.addChild(title);
			}

		// Codeboard
		this._codeScreen._codeBox = new PIXI.Sprite(this._assetManager.getTexture("ui_redeem_panel"));
		this._codeScreen._codeBox.anchor.set(0.5);
		this._codeScreen._codeBox.x = Common.STAGE_WIDTH/2;
		this._codeScreen._codeBox.y = Common.STAGE_HEIGHT/2 + 70;
		this._codeScreen.addChild(this._codeScreen._codeBox);

			// Close button
			this._codeScreen._closeButton = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_secnav_out"),
				this._assetManager.getTexture("ui_btn_secnav_over"),
				this._assetManager.getTexture("ui_btn_secnav_down"),
				this._assetManager.getTexture("ui_icon_secnav_cross")
			);
			this._codeScreen._closeButton.overSoundName = "sfx_btn_rollover_00";
			this._codeScreen._closeButton.x = (r2l ? -1 : 1) * 260;
			this._codeScreen._closeButton.y = -230;
			this._codeScreen._closeButton.signals.down.addOnce(this.onCloseClick, this);
			this._codeScreen._codeBox.addChild(this._codeScreen._closeButton);

			// Text
			this._codeScreen._codeBox.code = new PIXI.extras.BitmapText("", {font: "40px Mikadan Title", align: "center"});
			this._codeScreen._codeBox.code.x = - this._codeScreen._codeBox.code.textWidth/2;
			this._codeScreen._codeBox.code.y = - this._codeScreen._codeBox.code.textHeight/2 - 148;
			this._codeScreen._codeBox.addChild(this._codeScreen._codeBox.code);

			// Digits button
			this._codeScreen._digitButtons = [];

			for(var i = 0; i < 9; i++)
			{
				var x = i % 3;
				var y = Math.floor(i/3);

				var button = new p3.Button
				(
					this._assetManager.getTexture("ui_btn_input_normal"),
					this._assetManager.getTexture("ui_btn_input_over"),
					this._assetManager.getTexture("ui_btn_input_press"),
					this._assetManager.getTexture("ui_icon_input_00" + (i+1))
				);
				button.overSoundName = "sfx_btn_rollover_00";
				button.x = -148 + x * 94;
				button.y = -60  + y * 98;
				button.digit = i+1;
				button.signals.down.add(this.onDigitClick, this);
				this._codeScreen._codeBox.addChild(button);

				this._codeScreen._digitButtons.push(button);
			}

			// Cancel button
			this._deleteButton = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_input_delete_normal"),
				this._assetManager.getTexture("ui_btn_input_delete_over"),
				this._assetManager.getTexture("ui_btn_input_delete_press"),
				this._assetManager.getTexture("ui_icon_input_delete")
			);
			this._deleteButton.overSoundName = "sfx_btn_rollover_00";
			this._deleteButton.x = this._codeScreen._digitButtons[2].x + (this._codeScreen._digitButtons[2].x - this._codeScreen._digitButtons[1].x);
			this._deleteButton.y = this._codeScreen._digitButtons[2].y;
			this._deleteButton.signals.down.add(this.onDeleteClick, this);
			this._codeScreen._codeBox.addChild(this._deleteButton);

			// Enter button
			this._enterButton = new p3.Button
			(
				this._assetManager.getTexture("ui_btn_input_enter_normal"),
				this._assetManager.getTexture("ui_btn_input_enter_over"),
				this._assetManager.getTexture("ui_btn_input_enter_press"),
				this._assetManager.getTexture("ui_icon_input_enter")
			);
			this._enterButton.overSoundName = "sfx_btn_rollover_00";
			this._enterButton.x = this._codeScreen._digitButtons[5].x + (this._codeScreen._digitButtons[5].x - this._codeScreen._digitButtons[4].x);
			this._enterButton.y = this._codeScreen._digitButtons[5].y - this._codeScreen._digitButtons[5].height/2 + this._enterButton.height/2;
			this._enterButton.signals.down.add(this.onEnterClick, this);
			this._codeScreen._codeBox.addChild(this._enterButton);

	// Reward screen
	this._rewardScreen = new PIXI.Container();
	this.addChild(this._rewardScreen);

		// Title
		this._rewardScreen._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
		this._rewardScreen._title.anchor.set(0.5);
		this._rewardScreen._title.x = Common.STAGE_WIDTH/2;
		this._rewardScreen._title.y = 100;
		this._rewardScreen.addChild(this._rewardScreen._title);

			var copy = this._assetManager.getJSON("strings")["REWARD"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
				title.x = -title.textWidth/2;
				title.y = -title.textHeight/2 - 4;
				this._rewardScreen._title.addChild(title);
			}
			else
			{
				var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
				title.anchor.set(0.5);
				title.y = -6;
				this._rewardScreen._title.addChild(title);
			}

		this._rewardScreen._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
		this._rewardScreen._messageBox.anchor.set(0.5);
		this._rewardScreen._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2 + 70);
		this.addChild(this._rewardScreen._messageBox);

			var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_snowflakes_bg"));
			bg.anchor.set(0.5);
			bg.position.set(0, -40);
			this._rewardScreen._messageBox.addChild(bg);

			this._rewardScreen._messageBox.value = new PIXI.extras.BitmapText("??", {font: "56px Superclarendon Numbers", align: "center"});
			this._rewardScreen._messageBox.value.x = - this._rewardScreen._messageBox.value.textWidth/2;
			this._rewardScreen._messageBox.value.y = - this._rewardScreen._messageBox.value.textHeight/2 - 62;
			this._rewardScreen._messageBox.addChild(this._rewardScreen._messageBox.value);

			var copy = this._assetManager.getJSON("strings")["REWARD_MESSAGE"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				this._rewardScreen._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "36px Superclarendon Title Purple", align: "center"});
				this._rewardScreen._messageBox.message.x = - this._rewardScreen._messageBox.message.textWidth/2;
				this._rewardScreen._messageBox.message.y = - this._rewardScreen._messageBox.message.textHeight/2 + 140;
				this._rewardScreen._messageBox.addChild(this._rewardScreen._messageBox.message);
			}
			else
			{
				this._rewardScreen._messageBox.message = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
				this._rewardScreen._messageBox.message.anchor.set(0.5);
				this._rewardScreen._messageBox.message.position.set(0, 150);
				this._rewardScreen._messageBox.addChild(this._rewardScreen._messageBox.message);
			}

		this._rewardScreen._closeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_cross")
		);
		this._rewardScreen._closeButton.x = (r2l ? -1 : 1) * 400;
		this._rewardScreen._closeButton.y = -240;
		this._rewardScreen._closeButton.signals.down.addOnce(this.onCloseClick, this);
		this._rewardScreen._messageBox .addChild(this._rewardScreen._closeButton);

		this._rewardScreen._title.scale.set(0);
		this._rewardScreen._messageBox.scale.set(0);
		this._rewardScreen._closeButton.scale.set(0);

	// Error screen
	this._errorScreen = new PIXI.Container();
	this.addChild(this._errorScreen);

		this._errorScreen._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
		this._errorScreen._messageBox.anchor.set(0.5);
		this._errorScreen._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
		this.addChild(this._errorScreen._messageBox);

			var copy = this._assetManager.getJSON("strings")["SORRY"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				this._errorScreen._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "48px Superclarendon Title Purple", align: "center"});
				this._errorScreen._messageBox.message.x = - this._errorScreen._messageBox.message.textWidth/2;
				this._errorScreen._messageBox.message.y = - this._errorScreen._messageBox.message.textHeight/2 - 160;
				this._errorScreen._messageBox.addChild(this._errorScreen._messageBox.message);
			}
			else
			{
				this._errorScreen._messageBox.message = new PIXI.Text(copy, {font:"48px Arial", fill:0x000000, align:'center'});
				this._errorScreen._messageBox.message.anchor.set(0.5);
				this._errorScreen._messageBox.message.position.set(0, -150);
				this._errorScreen._messageBox.addChild(this._errorScreen._messageBox.message);
			}

			var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_redeem_warning"));
			bg.anchor.set(0.5);
			bg.position.set(0, -15);
			this._errorScreen._messageBox.addChild(bg);

			var copy = this._assetManager.getJSON("strings")["CODE_WRONG"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				this._errorScreen._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "32px Superclarendon Title Purple", align: "center"});
				this._errorScreen._messageBox.message.x = - this._errorScreen._messageBox.message.textWidth/2;
				this._errorScreen._messageBox.message.y = - this._errorScreen._messageBox.message.textHeight/2 + 140;
				this._errorScreen._messageBox.addChild(this._errorScreen._messageBox.message);
			}
			else
			{
				this._errorScreen._messageBox.message = new PIXI.Text(copy, {font:"32px Arial", fill:0x000000, align:'center'});
				this._errorScreen._messageBox.message.anchor.set(0.5);
				this._errorScreen._messageBox.message.position.set(0, 150);
				this._errorScreen._messageBox.addChild(this._errorScreen._messageBox.message);
			}

		this._errorScreen._closeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_cross")
		);
		this._errorScreen._closeButton.x = (r2l ? -1 : 1) * 400;
		this._errorScreen._closeButton.y = -240;
		this._errorScreen._closeButton.signals.down.addOnce(this.onCloseClick, this);
		this._errorScreen._messageBox .addChild(this._errorScreen._closeButton);

		this._errorScreen._messageBox.scale.set(0);
		this._errorScreen._closeButton.scale.set(0);
};

/**
 */
CodeOverlay.prototype.update = function()
{
};

/**
 */
CodeOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
CodeOverlay.prototype.dispose = function()
{

}

CodeOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._codeScreen._title.scale       = new PIXI.Point(0,0);
	this._codeScreen._codeBox.scale     = new PIXI.Point(0,0);
	this._codeScreen._closeButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                             .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._codeScreen._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._codeScreen._codeBox.scale,      .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._codeScreen._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

CodeOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                             .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._codeScreen._title.scale,        .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._codeScreen._codeBox.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._rewardScreen._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._rewardScreen._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._errorScreen._messageBox.scale,  .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};


//===================================================
// PRIVATE METHODS
//===================================================

CodeOverlay.prototype.updateCode = function(code)
{
	this._code = code;

	this._codeScreen._codeBox.code.text = this._code;
	this._codeScreen._codeBox.code.validate();
	this._codeScreen._codeBox.code.x = - this._codeScreen._codeBox.code.textWidth/2;
}

CodeOverlay.prototype.showResults = function()
{
	var tl = new TimelineMax();
		tl.to(this._codeScreen._title.scale,        .3, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._codeScreen._codeBox.scale,      .3, {x:0, y:0, ease:Back.easeIn}, 0);

	
	
	// Valid code
	if(Common.savedData.isCodeValid(this._code) && !Common.savedData.isCodeRedeemed(this._code))
	{
		var prize = Common.savedData.getCodeValue(this._code);
		Common.savedData.coins += prize;
		Common.savedData.setCodeAsUsed(this._code);
		Common.savedData.save();
		
		// Change values	
		this._rewardScreen._messageBox.value.x += this._rewardScreen._messageBox.value.textWidth/2;
		this._rewardScreen._messageBox.value.text = prize.toString();
		this._rewardScreen._messageBox.value.validate();
		this._rewardScreen._messageBox.value.x -= this._rewardScreen._messageBox.value.textWidth/2;

		if(!webfont)
		{
			this._rewardScreen._messageBox.message.x   += this._rewardScreen._messageBox.message.textWidth/2;
			this._rewardScreen._messageBox.message.text = this._rewardScreen._messageBox.message.text.replace("{value}", prize.toString());
			this._rewardScreen._messageBox.message.validate();
			this._rewardScreen._messageBox.message.x   -= this._rewardScreen._messageBox.message.textWidth/2;
		}
		else
		{
			this._rewardScreen._messageBox.message.text = this._rewardScreen._messageBox.message.text.replace("{value}", prize.toString());
		}		
		
		// Animation
		tl.to(this._rewardScreen._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, .3);
		tl.to(this._rewardScreen._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, .3);
		tl.to(this._rewardScreen._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, .6 + .3);
	}
	// Invalid code
	else
	{
		// Already redeemed
		if(Common.savedData.isCodeValid(this._code))
			var copy = this._assetManager.getJSON("strings")["CODE_USED"][Common.COUNTRY_CODE];
		// Wrong
		else
			var copy = this._assetManager.getJSON("strings")["CODE_WRONG"][Common.COUNTRY_CODE];
		
		if(!webfont)
		{
			this._errorScreen._messageBox.message.text = copy;
			this._errorScreen._messageBox.message.validate();
			this._errorScreen._messageBox.message.x = -this._errorScreen._messageBox.message.textWidth/2;
		}
		
		tl.to(this._errorScreen._messageBox.scale,  .5, {x:1, y:1, ease:Back.easeOut}, .3);
		tl.to(this._errorScreen._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, .6 + .3);
	}
	
	
	Common.animator.add(tl);	
}

//===================================================
// EVENTS
//===================================================

CodeOverlay.prototype.onCloseClick = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

CodeOverlay.prototype.onDigitClick = function(e)
{
	if(this._code.length >= this._maxLength)
	{
		SoundSFX.play("sfx_elsa_ice_magic_platform_fail_00");
		return;
	}

	SoundSFX.play("sfx_btn_press_00");
	this.updateCode(this._code + e.digit);
}

CodeOverlay.prototype.onEnterClick = function(e)
{
	if(this._code == "")
	{
		SoundSFX.play("sfx_elsa_ice_magic_platform_fail_00");
		return;
	}

	SoundSFX.play("sfx_btn_press_00");
	this.showResults();
}

CodeOverlay.prototype.onDeleteClick = function(e)
{
	if(this._code == "")
	{
		SoundSFX.play("sfx_elsa_ice_magic_platform_fail_00");
		return;
	}

	SoundSFX.play("sfx_btn_press_00");
	this.updateCode(this._code.substr(0, this._code.length-1));
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../screens/SimpleScreen":73}],55:[function(require,module,exports){
var Common          = require("../Common");
var SimpleScreen    = require("../screens/SimpleScreen");
var WireframeButton = require("../general/WireframeButton");
var SoundSFX        = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function EndGameOverlay(content, callback, scope)
{
	this._content = content;
	this._callback = callback;
	this._scope = scope;

	this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = EndGameOverlay;
EndGameOverlay.prototype = Object.create(SimpleScreen.prototype);
EndGameOverlay.prototype.constructor = EndGameOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
EndGameOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._bg.alpha   = 0.75;
	this._bg.width   = Common.STAGE_WIDTH;
	this._bg.height  = Common.STAGE_HEIGHT;
	this._bg.hitArea = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.tint    = 0x2c3a66;
	this._bg.interactive = true;
	this.addChild(this._bg);

	// Title
	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["WELL_DONE"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._title.addChild(title);
		}

	// Panel background
	this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2 + 70);
	this.addChild(this._messageBox);

		var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_image_pabbie_found"));
		bg.anchor.set(0.5);
		bg.position.set(0, -80);
		this._messageBox.addChild(bg);

		// What message?
		if(Common.savedData.endGameMessage.crystals.show)
			var copy = this._assetManager.getJSON("strings")["ENDGAME_CRYSTALS"][Common.COUNTRY_CODE];
		else if(Common.savedData.endGameMessage.trolls.show)
			var copy = this._assetManager.getJSON("strings")["ENDGAME_TROLLS"][Common.COUNTRY_CODE];
		else
			var copy = this._assetManager.getJSON("strings")["ENDGAME_LEVELS"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			this._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "32px Mikadan White", align: "center", tint: 0x6d38ab});
			this._messageBox.message.maxWidth = 620;
			this._messageBox.message.updateText();
			this._messageBox.message.x = -this._messageBox.message.textWidth/2;
			this._messageBox.message.y = -this._messageBox.message.textHeight/2 + 130;
			this._messageBox.addChild(this._messageBox.message);
		}
		else
		{
			this._messageBox.message = new PIXI.Text(copy, {font:"32px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:700});
			this._messageBox.message.anchor.set(0.5);
			this._messageBox.message.position.set(0, 130);
			this._messageBox.addChild(this._messageBox.message);
		}

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
	this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onClose, this);
	this._messageBox .addChild(this._closeButton);

	this._messageBox.scale.set(0);
	this._closeButton.scale.set(0);

	// Don't show again
	Common.savedData.endGameMessage.levels.shown   = Common.savedData.endGameMessage.levels.show;
	Common.savedData.endGameMessage.crystals.shown = Common.savedData.endGameMessage.crystals.show;
	Common.savedData.endGameMessage.trolls.shown   = Common.savedData.endGameMessage.trolls.show;
	Common.savedData.save();
};

/**
 */
EndGameOverlay.prototype.update = function()
{
};

/**
 */
EndGameOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
EndGameOverlay.prototype.dispose = function()
{

}

EndGameOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	this._bg.alpha = 0;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,       .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

EndGameOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

EndGameOverlay.prototype.onClose = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],56:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function EndlessOverlay(isLocked)
{
	this._isLocked = isLocked;
    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = EndlessOverlay;
EndlessOverlay.prototype = Object.create(SimpleScreen.prototype);
EndlessOverlay.prototype.constructor = EndlessOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
EndlessOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);


	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		if(this._isLocked)
			var copy = this._assetManager.getJSON("strings")["LOCKED"][Common.COUNTRY_CODE];
		else
			var copy = this._assetManager.getJSON("strings")["UNLOCKED"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor.set(0.5);
			title.y = -6;
			this._title.addChild(title);
		}

    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.x = Common.STAGE_WIDTH/2;
	this._messageBox.y = Common.STAGE_HEIGHT/2 + 70;
    this.addChild(this._messageBox);

		var deco = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_deco"));
		deco.anchor.set(0.5);
		deco.position.set(-160, -130);
		this._messageBox.addChild(deco);

		var lock = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_lock"));
		lock.anchor.set(0.5);
		lock.position = deco.position;
		this._messageBox.addChild(lock);

		if(this._isLocked)
			var copy = this._assetManager.getJSON("strings")["LOCKED"][Common.COUNTRY_CODE];
		else
			var copy = this._assetManager.getJSON("strings")["ENDLESS"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			text.x = -160 -text.textWidth/2;
			text.y = -10 -text.textHeight/2;
			this._messageBox.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			text.anchor.set(0.5);
			text.position.set(-160, -10);
			this._messageBox.addChild(text);
		}

		if(this._isLocked)
		{
			var levelRequired = this._assetManager.getJSON("config").endless.levelRequired;
			var copy = this._assetManager.getJSON("strings")["ENDLESS_LOCKED"][Common.COUNTRY_CODE];
			copy = copy.replace("{value}", levelRequired);
		}
		else
		{
			var copy = this._assetManager.getJSON("strings")["ENDLESS_UNLOCKED"][Common.COUNTRY_CODE];
		}

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "24px Mikadan White", align: "center", tint: 0x6d38ab});
			text.x = -160 -text.textWidth/2;
			text.y = +80 -text.textHeight/2;
			this._messageBox.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:270});
			text.anchor.set(0.5);
			text.position.set(-160, 80);
			this._messageBox.addChild(text);
		}


	// this._character = new PIXI.Sprite(this._assetManager.getTexture("ui_char_olaf"));
	// this._character.anchor.set(0.5, 1);
	// this._character.x = 170;
	// this._character.y = this._messageBox.height/2 + 35;
    // this._messageBox.addChild(this._character);

	this._char = new PIXI.spine.Spine(Common.characterAnimationData["olaf"]);
	this._char.skeleton.setToSetupPose();
	this._char.skeleton.setSkin(null);
	this._char.skeleton.setSkinByName("default");
	this._char.x = 170;
	this._char.y = this._messageBox.height/2 + 35;
	this._char.autoUpdate = true;
	this._char.scale.set(0.5);
	this._char.state.setAnimationByName(0, "look_left", true, 0);
	this._messageBox.addChild(this._char);

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onCloseClick, this);
	this._messageBox.addChild(this._closeButton);
};

/**
 */
EndlessOverlay.prototype.update = function()
{
};

/**
 */
EndlessOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
EndlessOverlay.prototype.dispose = function()
{

}

EndlessOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

EndlessOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

EndlessOverlay.prototype.onCloseClick = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],57:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function ExitOverlay(link, isDisneySite)
{
	this._link         = link;
    this._isDisneySite = isDisneySite;

	SimpleScreen.call(this);
}

module.exports = ExitOverlay;
ExitOverlay.prototype = Object.create(SimpleScreen.prototype);
ExitOverlay.prototype.constructor = ExitOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
ExitOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._boxContainer = new PIXI.Container();
	this.addChild(this._boxContainer);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this._boxContainer.addChild(this._bg);

	this._border = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._border.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
	this._border.anchor.set(0.5)
	this._border.width  = 602;
	this._border.height = 262;
	this._border.tint = 0x999999;
	this._boxContainer.addChild(this._border);

	this._box = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._box.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
	this._box.anchor.set(0.5)
	this._box.width = this._border.width-2;
	this._box.height = this._border.height-2;
	this._boxContainer.addChild(this._box);

	this._innerBox = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._innerBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
	this._innerBox.anchor.set(0.5)
	this._innerBox.width  = this._box.width-20;
	this._innerBox.height = this._box.height-20;
	this._boxContainer.addChild(this._innerBox);

	// Text
	if(this._isDisneySite)
		var copy = this._assetManager.getJSON("strings")["EXIT_DISNEY"][Common.COUNTRY_CODE];
	else
		var copy = this._assetManager.getJSON("strings")["EXIT_NOT_DISNEY"][Common.COUNTRY_CODE];

	var text = new PIXI.Text(copy, {font:"bold 16px Arial", fill:0x000000, align:'left', wordWrap:true, wordWrapWidth:this._box.width-100});
	text.position.set(Common.STAGE_WIDTH/2 - this._innerBox.width/2 + 20, Common.STAGE_HEIGHT/2 - this._innerBox.height/2 + 20)
	this._boxContainer.addChild(text);

	if(!this._isDisneySite)
	{
		var copy = this._assetManager.getJSON("strings")["EXIT_NOT_DISNEY_DESCRIPTION"][Common.COUNTRY_CODE];

		var text = new PIXI.Text(copy, {font:"13px Arial", fill:0x555555, align:'left', lineHeight: 20, wordWrap:true, wordWrapWidth:this._box.width-100});
		text.position.set(Common.STAGE_WIDTH/2 - this._innerBox.width/2 + 20, Common.STAGE_HEIGHT/2 - this._innerBox.height/2 + 50)
		this._boxContainer.addChild(text);
	}

	// Buttons
	this._backButton = new PIXI.Sprite(this._assetManager.getTexture("ui_btn_exit_white"));
	this._backButton.anchor.set(0,1);
	this._backButton.position.set(Common.STAGE_WIDTH/2 - this._innerBox.width/2 + 20, Common.STAGE_HEIGHT/2 + this._innerBox.height/2 - 20);
	this._backButton.interactive = true;
	this._backButton.touchstart = this._backButton.mousedown = function(e){this.onCloseClick(e)}.bind(this);
	this._boxContainer.addChild(this._backButton);

		var copy = this._assetManager.getJSON("strings")["EXIT_NO"][Common.COUNTRY_CODE];
		var text = new PIXI.Text(copy, {font:"14px Arial", fill:0x2a9bfe, align:'center', wordWrap:true, wordWrapWidth:this._box.width-100});
		text.anchor.set(0.5);
		text.position.set(this._backButton.width/2, -this._backButton.height/2)
		this._backButton.addChild(text);

	this._linkButton = new PIXI.Sprite(this._assetManager.getTexture("ui_btn_exit_blue"));
	this._linkButton.anchor.set(0,1);
	this._linkButton.position.set(Common.STAGE_WIDTH/2 - this._innerBox.width/2 + 20 + this._backButton.width + 10, Common.STAGE_HEIGHT/2 + this._innerBox.height/2 - 20);
	this._linkButton.interactive = true;
	this._linkButton.touchstart = this._linkButton.mousedown = function(e){this.onLinkClick(e)}.bind(this);
	this._boxContainer.addChild(this._linkButton);

		var copy = this._assetManager.getJSON("strings")["EXIT_YES"][Common.COUNTRY_CODE];
		var text = new PIXI.Text(copy, {font:"14px Arial", fill:0xffffff, align:'center', wordWrap:true, wordWrapWidth:this._box.width-100});
		text.anchor.set(0.5);
		text.position.set(this._linkButton.width/2, -this._linkButton.height/2)
		this._linkButton.addChild(text);

};

/**
 */
ExitOverlay.prototype.update = function()
{
};

/**
 */
ExitOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
ExitOverlay.prototype.dispose = function()
{

}

ExitOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	// this._bg.alpha = 0;
	this._boxContainer.alpha = 0;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		// tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._boxContainer,       .5, {alpha:1, ease:Sine.easeOut}, 0);
	Common.animator.add(tl);
};

ExitOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		// tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._boxContainer,     .5, {alpha:0, ease:Sine.easeOut}, 0);
	Common.animator.add(tl);
};

//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

ExitOverlay.prototype.onCloseClick = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

ExitOverlay.prototype.onLinkClick = function()
{
	if (!p3.Device.isIframe)
	{
		var win = window.open(this._link, '_blank');
		win.focus();
	}
	else
	{
		console.group("Opening " + this._link);
		try
		{
			// console.info("Tryng to open the page normally.");
			// var win = window.parent.open(this._link, '_blank');
			// win.focus();
			window.open(this._link, '_blank');
		}
		catch(e)
		{
			console.info("Couldn't open the page as it's not on the same domain.");
			// console.info("Tryng to open the page through 'postMessage'.");
			// window.parent.postMessage(this._link, '*');
		}
		console.groupEnd("Opening " + this._link);
	}

	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}


//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],58:[function(require,module,exports){
var Common       = require("../Common");
var SimpleScreen = require("../screens/SimpleScreen");
var NextButton   = require("../general/NextButton");
var SoundSFX     = require("../general/SoundSFX");
var MuteButton   = require("../lib/MuteButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function GameOverOverlay(level)
{
	this.level = level;

	SimpleScreen.call(this);

	this.handleActive = false;
	this.handleMinY   = - 180;
	this.handleMaxY   = + 200;
	this.handleY      = this.handleMinY;
	this.handleSFX = null;
	this.handleSFXCountdown = 0;

	this._characterData = this._assetManager.getJSON("config").characters[Common.savedData.character];

	this.signals.requestedCurrentScreen = new signals.Signal();
}
module.exports = GameOverOverlay;
GameOverOverlay.prototype = Object.create(SimpleScreen.prototype);
GameOverOverlay.prototype.constructor = GameOverOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
GameOverOverlay.prototype.init = function()
{
	console.log("PAUSE INITIALIZED");

	SimpleScreen.prototype.init.call(this);

	// Bg
	this._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_bg_main_menu"));
	this._bg.alpha       = 1;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);

	// GOALS SCREEN
	this._goalsScreen = new PIXI.Container();
	this.addChild(this._goalsScreen);

		this._goalsScreen._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
		this._goalsScreen._title.anchor.set(0.5);
		this._goalsScreen._title.x = Common.STAGE_WIDTH/2;
		this._goalsScreen._title.y = 100;
		this._goalsScreen.addChild(this._goalsScreen._title);

			var copy = this._assetManager.getJSON("strings")["GOALS"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var title = new PIXI.extras.BitmapText(copy, {font: "50px Superclarendon Title Purple", align: "center"});
				title.x = -title.textWidth/2;
				title.y = -title.textHeight/2 - 4;
				this._goalsScreen._title.addChild(title);
			}
			else
			{
				var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
				title.anchor.set(0.5);
				title.y = -6;
				this._goalsScreen._title.addChild(title);
			}

			this._goalsScreen._goalsContainer = new PIXI.Container();
			this._goalsScreen._goalsContainer.position.set(Common.STAGE_WIDTH/2 - 10, Common.STAGE_HEIGHT/2 - 140);
			this._goalsScreen.addChild(this._goalsScreen._goalsContainer);

			this._goalsScreen._goals = [];

				var activeGoals = Common.goalsManager.getActiveGoals();

				for(var active = 1; active >= 0; active--)
				{
					for(var i = 0; i < Common.goalsManager.goals.length; i++)
					{
						var id = Common.goalsManager.goals[i].id;
						var goalStatus = Common.goalsManager.getGoalStatus(id);

						// Show the active goals first, then the rest
						var keep = (active == 0);

						for(var j = 0; j < activeGoals.length; j++)
						{
							if(activeGoals[j].id == id)
							{
								keep = !keep;
								break;
							}
						}

						if(!keep) continue;


						var goal = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_" + ((i%4)+1)));
						goal.anchor.set(0.5);
						goal.y = i * 100;
						this._goalsScreen._goalsContainer.addChild(goal);
						this._goalsScreen._goals.push(goal);

						var icon = new PIXI.Sprite(this._assetManager.getTexture(Common.goalsManager.goals[i].icon));
						icon.anchor.set(0, 0.5);
						icon.x = - 360;
						goal.addChild(icon);

						if(!webfont)
						{
							var text = new PIXI.extras.BitmapText(Common.goalsManager.goals[i].label, {font: "28px Mikadan Title", align: "left"});
							text.maxWidth = 400;
							text.updateText();
							text.x = -180;
							text.y = -text.textHeight/2;
							goal.addChild(text);
						}
						else
						{
							var text = new PIXI.Text(Common.goalsManager.goals[i].label, {font:"28px Arial", fill:0xFFFFFF, align:(r2l ? 'right' : 'left'), wordWrap:true, wordWrapWidth:400});
							text.x = r2l ? 220 : -180;
							text.anchor.set(r2l ? 1 : 0, 0.5);
							goal.addChild(text);
						}

						var progress = new PIXI.Container();
						progress.x = 300
						goal.addChild(progress);

							var id = Common.goalsManager.goals[i].id;
							var goalStatus = Common.goalsManager.getGoalStatus(id);

							if(goalStatus == 1)
							{
								var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_complete"));
								progressBg.anchor.set(0.5);
								progress.addChild(progressBg);
							}
							else
							{
								var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_bar"));
								progressBg.anchor.set(0.5);
								progress.addChild(progressBg);

								if(goalStatus > 0)
								{
									var progressBar = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_fill"));
									progressBar.anchor.set(0.5);
									progress.addChild(progressBar);

										var canvas = document.createElement('canvas');
										canvas.width  = 128;
										canvas.height = 128;
										var ctx = canvas.getContext("2d");

										ctx.moveTo(canvas.width/2, canvas.height/2);
										ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2, -Math.PI/2, 2*Math.PI*goalStatus-Math.PI/2);
										ctx.lineTo(canvas.width/2, canvas.height/2);
										ctx.fillStyle = 'white';
										ctx.fill();

										var mask = new PIXI.Sprite(PIXI.Texture.fromCanvas(canvas));
										mask.anchor.set(0.5);
										progressBar.addChild(mask);
										progressBar.mask = mask;
								}
							}
						}
				}

				var snow = new PIXI.Sprite(this._assetManager.getTexture("ui_snow_top"));
				snow.anchor.set(0.5, 1);
				snow.y = -15;
				snow.width = this._goalsScreen._goals[0].width+ 20;
				this._goalsScreen._goals[0].addChild(snow);

				// Mask
				var canvas = document.createElement('canvas');
				canvas.width  = 2;
				canvas.height = 512;
				var ctx = canvas.getContext("2d");

				var gradient = ctx.createLinearGradient(0,0,0,canvas.height);
				gradient.addColorStop(0, "rgba(255,255,255,0)");
				gradient.addColorStop(0.05, "rgba(255,255,255,1)");
				gradient.addColorStop(0.93, "rgba(255,255,255,1)");
				gradient.addColorStop(1, "rgba(255,255,255,0)");

				ctx.fillStyle = gradient;
				ctx.fillRect(0, 0, canvas.width, canvas.height);

				var mask = new PIXI.Sprite(PIXI.Texture.fromCanvas(canvas));
				mask.anchor.set(0.5, 0);
				mask.position.y -= 85;
				mask.width = 800;
				mask.height = 550;
				this._goalsScreen._goalsContainer.addChild(mask);
				this._goalsScreen._goalsContainer.mask = mask;

			this._goalsScreen._goalsScroller = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_bg"));
			this._goalsScreen._goalsScroller.anchor.set(0.5);
			this._goalsScreen._goalsScroller.position.set(Common.STAGE_WIDTH/2 + 400, Common.STAGE_HEIGHT/2 + 60);
			this._goalsScreen.addChild(this._goalsScreen._goalsScroller);

				var texture = this._assetManager.getTexture("ui_scroll_rope_tile");
				this._goalsScreen._goalsScroller._rope = new PIXI.extras.TilingSprite(texture, texture.width, this._goalsScreen._goalsScroller.height - 10);
				this._goalsScreen._goalsScroller._rope.anchor.set(0.5);
				this._goalsScreen._goalsScroller.addChild(this._goalsScreen._goalsScroller._rope);

				var cap = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_top"));
				cap.anchor.set(0.5, 1);
				cap.y = -this._goalsScreen._goalsScroller._rope.height/2 + 25;
				this._goalsScreen._goalsScroller._rope.addChild(cap);

				var cap = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_bottom"));
				cap.anchor.set(0.5, 0);
				cap.y = this._goalsScreen._goalsScroller._rope.height/2 - 22;
				this._goalsScreen._goalsScroller._rope.addChild(cap);

				this._goalsScreen._goalsScroller._handle = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_handle"));
				this._goalsScreen._goalsScroller._handle.anchor      = new PIXI.Point(0.5, 0.5);
				this._goalsScreen._goalsScroller._handle.y           = this.handleMinY;
				this._goalsScreen._goalsScroller._handle.yReal       = this.handleMinY;
				this._goalsScreen._goalsScroller._handle.interactive = true;
				this._goalsScreen._goalsScroller.addChild(this._goalsScreen._goalsScroller._handle);

				this._goalsScreen._goalsScroller._handle.touchstart = this._goalsScreen._goalsScroller._handle.mousedown = function(e){this.onHandleDown(e)}.bind(this);
				this._goalsScreen._goalsScroller._handle.touchmove  = this._goalsScreen._goalsScroller._handle.mousemove = function(e){this.onHandleMove(e)}.bind(this);

		this._goalsScreen._closeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_con_out"),
			this._assetManager.getTexture("ui_btn_con_over"),
			this._assetManager.getTexture("ui_btn_con_down"),
			this._assetManager.getTexture("ui_icon_con_cross")
		);
		this._goalsScreen._closeButton.y = this._guiButtonTopMargin;
		this._goalsScreen._closeButton.signals.down.add(this.onCloseGoalsClick, this);
		this._goalsScreen.addChild(this._goalsScreen._closeButton);

	// RESULTS SCREEN
	this._resultsScreen = new PIXI.Container();
	this.addChild(this._resultsScreen);

		// Home button
		this._resultsScreen._homeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_con_out"),
			this._assetManager.getTexture("ui_btn_con_over"),
			this._assetManager.getTexture("ui_btn_con_down"),
			this._assetManager.getTexture("ui_icon_con_home")
		);
		this._resultsScreen._homeButton.y = this._guiButtonTopMargin;
		this._resultsScreen._homeButton.signals.down.addOnce(this.onHomeClick, this);
		this._resultsScreen._homeButton.overSoundName = "sfx_btn_rollover_00";
		this._resultsScreen.addChild(this._resultsScreen._homeButton);

		// Goals button
		this._resultsScreen._goalsButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_con_out"),
			this._assetManager.getTexture("ui_btn_con_over"),
			this._assetManager.getTexture("ui_btn_con_down"),
			this._assetManager.getTexture("ui_icon_con_goals")
		);
		this._resultsScreen._goalsButton.y = this._guiButtonTopMargin;
		this._resultsScreen._goalsButton.signals.down.add(this.onGoalsClick, this);
		this._resultsScreen._goalsButton.overSoundName = "sfx_btn_rollover_00";
		this._resultsScreen.addChild(this._resultsScreen._goalsButton);

		// Mute button
		this._resultsScreen._muteButton = new p3.MuteButton
		(
			this._assetManager.getTexture("ui_btn_con_out"),
			this._assetManager.getTexture("ui_btn_con_over"),
			this._assetManager.getTexture("ui_btn_con_down"),
			this._assetManager.getTexture("ui_icon_con_sound_on"),
			this._assetManager.getTexture("ui_icon_con_sound_off")
		);
		this._resultsScreen._muteButton.id = "mute";
		this._resultsScreen._muteButton.y = this._guiButtonTopMargin;
		this._resultsScreen._muteButton.init();
		this._resultsScreen.addChild(this._resultsScreen._muteButton);

		// Title
		var copy = this._assetManager.getJSON("strings")[(this.level.completed || this.level.endless) ? "WELL_DONE" : "NICE_TRY"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			this._resultsScreen._title = new PIXI.Container();
			this._resultsScreen._title.position.set(Common.STAGE_WIDTH/2 + 100, 100)
			this.addChild(this._resultsScreen._title);

			var title = new PIXI.extras.BitmapText(copy, {font: "48px Superclarendon Title", align: "center"});
			title.x = - title.textWidth/2;
			title.y = - title.textHeight/2;
			this._resultsScreen._title.addChild(title);
		}
		else
		{
			this._resultsScreen._title = new PIXI.Text(copy, {font:"36px Arial", fill:0xffffff, align:'center'});
			this._resultsScreen._title.anchor.set(0.5);
			this._resultsScreen._title.position.set(Common.STAGE_WIDTH/2 + 100, 100);
			this._resultsScreen.addChild(this._resultsScreen._title);
		}


		// Coins
		this.initCoinCointainer(Common.savedData.coins - this.level.snowflakes);
		this.removeChild(this._coinsContainer);
		this._resultsScreen._coinsContainer = this._coinsContainer;
		this._resultsScreen.addChild(this._resultsScreen._coinsContainer);

			// Coins text animation
			var tl = new TimelineMax();
				tl.coins = Common.savedData.coins - this.level.snowflakes;
				tl.to(tl, 1.1, {coins:Common.savedData.coins, ease:Linear.easeNone, onUpdateScope:this, onUpdate:function()
				{
					this.initCoinCointainer(Math.round(tl.coins));
				}}, 1.8);
			Common.animator.add(tl);


		// Scrolls
		this._resultsScreen._scroll = new PIXI.Sprite(this._assetManager.getTexture("ui_result_bg"));
		this._resultsScreen._scroll.anchor.set(0.5);
		this._resultsScreen._scroll.x = Common.STAGE_WIDTH/2 + 100;
		this._resultsScreen._scroll.y = Common.STAGE_HEIGHT/2 + 60;
		this._resultsScreen.addChild(this._resultsScreen._scroll);

			this._resultsScreen._scroll._content = new PIXI.Container();
			this._resultsScreen._scroll.addChild(this._resultsScreen._scroll._content);

			// Level
			if(!this.level.endless)
			{
				var copy = this._assetManager.getJSON("strings")["LEVEL"][Common.COUNTRY_CODE];

				if(!webfont)
				{
					var text = new PIXI.extras.BitmapText(copy.replace("{value}", (Common.savedData.level + 1)), {font: "36px Mikadan White", align: "center", tint: 0x6d534a});
					text.x = -text.textWidth/2;
					text.y = -text.textHeight/2 - 180;
					this._resultsScreen._scroll._content.addChild(text);
				}
				else
				{
					var text = new PIXI.Text(copy.replace("{value}", (Common.savedData.level + 1)), {font:"36px Arial", fill:0x6d534a, align:'center'});
					text.anchor.set(0.5);
					text.y = -180;
					this._resultsScreen._scroll._content.addChild(text);
				}
			}
			else
			{
				this._resultsScreen._scroll._content.y -= 30;
			}

			// First column
			var copy = this._assetManager.getJSON("strings")[this.level.endless ? "DISTANCE" : (Common.savedData.character == "pabbie" ? "TROLLS" : "CRYSTALS")][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "26px Mikadan White", align: "center", tint: 0x0fa0e4});
				text.x = - text.textWidth/2  - 200;
				text.y = - text.textHeight/2 - 125;
				this._resultsScreen._scroll._content.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x0fa0e4, align:'center'});
				text.anchor.set(0.5);
				text.x = -200;
				text.y = -130;
				this._resultsScreen._scroll._content.addChild(text);
			}

			if(!!this.level.endless)
				var t = "ui_icon_results_distance";
			else if(Common.savedData.character == "pabbie")
				var t = "ui_icon_results_troll";
			else
				var t = "ui_icon_results_crystal_" + this._characterData.color;

			var icon = new PIXI.Sprite(this._assetManager.getTexture(t));
			icon.anchor.set(0.5);
			icon.x = -200;
			icon.y = -45;
			this._resultsScreen._scroll._content.addChild(icon);


			var particle = "particle_sparkle_results_pink";
			if(!this.level.endless && (Common.savedData.character == "kristoff" || Common.savedData.character == "pabbie"))
				particle = "particle_sparkle_results_green";
			else if(this.level.endless || (Common.savedData.character == "olaf"))
				particle = "particle_sparkle_results_blue";
			else if(this.level.endless || (Common.savedData.character == "elsa"))
				particle = "particle_sparkle_results_purple";

			this.crystalSparklePS = new cloudkid.Emitter(icon,
			[
				this._assetManager.getTexture("particle_sparkle_offset_00"),
				this._assetManager.getTexture("particle_sparkle_offset_01"),
				this._assetManager.getTexture("particle_sparkle_offset_02"),
				this._assetManager.getTexture("particle_sparkle_offset_03")
			], this._assetManager.getJSON(particle));
			this.crystalSparklePS.emit = true;

			if(!!this.level.endless)
				var copy = this.level.avatar.distance + "m";
			else if(Common.savedData.character == "pabbie")
				var copy = Common.savedData.getLevelCollectedTrollCount(Common.savedData.level) + "/3";
			else
				var copy = Common.savedData.getLevelCharacterCrystalCount(Common.savedData.level, Common.savedData.character) + "/3";

			var text = new PIXI.extras.BitmapText(copy, {font: "36px Superclarendon Title Purple", align: "center"});
			text.x = - text.textWidth/2 - 200;
			text.y = - text.textHeight/2 + 40;
			this._resultsScreen._scroll._content.addChild(text);

			// var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x000000, align:'center'});
			// text.anchor.set(0.5);
			// text.x = -200;
			// text.y = 40;
			// this._resultsScreen._scroll._content.addChild(text);

			// Second column
			var copy = this._assetManager.getJSON("strings")["STYLE_POINTS"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "26px Mikadan White", align: "center", tint: 0x0fa0e4});
				text.x = - text.textWidth/2;
				text.y = - text.textHeight/2 - 125;
				this._resultsScreen._scroll._content.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x0fa0e4, align:'center'});
				text.anchor.set(0.5);
				text.x = 0;
				text.y = -130;
				this._resultsScreen._scroll._content.addChild(text);
			}

			var icon = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_results_style"));
			icon.anchor.set(0.5);
			icon.x = 0;
			icon.y = -45;
			this._resultsScreen._scroll._content.addChild(icon);

			this.styleSparklePS = new cloudkid.Emitter(icon,
			[
				this._assetManager.getTexture("particle_sparkle_offset_00"),
				this._assetManager.getTexture("particle_sparkle_offset_01"),
				this._assetManager.getTexture("particle_sparkle_offset_02"),
				this._assetManager.getTexture("particle_sparkle_offset_03")
			], this._assetManager.getJSON("particle_sparkle_results_pink"));
			this.styleSparklePS.emit = true;

			var copy = this._assetManager.getJSON("strings")["STYLE_POINTS"][Common.COUNTRY_CODE];
			var text = new PIXI.extras.BitmapText(this.level.styleScore.toString(), {font: "36px Superclarendon Title Purple", align: "center"});
			text.x = - text.textWidth/2;
			text.y = - text.textHeight/2 + 40;
			this._resultsScreen._scroll._content.addChild(text);

			// var text = new PIXI.Text(this.level.styleScore + "", {font:"24px Arial", fill:0x000000, align:'center'});
			// text.anchor.set(0.5);
			// text.x = 0;
			// text.y = 40;
			// this._resultsScreen._scroll._content.addChild(text);

			// Third column
			var copy = this._assetManager.getJSON("strings")["SNOWFLAKES"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "26px Mikadan White", align: "center", tint: 0x0fa0e4});
				text.x = - text.textWidth/2 + 200;
				text.y = - text.textHeight/2 - 125;
				this._resultsScreen._scroll._content.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x0fa0e4, align:'center'});
				text.anchor.set(0.5);
				text.x = 200;
				text.y = -130;
				this._resultsScreen._scroll._content.addChild(text);
			}

			this._snowflakeIcon = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_results_snowflake"));
			this._snowflakeIcon.anchor.set(0.5);
			this._snowflakeIcon.x = 200;
			this._snowflakeIcon.y = -45;
			this._resultsScreen._scroll._content.addChild(this._snowflakeIcon);

			this.snowflakeSparklePS = new cloudkid.Emitter(this._snowflakeIcon,
			[
				this._assetManager.getTexture("particle_sparkle_offset_00"),
				this._assetManager.getTexture("particle_sparkle_offset_01"),
				this._assetManager.getTexture("particle_sparkle_offset_02"),
				this._assetManager.getTexture("particle_sparkle_offset_03")
			], this._assetManager.getJSON("particle_sparkle_results_blue"));
			this.snowflakeSparklePS.emit = true;

			var text = new PIXI.extras.BitmapText(this.level.snowflakes.toString(), {font: "36px Superclarendon Title Purple", align: "center"});
			text.x = - text.textWidth/2  + 200;
			text.y = - text.textHeight/2 + 40;
			this._resultsScreen._scroll._content.addChild(text);

			// var text = new PIXI.Text(this.level.snowflakes + "", {font:"24px Arial", fill:0x000000, align:'center'});
			// text.anchor.set(0.5);
			// text.x = 200;
			// text.y = 40;
			// this._resultsScreen._scroll._content.addChild(text);

			// Total title
			var copy = this._assetManager.getJSON("strings")["TOTAL"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "26px Mikadan White", align: "center", tint: 0x0fa0e4});
				text.x = - text.textWidth/2;
				text.y = - text.textHeight/2 + 90;
				this._resultsScreen._scroll._content.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"30px Arial", fill:0x0fa0e4, align:'center'});
				text.anchor.set(0.5);
				text.x = 0;
				text.y = 90;
				this._resultsScreen._scroll._content.addChild(text);
			}

			var sprite = new PIXI.Sprite(this._assetManager.getTexture("ui_result_element_1"));
			sprite.anchor.set(0, 0.5);
			sprite.position.set(+60, 90);
			this._resultsScreen._scroll._content.addChild(sprite);

			var sprite = new PIXI.Sprite(this._assetManager.getTexture("ui_result_element_1"));
			sprite.anchor.set(0, 0.5);
			sprite.position.set(-60, 90);
			sprite.rotation = Math.PI;
			this._resultsScreen._scroll._content.addChild(sprite);


			// Total
			var text = new PIXI.extras.BitmapText(this.level.score.toString(), {font: "56px Superclarendon Title Purple", align: "center"});
			text.x = - text.textWidth/2;
			text.y = - text.textHeight/2 + 140;
			this._resultsScreen._scroll._content.addChild(text);

			// var text = new PIXI.Text(this.level.score.toString(), {font:"48px Arial", fill:0x000000, align:'center'});
			// text.anchor.set(0.5);
			// text.x = 0;
			// text.y = 140;
			// this._resultsScreen._scroll._content.addChild(text);

			// Highscore
			var copy = this._assetManager.getJSON("strings")["HISCORE"][Common.COUNTRY_CODE];
			copy = copy.replace("{value}", Common.savedData.getHighscore(this.level.endless ? "endless" : Common.savedData.level));

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "26px Mikadan White", align: "center", tint: 0x0fa0e4});
				text.x = - text.textWidth/2;
				text.y = - text.textHeight/2 + 190;
				this._resultsScreen._scroll._content.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"24px Arial", fill:0x0fa0e4, align:'center'});
				text.anchor.set(0.5);
				text.x = 0;
				text.y = 190;
				this._resultsScreen._scroll._content.addChild(text);
			}

		// Character
		// this._resultsScreen._char = new PIXI.Sprite(this._assetManager.getTexture("ui_char_" + Common.savedData.character));
		// this._resultsScreen._char.anchor.set(0.5, 1);
		// this._resultsScreen._char.x = Common.STAGE_WIDTH/2 - 330;
		// this._resultsScreen._char.xEnd = this._resultsScreen._char.x;
		// this._resultsScreen._char.y = Common.STAGE_HEIGHT;
		// this._resultsScreen.addChild(this._resultsScreen._char);

		this._resultsScreen._char = new PIXI.spine.Spine(Common.characterAnimationData[Common.savedData.character]);
		this._resultsScreen._char.x = Common.STAGE_WIDTH/2 - 330;
		this._resultsScreen._char.xEnd = this._resultsScreen._char.x;
		this._resultsScreen._char.y = Common.STAGE_HEIGHT;
		this._resultsScreen._char.autoUpdate = true;
		this._resultsScreen._char.scale.set(0.5);
		this._resultsScreen._char.state.setAnimationByName(0, "look_right", true, 0);
		this._resultsScreen.addChild(this._resultsScreen._char);

		// Restart button
		this._resultsScreen._restartButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_restart")
		);
		this._resultsScreen._restartButton.overSoundName = "sfx_btn_rollover_00";
		this._resultsScreen._restartButton.y = Common.STAGE_HEIGHT - 120;
		this._resultsScreen._restartButton.signals.down.addOnce(this.onRestartClick, this);
		this._resultsScreen.addChild(this._resultsScreen._restartButton);

		// Continue button
		this._resultsScreen._continueButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out_big"),
			this._assetManager.getTexture("ui_btn_nav_over_big"),
			this._assetManager.getTexture("ui_btn_nav_down_big"),
			this._assetManager.getTexture("ui_icon_nav_play")
		);
		this._resultsScreen._continueButton.overSoundName = "sfx_btn_rollover_00";
		this._resultsScreen._continueButton.y = Common.STAGE_HEIGHT - 120;
		this._resultsScreen._continueButton.signals.down.addOnce(this.onContinueClick, this);
		this._resultsScreen.addChild(this._resultsScreen._continueButton);

	// Snowflakes
	this._goalSnowflakes = [];
	for(var i = 0; i < 10; i++)
	{
		var snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
		snowflake.anchor.set(0.5);
		snowflake.alpha = 0;
		this.addChild(snowflake);

		this._goalSnowflakes.push(snowflake);
	}

	// Music
	if(!!Common.bgMusic)
	{
		Common.bgMusic.stop();
		Common.bgMusic.fadeOut();
	}
	Common.bgMusic = SoundSFX.play('mx_frozen_05_score_lp', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 1000);

	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_end",
		game_level : Common.savedData.endless ? null : (Common.savedData.level+1),
		game_tier1 : "play_end",
		game_tier2 : (this.level.completed || this.level.endless) ? "success" : "fail",
		game_meta  : "{" +
						 "CharacterName=" + Common.savedData.character + "," +
						 "tumble="        + Common.savedData.charactersPower[Common.savedData.character][0] + "," +
						 "magnet="        + Common.savedData.charactersPower[Common.savedData.character][1] + "," +
						 "magic="         + Common.savedData.charactersPower[Common.savedData.character][2] + "," +
						 "crystals="      + (this.level.endless ? 0 : (Common.savedData.character == "pabbie" ? Common.savedData.getLevelCollectedTrollCount(Common.savedData.level) : Common.savedData.getLevelCharacterCrystalCount(Common.savedData.level, Common.savedData.character))) + "," +
						 "goals=["         + Common.goalsManager.getRunCompletedGoalsIds().join() + "]," +
						 "coins="         + Common.savedData.coins + "," +
						 "distance="      + this.level.avatar.distance +
					 "}"
	});
};

/**
 */
GameOverOverlay.prototype.update = function()
{
	this._resultsScreen._coinsContainer.x = this._getSecondButtonPositionLeft();

	this._resultsScreen._homeButton.x   = this._getFirstButtonPositionLeft();
	this._resultsScreen._muteButton.x   = this._getFirstButtonPositionRight();
	this._resultsScreen._goalsButton.x  = this._getSecondButtonPositionRight();

	// this._resultsScreen._restartButton.x   = r2l ? (this._getFirstButtonPositionRight() - 20) : (this._getFirstButtonPositionLeft() + 10);
	// this._resultsScreen._continueButton.x  = r2l ? (this._getFirstButtonPositionLeft() + 20) : (this._getFirstButtonPositionRight() - 20);
	this._resultsScreen._restartButton.x   = this._getFirstButtonPositionLeft() + 10;
	this._resultsScreen._continueButton.x  = this._getFirstButtonPositionRight() - 20;

	this._goalsScreen._closeButton.x = r2l ? this._getFirstButtonPositionLeft() : this._getFirstButtonPositionRight();

	this.crystalSparklePS.update(p3.Timestep.deltaTime);
	this.styleSparklePS.update(p3.Timestep.deltaTime);
	this.snowflakeSparklePS.update(p3.Timestep.deltaTime);

	if(!!this.handleSFX && this.handleSFXCountdown > 0)
	{
		this.handleSFXCountdown -= p3.Timestep.deltaTime;

		if(this.handleSFXCountdown <= 0)
		{
			this.handleSFX.stop();
			this.handleSFXCountdown = 0;
		}
	}
	// this._exitButton.x = this._getFirstButtonPositionLeft();
	// this._muteButton.x = this._getFirstButtonPositionRight();
};

/**
 */
GameOverOverlay.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);
};

/**
 */
GameOverOverlay.prototype.dispose = function()
{

}

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
GameOverOverlay.prototype.animateIn = function(callback, scope)
{
	var tl = new TimelineMax();
		tl.to(this._bg, .5, {alpha:1, ease:Sine.easeIn}, 0);
	Common.animator.add(tl);

	this._bg.alpha = 0;

	this.showResults(callback, scope)
	// this.showGoals(callback, scope)

	// Snowflakes particles
	var count    = 0;
	var countMax = 10;
	var tl = new TimelineMax();
	for(var p = 0; p < this._goalSnowflakes.length && count < countMax; p++)
	{
		var s = this._goalSnowflakes[p];
		if(s.alpha > 0) continue;

		s.position.set(this._resultsScreen._scroll.x + this._snowflakeIcon.x, this._resultsScreen._scroll.y + this._snowflakeIcon.y + this._resultsScreen._scroll._content.y);
		s.scale.set(1.5);
		s.alpha = 0;

		tl.to(s.scale, 1,    {x: 1, y: 1, ease:Quart.easeOut},            1 + count * 0.1);
		tl.to(s,       1,    {alpha:1, ease:Quart.easeOut},               1 + count * 0.1);
		tl.to(s,       1,    {rotation:2 * Math.PI, ease:Sine.easeInOut}, 1 + count * 0.1);
		tl.to(s,       1,    {x: this._coinsContainer.x + this._coinsContainer._snowflake.x,
		                      y: this._coinsContainer.y + this._coinsContainer._snowflake.y,
							  ease : Sine.easeInOut}, 1 + count * 0.1);
		tl.to(s,       0.01, {alpha: 0, ease:Linear.easeNone});

		count++;
	}

};


/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.animateOut = function(callback, scope)
{
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.exitGame = function(callback, scope)
{
	this._resultsScreen._homeButton.interactive     = false;
	this._resultsScreen._goalsButton.interactive    = false;
	this._resultsScreen._muteButton.interactive     = false;
	this._resultsScreen._restartButton.interactive  = false;
	this._resultsScreen._continueButton.interactive = false;

	if(callback) callback.call(scope);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.showGoals = function(callback, scope)
{
	this._goalsScreen.visible = true;
	this._resultsScreen.visible = false;

	this._goalsScreen._title.scale.set(0);
	this._goalsScreen._closeButton.scale.set(0);
	this._goalsScreen._goalsContainer.scale.set(1);
	this._goalsScreen._goalsScroller.scale.set(0);
	for(var i = 0; i < this._goalsScreen._goals.length; i++)
		this._goalsScreen._goals[i].scale.set(0);

	// this._goalsScreen._closeButton.interactive = true;

	this.moveHandle(-1000);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._goalsScreen._title.scale,         .5, {x:1, y:1, ease:Back.easeOut}, 0.2);
		tl.to(this._goalsScreen._closeButton.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
		tl.to(this._goalsScreen._goalsScroller.scale, .5, {x:1, y:1, ease:Back.easeOut}, 1);

		for(var i = 0; i < this._goalsScreen._goals.length; i++)
			tl.to(this._goalsScreen._goals[i].scale, .5, {x:1, y:1, ease:Back.easeOut}, Math.min(0.4 + i * 0.1, 2));

	Common.animator.add(tl);

};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.hideGoals = function(callback, scope)
{
	// this._goalsScreen._closeButton.interactive = false;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._goalsScreen._title.scale,       .3, {x:0, y:0, ease:Back.easeIn},       0);
		tl.to(this._goalsScreen._closeButton.scale, .3, {x:0, y:0, ease:Back.easeIn},       0);
		tl.to(this._goalsScreen._goalsScroller.scale,     .3, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._goalsScreen._goalsContainer.scale, .3, {x:0, y:0, ease:Back.easeIn},    0.2);
	Common.animator.add(tl);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.showResults = function(callback, scope)
{
	this._goalsScreen.visible = false;
	this._resultsScreen.visible = true;

	this._resultsScreen._title.scale.set(0);
	this._resultsScreen._coinsContainer.scale.set(0);
	this._resultsScreen._scroll.scale.set(0);
	this._resultsScreen._homeButton.scale.set(0);
	this._resultsScreen._goalsButton.scale.set(0);
	this._resultsScreen._muteButton.scale.set(0);
	this._resultsScreen._restartButton.scale.set(0);
	this._resultsScreen._continueButton.scale.set(0);

	// this._resultsScreen._homeButton.interactive     = true;
	// this._resultsScreen._goalsButton.interactive    = true;
	// this._resultsScreen._muteButton.interactive     = true;
	// this._resultsScreen._restartButton.interactive  = true;
	// this._resultsScreen._continueButton.interactive = true;

	this._resultsScreen._char.x = 0;
	this._resultsScreen._char.alpha = 0;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});

		tl.to(this._resultsScreen._title.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._resultsScreen._coinsContainer.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.4);
		tl.to(this._resultsScreen._scroll.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.2);

		tl.to(this._resultsScreen._goalsButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.4);
		tl.to(this._resultsScreen._muteButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.5);
		tl.to(this._resultsScreen._homeButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.5);

		tl.to(this._resultsScreen._restartButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
		tl.to(this._resultsScreen._continueButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.8);

		tl.to(this._resultsScreen._char, .5, {alpha:1, x: this._resultsScreen._char.xEnd, ease:Sine.EaseOut}, 0.3);

	Common.animator.add(tl);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameOverOverlay.prototype.hideResults = function(callback, scope)
{
	// this._resultsScreen._homeButton.interactive     = false;
	// this._resultsScreen._goalsButton.interactive    = false;
	// this._resultsScreen._muteButton.interactive     = false;
	// this._resultsScreen._restartButton.interactive  = false;
	// this._resultsScreen._continueButton.interactive = false;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});

		tl.to(this._resultsScreen._title.scale,          .5, {x:0, y:0, ease:Back.easeIn}, 0.1);
		tl.to(this._resultsScreen._coinsContainer.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0.2);
		tl.to(this._resultsScreen._scroll.scale,         .5, {x:0, y:0, ease:Back.easeIn}, 0.3);

		tl.to(this._resultsScreen._goalsButton.scale,    .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._resultsScreen._muteButton.scale,     .5, {x:0, y:0, ease:Back.easeIn}, 0.1);
		tl.to(this._resultsScreen._homeButton.scale,     .5, {x:0, y:0, ease:Back.easeIn}, 0.2);

		tl.to(this._resultsScreen._restartButton.scale,  .5, {x:0, y:0, ease:Back.easeIn}, 0.05);
		tl.to(this._resultsScreen._continueButton.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0.15);

		tl.to(this._resultsScreen._char,                 .5, {alpha:0, x: this._resultsScreen._char.x-200, ease:Sine.EaseIn}, 0.35);

	Common.animator.add(tl);
};



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================


GameOverOverlay.prototype.onCloseGoalsClick = function()
{
	this.hideGoals(function(){this.showResults()}, this);
}

GameOverOverlay.prototype.onRestartClick = function()
{
	this.exitGame(function()
	{
		this.signals.requestedCurrentScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}


GameOverOverlay.prototype.onContinueClick = function()
{
	this.exitGame(function()
	{
		this.signals.requestedNextScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}



GameOverOverlay.prototype.onHomeClick = function()
{
	this.exitGame(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

GameOverOverlay.prototype.onGoalsClick = function()
{
	this.hideResults(function(){this.showGoals()}, this);

	SoundSFX.play("sfx_btn_press_00");
}

/**
 */
GameOverOverlay.prototype.onHandleDown = function(e)
{
	this.handleActive = true;
	this.handleY = e.data.getLocalPosition(this).y;
	this.handleUp = function(){this.onHandleUp();}.bind(this)

	document.body.addEventListener('touchend', this.handleUp);
	document.body.addEventListener('mouseup', this.handleUp);
}

/**
 */
GameOverOverlay.prototype.onHandleUp = function()
{
	this.handleActive = false;
	document.body.removeEventListener("mouseup",  this.handleUp);
	document.body.removeEventListener("touchend", this.handleUp);
}

/**
 */
GameOverOverlay.prototype.onHandleMove = function(e)
{
	if(!this.handleActive) return;

	var newY  = e.data.getLocalPosition(this).y;
	var delta = newY - this.handleY;
	this.moveHandle(delta);

	if(this.handleSFXCountdown == 0)
	{
		this.handleSFX = SoundSFX.play("sfx_pulley_down_loop_04", {loop:true});
	}
	this.handleSFXCountdown = 0.2;
}

GameOverOverlay.prototype.moveHandle = function(delta)
{
	if(this._goalsScreen._goalsScroller._handle.y + delta < this.handleMinY)
		delta = this.handleMinY - this._goalsScreen._goalsScroller._handle.y
	else if(this._goalsScreen._goalsScroller._handle.y + delta > this.handleMaxY)
		delta = this.handleMaxY - this._goalsScreen._goalsScroller._handle.y

	this._goalsScreen._goalsScroller._rope.tilePosition.y += delta;
	this._goalsScreen._goalsScroller._handle.y += delta;

	var perc   = (this._goalsScreen._goalsScroller._handle.y - this.handleMinY)/( this.handleMaxY - this.handleMinY);
	var nSteps = this._goalsScreen._goals.length - 4;
	var step   = (perc /(1/(nSteps-1)));

	for(var i = 0; i < this._goalsScreen._goals.length; i++)
	{
		this._goalsScreen._goals[i].y = 100 * (i-step);
	}

	this.handleY += delta;
}


//===================================================
// GETTERS/SETTERS
//===================================================


//===================================================


},{"../Common":2,"../general/NextButton":43,"../general/SoundSFX":44,"../lib/MuteButton":49,"../screens/SimpleScreen":73}],59:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function GenericPopupOverlay(content, callback, scope)
{
    this._content = content;
    this._callback = callback;
    this._scope = scope;

    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = GenericPopupOverlay;
GenericPopupOverlay.prototype = Object.create(SimpleScreen.prototype);
GenericPopupOverlay.prototype.constructor = GenericPopupOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
GenericPopupOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

    var bg = new PIXI.Sprite(Common.generatedTextures['black']);
    bg.width = Common.STAGE_WIDTH;
    bg.height = Common.STAGE_HEIGHT;
    bg.hitArea = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
    bg.interactive = true;
    bg.alpha = 0.75;
    this.addChild(bg);

    var messageBox = new PIXI.Graphics();
    messageBox.beginFill(0xFFFFFF);
    messageBox.drawRect(-300, -200, 600, 400);
    messageBox.x = Common.STAGE_WIDTH / 2;
    messageBox.y = (Common.STAGE_HEIGHT / 2);
    this.addChild(messageBox);

    messageBox.addChild(this._content);

    this._closeButton = new WireframeButton("Close");
    this._closeButton.x = r2l ? -300 : 300;
    this._closeButton.y = -200;
    this._closeButton.signals.clicked.addOnce(this.onCloseClick, this);
    messageBox.addChild(this._closeButton);
};

/**
 */
GenericPopupOverlay.prototype.update = function()
{
};

/**
 */
GenericPopupOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
GenericPopupOverlay.prototype.dispose = function()
{

}

GenericPopupOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);
};

GenericPopupOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

GenericPopupOverlay.prototype.onCloseClick = function()
{
	this._callback.call(this._scope);
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],60:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function GenericPopupOverlay(section)
{
	this._section = section;
    this._closeButton = null;

	this._screenIndex = 0;

	SimpleScreen.call(this);
}

module.exports = GenericPopupOverlay;
GenericPopupOverlay.prototype = Object.create(SimpleScreen.prototype);
GenericPopupOverlay.prototype.constructor = GenericPopupOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
GenericPopupOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);


	// Title
	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["HELP"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor.set(0.5);
			title.y = -6;
			this._title.addChild(title);
		}

	// Content
    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.x = Common.STAGE_WIDTH/2;
	this._messageBox.y = Common.STAGE_HEIGHT/2 + 70;
    this.addChild(this._messageBox);

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onCloseClick, this);
	this._messageBox.addChild(this._closeButton);

	// Help screens
	this._content = [];

	switch(this._section)
	{
		case "splash":
			this._content.push({image:["ui_help_main_menu_bg", "ui_help_main_menu_story"], text:"HELP_MAIN_0"});
			this._content.push({image:["ui_help_main_menu_bg", "ui_help_main_menu_endless"], text:"HELP_MAIN_1"});
			this._content.push({image:["ui_help_main_menu_bg", "ui_help_main_menu_hi_score"], text:"HELP_MAIN_2"});
			this._content.push({image:["ui_help_goals"], text:"HELP_GOALS_0"});
			break;

		case "levelSelect":
			this._content.push({image:["ui_help_map_clean_bg"], text:"HELP_MAP_0"});
			this._content.push({image:["ui_help_map_bg", "ui_help_map_characters"], text:"HELP_MAP_1"});
			this._content.push({image:["ui_help_map_pabbie"], text:"HELP_MAP_2"});
			break;

		case "characterSelect":
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_arrows"], text:"HELP_CHARACTER_0"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_upgrade"], text:"HELP_CHARACTER_1"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_tumble"], text:"HELP_CHARACTER_2"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_magnet"], text:"HELP_CHARACTER_3"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_magic"], text:"HELP_CHARACTER_4"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_crystals"], text:"HELP_CHARACTER_5"});
			this._content.push({image:["ui_tutorial_bg", "ui_tutorial_anna"], text:"HELP_CHARACTER_6"});
			this._content.push({image:["ui_help_characters_bg", "ui_help_characters_crystals"], text:"HELP_CHARACTER_7"});
			break;
	}

	this._screens = [];
	for(var i = 0; i < this._content.length; i++)
	{
		var screen = new PIXI.Container();
		screen.alpha = i == 0 ? 1 : 0;

		for(var m = 0; m < this._content[i].image.length; m++)
		{
			var image = new PIXI.Sprite(this._assetManager.getTexture(this._content[i].image[m]));
			image.anchor.set(0.5);
			image.y = -30;
			screen.addChild(image);
		}

		var copy = this._assetManager.getJSON("strings")[this._content[i].text][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "24px Mikadan White", align: "center", tint: 0x6d38ab});
			text.maxWidth = 620;
			text.updateText();
			text.x = -text.textWidth/2;
			text.y = -text.textHeight/2 + 185;
			screen.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy.replace(/\n/gi, ""), {font:"24px Arial", fill:0x000000, align:'center', wordWrap:true, lineHeight:32, wordWrapWidth:620});
			text.anchor.set(0.5);
			text.y = 180;
			screen.addChild(text);
		}

		this._screens.push(screen);
		this._messageBox.addChild(screen);
	}

	// Prev/Next buttons
	if(this._content.length > 1)
	{
		this._messageBox._leftButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._messageBox._leftButton.overSoundName = "sfx_btn_rollover_00";
		this._messageBox._leftButton.children[1].x = -5;
		this._messageBox._leftButton.children[1].scale.x = -1;
		this._messageBox._leftButton.position.set(-385, 210);
		this._messageBox._leftButton.alpha = 0;
		this._messageBox._leftButton.signals.down.add(this.onPrev, this);
		this._messageBox.addChild(this._messageBox._leftButton);

		this._messageBox._rightButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._messageBox._rightButton.overSoundName = "sfx_btn_rollover_00";
		this._messageBox._rightButton.position.set(385, 210);
		this._messageBox._rightButton.signals.down.add(this.onNext, this);
		this._messageBox.addChild(this._messageBox._rightButton);

		if(r2l)
		{
			this._messageBox._leftButton.scale.set(-1,1);
			this._messageBox._leftButton.position.set(385, 210);
			this._messageBox._rightButton.scale.set(-1,1);
			this._messageBox._rightButton.position.set(-385, 210);
		}
	}

};

/**
 */
GenericPopupOverlay.prototype.update = function()
{
};

/**
 */
GenericPopupOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
GenericPopupOverlay.prototype.dispose = function()
{

}

GenericPopupOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

GenericPopupOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};

/**
 */
GenericPopupOverlay.prototype.onPrev = function()
{
	if(this._screenIndex == 0) return;

	nextScreen = this._screenIndex-1;
	if(nextScreen < 0) nextScreen = this._screens.length -1;

	var tl = new TimelineMax();
		tl.to(this._screens[this._screenIndex],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._screens[nextScreen],           .5, {alpha:1, ease:Sine.easeInOut}, 0);

		if(this._screenIndex == this._screens.length-1)
		{
			tl.to(this._messageBox._rightButton,  .5, {alpha:1, ease:Sine.easeInOut}, 0);
			this._messageBox._rightButton.interactive = true;
		}

		if(nextScreen == 0)
		{
			tl.to(this._messageBox._leftButton,  .5, {alpha:0, ease:Sine.easeInOut}, 0);
			this._messageBox._leftButton.interactive = false;
		}

	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._screenIndex = nextScreen;
}

/**
 */
GenericPopupOverlay.prototype.onNext = function()
{
	if(this._screenIndex == this._screens.length-1) return;

	nextScreen = this._screenIndex+1;
	if(nextScreen >= this._screens.length) nextScreen = 0;

	var tl = new TimelineMax();
		tl.to(this._screens[this._screenIndex],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._screens[nextScreen],           .5, {alpha:1, ease:Sine.easeInOut}, 0);

		if(nextScreen == this._screens.length-1)
		{
			tl.to(this._messageBox._rightButton,  .5, {alpha:0, ease:Sine.easeInOut}, 0);
			this._messageBox._rightButton.interactive = false;
		}

		if(this._screenIndex == 0)
		{
			tl.to(this._messageBox._leftButton,  .5, {alpha:1, ease:Sine.easeInOut}, 0);
			this._messageBox._leftButton.interactive = true;
		}

	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._screenIndex = nextScreen;
}




//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

GenericPopupOverlay.prototype.onCloseClick = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],61:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX             = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function InstructionsOverlay(what)
{
	this._what = what;
    this._closeButton = null;

	this._screenIndex = 0;

	SimpleScreen.call(this);
}

module.exports = InstructionsOverlay;
InstructionsOverlay.prototype = Object.create(SimpleScreen.prototype);
InstructionsOverlay.prototype.constructor = InstructionsOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
InstructionsOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);

	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["HELP"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor.set(0.5);
			title.y = -6;
			this._title.addChild(title);
		}

    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.x = Common.STAGE_WIDTH/2;
	this._messageBox.y = Common.STAGE_HEIGHT/2 + 70;
    this.addChild(this._messageBox);

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onCloseClick, this);
	this._messageBox.addChild(this._closeButton);

	// Help screens
	this._content = [];

	switch(this._what)
	{
		default:
		case "anna":
			if(p3.Device.isMobile)
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_anna", "ui_help_tap_highlight_r", "ui_help_gameplay_hand_r"], text:"HELP_CHARACTER_ANNA_0"});
			else
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_anna","ui_help_gameplay_mouse"], text:"HELP_CHARACTER_ANNA_0"});
			break;

		case "kristoff":
			if(p3.Device.isMobile)
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_kristoff", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_KRISTOFF_0"});
			else
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_kristoff","ui_help_gameplay_enter"], text:"HELP_CHARACTER_KRISTOFF_0"});
			break;

		case "olaf":
			if(p3.Device.isMobile)
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_olaf", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_OLAF_0"});
			else
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_olaf","ui_help_gameplay_enter_olaf"], text:"HELP_CHARACTER_OLAF_0"});
			break;

		case "elsa":
			if(p3.Device.isMobile)
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_elsa", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_ELSA_0"});
			else
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_elsa","ui_help_gameplay_enter"], text:"HELP_CHARACTER_ELSA_0"});
			break;

		case "pabbie":
			if(p3.Device.isMobile)
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_pabbie", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_PABBIE_0"});
			else
				this._content.push({image:["ui_tutorial_bg", "ui_tutorial_pabbie","ui_help_gameplay_enter"], text:"HELP_CHARACTER_PABBIE_0"});
			break;

		case "endless":
			this._content.push({image:["ui_tutorial_bg", "ui_tutorial_distance"], text:"HELP_ENDLESS_0"});
			this._content.push({image:["ui_tutorial_bg", "ui_tutorial_personal_best"], text:"HELP_ENDLESS_1"});
			break;
	}

	this._screens = [];
	for(var i = 0; i < this._content.length; i++)
	{
		var screen = new PIXI.Container();
		// screen.y = -70;
		screen.alpha = i == 0 ? 1 : 0;

		for(var m = 0; m < this._content[i].image.length; m++)
		{
			var image = new PIXI.Sprite(this._assetManager.getTexture(this._content[i].image[m]));
			image.anchor.set(0.5);
			image.y = -30;
			screen.addChild(image);
		};

		var copy = this._assetManager.getJSON("strings")[this._content[i].text][Common.COUNTRY_CODE];
		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "22px Mikadan White", align: "center", tint: 0x6d38ab});
			// text.maxWidth = 650;
			// text.updateText();
			text.x = -text.textWidth/2;
			text.y = -text.textHeight/2 + 180;
			screen.addChild(text);
		}
		else
		{
			var copy = this._assetManager.getJSON("strings")[this._content[i].text][Common.COUNTRY_CODE];
			var text = new PIXI.Text(copy.replace(/\n/gi, ""), {font:"24px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:620});
			text.anchor.set(0.5);
			text.y = 180;
			screen.addChild(text);
		}

		this._screens.push(screen);
		this._messageBox.addChild(screen);
	}

	// Prev/Next buttons
	if(this._content.length > 1)
	{
		this._messageBox._leftButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._messageBox._leftButton.overSoundName = "sfx_btn_rollover_00";
		this._messageBox._leftButton.children[1].x = -5;
		this._messageBox._leftButton.children[1].scale.x = -1;
		this._messageBox._leftButton.position.set(-385, 210);
		this._messageBox._leftButton.alpha = 0;
		this._messageBox._leftButton.signals.down.add(this.onPrev, this);
		this._messageBox.addChild(this._messageBox._leftButton);

		this._messageBox._rightButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._messageBox._rightButton.overSoundName = "sfx_btn_rollover_00";
		this._messageBox._rightButton.position.set(385, 210);
		this._messageBox._rightButton.signals.down.add(this.onNext, this);
		this._messageBox.addChild(this._messageBox._rightButton);
	}

	Common.bgMusic.stop();
	Common.bgMusic.fadeOut(0, 500);
	Common.bgMusic = SoundSFX.play('mx_frozen_04_pause_lp', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);
};

/**
 */
InstructionsOverlay.prototype.update = function()
{
};

/**
 */
InstructionsOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
InstructionsOverlay.prototype.dispose = function()
{

}

InstructionsOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,        .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

InstructionsOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};

/**
 */
InstructionsOverlay.prototype.onPrev = function()
{
	if(this._screenIndex == 0) return;

	nextScreen = this._screenIndex-1;
	if(nextScreen < 0) nextScreen = this._screens.length -1;

	var tl = new TimelineMax();
		tl.to(this._screens[this._screenIndex],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._screens[nextScreen],           .5, {alpha:1, ease:Sine.easeInOut}, 0);

		if(this._screenIndex == this._screens.length-1)
		{
			tl.to(this._messageBox._rightButton,  .5, {alpha:1, ease:Sine.easeInOut}, 0);
			this._messageBox._rightButton.interactive = true;
		}

		if(nextScreen == 0)
		{
			tl.to(this._messageBox._leftButton,  .5, {alpha:0, ease:Sine.easeInOut}, 0);
			this._messageBox._leftButton.interactive = false;
		}

	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._screenIndex = nextScreen;
}

/**
 */
InstructionsOverlay.prototype.onNext = function()
{
	if(this._screenIndex == this._screens.length-1) return;

	nextScreen = this._screenIndex+1;
	if(nextScreen >= this._screens.length) nextScreen = 0;

	var tl = new TimelineMax();
		tl.to(this._screens[this._screenIndex],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._screens[nextScreen],           .5, {alpha:1, ease:Sine.easeInOut}, 0);

		if(nextScreen == this._screens.length-1)
		{
			tl.to(this._messageBox._rightButton,  .5, {alpha:0, ease:Sine.easeInOut}, 0);
			this._messageBox._rightButton.interactive = false;
		}

		if(this._screenIndex == 0)
		{
			tl.to(this._messageBox._leftButton,  .5, {alpha:1, ease:Sine.easeInOut}, 0);
			this._messageBox._leftButton.interactive = true;
		}

	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._screenIndex = nextScreen;
}




//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

InstructionsOverlay.prototype.onCloseClick = function()
{
	Common.savedData.hasSeenTutorial[this._what] = true;
	Common.savedData.save();

	this.animateOut(function()
	{
		this.signals.requestedNextScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],62:[function(require,module,exports){
var Common       = require("../Common");
var SimpleScreen = require("../screens/SimpleScreen");
var NextButton   = require("../general/NextButton");
var SoundSFX     = require("../general/SoundSFX");
var MuteButton   = require("../lib/MuteButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function PauseOverlay(level)
{
	SimpleScreen.call(this);

	this._level = level;
	this.signals.requestedCurrentScreen = new signals.Signal();
}
module.exports = PauseOverlay;
PauseOverlay.prototype = Object.create(SimpleScreen.prototype);
PauseOverlay.prototype.constructor = PauseOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
PauseOverlay.prototype.init = function()
{
	console.log("PAUSE INITIALIZED");

	SimpleScreen.prototype.init.call(this);

	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);

	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor = new PIXI.Point(0.5, 0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["PAUSE"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text("Pause", {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._title.addChild(title);
		}

    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox .anchor = new PIXI.Point(0.5, 0.5);
	this._messageBox .x = Common.STAGE_WIDTH/2;
	this._messageBox .y = Common.STAGE_HEIGHT/2 + 70;
    this.addChild(this._messageBox );

	var closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	closeButton.overSoundName = "sfx_btn_rollover_00";
	closeButton.x = r2l ? -400 : 400;
    closeButton.y = -240;
	closeButton.signals.down.addOnce(this.resumeClicked, this);
	this._messageBox .addChild(closeButton);


	this._mainScreen = new PIXI.Container();
	this._mainScreen.y = -70;
	this._messageBox.addChild(this._mainScreen);


		// Play button
		this._mainScreen._resumeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out_big"),
			this._assetManager.getTexture("ui_btn_nav_over_big"),
			this._assetManager.getTexture("ui_btn_nav_down_big"),
			this._assetManager.getTexture("ui_icon_nav_play")
		);
		this._mainScreen._resumeButton.overSoundName = "sfx_btn_rollover_00";
		this._mainScreen._resumeButton.y = -20;
		this._mainScreen._resumeButton.signals.down.add(this.resumeClicked, this);
		this._mainScreen.addChild(this._mainScreen._resumeButton);

		var image = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_deco_2"));
		image.anchor.set(0.5);
		this._mainScreen._resumeButton.addChild(image);

		// Home button
		this._mainScreen._homeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_home")
		);
		this._mainScreen._homeButton.overSoundName = "sfx_btn_rollover_00";
		this._mainScreen._homeButton.x = -225;
		this._mainScreen._homeButton.y = +180;
		this._mainScreen._homeButton.signals.down.add(this.homeScreenClicked, this);
		this._mainScreen.addChild(this._mainScreen._homeButton);

		// Restart button
		this._mainScreen._restartButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_restart")
		);
		this._mainScreen._restartButton.overSoundName = "sfx_btn_rollover_00";
		this._mainScreen._restartButton.x = -75;
		this._mainScreen._restartButton.y = +180;
		this._mainScreen._restartButton.signals.down.add(this.restartScreenClicked, this);
		this._mainScreen.addChild(this._mainScreen._restartButton);

		// Audio button
		this._mainScreen._muteButton = new p3.MuteButton
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_sound_on"),
			this._assetManager.getTexture("ui_icon_secnav_sound_off")
		);
		this._mainScreen._muteButton.overSoundName = "sfx_btn_rollover_00";
		this._mainScreen._muteButton.id = "mute";
		this._mainScreen._muteButton.x = +75;
		this._mainScreen._muteButton.y = +180;
		// this._mainScreen._muteButton.scale = new PIXI.Point(0, 0);
		// this._muteButton.signals.over.add(this.buttonOver, this);
		this._mainScreen._muteButton.init();
		this._mainScreen.addChild(this._mainScreen._muteButton);

		// Help button
		this._mainScreen._helpButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_secnav_out"),
			this._assetManager.getTexture("ui_btn_secnav_over"),
			this._assetManager.getTexture("ui_btn_secnav_down"),
			this._assetManager.getTexture("ui_icon_secnav_help")
		);
		this._mainScreen._helpButton.overSoundName = "sfx_btn_rollover_00";
		this._mainScreen._helpButton.x = +225;
		this._mainScreen._helpButton.y = +180;
		this._mainScreen._helpButton.signals.down.add(this.helpScreenClicked, this);
		this._mainScreen.addChild(this._mainScreen._helpButton);

	// HOME SCREEN
	this._homeScreen = new PIXI.Container();
	this._homeScreen.y = -70;
	this._homeScreen.visible = false;
	this._homeScreen.alpha = 0;
	this._messageBox.addChild(this._homeScreen);

		var copy = this._assetManager.getJSON("strings")["PAUSE_EXIT"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "36px Mikadan White", align: "center", tint: 0x6d38ab});
			title.x = - title.textWidth/2;
			title.y = - title.textHeight/2;
			this._homeScreen.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._homeScreen.addChild(title);
		}

		// Home confirm button
		this._homeScreen._homeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_tick")
		);
		this._homeScreen._homeButton.overSoundName = "sfx_btn_rollover_00";
		this._homeScreen._homeButton.x = (r2l ? -1 : 1) * 125;
		this._homeScreen._homeButton.y = +160;
		this._homeScreen._homeButton.signals.down.addOnce(this.homeClicked, this);
		this._homeScreen.addChild(this._homeScreen._homeButton);

		// Home cancel button
		this._homeScreen._resumeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_cross")
		);
		this._homeScreen._resumeButton.overSoundName = "sfx_btn_rollover_00";
		this._homeScreen._resumeButton.x = (r2l ? -1 : 1) * -125;
		this._homeScreen._resumeButton.y = +160;
		this._homeScreen._resumeButton.signals.down.addOnce(this.resumeClicked, this);
		this._homeScreen.addChild(this._homeScreen._resumeButton);


	// RESTART SCREEN
	this._restartScreen = new PIXI.Container();
	this._restartScreen.y = -70;
	this._restartScreen.visible = false;
	this._restartScreen.alpha = 0;
	this._messageBox.addChild(this._restartScreen);

		var copy = this._assetManager.getJSON("strings")["PAUSE_RESTART"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "36px Mikadan White", align: "center", tint: 0x6d38ab});
			title.x = - title.textWidth/2;
			title.y = - title.textHeight/2;
			this._restartScreen.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._restartScreen.addChild(title);
		}

		// Restart confirm button
		this._restartScreen._restartButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_tick")
		);
		this._restartScreen._restartButton.overSoundName = "sfx_btn_rollover_00";
		this._restartScreen._restartButton.x = (r2l ? -1 : 1) * 125;
		this._restartScreen._restartButton.y = +160;
		this._restartScreen._restartButton.signals.down.addOnce(this.restartClicked, this);
		this._restartScreen.addChild(this._restartScreen._restartButton);

		// Restart cancel button
		this._restartScreen._resumeButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_cross")
		);
		this._restartScreen._resumeButton.overSoundName = "sfx_btn_rollover_00";
		this._restartScreen._resumeButton.x = (r2l ? -1 : 1) * -125;
		this._restartScreen._resumeButton.y = +160;
		this._restartScreen._resumeButton.signals.down.addOnce(this.resumeClicked, this);
		this._restartScreen.addChild(this._restartScreen._resumeButton);

	// HELP SCREEN
	this._helpScreen = new PIXI.Container();
	this._helpScreen.visible = false;
	this._helpScreen.alpha = 0;
	this._helpScreen.page  = 0;
	this._helpScreen.pages = [];
	this._messageBox.addChild(this._helpScreen);

		// Prev button
		this._helpScreen._prevButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._helpScreen._prevButton.overSoundName = "sfx_btn_rollover_00";
		this._helpScreen._prevButton.x = -387;
		this._helpScreen._prevButton.y = +210;
		this._helpScreen._prevButton.alpha = 0;
		this._helpScreen._prevButton.interactive = false;
		this._helpScreen._prevButton.signals.down.add(this.helpPrevClicked, this);
		this._helpScreen.addChild(this._helpScreen._prevButton);
		this._helpScreen._prevButton.children[1].scale.x = -1;
		this._helpScreen._prevButton.children[1].x = -5;

		// Next button
		this._helpScreen._nextButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out"),
			this._assetManager.getTexture("ui_btn_nav_over"),
			this._assetManager.getTexture("ui_btn_nav_down"),
			this._assetManager.getTexture("ui_icon_nav_arrow")
		);
		this._helpScreen._nextButton.overSoundName = "sfx_btn_rollover_00";
		this._helpScreen._nextButton.x = 387;
		this._helpScreen._nextButton.y = +210;
		this._helpScreen._nextButton.signals.down.add(this.helpNextClicked, this);
		this._helpScreen.addChild(this._helpScreen._nextButton);
		
		if(r2l)
		{
			this._helpScreen._prevButton.scale.set(-1,1);
			this._helpScreen._prevButton.position.set(387, 210);
			this._helpScreen._nextButton.scale.set(-1,1);
			this._helpScreen._nextButton.position.set(-387, 210);
		}		

		// Screens
		this._content = [];
		
		if(p3.Device.isMobile)
			this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_jump", "ui_help_tap_highlight_r", "ui_help_gameplay_hand_r"], text:"HELP_GENERIC_0" + (p3.Device.isMobile ? "_MOB" : "_PC")});
		else
			this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_jump", "ui_help_gameplay_mouse"], text:"HELP_GENERIC_0" + (p3.Device.isMobile ? "_MOB" : "_PC")});
		
		if(p3.Device.isMobile)
			this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_tumble", "ui_help_tap_highlight_r", "ui_help_gameplay_hand_r"], text:"HELP_GENERIC_1" + (p3.Device.isMobile ? "_MOB" : "_PC")});
		else
			this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_tumble","ui_help_gameplay_mouse"], text:"HELP_GENERIC_1" + (p3.Device.isMobile ? "_MOB" : "_PC")});

		switch(Common.savedData.character)
		{
			default:
			case "anna":
				if(p3.Device.isMobile)
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_anna", "ui_help_tap_highlight_r", "ui_help_gameplay_hand_r"], text:"HELP_CHARACTER_ANNA_0"});
				else
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_anna","ui_help_gameplay_mouse"], text:"HELP_CHARACTER_ANNA_0"});
				break;

			case "kristoff":
				if(p3.Device.isMobile)
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_kristoff", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_KRISTOFF_0"});
				else
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_kristoff","ui_help_gameplay_enter"], text:"HELP_CHARACTER_KRISTOFF_0"});
				break;

			case "olaf":
				if(p3.Device.isMobile)
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_olaf", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_OLAF_0"});
				else
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_olaf","ui_help_gameplay_enter_olaf"], text:"HELP_CHARACTER_OLAF_0"});
				break;

			case "elsa":
				if(p3.Device.isMobile)
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_elsa", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_ELSA_0"});
				else
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_elsa","ui_help_gameplay_enter"], text:"HELP_CHARACTER_ELSA_0"});
			break;

			case "pabbie":
				if(p3.Device.isMobile)
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_pabbie", "ui_help_tap_highlight_l", "ui_help_gameplay_hand_l"], text:"HELP_CHARACTER_PABBIE_0"});
				else
					this._content.push({image:["ui_tutorial_bg", "ui_tutorial_pabbie","ui_help_gameplay_enter"], text:"HELP_CHARACTER_PABBIE_0"});
				break;
		}

		this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_sven_sled"], text:"HELP_GENERIC_3"});
		this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_marshmallow"], text:"HELP_GENERIC_4"});

		if(!this._level.endless)
			this._content.push({image:["ui_help_gameplay_bg", "ui_help_gameplay_crystals"], text:"HELP_STORY_0"});




		for(var i = 0; i < this._content.length; i++)
		{
			var page = new PIXI.Container();
			page.alpha = (i == 0) ? 1 : 0;
			this._helpScreen.pages.push(page);
			this._helpScreen.addChild(page);

			for(var m = 0; m < this._content[i].image.length; m++)
			{
				var image = new PIXI.Sprite(this._assetManager.getTexture(this._content[i].image[m]));
				image.anchor.set(0.5);
				image.y = -30;
				page.addChild(image);
			}

			var copy = this._assetManager.getJSON("strings")[this._content[i].text][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "22px Mikadan White", align: "center", tint: 0x6d38ab});
				// text.maxWidth = 620;
				// text.updateText();
				text.x = -text.textWidth/2;
				text.y = -text.textHeight/2 + 180;
				page.addChild(text);
			}
			else
			{
				var copy = this._assetManager.getJSON("strings")[this._content[i].text][Common.COUNTRY_CODE];
				var text = new PIXI.Text(copy.replace(/\n/gi, ""), {font:"24px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:620});
				text.anchor.set(0.5);
				text.y = 180;
				page.addChild(text);
			}
		}

	// this._char = new PIXI.Sprite(this._assetManager.getTexture("ui_char_" + Common.savedData.character));
	// this._char.anchor.set(0.5, 1);
	// this._char.x = Common.STAGE_WIDTH/2 - 390;
	// this._char.y = Common.STAGE_HEIGHT;
	// this._char.visible = false;
	// this._char.scale.x = -1;
	// this.addChild(this._char);

	Common.bgMusic.fadeOut(0, 500);
	Common.bgMusic = SoundSFX.play('mx_frozen_04_pause_lp', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);
};

/**
 */
PauseOverlay.prototype.update = function()
{
	// this._exitButton.x = this._getFirstButtonPositionLeft();
	// this._muteButton.x = this._getFirstButtonPositionRight();
};

/**
 */
PauseOverlay.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);
};

/**
 */
PauseOverlay.prototype.dispose = function()
{

}

/**
 */
 /*
PauseOverlay.prototype.setIntroHelpMode = function()
{
	if(Common.savedData.hasViewedInstructions) return;

	if(this._contents.length > 1 )
	{
		this._resumeButton.visible = false;
	}
    this._introHelpMode = true;
}*/

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
PauseOverlay.prototype.animateIn = function(callback, scope)
{
	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._mainScreen._resumeButton.scale = new PIXI.Point(0,0);
	this._mainScreen._homeButton.scale = new PIXI.Point(0,0);
	this._mainScreen._restartButton.scale = new PIXI.Point(0,0);
	this._mainScreen._muteButton.scale = new PIXI.Point(0,0);
	this._mainScreen._helpButton.scale = new PIXI.Point(0,0);

	var tl = new TimelineMax();

		tl.to(this._bg,          .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0);

		tl.to(this._messageBox.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0);
			tl.to(this._mainScreen._resumeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.3);
			tl.to(this._mainScreen._homeButton.scale,    .5, {x:1, y:1, ease:Back.easeOut}, 0.5);
			tl.to(this._mainScreen._restartButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
			tl.to(this._mainScreen._muteButton.scale,    .5, {x:1, y:1, ease:Back.easeOut}, 0.7);
			tl.to(this._mainScreen._helpButton.scale,    .5, {x:1, y:1, ease:Back.easeOut}, 0.8);

		// tl.to(this._char,         .5, {alpha:1, x: this._char.x, ease:Sine.EaseIn}, 0.1);

	Common.animator.add(tl);

	// this._char.x = 0;
	// this._char.alpha = 0;
};


/**
 * @param {Function=} callback
 * @param {*=} scope
 */
PauseOverlay.prototype.animateOut = function(callback, scope)
{
	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn}, 0);
		// tl.to(this._char,             .5, {alpha:0, x: 0, ease:Sine.EaseIn},0);
	Common.animator.add(tl);

	Common.bgMusic.fadeOut(0, 500);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
PauseOverlay.prototype.exitGame = function(callback, scope)
{
	// var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		// tl.to(this._overlay, .5, {alpha:1, ease:Sine.easeIn}, 0);
	// Common.animator.add(tl);
	if(callback) callback.call(scope);
};



//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================


/**
 */
PauseOverlay.prototype.resumeClicked = function()
{
	this.animateOut(function()
	{
		this.signals.requestedNextScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
};

/**
 */
PauseOverlay.prototype.homeScreenClicked = function()
{
	var tl = new TimelineMax();
		tl.to(this._mainScreen, 0.25, {alpha:0, ease:Sine.EaseIn, onCompleteScope:this, onComplete:function(){this._homeScreen.visible = true; this._mainScreen.visible = false;}}, 0);
		tl.to(this._homeScreen, 0.25, {alpha:1, ease:Sine.EaseOut});
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");
};

/**
 */
PauseOverlay.prototype.restartScreenClicked = function()
{
	var tl = new TimelineMax();
		tl.to(this._mainScreen,    0.25, {alpha:0, ease:Sine.EaseIn, onCompleteScope:this, onComplete:function(){this._restartScreen.visible = true; this._mainScreen.visible = false;}}, 0);
		tl.to(this._restartScreen, 0.25, {alpha:1, ease:Sine.EaseOut});
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");
};

/**
 */
PauseOverlay.prototype.helpScreenClicked = function()
{
	var tl = new TimelineMax();
		tl.to(this._mainScreen, 0.25, {alpha:0, ease:Sine.EaseIn, onCompleteScope:this, onComplete:function(){this._helpScreen.visible = true; this._mainScreen.visible = false;}}, 0);
		tl.to(this._helpScreen, 0.25, {alpha:1, ease:Sine.EaseOut});
		// tl.to(this._char, 0.5, {alpha:0, x: 0, ease:Sine.EaseIn},0);
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");
};


/**
 */
PauseOverlay.prototype.homeClicked = function()
{
	this.exitGame(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
};


/**
 */
PauseOverlay.prototype.restartClicked = function()
{
	this.exitGame(function()
	{
		this.signals.requestedCurrentScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
};

/**
 */
PauseOverlay.prototype.helpPrevClicked = function()
{
	if(this._helpScreen.page == 0) return;

	SoundSFX.play("sfx_btn_press_00");

	var tl = new TimelineMax();

		tl.to(this._helpScreen.pages[this._helpScreen.page], 0.5, {alpha:0, ease:Sine.EaseInOut}, 0);
		tl.to(this._helpScreen.pages[this._helpScreen.page-1], 0.5, {alpha:1, ease:Sine.EaseInOut}, 0);

		if(this._helpScreen.page == this._helpScreen.pages.length-1)
		{
			tl.to(this._helpScreen._nextButton, 0.5, {alpha:1, ease:Sine.EaseInOut, onCompleteScope:this._helpScreen._nextButton, onComplete:function(){this.interactive = true}}, 0);
		}
		else if(this._helpScreen.page == 1)
		{
			this._helpScreen._prevButton.interactive = false;
			tl.to(this._helpScreen._prevButton, 0.5, {alpha:0, ease:Sine.EaseInOut}, 0);
		}

	Common.animator.add(tl);

	this._helpScreen.page--;
};

/**
 */
PauseOverlay.prototype.helpNextClicked = function()
{
	if(this._helpScreen.page == this._helpScreen.pages.length-1) return;

	SoundSFX.play("sfx_btn_press_00");

	var tl = new TimelineMax();

		tl.to(this._helpScreen.pages[this._helpScreen.page], 0.5, {alpha:0, ease:Sine.EaseInOut}, 0);
		tl.to(this._helpScreen.pages[this._helpScreen.page+1], 0.5, {alpha:1, ease:Sine.EaseInOut}, 0);

		if(this._helpScreen.page == 0)
		{
			tl.to(this._helpScreen._prevButton, 0.5, {alpha:1, ease:Sine.EaseInOut, onCompleteScope:this._helpScreen._prevButton, onComplete:function(){this.interactive = true}}, 0);
		}
		else if(this._helpScreen.page == this._helpScreen.pages.length-2)
		{
			this._helpScreen._nextButton.interactive = false;
			tl.to(this._helpScreen._nextButton, 0.5, {alpha:0, ease:Sine.EaseInOut}, 0);
		}

	Common.animator.add(tl);

	this._helpScreen.page++;

};




//===================================================
// GETTERS/SETTERS
//===================================================


//===================================================


},{"../Common":2,"../general/NextButton":43,"../general/SoundSFX":44,"../lib/MuteButton":49,"../screens/SimpleScreen":73}],63:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function PowerupPurchaseOverlay(previousScreen, cost)
{
	this._prevScreen  = previousScreen;
	this._cost        = cost;
    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = PowerupPurchaseOverlay;
PowerupPurchaseOverlay.prototype = Object.create(SimpleScreen.prototype);
PowerupPurchaseOverlay.prototype.constructor = PowerupPurchaseOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Initialization
 */
PowerupPurchaseOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Bg
	this._bg = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._bg.alpha       = 0.75;
	this._bg.width       = Common.STAGE_WIDTH;
	this._bg.height      = Common.STAGE_HEIGHT;
	this._bg.hitArea     = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.interactive = true;
	this.addChild(this._bg);

	// Panel background
    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
    this.addChild(this._messageBox);

		var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_snowflakes_bg"));
		bg.anchor.set(0.5);
		bg.position.set(0, -40);
		this._messageBox.addChild(bg);

		// Cost
		var copy = "-" + this._cost;
		
		var text = new PIXI.extras.BitmapText(copy, {font: "56px Superclarendon Numbers", align: "center"});	
		text.x = - text.textWidth/2 - 10;
		text.y = - text.textHeight/2 - 62;
		this._messageBox.addChild(text);

		// var text = new PIXI.Text("-" + this._cost, {font:"48px Arial", fill:0x000000, align:'center'});
		// text.anchor.set(0.5);
		// text.position.set(-10, -65);
		// this._messageBox.addChild(text);
	

		// Are you sure?
		var copy = this._assetManager.getJSON("strings")["ARE_YOU_SURE"][Common.COUNTRY_CODE];
		
		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "40px Mikadan White", align: "center", tint: 0x6d38ab});	
			text.x = - text.textWidth/2;
			text.y = - text.textHeight/2 + 100;
			this._messageBox.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			text.anchor.set(0.5);
			text.position.set(0, 90);
			this._messageBox.addChild(text);
		}

	// Cancel button
	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_nav_out"),
		this._assetManager.getTexture("ui_btn_nav_over"),
		this._assetManager.getTexture("ui_btn_nav_down"),
		this._assetManager.getTexture("ui_icon_nav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.position.set(-150, 200);
	this._closeButton.signals.down.addOnce(this.onCloseClick, this);
	this._messageBox.addChild(this._closeButton);

	// Confirm button
	this._buyButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_nav_out"),
		this._assetManager.getTexture("ui_btn_nav_over"),
		this._assetManager.getTexture("ui_btn_nav_down"),
		this._assetManager.getTexture("ui_icon_nav_tick")
	);
	this._buyButton.overSoundName = "sfx_btn_rollover_00";
	this._buyButton.position.set(150, 200);
	this._buyButton.signals.down.addOnce(this.onBuyClick, this);
	this._messageBox.addChild(this._buyButton);
};

/**
 */
PowerupPurchaseOverlay.prototype.update = function()
{
};

/**
 */
PowerupPurchaseOverlay.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);
};

/**
 */
PowerupPurchaseOverlay.prototype.dispose = function()
{
}

/**
 */
PowerupPurchaseOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._bg.alpha = 0;
	this._messageBox.scale.set(0);
	this._closeButton.scale.set(0);
	this._buyButton.scale.set(0);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                 .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0.5);
		tl.to(this._buyButton.scale,    .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

/**
 */
PowerupPurchaseOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};

//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

/**
 * Purchase cancel
 */
PowerupPurchaseOverlay.prototype.onCloseClick = function()
{	
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);
	
	SoundSFX.play("sfx_btn_press_00");	
}


/**
 * Purchase confirm
 */
PowerupPurchaseOverlay.prototype.onBuyClick = function()
{
	this._prevScreen.buy();

	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);
	
	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],64:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");
var SoundSFX            = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function PromoOverlay()
{
	SimpleScreen.call(this);

	// Pick one promo at random
	this._promoData = Common.savedData.getNewPromo();

	this.signals.linkClick = new signals.Signal();
}

module.exports = PromoOverlay;
PromoOverlay.prototype = Object.create(SimpleScreen.prototype);
PromoOverlay.prototype.constructor = PromoOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
PromoOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._bg.alpha   = 0.75;
	this._bg.width   = Common.STAGE_WIDTH;
	this._bg.height  = Common.STAGE_HEIGHT;
	this._bg.hitArea = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.tint    = 0x2c3a66;
	this._bg.interactive = true;
	this.addChild(this._bg);

	// Title
	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._promoData.title;

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._title.addChild(title);
		}

	// Panel background
    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2 + 70);
    this.addChild(this._messageBox);

	// this._messageBox.y -= 70;

		var promo = new PIXI.Container();
		this._messageBox.addChild(promo);

		promo.image = new PIXI.Sprite(PIXI.Texture.fromImage('assets/images/hd/comms/' + this._promoData.image));
		promo.image.anchor.set(0.5, 0);
		promo.image.y = -205;
		promo.image.interactive = true;
		promo.image.buttonMode = true;
		promo.addChild(promo.image);

		promo.image.touchstart = promo.image.mousedown = function(e)
		{
			this.onPromoClick();
		}.bind(this);

		var copy = this._promoData.text;

		if(!webfont)
		{
			promo.text = new PIXI.extras.BitmapText(copy, {font: "28px Mikadan White", align: "center", tint: 0x6d38ab});
			promo.text.maxWidth = 620;
			promo.text.updateText();
			promo.text.x = -promo.text.textWidth/2;
			promo.text.y = -promo.text.textHeight/2 + 170;
			promo.addChild(promo.text);
		}
		else
		{
			promo.text = new PIXI.Text(this._promoData.text, {font:"28px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:540});
			promo.text.anchor.set(0.5);
			promo.text.y = 170;
			promo.addChild(promo.text);
		}

		// promo.link = new PIXI.Text(this._promoData.url.replace("https://", "").replace("http://", ""), {font:"28px Arial", fill:0x000000, align:'center', wordWrap:true, wordWrapWidth:400});
		// promo.link.anchor.set(0.5);
		// promo.link.y = 192;
		// promo.link.interactive = true;
		// promo.link.buttonMode = true;
		// promo.addChild(promo.link);

		// promo.link.touchstart = promo.link.mousedown = function(e)
		// {
			// this.onPromoClick();
		// }.bind(this);

		// this._linkButton = new p3.Button
		// (
			// this._assetManager.getTexture("ui_btn_nav_out"),
			// this._assetManager.getTexture("ui_btn_nav_over"),
			// this._assetManager.getTexture("ui_btn_nav_down"),
			// this._assetManager.getTexture("ui_icon_nav_arrow")
		// );
		// this._linkButton.overSoundName = "sfx_btn_rollover_00";
		// this._linkButton.position.set(330, 100);
		// this._linkButton.signals.up.add(this.onPromoClick, this);
		// promo.addChild(this._linkButton);

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.overSoundName = "sfx_btn_rollover_00";
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onClose, this);
	this._messageBox.addChild(this._closeButton);

	this._messageBox.scale.set(0);
	this._closeButton.scale.set(0);

	// Don't show again
	Common.savedData.setPromoAsShown(this._promoData);
	Common.savedData.save();
};

/**
 */
PromoOverlay.prototype.update = function()
{
};

/**
 */
PromoOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
PromoOverlay.prototype.dispose = function()
{

}

PromoOverlay.prototype.animateIn = function(callback, scope)
{
	// Dirty fix
	if(!!this.shown) return;
	this.shown = true;

	SimpleScreen.prototype.animateIn.call(this);

	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	this._bg.alpha = 0;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,       .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

PromoOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};


/**
 */
PromoOverlay.prototype.onPromoClick = function()
{
	// Event Tracking
	// Common.ctow.trackEvent(
	// {
		// event      : "game_action",
		// game_tier1 : "com_screen",
		// game_tier2 : "slide" + (this._currentcomm+1)
	// });

	// Open a new window
	// var win = window.open(this._promoData.url, '_system');
	// win.focus();

	this.signals.linkClick.dispatch(this._promoData.url, !!this._promoData.disney);
	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

PromoOverlay.prototype.onClose = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);

	SoundSFX.play("sfx_btn_press_00");
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],65:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("../screens/SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function RewardOverlay(content, callback, scope)
{
    this._content = content;
    this._callback = callback;
    this._scope = scope;

    this._closeButton = null;

	SimpleScreen.call(this);
}

module.exports = RewardOverlay;
RewardOverlay.prototype = Object.create(SimpleScreen.prototype);
RewardOverlay.prototype.constructor = RewardOverlay;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
RewardOverlay.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._bg.alpha   = 0.75;
	this._bg.width   = Common.STAGE_WIDTH;
	this._bg.height  = Common.STAGE_HEIGHT;
	this._bg.hitArea = new PIXI.Rectangle(0, 0, Common.STAGE_WIDTH, Common.STAGE_HEIGHT);
	this._bg.tint    = 0x2c3a66;
	this._bg.interactive = true;
	this.addChild(this._bg);

	// Title
	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor.set(0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy = this._assetManager.getJSON("strings")["SURPRISE"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor.set(0.5);
			title.y = -6;
			this._title.addChild(title);
		}

	// Panel background
    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2 + 70);
    this.addChild(this._messageBox);

		var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_snowflakes_bg"));
		bg.anchor.set(0.5);
		bg.position.set(0, -40);
		this._messageBox.addChild(bg);

		this._messageBox.value = new PIXI.extras.BitmapText("" + this._assetManager.getJSON("config").lossStreak.reward, {font: "56px Superclarendon Numbers", align: "center"});
		this._messageBox.value.x = - this._messageBox.value.textWidth/2;
		this._messageBox.value.y = - this._messageBox.value.textHeight/2 - 62;
		this._messageBox.addChild(this._messageBox.value);

		var copy = this._assetManager.getJSON("strings")["REWARD_MESSAGE"][Common.COUNTRY_CODE];
		copy = copy.replace("{value}", this._assetManager.getJSON("config").lossStreak.reward);

		if(!webfont)
		{
			this._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "36px Superclarendon Title Purple", align: "center"});
			this._messageBox.message.x = - this._messageBox.message.textWidth/2;
			this._messageBox.message.y = - this._messageBox.message.textHeight/2 + 140;
			this._messageBox.addChild(this._messageBox.message);
		}
		else
		{
			this._messageBox.message = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			this._messageBox.message.anchor.set(0.5);
			this._messageBox.message.position.set(0, 150);
			this._messageBox.addChild(this._messageBox.message);
		}


	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.x = r2l ? -400 : 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onClose, this);
	this._messageBox .addChild(this._closeButton);

	this._messageBox.scale.set(0);
	this._closeButton.scale.set(0);

	// Actual reward
	Common.savedData.coins += this._assetManager.getJSON("config").lossStreak.reward;
	Common.savedData.lossStreak.awarded = true;
	Common.savedData.save();
};

/**
 */
RewardOverlay.prototype.update = function()
{
};

/**
 */
RewardOverlay.prototype.resize = function()
{

	SimpleScreen.prototype.resize.call(this);
};

/**
 */
RewardOverlay.prototype.dispose = function()
{

}

RewardOverlay.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	this._title.scale = new PIXI.Point(0,0);
	this._messageBox.scale = new PIXI.Point(0,0);
	this._closeButton.scale = new PIXI.Point(0,0);

	this._bg.alpha = 0;

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,                .5, {alpha:0.75, ease:Sine.easeOut}, 0);
		tl.to(this._title.scale,       .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._messageBox.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 0);
		tl.to(this._closeButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 0.6);
	Common.animator.add(tl);
};

RewardOverlay.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._bg,               .5, {alpha:0, ease:Sine.easeIn},  0);
		tl.to(this._title.scale,      .5, {x:0, y:0, ease:Back.easeIn}, 0);
		tl.to(this._messageBox.scale, .5, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

RewardOverlay.prototype.onClose = function()
{
	this.animateOut(function()
	{
		this.signals.requestedPreviousScreen.dispatch();
	}, this);
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/WireframeButton":45,"../screens/SimpleScreen":73}],66:[function(require,module,exports){
var Common       		 = require("../Common");
var SimpleScreen 		 = require("./SimpleScreen");
var WireframeButton 	 = require("../general/WireframeButton");
var CharacterSelectPanel = require("../general/CharacterSelectPanel");
var SoundSFX             = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function CharacterSelectScreen(level)
{
	this._level = !!level ? level : 0;

	this._characterHolder  = null;
	this._characterPanels  = [];
    this._currentCharacter = 0;
	this._isAnimating = false;

    this._leftButton    = null;
    this._rightButton   = null;

	SimpleScreen.call(this);

	this.signals.buyPressed = new signals.Signal();
	this.signals.characterUnlocked = new signals.Signal();
}

module.exports = CharacterSelectScreen;
CharacterSelectScreen.prototype = Object.create(SimpleScreen.prototype);
CharacterSelectScreen.prototype.constructor = CharacterSelectScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 * Initialization
 */
CharacterSelectScreen.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Show unlocked character
	// Common.savedData.showUnlockedCharacter = "olaf"; // DEBUG
	if(!!Common.savedData.showUnlockedCharacter)
	{
		Common.savedData.character = Common.savedData.showUnlockedCharacter;
		Common.animator.setTimeout(function()
		{
			this.signals.characterUnlocked.dispatch(Common.savedData.showUnlockedCharacter);
			Common.savedData.showUnlockedCharacter = null;
			Common.savedData.save();
		},0.8, this)
	}

	// Background
	this._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_bg_characters"));
    this.addChild(this._bg);

	// Character panels
    this._characterHolder = new PIXI.Container();
    this._characterHolder.x = Common.STAGE_WIDTH / 2;
    this._characterHolder.y = (Common.STAGE_HEIGHT / 2) + 40;
    this.addChild(this._characterHolder);

	this._playableCharacters = this._assetManager.getJSON("config").playableCharacters;
	this._characterData      = $.extend(true, this._assetManager.getJSON("config").characters, this._assetManager.getJSON("strings").characters);

	for(var i = 0; i < this._playableCharacters.length; i++)
	{
		if(!Common.savedData.charactersUnlocked[this._playableCharacters[i]]) break;

		var characterPanel = new CharacterSelectPanel(this, this._characterData[this._playableCharacters[i]]);
		this._characterHolder.addChild(characterPanel);

		// Set the current character as default
		if(this._playableCharacters[i] == Common.savedData.character)
		{
			this._currentCharacter = i;
		}
		else
		{
			characterPanel.alpha = 0;
			characterPanel.visible = false;
		}

		this._characterPanels.push(characterPanel);
	}

	// Title (character name)
	if(!webfont)
	{
		this._title = new PIXI.extras.BitmapText(this._characterData[Common.savedData.character].name[Common.COUNTRY_CODE], {font: "64px Superclarendon Title", align: "center"});
		this._title.x = - this._title.textWidth/2  + Common.STAGE_WIDTH/2;
		this._title.y = - this._title.textHeight/2 + 100;
		this.addChild(this._title);
	}
	else
	{
		this._title = new PIXI.Text(this._characterData[Common.savedData.character].name[Common.COUNTRY_CODE], {font:"60px Arial", fill:0xffffff, align:'center'});
		this._title.position.set(Common.STAGE_WIDTH / 2, 100);
		this._title.anchor.set(0.5);
		this.addChild(this._title);
	}

	// Coins
	this.initCoinCointainer();

	// Left/right button - if more than one character has been unlocked
	if(Common.savedData.getUnlockedCharacterCount() > 1)
	{
		this._leftButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_sidenav_out"),
			this._assetManager.getTexture("ui_btn_sidenav_over"),
			this._assetManager.getTexture("ui_btn_sidenav_down"),
			this._assetManager.getTexture("ui_icon_sidenav_arrow")
		);
		this._leftButton.children[0].anchor.set(0, 0.5);
		this._leftButton.children[1].anchor.set(0, 0.5);
		this._leftButton.y = Common.STAGE_HEIGHT / 2;
		this._leftButton.signals.down.add(this.onLeftDown, this);
		this._leftButton.overSoundName = "sfx_btn_rollover_00";
		this.addChild(this._leftButton);

		this._rightButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_sidenav_out"),
			this._assetManager.getTexture("ui_btn_sidenav_over"),
			this._assetManager.getTexture("ui_btn_sidenav_down"),
			this._assetManager.getTexture("ui_icon_sidenav_arrow")
		);
		this._rightButton.scale.x = -1;
		this._rightButton.children[0].anchor.set(0, 0.5);
		this._rightButton.children[1].anchor.set(0, 0.5);
		this._rightButton.y = Common.STAGE_HEIGHT / 2;
		this._rightButton.signals.down.add(this.onRightDown, this);
		this._rightButton.overSoundName = "sfx_btn_rollover_00";
		this.addChild(this._rightButton);
	}


	// UI

	// Play button
	this._playButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_nav_out_big"),
		this._assetManager.getTexture("ui_btn_nav_over_big"),
		this._assetManager.getTexture("ui_btn_nav_down_big"),
		this._assetManager.getTexture("ui_icon_nav_play")
	);
	this._playButton.y = Common.STAGE_HEIGHT-120;
	this._playButton.signals.down.add(this.onPlayPressed, this);
	this._playButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._playButton);

	// Back button
	this._backButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_back")
	);
	this._backButton.y = this._guiButtonTopMargin;
	this._backButton.scale = new PIXI.Point(1, 1);
	this._backButton.signals.down.add(this.onBackPressed, this);
	this._backButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._backButton);

	// Help button
	this._helpButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_help")
	);
	this._helpButton.y = this._guiButtonTopMargin;
	this._helpButton.signals.down.add(this.onHelpPressed, this);
	this._helpButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._helpButton);

	// Mute button
	this._muteButton = new p3.MuteButton
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_sound_on"),
		this._assetManager.getTexture("ui_icon_con_sound_off")
	);
	this._muteButton.overSoundName = "sfx_btn_rollover_00";
	this._muteButton.id = "mute";
	this._muteButton.y = this._guiButtonTopMargin;
	this._muteButton.init();
	this.addChild(this._muteButton);

	// Music
	if(!!Common.bgMusic) Common.bgMusic.fadeOut(0, 500);
	Common.bgMusic = SoundSFX.play('mx_frozen_02_character_selection', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);
};

/**
 */
CharacterSelectScreen.prototype.update = function()
{
	this._characterPanels[this._currentCharacter].upgradePS.update(p3.Timestep.deltaTime);
};

/**
 */
CharacterSelectScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);

	if(!!this._leftButton)
		this._leftButton.x  = this._getBorderButtonPositionLeft();
	if(!!this._rightButton)
		this._rightButton.x = this._getBorderButtonPositionRight();
	this._backButton.x  = this._getFirstButtonPositionLeft();
	this._muteButton.x  = this._getFirstButtonPositionRight();
	this._helpButton.x  = this._getSecondButtonPositionRight();
	// this._playButton.x  = r2l ? (this._getFirstButtonPositionLeft()+30) : (this._getFirstButtonPositionRight()-30);
	this._playButton.x = this._getFirstButtonPositionRight()-30;
};

/**
 */
CharacterSelectScreen.prototype.dispose = function()
{

}

/**
 */
CharacterSelectScreen.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);
};

/**
 */
CharacterSelectScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);
};

//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

/**
 * Show the previous character
 */
CharacterSelectScreen.prototype.onLeftDown = function()
{
	if(this._isAnimating) return;
	this._isAnimating = true;

	if(!r2l)
	{
		var nextCharacter =  this._currentCharacter-1;
		if(nextCharacter < 0)
			nextCharacter = this._characterPanels.length-1;
	}
	else
	{
		var nextCharacter =  this._currentCharacter+1;
		if(nextCharacter >= this._characterPanels.length)
			nextCharacter = 0;
	}

	this._characterPanels[nextCharacter].x = -p3.View.width;
	this._characterPanels[nextCharacter].visible = true;

	this._characterPanels[this._currentCharacter].closeSubPanel();

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function()
		{
			this._characterPanels[this._currentCharacter].visible = false;
			this._currentCharacter = nextCharacter;
			this._isAnimating = false;
		}
	});
	tl.to(this._characterPanels[this._currentCharacter],  .5, {x:+p3.View.width, alpha:0, ease:Sine.easeInOut}, 0);
	tl.to(this._characterPanels[nextCharacter],  .5, {x:0, alpha:1, ease:Sine.easeInOut}, 0);
	Common.animator.add(tl);

	var tl = new TimelineMax();
	tl.to(this._title,  .25, {alpha:0, ease:Sine.easeInOut, onCompleteScope:this, onComplete:function()
	{
		this._title.x += this._title.textWidth/2;
		this._title.text = this._characterData[this._playableCharacters[nextCharacter]].name[Common.COUNTRY_CODE];
		this._title.validate(); // Forces the text to update the sizes
		this._title.x -= this._title.textWidth/2;
	}}, 0);
	tl.to(this._title,  .25, {alpha:1, ease:Sine.easeInOut});
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	Common.savedData.character = this._characterData[this._playableCharacters[nextCharacter]].id;
}

/**
 * Show the next character
 */
CharacterSelectScreen.prototype.onRightDown = function()
{
	if(this._isAnimating) return;
	this._isAnimating = true;

	if(!r2l)
	{
		var nextCharacter =  this._currentCharacter+1;
		if(nextCharacter >= this._characterPanels.length)
			nextCharacter = 0;
	}
	else
	{
		var nextCharacter =  this._currentCharacter-1;
		if(nextCharacter < 0)
			nextCharacter = this._characterPanels.length-1;
	}

	this._characterPanels[nextCharacter].x = p3.View.width;
	this._characterPanels[nextCharacter].visible = true;

	this._characterPanels[this._currentCharacter].closeSubPanel();

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function()
		{
			this._characterPanels[this._currentCharacter].visible = false;
			this._currentCharacter = nextCharacter;
			this._isAnimating = false;
		}
	});
	tl.to(this._characterPanels[this._currentCharacter],  .5, {x:-p3.View.width, alpha:0, ease:Sine.easeInOut}, 0);
	tl.to(this._characterPanels[nextCharacter],  .5, {x:0, alpha:1, ease:Sine.easeInOut}, 0);
	Common.animator.add(tl);

	var tl = new TimelineMax();
	tl.to(this._title,  .25, {alpha:0, ease:Sine.easeInOut, onCompleteScope:this, onComplete:function()
	{
		if(!webfont)
		{
			this._title.x += this._title.textWidth/2;
			this._title.text = this._characterData[this._playableCharacters[nextCharacter]].name[Common.COUNTRY_CODE];
			this._title.validate();
			this._title.x -= this._title.textWidth/2;
		}
		else
		{
			this._title.text = this._characterData[this._playableCharacters[nextCharacter]].name[Common.COUNTRY_CODE];
		}
	}}, 0);
	tl.to(this._title,  .25, {alpha:1, ease:Sine.easeInOut});
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	Common.savedData.character = this._characterData[this._playableCharacters[nextCharacter]].id;
}

/**
 * Return to the previous screen
 */
CharacterSelectScreen.prototype.onBackPressed = function()
{
	this.signals.requestedPreviousScreen.dispatch("back");

	SoundSFX.play("sfx_btn_press_00");
};

/**
 * Show the help overlay
 */
CharacterSelectScreen.prototype.onHelpPressed = function(e)
{
	this.signals.GUIButtonClicked.dispatch("help");
	SoundSFX.play("sfx_btn_press_00");
}

/**
 * Start the level
 */
CharacterSelectScreen.prototype.onPlayPressed = function()
{
	this.signals.requestedNextScreen.dispatch();

	// Music end
	Common.bgMusic.fadeOut(0, 600);

	SoundSFX.play("sfx_btn_press_00");
}


//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/CharacterSelectPanel":40,"../general/SoundSFX":44,"../general/WireframeButton":45,"./SimpleScreen":73}],67:[function(require,module,exports){
var Common       		= require("../Common");
var SimpleScreen 		= require("./SimpleScreen");
var WireframeButton 	= require("../general/WireframeButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function DailyBonusScreen()
{
	this._snowFlakePrizes = null;

	SimpleScreen.call(this);

	this.signals.prizeSelected = new signals.Signal();
}

module.exports = DailyBonusScreen;
DailyBonusScreen.prototype = Object.create(SimpleScreen.prototype);
DailyBonusScreen.prototype.constructor = DailyBonusScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
DailyBonusScreen.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_bg_daily_bonus"));
    this.addChild(this._bg);

	// Title
	this._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
	this._title.anchor = new PIXI.Point(0.5, 0.5);
	this._title.x = Common.STAGE_WIDTH/2;
	this._title.y = 100;
	this.addChild(this._title);

		var copy  = this._assetManager.getJSON("strings")["DAILY_BONUS"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var title = new PIXI.extras.BitmapText(copy, {font: "42px Superclarendon Title Purple", align: "center"});
			title.x = -title.textWidth/2;
			title.y = -title.textHeight/2 - 4;
			this._title.addChild(title);
		}
		else
		{
			var title = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			title.anchor = new PIXI.Point(0.5, 0.5);
			title.y = -6;
			this._title.addChild(title);
		}

	var copy = this._assetManager.getJSON("strings")["DAILY_BONUS_DESC"][Common.COUNTRY_CODE];

	if(!webfont)
	{
		this._description  = new PIXI.extras.BitmapText(copy, {font: "28px Mikadan Title", align: "center"});
		this._description .x = -this._description.textWidth/2  + Common.STAGE_WIDTH / 2;
		this._description .y = -this._description.textHeight/2 + (Common.STAGE_HEIGHT / 2) - 190;
		this.addChild(this._description);
	}
	else
	{
		this._description = new PIXI.Text(copy, {font:"30px Arial", fill:0xFFFFFF, align:'center'});
		this._description.anchor.x = 0.5;
		this._description.x = Common.STAGE_WIDTH / 2;
		this._description.y = (Common.STAGE_HEIGHT / 2) - 220;
		this.addChild(this._description);
	}

	// Snowflakes
    this._snowflakeHolder = new PIXI.Container();
    this._snowflakeHolder.position.set(Common.STAGE_WIDTH / 2, Common.STAGE_HEIGHT / 2 + 50);
    this.addChild(this._snowflakeHolder);

    var snowflakePrizes  = this._assetManager.getJSON("config").dailyBonus;
	var randomPrizeIndex = Math.floor(Math.random() * snowflakePrizes.length);
	this._snowflakes = [];

	var coords =
	[
		{x : -220, y: -100},
		{x : 0,    y: -50},
		{x : 250,  y: -75},
		{x : -290, y: 140},
		{x : 50,   y: 180},
		{x : 300,  y: 150}
	]

    for(var i = 0; i < 6; i++)
    {
    	var snowflake = new PIXI.Container();
		snowflake.position = coords[i];
		snowflake.scale.set(0);
		snowflake.prize = snowflakePrizes[(randomPrizeIndex + i) % snowflakePrizes.length];

		snowflake.sprite = new PIXI.Sprite(this._assetManager.getTexture("ui_bonus_snowflake_" + (i+1)));
		snowflake.sprite.anchor.set(0.5);
		snowflake.addChild(snowflake.sprite);

		this._snowflakeHolder.addChild(snowflake);
		this._snowflakes.push(snowflake);

		snowflake.text = new PIXI.extras.BitmapText("" + snowflake.prize, {font: "48px Superclarendon Numbers", align: "center"});
		snowflake.text.x -= snowflake.text.textWidth/2;
		snowflake.text.y -= snowflake.text.textHeight/2;
		snowflake.text.alpha = 0;
		snowflake.addChild(snowflake.text);

		// snowflake.text = new PIXI.Text("" + snowflake.prize, {font:"48px Arial", fill:0x000000, align:'center'});
		// snowflake.text.anchor.set(0.5);
		// snowflake.text.alpha = 0;
		// snowflake.addChild(snowflake.text);

		snowflake.tween = new TimelineMax();

			var delay = 0.5 + 0.25 * i;
			var duration = 1;
			snowflake.tween.to(snowflake.scale, duration, {x: 1, y: 1, ease:Elastic.easeOut}, delay);
			snowflake.tween.to(snowflake.scale, 2 + Math.random() * 4, {x: 0.75, y: 0.75, ease:Sine.easeInOut, repeat:-1, yoyo:true}, delay + duration);
			snowflake.tween.to(snowflake, 2 + Math.random()* 3, {x: snowflake.x + 40 * (-1 + 2 * Math.random()), ease:Sine.easeInOut, repeat:-1, yoyo:true}, 0);
			snowflake.tween.to(snowflake, 2 + Math.random()* 3, {y: snowflake.y + 40 * (-1 + 2 * Math.random()), ease:Sine.easeInOut, repeat:-1, yoyo:true}, 0);
			snowflake.tween.to(snowflake.sprite, 30 + Math.random()* 30, {rotation: Math.PI*2 * (Math.floor(Math.random()*2)*2-1), ease:Sine.easeInOut, repeat:-1, yoyo:true}, 0);
		Common.animator.add(snowflake.tween);
    }

	// Panel background
    this._messageBox = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
	this._messageBox.anchor.set(0.5);
	this._messageBox.position.set(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2 + 70);
    this.addChild(this._messageBox);

		var bg = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_snowflakes_bg"));
		bg.anchor.set(0.5);
		bg.position.set(0, -40);
		this._messageBox.addChild(bg);

		this._messageBox.value = new PIXI.extras.BitmapText("??", {font: "56px Superclarendon Numbers", align: "center"});
		this._messageBox.value.x = - this._messageBox.value.textWidth/2;
		this._messageBox.value.y = - this._messageBox.value.textHeight/2 - 62;
		this._messageBox.addChild(this._messageBox.value);

		// this._messageBox.value = new PIXI.Text("??", {font:"48px Arial", fill:0x000000, align:'center'});
		// this._messageBox.value.anchor.set(0.5);
		// this._messageBox.value.position.set(0, -65);
		// this._messageBox.addChild(this._messageBox.value);

		var copy = this._assetManager.getJSON("strings")["REWARD_MESSAGE"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			this._messageBox.message = new PIXI.extras.BitmapText(copy, {font: "36px Superclarendon Title Purple", align: "center"});
			this._messageBox.message.x = - this._messageBox.message.textWidth/2;
			this._messageBox.message.y = - this._messageBox.message.textHeight/2 + 140;
			this._messageBox.addChild(this._messageBox.message);
		}
		else
		{
			this._messageBox.message = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
			this._messageBox.message.anchor.set(0.5);
			this._messageBox.message.position.set(0, 150);
			this._messageBox.addChild(this._messageBox.message);
		}

	this._closeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_secnav_out"),
		this._assetManager.getTexture("ui_btn_secnav_over"),
		this._assetManager.getTexture("ui_btn_secnav_down"),
		this._assetManager.getTexture("ui_icon_secnav_cross")
	);
	this._closeButton.x = 400;
    this._closeButton.y = -240;
	this._closeButton.signals.down.addOnce(this.onClose, this);
	this._messageBox .addChild(this._closeButton);

	this._messageBox.scale.set(0);
	this._closeButton.scale.set(0);

	// HitArea
	this._hitArea = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._hitArea.alpha = 0;
	this._hitArea.width = Common.STAGE_WIDTH;
	this._hitArea.height = Common.STAGE_HEIGHT;
	this._hitArea.interactive = true;
	this._hitArea.touchstart  = this._hitArea.mousedown = this.onTouch.bind(this);
	this.addChild(this._hitArea);

	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_action",
		game_tier1 : "daily_bonus"
	});
};

/**
 */
DailyBonusScreen.prototype.update = function()
{
	// Particles update
	if(!!this.rewardPS)
		this.rewardPS.update(p3.Timestep.deltaTime);
};

/**
 */
DailyBonusScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);
};

/**
 */
DailyBonusScreen.prototype.dispose = function()
{

}

DailyBonusScreen.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);
};

DailyBonusScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);
};



//===================================================
// PRIVATE METHODS
//===================================================



//===================================================
// EVENTS
//===================================================

DailyBonusScreen.prototype.onTouch = function(e)
{
	var clickPosition = e.data.getLocalPosition(this._snowflakeHolder);
	this._hitArea.interactive = false;

	// Find the closest snowflake
	var minDistance = 0;
	var index = -1;

	for(var i = 0; i < this._snowflakes.length; i++)
	{
		var distance = Math.sqrt(Math.pow(this._snowflakes[i].x - clickPosition.x,2) + Math.pow(this._snowflakes[i].y - clickPosition.y, 2));

		if(index == -1 || distance < minDistance)
		{
			index = i;
			minDistance = distance;
		}
	}


	// Make all the snowflake fall except the chosen one
	for(var i = 0; i < this._snowflakes.length; i++)
	{
		this._snowflakes[i].tween.kill();

		this._snowflakes[i].tween = new TimelineMax();

		if(i != index)
		{
			// Other snowflakes
			this._snowflakes[i].tween.to(this._snowflakes[i], 1.5, {alpha: 0, ease:Quad.easeInOut}, 0);
			this._snowflakes[i].tween.to(this._snowflakes[i], 1.5, {y: this._snowflakes[i].y + 100 + 300 * Math.random(), ease:Sine.easeIn}, 0);
			this._snowflakes[i].tween.to(this._snowflakes[i].scale,  1.5, {x: 0.5, y: 0.5, ease:Sine.easeIn}, 0);
			this._snowflakes[i].tween.to(this._snowflakes[i].text, 0.1, {alpha: 1, ease:Sine.easeOut}, 0);
		}
		else
		{
			// Clicked snowflake
			this._snowflakes[i].tween.to(this._snowflakes[i], 1, {x: 0, y: 20, ease:Sine.easeInOut}, 0);
			this._snowflakes[i].tween.to(this._snowflakes[i].scale,  1, {x: 1.6, y: 1.6, ease:Sine.easeInOut}, 0);
			this._snowflakes[i].tween.to(this._snowflakes[i].text, 1, {alpha: 1, ease:Sine.easeOut}, 0);

			this._snowflakes[i].tween.to(this._snowflakes[i].scale, 1, {x: 1.4, y: 1.4, ease:Sine.easeInOut, repeat:-1, yoyo:true}, 1);
			this._snowflakes[i].tween.to(this._snowflakes[i].sprite, 30, {rotation: this._snowflakes[i].rotation + Math.PI*2 * (Math.floor(Math.random()*2)*2-1), ease:Sine.easeInOut, repeat:-1, yoyo:true}, 0);

			this._snowflakes[i].tween.to(this._snowflakes[i], 0.5, {alpha: 0, ease:Sine.easeOut}, 1.75);
		}

		Common.animator.add(this._snowflakes[i].tween);
	}


	this.rewardPS = new cloudkid.Emitter(this._snowflakes[index],
	[
		this._assetManager.getTexture("particle_snowflake_offset_00"),
		this._assetManager.getTexture("particle_snowflake_offset_01"),
		this._assetManager.getTexture("particle_snowflake_offset_02"),
		this._assetManager.getTexture("particle_snowflake_offset_03")
	], this._assetManager.getJSON("particle_reward"));

	this.rewardPS.emit = true;

	// Show the notice
	this._messageBox.value.x += this._messageBox.value.textWidth/2;
	this._messageBox.value.text = this._snowflakes[index].prize;
	this._messageBox.value.validate();
	this._messageBox.value.x -= this._messageBox.value.textWidth/2;

	if(!webfont)
	{
		this._messageBox.message.x += this._messageBox.message.textWidth/2;
		this._messageBox.message.text = this._messageBox.message.text.replace("{value}", this._snowflakes[index].prize);
		this._messageBox.message.validate();
		this._messageBox.message.x -= this._messageBox.message.textWidth/2;
	}
	else
	{
		this._messageBox.message.text = this._messageBox.message.text.replace("{value}", this._snowflakes[index].prize);
	}

	var tl = new TimelineMax();
		tl.to(this._description,        .5, {alpha: 0, ease:Sine.easeOut}, 1.75);
		tl.to(this._messageBox.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 1.75);
		tl.to(this._closeButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 2.25);
	Common.animator.add(tl);

	// Store
	Common.savedData.awardDailyBonus(this._snowflakes[index].prize);
	Common.savedData.save();
}

DailyBonusScreen.prototype.onClose = function()
{
	this.signals.requestedNextScreen.dispatch();
}

//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../general/WireframeButton":45,"./SimpleScreen":73}],68:[function(require,module,exports){
var Common                  = require("../Common");
var Editor                  = require("../editor/Editor");
var SimpleScreen            = require("./SimpleScreen");


//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function EditorScreen()
{
	SimpleScreen.call(this);
}
module.exports = EditorScreen;
EditorScreen.prototype = Object.create(SimpleScreen.prototype);
EditorScreen.prototype.constructor = EditorScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
EditorScreen.prototype.init = function()
{
	console.log("EDITOR INITIALIZED");

	// HitArea
	this.hitArea = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this.hitArea.alpha  = 0;
	this.hitArea.width  = Common.STAGE_WIDTH;
	this.hitArea.height = Common.STAGE_HEIGHT;
	this.hitArea.interactive = true;
	this.addChild(this.hitArea);

	this.mouse =
	{
		position         : new PIXI.Point(0,0),
		lastPosition     : new PIXI.Point(0,0),
		movement         : new PIXI.Point(0,0),
		leftPressed      : false,
		leftJustPressed  : false,
		centerPressed    : false,
		rightPressed     : false,
		rightJustPressed : false,
		update           : function()
		{
			this.leftJustPressed = false;
			this.rightJustPressed = false;
			this.movement.x = this.position.x - this.lastPosition.x;
			this.movement.y = this.position.y - this.lastPosition.y;
			this.lastPosition.x = this.position.x;
			this.lastPosition.y = this.position.y;
		}
	}

	document.getElementById('canvas').onmousedown = function(e)
	{
		e.preventDefault();
		switch(e.which)
		{
			case 1:
				this.mouse.leftPressed = true;
				this.mouse.leftJustPressed = true;
				break;
			case 2:
				this.mouse.centerPressed = true;
				break;
			case 3:
				this.mouse.rightPressed = true;
				this.mouse.rightJustPressed = true;
				break;
		};

	}.bind(this);

	document.getElementById('canvas').onmouseup = function(e)
	{
		switch(e.which)
		{
			case 1:
				this.mouse.leftPressed = false;
				break;
			case 2:
				this.mouse.centerPressed = false;
				break;
			case 3:
				this.mouse.rightPressed = false;
				break;
		};
	}.bind(this);

	this.hitArea.mousemove = function(e)
	{
		this.mouse.position.x = e.data.getLocalPosition(this).x;
		this.mouse.position.y = e.data.getLocalPosition(this).y;
	}.bind(this);


	this.editor = new Editor();
	this.editor.mouse = this.mouse;
	this.addChild(this.editor);
	this.editor.init();

	SimpleScreen.prototype.init.call(this);
}


/**
 */
EditorScreen.prototype.update = function()
{
	this.editor.update();

	this.mouse.update();
}

/**
 */
EditorScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);
}

/**
 */
EditorScreen.prototype.dispose = function()
{

}

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
EditorScreen.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);
}

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
EditorScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);
}


/**
 */
EditorScreen.prototype.hideGUI = function(callback, scope)
{
	this._paused = true;
	TweenMax.pauseAll();
}

/**
 */
EditorScreen.prototype.showGUI = function()
{
	this._paused = false;
	TweenMax.resumeAll();
}


//===================================================
// PRIVATE METHODS
//===================================================




//===================================================
// EVENTS
//===================================================



//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../editor/Editor":9,"./SimpleScreen":73}],69:[function(require,module,exports){
var Common                  = require("../Common");
var SimpleScreen            = require("./SimpleScreen");
var SoundSFX                = require("../general/SoundSFX");
var Level                   = require("../game/Level");
var GameUI                  = require("../game/GameUI");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function GameScreen()
{
	SimpleScreen.call(this);

	this._paused = false;

	this.signals.pausePressed     = new signals.Signal();
	this.signals.showInstructions = new signals.Signal();
}
module.exports = GameScreen;
GameScreen.prototype = Object.create(SimpleScreen.prototype);
GameScreen.prototype.constructor = GameScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
GameScreen.prototype.init = function()
{
	console.log("GAME INITIALIZED");

	SimpleScreen.prototype.init.call(this);

	// Level
	if(Common.savedData.levelDebug != "")
	{
		var config = JSON.parse(Common.savedData.levelDebug);

		if(config.length)
		{
			this._level = new Level(false, "", "theme_01_");
			this._level.config = JSON.parse(Common.savedData.levelDebug);
		}
		else
		{
			this._level = new Level(true,
			{
				start : ["endless_start_000"],
				parts : [],
				partDebug : config
			}, "theme_01_");

		}

		Common.savedData.levelDebug = "";
		Common.savedData.save();
	}
	else if(!Common.savedData.endless)
	{
		var levelName = "";

		switch(Common.savedData.level)
		{
			case 0:
				this._level = new Level(false, "level_00", "theme_01_");
				break;

			default:
			case 1:
				this._level = new Level(false, "level_01", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 2:
				this._level = new Level(false, "level_02", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 3:
				this._level = new Level(false, "level_03", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 4:
				this._level = new Level(false, "level_04", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 5:
				this._level = new Level(false, "level_05", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 6:
				this._level = new Level(false, "level_06", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 7:
				this._level = new Level(false, "level_07", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 8:
				this._level = new Level(false, "level_08", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 9:
				this._level = new Level(false, "level_09", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 10:
				this._level = new Level(false, "level_10", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;

			case 11:
				this._level = new Level(false, "level_11", "theme_0" + (((Common.savedData.level-1)%3)+1) + "_");
				break;
		}
	}
	else
	{
		this._level = new Level(true,
		{
			start : ["endless_start_000"],
			parts :
			[
				"endless_part_000",
				"endless_part_001",
				"endless_part_002",
				"endless_part_003",
				"endless_part_004",
				"endless_part_005",
				"endless_part_006",
				"endless_part_007",
				"endless_part_008",
				"endless_part_009",
				"endless_part_010",
				"endless_part_011",
				"endless_part_012",
				"endless_part_013",
				"endless_part_014",
				"endless_part_015",
				"endless_part_016",
				"endless_part_017",
				"endless_part_018",
				"endless_part_019",
				"endless_part_020",
				"endless_part_021",
				"endless_part_022",
				"endless_part_023",
				"endless_part_024",
				"endless_part_025"
			],
		}, "theme_01_");
	}

	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_start",
		game_level : Common.savedData.endless ? null : (Common.savedData.level+1),
		game_tier1 : "play_start",
		game_meta  : "{" +
						 "CharacterName=" + Common.savedData.character + "," +
						 "tumble="        + Common.savedData.charactersPower[Common.savedData.character][0] + "," +
						 "magnet="        + Common.savedData.charactersPower[Common.savedData.character][1] + "," +
						 "magic="         + Common.savedData.charactersPower[Common.savedData.character][2] +
					 "}"
	});


	this._level.init();
	this.addChild(this._level);

	// Level UI
	this.gameUI = new GameUI(this._level);
	this.gameUI.init();
	this.addChild(this.gameUI);

	// HitArea left: ability
	this._hitAreaLeft = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._hitAreaLeft.alpha = 0;
	this._hitAreaLeft.width = Common.STAGE_WIDTH/2;
	this._hitAreaLeft.height = Common.STAGE_HEIGHT;
	this._hitAreaLeft.interactive = true;

	// HitArea right: jump
	this._hitAreaRight = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	this._hitAreaRight.alpha = 0;
	this._hitAreaRight.x = Common.STAGE_WIDTH/2;
	this._hitAreaRight.width = Common.STAGE_WIDTH/2;
	this._hitAreaRight.height = Common.STAGE_HEIGHT;
	this._hitAreaRight.interactive = true;

	if(p3.Device.isMobile)
	{
		this.addChild(this._hitAreaRight);

		// Anna and pabbie don't have powers, they can only jump
		if(Common.savedData.character == "anna")
		{
			this._hitAreaRight.x = 0;
			this._hitAreaRight.width = Common.STAGE_WIDTH;
		}
		else
		{
			this.addChild(this._hitAreaLeft);
		}
	}
	else
	{
		this.addChild(this._hitAreaRight);
		this._hitAreaRight.x = 0;
		this._hitAreaRight.width = Common.STAGE_WIDTH;
	}


	//UI
	this._pauseButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_pause")
	);
	this._pauseButton.y = this._guiButtonTopMargin - 20;
	this._pauseButton.scale.set(0);
	this._pauseButton.signals.down.add(this.onPausePressed, this);
	this._pauseButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._pauseButton);

	// this._muteButton = new p3.MuteButton
	// (
		// this._assetManager.getTexture("ui_btn_con_out"),
		// this._assetManager.getTexture("ui_btn_con_over"),
		// this._assetManager.getTexture("ui_btn_con_down"),
		// this._assetManager.getTexture("ui_icon_con_sound_on"),
		// this._assetManager.getTexture("ui_icon_con_sound_off")
	// );

	// this._muteButton.id = "mute";
	// this._muteButton.y = this._guiButtonTopMargin;
	// this._muteButton.scale.set(0);
	// this._muteButton.signals.over.add(this.buttonOver, this);
	// this._muteButton.init();
	// this.addChild(this._muteButton);

	// Touch areas
	this._level.avatar.kAbility = false;
	this._hitAreaLeft.touchstart  = this._hitAreaLeft.mousedown  = this.onTouchLeftStart.bind(this);
	// this._hitAreaLeft.touchend    = this._hitAreaLeft.mouseup    = this.onTouchLeftEnd.bind(this);

	this._hitAreaRight.touchstart = this._hitAreaRight.mousedown = this.onTouchRightStart.bind(this);
	this._hitAreaRight.touchend   = this._hitAreaRight.mouseup   = this.onTouchRightEnd.bind(this);

	Common.goalsManager.startRun(this);
	this.startGame();

	// Common.animator.setTimeout(function()
	// {
		// this.endGame();
	// }, 1.2, this);


	if(Common.savedData.endless && !Common.savedData.hasSeenTutorial["endless"])
	{
		Common.animator.setTimeout(function()
		{
			this.showInstructions("endless");
		}, 1.2, this);
	}
	if(Common.savedData.hasSeenTutorial[Common.savedData.character] == false)
	{
		Common.animator.setTimeout(function()
		{
			this.showInstructions(Common.savedData.character);
		}, 1.2, this);
	}
}

/**
 */
GameScreen.prototype.startGame = function()
{
	this.showGUI();

	Common.animator.setTimeout(function()
	{
		this.gameUI.showGoals(false);
	}, 0.25, this);
}

/**
 */
GameScreen.prototype.endGame = function()
{
	this._paused = true;

	this.signals.requestedNextScreen.dispatch(this._level);
}

/**
 */
GameScreen.prototype.update = function()
{
	// if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_Q))
	// {
		// this._paused = !this._paused;

		// if(this._paused)
			// TweenMax.pauseAll();
		// else
			// TweenMax.resumeAll();
	// }

	// if(Common.keyboard.getKeyJustPressed(Common.keyboard.KEY_Z))
	// {
		// this._level.avatar.kAbility = true;
	// }

	if(!this._paused)
	{
		this._level.update();
		this.gameUI.update();
	}
}

/**
 */
GameScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);

	this.gameUI.resize();
	// this._muteButton.x   = this._getFirstButtonPositionRight();
	this._pauseButton.x  = this._getFirstButtonPositionRight();
}

/**
 */
GameScreen.prototype.dispose = function()
{
	this._level.dispose();
	SoundSFX.stop('mx_frozen_01_gameplay_lp');
}

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
GameScreen.prototype.animateIn = function(callback, scope)
{
	// Music
	if(!!Common.bgMusic)
	{
		Common.bgMusic.stop();
		Common.bgMusic.fadeOut(0, 500);
	}
	Common.bgMusic = SoundSFX.play('mx_frozen_01_gameplay_lp', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);

	SimpleScreen.prototype.animateIn.call(this);

	if(callback) callback.call(scope);
}

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
GameScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	if(callback) callback.call(scope);
}


/**
 */
GameScreen.prototype.hideGUI = function(callback, scope)
{
	this._paused = true;
	TweenMax.pauseAll();

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
	tl.to(this._pauseButton.scale, .35, {x:0, y:0, ease:Back.easeIn}, 0);
	// tl.to(this._muteButton.scale,  .35, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
}

/**
 */
GameScreen.prototype.showGUI = function()
{
	this._paused = false;
	TweenMax.resumeAll();

	// Ugly way to update mute button if changed in the pause screen
	// this._muteButton._enabled = p3.Button.audio._isMute;
	// this._muteButton._currentIconTexture = p3.Button.audio._isMute ? this._muteButton._offIconTexture : this._muteButton._onIconTexture;
	// this._muteButton._icon.texture       = this._muteButton._currentIconTexture;

	var tl = new TimelineMax();
	// tl.to(this._muteButton.scale,   .5, {x:1, y:1, ease:Back.easeOut}, 0);
	tl.to(this._pauseButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 1.5);
	Common.animator.add(tl);
}

/**
 */
GameScreen.prototype.gameOver = function(callback, scope)
{
	// Show goals
	this.gameUI.showGoals(true);

	// Hide UI
	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
		tl.to(this._pauseButton.scale,  .35, {x:0, y:0, ease:Back.easeIn}, 0);
		// tl.to(this._muteButton.scale,   .35, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);

	this.gameUI.gameOver();

	// Show results after a delay
	Common.animator.setTimeout(function()
	{
		this._level.stopLoops();

		this.signals.requestedNextScreen.dispatch(this._level);
	}, 2, this);

	// Music
	Common.bgMusic.fadeOut(0, 2000);
}

/**
 */
GameScreen.prototype.showInstructions = function(what)
{
	this._level.stopLoops();
	// this._paused = true;
	this.signals.showInstructions.dispatch(what);
}

//===================================================
// PRIVATE METHODS
//===================================================

/**
 */
GameScreen.prototype.onPausePressed = function()
{
	SoundSFX.play("sfx_btn_press_00");

	if(this._level.avatar.isDead) return;
	this.signals.pausePressed.dispatch(this._level);

	this._level.stopLoops();
}

/**
 */
GameScreen.prototype.buttonOver = function()
{
	SoundSFX.play("sfx_btn_rollover_00");
}

/**
 */
GameScreen.prototype.onTouchLeftStart = function(event, id)
{
	this._level.avatar.kAbility = true;
};

/**
 */
GameScreen.prototype.onTouchLeftEnd = function(event, id)
{

};

/**
 */
GameScreen.prototype.onTouchRightStart = function(event, id)
{
	this._level.avatar.kJumpStart = true;
};

/**
 */
GameScreen.prototype.onTouchRightEnd = function(event, id)
{
	this._level.avatar.kJumpEnd = true;
};

/**
 */
GameScreen.prototype.restart = function()
{
	this.signals.requestedPreviousScreen.dispatch();
};


//===================================================
// EVENTS
//===================================================



//===================================================
// GETTERS/SETTERS
//===================================================


},{"../Common":2,"../game/GameUI":16,"../game/Level":17,"../general/SoundSFX":44,"./SimpleScreen":73}],70:[function(require,module,exports){
var Common       = require("../Common");
var SimpleScreen = require("./SimpleScreen");
var SoundSFX     = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function IntroScreen(type)
{
	SimpleScreen.call(this);

	this._type = type;

	switch(this._type)
	{
		case "intro":
			this._spine = Common.introAnimationData
			break;

		case "outro":
			this._spine = Common.outroAnimationData
			break;
	}
}
module.exports = IntroScreen;
IntroScreen.prototype = Object.create(SimpleScreen.prototype);
IntroScreen.prototype.constructor = IntroScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
IntroScreen.prototype.init = function()
{
	console.log("INTRO INITIALIZED");

	SimpleScreen.prototype.init.call(this);

	// Bg
	this._bg = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
	this._bg.alpha = 1;
	this._bg.width  = Common.STAGE_WIDTH;
	this._bg.height = Common.STAGE_HEIGHT;
	this._bg.tint   = 0x476FA6;
	this.addChild(this._bg)

	// Animation
	var barSize = 160;

	this.spine = new PIXI.spine.Spine(this._spine);
	this.spine.x = Common.STAGE_WIDTH/2;
	this.spine.y = Common.STAGE_HEIGHT-barSize+1;
	this.spine.autoUpdate = true;
	this.spine.scale.set(0.5);
	this.addChild(this.spine);
	this.spine.state.setAnimationByName(0, "animation", false, 0);


	var bar = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	bar.alpha = 1;
	bar.width  = Common.STAGE_WIDTH;
	bar.height = barSize;
	this.addChild(bar)

	var bar = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	bar.alpha = 1;
	bar.width  = Common.STAGE_WIDTH;
	bar.height = barSize;
	bar.y = Common.STAGE_HEIGHT - bar.height;
	this.addChild(bar);

	var bar = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	bar.alpha = 1;
	bar.width  = 441;
	bar.height = Common.STAGE_HEIGHT;
	this.addChild(bar);

	var bar = new PIXI.Sprite(Common.generatedTextures['blackSquare']);
	bar.alpha  = 1;
	bar.width  = 441;
	bar.x      = Common.STAGE_WIDTH-bar.width;
	bar.height = Common.STAGE_HEIGHT;
	this.addChild(bar);

	// Audio
	if(!!Common.bgMusic) Common.bgMusic.fadeOut(0, 500);

	// Subtitles
	if(!webfont)
	{
		this._subtitle = new PIXI.extras.BitmapText("TEST", {font: "38px Superclarendon Title", align: "center"});
		this._subtitle.x = Common.STAGE_WIDTH/2  - this._subtitle.textWidth/2;
		this._subtitle.y = Common.STAGE_HEIGHT - this._subtitle.textHeight/2 -80;
		this.addChild(this._subtitle);
	}
	else
	{
		this._subtitle = new PIXI.Text("TEST", {font:"38px Arial", fill:0xffffff, align:'center'});
		this._subtitle.position.set( Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT - 80);
		this._subtitle.anchor.set(0.5);
		this.addChild(this._subtitle);
	}
	this._subtitle.alpha = 0;


	this._subtitleTl = new TimelineMax();

	switch(this._type)
	{
		case "intro":
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["INTRO_0"][Common.COUNTRY_CODE])}}, 0.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 3);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["INTRO_1"][Common.COUNTRY_CODE])}}, 4);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 6.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["INTRO_2"][Common.COUNTRY_CODE])}}, 7);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 15.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["INTRO_3"][Common.COUNTRY_CODE])}}, 16.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 19);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["INTRO_4"][Common.COUNTRY_CODE])}}, 20);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onCompleteScope:this, onComplete:function(){this.animateOut()}}, 30);

			Common.bgMusic = SoundSFX.play('sfx_intro_audio_01', {loop:false, volume:0});
			Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);

			break;

		case "outro":
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["OUTRO_0"][Common.COUNTRY_CODE])}}, 0.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 4.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["OUTRO_1"][Common.COUNTRY_CODE])}}, 5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 9);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["OUTRO_2"][Common.COUNTRY_CODE])}}, 14.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:0, ease:Sine.easeInOut}, 18.5);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onStartScope:this, onStart:function(){this.setSubtitle(this._assetManager.getJSON("strings")["OUTRO_3"][Common.COUNTRY_CODE])}}, 19);
			this._subtitleTl.to(this._subtitle, .5, {alpha:1, ease:Sine.easeInOut, onCompleteScope:this, onComplete:function(){this.animateOut()}}, 24);

			Common.bgMusic = SoundSFX.play('sfx_outro_audio_01', {loop:false, volume:0});
			Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);

			break;
	}

	Common.animator.add(this._subtitleTl);

	// Buttons
	this._nextButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_nav_out_big"),
		this._assetManager.getTexture("ui_btn_nav_over_big"),
		this._assetManager.getTexture("ui_btn_nav_down_big"),
		this._assetManager.getTexture("ui_icon_nav_skip")
	);

	this._nextButton.y = Common.STAGE_HEIGHT - 250;
	this._nextButton.signals.down.add(this.nextClicked, this);
	this._nextButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._nextButton);

	// Mute button
	this._muteButton = new p3.MuteButton
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_sound_on"),
		this._assetManager.getTexture("ui_icon_con_sound_off")
	);

	this._muteButton.id = "mute";
	this._muteButton.y = this._guiButtonTopMargin;
	// this._muteButton.scale = new PIXI.Point(0, 0);
	this._muteButton.init();
	this.addChild(this._muteButton);
};

/**
 */
IntroScreen.prototype.update = function()
{

};

/**
 */
IntroScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);

	// this._nextButton.x = r2l ? (this._getFirstButtonPositionLeft() + 30) : (this._getFirstButtonPositionRight() - 30);
	this._nextButton.x = this._getFirstButtonPositionRight() - 30;
	
	this._muteButton.x = this._getFirstButtonPositionRight();
};

/**
 */
IntroScreen.prototype.dispose = function()
{

}

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
IntroScreen.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	// Buttons
	// var tl = new TimelineMax();
	// tl.to(this._nextButton.scale, 1, {x:1, y:1, ease:Elastic.easeOut}, 0);
	// Common.animator.add(tl);

	// Common.animator.setTimeout(function()
	// {
		// Common.savedData.hasSeenIntro = true;
		// Common.savedData.save();
		// this.animateOut();
	// }, 4.5, this);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
IntroScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	this.signals.requestedNextScreen.dispatch();
};

IntroScreen.prototype.setSubtitle = function(text)
{
	if(!webfont)
	{
		this._subtitle.x += this._subtitle.textWidth/2;
		this._subtitle.y += this._subtitle.textHeight/2;
		this._subtitle.text = text;
		this._subtitle.validate();
		this._subtitle.x -= this._subtitle.textWidth/2;
		this._subtitle.y -= this._subtitle.textHeight/2;
	}
	else
	{
		this._subtitle.text = text;
	}
};

//===================================================
// PRIVATE METHODS
//===================================================


//===================================================
// EVENTS
//===================================================

/**
 */
IntroScreen.prototype.nextClicked = function()
{
	this.animateOut();

	SoundSFX.play("sfx_btn_press_00");
};

/**
 */
IntroScreen.prototype.buttonOver = function()
{
	SoundSFX.play("sfx_btn_rollover_00");
};

/**
 */
IntroScreen.prototype.nextClickFinish = function()
{
	this.signals.requestedNextScreen.dispatch();
};


//===================================================
// GETTERS/SETTERS
//===================================================

},{"../Common":2,"../general/SoundSFX":44,"./SimpleScreen":73}],71:[function(require,module,exports){
var Common            = require("../Common");
var SimpleScreen      = require("./SimpleScreen");
var LevelSelectButton = require("../general/LevelSelectButton");
var SoundSFX          = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function LevelSelectScreen(lastLevel)
{
    this._bg                = null;
    this._leftButtonHeld    = false;
    this._rightButtonHeld   = false;
	this._scrollPercentage  = 0;
	this._speed         = 0;
	this._speedMax      = 1.5;
	this._accelleration = 3;
	this._decelleration = 4;

    this._scrollEnabled     = true;
    this._mapHolderBuffer   = 75;

	this.isTouchScrolling  = false;
	this.touchPosition     = 0;

    SimpleScreen.call(this);

	this.signals.helpPressed = new signals.Signal();
}
module.exports = LevelSelectScreen;
LevelSelectScreen.prototype = Object.create(SimpleScreen.prototype);
LevelSelectScreen.prototype.constructor = LevelSelectScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
LevelSelectScreen.prototype.init = function()
{
    console.log("SPLASH INITIALIZED");
    SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_bg_main_menu"));
    this.addChild(this._bg);

	// Background particles
	this._backgroundPSContainer = new PIXI.Container();
	this.addChild(this._backgroundPSContainer);

	this.backgroundPS = new cloudkid.Emitter(this._backgroundPSContainer,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_menu_snow"));

	this.backgroundPS.updateSpawnPos(Common.STAGE_WIDTH/2, 0);
	this.backgroundPS.update(5);
	this.backgroundPS.emit = true;

	// Map
    this._mapHolder = new PIXI.Container();
    this._mapHolder.x = this._centre.x - (p3.View.width/2) + this._mapHolderBuffer;
    this._mapHolder.y = 175;
    this.addChild(this._mapHolder);

		this._mapHolder._mapPiece1 = new PIXI.Sprite(this._assetManager.getTexture("ui_map_bg_1"));
		this._mapHolder._mapPiece1.anchor.set(0);
		this._mapHolder._mapPiece1.scale.set(1/0.8, 1/0.8);
		this._mapHolder.addChild(this._mapHolder._mapPiece1);

		this._mapHolder._mapPiece2 = new PIXI.Sprite(this._assetManager.getTexture("ui_map_bg_2"));
		this._mapHolder._mapPiece2.anchor.set(0);
		this._mapHolder._mapPiece2.scale.set(1/0.8, 1/0.8);
		this._mapHolder._mapPiece2.x += this._mapHolder._mapPiece1.width-1;
		this._mapHolder.addChild(this._mapHolder._mapPiece2);

		this._bg.interactive = true;
		this._bg.touchstart = this._bg.mousedown = function(e){this.onTouchStart(e)}.bind(this);
		this._bg.touchmove  = this._bg.mousemove = function(e){this.onTouchMove(e)}.bind(this);
		this._bg.touchend   = this._bg.mouseup   = function(e){this.onTouchEnd(e)}.bind(this);


	// this._mapHolder.xMax = this._mapHolder.x;
	// this._mapHolder.xMin = this._mapHolder.x - this._mapHolder._mapPiece1.width - this._mapHolder._mapPiece2.width + p3.View.width - 2 * this._mapHolderBuffer;

		// Dev code for dots placement
		/*
		var that = this;
		this._mapHolder._mapPiece1.interactive = true;
		this._mapHolder._mapPiece1.mousedown = function(e)
		{
			console.log("%i %i", e.data.getLocalPosition(this).x, e.data.getLocalPosition(this).y);

			var dot = new PIXI.Sprite(that._assetManager.getTexture("ui_map_path_off"));
			dot.anchor = new PIXI.Point(0.5, 0.5);
			dot.x = e.data.getLocalPosition(this).x;
			dot.y = e.data.getLocalPosition(this).y;

			that._mapHolder.addChild(dot);
		};

		var that = this;
		this._mapHolder._mapPiece2.interactive = true;
		this._mapHolder._mapPiece2.mousedown = function(e)
		{
			console.log("%i %i", this._mapHolder._mapPiece1.width + e.data.getLocalPosition(this).x, e.data.getLocalPosition(this).y);

			var dot = new PIXI.Sprite(that._assetManager.getTexture("ui_map_path_off"));
			dot.anchor = new PIXI.Point(0.5, 0.5);
			dot.x = this._mapHolder._mapPiece1.width + e.data.getLocalPosition(this).x;
			dot.y = e.data.getLocalPosition(this).y;

			that._mapHolder.addChild(dot);
		};
		*/

	// Map deco
	var birds = [
	             {x:500, y:320},
	             {x:670, y:360}, {x:710, y:370}, {x:690, y:380},
				 {x:900, y:70}, {x:940, y:80},
				 {x:1410, y:370}, {x:1430, y:380}
				];
	for(var i = 0; i < birds.length; i++)
	{
		var animation = new p3.MovieClip(this._generateAnimationSequence("map_bird", 4));
		animation.animationSpeed = animation.totalFrames/1;
		animation.anchor  = new PIXI.Point(0.5, 0.5);
		animation.looping = true;
		animation.position = birds[i];
		animation.gotoAndPlay(p3.Utils.randomInt(0,animation.totalFrames));
		this._mapHolder.addChild(animation);
	}

	this.ripplesLowerPSHolder = new PIXI.Container();
	this.ripplesLowerPSHolder.position.set(500, 480);
	this._mapHolder.addChild(this.ripplesLowerPSHolder);
	this.ripplesLowerPS = new cloudkid.Emitter(this.ripplesLowerPSHolder,
	[
		this._assetManager.getTexture("map_wave_01"),
		this._assetManager.getTexture("map_wave_02"),
		this._assetManager.getTexture("map_wave_03")
	], this._assetManager.getJSON("particle_map_ripples_lower"));
	this.ripplesLowerPS.emit = true;

	this.ripplesUpperPSHolder = new PIXI.Container();
	this.ripplesUpperPSHolder.position.set(380, 410);
	this._mapHolder.addChild(this.ripplesUpperPSHolder);
	this.ripplesUpperPS = new cloudkid.Emitter(this.ripplesUpperPSHolder,
	[
		this._assetManager.getTexture("map_wave_01"),
		this._assetManager.getTexture("map_wave_02"),
		this._assetManager.getTexture("map_wave_03")
	], this._assetManager.getJSON("particle_map_ripples_upper"));
	this.ripplesUpperPS.emit = true;

	this.ripplesBridgePSHolder = new PIXI.Container();
	this.ripplesBridgePSHolder.position.set(1570, 395);
	this._mapHolder.addChild(this.ripplesBridgePSHolder);
	this.ripplesBridgePS = new cloudkid.Emitter(this.ripplesBridgePSHolder,
	[
		this._assetManager.getTexture("map_wave_01"),
		this._assetManager.getTexture("map_wave_02"),
		this._assetManager.getTexture("map_wave_03")
	], this._assetManager.getJSON("particle_map_ripples_bridge"));
	this.ripplesBridgePS.emit = true;	
	
	this.poolSparklesPSHolder = new PIXI.Container();
	this.poolSparklesPSHolder.position.set(1920, 170);
	this._mapHolder.addChild(this.poolSparklesPSHolder);
	this.poolSparklesPS = new cloudkid.Emitter(this.poolSparklesPSHolder,
	[
		this._assetManager.getTexture("map_star_01"),
		this._assetManager.getTexture("map_star_02")
	], this._assetManager.getJSON("particle_map_troll_pool_sparkles"));
	this.poolSparklesPS.emit = true;


	// Text: The story
	var copy = this._assetManager.getJSON("strings")["THE_STORY"][Common.COUNTRY_CODE];
	if(!webfont)
	{
		var text = new PIXI.extras.BitmapText(copy, {font: "36px Mikadan White", align: "center"});
		text.tint = 0x715951;
		text.x = 150-text.textWidth/2;
		text.y = 105-text.textHeight/2;
		this._mapHolder.addChild(text);
	}
	else
	{
		var text = new PIXI.Text(copy, {font:"36px Arial", fill:0x715951, align:'center'});
		text.anchor.set(0.5);
		text.x = 150;
		text.y = 105;
		this._mapHolder.addChild(text);
	}

	// Text: Arendelle
	var copy = this._assetManager.getJSON("strings")["ARENDELLE"][Common.COUNTRY_CODE];
	if(!webfont)
	{
		var text = new PIXI.extras.BitmapText(copy, {font: "32px Mikadan White", align: "center"});
		text.tint = 0x897770;
		text.x = 660-text.textWidth/2;
		text.y = 325-text.textHeight/2;
		this._mapHolder.addChild(text);
	}
	else
	{
		var text = new PIXI.Text(copy, {font:"32px Arial", fill:0x897770, align:'center'});
		text.anchor.set(0.5);
		text.x = 660;
		text.y = 325;
		this._mapHolder.addChild(text);
	}

	// Text: Oaken
	var copy = this._assetManager.getJSON("strings")["OAKEN"][Common.COUNTRY_CODE];
	if(!webfont)
	{
		var text = new PIXI.extras.BitmapText(copy, {font: "32px Mikadan White", align: "center"});
		text.tint = 0x897770;
		text.x = 1220-text.textWidth/2;
		text.y = 165-text.textHeight/2;
		this._mapHolder.addChild(text);
	}
	else
	{
		var text = new PIXI.Text(copy, {font:"32px Arial", fill:0x897770, align:'center'});
		text.anchor.set(0.5);
		text.x = 1220;
		text.y = 165;
		this._mapHolder.addChild(text);
	}

	// Text: Troll's den
	var copy = this._assetManager.getJSON("strings")["TROLLS_DEN"][Common.COUNTRY_CODE];
	if(!webfont)
	{
		var text = new PIXI.extras.BitmapText(copy, {font: "32px Mikadan White", align: "center"});
		text.tint = 0x897770;
		text.x = 1950-text.textWidth/2;
		text.y = 90-text.textHeight/2;
		this._mapHolder.addChild(text);
	}
	else
	{
		var text = new PIXI.Text(copy, {font:"32px Arial", fill:0x897770, align:'center'});
		text.anchor.set(0.5);
		text.x = 1950;
		text.y = 95;
		this._mapHolder.addChild(text);
	}

	// Characters
	var kristoff = new PIXI.Sprite(this._assetManager.getTexture("ui_map_char_kristoff"));
	kristoff.anchor.set(0.5, 1);
	kristoff.position.set(355, 190);
	this._mapHolder.addChild(kristoff);

	var olaf = new PIXI.Sprite(this._assetManager.getTexture("ui_map_char_olaf"));
	olaf.anchor.set(0.5, 1);
	olaf.position.set(770, 140);
	this._mapHolder.addChild(olaf);

	var elsa = new PIXI.Sprite(this._assetManager.getTexture("ui_map_char_elsa"));
	elsa.anchor.set(0.5, 1);
	elsa.position.set(1010, 400);
	this._mapHolder.addChild(elsa);


 	// Map buttons
	this._buttons = [];
	var buttonCoords =
	[
		{x: 180, y: 360},
		{x: 310, y: 160},
		{x: 520, y: 150},
		{x: 710, y: 145},
		{x: 860, y: 260},
		{x: 980, y: 400},
		{x: 1160, y: 410},
		{x: 1300, y: 320},
		{x: 1420, y: 160},
		{x: 1590, y: 220},
		{x: 1770, y: 350},
		{x: 1960, y: 300}
	];

	for(var i = 0; i < buttonCoords.length; i++)
	{
		if(Common.savedData.showUnlockedLevel && i == Common.savedData.levelsUnlocked-1)
		{
			var button = new LevelSelectButton(i, false);
			button.position = buttonCoords[i];
			button.signals.clicked.add(this.onLevelClicked, this);
			this._buttons.push(button);
			this._mapHolder.addChild(button);

			var button = new LevelSelectButton(i, true);
			button.position = buttonCoords[i];
			button.signals.clicked.add(this.onLevelClicked, this);
			button.scale.set(0);
			this._buttons.push(button);
			this._mapHolder.addChild(button);
		}
		else
		{
			var button = new LevelSelectButton(i, Common.savedData.levelsUnlocked > i);
			button.position = buttonCoords[i];
			button.signals.clicked.add(this.onLevelClicked, this);
			this._buttons.push(button);
			this._mapHolder.addChild(button);
		}
	}

	// Map dots
	this._dots = []
	var coords = [];
	coords[0] =
	[
		[212, 298],
		[228, 274],
		[236, 248],
		[240, 221],
		[244, 191]
	];
	coords[1] =
	[
		[373, 119],
		[399, 111],
		[427, 111],
		[451, 120]
	];
	coords[2] =
	[
		[580, 187],
		[600, 198],
		[625, 197],
		[645, 182]
	];
	coords[3] =
	[
		[775, 143],
		[798, 155],
		[814, 177],
		[826, 200]
	];
	coords[4] =
	[
		[917, 306],
		[928, 325],
		[934, 349]
	];
	coords[5] =
	[
		[1035, 441],
		[1055, 448],
		[1078, 446],
		[1097, 434]
	];
	coords[6] =
	[
		[1224, 404],
		[1239, 387],
		[1248, 367]
	];
	coords[7] =
	[
		[1323, 256],
		[1324, 230],
		[1327, 203],
		[1336, 177],
		[1353, 158]
	];
	coords[8] =
	[
		[1487, 147],
		[1512, 158],
		[1532, 176]
	];
	coords[9] =
	[
		[1649, 271],
		[1662, 292],
		[1679, 311],
		[1700, 324]
	];
	coords[10] =
	[
		[1836, 348],
		[1860, 339],
		[1879, 325],
		[1894, 306]
	];


	for(var i = 0; i < coords.length; i++)
	{
		this._dots[i] = [];

		if(Common.savedData.showUnlockedLevel && i == (Common.savedData.levelsUnlocked-2))
		{
			for(var p = 0; p < coords[i].length; p++)
			{
				var dot = new PIXI.Sprite(this._assetManager.getTexture("ui_map_path_off"));
				dot.anchor.set(0.5);
				dot.position.set(coords[i][p][0], coords[i][p][1]);
				this._dots[i].push(dot);
				this._mapHolder.addChildAt(dot,2);

				var dotFull = new PIXI.Sprite(this._assetManager.getTexture("ui_map_path_on"));
				dotFull.anchor.set(0.5);
				dotFull.position.set(coords[i][p][0], coords[i][p][1]);
				dotFull.alpha = 0;
				this._dots[i].push(dotFull);
				this._mapHolder.addChildAt(dotFull,2);
			}
		}
		else
		{
			for(var p = 0; p < coords[i].length; p++)
			{
				var dot = new PIXI.Sprite(this._assetManager.getTexture(Common.savedData.levelsUnlocked > i+1 ? "ui_map_path_on" : "ui_map_path_off"));
				dot.anchor.set(0.5);
				dot.position.set(coords[i][p][0], coords[i][p][1]);
				this._mapHolder.addChildAt(dot,2);
			}
		}
	}

	// Coins
	this.initCoinCointainer();

	// UI
	this._leftButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_sidenav_out"),
		this._assetManager.getTexture("ui_btn_sidenav_over"),
		this._assetManager.getTexture("ui_btn_sidenav_down"),
		this._assetManager.getTexture("ui_icon_sidenav_arrow")
	);
	this._leftButton.children[0].anchor.set(0, 0.5);
	this._leftButton.children[1].anchor.set(0, 0.5);
	this._leftButton.y = Common.STAGE_HEIGHT / 2;
	this._leftButton.signals.down.add(this.onLeftDown, this);
	this._leftButton.signals.up.add(this.onLeftUp, this);
	this._leftButton.overSoundName = "sfx_btn_rollover_00";
	this._leftButton.visible = false;
	this._leftButton.alpha = 0;
	this.addChild(this._leftButton);

	this._rightButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_sidenav_out"),
		this._assetManager.getTexture("ui_btn_sidenav_over"),
		this._assetManager.getTexture("ui_btn_sidenav_down"),
		this._assetManager.getTexture("ui_icon_sidenav_arrow")
	);
	this._rightButton.scale.x = -1;
	this._rightButton.children[0].anchor.set(0, 0.5);
	this._rightButton.children[1].anchor.set(0, 0.5);
	this._rightButton.y = Common.STAGE_HEIGHT / 2;
	this._rightButton.signals.down.add(this.onRightDown, this);
	this._rightButton.signals.up.add(this.onRightUp, this);
	this._rightButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._rightButton);

	// Back button
	this._bkButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_back")
	);
	this._bkButton.y = this._guiButtonTopMargin;
	this._bkButton.signals.down.add(this.onBackPressed, this);
	this._bkButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._bkButton);

	// Help button
	this._helpButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_help")
	);
	this._helpButton.overSoundName = "sfx_btn_rollover_00";
	this._helpButton.y = this._guiButtonTopMargin;
	this._helpButton.signals.down.add(this.onHelpPressed, this);
	this.addChild(this._helpButton);

	// Mute button
	this._muteButton = new p3.MuteButton
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_sound_on"),
		this._assetManager.getTexture("ui_icon_con_sound_off")
	);
	this._muteButton.overSoundName = "sfx_btn_rollover_00";
	this._muteButton.id = "mute";
	this._muteButton.y = this._guiButtonTopMargin;
	this._muteButton.init();
	this.addChild(this._muteButton);

	// Show new unlocked level animation
	if(Common.savedData.showUnlockedLevel)
	{
		var tl = new TimelineMax({onCompleteScope:this, onComplete:function()
		{
			Common.savedData.showUnlockedLevel = false;
			Common.savedData.save();
		}});

			// Scroll the view
			var xMin = this._centre.x - (Math.min(Common.STAGE_WIDTH, p3.View.width)/2) + this._mapHolderBuffer;
			var xMax = xMin - this._mapHolder._mapPiece1.width - this._mapHolder._mapPiece2.width + Math.min(Common.STAGE_WIDTH, p3.View.width) - 2 * this._mapHolderBuffer;
			var xTarget = this._centre.x - buttonCoords[Common.savedData.levelsUnlocked-1].x;
			var scrollPercentageTarget = Math.min(1, Math.max(0,(xTarget-xMin)/(xMax-xMin)));
			var delay = 0.25;
			var scrollDuration = scrollPercentageTarget * 2;
			if(scrollDuration != 0 && scrollDuration < 0.5) scrollDuration = 0.5;

			tl.to(this, scrollDuration, {_scrollPercentage:scrollPercentageTarget, ease:Sine.easeInOut, onCompleteScope:this, onComplete:function()
			{
				this.unlockPS.updateSpawnPos(this._buttons[Common.savedData.levelsUnlocked].x, this._buttons[Common.savedData.levelsUnlocked].y);
				this.unlockPS.emit = true;
			}}, delay);


			// Run the particle effect
			this.unlockPSContainer = new PIXI.Container();
			this._mapHolder.addChild(this.unlockPSContainer);

			this.unlockPS = new cloudkid.Emitter(this.unlockPSContainer,
			[
				this._assetManager.getTexture("particle_snowflake_offset_00"),
				this._assetManager.getTexture("particle_snowflake_offset_01"),
				this._assetManager.getTexture("particle_snowflake_offset_02"),
				this._assetManager.getTexture("particle_snowflake_offset_03")
			], this._assetManager.getJSON("particle_level_unlock"));

			this.unlockPS.emit = false;

			// Show the dots
			for(var d = 0; d < this._dots[Common.savedData.levelsUnlocked-2].length; d+=2)
			{
				tl.to(this._dots[Common.savedData.levelsUnlocked-2][d],   0.25, {alpha:0, ease:Linear.easeNone}, delay + scrollDuration * 0.8 + (d/2+1)* 0.25);
				tl.to(this._dots[Common.savedData.levelsUnlocked-2][d+1], 0.25, {alpha:1, ease:Linear.easeNone}, delay + scrollDuration * 0.8 + (d/2)  * 0.25);
			}

			// Show the level button
			tl.to(this._buttons[Common.savedData.levelsUnlocked].scale, 1.25, {x:1, y:1, ease:Elastic.easeOut, onStartScope:this, onStart:function(){SoundSFX.play("sfx_ui_map_level_unlock_02");}});

			// Show side buttons
			this._leftButton.alpha    = 0;
			this._rightButton.alpha   = 0;
			this._leftButton.visible  = false;
			this._rightButton.visible = false;

			if(scrollPercentageTarget < 1)
				tl.to(this._rightButton,  .2, {alpha:1, ease:Linear.easeNone, onStartScope:this, onStart:function(){this._rightButton.visible=true;}}, delay + scrollDuration + 1.25);

			if(scrollPercentageTarget > 0)
				tl.to(this._leftButton,  .2, {alpha:1, ease:Linear.easeNone, onStartScope:this, onStart:function(){this._leftButton.visible=true;}}, delay + scrollDuration + 1.25);


		Common.animator.add(tl);
	}
	else
	{
		// Scroll the view
		var xMin = this._centre.x - (Math.min(Common.STAGE_WIDTH, p3.View.width)/2) + this._mapHolderBuffer;
		var xMax = xMin - this._mapHolder._mapPiece1.width - this._mapHolder._mapPiece2.width + Math.min(Common.STAGE_WIDTH, p3.View.width) - 2 * this._mapHolderBuffer;
		var xTarget = this._centre.x - buttonCoords[Common.savedData.levelsUnlocked-1].x;
		var scrollPercentageTarget = Math.min(1, Math.max(0,(xTarget-xMin)/(xMax-xMin)));
		var delay = 0.25;
		var scrollDuration = scrollPercentageTarget * 2;
		if(scrollDuration != 0 && scrollDuration < 0.5) scrollDuration = 0.5;

		TweenMax.to(this, scrollDuration, {_scrollPercentage:scrollPercentageTarget, ease:Sine.easeInOut}, delay);
		// Show side buttons
		this._leftButton.alpha    = 0;
		this._rightButton.alpha   = 0;
		this._leftButton.visible  = false;
		this._rightButton.visible = false;

		if(scrollPercentageTarget < 1)
			TweenMax.to(this._rightButton,  .2, {alpha:1, ease:Linear.easeNone, onStartScope:this, onStart:function(){this._rightButton.visible=true;}}, delay + scrollDuration + 1.25);

		if(scrollPercentageTarget > 0)
			TweenMax.to(this._leftButton,  .2, {alpha:1, ease:Linear.easeNone, onStartScope:this, onStart:function(){this._leftButton.visible=true;}}, delay + scrollDuration + 1.25);
	}

	// Music
	if(!!Common.bgMusic) Common.bgMusic.fadeOut(0, 500);
	Common.bgMusic = SoundSFX.play('mx_frozen_05_map_lp', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);

	// Loss streak reward
	if(Common.savedData.lossStreak.count >= this._assetManager.getJSON("config").lossStreak.losses && !Common.savedData.lossStreak.awarded)
	{
		Common.animator.setTimeout(function()
		{
			this.signals.GUIButtonClicked.dispatch("reward");
		}, 1, this);

		this._coinsContainer._text.text = Common.savedData.coins + this._assetManager.getJSON("config").lossStreak.reward;
	}
	// Show collect all crystals message?
	else if(Common.savedData.endGameMessage.levels.show   && !Common.savedData.endGameMessage.levels.shown ||
	        Common.savedData.endGameMessage.crystals.show && !Common.savedData.endGameMessage.crystals.shown ||
			Common.savedData.endGameMessage.trolls.show   && !Common.savedData.endGameMessage.trolls.shown)
	{
		Common.animator.setTimeout(function()
		{
			this.signals.GUIButtonClicked.dispatch("endgame");
		}, 1, this);
	}
	// Show promo?
	else if(Common.savedData.canShowPromo())
	{
		Common.animator.setTimeout(function()
		{
			this.signals.GUIButtonClicked.dispatch("promo");
		}, 1, this);
	}
};

/**
 * Dispose
 */
LevelSelectScreen.prototype.dispose = function()
{

}

/**
 * Update
 */
LevelSelectScreen.prototype.update = function()
{
    SimpleScreen.prototype.update.call(this);

	this.backgroundPS.update(p3.Timestep.deltaTime);
	this.ripplesLowerPS.update(p3.Timestep.deltaTime);
	this.ripplesUpperPS.update(p3.Timestep.deltaTime);
	this.ripplesBridgePS.update(p3.Timestep.deltaTime);
	this.poolSparklesPS.update(p3.Timestep.deltaTime);

	if(!!this.unlockPS)
		this.unlockPS.update(p3.Timestep.deltaTime);

	if(this._rightButtonHeld)
	{
		this._speed += this._accelleration * p3.Timestep.deltaTime;
		if(this._speed > this._speedMax) this._speed = this._speedMax;
	}
	else if(this._leftButtonHeld)
	{
		this._speed -= this._accelleration * p3.Timestep.deltaTime;
		if(this._speed < -this._speedMax) this._speed = -this._speedMax;
	}
	else
	{
		if(this._speed < 0)
		{
			this._speed += this._decelleration * p3.Timestep.deltaTime;
			if(this._speed > 0)
				this._speed = 0;
		}
		else if(this._speed > 0)
		{
			this._speed -= this._decelleration * p3.Timestep.deltaTime;
			if(this._speed < 0)
				this._speed = 0;
		}
	}

	this._scrollPercentage += this._speed * p3.Timestep.deltaTime;

	if(this._scrollPercentage < 0)
	{
		this._scrollPercentage = 0;
		this._leftButtonHeld = false;

		var tl = new TimelineMax();
		tl.to(this._leftButton,  .2, {alpha:0, ease:Linear.easeNone, onCompleteScope:this, onComplete:function(){this._leftButton.visible = false}}, 0);
		Common.animator.add(tl);
	}
	else if(this._scrollPercentage > 1)
	{
		this._scrollPercentage = 1;
		this._rightButtonHeld = false;

		var tl = new TimelineMax();
		tl.to(this._rightButton,  .2, {alpha:0, ease:Linear.easeNone, onCompleteScope:this, onComplete:function(){this._rightButton.visible = false}}, 0);
		Common.animator.add(tl);

	}
	else if(this._speed != 0)
	{
		if(this._rightButton.alpha == 0)
		{
			this._rightButton.visible = true;
			var tl = new TimelineMax();
			tl.to(this._rightButton,  .2, {alpha:1, ease:Linear.easeNone}, 0);
			Common.animator.add(tl);
		}

		if(this._leftButton.alpha == 0)
		{
			this._leftButton.visible = true;
			var tl = new TimelineMax();
			tl.to(this._leftButton,  .2, {alpha:1, ease:Linear.easeNone}, 0);
			Common.animator.add(tl);
		}
	}

	var xMin = this._centre.x - (Math.min(Common.STAGE_WIDTH, p3.View.width)/2) + this._mapHolderBuffer;;
	var xMax = xMin - this._mapHolder._mapPiece1.width - this._mapHolder._mapPiece2.width + Math.min(Common.STAGE_WIDTH, p3.View.width) - 2 * this._mapHolderBuffer;
	this._mapHolder.x = xMin + (xMax - xMin) * this._scrollPercentage;
};

/**
 * On resize callback
 */
LevelSelectScreen.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);

	this._leftButton.x  = this._getBorderButtonPositionLeft();
	this._rightButton.x = this._getBorderButtonPositionRight();
	this._bkButton.x  = this._getFirstButtonPositionLeft();
	this._muteButton.x  = this._getFirstButtonPositionRight();
	this._helpButton.x  = this._getSecondButtonPositionRight();
};

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
LevelSelectScreen.prototype.animateIn = function(callback, scope) {

    SimpleScreen.prototype.animateIn.call(this);

	// var tl = new TimelineMax();
	// tl.to(this._helpButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 1);
	// tl.to(this._muteButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 1.1);
	// tl.to(this._bkButton.scale,  .5, {x:1, y:1, ease:Back.easeOut}, 1);
	// Common.animator.add(tl);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
LevelSelectScreen.prototype.animateOut = function(callback, scope) {

    SimpleScreen.prototype.animateOut.call(this);
};

//===================================================
// PRIVATE METHODS
//===================================================


/**
 * @param {!String} character
 * @param {!Number} frameLimit
 * @returns {!p3.MovieClipSequence}
 */
LevelSelectScreen.prototype._generateAnimationSequence = function(character, frameLimit, frameStart)
{
	if(!frameStart) frameStart = 0;

	var textureArr = [];
	for(var i = frameStart + 1; i <= frameStart + frameLimit; i++)
	{
		var n = "" + i;
		while(n.length < 2) n = "0" + n;
		textureArr.push(character + "_" + n);
	}
	for(var i = 0; i < textureArr.length; i++)
	{
		textureArr[i] = this._assetManager.getTexture(textureArr[i]);
	}
	var sequence = new p3.MovieClipSequence();
	sequence.addTextures(textureArr);

	return sequence;
}

//===================================================
// EVENTS
//===================================================

LevelSelectScreen.prototype.onLevelClicked = function(button)
{
	console.log("Selected level %i", button._id);
	Common.savedData.level = button._id;
    this.signals.requestedNextScreen.dispatch(button.id);
	SoundSFX.play("sfx_btn_press_00");
}

LevelSelectScreen.prototype.onHelpPressed = function(e)
{
	this.signals.GUIButtonClicked.dispatch("help");
	SoundSFX.play("sfx_btn_press_00");
}

LevelSelectScreen.prototype.onLeftDown = function()
{
    if(this._scrollEnabled)
    {
        this._leftButtonHeld = true;
    }
};

LevelSelectScreen.prototype.onLeftUp = function()
{
    if(this._scrollEnabled)
    {
        this._leftButtonHeld = false;
    }
};

LevelSelectScreen.prototype.onRightDown = function()
{
    if(this._scrollEnabled)
    {
        this._rightButtonHeld = true;
    }
};

LevelSelectScreen.prototype.onRightUp = function()
{
    if(this._scrollEnabled)
    {
        this._rightButtonHeld = false;
    }
};

LevelSelectScreen.prototype.onBackPressed = function()
{
	this.signals.requestedPreviousScreen.dispatch("back");
	SoundSFX.play("sfx_btn_press_00");
};


LevelSelectScreen.prototype.onTouchStart = function(e)
{
	this.isTouchScrolling = true;
	this.touchPosition = e.data.getLocalPosition(this).x;
};

LevelSelectScreen.prototype.onTouchMove = function(e)
{
	if(this.isTouchScrolling)
	{
		var delta   = e.data.getLocalPosition(this).x - this.touchPosition;
		this._speed = -delta/20; //magic numbers, yay

		this.touchPosition = e.data.getLocalPosition(this).x;
	}
};

LevelSelectScreen.prototype.onTouchEnd = function(e)
{
	this.isTouchScrolling = false;
    this._leftButtonHeld    = false;
    this._rightButtonHeld   = false;
};




//===================================================
// GETTERS/SETTERS
//===================================================



},{"../Common":2,"../general/LevelSelectButton":42,"../general/SoundSFX":44,"./SimpleScreen":73}],72:[function(require,module,exports){
/**
 *  Preloader
 *
 *  Created by Legman on 5/04/2015.
 *
 */

var SimpleScreen        = require("./SimpleScreen");

var Common              = require("../Common");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function Preloader()
{
    this.loadedPercentage   = 0.0;

	this._crystalsContainer = null;
	this._crystals          = [];
    this._loadingText       = null;
	this._index             = 0;

    SimpleScreen.call(this);
}
module.exports = Preloader;
Preloader.prototype = Object.create(SimpleScreen.prototype);
Preloader.prototype.constructor = Preloader;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
Preloader.prototype.init = function()
{
    console.log("PRELOADER INITIALIZED");
    SimpleScreen.prototype.init.call(this);

	// Background
    var bg = new PIXI.Sprite(this._assetManager.getTexture("preloader_bg"));
    this.addChild(bg);

	// Crystal container
    this._crystalsContainer = new PIXI.Sprite(this._assetManager.getTexture("ui_loading_crystals_bg"));
    this._crystalsContainer.anchor = new PIXI.Point(0.5, 0.5);
    this._crystalsContainer.x = (Common.STAGE_WIDTH / 2);
    this._crystalsContainer.y = (Common.STAGE_HEIGHT / 2) + 120;
    this.addChild(this._crystalsContainer);

	for(var i = 1; i <= 12; i++)
	{
		var crystal = new PIXI.Sprite(this._assetManager.getTexture("ui_loading_crystals_" + i));
		crystal.anchor = new PIXI.Point(0.5, 0.5);
		crystal.visible = false;
		this._crystalsContainer.addChild(crystal);
		this._crystals.push(crystal);
	}


    this.loadedPercentage = 0.0;

    this._loadingText = new PIXI.Text("0%", {font:"24px Arial", fill:0xFFFFFF, align:'center'});
    this._loadingText.x = Common.STAGE_WIDTH / 2;
    this._loadingText.y = Common.STAGE_HEIGHT / 2;
    // this.addChild(this._loadingText);
};

/**
 */
Preloader.prototype.dispose = function()
{
    SimpleScreen.prototype.dispose.call(this);
};

/**
 */
Preloader.prototype.resize = function()
{
    SimpleScreen.prototype.resize.call(this);

    this.x = (p3.View.width - Common.STAGE_WIDTH) * 0.5;
    this.y = (p3.View.height - Common.STAGE_HEIGHT) * 0.5;
};

/**
 */
Preloader.prototype.update = function()
{
    // console.log("LOADING: " + this.loadedPercentage);
    // this.loadedPercentage += 0.1;

    // if(this.loadedPercentage > 100)
        // this.loadedPercentage = 0;*/

    this._loadingText.text = Math.round(this.loadedPercentage);

	for(var i = 0; i < (this.loadedPercentage * (this._crystals.length))/100; i++)
	{	
		this._crystals[i].visible = true;
	}
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
Preloader.prototype.animateIn = function(callback, scope)
{
    SimpleScreen.prototype.animateIn.call(callback, scope);
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
Preloader.prototype.animateOut = function(callback, scope) {
    SimpleScreen.prototype.animateOut.call(callback, scope);

    var timeline = new TimelineMax({
        onComplete: callback,
        onCompleteScope: scope
    });
    this._tweens.push(timeline);
};

//===================================================
// PRIVATE METHODS
//===================================================

//===================================================
// EVENTS
//===================================================

//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"./SimpleScreen":73}],73:[function(require,module,exports){

var Common          = require("../Common");
var Scene           = require("../lib/Scene");
var WireframeButton = require("../general/WireframeButton");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function SimpleScreen() 
{
    /**
     * @type {signals.Signal}
     */
    this.signals = {};
    this.signals.requestedNextScreen = new signals.Signal();
    this.signals.requestedPreviousScreen = new signals.Signal();
    this.signals.GUIButtonClicked = new signals.Signal();

    /**
     * @type {p3.AssetManager}
     * @protected
     */
    this._assetManager = p3.AssetManager.instance;
	
    /**
     * @type {Array.<TweenMax>}
     * @protected
     */
    this._tweens = null;

    /**
     * @type {PIXI.Point}
     */
    this._centre = null;

    /**
     * @type {Number}
     */
    this._leftEdge = 0;

    /**
     * @type {Number}
     */
    this._rightEdge = 0;

    /**
     * @type {Number}
     */
    this._guiButtonTopMargin = 100;
	
    p3.Screen.call(this);
}
module.exports = SimpleScreen;
SimpleScreen.prototype = Object.create(Scene.prototype);
SimpleScreen.prototype.constructor = SimpleScreen;

//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
SimpleScreen.prototype.init = function() {
    this._tweens = [];
    this._centre = new PIXI.Point(Common.STAGE_WIDTH/2, Common.STAGE_HEIGHT/2);
};

/**
 */
SimpleScreen.prototype.dispose = function() {
    this.signals.requestedNextScreen.dispose();
    this.signals.requestedPreviousScreen.dispose();

    var tween;
    for (var i = 0; i < this._tweens.length; ++ i) {
        tween = this._tweens[i];
        if (tween) {
            tween.kill();
        }
    }
    this._tweens.length = 0;

    console.log("screen disposed");

    TweenMax.killAll();
    Common.animator.removeAll();
};

/**
 */
SimpleScreen.prototype.resize = function() {

    this.x = (p3.View.width - Common.STAGE_WIDTH) * 0.5;

    this._rightEdge = this._centre.x + (p3.View.width/2);
    this._leftEdge = this._centre.x - (p3.View.width/2);

	if(this._coinsContainer)
		this._coinsContainer.x = this._getSecondButtonPositionLeft();

	/*
    if(this._backButton)
    {
        this._backButton.x = this._getFirstButtonPositionLeft();
    }

    if(this._pauseButton)
    {
        this._pauseButton.x = this._getFirstButtonPositionRight();
    }

    if(this._helpButton)
    {
        this._helpButton.x = this._getSecondButtonPositionRight();
    }

    if(this._muteButton)
    {
        this._muteButton.x = this._getFirstButtonPositionRight();
    }
	*/
};

/**
 */
SimpleScreen.prototype.activate = function() {
    this.animateIn(function() {

    }, this);
};

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
SimpleScreen.prototype.animateIn = function(callback, scope) {
    scope = scope || window;
};

/**
 * @param {Function=} callback
 * @param {*=} scope
 */
SimpleScreen.prototype.animateOut = function(callback, scope) {
    scope = scope || window;
};

/*
SimpleScreen.prototype.initPauseButton = function()
{
    this._pauseButton = new WireframeButton("Pause");
    this._pauseButton.id = "pause";
    this._pauseButton.y = this._guiButtonTopMargin;
    this._pauseButton.scale = new PIXI.Point(0.6, 0.6);
    this._pauseButton.signals.clicked.add(this.onGUIButtonClicked, this);
    //this._pauseButton.downSoundName = "sfx_btn_press_fwd_00";
    this.addChild(this._pauseButton);
};

SimpleScreen.prototype.initHelpButton = function()
{
    this._helpButton = new WireframeButton("Help");
    this._helpButton.id = "help";
    this._helpButton.y = this._guiButtonTopMargin;
    this._helpButton.scale = new PIXI.Point(0.6, 0.6);
    this._helpButton.signals.clicked.add(this.onGUIButtonClicked, this);
    //this._pauseButton.downSoundName = "sfx_btn_press_fwd_00";
    this.addChild(this._helpButton);
};

SimpleScreen.prototype.initBackButton = function(home)
{
    this._backButton = new WireframeButton(home ? "Home" : "Back");
    this._backButton.id = "back";
    this._backButton.scale = new PIXI.Point(0.6, 0.6);
    this._backButton.y = this._guiButtonTopMargin;
    this._backButton.signals.clicked.add(this.onGUIButtonClicked, this);
    //this._pauseButton.downSoundName = "sfx_btn_press_fwd_00";
    this.addChild(this._backButton);
};

SimpleScreen.prototype.initMuteButton = function()
{
    var soundOn = new WireframeButton("Sound On");
    var soundOff = new WireframeButton("Sound Off");

    var blank = new PIXI.Container();
    var blankTexture = blank.generateTexture(Common.renderer, 1.0, PIXI.SCALE_MODES.LINEAR);

    this._muteButton = new p3.MuteButton(blankTexture,
                                     blankTexture,
                                     blankTexture,
                                     soundOn.texture,
                                     soundOff.texture
                                     );
    this._muteButton.id = "mute";
    this._muteButton.scale = new PIXI.Point(0.6, 0.6);
    this._muteButton.y = this._guiButtonTopMargin;
    this.addChild(this._muteButton);
};
*/


SimpleScreen.prototype.initCoinCointainer = function(value)
{
	value = (typeof(value) != "undefined") ? value : Common.savedData.coins;
	
	if(!this._coinsContainer)
	{
		this._coinsContainer = new PIXI.Container();
		this._coinsContainer.y = this._guiButtonTopMargin;
		this.addChild(this._coinsContainer);

			this._coinsContainer._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_snowflake_bg"));
			this._coinsContainer._bg.anchor.set(0, 0.5);
			this._coinsContainer.addChild(this._coinsContainer._bg);

			this._coinsContainer._text = new PIXI.extras.BitmapText(value.toString(), {font: "32px Superclarendon Numbers", align: "center"});
			this._coinsContainer._text.x = -this._coinsContainer._text.textWidth/2  + this._coinsContainer.width/2 + 15;
			this._coinsContainer._text.y = -this._coinsContainer._text.textHeight/2;
			this._coinsContainer.addChild(this._coinsContainer._text);

			// this._coinsContainer._text = new PIXI.Text(Common.savedData.coins, {font:"24px Arial", fill:0xffffff, align:'center'});
			// this._coinsContainer._text.x = this._coinsContainer.width/2 + 10;
			// this._coinsContainer._text.anchor.set(0.5);
			// this._coinsContainer.addChild(this._coinsContainer._text);

			this._coinsContainer._snowflake = new PIXI.Sprite(this._assetManager.getTexture("ui_icon_snowflake"));
			this._coinsContainer._snowflake.x = 20;
			this._coinsContainer._snowflake.anchor.set(0.5);
			this._coinsContainer.addChild(this._coinsContainer._snowflake);
	}
	else
	{	
		this._coinsContainer._text.x += this._coinsContainer._text.textWidth/2;
		this._coinsContainer._text.text = value.toString();
		this._coinsContainer._text.validate();
		this._coinsContainer._text.x -= this._coinsContainer._text.textWidth/2;
	}
};

/**
 */
SimpleScreen.prototype.hideGUI = function() {

};

/**
 */
SimpleScreen.prototype.showGUI = function() {

};


//===================================================
// PRIVATE METHODS
//===================================================


/**
 * @returns {Number}
 */
SimpleScreen.prototype._getFirstButtonPositionRight = function()
{
	return this._getBorderButtonPositionRight() - 90;
}

/**
 * @returns {Number}
 */
SimpleScreen.prototype._getSecondButtonPositionRight = function()
{
	return this._getFirstButtonPositionRight() - 100;
}

/**
 * @returns {Number}
 */
SimpleScreen.prototype._getBorderButtonPositionRight = function()
{
	return Math.min(Math.round((Common.STAGE_WIDTH + p3.View.width) * 0.5), Common.STAGE_WIDTH - 150);
}


/**
 * @returns {Number}
 */
SimpleScreen.prototype._getFirstButtonPositionLeft = function()
{
    return this._getBorderButtonPositionLeft() + 90;
}

/**
 * @returns {Number}
 */
SimpleScreen.prototype._getSecondButtonPositionLeft = function()
{
    return this._getFirstButtonPositionLeft() + 100;
}

/**
 * @returns {Number}
 */
SimpleScreen.prototype._getBorderButtonPositionLeft = function()
{
   return Math.max(Math.round((Common.STAGE_WIDTH - p3.View.width) * 0.5), 150);
}


//===================================================
// EVENTS
//===================================================

SimpleScreen.prototype.onGUIButtonClicked = function(button)
{
    if(button.id == "back")
        this.signals.requestedPreviousScreen.dispatch(button.id);
    else
        this.signals.GUIButtonClicked.dispatch(button.id);
};

/**
 * @param {!p3.Button} button
 */
SimpleScreen.prototype.onButtonClickedPrevious = function(button) {

};


//===================================================
// GETTERS/SETTERS
//===================================================

//===================================================


},{"../Common":2,"../general/WireframeButton":45,"../lib/Scene":50}],74:[function(require,module,exports){
var Common       	  = require("../Common");
var SimpleScreen 	  = require("./SimpleScreen");
var WireframeButton   = require("../general/WireframeButton");
var SoundSFX          = require("../general/SoundSFX");

//===================================================
// CONSTRUCTOR
//===================================================

/**
 * @constructor
 */
function SplashScreen()
{
	this.zoom = 1;
	this.focusPosition    = new PIXI.Point(Common.STAGE_WIDTH / 2, Common.STAGE_HEIGHT / 2);
	this.oldFocusPosition = new PIXI.Point(this.focusPosition.x, this.focusPosition.y);
	this.focusPoint    = new PIXI.Point(0.5, 0.5);

	this._mainContainer = null;
	this._centralArea   = null;
	this._leftArea      = null;
	this._rightArea     = null;

	this._leftButton  = null;
	this._rightButton = null;

	this._currentScreen = 1;
	this._currentcomm   = 0;
	this._commsData = null;
	this._comms = [];

	this.handleActive = false;
	this.handleY      = 0;
	this.handleMinY   = - 180;
	this.handleMaxY   = + 200;

	this.handleSFX = null;
	this.handleSFXCountdown = 0;

	this.parallaxLayers = [];

	SimpleScreen.call(this);

	this.isEndlessUnlocked = Common.savedData.levelsUnlocked > this._assetManager.getJSON("config").endless.levelRequired
	this.showIntro = Common.savedData.showSplashIntro;
	Common.savedData.showSplashIntro = false;

	this.signals.linkClick = new signals.Signal();
}

module.exports = SplashScreen;
SplashScreen.prototype = Object.create(SimpleScreen.prototype);
SplashScreen.prototype.constructor = SplashScreen;


//===================================================
// PUBLIC METHODS
//===================================================

/**
 */
SplashScreen.prototype.init = function()
{
	SimpleScreen.prototype.init.call(this);

	// Background
	this._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_bg_main_menu"));
    this.addChild(this._bg);

	// Northern lights
	this._northernLights = new PIXI.Container();

		var layers = [];
		layers.push({image:"northern_lights_blue",  xScale:4,   yScale:2,   y:-180,  xTiling:15,});
		layers.push({image:"northern_lights_green", xScale:4,   yScale:2,   y:-215,  xTiling:-20});
		layers.push({image:"northern_lights_pink",  xScale:4,   yScale:2,   y:-250,  xTiling:10, });

		for(var i = 0; i < layers.length; i++)
		{
			var texture  = this._assetManager.getTexture(layers[i].image);
			var bg       = new PIXI.extras.TilingSprite(texture, Common.STAGE_WIDTH, texture.crop.height * layers[i].yScale);
			bg.tileScale = new PIXI.Point(layers[i].xScale, layers[i].yScale);
			bg.y         = layers[i].y;
			bg.alpha     = Common.savedData.getCollectedCrystalCount() / Common.savedData.getCrystalCount();
			bg.xTiling   = layers[i].xTiling;
			this._northernLights.addChild(bg);
		}

	this._bg.addChild(this._northernLights);


	// Main container
	this._mainContainer = new PIXI.Container();
	this.addChild(this._mainContainer);

	// Background elements
	this._background = new PIXI.Container();
	this._background.x = Common.STAGE_WIDTH/2;
	this._background.y = Common.STAGE_HEIGHT -100;
	this._mainContainer.addChild(this._background);

		// this._background._blur = new PIXI.filters.BlurFilter();
		// this._background._blur.blurX = 6;
		// this._background._blur.blurY = 6;
		// this._background.filters = [this._background._blur];

		this._background._rock_00 =  new PIXI.Sprite(this._assetManager.getTexture("menu_rock_00"));
		this._background._rock_00.anchor.set(0.5, 1);
		this._background._rock_00.x -= 350;
		this._background.addChild(this._background._rock_00);

		this._background._tree_00 =  new PIXI.Sprite(this._assetManager.getTexture("menu_tree_05"));
		this._background._tree_00.anchor.set(0.5, 1);
		this._background._tree_00.x -= 500;
		this._background.addChild(this._background._tree_00);

		this._background._tree_01 =  new PIXI.Sprite(this._assetManager.getTexture("menu_tree_06"));
		this._background._tree_01.anchor.set(0.5, 1);
		this._background._tree_01.x += 480;
		this._background._tree_01.y += 100;
		this._background.addChild(this._background._tree_01);

		this._background._tree_02 =  new PIXI.Sprite(this._assetManager.getTexture("menu_tree_05"));
		this._background._tree_02.anchor.set(0.5, 1);
		this._background._tree_02.x += 950;
		this._background._tree_02.scale.set(-0.8, 0.8);
		this._background.addChild(this._background._tree_02);

		this._background._tree_03 =  new PIXI.Sprite(this._assetManager.getTexture("menu_tree_06"));
		this._background._tree_03.anchor.set(0.5, 1);
		this._background._tree_03.x -= 980;
		this._background._tree_03.y += 40;
		this._background._tree_03.scale.set(0.7, 0.7);
		this._background.addChild(this._background._tree_03);

		this._background._carriage_00 =  new PIXI.Sprite(this._assetManager.getTexture("menu_carriage_00"));
		this._background._carriage_00.anchor.set(0.5, 1);
		this._background._carriage_00.x += 420;
		this._background._carriage_00.y += -110;
		this._background.addChild(this._background._carriage_00);

		var texture = this._assetManager.getTexture("ui_menu_snow");
		this._background._bg = new PIXI.extras.TilingSprite(texture, Common.STAGE_WIDTH * 3, texture.height);
		this._background._bg.anchor.set(0.5, 1);
		this._background._bg.tilePosition.x += texture.width/2;
		this._background.addChild(this._background._bg);

		var fill = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
		fill.width = Common.STAGE_WIDTH * 3;
		fill.height = 300;
		fill.tint = 0x9bc6e5;
		fill.anchor.set(0.5, 0);
		this._background.addChild(fill);

	// Background particles
	this._backgroundPSContainer = new PIXI.Container();
	this._backgroundPSContainer.x = Common.STAGE_WIDTH/2;
	this._backgroundPSContainer.alpha = this.showIntro ? 0 : 1;
	this._mainContainer.addChild(this._backgroundPSContainer);

	this.backgroundPS = new cloudkid.Emitter(this._backgroundPSContainer,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_menu_snow"));

	this.backgroundPS.update(5);
	this.backgroundPS.emit = true;

	// Left area
    this._leftArea = new PIXI.Container();
    this._leftArea.x = (Common.STAGE_WIDTH / 2) - 1000;
    this._leftArea.y = Common.STAGE_HEIGHT / 2;
    this._mainContainer.addChild(this._leftArea);

		// Title
		this._leftArea._title = new PIXI.Sprite(this._assetManager.getTexture("ui_title_bg"));
		this._leftArea._title.anchor.set(0.5);
		this._leftArea._title.position.set(- 100, -290);
		this._leftArea.addChild(this._leftArea._title);

			var copy = this._assetManager.getJSON("strings")["GOALS"][Common.COUNTRY_CODE];

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "50px Superclarendon Title Purple", align: "center"});
				text.x = -text.textWidth/2;
				text.y = -text.textHeight/2 - 4;
				this._leftArea._title.addChild(text);
			}
			else
			{
				var copy = this._assetManager.getJSON("strings")["GOALS"][Common.COUNTRY_CODE];
				var text = new PIXI.Text(copy, {font:"36px Arial", fill:0x000000, align:'center'});
				text.anchor.set(0.5);
				text.y -= 5;
				this._leftArea._title.addChild(text);
			}

		// Goals list
		this._leftArea._goalsContainer = new PIXI.Container();
		this._leftArea._goalsContainer.position.set(-100, -140);
		this._leftArea.addChild(this._leftArea._goalsContainer);

		this._leftArea._blur = new PIXI.filters.BlurFilter();
		this._leftArea._blur.blurX = 0;
		this._leftArea._blur.blurY = 0;
		this._leftArea.filters = [this._leftArea._blur];

		this._leftArea._goals = [];

			var activeGoals = Common.goalsManager.getActiveGoals();

			for(var active = 1; active >= 0; active--)
			{
				for(var i = 0; i < Common.goalsManager.goals.length; i++)
				{
					var id = Common.goalsManager.goals[i].id;
					var goalStatus = Common.goalsManager.getGoalStatus(id);

					// Show the active goals first, then the rest
					var keep = (active == 0);

					for(var j = 0; j < activeGoals.length; j++)
					{
						if(activeGoals[j].id == id)
						{
							keep = !keep;
							break;
						}
					}

					if(!keep) continue;

					// Goal
					var goal = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_" + ((i%4)+1)));
					goal.anchor.set(0.5);
					goal.y = this._leftArea._goals.length * 100;
					this._leftArea._goalsContainer.addChild(goal);
					this._leftArea._goals.push(goal);

					var icon = new PIXI.Sprite(this._assetManager.getTexture(Common.goalsManager.goals[i].icon));
					icon.anchor.set(0, 0.5);
					icon.x = - 360;
					goal.addChild(icon);

					if(!webfont)
					{
						var text = new PIXI.extras.BitmapText(Common.goalsManager.goals[i].label, {font: "28px Mikadan Title", align: "left"});
						text.maxWidth = 400;
						text.updateText();
						text.x = -180;
						text.y = -text.textHeight/2;
						goal.addChild(text);
					}
					else
					{
						var text = new PIXI.Text(Common.goalsManager.goals[i].label, {font:"28px Arial", fill:0xFFFFFF, align: (r2l ? 'right' : 'left'), wordWrap:true, wordWrapWidth:400});
						text.x = r2l ? 220 : -180;
						text.anchor.set(r2l ? 1 : 0, 0.5);
						goal.addChild(text);
					}

					var progress = new PIXI.Container();
					progress.x = 300
					goal.addChild(progress);

						if(goalStatus == 1)
						{
							var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_complete"));
							progressBg.anchor.set(0.5);
							progress.addChild(progressBg);
						}
						else
						{
							var progressBg = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_bar"));
							progressBg.anchor.set(0.5);
							progress.addChild(progressBg);

							if(goalStatus > 0)
							{
								var progressBar = new PIXI.Sprite(this._assetManager.getTexture("ui_goals_fill"));
								progressBar.anchor.set(0.5);
								progress.addChild(progressBar);

									var canvas = document.createElement('canvas');
									canvas.width  = 128;
									canvas.height = 128;
									var ctx = canvas.getContext("2d");

									ctx.moveTo(canvas.width/2, canvas.height/2);
									ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2, -Math.PI/2, 2*Math.PI*goalStatus-Math.PI/2);
									ctx.lineTo(canvas.width/2, canvas.height/2);
									ctx.fillStyle = 'white';
									ctx.fill();

									var mask = new PIXI.Sprite(PIXI.Texture.fromCanvas(canvas));
									mask.anchor.set(0.5);
									progressBar.addChild(mask);
									progressBar.mask = mask;
							}
						}
				}
			}

			var snow = new PIXI.Sprite(this._assetManager.getTexture("ui_snow_top"));
			snow.anchor.set(0.5, 1);
			snow.y = -15;
			snow.width = this._leftArea._goals[0].width+ 20;
			this._leftArea._goals[0].addChild(snow);

			// Mask
			var canvas = document.createElement('canvas');
			canvas.width  = 2;
			canvas.height = 512;
			var ctx = canvas.getContext("2d");

			var gradient = ctx.createLinearGradient(0,0,0,canvas.height);
			gradient.addColorStop(0, "rgba(255,255,255,0)");
			gradient.addColorStop(0.05, "rgba(255,255,255,1)");
			gradient.addColorStop(0.93, "rgba(255,255,255,1)");
			gradient.addColorStop(1, "rgba(255,255,255,0)");

			ctx.fillStyle = gradient;
			ctx.fillRect(0, 0, canvas.width, canvas.height);

			var mask = new PIXI.Sprite(PIXI.Texture.fromCanvas(canvas));
			mask.anchor.set(0.5, 0);
			mask.position.y -= 85;
			mask.width = 800;
			mask.height = 550;
			this._leftArea._goalsContainer.addChild(mask);
			this._leftArea._goalsContainer.mask = mask;

		// Goals scrollbar
		this._leftArea._goalsScroller = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_bg"));
		this._leftArea._goalsScroller.anchor.set(0.5);
		this._leftArea._goalsScroller.x = 330;
		this._leftArea._goalsScroller.y = 60;
		this._leftArea.addChild(this._leftArea._goalsScroller);

			var texture = this._assetManager.getTexture("ui_scroll_rope_tile");
			this._leftArea._goalsScroller._rope = new PIXI.extras.TilingSprite(texture, texture.width, this._leftArea._goalsScroller.height - 10);
			this._leftArea._goalsScroller._rope.anchor.set(0.5);
			this._leftArea._goalsScroller.addChild(this._leftArea._goalsScroller._rope);

			var cap = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_top"));
			cap.anchor.set(0.5, 1);
			cap.y = -this._leftArea._goalsScroller._rope.height/2 + 25;
			this._leftArea._goalsScroller._rope.addChild(cap);

			var cap = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_rope_bottom"));
			cap.anchor.set(0.5, 0);
			cap.y = this._leftArea._goalsScroller._rope.height/2 - 22;
			this._leftArea._goalsScroller._rope.addChild(cap);

			this._leftArea._goalsScroller._handle = new PIXI.Sprite(this._assetManager.getTexture("ui_scroll_handle"));
			this._leftArea._goalsScroller._handle.anchor      = new PIXI.Point(0.5, 0.5);
			this._leftArea._goalsScroller._handle.y           = this.handleMinY;
			this._leftArea._goalsScroller._handle.yReal       = this.handleMinY;
			this._leftArea._goalsScroller._handle.interactive = true;
			this._leftArea._goalsScroller.addChild(this._leftArea._goalsScroller._handle);

			this._leftArea._goalsScroller._handle.touchstart = this._leftArea._goalsScroller._handle.mousedown = function(e){this.onHandleDown(e)}.bind(this);
			this._leftArea._goalsScroller._handle.touchmove  = this._leftArea._goalsScroller._handle.mousemove = function(e){this.onHandleMove(e)}.bind(this);


	// Right area
    this._rightArea = new PIXI.Container();
    this._rightArea.x = (Common.STAGE_WIDTH / 2) + 1000;
    this._rightArea.y = Common.STAGE_HEIGHT / 2;
    this._mainContainer.addChild(this._rightArea);

		this._rightArea._bg = new PIXI.Sprite(this._assetManager.getTexture("ui_popup_bg"));
		this._rightArea._bg.anchor.set(0.5);
		this._rightArea._bg.y = 50;
		this._rightArea.addChild(this._rightArea._bg);

		var snow = new PIXI.Sprite(this._assetManager.getTexture("ui_snow_top"));
		snow.anchor.set(0.5, 1);
		snow.y = - 233;
		this._rightArea._bg.addChild(snow);

		this._rightArea._commContainer = new PIXI.Container();
		this._rightArea._commContainer.y = 50;
		this._rightArea.addChild(this._rightArea._commContainer);

			this._commsData = this._assetManager.getJSON("strings").comms;

			for(var i = 0; i < this._commsData.length; i++)
			{
				var comm = new PIXI.Container();
				comm.alpha = (i == 0) ? 1 : 0;

				comm.image = new PIXI.Sprite(PIXI.Texture.fromImage('assets/images/hd/comms/' + this._commsData[i].image));
				comm.image.anchor.set(0.5, 0);
				comm.image.y = -205;
				comm.image.interactive = (i == 0);
				comm.image.buttonMode = true;
				comm.image.touchstart = comm.image.mousedown = function(e){this.onCommClick();}.bind(this);
				comm.addChild(comm.image);

				this._rightArea._commContainer.addChild(comm);
				this._comms.push(comm);
			}

			if(this._commsData.length > 1)
			{
				this._rightArea._leftButton = new p3.Button
				(
					this._assetManager.getTexture("ui_btn_nav_out"),
					this._assetManager.getTexture("ui_btn_nav_over"),
					this._assetManager.getTexture("ui_btn_nav_down"),
					this._assetManager.getTexture("ui_icon_nav_arrow")
				);
				this._rightArea._leftButton.overSoundName = "sfx_btn_rollover_00";
				this._rightArea._leftButton.children[1].x = -5;
				this._rightArea._leftButton.children[1].scale.x = -1;
				this._rightArea._leftButton.position.set(-385, 260);
				this._rightArea._leftButton.signals.down.add(this.onCommPrev, this);
				this._rightArea.addChild(this._rightArea._leftButton);

				this._rightArea._rightButton = new p3.Button
				(
					this._assetManager.getTexture("ui_btn_nav_out"),
					this._assetManager.getTexture("ui_btn_nav_over"),
					this._assetManager.getTexture("ui_btn_nav_down"),
					this._assetManager.getTexture("ui_icon_nav_arrow")
				);
				this._rightArea._rightButton.overSoundName = "sfx_btn_rollover_00";
				this._rightArea._rightButton.position.set(385, 260);
				this._rightArea._rightButton.signals.down.add(this.onCommNext, this);
				this._rightArea.addChild(this._rightArea._rightButton);

				if(r2l)
				{
					this._rightArea._leftButton.scale.set(-1,1);
					this._rightArea._leftButton.position.set(385, 260);
					this._rightArea._rightButton.scale.set(-1,1);
					this._rightArea._rightButton.position.set(-385, 260);
				}
			}

	// Characters
	this._characters = new PIXI.Container();
	this._characters.x = Common.STAGE_WIDTH / 2;
	this._characters.y = Common.STAGE_HEIGHT;
	this._mainContainer.addChild(this._characters);

		this._characters._anna = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_character_anna_elsa"));
		this._characters._anna.anchor.set(0.5, 1);
		this._characters._anna.x = 420;
		this._characters._anna.y = 150;
		this._characters.addChild(this._characters._anna);

		this._characters._kristoff = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_character_kristoff"));
		this._characters._kristoff.anchor.set(0.5, 1);
		this._characters._kristoff.x = -200;
		this._characters._kristoff.y = 110;
		this._characters.addChild(this._characters._kristoff);

		this._characters._olaf = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_character_olaf"));
		this._characters._olaf.anchor.set(0.5, 1);
		this._characters._olaf.x = 320;
		this._characters._olaf.y = 0;
		this._characters.addChild(this._characters._olaf);

		this._characters._pabbie = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_character_pabbie"));
		this._characters._pabbie.anchor.set(0.5, 1);
		this._characters._pabbie.x = -370;
		this._characters._pabbie.y = 0;
		this._characters.addChild(this._characters._pabbie);


	// Center area
	this._centralArea = new PIXI.Container();
	this._centralArea.x = Common.STAGE_WIDTH / 2;
	this._centralArea.y = Common.STAGE_HEIGHT / 2;
	this._centralArea.alpha = this.showIntro ? 0.001 : 1;
	this._mainContainer.addChild(this._centralArea);

		// Story mode
		var crystalCount     = Common.savedData.getCrystalCount();
		var crystalCollected = Common.savedData.getCollectedCrystalCount();

		this._storyButton = new p3.Button
		(
			this._assetManager.getTexture("ui_btn_nav_out_big"),
			this._assetManager.getTexture("ui_btn_nav_over_big"),
			this._assetManager.getTexture("ui_btn_nav_down_big"),
			this._assetManager.getTexture("ui_icon_nav_play")
		);
		this._storyButton.overSoundName = "sfx_btn_rollover_00";
		this._storyButton.position.set(-160, 90 + (crystalCollected == crystalCount ? -20 : 0));
		this._storyButton.signals.down.add(this.onStoryClick, this);
		this._centralArea.addChild(this._storyButton);

		// Story label
		var copy = this._assetManager.getJSON("strings")["STORY"][Common.COUNTRY_CODE];
		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "50px Superclarendon Title", align: "center"});
			text.x = this._storyButton.position.x - text.textWidth/2;
			text.y = this._storyButton.position.y + 110 - text.textHeight/2;
			this._centralArea.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"48px Arial", fill:0xffffff, align:'center'});
			text.position.set(this._storyButton.position.x, this._storyButton.position.y + 110);
			text.anchor.set(0.5);
			this._centralArea.addChild(text);
		}

		// Troll count
		if(crystalCollected == crystalCount)
		{
			var trollCollected = Common.savedData.getCollectedTrollCount();
			var trollCount     = Common.savedData.getTrollCount();

			var trollBg = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_trolls"));
			trollBg.anchor.set(0.5, 1);
			trollBg.x = this._storyButton.x;
			trollBg.y = 395;
			this._centralArea.addChild(trollBg);

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(trollCollected + "/" + trollCount, {font: "20px Superclarendon Level", align: "center"});
				text.x = -text.textWidth/2 + 46;
				text.y = -text.textHeight/2 - 80;
				trollBg.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(trollCollected + "/" + trollCount, {font:"24px Arial", fill:0x000000, align:'center'});
				text.anchor.set(0.5);
				text.x += 45;
				text.y -= 78;
				trollBg.addChild(text);
			}
		}

		// Crystal count
		var storyBg = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_crystals_bg"));
		storyBg.anchor.set(0.5);
		storyBg.x = this._storyButton.x;
		storyBg.y = this._storyButton.y + 200 - 6;
		this._centralArea.addChild(storyBg);

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(crystalCollected + "/" + crystalCount, {font: "20px Superclarendon Level", align: "center"});
				text.x = -text.textWidth/2  - 46;
				text.y = -text.textHeight/2 - 16;
				storyBg.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(crystalCollected + "/" + crystalCount, {font:"24px Arial", fill:0x000000, align:'center'});
				text.anchor.set(0.5);
				text.x -= 45;
				text.y -= 12;
				storyBg.addChild(text);
			}



		// Endless mode
		this._endlessButton = new p3.Button
		(
			this._assetManager.getTexture(this.isEndlessUnlocked ? "ui_btn_nav_out_big"  : "ui_btn_nav_out_big_inactive"),
			this._assetManager.getTexture(this.isEndlessUnlocked ? "ui_btn_nav_over_big" : "ui_btn_nav_over_big_inactive"),
			this._assetManager.getTexture(this.isEndlessUnlocked ? "ui_btn_nav_down_big" : "ui_btn_nav_down_big_inactive"),
			this._assetManager.getTexture(this.isEndlessUnlocked ? "ui_icon_nav_play"    : "ui_icon_nav_lock")
		);
		this._endlessButton.x = 110;
		this._endlessButton.y = this._storyButton.position.y;
		this._endlessButton.signals.down.add(this.onEndlessClick, this);
		this._endlessButton.overSoundName = "sfx_btn_rollover_00";
		this._centralArea.addChild(this._endlessButton);

		if(!this.isEndlessUnlocked)
			this._endlessButton.children[1].position.set(-2, -3);



		// Endless label
		var copy = this._assetManager.getJSON("strings")["ENDLESS"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "50px Superclarendon Title", align: "center"});
			text.x = this._endlessButton.position.x - text.textWidth/2;
			text.y = this._endlessButton.position.y + 110 - text.textHeight/2;
			this._centralArea.addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"48px Arial", fill:0xffffff, align:'center'});
			text.position.set(this._endlessButton.position.x, this._endlessButton.position.y + 110);
			text.anchor.set(0.5);
			this._centralArea.addChild(text);
		}

		// Endless record
		var endlessBg = new PIXI.Sprite(this._assetManager.getTexture("ui_menu_hiscore_bg"));
		endlessBg.anchor.set(0.5);
		endlessBg.x = this._endlessButton.x;
		endlessBg.y = this._endlessButton.y + 185;
		this._centralArea.addChild(endlessBg);

			var copy = this._assetManager.getJSON("strings")["HISCORE"][Common.COUNTRY_CODE];
			copy = copy.replace("{value}", Common.savedData.getHighscore("endless"));

			if(!webfont)
			{
				var text = new PIXI.extras.BitmapText(copy, {font: "20px Superclarendon Level", align: "center"});
				text.x = -text.textWidth/2;
				text.y = -text.textHeight/2 - 6;
				endlessBg.addChild(text);
			}
			else
			{
				var text = new PIXI.Text(copy, {font:"20px Arial", fill:0x000000, align:'center'});
				text.anchor.set(0.5);
				text.y -= 4;
				endlessBg.addChild(text);
			}

	// Foreground particles
	this._foregroundPSContainer = new PIXI.Container();
	this._foregroundPSContainer.x = Common.STAGE_WIDTH/2;
	this._foregroundPSContainer.alpha = this.showIntro ? 0 : 1;
	this._mainContainer.addChild(this._foregroundPSContainer);

	this.foregroundPS = new cloudkid.Emitter(this._foregroundPSContainer,
	[
		this._assetManager.getTexture("particle_snowflake_00"),
		this._assetManager.getTexture("particle_snowflake_01"),
		this._assetManager.getTexture("particle_snowflake_02"),
		this._assetManager.getTexture("particle_snowflake_03")
	], this._assetManager.getJSON("particle_menu_snow"));

	this.foregroundPS.update(5);
	this.foregroundPS.emit = true;

	// Snow overlay
	this._overlay = new PIXI.Container();
	this._overlay.x = Common.STAGE_WIDTH/2;
	this._overlay.y = Common.STAGE_HEIGHT + 90;

	this._mainContainer.addChild(this._overlay);

		var texture = this._assetManager.getTexture("ui_menu_snow");
		this._overlay._bg = new PIXI.extras.TilingSprite(texture, Common.STAGE_WIDTH * 3, texture.height);
		this._overlay._bg.anchor.set(0.5, 1);
		this._overlay.addChild(this._overlay._bg);

		var fill = new PIXI.Sprite(Common.generatedTextures['whiteSquare']);
		fill.width = Common.STAGE_WIDTH * 3;
		fill.height = 300;
		fill.tint = 0x9bc6e5;
		fill.anchor.set(0.5, 0);
		this._overlay.addChildAt(fill, 0);


	//UI
	this._leftButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_sidenav_out"),
		this._assetManager.getTexture("ui_btn_sidenav_over"),
		this._assetManager.getTexture("ui_btn_sidenav_down"),
		this._assetManager.getTexture("ui_icon_sidenav_arrow")
	);
	this._leftButton.children[0].anchor.set(0, 0.5);
	this._leftButton.children[1].anchor.set(0, 0.5);
	this._leftButton.y = Common.STAGE_HEIGHT / 2;
	this._leftButton.alpha = this.showIntro ? 0 : 1;
	this._leftButton.signals.down.add(this.onLeftClick, this);
	this._leftButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._leftButton);

	this._rightButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_sidenav_out"),
		this._assetManager.getTexture("ui_btn_sidenav_over"),
		this._assetManager.getTexture("ui_btn_sidenav_down"),
		this._assetManager.getTexture("ui_icon_sidenav_arrow")
	);
	this._rightButton.scale.x = -1;
	this._rightButton.children[0].anchor.set(0, 0.5);
	this._rightButton.children[1].anchor.set(0, 0.5);
	this._rightButton.y = Common.STAGE_HEIGHT / 2;
	this._rightButton.alpha = this.showIntro ? 0 : 1;
	this._rightButton.signals.down.add(this.onRightClick, this);
	this._rightButton.overSoundName = "sfx_btn_rollover_00";
	this.addChild(this._rightButton);

	// Help button
	this._helpButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_help")
	);
	this._helpButton.overSoundName = "sfx_btn_rollover_00";
	this._helpButton.y = this._guiButtonTopMargin;
	this._helpButton.scale.set(0);
	this._helpButton.signals.down.add(this.onHelpPressed, this);
	this.addChild(this._helpButton);

	// Mute button
	this._muteButton = new p3.MuteButton
	(
		this._assetManager.getTexture("ui_btn_con_out"),
		this._assetManager.getTexture("ui_btn_con_over"),
		this._assetManager.getTexture("ui_btn_con_down"),
		this._assetManager.getTexture("ui_icon_con_sound_on"),
		this._assetManager.getTexture("ui_icon_con_sound_off")
	);
	this._muteButton.overSoundName = "sfx_btn_rollover_00";
	this._muteButton.id = "mute";
	this._muteButton.y = this._guiButtonTopMargin;
	this._muteButton.scale.set(0);
	this._muteButton.init();
	this.addChild(this._muteButton);

	// Code button
	this._codeButton = new p3.Button
	(
		this._assetManager.getTexture("ui_btn_code_normal"),
		this._assetManager.getTexture("ui_btn_code_over"),
		this._assetManager.getTexture("ui_btn_code_press"),
		Common.generatedTextures['whiteSquare']
	);
	this._codeButton.overSoundName = "sfx_btn_rollover_00";
	this._codeButton.y = this._guiButtonTopMargin;
	this._codeButton.scale.set(0);
	this._codeButton.signals.down.add(this.onCodePressed, this);
	this.addChild(this._codeButton);

		var copy = this._assetManager.getJSON("strings")["ENTER_CODE"][Common.COUNTRY_CODE];

		if(!webfont)
		{
			var text = new PIXI.extras.BitmapText(copy, {font: "28px Superclarendon Title", align: "center"});
			text.x = -text.textWidth/2;
			text.y = -text.textHeight/2;
			this._codeButton.children[0].addChild(text);
		}
		else
		{
			var text = new PIXI.Text(copy, {font:"28px Arial", fill:0xffffff, align:'center'});
			text.anchor.set(0.5);
			this._codeButton.children[0].addChild(text);
		}


	// Music
	if(!!Common.bgMusic) Common.bgMusic.fadeOut(0, 500);
	Common.bgMusic = SoundSFX.play('mx_frozen_03_main_menu_edit', {loop:true, volume:0});
	Common.bgMusic.fadeIn(Common.bgMusicVolume, 500);

	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_enter",
		game_tier1 : "enter",
		game_tier2 : "mainmenu"
	});

	// Show endless mode unlocked
	if(Common.savedData.endGameMessage.endless.show && !Common.savedData.endGameMessage.endless.shown)
	{
		Common.animator.setTimeout(function()
		{
			this.signals.GUIButtonClicked.dispatch("endless_unlocked");
		}, 1.2, this);

		Common.savedData.endGameMessage.endless.shown = true;
		Common.savedData.save();
	}

	// Parallax layers
	this.parallaxLayers.push({layer:this._background._rock_00,     parallax:{x:-0.2,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._tree_00,     parallax:{x:-0.15,  y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._tree_01,     parallax:{x:-0.125, y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._tree_02,     parallax:{x:-0.15,  y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._tree_03,     parallax:{x:-0.125, y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._carriage_00, parallax:{x:-0.13,  y:0, scale:1}});
	this.parallaxLayers.push({layer:this._background._bg,          parallax:{x:-0.1,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._characters._kristoff,    parallax:{x:0.15,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._characters._anna,        parallax:{x:0.15,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._characters._olaf,        parallax:{x:0.05,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._characters._pabbie,      parallax:{x:0.05,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._foregroundPSContainer,   parallax:{x:0.25,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._centralArea,             parallax:{x:0.40,   y:0, scale:1}});
	this.parallaxLayers.push({layer:this._overlay,                 parallax:{x:0.5,    y:0, scale:4}});

	// Animation
	this._leftArea.scale.set(1);
	// this._leftArea.x += 300;

	this._rightArea.scale.set(1);
	// this._rightArea.x -= 300;

	if(this.showIntro)
	{
		this.setZoom(0.6);
		this.changeZoom(1/this._centralArea.scale.x, 2, 1)

		// var tl = new TimelineMax();
		// tl.to(this._leftArea,  2, {x: this._leftArea.x  - 100, ease:Sine.easeInOut}, 1);
		// tl.to(this._leftArea,  2, {x: this._leftArea.x  - 100, ease:Sine.easeInOut}, 1);
		// tl.to(this._rightArea.scale, 2, {x: this._rightArea.x + 100, ease:Sine.easeInOut}, 1);
		// tl.to(this._rightArea, 2, {x: this._rightArea.x + 100, ease:Sine.easeInOut}, 1);
		// Common.animator.add(tl);
		// this._leftArea.x -= 100;
		// this._rightArea.x += 100;
	}
	else
	{
		this._leftArea.x -= 100;
		this._rightArea.x += 100;
	}
};

/**
 * Update
 */
SplashScreen.prototype.update = function()
{
	this._mainContainer.x = Common.STAGE_WIDTH  * this.focusPoint.x - this.focusPosition.x * this.zoom;
	this._mainContainer.y = Common.STAGE_HEIGHT * this.focusPoint.y - this.focusPosition.y * this.zoom;
	this._mainContainer.scale.set(this.zoom, this.zoom);

	this.backgroundPS.update(p3.Timestep.deltaTime);
	this.foregroundPS.update(p3.Timestep.deltaTime);

	if(!!this.handleSFX && this.handleSFXCountdown > 0)
	{
		this.handleSFXCountdown -= p3.Timestep.deltaTime;

		if(this.handleSFXCountdown <= 0)
		{
			this.handleSFX.stop();
			this.handleSFXCountdown = 0;
		}
	}

	// Northern lights
	for(var i = 0; i < this._northernLights.children.length; i++)
	{
		this._northernLights.children[i].tilePosition.x += p3.Timestep.deltaTime * this._northernLights.children[i].xTiling;
	}
};

/**
 * On resize callback
 */
SplashScreen.prototype.resize = function()
{
	SimpleScreen.prototype.resize.call(this);

	this._leftButton.x  = this._getBorderButtonPositionLeft();
	this._rightButton.x = this._getBorderButtonPositionRight();
	this._muteButton.x  = this._getFirstButtonPositionRight();
	this._helpButton.x  = this._getSecondButtonPositionRight();
	this._codeButton.x  = this._getFirstButtonPositionLeft() + 80;
};

/**
 * Dispose
 */
SplashScreen.prototype.dispose = function()
{
}

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
SplashScreen.prototype.animateIn = function(callback, scope)
{
	SimpleScreen.prototype.animateIn.call(this);

	var tl = new TimelineMax();
	tl.to(this._helpButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 1.3);
	tl.to(this._muteButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 1.4);
	tl.to(this._codeButton.scale, .5, {x:1, y:1, ease:Back.easeOut}, 1.5);

	if(this.showIntro)
	{
		tl.to(this._centralArea, 1, {alpha: 1, ease:Linear.easeNone}, 1);
		tl.to(this._backgroundPSContainer, 1, {alpha: 1, ease:Linear.easeNone}, 0.5);
		tl.to(this._foregroundPSContainer, 1, {alpha: 1, ease:Linear.easeNone}, 0.5);
		tl.to(this._leftButton,  0.5, {alpha: 1, ease:Linear.easeNone}, 1.5);
		tl.to(this._rightButton, 0.5, {alpha: 1, ease:Linear.easeNone}, 1.5);
	}

	Common.animator.add(tl);
};

/**
 * @param {Function=} callback
 * @param {*=}scope
 */
SplashScreen.prototype.animateOut = function(callback, scope)
{
	SimpleScreen.prototype.animateOut.call(this);

	var tl = new TimelineMax({onCompleteScope:scope, onComplete:callback});
	tl.to(this._helpButton.scale, .35, {x:0, y:0, ease:Back.easeIn}, 0);
	tl.to(this._muteButton.scale, .35, {x:0, y:0, ease:Back.easeIn}, 0);
	tl.to(this._codeButton.scale, .35, {x:0, y:0, ease:Back.easeIn}, 0);
	Common.animator.add(tl);
};

//===================================================
// PRIVATE METHODS
//===================================================

/**
 */
SplashScreen.prototype.animate = function(direction)
{
	if(TweenMax.isTweening(this)) return;
	if(TweenMax.isTweening(this.focusPosition)) return;

	if(Math.sign(direction) == 1)
	{
		this._currentScreen--;

		// Event Tracking
		Common.ctow.trackEvent(
		{
			event      : "game_enter",
			game_tier1 : "enter",
			game_tier2 :  this._currentScreen == 0 ? "goals" : "mainmenu"
		});
	}
	else
	{
		this._currentScreen++;

		// Event Tracking
		Common.ctow.trackEvent(
		{
			event      : "game_enter",
			game_tier1 : "enter",
			game_tier2 :  this._currentScreen == 2 ? "comscreen" : "mainmenu"
		});
	}


	switch(this._currentScreen)
	{
		case 0:
			SoundSFX.play("sfx_goals_screen_spotfx_00");
			this.changeZoom(1/this._leftArea.scale.x, 1)
			this.changeFocusPosition(new PIXI.Point(this._leftArea.x, this._leftArea.y), 1);
			break;

		case 1:
			SoundSFX.play("sfx_main_screen_spotfx_01");
			this.changeZoom(1/this._centralArea.scale.x, 1)
			this.changeFocusPosition(new PIXI.Point(Common.STAGE_WIDTH / 2, Common.STAGE_HEIGHT / 2), 1);
			break;

		case 2:
			SoundSFX.play("sfx_promo_screen_spotfx_00");
			this.changeZoom(1/this._rightArea.scale.x, 1)
			this.changeFocusPosition(new PIXI.Point(this._rightArea.x, this._rightArea.y), 1);
			break;
	}
}

/**
 */
SplashScreen.prototype.setLeftRightButtons = function()
{
	var tl = new TimelineMax();

	if(this._currentScreen <= 0)
		tl.to(this._leftButton,  .5, {alpha:0, ease:Sine.easeOut}, 0);
	else
		tl.to(this._leftButton,  .5, {alpha:1, ease:Sine.easeOut}, 0);

	if(this._currentScreen >= 2)
		tl.to(this._rightButton, .5, {alpha:0, ease:Sine.easeOut}, 0);
	else
		tl.to(this._rightButton, .5, {alpha:1, ease:Sine.easeOut}, 0);

	Common.animator.add(tl);

	this._leftButton.interactive  = this._currentScreen > 0;
	this._rightButton.interactive = this._currentScreen < 2;
}

/**
 * Set zoom
 * @param {Number} zoom (1: 100%)
 */
SplashScreen.prototype.setZoom = function(zoom)
{
	this.zoom = zoom;
}

/**
 * Change zoom over time
 * @param {Number} zoom (1: 100%)
 * @param {Number} time
 * @param {Number} delay
 */
SplashScreen.prototype.changeZoom = function(zoom, time, delay)
{
	if(this.zoomTween != null)
		this.zoomTween.kill();

	if(zoom == this.zoom) return;

	this.zoomTween = new TimelineMax();
	this.zoomTween.to(this, time, {zoom: zoom, ease:Sine.easeInOut}, !!delay ? delay : 0);
	Common.animator.add(this.zoomTween);

	this.zoomTarget = zoom;
}

/**
 * Change the focus point over time
 * @param {PIXI.Point} focusPoint
 * @param {Number} time
 * @param {Number} delay
 */
SplashScreen.prototype.changeFocusPoint = function(focusPoint, time, delay)
{
	if(this.focusPointTween != null)
		this.focusPointTween.kill();

	if(this.focusPoint.equal(focusPoint)) return;

	this.focusPointTween = new TimelineMax();
	this.focusPointTween.to(this.focusPoint, time, {x: focusPoint.x, y:focusPoint.y, ease:Sine.easeInOut}, !!delay ? delay : 0);
	Common.animator.add(this.focusPointTween);
}

/**
 * Change the focus position over time
 * @param {PIXI.Point} focusPoint
 * @param {Number} time
 * @param {Number} delay
 */
SplashScreen.prototype.changeFocusPosition = function(focusPosition, time, delay)
{
	if(this.focusPointTween != null)
		this.focusPointTween.kill();

	if(this.focusPosition.equal(focusPosition)) return;

	this.focusPointTween = new TimelineMax();
	this.focusPointTween.to(this.focusPosition, time, {x: focusPosition.x, y:focusPosition.y, ease:Sine.easeInOut, onUpdateScope:this, onUpdate:function()
		{
			var deltaPosition = new PIXI.Point(this.focusPosition.x - this.oldFocusPosition.x, this.focusPosition.y - this.oldFocusPosition.y);

			for(var i = 0; i < this.parallaxLayers.length; i++)
			{
				this.parallaxLayers[i].layer.x -= deltaPosition.x * this.parallaxLayers[i].parallax.x;
				this.parallaxLayers[i].layer.y -= deltaPosition.y * this.parallaxLayers[i].parallax.y;
			}

			this.oldFocusPosition.set(this.focusPosition.x, this.focusPosition.y);
		}
	}, !!delay ? delay : 0);
	Common.animator.add(this.focusPointTween);
}



//===================================================
// EVENTS
//===================================================

/**
 */
SplashScreen.prototype.onStoryClick = function()
{
	Common.savedData.endless = false;

	if(Common.savedData.levelsUnlocked == 1)
	{
		if(!Common.savedData.hasSeenIntro)
		{
			this.signals.requestedNextScreen.dispatch('intro');
		}
		else
		{
			this.signals.requestedNextScreen.dispatch('tutorial');
		}
	}
	else
	{
		this.signals.requestedNextScreen.dispatch('story');
	}

	Common.ctow.trackEvent(
	{
		event      : "game_enter",
		game_tier1 : "enter",
		game_tier2 : "story"
	});

	SoundSFX.play("sfx_btn_press_00");

	// Music end
	// Common.bgMusic.fadeOut(0, 600);
}

/**
 */
SplashScreen.prototype.onEndlessClick = function()
{
	var levelRequired = this._assetManager.getJSON("config").endless.levelRequired;

	if(!this.isEndlessUnlocked)
	{
		this.signals.GUIButtonClicked.dispatch("endless");
	}
	else
	{
		Common.savedData.endless = true;
		this.signals.requestedNextScreen.dispatch('endless');
	}

	Common.ctow.trackEvent(
	{
		event      : "game_enter",
		game_tier1 : "enter",
		game_tier2 : "endless"
	});

	SoundSFX.play("sfx_btn_press_00");

	// Music end
	// Common.bgMusic.fadeOut(0, 600);
}


/**
 */
SplashScreen.prototype.onHelpPressed = function(e)
{
	this.signals.GUIButtonClicked.dispatch("help");

	Common.ctow.trackEvent(
	{
		event      : "game_enter",
		game_tier1 : "enter",
		game_tier2 : "help"
	});

	SoundSFX.play("sfx_btn_press_00");
}

/**
 */
SplashScreen.prototype.onCodePressed = function(e)
{
	this.signals.GUIButtonClicked.dispatch("code");

	SoundSFX.play("sfx_btn_press_00");
}

/**
 */
SplashScreen.prototype.onLeftClick = function()
{
	this.animate(1);
	this.setLeftRightButtons();
}

/**
 */
SplashScreen.prototype.onRightClick = function()
{
	this.animate(-1);
	this.setLeftRightButtons();
}

/**
 */
SplashScreen.prototype.onHandleDown = function(e)
{
	this.handleActive = true;
	this.handleY = e.data.getLocalPosition(this).y;
	this.handleUp = function(){this.onHandleUp();}.bind(this)

	document.body.addEventListener('touchend', this.handleUp);
	document.body.addEventListener('mouseup', this.handleUp);
}

/**
 */
SplashScreen.prototype.onHandleUp = function()
{
	this.handleActive = false;
	document.body.removeEventListener("mouseup",  this.handleUp);
	document.body.removeEventListener("touchend", this.handleUp);
}

/**
 */
SplashScreen.prototype.onHandleMove = function(e)
{
	if(!this.handleActive) return;

	var newY = e.data.getLocalPosition(this).y;

	var delta = newY - this.handleY;

	if(this._leftArea._goalsScroller._handle.y + delta < this.handleMinY)
		delta = this.handleMinY - this._leftArea._goalsScroller._handle.y
	else if(this._leftArea._goalsScroller._handle.y + delta > this.handleMaxY)
		delta = this.handleMaxY - this._leftArea._goalsScroller._handle.y

	this._leftArea._goalsScroller._rope.tilePosition.y += delta;
	this._leftArea._goalsScroller._handle.y += delta;

	var perc   = (this._leftArea._goalsScroller._handle.y - this.handleMinY)/( this.handleMaxY - this.handleMinY);
	var nSteps = this._leftArea._goals.length - 4;
	var step   = (perc /(1/(nSteps-1)));

	for(var i = 0; i < this._leftArea._goals.length; i++)
	{
		this._leftArea._goals[i].y = 100 * (i-step);
	}

	this.handleY = newY;

	if(this.handleSFXCountdown == 0)
	{
		this.handleSFX = SoundSFX.play("sfx_pulley_down_loop_04", {loop:true});
	}
	this.handleSFXCountdown = 0.2;
}

/**
 */
SplashScreen.prototype.onCommPrev = function()
{
	this._comms[this._currentcomm].image.interactive = false;
	// this._comms[this._currentcomm].link.interactive = false;

	nextcomm = this._currentcomm-1;
	if(nextcomm < 0) nextcomm = this._comms.length -1;

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function()
		{
			this._comms[nextcomm].image.interactive = true;
			// this._comms[nextcomm].link.interactive = true;
		}
	});
		tl.to(this._comms[this._currentcomm],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._comms[nextcomm],           .5, {alpha:1, ease:Sine.easeInOut}, 0);
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._currentcomm = nextcomm;
}

/**
 */
SplashScreen.prototype.onCommNext = function()
{
	this._comms[this._currentcomm].image.interactive = false;
	// this._comms[this._currentcomm].link.interactive = false;

	nextcomm = this._currentcomm+1;
	if(nextcomm >= this._comms.length) nextcomm = 0;

	var tl = new TimelineMax(
	{
		onCompleteScope:this,
		onComplete:function()
		{
			this._comms[nextcomm].image.interactive = true;
			// this._comms[nextcomm].link.interactive = true;
		}
	});
		tl.to(this._comms[this._currentcomm],  .5, {alpha:0, ease:Sine.easeInOut}, 0);
		tl.to(this._comms[nextcomm],           .5, {alpha:1, ease:Sine.easeInOut}, 0);
	Common.animator.add(tl);

	SoundSFX.play("sfx_btn_press_00");

	this._currentcomm = nextcomm;
}

/**
 */
SplashScreen.prototype.onCommClick = function()
{
	// Event Tracking
	Common.ctow.trackEvent(
	{
		event      : "game_action",
		game_tier1 : "com_screen",
		game_tier2 : "slide" + (this._currentcomm+1)
	});

	// this._blur = new PIXI.filters.BlurFilter();
	// this._blur.blurX = 3;
	// this._blur.blurY = 3;
	// this.filters = [this._blur];

	// Open a new window
	// var url = this._commsData[this._currentcomm].url;
	// var win = window.open(url, '_system');
	// win.focus();

	this.signals.linkClick.dispatch(this._commsData[this._currentcomm].url, !!this._commsData[this._currentcomm].disney);
	SoundSFX.play("sfx_btn_press_00");
}
},{"../Common":2,"../general/SoundSFX":44,"../general/WireframeButton":45,"./SimpleScreen":73}]},{},[6])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiLi4vZ2FtZS9BcHBsaWNhdGlvbi5qcyIsIi4uL2dhbWUvQ29tbW9uLmpzIiwiLi4vZ2FtZS9DdG93LmpzIiwiLi4vZ2FtZS9Hb2Fscy5qcyIsIi4uL2dhbWUvS2V5Ym9hcmQuanMiLCIuLi9nYW1lL01haW4uanMiLCIuLi9nYW1lL1NhdmVkRGF0YS5qcyIsIi4uL2dhbWUvZWRpdG9yL0JlemllclBhdGguanMiLCIuLi9nYW1lL2VkaXRvci9FZGl0b3IuanMiLCIuLi9nYW1lL2VkaXRvci9MZXZlbC5qcyIsIi4uL2dhbWUvZWRpdG9yL0xldmVsTGF5ZXIuanMiLCIuLi9nYW1lL2VkaXRvci9MZXZlbE9iamVjdC5qcyIsIi4uL2dhbWUvZWRpdG9yL0xldmVsUGF0aC5qcyIsIi4uL2dhbWUvZ2FtZS9BdmF0YXIuanMiLCIuLi9nYW1lL2dhbWUvR2FtZU9iamVjdC5qcyIsIi4uL2dhbWUvZ2FtZS9HYW1lVUkuanMiLCIuLi9nYW1lL2dhbWUvTGV2ZWwuanMiLCIuLi9nYW1lL2dhbWUvTGV2ZWxMYXllci5qcyIsIi4uL2dhbWUvZ2FtZS9MZXZlbFBhdGguanMiLCIuLi9nYW1lL2dhbWUvTGV2ZWxSZWNvcmQuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0QXhlLmpzIiwiLi4vZ2FtZS9nYW1lL09iamVjdENhbWVyYVpvb20uanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0Q29pbi5qcyIsIi4uL2dhbWUvZ2FtZS9PYmplY3RDcnlzdGFsLmpzIiwiLi4vZ2FtZS9nYW1lL09iamVjdERlY29yYXRpb24uanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0SnVtcFBsYXRmb3JtLmpzIiwiLi4vZ2FtZS9nYW1lL09iamVjdExldmVsRW5kLmpzIiwiLi4vZ2FtZS9nYW1lL09iamVjdE1hbmFnZXIuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0TWFyc2htYWxsb3cuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0T2JzdGFjbGUuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0UG93ZXJ1cC5qcyIsIi4uL2dhbWUvZ2FtZS9PYmplY3RTaHJpbmtMb2NrLmpzIiwiLi4vZ2FtZS9nYW1lL09iamVjdFNsZWQuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0U25vd2JhbGwuanMiLCIuLi9nYW1lL2dhbWUvT2JqZWN0U3Zlbi5qcyIsIi4uL2dhbWUvZ2FtZS9PYmplY3RUcm9sbC5qcyIsIi4uL2dhbWUvZ2FtZS9PYmplY3RUdXRvcmlhbC5qcyIsIi4uL2dhbWUvZ2FtZS9SdW5uaW5nRW50aXR5LmpzIiwiLi4vZ2FtZS9nYW1lL1Nob2Nrd2F2ZS5qcyIsIi4uL2dhbWUvZ2VuZXJhbC9DaGFyYWN0ZXJTZWxlY3RQYW5lbC5qcyIsIi4uL2dhbWUvZ2VuZXJhbC9FbWl0dGVyLmpzIiwiLi4vZ2FtZS9nZW5lcmFsL0xldmVsU2VsZWN0QnV0dG9uLmpzIiwiLi4vZ2FtZS9nZW5lcmFsL05leHRCdXR0b24uanMiLCIuLi9nYW1lL2dlbmVyYWwvU291bmRTRlguanMiLCIuLi9nYW1lL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uLmpzIiwiLi4vZ2FtZS9saWIvQ3V0b3V0U2hhZGVyLmpzIiwiLi4vZ2FtZS9saWIvQ3V0b3V0VHJhbnNpdGlvbi5qcyIsIi4uL2dhbWUvbGliL0ZhZGVUcmFuc2l0aW9uLmpzIiwiLi4vZ2FtZS9saWIvTXV0ZUJ1dHRvbi5qcyIsIi4uL2dhbWUvbGliL1NjZW5lLmpzIiwiLi4vZ2FtZS9saWIvU2NlbmVNYW5hZ2VyLmpzIiwiLi4vZ2FtZS9saWIvVHJhbnNpdGlvbi5qcyIsIi4uL2dhbWUvb3ZlcmxheXMvQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9Db2RlT3ZlcmxheS5qcyIsIi4uL2dhbWUvb3ZlcmxheXMvRW5kR2FtZU92ZXJsYXkuanMiLCIuLi9nYW1lL292ZXJsYXlzL0VuZGxlc3NPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9FeGl0T3ZlcmxheS5qcyIsIi4uL2dhbWUvb3ZlcmxheXMvR2FtZU92ZXJPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9HZW5lcmljUG9wdXBPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9IZWxwT3ZlcmxheS5qcyIsIi4uL2dhbWUvb3ZlcmxheXMvSW5zdHJ1Y3Rpb25zT3ZlcmxheS5qcyIsIi4uL2dhbWUvb3ZlcmxheXMvUGF1c2VPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LmpzIiwiLi4vZ2FtZS9vdmVybGF5cy9Qcm9tb092ZXJsYXkuanMiLCIuLi9nYW1lL292ZXJsYXlzL1Jld2FyZE92ZXJsYXkuanMiLCIuLi9nYW1lL3NjcmVlbnMvQ2hhcmFjdGVyU2VsZWN0U2NyZWVuLmpzIiwiLi4vZ2FtZS9zY3JlZW5zL0RhaWx5Qm9udXNTY3JlZW4uanMiLCIuLi9nYW1lL3NjcmVlbnMvRWRpdG9yU2NyZWVuLmpzIiwiLi4vZ2FtZS9zY3JlZW5zL0dhbWVTY3JlZW4uanMiLCIuLi9nYW1lL3NjcmVlbnMvSW50cm9TY3JlZW4uanMiLCIuLi9nYW1lL3NjcmVlbnMvTGV2ZWxTZWxlY3RTY3JlZW4uanMiLCIuLi9nYW1lL3NjcmVlbnMvUHJlbG9hZGVyLmpzIiwiLi4vZ2FtZS9zY3JlZW5zL1NpbXBsZVNjcmVlbi5qcyIsIi4uL2dhbWUvc2NyZWVucy9TcGxhc2hTY3JlZW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMXJCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcm9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcGlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDanBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL1VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDamtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoNkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDejFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNtQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ptQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbGRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6U0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM2tCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1ZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9PQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcmFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaDRCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgQ29tbW9uICAgICAgICAgIFx0XHQgPSByZXF1aXJlKFwiLi9Db21tb25cIik7XG52YXIgR2FtZVNjcmVlbiAgICAgIFx0XHQgPSByZXF1aXJlKFwiLi9zY3JlZW5zL0dhbWVTY3JlZW5cIik7XG52YXIgRWRpdG9yU2NyZWVuICAgIFx0XHQgPSByZXF1aXJlKFwiLi9zY3JlZW5zL0VkaXRvclNjcmVlblwiKTtcbnZhciBTcGxhc2hTY3JlZW4gICAgXHRcdCA9IHJlcXVpcmUoXCIuL3NjcmVlbnMvU3BsYXNoU2NyZWVuXCIpO1xudmFyIERhaWx5Qm9udXNTY3JlZW5cdFx0ID0gcmVxdWlyZShcIi4vc2NyZWVucy9EYWlseUJvbnVzU2NyZWVuXCIpO1xudmFyIEludHJvU2NyZWVuICAgICBcdFx0ID0gcmVxdWlyZShcIi4vc2NyZWVucy9JbnRyb1NjcmVlblwiKTtcbnZhciBMZXZlbFNlbGVjdFNjcmVlbiAgICAgXHQgPSByZXF1aXJlKFwiLi9zY3JlZW5zL0xldmVsU2VsZWN0U2NyZWVuXCIpO1xudmFyIENoYXJhY3RlclNlbGVjdFNjcmVlbiAgICA9IHJlcXVpcmUoXCIuL3NjcmVlbnMvQ2hhcmFjdGVyU2VsZWN0U2NyZWVuXCIpO1xudmFyIFBhdXNlT3ZlcmxheSAgICBcdFx0ID0gcmVxdWlyZShcIi4vb3ZlcmxheXMvUGF1c2VPdmVybGF5XCIpO1xudmFyIEdhbWVPdmVyT3ZlcmxheSBcdFx0ID0gcmVxdWlyZShcIi4vb3ZlcmxheXMvR2FtZU92ZXJPdmVybGF5XCIpO1xudmFyIEhlbHBPdmVybGF5IFx0XHRcdCA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0hlbHBPdmVybGF5XCIpO1xudmFyIENvZGVPdmVybGF5IFx0XHRcdCA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0NvZGVPdmVybGF5XCIpO1xudmFyIEVuZGxlc3NPdmVybGF5IFx0XHRcdCA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0VuZGxlc3NPdmVybGF5XCIpO1xudmFyIFBvd2VydXBQdXJjaGFzZU92ZXJsYXkgXHQgPSByZXF1aXJlKFwiLi9vdmVybGF5cy9Qb3dlcnVwUHVyY2hhc2VPdmVybGF5XCIpO1xudmFyIEdlbmVyaWNQb3B1cE92ZXJsYXkgXHQgPSByZXF1aXJlKFwiLi9vdmVybGF5cy9HZW5lcmljUG9wdXBPdmVybGF5XCIpO1xudmFyIENoYXJhY3RlclVubG9ja2VkT3ZlcmxheSA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0NoYXJhY3RlclVubG9ja2VkT3ZlcmxheVwiKTtcbnZhciBSZXdhcmRPdmVybGF5ICAgICAgICAgICAgPSByZXF1aXJlKFwiLi9vdmVybGF5cy9SZXdhcmRPdmVybGF5XCIpO1xudmFyIEVuZEdhbWVPdmVybGF5ICAgICAgICAgICA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0VuZEdhbWVPdmVybGF5XCIpO1xudmFyIFByb21vT3ZlcmxheSAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL1Byb21vT3ZlcmxheVwiKTtcbnZhciBJbnN0cnVjdGlvbnNPdmVybGF5ICAgICAgPSByZXF1aXJlKFwiLi9vdmVybGF5cy9JbnN0cnVjdGlvbnNPdmVybGF5XCIpO1xudmFyIEV4aXRPdmVybGF5ICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuL292ZXJsYXlzL0V4aXRPdmVybGF5XCIpO1xudmFyIFRyYW5zaXRpb24gICAgICBcdFx0ID0gcmVxdWlyZShcIi4vbGliL1RyYW5zaXRpb25cIik7XG52YXIgQ3V0b3V0VHJhbnNpdGlvbiAgICAgICAgID0gcmVxdWlyZShcIi4vbGliL0N1dG91dFRyYW5zaXRpb25cIik7XG52YXIgU2F2ZWREYXRhICAgICAgIFx0XHQgPSByZXF1aXJlKFwiLi9TYXZlZERhdGFcIik7XG52YXIgR29hbHMgICAgICAgICAgICBcdFx0ID0gcmVxdWlyZShcIi4vR29hbHNcIik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05TVFJVQ1RPUlxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gQXBwbGljYXRpb24oKVxue1xuXHQvKipcblx0ICogQHR5cGUge0Fzc2V0TWFuYWdlcn1cblx0ICogQHByaXZhdGVcblx0ICovXG5cdHRoaXMuX2Fzc2V0TWFuYWdlciA9IG51bGw7XG5cblx0LyoqXG5cdCAqIEB0eXBlIHtTY3JlZW5NYW5hZ2VyfVxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0dGhpcy5fc2NyZWVuTWFuYWdlciA9IG51bGw7XG5cblx0LyoqXG5cdCAqIEB0eXBlIHtwMy5TY3JlZW59XG5cdCAqL1xuXHR0aGlzLl9jdXJyZW50U2NyZWVuID0gbnVsbDtcblxuXHQvKipcblx0ICogQHR5cGUge3AzLlRyYW5zaXRpb259XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHR0aGlzLl90cmFuc2l0aW9uID0gbnVsbDtcbn1cbm1vZHVsZS5leHBvcnRzID0gQXBwbGljYXRpb247XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQVUJMSUMgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuQXBwbGljYXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdGNvbnNvbGUubG9nKFwiQVBQTElDQVRJT04gSU5JVElBTElaRURcIik7XG5cblx0dGhpcy5fYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xuXHR0aGlzLl9zY3JlZW5NYW5hZ2VyID0gQ29tbW9uLnNjZW5lTWFuYWdlcjtcblxuXHRUd2Vlbk1heC5kZWZhdWx0T3ZlcndyaXRlID0gXCJub25lXCI7XG5cblx0Ly9UZXh0dXJlIGdlbmVyYXRpb246IGJsYWNrIHNxdWFyZVxuXHRpZihDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10gPT0gdW5kZWZpbmVkKVxuXHR7XG5cdFx0dmFyIGdyID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcblx0XHRnci5iZWdpbkZpbGwoMHgwMDAwMDApO1xuXHRcdGdyLmRyYXdSZWN0KDAsIDAsIDEsIDEpO1xuXHRcdENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snYmxhY2tTcXVhcmUnXSA9IGdyLmdlbmVyYXRlVGV4dHVyZShDb21tb24ucmVuZGVyZXIsIDEuMCwgUElYSS5TQ0FMRV9NT0RFUy5MSU5FQVIpO1xuXHR9XG5cblx0Ly9UZXh0dXJlIGdlbmVyYXRpb246IHdoaXRlIHNxdWFyZVxuXHRpZihDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ3doaXRlU3F1YXJlJ10gPT0gdW5kZWZpbmVkKVxuXHR7XG5cdFx0dmFyIGdyID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcblx0XHRnci5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuXHRcdGdyLmRyYXdSZWN0KDAsIDAsIDEsIDEpO1xuXHRcdENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snd2hpdGVTcXVhcmUnXSA9IGdyLmdlbmVyYXRlVGV4dHVyZShDb21tb24ucmVuZGVyZXIsIDEuMCwgUElYSS5TQ0FMRV9NT0RFUy5MSU5FQVIpO1xuXHR9XG5cblx0Q29tbW9uLnNhdmVkRGF0YSA9IG5ldyBTYXZlZERhdGEoKTtcblx0Q29tbW9uLnNhdmVkRGF0YS5pbml0KCk7XG5cblx0Q29tbW9uLmdvYWxzTWFuYWdlciA9IG5ldyBHb2FscygpO1xuXHRDb21tb24uZ29hbHNNYW5hZ2VyLmluaXQoKTtcblxuXHRwMy5CdXR0b24uYXVkaW8gPSBwMy5BdWRpb01hbmFnZXIuaW5zdGFuY2U7XG5cblx0aWYoISF3aW5kb3cub2cubW9kZSAmJiB3aW5kb3cub2cubW9kZSA9PSBcImVkaXRvclwiKVxuXHR7XG5cdFx0dGhpcy5zaG93RWRpdG9yKCk7XG5cdH1cblx0ZWxzZSBpZihDb21tb24uc2F2ZWREYXRhLmxldmVsRGVidWcgIT0gXCJcIilcblx0e1xuXHRcdGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyRGVidWcgIT0gXCJcIilcblx0XHR7XG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9IENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyRGVidWc7XG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlckRlYnVnID0gXCJcIjtcblx0XHR9XG5cblx0XHR0aGlzLnNob3dHYW1lKCk7XG5cdH1cblx0ZWxzZSBpZihDb21tb24uc2F2ZWREYXRhLmNhbkF3YXJkRGFpbHlCb251cygpKVxuXHR7XG5cdFx0dGhpcy5zaG93RGFpbHlCb251cygpO1xuXHR9XG5cdGVsc2Vcblx0e1xuXHRcdC8vIHRoaXMuc2hvd0RhaWx5Qm9udXMoKTtcblx0XHR0aGlzLnNob3dTcGxhc2goKTtcblx0XHQvLyB0aGlzLnNob3dMZXZlbFNlbGVjdCgpO1xuXHRcdC8vIHRoaXMuc2hvd0ludHJvKCk7XG5cdFx0Ly8gdGhpcy5zaG93T3V0cm8oKTtcblx0XHQvLyB0aGlzLnNob3dDaGFyYWN0ZXJTZWxlY3QoKTtcblx0XHQvLyB0aGlzLnNob3dHYW1lKCk7XG5cdH1cbn07XG5cblxuLyoqXG4gKiBTUExBU0hcbiAqL1xuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dTcGxhc2ggPSBmdW5jdGlvbigpXG57XG5cdHZhciBzY3JlZW4gPSBuZXcgU3BsYXNoU2NyZWVuKCk7XG5cdHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdGhpcy5fZ2V0VHJhbnNpdGlvbigpKTtcblxuXHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKClcblx0e1xuXG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uYWRkT25jZShmdW5jdGlvbihpZClcblx0e1xuXHRcdGlmKGlkID09ICdzdG9yeScpXG5cdFx0e1xuXHRcdFx0dGhpcy5zaG93TGV2ZWxTZWxlY3QoKTtcblx0XHR9XG5cdFx0ZWxzZSBpZihpZCA9PSAnZW5kbGVzcycpXG5cdFx0e1xuXHRcdFx0dGhpcy5zaG93Q2hhcmFjdGVyU2VsZWN0KCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYoaWQgPT0gJ3R1dG9yaWFsJylcblx0XHR7XG5cdFx0XHR0aGlzLnNob3dHYW1lKCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYoaWQgPT0gJ2ludHJvJylcblx0XHR7XG5cdFx0XHR0aGlzLnNob3dJbnRybygpO1xuXHRcdH1cblx0fSwgdGhpcyk7XG5cblx0c2NyZWVuLnNpZ25hbHMuR1VJQnV0dG9uQ2xpY2tlZC5hZGQoZnVuY3Rpb24oaWQpXG5cdHtcbiAgICAgICAgaWYoaWQgPT0gJ2hlbHAnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNob3dIZWxwT3ZlcmxheShcInNwbGFzaFwiKTtcbiAgICAgICAgfVxuXHRcdGVsc2UgaWYoaWQgPT0gJ2VuZGxlc3MnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNob3dFbmRsZXNzT3ZlcmxheSh0cnVlKTtcbiAgICAgICAgfVxuXHRcdGVsc2UgaWYoaWQgPT0gJ2VuZGxlc3NfdW5sb2NrZWQnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNob3dFbmRsZXNzT3ZlcmxheShmYWxzZSk7XG4gICAgICAgIH1cblx0XHRlbHNlIGlmKGlkID09ICdjb2RlJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zaG93Q29kZU92ZXJsYXkoKTtcbiAgICAgICAgfVxuICAgIH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLmxpbmtDbGljay5hZGQoZnVuY3Rpb24obGluaywgaXNEaXNuZXlTaXRlKVxuXHR7XG5cdFx0dGhpcy5zaG93RXhpdE92ZXJsYXkobGluaywgaXNEaXNuZXlTaXRlKTtcblx0fSwgdGhpcyk7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcbn07XG5cbi8qKlxuICogREFJTFkgQk9OVVNcbiAqL1xuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dEYWlseUJvbnVzID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgc2NyZWVuID0gbmV3IERhaWx5Qm9udXNTY3JlZW4oKTtcblx0dGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRUcmFuc2l0aW9uKCkpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uYWRkT25jZShmdW5jdGlvbigpXG5cdHtcblx0XHR0aGlzLnNob3dTcGxhc2goKTtcblx0fSwgdGhpcyk7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcbn07XG5cbi8qKlxuICogTEVWRUwgU0VMRUNUXG4gKi9cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93TGV2ZWxTZWxlY3QgPSBmdW5jdGlvbigpXG57XG5cdHZhciBzY3JlZW4gPSBuZXcgTGV2ZWxTZWxlY3RTY3JlZW4oKTtcblx0dGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRUcmFuc2l0aW9uKCkpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5zaG93U3BsYXNoKCk7XG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uYWRkT25jZShmdW5jdGlvbihsZXZlbClcblx0e1xuXHRcdHRoaXMuc2hvd0NoYXJhY3RlclNlbGVjdChsZXZlbCk7XG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLkdVSUJ1dHRvbkNsaWNrZWQuYWRkKGZ1bmN0aW9uKGlkKVxuXHR7XG4gICAgICAgIGlmKGlkID09ICdoZWxwJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zaG93SGVscE92ZXJsYXkoXCJsZXZlbFNlbGVjdFwiKTtcbiAgICAgICAgfVxuXHRcdGVsc2UgaWYoaWQgPT0gJ3Jld2FyZCcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1Jld2FyZE92ZXJsYXkoKTtcbiAgICAgICAgfVxuXHRcdGVsc2UgaWYoaWQgPT0gJ2VuZGdhbWUnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNob3dFbmRHYW1lT3ZlcmxheShcImVuZGdhbWVcIik7XG4gICAgICAgIH1cblx0XHRlbHNlIGlmKGlkID09ICdwcm9tbycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1Byb21vT3ZlcmxheSgpO1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcbn07XG5cbi8qKlxuICogQ0hBUkFDVEVSIFNFTEVDVFxuICovXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd0NoYXJhY3RlclNlbGVjdCA9IGZ1bmN0aW9uKGxldmVsKVxue1xuXHR2YXIgc2NyZWVuID0gbmV3IENoYXJhY3RlclNlbGVjdFNjcmVlbihsZXZlbCk7XG5cdHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdGhpcy5fZ2V0VHJhbnNpdGlvbigpKTtcblxuXHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKClcblx0e1xuXHRcdGlmKCFDb21tb24uc2F2ZWREYXRhLmVuZGxlc3MpXG5cdFx0XHR0aGlzLnNob3dMZXZlbFNlbGVjdCgpO1xuXHRcdGVsc2Vcblx0XHRcdHRoaXMuc2hvd1NwbGFzaCgpO1xuXHR9LCB0aGlzKTtcblxuXHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5zaG93R2FtZSgpO1xuXHR9LCB0aGlzKTtcblxuXHRzY3JlZW4uc2lnbmFscy5idXlQcmVzc2VkLmFkZChmdW5jdGlvbihwcmV2U2NyZWVuLCBjb3N0KVxuXHR7XG5cdFx0dGhpcy5zaG93UG93ZXJ1cFB1cmNoYXNlKHByZXZTY3JlZW4sIGNvc3QpO1xuXHR9LCB0aGlzKTtcblxuXHRzY3JlZW4uc2lnbmFscy5jaGFyYWN0ZXJVbmxvY2tlZC5hZGRPbmNlKGZ1bmN0aW9uKGNoYXJhY3Rlcilcblx0e1xuXHRcdHRoaXMuc2hvd1VubG9ja2VkQ2hhcmFjdGVyKGNoYXJhY3Rlcik7XG5cdH0sIHRoaXMpO1xuXG5cblx0c2NyZWVuLnNpZ25hbHMuR1VJQnV0dG9uQ2xpY2tlZC5hZGQoZnVuY3Rpb24oaWQpXG5cdHtcbiAgICAgICAgaWYoaWQgPT0gJ2hlbHAnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNob3dIZWxwT3ZlcmxheShcImNoYXJhY3RlclNlbGVjdFwiKTtcbiAgICAgICAgfVxuICAgIH0sIHRoaXMpO1xuXG5cdHRoaXMuX2N1cnJlbnRTY3JlZW4gPSBzY3JlZW47XG59O1xuXG5cdEFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93UG93ZXJ1cFB1cmNoYXNlID0gZnVuY3Rpb24ocHJldlNjcmVlbiwgY29zdClcblx0e1xuXHRcdHZhciB0ID0gbmV3IFRyYW5zaXRpb24oKTtcblx0XHR0LnJlcGxhY2UgPSBmYWxzZTtcblx0XHR0LnB1c2ggPSB0cnVlO1xuXG5cdFx0dmFyIHNjcmVlbiA9IG5ldyBQb3dlcnVwUHVyY2hhc2VPdmVybGF5KHByZXZTY3JlZW4sIGNvc3QpO1xuXHRcdHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cblx0XHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuXHRcdHtcblx0XHRcdHRoaXMuX3NjcmVlbk1hbmFnZXIucmVtb3ZlKCk7XG5cdFx0fSwgdGhpcyk7XG5cdH07XG5cblx0QXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dVbmxvY2tlZENoYXJhY3RlciA9IGZ1bmN0aW9uKGNoYXJhY3Rlcilcblx0e1xuXHRcdHZhciB0ID0gbmV3IFRyYW5zaXRpb24oKTtcblx0XHR0LnJlcGxhY2UgPSBmYWxzZTtcblx0XHR0LnB1c2ggPSB0cnVlO1xuXG5cdFx0dmFyIHNjcmVlbiA9IG5ldyBDaGFyYWN0ZXJVbmxvY2tlZE92ZXJsYXkoY2hhcmFjdGVyKTtcblx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHQpO1xuXG5cdFx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbihpZClcblx0XHR7XG5cdFx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlbW92ZSgpO1xuXHRcdH0sIHRoaXMpO1xuXHR9O1xuXG4vKipcbiAqIElOVFJPXG4gKi9cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93SW50cm8gPSBmdW5jdGlvbigpXG57XG5cdENvbW1vbi5zYXZlZERhdGEuaGFzU2VlbkludHJvID0gdHJ1ZTtcblx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XG5cblx0dmFyIHNjcmVlbiA9IG5ldyBJbnRyb1NjcmVlbihcImludHJvXCIpO1xuXHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHRoaXMuX2dldFRyYW5zaXRpb24oKSk7XG5cblx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbigpXG5cdHtcblx0fSwgdGhpcyk7XG5cblx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKClcblx0e1xuXHRcdHRoaXMuc2hvd0dhbWUoKTtcblx0fSwgdGhpcyk7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcblxuXHRyZXR1cm4gc2NyZWVuO1xufTtcblxuLyoqXG4gKiBPVVRST1xuICovXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd091dHJvID0gZnVuY3Rpb24oKVxue1xuXHRDb21tb24uc2F2ZWREYXRhLmhhc1NlZW5PdXRybyA9IHRydWU7XG5cdENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xuXG5cdHZhciBzY3JlZW4gPSBuZXcgSW50cm9TY3JlZW4oXCJvdXRyb1wiKTtcblx0dGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0aGlzLl9nZXRUcmFuc2l0aW9uKCkpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKVxuXHR7XG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uYWRkT25jZShmdW5jdGlvbigpXG5cdHtcblx0XHR0aGlzLnNob3dMZXZlbFNlbGVjdCgpO1xuXHR9LCB0aGlzKTtcblxuXHR0aGlzLl9jdXJyZW50U2NyZWVuID0gc2NyZWVuO1xuXG5cdHJldHVybiBzY3JlZW47XG59O1xuXG5cbi8qKlxuICogR0FNRVxuICovXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd0dhbWUgPSBmdW5jdGlvbigpXG57XG5cdHZhciBzY3JlZW4gPSBuZXcgR2FtZVNjcmVlbigpO1xuXHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHRoaXMuX2dldFRyYW5zaXRpb24oKSk7XG5cblx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbigpXG5cdHtcblx0XHRzY3JlZW4uYW5pbWF0ZU91dCh0aGlzLnNob3dHYW1lLCB0aGlzKTtcblx0fSwgdGhpcyk7XG5cblx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKGxldmVsKVxuXHR7XG5cdFx0dGhpcy5zaG93R2FtZU92ZXIobGV2ZWwpO1xuXHR9LCB0aGlzKTtcblxuXHRzY3JlZW4uc2lnbmFscy5wYXVzZVByZXNzZWQuYWRkKGZ1bmN0aW9uKGxldmVsKVxuXHR7XG5cdFx0dGhpcy5zaG93UGF1c2UobGV2ZWwpO1xuXHR9LCB0aGlzKTtcblxuXHRzY3JlZW4uc2lnbmFscy5zaG93SW5zdHJ1Y3Rpb25zLmFkZChmdW5jdGlvbih3aGF0KVxuXHR7XG5cdFx0dGhpcy5zaG93SW5zdHJ1Y3Rpb25zT3ZlcmxheSh3aGF0KTtcblx0fSwgdGhpcyk7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbiA9IHNjcmVlbjtcblxuXHQvLyBpZihzaG93UGF1c2UgJiYgIUNvbW1vbi5zYXZlZERhdGEuaGFzVmlld2VkSW5zdHJ1Y3Rpb25zKVxuXHQvLyB7XG5cdFx0Ly8gdGhpcy5fY3VycmVudFNjcmVlbi5fc2hvd1BhdXNlID0gdHJ1ZTtcblx0XHQvLyBDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpXG5cdFx0Ly8ge1xuXHRcdFx0Ly8gdGhpcy5zaG93UGF1c2UodHJ1ZSk7XG5cdFx0Ly8gfSwgMCwgdGhpcyk7XG5cdC8vIH1cblxuXHRyZXR1cm4gc2NyZWVuO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dFZGl0b3IgPSBmdW5jdGlvbigpXG57XG5cdHZhciBzY3JlZW4gPSBuZXcgRWRpdG9yU2NyZWVuKCk7XG5cdHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdGhpcy5fZ2V0VHJhbnNpdGlvbigpKTtcblxuXHR0aGlzLl9jdXJyZW50U2NyZWVuID0gc2NyZWVuO1xuXG5cdHJldHVybiBzY3JlZW47XG59O1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd0hlbHBPdmVybGF5ID0gZnVuY3Rpb24oc2VjdGlvbilcbntcbiAgICB2YXIgdCA9IG5ldyBUcmFuc2l0aW9uKCk7XG4gICAgdC5yZXBsYWNlID0gZmFsc2U7XG4gICAgdC5wdXNoID0gdHJ1ZTtcblxuICAgIHZhciBzY3JlZW4gPSBuZXcgSGVscE92ZXJsYXkoc2VjdGlvbik7XG4gICAgdGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0KTtcblxuICAgIHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oaWQpXG5cdHtcbiAgICAgICAgdGhpcy5fc2NyZWVuTWFuYWdlci5yZW1vdmUoKTtcbiAgICB9LCB0aGlzKTtcbn07XG5cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93Q29kZU92ZXJsYXkgPSBmdW5jdGlvbigpXG57XG4gICAgdmFyIHQgPSBuZXcgVHJhbnNpdGlvbigpO1xuICAgIHQucmVwbGFjZSA9IGZhbHNlO1xuICAgIHQucHVzaCA9IHRydWU7XG5cbiAgICB2YXIgc2NyZWVuID0gbmV3IENvZGVPdmVybGF5KCk7XG4gICAgdGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0KTtcblxuICAgIHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oaWQpXG5cdHtcbiAgICAgICAgdGhpcy5fc2NyZWVuTWFuYWdlci5yZW1vdmUoKTtcbiAgICB9LCB0aGlzKTtcbn07XG5cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93SW5zdHJ1Y3Rpb25zT3ZlcmxheSA9IGZ1bmN0aW9uKHdoYXQpXG57XG4gICAgLy8gdmFyIHQgPSBuZXcgVHJhbnNpdGlvbigpO1xuICAgIC8vIHQucmVwbGFjZSA9IGZhbHNlO1xuICAgIC8vIHQucHVzaCA9IHRydWU7XG5cbiAgICAvLyB2YXIgc2NyZWVuID0gbmV3IEluc3RydWN0aW9uc092ZXJsYXkoKTtcbiAgICAvLyB0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHQpO1xuXG4gICAgLy8gc2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbihpZClcblx0Ly8ge1xuICAgICAgICAvLyB0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlbW92ZSgpO1xuICAgIC8vIH0sIHRoaXMsIHRydWUpO1xuXG5cblx0dmFyIHQgICAgID0gbmV3IFRyYW5zaXRpb24oKTtcblx0dC5yZXBsYWNlID0gZmFsc2U7XG5cdHQucHVzaCAgICA9IHRydWU7XG5cblx0dGhpcy5fY3VycmVudFNjcmVlbi5oaWRlR1VJKGZ1bmN0aW9uKClcblx0e1xuXHRcdHZhciBzY3JlZW4gPSBuZXcgSW5zdHJ1Y3Rpb25zT3ZlcmxheSh3aGF0KTtcblx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHQpO1xuXG5cdFx0Ly8gUmVzdW1lXG5cdFx0c2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5fY3VycmVudFNjcmVlbi5zaG93R1VJKCk7XG5cdFx0fSwgdGhpcyk7XG5cblx0fSwgdGhpcywgdHJ1ZSk7XG5cbn07XG5cbkFwcGxpY2F0aW9uLnByb3RvdHlwZS5zaG93RW5kbGVzc092ZXJsYXkgPSBmdW5jdGlvbihpc0xvY2tlZClcbntcbiAgICB2YXIgdCA9IG5ldyBUcmFuc2l0aW9uKCk7XG4gICAgdC5yZXBsYWNlID0gZmFsc2U7XG4gICAgdC5wdXNoID0gdHJ1ZTtcblxuICAgIHZhciBzY3JlZW4gPSBuZXcgRW5kbGVzc092ZXJsYXkoaXNMb2NrZWQpO1xuICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuXHR7XG4gICAgICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIucmVtb3ZlKCk7XG4gICAgfSwgdGhpcyk7XG59O1xuXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd1Jld2FyZE92ZXJsYXkgPSBmdW5jdGlvbigpXG57XG4gICAgdmFyIHQgPSBuZXcgVHJhbnNpdGlvbigpO1xuICAgIHQucmVwbGFjZSA9IGZhbHNlO1xuICAgIHQucHVzaCA9IHRydWU7XG5cbiAgICB2YXIgc2NyZWVuID0gbmV3IFJld2FyZE92ZXJsYXkoKTtcbiAgICB0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHQpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbihpZClcblx0e1xuICAgICAgICB0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlbW92ZSgpO1xuICAgIH0sIHRoaXMpO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dFbmRHYW1lT3ZlcmxheSA9IGZ1bmN0aW9uKClcbntcbiAgICB2YXIgdCA9IG5ldyBUcmFuc2l0aW9uKCk7XG4gICAgdC5yZXBsYWNlID0gZmFsc2U7XG4gICAgdC5wdXNoID0gdHJ1ZTtcblxuICAgIHZhciBzY3JlZW4gPSBuZXcgRW5kR2FtZU92ZXJsYXkoKTtcbiAgICB0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZChzY3JlZW4sIHQpO1xuXG4gICAgc2NyZWVuLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uYWRkT25jZShmdW5jdGlvbihpZClcblx0e1xuICAgICAgICB0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlbW92ZSgpO1xuICAgIH0sIHRoaXMpO1xufTtcblxuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dQcm9tb092ZXJsYXkgPSBmdW5jdGlvbigpXG57XG4gICAgdmFyIHQgPSBuZXcgVHJhbnNpdGlvbigpO1xuICAgIHQucmVwbGFjZSA9IGZhbHNlO1xuICAgIHQucHVzaCA9IHRydWU7XG5cbiAgICB2YXIgc2NyZWVuID0gbmV3IFByb21vT3ZlcmxheSgpO1xuICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuXHR7XG4gICAgICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIucmVtb3ZlKCk7XG4gICAgfSwgdGhpcyk7XG5cblx0c2NyZWVuLnNpZ25hbHMubGlua0NsaWNrLmFkZChmdW5jdGlvbihsaW5rLCBpc0Rpc25leVNpdGUpXG5cdHtcblx0XHR0aGlzLnNob3dFeGl0T3ZlcmxheShsaW5rLCBpc0Rpc25leVNpdGUpO1xuXHR9LCB0aGlzKTtcbn07XG5cblxuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dHZW5lcmljUG9wdXBPdmVybGF5ID0gZnVuY3Rpb24oY29udGVudCwgY2FsbGJhY2ssIHNjb3BlKVxue1xuXHR2YXIgdCA9IG5ldyBUcmFuc2l0aW9uKCk7XG4gICAgdC5yZXBsYWNlID0gZmFsc2U7XG4gICAgdC5wdXNoID0gdHJ1ZTtcblxuICAgIHZhciBzY3JlZW4gPSBuZXcgR2VuZXJpY1BvcHVwT3ZlcmxheShjb250ZW50LCBjYWxsYmFjaywgc2NvcGUpO1xuICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5fc2NyZWVuTWFuYWdlci5yZW1vdmUoKTtcbiAgICB9LCB0aGlzKTtcbn07XG5cbi8qKlxuICogUEFVU0VcbiAqL1xuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dQYXVzZSA9IGZ1bmN0aW9uKGxldmVsKVxue1xuXHR2YXIgdCAgICAgPSBuZXcgVHJhbnNpdGlvbigpO1xuXHR0LnJlcGxhY2UgPSBmYWxzZTtcblx0dC5wdXNoICAgID0gdHJ1ZTtcblxuXHR0aGlzLl9jdXJyZW50U2NyZWVuLmhpZGVHVUkoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dmFyIHNjcmVlbiA9IG5ldyBQYXVzZU92ZXJsYXkobGV2ZWwpO1xuXHRcdHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cblx0XHQvLyBSZXN1bWVcblx0XHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKVxuXHRcdHtcblx0XHRcdHRoaXMuX3NjcmVlbk1hbmFnZXIucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLl9jdXJyZW50U2NyZWVuLnNob3dHVUkoKTtcblx0XHR9LCB0aGlzKTtcblxuXHRcdC8vIFJldHVybiB0byBzcGxhc2hcblx0XHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHR0aGlzLnNob3dTcGxhc2goKTtcblx0XHR9LCB0aGlzKTtcblxuXHRcdC8vIFJlc3RhcnRcblx0XHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRDdXJyZW50U2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oKVxuXHRcdHtcblx0XHRcdHRoaXMuc2hvd0dhbWUoKTtcblx0XHR9LCB0aGlzKTtcblxuXHR9LCB0aGlzLCB0cnVlKTtcbn07XG5cbi8qKlxuICogR0FNRU9WRVJcbiAqL1xuQXBwbGljYXRpb24ucHJvdG90eXBlLnNob3dHYW1lT3ZlciA9IGZ1bmN0aW9uKGxldmVsKVxue1xuXHR2YXIgdCA9IG5ldyBUcmFuc2l0aW9uKCk7XG5cdHQucmVwbGFjZSA9IGZhbHNlO1xuXHR0LnB1c2ggPSB0cnVlO1xuXG5cdHZhciBzY3JlZW4gPSBuZXcgR2FtZU92ZXJPdmVybGF5KGxldmVsKTtcblx0dGhpcy5fc2NyZWVuTWFuYWdlci5hZGQoc2NyZWVuLCB0KTtcblxuXHRzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oaWQpXG5cdHtcblx0XHRpZighQ29tbW9uLnNhdmVkRGF0YS5oYXNTZWVuT3V0cm8gJiYgQ29tbW9uLnNhdmVkRGF0YS5nZXRDcnlzdGFsQ291bnQoKSA9PSBDb21tb24uc2F2ZWREYXRhLmdldENvbGxlY3RlZENyeXN0YWxDb3VudCgpKVxuXHRcdHtcblx0XHRcdHRoaXMuc2hvd091dHJvKCk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHRpZighQ29tbW9uLnNhdmVkRGF0YS5lbmRsZXNzKVxuXHRcdFx0XHR0aGlzLnNob3dMZXZlbFNlbGVjdCgpO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHR0aGlzLnNob3dTcGxhc2goKTtcblx0XHR9XG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZEN1cnJlbnRTY3JlZW4uYWRkT25jZShmdW5jdGlvbigpXG5cdHtcblx0XHRpZighQ29tbW9uLnNhdmVkRGF0YS5oYXNTZWVuT3V0cm8gJiYgQ29tbW9uLnNhdmVkRGF0YS5nZXRDcnlzdGFsQ291bnQoKSA9PSBDb21tb24uc2F2ZWREYXRhLmdldENvbGxlY3RlZENyeXN0YWxDb3VudCgpKVxuXHRcdFx0dGhpcy5zaG93T3V0cm8oKTtcblx0XHRlbHNlXG5cdFx0XHR0aGlzLnNob3dHYW1lKCk7XG5cdH0sIHRoaXMpO1xuXG5cdHNjcmVlbi5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmFkZE9uY2UoZnVuY3Rpb24oaWQpXG5cdHtcblx0XHRpZighQ29tbW9uLnNhdmVkRGF0YS5oYXNTZWVuT3V0cm8gJiYgQ29tbW9uLnNhdmVkRGF0YS5nZXRDcnlzdGFsQ291bnQoKSA9PSBDb21tb24uc2F2ZWREYXRhLmdldENvbGxlY3RlZENyeXN0YWxDb3VudCgpKVxuXHRcdFx0dGhpcy5zaG93T3V0cm8oKTtcblx0XHRlbHNlXG5cdFx0XHR0aGlzLnNob3dTcGxhc2goKTtcblx0fSwgdGhpcyk7XG59O1xuXG4vKipcbiAqIEVYVEVSTkFMIExJTksgT1ZFUkxBWVxuICovXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuc2hvd0V4aXRPdmVybGF5ID0gZnVuY3Rpb24obGluaywgaXNEaXNuZXlTaXRlKVxue1xuICAgIHZhciB0ID0gbmV3IFRyYW5zaXRpb24oKTtcbiAgICB0LnJlcGxhY2UgPSBmYWxzZTtcbiAgICB0LnB1c2ggPSB0cnVlO1xuXG4gICAgdmFyIHNjcmVlbiA9IG5ldyBFeGl0T3ZlcmxheShsaW5rLCBpc0Rpc25leVNpdGUpO1xuICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIuYWRkKHNjcmVlbiwgdCk7XG5cbiAgICBzY3JlZW4uc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5hZGRPbmNlKGZ1bmN0aW9uKGlkKVxuXHR7XG4gICAgICAgIHRoaXMuX3NjcmVlbk1hbmFnZXIucmVtb3ZlKCk7XG4gICAgfSwgdGhpcyk7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUklWQVRFIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5BcHBsaWNhdGlvbi5wcm90b3R5cGUuX2dldFRyYW5zaXRpb24gPSBmdW5jdGlvbigpXG57XG5cdC8vIHZhciB0cmFuc2l0aW9uID0gbmV3IFRyYW5zaXRpb24oKTtcblx0Ly8gdHJhbnNpdGlvbi5yZXBsYWNlID0gdHJ1ZTtcblx0Ly8gdHJhbnNpdGlvbi5wdXNoID0gZmFsc2U7XG5cbiAgICB2YXIgdHJhbnNpdGlvbiAgICAgID0gbmV3IEN1dG91dFRyYW5zaXRpb24odGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ0cmFuc2l0aW9uXCIpLCBDb21tb24uVFJBTlNJVElPTl9DT0xPUik7XG4gICAgLy8gdHJhbnNpdGlvbi53YWl0ICAgICA9IHRydWU7XG5cdC8vIHRyYW5zaXRpb24ucmVwbGFjZSA9IHRydWU7XG5cdC8vIHRyYW5zaXRpb24ucHVzaCA9IGZhbHNlO1xuXG4gICAgLy8gdHJhbnNpdGlvbi5zaWduYWxzLmluLmFkZE9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIENvbW1vbi5hbmltYXRvci5wYXVzZWQgPSBmYWxzZTtcbiAgICAvLyB9LCB0aGlzKTtcblxuXHRyZXR1cm4gdHJhbnNpdGlvbjtcbn1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEdFVFRFUlMvU0VUVEVSU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuIiwiLyoqXG4gKiAgQ29tbW9uXG4gKlxuICogIENyZWF0ZWQgYnkgTGVnbWFuIG9uIDMwLzA0LzIwMTUuXG4gKlxuICovXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05TVFJVQ1RPUlxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gQ29tbW9uKCkge31cbm1vZHVsZS5leHBvcnRzID0gQ29tbW9uO1xuXG5cbi8qIC0tLS0tLUdFTkVSSUMtLS0tLS0gKi9cblxuLyoqXG4gKiBAdHlwZSB7TnVtYmVyfVxuICogQGNvbnN0XG4gKi9cbkNvbW1vbi5TVEFHRV9XSURUSCA9IDE5MDAuMDtcblxuLyoqXG4gKiBAdHlwZSB7TnVtYmVyfVxuICogQGNvbnN0XG4gKi9cbkNvbW1vbi5TVEFHRV9IRUlHSFQgPSA3NjguMDtcblxuLyoqXG4gKiBAdHlwZSB7UElYSS5Db250YWluZXJ9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5zdGFnZSA9IG51bGw7XG5cbi8qKlxuICogQHR5cGUge1BJWEkuQ2FudmFzUmVuZGVyZXJ8UElYSS5XZWJHTFJlbmRlcmVyfVxuICogQHN0YXRpY1xuICovXG5Db21tb24ucmVuZGVyZXIgPSBudWxsO1xuXG4vKipcbiAqIEB0eXBlIHtwMy5UaW1lc3RlcH1cbiAqIEBzdGF0aWNcbiAqL1xuQ29tbW9uLnRpbWVzdGVwID0gbnVsbDtcblxuLyoqXG4gKiBAdHlwZSB7cDMuQW5pbWF0b3J9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5hbmltYXRvciA9IG51bGw7XG5cbi8qKlxuICogQHR5cGUge1BJWEkuUG9pbnR9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi50b3VjaCA9IG5ldyBQSVhJLlBvaW50KDAuMCwgMC4wKTtcblxuLyoqXG4gKiBAdHlwZSB7TnVtYmVyfVxuICogQHN0YXRpY1xuICovXG5Db21tb24ucGF1c2VkID0gZmFsc2U7XG5cbi8qKlxuICogQHR5cGUge0Jvb2xlYW59XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5pc1dlYkdMID0gZmFsc2U7XG5cbi8qKlxuICogQHR5cGUge051bWJlcn1cbiAqIEBjb25zdFxuICovXG5Db21tb24uREVCVUdfUEFJTlRfTU9ERSA9IDA7XG5cbi8qKlxuICogQHR5cGUge051bWJlcn1cbiAqIEBzdGF0aWNcbiAqL1xuQ29tbW9uLmZyYW1lQ291bnQgPSAwO1xuXG4vKipcbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKiBAY29uc3RcbiAqL1xuQ29tbW9uLkZQUyA9IDYwO1xuXG4vKipcbiAqIEB0eXBlIHtTYXZlZERhdGF9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5zY2VuZU1hbmFnZXIgPSBudWxsO1xuXG4vKipcbiAqIEB0eXBlIHtTdHJpbmd9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlcyA9IHt9O1xuXG4vKipcbiAqIEB0eXBlIHtTdHJpbmd9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5DT1VOVFJZX0NPREUgPSAnZW4nO1xuXG4vKipcbiAqIEB0eXBlIHtPYmplY3R9XG4gKiBAc3RhdGljXG4gKi9cbkNvbW1vbi5hbmltYXRpb25EYXRhID0ge307XG5cbi8qKlxuICogQHR5cGUge1NhdmVkRGF0YX1cbiAqIEBzdGF0aWNcbiAqL1xuQ29tbW9uLnNhdmVkRGF0YSA9IG51bGw7XG5cbi8qKlxuICogQHR5cGUge0dvYWxzfVxuICogQHN0YXRpY1xuICovXG5Db21tb24uZ29hbHNNYW5hZ2VyID0gbnVsbDtcblxuLyoqXG4gKiBAdHlwZSB7T2JqZWN0fVxuICogQHN0YXRpY1xuICovXG5Db21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YSA9IFtdO1xuXG5Db21tb24uYmdNdXNpY1ZvbHVtZSA9IDAuMztcbkNvbW1vbi5iZ011c2ljID0gbnVsbDtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iLCJ2YXIgQ29tbW9uID0gcmVxdWlyZShcIi4vQ29tbW9uXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5mdW5jdGlvbiBDdG93KClcbntcblxuXHR0aGlzLmN0b3cgPSBudWxsO1xuXG5cdGlmKHR5cGVvZihDVE9XKSAhPSBcInVuZGVmaW5lZFwiKVxuXHRcdHRoaXMuY3RvdyA9IG5ldyBDVE9XKCk7XG5cblx0dGhpcy5kZWZhdWx0RXZlbnREYXRhID1cblx0e1xuXHRcdGV2ZW50ICAgICAgICAgIDogbnVsbCxcblx0XHRwYWdlX25hbWUgICAgICA6IFwiZW1lYTp1azpnYW1lczpzd3M6cGxheTp7R2FtZSBuYW1lfVwiLFxuXHRcdHBhZ2VfdXJsICAgICAgIDogXCJ7VVJMfVwiLFxuXHRcdGdhbWVfbmFtZSAgICAgIDogXCJ7R2FtZSBuYW1lfVwiLFxuXHRcdGdhbWVfaWQgICAgICAgIDogXCJ7Q01TIElEfVwiLFxuXHRcdGdhbWVfc291cmNlX2lkIDogXCJ7Q01TIE5hbWV9XCIsXG5cdFx0Z2FtZV90aWVyNCAgICAgOiBcIkZyb3plbk5vcnRoZXJuTGlnaHRzXCJcblx0fTtcbn1cbm1vZHVsZS5leHBvcnRzID0gQ3RvdztcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBVQkxJQyBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEluaXRcbiAqL1xuQ3Rvdy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcblx0aWYodGhpcy5jdG93ID09IG51bGwpIHJldHVybjtcblxuXHRjb25zb2xlLmluZm8oXCJDVE9XIEluaXRcIik7XG5cdHRoaXMuY3Rvdy50cmFja1BhZ2UoKTtcbn07XG5cbkN0b3cucHJvdG90eXBlLnRyYWNrRXZlbnQgPSBmdW5jdGlvbihkYXRhKVxue1xuXHRpZih0aGlzLmN0b3cgPT0gbnVsbCkgcmV0dXJuO1xuXHRpZighZGF0YS5ldmVudClcblx0e1xuXHRcdGNvbnNvbGUuZXJyb3IoXCJGaWVsZCBtaXNzaW5nOiAnZXZlbnQnXCIpXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0dmFyIGV2ZW50RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5kZWZhdWx0RXZlbnREYXRhKSk7XG5cblx0ZXZlbnREYXRhLmV2ZW50ID0gZGF0YS5ldmVudDtcblx0aWYoISFkYXRhLmdhbWVfbGV2ZWwpIGV2ZW50RGF0YS5nYW1lX2xldmVsID0gZGF0YS5nYW1lX2xldmVsO1xuXHRpZighIWRhdGEuZ2FtZV90aWVyMSkgZXZlbnREYXRhLmdhbWVfdGllcjEgPSBkYXRhLmdhbWVfdGllcjE7XG5cdGlmKCEhZGF0YS5nYW1lX3RpZXIyKSBldmVudERhdGEuZ2FtZV90aWVyMiA9IGRhdGEuZ2FtZV90aWVyMjtcblx0aWYoISFkYXRhLmdhbWVfdGllcjMpIGV2ZW50RGF0YS5nYW1lX3RpZXIzID0gZGF0YS5nYW1lX3RpZXIzO1xuXHRpZighIWRhdGEuZ2FtZV90aWVyNCkgZXZlbnREYXRhLmdhbWVfdGllcjQgPSBkYXRhLmdhbWVfdGllcjQ7XG5cdGlmKCEhZGF0YS5nYW1lX3RpZXI1KSBldmVudERhdGEuZ2FtZV90aWVyNSA9IGRhdGEuZ2FtZV90aWVyNTtcblx0aWYoISFkYXRhLmdhbWVfdGllcjYpIGV2ZW50RGF0YS5nYW1lX3RpZXI2ID0gZGF0YS5nYW1lX3RpZXI2O1xuXHRpZighIWRhdGEuZ2FtZV9tZXRhKSAgZXZlbnREYXRhLmdhbWVfbWV0YSAgPSBkYXRhLmdhbWVfbWV0YTtcblxuXHRjb25zb2xlLmdyb3VwKFwiRXZlbnQgdHJhY2tlZFwiKTtcblx0Y29uc29sZS5pbmZvKGRhdGEpO1xuXHRjb25zb2xlLmluZm8oZXZlbnREYXRhKTtcblx0Y29uc29sZS5ncm91cEVuZCgpO1xuXG5cdC8vIHRoaXMuY3Rvdy50cmFja0dhbWUoZXZlbnREYXRhKTtcbn0iLCJ2YXIgQ29tbW9uID0gcmVxdWlyZShcIi4vQ29tbW9uXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmZ1bmN0aW9uIEdvYWxzKClcbntcblx0dGhpcy5fYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xuXHR0aGlzLl9hY3RpdmVHb2Fsc0NvdW50ID0gMztcblx0dGhpcy5fYWN0aXZlR29hbHMgPSBudWxsO1xuXHR0aGlzLl9hY3RpdmVHb2Fsc0NvbXBsZXRlZCA9IG51bGw7XG5cdHRoaXMuX2dhbWVTY3JlZW4gPSBudWxsO1xufVxubW9kdWxlLmV4cG9ydHMgPSBHb2FscztcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBVQkxJQyBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEluaXRcbiAqL1xuR29hbHMucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdHZhciBqc29uID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIik7XG5cblx0dGhpcy5nb2FscyAgPSBqc29uLmdvYWxzO1xuXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmdvYWxzLmxlbmd0aDsgaSsrKVxuXHR7XG5cdFx0aWYodGhpcy5nb2Fsc1tpXS52YWx1ZSA+IDEgJiYgISF0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIikuZ29hbF9sYWJlbHNbdGhpcy5nb2Fsc1tpXS50eXBlICsgXCJfcGx1cmFsXCJdKVxuXHRcdHtcblx0XHRcdHRoaXMuZ29hbHNbaV0ubGFiZWwgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIikuZ29hbF9sYWJlbHNbdGhpcy5nb2Fsc1tpXS50eXBlICsgXCJfcGx1cmFsXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdLnJlcGxhY2UoXCJ7dmFsdWV9XCIsIHRoaXMuZ29hbHNbaV0udmFsdWUpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhpcy5nb2Fsc1tpXS5sYWJlbCA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKS5nb2FsX2xhYmVsc1t0aGlzLmdvYWxzW2ldLnR5cGVdW0NvbW1vbi5DT1VOVFJZX0NPREVdLnJlcGxhY2UoXCJ7dmFsdWV9XCIsIHRoaXMuZ29hbHNbaV0udmFsdWUpO1xuXHRcdH1cblx0XHR0aGlzLmdvYWxzW2ldLmljb24gID0ganNvbi5nb2FsX2ljb25zW3RoaXMuZ29hbHNbaV0udHlwZV07XG5cdH1cbn07XG5cbi8qKlxuICovXG5Hb2Fscy5wcm90b3R5cGUuc3RhcnRSdW4gPSBmdW5jdGlvbihnYW1lU2NyZWVuKVxue1xuXHR0aGlzLl9nYW1lU2NyZWVuID0gZ2FtZVNjcmVlbjtcblx0dGhpcy5fYWN0aXZlR29hbHMgPSB0aGlzLmdldEFjdGl2ZUdvYWxzKCk7XG5cdHRoaXMuX2FjdGl2ZUdvYWxzQ29tcGxldGVkID0gW107XG5cdHRoaXMuX2V2ZW50cyA9IFtdO1xufVxuXG4vKipcbiAqL1xuR29hbHMucHJvdG90eXBlLmdldEdvYWxCeUlkID0gZnVuY3Rpb24oaWQpXG57XG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmdvYWxzLmxlbmd0aDsgaSsrKVxuXHR7XG5cdFx0aWYodGhpcy5nb2Fsc1tpXS5pZCA9PSBpZClcblx0XHRcdHJldHVybiB0aGlzLmdvYWxzW2ldO1xuXHR9XG59XG5cbi8qKlxuICovXG5Hb2Fscy5wcm90b3R5cGUuZ2V0R29hbFN0YXR1cyA9IGZ1bmN0aW9uKGlkKVxue1xuXHRpZighQ29tbW9uLnNhdmVkRGF0YS5nb2Fsc1tpZF0pXG5cdFx0cmV0dXJuIDA7XG5cblx0dmFyIGdvYWwgPSB0aGlzLmdldEdvYWxCeUlkKGlkKTtcblx0cmV0dXJuIE1hdGgubWluKDEsIENvbW1vbi5zYXZlZERhdGEuZ29hbHNbaWRdL2dvYWwudmFsdWUpO1xufVxuXG4vKipcbiAqL1xuR29hbHMucHJvdG90eXBlLmdldEFjdGl2ZUdvYWxzID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgZ29hbHMgPSBbXTtcblxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5nb2Fscy5sZW5ndGggJiYgZ29hbHMubGVuZ3RoIDwgdGhpcy5fYWN0aXZlR29hbHNDb3VudDsgaSsrKVxuXHR7XG5cdFx0aWYodGhpcy5nZXRHb2FsU3RhdHVzKHRoaXMuZ29hbHNbaV0uaWQpIDwgMSlcblx0XHR7XG5cdFx0XHRnb2Fscy5wdXNoKHRoaXMuZ29hbHNbaV0pO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBnb2Fscztcbn1cblxuLyoqXG4gKi9cbkdvYWxzLnByb3RvdHlwZS50cmFja0V2ZW50ID0gZnVuY3Rpb24oZXZlbnQsIGFtb3VudClcbntcblx0YW1vdW50ID0gISFhbW91bnQgPyBhbW91bnQgOiAxO1xuXHRzYXZlID0gZmFsc2U7XG5cblx0Ly8gUnVuIGV2ZW50cyBjb3VudFxuXHRpZighdGhpcy5fZXZlbnRzW2V2ZW50XSlcblx0XHR0aGlzLl9ldmVudHNbZXZlbnRdID0gYW1vdW50O1xuXHRlbHNlXG5cdFx0dGhpcy5fZXZlbnRzW2V2ZW50XSArPSBhbW91bnQ7XG5cblx0Ly8gVXBkYXRlIGFjdGl2ZSBnb2Fsc1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fYWN0aXZlR29hbHMubGVuZ3RoOyBpKyspXG5cdHtcblx0XHR2YXIgZ29hbCA9IHRoaXMuX2FjdGl2ZUdvYWxzW2ldO1xuXG5cdFx0aWYoIUNvbW1vbi5zYXZlZERhdGEuZ29hbHNbZ29hbC5pZF0pXG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLmdvYWxzW2dvYWwuaWRdID0gMDtcblxuXG5cdFx0aWYoZ29hbC50eXBlID09IGV2ZW50KVxuXHRcdHtcblx0XHRcdGlmKENvbW1vbi5zYXZlZERhdGEuZ29hbHNbZ29hbC5pZF0gPj0gZ29hbC52YWx1ZSkgYnJlYWs7XG5cblx0XHRcdENvbW1vbi5zYXZlZERhdGEuZ29hbHNbZ29hbC5pZF0rKztcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiR29hbCAlcyAlaS8laVwiLCBnb2FsLmlkLCBDb21tb24uc2F2ZWREYXRhLmdvYWxzW2dvYWwuaWRdLCBnb2FsLnZhbHVlKTtcblxuXHRcdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5nb2Fsc1tnb2FsLmlkXSA+PSBnb2FsLnZhbHVlKVxuXHRcdFx0e1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkdvYWwgJXMgY29tcGxldGVkXCIsIGdvYWwuaWQpO1xuXHRcdFx0XHR0aGlzLmdvYWxDb21wbGV0ZWQoZ29hbCk7XG5cdFx0XHRcdHNhdmUgPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0fVxuXHRcdGVsc2UgaWYoZ29hbC50eXBlID09IGV2ZW50ICsgXCJfcnVuXCIpXG5cdFx0e1xuXHRcdFx0aWYodGhpcy5fZXZlbnRzW2V2ZW50XSA+IGdvYWwudmFsdWUpIGJyZWFrO1xuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIkdvYWwgJXMgJWkvJWlcIiwgZ29hbC5pZCwgdGhpcy5fZXZlbnRzW2V2ZW50XSwgZ29hbC52YWx1ZSk7XG5cblx0XHRcdGlmKHRoaXMuX2V2ZW50c1tldmVudF0gPiBDb21tb24uc2F2ZWREYXRhLmdvYWxzW2dvYWwuaWRdKVxuXHRcdFx0XHRDb21tb24uc2F2ZWREYXRhLmdvYWxzW2dvYWwuaWRdID0gdGhpcy5fZXZlbnRzW2V2ZW50XTtcblxuXHRcdFx0aWYodGhpcy5fZXZlbnRzW2V2ZW50XSA9PSBnb2FsLnZhbHVlKVxuXHRcdFx0e1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkdvYWwgJXMgY29tcGxldGVkXCIsIGdvYWwuaWQpO1xuXHRcdFx0XHR0aGlzLmdvYWxDb21wbGV0ZWQoZ29hbCk7XG5cdFx0XHRcdHNhdmUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmKHNhdmUpXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGFycmF5IG9mIHRoZSBpZHMgb2YgdGhlIGdvYWxzIGNvbXBsZXRlZCBkdXJpbmcgYSBsZXZlbFxuICogQHJldHVybnMge0FycmF5fVxuICovXG5Hb2Fscy5wcm90b3R5cGUuZ2V0UnVuQ29tcGxldGVkR29hbHNJZHMgPSBmdW5jdGlvbigpXG57XG5cdHZhciBpZHMgPSBbXTtcblxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fYWN0aXZlR29hbHNDb21wbGV0ZWQubGVuZ3RoOyBpKyspXG5cdHtcblx0XHRpZHMucHVzaCh0aGlzLl9hY3RpdmVHb2Fsc0NvbXBsZXRlZFtpXS5pZCk7XG5cdH1cblxuXHRyZXR1cm4gaWRzO1xufVxuXG4vKipcbiAqL1xuR29hbHMucHJvdG90eXBlLmdvYWxDb21wbGV0ZWQgPSBmdW5jdGlvbihnb2FsKVxue1xuXHRDb21tb24uc2F2ZWREYXRhLmNvaW5zICs9IGdvYWwucmV3YXJkO1xuXHR0aGlzLl9nYW1lU2NyZWVuLmdhbWVVSS5xdWV1ZUdvYWwoZ29hbC5sYWJlbCwgZ29hbC5yZXdhcmQpO1xuXG5cdHRoaXMuX2FjdGl2ZUdvYWxzQ29tcGxldGVkLnB1c2goZ29hbCk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogS2V5Ym9hcmQgY2xhc3NcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQGNvbnN0cnVjdG9yXG4gKi9cblxuZnVuY3Rpb24gS2V5Ym9hcmQoKVxue1xufVxubW9kdWxlLmV4cG9ydHMgPSBLZXlib2FyZDtcblxudmFyIEtleWJvYXJkID0gS2V5Ym9hcmQucHJvdG90eXBlO1xuXG4vKipcbiAqIEB0eXBlIHtTaWduYWwuU2lnbmFsfVxuICovXG5LZXlib2FyZC5zaWduYWxLZXlEb3duID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG5LZXlib2FyZC5zaWduYWxLZXlVcCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuXG4vKipcbiAqIEB0eXBlIHtPYmplY3QuPGJvb2xlYW4+fVxuICovXG5LZXlib2FyZC5fa2V5c0Rvd24gICAgPSBudWxsO1xuS2V5Ym9hcmQuX2tleXNQcmVzc2VkID0gbnVsbDtcbktleWJvYXJkLl9rZXlzVXAgICAgICA9IG51bGw7XG5cbi8qKlxuICogQGNvbnN0IEB0eXBlIHtudW1iZXJ9XG4gKi9cbktleWJvYXJkLktFWV9UQUIgICA9IDk7XG5LZXlib2FyZC5LRVlfRU5URVIgPSAxMztcbktleWJvYXJkLktFWV9TSElGVCA9IDE2O1xuS2V5Ym9hcmQuS0VZX0NUUkwgID0gMTc7XG5LZXlib2FyZC5LRVlfU1BBQ0UgPSAzMjtcbktleWJvYXJkLktFWV9MRUZUICA9IDM3O1xuS2V5Ym9hcmQuS0VZX1VQICAgID0gMzg7XG5LZXlib2FyZC5LRVlfUklHSFQgPSAzOTtcbktleWJvYXJkLktFWV9ET1dOICA9IDQwO1xuS2V5Ym9hcmQuS0VZX0EgICAgID0gNjU7XG5LZXlib2FyZC5LRVlfQiAgICAgPSA2NjtcbktleWJvYXJkLktFWV9DICAgICA9IDY3O1xuS2V5Ym9hcmQuS0VZX0QgICAgID0gNjg7XG5LZXlib2FyZC5LRVlfRSAgICAgPSA2OTtcbktleWJvYXJkLktFWV9GICAgICA9IDcwO1xuS2V5Ym9hcmQuS0VZX0cgICAgID0gNzE7XG5LZXlib2FyZC5LRVlfSCAgICAgPSA3MjtcbktleWJvYXJkLktFWV9JICAgICA9IDczO1xuS2V5Ym9hcmQuS0VZX0ogICAgID0gNzQ7XG5LZXlib2FyZC5LRVlfSyAgICAgPSA3NTtcbktleWJvYXJkLktFWV9MICAgICA9IDc2O1xuS2V5Ym9hcmQuS0VZX00gICAgID0gNzc7XG5LZXlib2FyZC5LRVlfTiAgICAgPSA3ODtcbktleWJvYXJkLktFWV9PICAgICA9IDc5O1xuS2V5Ym9hcmQuS0VZX1AgICAgID0gODA7XG5LZXlib2FyZC5LRVlfUSAgICAgPSA4MTtcbktleWJvYXJkLktFWV9SICAgICA9IDgyO1xuS2V5Ym9hcmQuS0VZX1MgICAgID0gODM7XG5LZXlib2FyZC5LRVlfVCAgICAgPSA4NDtcbktleWJvYXJkLktFWV9VICAgICA9IDg1O1xuS2V5Ym9hcmQuS0VZX1YgICAgID0gODY7XG5LZXlib2FyZC5LRVlfVyAgICAgPSA4NztcbktleWJvYXJkLktFWV9YICAgICA9IDg4O1xuS2V5Ym9hcmQuS0VZX1kgICAgID0gODk7XG5LZXlib2FyZC5LRVlfWiAgICAgPSA5MDtcbktleWJvYXJkLktFWV9QTFVzICA9IDE4NztcbktleWJvYXJkLktFWV9NSU5VUyA9IDE4OTtcblxuXG4vKipcbiAqIEluaXRpYWxpemF0aW9uXG4gKi9cbktleWJvYXJkLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMucmVzZXQoKTtcblxuXHQvLyBLZXkgZXZlbnRzXG5cdGRvY3VtZW50LmJvZHkub25rZXlkb3duID0gZnVuY3Rpb24oZSlcblx0e1xuXHRcdHZhciBjb2RlO1xuXHRcdGlmKHdpbmRvdy5ldmVudCkgY29kZSA9IGUua2V5Q29kZTtcblx0XHRlbHNlICAgICAgICAgICAgIGNvZGUgPSBlLndoaWNoO1xuXG5cdFx0S2V5Ym9hcmQuX2tleXNEb3duW2NvZGVdICAgID0gIUtleWJvYXJkLl9rZXlzUHJlc3NlZFtjb2RlXTtcblx0XHRLZXlib2FyZC5fa2V5c1ByZXNzZWRbY29kZV0gPSB0cnVlO1xuXG5cdFx0S2V5Ym9hcmQuc2lnbmFsS2V5RG93bi5kaXNwYXRjaChjb2RlKTtcblx0fVxuXG5cdGRvY3VtZW50LmJvZHkub25rZXl1cCA9IGZ1bmN0aW9uKGUpXG5cdHtcblx0XHR2YXIgY29kZTtcblx0XHRpZih3aW5kb3cuZXZlbnQpIGNvZGUgPSBlLmtleUNvZGU7XG5cdFx0ZWxzZSAgICAgICAgICAgICBjb2RlID0gZS53aGljaDtcblxuXHRcdEtleWJvYXJkLl9rZXlzRG93bltjb2RlXSAgICA9IGZhbHNlO1xuXHRcdEtleWJvYXJkLl9rZXlzUHJlc3NlZFtjb2RlXSA9IGZhbHNlO1xuXHRcdEtleWJvYXJkLl9rZXlzVXBbY29kZV0gICAgICA9IHRydWU7XG5cblx0XHRLZXlib2FyZC5zaWduYWxLZXlVcC5kaXNwYXRjaChjb2RlKTtcblx0fVxufVxuXG4vKipcbiAqIFVwZGF0ZVxuICovXG5LZXlib2FyZC51cGRhdGUgPSBmdW5jdGlvbigpXG57XG5cdEtleWJvYXJkLl9rZXlzRG93biA9IHt9O1xuXHRLZXlib2FyZC5fa2V5c1VwICAgPSB7fTtcbn1cblxuLyoqXG4gKiBSZXNldFxuICovXG5LZXlib2FyZC5yZXNldCA9IGZ1bmN0aW9uKClcbntcblx0S2V5Ym9hcmQuX2tleXNEb3duICAgID0ge307XG5cdEtleWJvYXJkLl9rZXlzUHJlc3NlZCA9IHt9O1xuXHRLZXlib2FyZC5fa2V5c1VwICAgICAgPSB7fTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gaWYgdGhlIGdpdmVuIGtleUNvZGUgaXMgY3VycmVudGx5IHByZXNzZWRcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0ga2V5Q29kZVxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbktleWJvYXJkLmdldEtleVByZXNzZWQgPSBmdW5jdGlvbihrZXlDb2RlKVxue1xuXHRyZXR1cm4gS2V5Ym9hcmQuX2tleXNQcmVzc2VkW2tleUNvZGVdO1xufVxuXG4vKipcbiAqIFJldHVybiBpZiB0aGUgZ2l2ZW4ga2V5Q29kZSBvciB0aGUgZ2l2ZW4gY29tYmluYXRpb24gb2Yga2V5cyBoYXMganVzdCBiZWVuIHByZXNzZWRcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0ga2V5Q29kZVxuICogQHJldHVybnMge0Jvb2xlYW59XG4gKi9cbktleWJvYXJkLmdldEtleUp1c3RQcmVzc2VkID0gZnVuY3Rpb24oa2V5Q29kZSlcbntcblx0cmV0dXJuIEtleWJvYXJkLl9rZXlzRG93bltrZXlDb2RlXTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gaWYgdGhlIGdpdmVuIGtleUNvZGUgb3IgdGhlIGdpdmVuIGNvbWJpbmF0aW9uIG9mIGtleXMgaGFzIGp1c3QgYmVlbiByZWxlYXNlZFxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBrZXlDb2RlXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAqL1xuS2V5Ym9hcmQuZ2V0S2V5SnVzdFJlbGVhc2VkID0gZnVuY3Rpb24oa2V5Q29kZSlcbntcblx0cmV0dXJuIEtleWJvYXJkLl9rZXlzVXBba2V5Q29kZV07XG59IiwiLyoqXG4gKiAgTWFpblxuICovXG5cbnZhciBBcHBsaWNhdGlvbiAgID0gcmVxdWlyZShcIi4vQXBwbGljYXRpb25cIik7XG52YXIgQ29tbW9uICAgICAgICA9IHJlcXVpcmUoXCIuL0NvbW1vblwiKTtcbnZhciBQcmVsb2FkZXIgICAgID0gcmVxdWlyZShcIi4vc2NyZWVucy9QcmVsb2FkZXJcIik7XG52YXIgU2NlbmVNYW5hZ2VyICA9IHJlcXVpcmUoXCIuL2xpYi9TY2VuZU1hbmFnZXJcIik7XG52YXIgS2V5Ym9hcmQgICAgICA9IHJlcXVpcmUoXCIuL0tleWJvYXJkXCIpO1xudmFyIEN0b3cgICAgICAgICAgPSByZXF1aXJlKFwiLi9DdG93XCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQHBhcmFtIHshTnVtYmVyfSB3aWR0aFxuICogQHBhcmFtIHshTnVtYmVyfSBoZWlnaHRcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBNYWluKHdpZHRoLCBoZWlnaHQpXG57XG5cdC8qKlxuXHQgKiBAdHlwZSB7IU51bWJlcn1cblx0ICogQHByaXZhdGVcblx0ICovXG5cdHRoaXMuX3dpZHRoICA9IHdpZHRoO1xuXHR0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XG5cblx0LyoqXG5cdCAqIEB0eXBlIHtwMy5Bc3NldE1hbmFnZXJ9XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHR0aGlzLl9hc3NldE1hbmFnZXIgPSBudWxsO1xuXG5cdC8qKlxuXHQgKiBAdHlwZSB7cDMuU2NyZWVuTWFuYWdlcn1cblx0ICogQHByaXZhdGVcblx0ICovXG5cdHRoaXMuX3NjcmVlbk1hbmFnZXIgPSBudWxsO1xuXG5cdC8qKlxuXHQgKiBAdHlwZSB7UHJlbG9hZGVyfVxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0dGhpcy5fcHJlbG9hZGVyID0gbnVsbDtcblxuXHQvKipcblx0ICogQHR5cGUge0FwcGxpY2F0aW9ufVxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0dGhpcy5fZ2FtZSA9IG51bGw7XG5cblx0LyoqXG5cdCAqIEB0eXBlIHtOdW1iZXJ9XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHR0aGlzLl9yZXNvbHV0aW9uID0gMS4wO1xuXG5cdC8qKlxuXHQgKiBAdHlwZSB7U3RyaW5nfVxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0dGhpcy5fc2NhbGUgICAgICA9IFwiaGQvXCI7XG5cdHRoaXMuX3JlbmRlckZQUyAgPSA2MC4wO1xuXHR0aGlzLl9mcmFtZUNvdW50ID0gMDtcblxufVxud2luZG93Lk1haW4gPSBNYWluO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5NYWluLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxue1xuICBcdHRoaXMuX2Fzc2V0TWFuYWdlciAgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XG5cdHRoaXMuX3NjcmVlbk1hbmFnZXIgPSBuZXcgU2NlbmVNYW5hZ2VyKCk7XG5cblx0Q29tbW9uLkNPVU5UUllfQ09ERSA9IHdpbmRvdy5vZy5sYW5ndWFnZTtcblxuXHR2YXIgZWxlbWVudElkICAgPSBcIm9nLWdhbWUtaG9sZGVyXCI7XG5cdHZhciBwYXJhbXMgICAgICA9IG5ldyBwMy5WaWV3UGFyYW1zKCk7XG5cdHBhcmFtcy53aWR0aCAgICA9IHRoaXMuX3dpZHRoO1xuXHRwYXJhbXMuaGVpZ2h0ICAgPSB0aGlzLl9oZWlnaHQ7XG5cdHBhcmFtcy5ob2xkZXJJZCA9IGVsZW1lbnRJZDtcblx0cGFyYW1zLnJvdGF0ZUltYWdlVXJsICAgPSBcImFzc2V0cy9pbWFnZXMvc3lzdGVtL1wiICsgQ29tbW9uLkNPVU5UUllfQ09ERSArIFwiL3JvdGF0ZV9kZXZpY2UuanBnXCI7XG5cdHBhcmFtcy5yb3RhdGVJbWFnZUNvbG9yID0gXCIjMDAwMDAwXCI7XG5cblx0UElYSS5SRVRJTkFfUFJFRklYID0gL1xcXyg/PVteX10qJCkoLispeC87XG5cblx0cDMuVHJhY2tpbmcuREVCVUcgPSB0cnVlO1xuXHRDb21tb24udHJhY2tpbmcgPSBuZXcgcDMuVHJhY2tpbmcoKTtcblx0Q29tbW9uLnRyYWNraW5nLmluaXQobmV3IHAzLlRyYWNraW5nTW9kdWxlRWNobyh3aW5kb3cuc3RhdHMpKTtcblxuXHRwMy5EZXZpY2UuaW5pdCh3aW5kb3dbXCJib3dzZXJcIl0pO1xuXG5cdFR3ZWVuTWF4LmRlZmF1bHRPdmVyd3JpdGUgPSBcIm5vbmVcIjtcblx0VHdlZW5NYXgudGlja2VyLmZwcyhDb21tb24uRlBTKTtcblxuXHR2YXIgY2FudmFzID0gbmV3IHAzLlZpZXcocGFyYW1zKTtcblx0Y2FudmFzLnNpZ25hbHMucmVhZHkuYWRkT25jZShmdW5jdGlvbihjYW52YXMpXG5cdHtcblx0XHR2YXIgb3B0aW9ucyA9IHt9O1xuXHRcdG9wdGlvbnMudmlldyA9IGNhbnZhcztcblx0XHRvcHRpb25zLnRyYW5zcGFyZW50ID0gZmFsc2U7XG5cdFx0b3B0aW9ucy5hbnRpYWxpYXMgPSBmYWxzZTtcblx0XHRvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlciA9IGZhbHNlO1xuXHRcdG9wdGlvbnMucmVzb2x1dGlvbiA9IHRoaXMuX3Jlc29sdXRpb247XG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLnNjYWxlRmFjdG9yID0gdGhpcy5fcmVzb2x1dGlvbjtcblxuXHRcdHZhciBzdGFnZSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHRcdENvbW1vbi5zdGFnZSA9IHN0YWdlO1xuXG5cdFx0dmFyIHJlbmRlcmVyID0gUElYSS5hdXRvRGV0ZWN0UmVuZGVyZXIodGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCwgb3B0aW9ucyk7XG5cdFx0Q29tbW9uLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cblx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmluaXQoc3RhZ2UsIHJlbmRlcmVyKTtcblx0XHRDb21tb24uc2NlbmVNYW5hZ2VyID0gdGhpcy5fc2NyZWVuTWFuYWdlcjtcblxuXHRcdENvbW1vbi5pc1dlYkdMID0gKHJlbmRlcmVyIGluc3RhbmNlb2YgUElYSS5XZWJHTFJlbmRlcmVyKTtcblx0XHRDb21tb24uREVCVUdfUEFJTlRfTU9ERSA9IHAzLlV0aWxzLmdldFVSTFBhcmFtZXRlcihcInBhaW50XCIsIDApO1xuXG5cdFx0dmFyIHRpbWVzdGVwID0gbmV3IHAzLlRpbWVzdGVwKCk7XG5cdFx0dGltZXN0ZXAuaW5pdCh0aGlzLnVwZGF0ZSwgdGhpcy5yZW5kZXIsIHRoaXMpO1xuXHRcdENvbW1vbi50aW1lc3RlcCA9IHRpbWVzdGVwO1xuXG5cdFx0Q29tbW9uLmFuaW1hdG9yID0gbmV3IHAzLkFuaW1hdG9yKCk7XG5cdFx0Q29tbW9uLmFuaW1hdG9yLmluaXQoKTtcblxuXHRcdENvbW1vbi5rZXlib2FyZCA9IG5ldyBLZXlib2FyZCgpO1xuXHRcdENvbW1vbi5rZXlib2FyZC5pbml0KCk7XG5cblx0XHRDb21tb24uY3RvdyA9IG5ldyBDdG93KCk7XG5cdFx0Q29tbW9uLmN0b3cuaW5pdCgpO1xuXG5cdFx0dGhpcy5sb2FkUHJlbG9hZGVyKCk7XG5cblx0fSwgdGhpcyk7XG5cdGNhbnZhcy5zaWduYWxzLnJlc2l6ZS5hZGQodGhpcy5vbkNhbnZhc1Jlc2l6ZSwgdGhpcyk7XG5cblx0dmFyIGhpZGRlbjtcblx0XCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZG9jdW1lbnQuaGlkZGVuID8gKGhpZGRlbiA9IFwiaGlkZGVuXCIsXG5cdFx0dGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gXCJ2aXNpYmlsaXR5Y2hhbmdlXCIpICAgIDogXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZG9jdW1lbnQubW96SGlkZGVuID8gKGhpZGRlbiA9IFwibW96SGlkZGVuXCIsXG5cdFx0dGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gXCJtb3p2aXNpYmlsaXR5Y2hhbmdlXCIpIDogXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZG9jdW1lbnQubXNIaWRkZW4gPyAoaGlkZGVuID0gXCJtc0hpZGRlblwiLFxuXHRcdHRoaXMudmlzaWJpbGl0eUNoYW5nZSA9IFwibXN2aXNpYmlsaXR5Y2hhbmdlXCIpICA6IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGRvY3VtZW50LndlYmtpdEhpZGRlbiAmJiAoaGlkZGVuID0gXCJ3ZWJraXRIaWRkZW5cIixcblx0XHR0aGlzLnZpc2liaWxpdHlDaGFuZ2UgPSBcIndlYmtpdHZpc2liaWxpdHljaGFuZ2VcIik7XG5cblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnZpc2liaWxpdHlDaGFuZ2UsIGZ1bmN0aW9uKCl7XG5cdFx0ZG9jdW1lbnRbaGlkZGVuXSA/IEhvd2xlci52b2x1bWUoMCkgOiBIb3dsZXIudm9sdW1lKDEpO1xuXHR9LCBmYWxzZSk7XG5cdFxuXHQvLyBSZWdhaW4gZm9jdXMgZm9yIGtleWJvYXJkIGV2ZW50c1xuXHRkb2N1bWVudC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIFxuXHR7XG4gICAgICAgIHdpbmRvdy5mb2N1cygpO1xuICAgIH07XG5cblxuXHQvLyBTdGF0c1xuXHQvLyB0aGlzLl9zdGF0cyA9IG5ldyBTdGF0cygpO1xuXHQvLyB0aGlzLl9zdGF0cy5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uXHQ9ICdhYnNvbHV0ZSc7XG5cdC8vIHRoaXMuX3N0YXRzLmRvbUVsZW1lbnQuc3R5bGUuYm90dG9tXHRcdD0gJzBweCc7XG5cdC8vIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fc3RhdHMuZG9tRWxlbWVudCk7XG59O1xuXG4vKipcbiAqL1xuTWFpbi5wcm90b3R5cGUubG9hZFByZWxvYWRlciA9IGZ1bmN0aW9uKClcbntcblx0dmFyIHNjYWxlICA9IHRoaXMuX3NjYWxlO1xuXHR2YXIgcHJlZml4ID0gKHNjYWxlID09PSBcInNkL1wiID8gXCJfMC41eFwiIDogXCJcIik7XG5cdHZhciBmaWxlcyA9XG5cdFtcblx0XHR7bmFtZTpcInByZWxvYWRlcl8wXCIsICB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwicHJlbG9hZGVyXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwicHJlbG9hZGVyX2JnXCIsIHVybDpcImltYWdlcy9cIiArIHNjYWxlICsgXCJ0aXRsZXNfXCIgKyBDb21tb24uQ09VTlRSWV9DT0RFICsgXCIvcHJlbG9hZGVyXCIgKyBwcmVmaXggKyBcIi5qcGdcIn1cblx0XTtcblx0dmFyIHNvdW5kcyA9IFtcblx0XTtcblxuXHRpZiAoZmlsZXMubGVuZ3RoKVxuXHR7XG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmFkZEZpbGVzKGZpbGVzLCB3aW5kb3cub2cuZ2FtZURpciArIFwiYXNzZXRzL1wiKTtcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuc2lnbmFsQ29tcGxldGVkLmFkZE9uY2UoZnVuY3Rpb24oKSB7dGhpcy5sb2FkQXNzZXRzKCk7fSwgdGhpcyk7XG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmxvYWQoKTtcblxuXHRcdHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5hZGRTb3VuZHMoc291bmRzLCBbXCIubXAzXCIsIFwiLm9nZ1wiXSwgXCJcIik7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0dGhpcy5sb2FkQXNzZXRzKCk7XG5cdH1cbn07XG5cblxuLyoqXG4gKi9cbk1haW4ucHJvdG90eXBlLmxvYWRBc3NldHMgPSBmdW5jdGlvbigpXG57XG5cdHZhciBzY2FsZSAgPSB0aGlzLl9zY2FsZTtcblx0dmFyIHByZWZpeCA9IChzY2FsZSA9PT0gXCJzZC9cIiA/IFwiXzAuNXhcIiA6IFwiXCIpO1xuXHR2YXIgZmlsZXMgPVxuXHRbXG5cdFx0e25hbWU6XCJjb25maWdcIiwgICAgIHVybDpcInN0cmluZ3MvY29uZmlnLmpzb25cIn0sXG5cdFx0e25hbWU6XCJzdHJpbmdzXCIsICAgIHVybDpcInN0cmluZ3Mvc3RyaW5ncy5qc29uXCJ9LFxuXHRcdHtuYW1lOlwidWkwXCIsICAgICAgICB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwidWkwXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwidWkxXCIsICAgICAgICB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwidWkxXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwidWkyXCIsICAgICAgICB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwidWkyXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwibWFwMFwiLCAgICAgICB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwibWFwMFwiICsgcHJlZml4ICsgXCIuanNvblwifSxcblx0XHR7bmFtZTpcImluZ2FtZV8wXCIsICAgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImluZ2FtZV8wXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDFfMFwiLCB1cmw6XCJpbWFnZXMvXCIgKyBzY2FsZSArIFwidGhlbWVfMDFfMFwiICsgcHJlZml4ICsgXCIuanNvblwifSxcblx0XHR7bmFtZTpcInRoZW1lXzAyXzBcIiwgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcInRoZW1lXzAyXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wM18wXCIsIHVybDpcImltYWdlcy9cIiArIHNjYWxlICsgXCJ0aGVtZV8wM18wXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwibm9ydGhlcm5fbGlnaHRzXzBcIiwgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcIm5vcnRoZXJuX2xpZ2h0c18wXCIgKyBwcmVmaXggKyBcIi5qc29uXCJ9LFxuXG5cdFx0Ly8gTGV2ZWxzXG5cdFx0Ly97bmFtZTpcImxldmVsX2JnXzBcIiwgICAgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAwX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0Ly97bmFtZTpcImxldmVsX2JnXzFcIiwgICAgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAxX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0Ly97bmFtZTpcImxldmVsX2JnXzJcIiwgICAgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAyX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0Ly97bmFtZTpcImxldmVsXzAwX2JnXzBcIiwgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAwX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0Ly97bmFtZTpcImxldmVsXzAxX2JnXzBcIiwgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAxX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cdFx0Ly97bmFtZTpcImxldmVsXzAyX2JnXzBcIiwgdXJsOlwiaW1hZ2VzL1wiICsgc2NhbGUgKyBcImxldmVsXzAyX2JnXzBcIiArIHByZWZpeCArIFwiLmpzb25cIn0sXG5cblxuXHRcdHtuYW1lOlwiZWRpdG9yQ29uZmlnXCIsICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci9jb25maWcuanNvblwifSxcblx0XHR7bmFtZTpcInRlc3RfMDAwXCIsICAgICAgICAgIHVybDpcImRhdGEvdGVzdF8wMDAuanNvblwifSxcblx0XHR7bmFtZTpcInRlc3RfMDAxXCIsICAgICAgICAgIHVybDpcImRhdGEvdGVzdF8wMDEuanNvblwifSxcblx0XHR7bmFtZTpcInRlc3RfMDAyXCIsICAgICAgICAgIHVybDpcImRhdGEvdGVzdF8wMDIuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3Nfc3RhcnRfMDAwXCIsIHVybDpcImRhdGEvZW5kbGVzc19zdGFydF8wMDAuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMDBcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAwMC5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAwMVwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDAxLmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDAyXCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMDIuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMDNcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAwMy5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAwNFwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDA0Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDA1XCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMDUuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMDZcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAwNi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAwN1wiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDA3Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDA4XCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMDguanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMDlcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAwOS5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAxMFwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDEwLmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDExXCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMTEuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMTJcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAxMi5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAxM1wiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDEzLmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDE0XCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMTQuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMTVcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAxNS5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAxNlwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDE2Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDE3XCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMTcuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMThcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAxOC5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAxOVwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDE5Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDIwXCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMjAuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMjFcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAyMS5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAyMlwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDIyLmpzb25cIn0sXG5cdFx0e25hbWU6XCJlbmRsZXNzX3BhcnRfMDIzXCIsICB1cmw6XCJkYXRhL2VuZGxlc3NfcGFydF8wMjMuanNvblwifSxcblx0XHR7bmFtZTpcImVuZGxlc3NfcGFydF8wMjRcIiwgIHVybDpcImRhdGEvZW5kbGVzc19wYXJ0XzAyNC5qc29uXCJ9LFxuXHRcdHtuYW1lOlwiZW5kbGVzc19wYXJ0XzAyNVwiLCAgdXJsOlwiZGF0YS9lbmRsZXNzX3BhcnRfMDI1Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wMFwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzAwX3R1dG9yaWFsLmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wMVwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzAxLmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wMlwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzAyLmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wM1wiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzAzLmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wNFwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA0Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wNVwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA1Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wNlwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA2Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wN1wiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA3Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wOFwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA4Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8wOVwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzA5Lmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8xMFwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzEwLmpzb25cIn0sXG5cdFx0e25hbWU6XCJsZXZlbF8xMVwiLCAgICAgICAgICB1cmw6XCJkYXRhL2xldmVsXzExLmpzb25cIn0sXG5cblx0XHQvLyBCZ1xuXHRcdHtuYW1lOlwidWlfYmdfY2hhcmFjdGVyc1wiLCAgdXJsOlwiaW1hZ2VzL2hkL3VpX2JnX2NoYXJhY3RlcnMuanBnXCJ9LFxuXHRcdHtuYW1lOlwidWlfYmdfZGFpbHlfYm9udXNcIiwgdXJsOlwiaW1hZ2VzL2hkL3VpX2JnX2RhaWx5X2JvbnVzLmpwZ1wifSxcblx0XHR7bmFtZTpcInVpX2JnX21haW5fbWVudVwiLCAgIHVybDpcImltYWdlcy9oZC91aV9iZ19tYWluX21lbnUuanBnXCJ9LFxuXHRcdHtuYW1lOlwidHJhbnNpdGlvblwiLCAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL3RyYW5zaXRpb24ucG5nXCJ9LFxuXG5cdFx0Ly8gUGFydGljbGUgc3lzdGVtc1xuXHRcdHtuYW1lOiBcInBhcnRpY2xlX2JhcnJlbF9leHBsb3Npb25cIiwgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9iYXJyZWxfZXhwbG9zaW9uLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfaWNlX2V4cGxvc2lvblwiLCAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2ljZV9leHBsb3Npb24uanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9jb2luX2NvbGxlY3RfYnVyc3RcIiwgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfY29pbl9jb2xsZWN0X2J1cnN0Lmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfc25vd19lbWl0dGVyX3YxXCIsICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX3Nub3dfZW1pdHRlcl92MS5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX2RvdWJsZWp1bXBcIiwgICAgICAgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9kb3VibGVqdW1wLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfaWNlX2JyaWRnZVwiLCAgICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2ljZV9icmlkZ2UuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9tYXJzaG1hbGxvd19sYW5kXCIsICAgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfbWFyc2htYWxsb3dfbGFuZC5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX3Nub3diYWxsXCIsICAgICAgICAgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9zbm93YmFsbC5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX2NoYXJfdXBncmFkZVwiLCAgICAgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9lbWl0dGVyX3Nub3dfY2hhcl91cGdyYWRlXzAwLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfbWVudV9zbm93XCIsICAgICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2VtaXR0ZXJfbWVudV9zbm93Lmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfbGV2ZWxfdW5sb2NrXCIsICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2xldmVsX3VubG9ja19pY2VtYWdpYzMuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9jaGFyYWN0ZXJfdW5sb2NrXCIsICAgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfc25vd3N0b3JtX2NoYXJfdW5sb2NrXzAwLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfcmV3YXJkXCIsICAgICAgICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2VtaXR0ZXJfc25vd2J1cnN0X3Jld2FyZF8wMC5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX3Ryb2xsX21hZ2ljXCIsICAgICAgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9lbWl0dGVyX3Ryb2xsX21hZ2ljXzAwLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfbWFnaWNfdHJhaWxcIiwgICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2VtaXR0ZXJfdHJvbGxtYWdpY190cmFpbF8wMS5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX2RlYXRoXCIsICAgICAgICAgICAgICAgICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9lbWl0dGVyX2ZhbGxfb2Zmc2NyZWVuXzAwLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfc3BhcmtsZV9yZXN1bHRzX2JsdWVcIiwgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19ibHVlLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfc3BhcmtsZV9yZXN1bHRzX2dyZWVuXCIsICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19ncmVlbi5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19waW5rXCIsICAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9zcGFya2xlX3Jlc3VsdHNfcGluay5qc29uXCJ9LFxuXHRcdHtuYW1lOiBcInBhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19wdXJwbGVcIiwgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9zcGFya2xlX3Jlc3VsdHNfcHVycGxlLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfc2xlZF9zaGluZVwiLCAgICAgICAgICAgICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX3NsZWRfc2hpbmVfMDEuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9tYXBfcmlwcGxlc19sb3dlclwiLCAgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfbWFwX3JpcHBsZXNfbG93ZXJfMDAuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9tYXBfcmlwcGxlc191cHBlclwiLCAgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfbWFwX3JpcHBsZXNfdXBwZXJfMDAuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9tYXBfcmlwcGxlc19icmlkZ2VcIiwgICAgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfbWFwX3JpcHBsZXNfYnJpZGdlLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfbWFwX3Ryb2xsX3Bvb2xfc3BhcmtsZXNcIiwgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX21hcF90cm9sbF9wb29sX3NwYXJrbGVzLmpzb25cIn0sXG5cdFx0e25hbWU6IFwicGFydGljbGVfZW5kX3N3aXJsdHJhaWxfMDBcIiwgXHQgICB1cmw6XCJwYXJ0aWNsZXMvcGFydGljbGVfZW5kX3N3aXJsdHJhaWxfMDAuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9nZW1fY3lhbl9lbmRpbmdcIiwgXHQgICBcdCAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9nZW1fY3lhbl9lbmRpbmcuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9nZW1fZ3JlZW5fZW5kaW5nXCIsIFx0ICAgdXJsOlwicGFydGljbGVzL3BhcnRpY2xlX2dlbV9ncmVlbl9lbmRpbmcuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9nZW1fcGlua19lbmRpbmdcIiwgXHQgICBcdCAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9nZW1fcGlua19lbmRpbmcuanNvblwifSxcblx0XHR7bmFtZTogXCJwYXJ0aWNsZV9nZW1fcHVycGxlX2VuZGluZ1wiLCBcdCAgIHVybDpcInBhcnRpY2xlcy9wYXJ0aWNsZV9nZW1fcHVycGxlX2VuZGluZy5qc29uXCJ9LFxuXG5cdFx0Ly8gRnhcblx0XHR7bmFtZTpcInNob2Nrd2F2ZVwiLCAgICAgdXJsOlwiaW1hZ2VzL2hkL3Nob2Nrd2F2ZS5wbmdcIn0sXG5cblx0XHQvLyBGb250c1xuXHRcdHtuYW1lOlwibWlrYWRhbl90aXRsZV82NHB0XCIsICAgICAgICAgIHVybDpcImZvbnRzL21pa2FkYW5fdGl0bGVfNjRwdC54bWxcIn0sXG5cdFx0e25hbWU6XCJtaWthZGFuX3doaXRlXzY0cHRcIiwgICAgICAgICAgdXJsOlwiZm9udHMvbWlrYWRhbl93aGl0ZV82NHB0LnhtbFwifSxcblx0XHR7bmFtZTpcInN1cGVyY2xhcmVuZG9uX2xldmVsXzMycHRcIiwgICB1cmw6XCJmb250cy9zdXBlcmNsYXJlbmRvbl9sZXZlbF8zMnB0LnhtbFwifSxcblx0XHR7bmFtZTpcInN1cGVyY2xhcmVuZG9uX251bWJlcnNfNjBwdFwiLCB1cmw6XCJmb250cy9zdXBlcmNsYXJlbmRvbl9udW1iZXJzXzYwcHQueG1sXCJ9LFxuXHRcdHtuYW1lOlwic3VwZXJjbGFyZW5kb25fcmVzdWx0c18zMnB0XCIsIHVybDpcImZvbnRzL3N1cGVyY2xhcmVuZG9uX3Jlc3VsdHNfMzJwdC54bWxcIn0sXG5cdFx0e25hbWU6XCJzdXBlcmNsYXJlbmRvbl90aXRsZV81MHB0XCIsICAgdXJsOlwiZm9udHMvc3VwZXJjbGFyZW5kb25fdGl0bGVfNTBwdC54bWxcIn0sXG5cdFx0e25hbWU6XCJzdXBlcmNsYXJlbmRvbl90aXRsZV82NHB0XCIsICAgdXJsOlwiZm9udHMvc3VwZXJjbGFyZW5kb25fdGl0bGVfNjRwdC54bWxcIn0sXG5cblx0XHQvLyBMZXZlbCBlbGVtZW50c1xuXHRcdHtuYW1lOlwidGhlbWVfMDFfZmlsbFwiLCAgICAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wMV9maWxsLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzAxX2dyb3VuZFwiLCAgICAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDFfZ3JvdW5kLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzAxX2dyb3VuZF9lZGdlXCIsICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDFfZ3JvdW5kX2VkZ2UucG5nXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDFfd2FsbFwiLCAgICAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wMV93YWxsLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzAyX2ZpbGxcIiwgICAgICAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDJfZmlsbC5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wMl9ncm91bmRcIiwgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzAyX2dyb3VuZC5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wMl9ncm91bmRfZWRnZVwiLCAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzAyX2dyb3VuZF9lZGdlLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzAyX3dhbGxcIiwgICAgICAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDJfd2FsbC5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wM19maWxsXCIsICAgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzAzX2ZpbGwucG5nXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDNfZ3JvdW5kXCIsICAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wM19ncm91bmQucG5nXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDNfZ3JvdW5kX2VkZ2VcIiwgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wM19ncm91bmRfZWRnZS5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wM193YWxsXCIsICAgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzAzX3dhbGwucG5nXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDRfZmlsbFwiLCAgICAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wNF9maWxsLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzA0X2dyb3VuZFwiLCAgICAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDRfZ3JvdW5kLnBuZ1wifSxcblx0XHR7bmFtZTpcInRoZW1lXzA1X2ZpbGxcIiwgICAgICAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdGhlbWVfMDVfZmlsbC5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wNV9ncm91bmRcIiwgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzA1X2dyb3VuZC5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0aGVtZV8wNl9maWxsXCIsICAgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3RoZW1lXzA2X2ZpbGwucG5nXCJ9LFxuXHRcdHtuYW1lOlwidGhlbWVfMDZfZ3JvdW5kXCIsICAgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90aGVtZV8wNl9ncm91bmQucG5nXCJ9LFxuXHRcdHtuYW1lOlwiZWxzYV9pY2VfZmxvd19jYXBsXzAwXCIsICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci9lbHNhX2ljZV9mbG93X2NhcGxfMDAucG5nXCJ9LFxuXHRcdHtuYW1lOlwiZWxzYV9pY2VfZmxvd19ncm91bmRfMDBcIiwgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci9lbHNhX2ljZV9mbG93X2dyb3VuZF8wMC5wbmdcIn0sXG5cblx0XHR7bmFtZTpcImp1bXBfcGxhdGZvcm1cIiwgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvanVtcF9wbGF0Zm9ybS5wbmdcIn0sXG5cdFx0e25hbWU6XCJjYW1lcmFfem9vbVwiLCAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL2NhbWVyYV96b29tLnBuZ1wifSxcblx0XHR7bmFtZTpcImxldmVsX2VuZFwiLCAgICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvbGV2ZWxfZW5kLnBuZ1wifSxcblx0XHR7bmFtZTpcImxldmVsX2dhbWVvdmVyXCIsIHVybDpcImltYWdlcy9oZC9lZGl0b3IvbGV2ZWxfZ2FtZW92ZXIucG5nXCJ9LFxuXHRcdHtuYW1lOlwic2hyaW5rX3VubG9ja1wiLCAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci9zaHJpbmtfdW5sb2NrLnBuZ1wifSxcblx0XHR7bmFtZTpcInNocmlua19sb2NrXCIsICAgIHVybDpcImltYWdlcy9oZC9lZGl0b3Ivc2hyaW5rX2xvY2sucG5nXCJ9LFxuXHRcdHtuYW1lOlwidHV0b3JpYWxcIiwgICAgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci90dXRvcmlhbC5wbmdcIn0sXG5cdFx0e25hbWU6XCJzdmVuXCIsICAgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3N2ZW4ucG5nXCJ9LFxuXHRcdHtuYW1lOlwibWFyc2htYWxsb3dcIiwgICAgdXJsOlwiaW1hZ2VzL2hkL2VkaXRvci9tYXJzaG1hbGxvdy5wbmdcIn0sXG5cdFx0e25hbWU6XCJ0cm9sbFwiLCAgICAgICAgICB1cmw6XCJpbWFnZXMvaGQvZWRpdG9yL3Ryb2xsLnBuZ1wifSxcblx0XHR7bmFtZTpcInRyb2xsX3BhYmJpZVwiLCAgIHVybDpcImltYWdlcy9oZC9lZGl0b3IvdHJvbGxfcGFiYmllLnBuZ1wifVxuXG5cdFx0Ly8gU3BpbmUgKGRvZXMgaXQgY2FjaGU/KVxuXHRcdC8vIHtuYW1lOiBcImNoYXJfZmVtYWxlXCIsICAgICAgICAgICAgdXJsOlwic3BpbmUvXCIgKyBzY2FsZSArICdjaGFyX2ZlbWFsZScgKyBcIi5qc29uXCJ9LFxuXHRcdC8vIHtuYW1lOlwiY2hhcl9mZW1hbGVcIiwgICAgICB1cmw6XCJzcGluZS9oZC9jaGFyX2ZlbWFsZS5wbmdcIn0sXG5cdFx0Ly8ge25hbWU6XCJjaGFyX2Vsc2FcIiwgICAgICAgIHVybDpcInNwaW5lL2hkL2NoYXJfZWxzYS5wbmdcIn0sXG5cdFx0Ly8ge25hbWU6XCJjaGFyX2tyaXN0b2ZmXCIsICAgIHVybDpcInNwaW5lL2hkL2NoYXJfa3Jpc3RvZmYucG5nXCJ9LFxuXHRcdC8vIHtuYW1lOlwiY2hhcl9vbGFmXCIsICAgICAgICB1cmw6XCJzcGluZS9oZC9jaGFyX29sYWYucG5nXCJ9LFxuXHRcdC8vIHtuYW1lOlwiY2hhcl9wYWJiaWVcIiwgICAgICB1cmw6XCJzcGluZS9oZC9jaGFyX3BhYmJpZS5wbmdcIn0sXG5cdFx0Ly8ge25hbWU6XCJjaGFyX3N2ZW5cIiwgICAgICAgIHVybDpcInNwaW5lL2hkL2NoYXJfc3Zlbi5wbmdcIn0sXG5cdFx0Ly8ge25hbWU6XCJzbGVkXCIsICAgICAgICAgICAgIHVybDpcInNwaW5lL2hkL3NsZWQucG5nXCJ9LFxuXHRcdC8vIHtuYW1lOlwiY2hhcl9tYXJzaG1hbGxvd1wiLCB1cmw6XCJzcGluZS9oZC9jaGFyX21hcnNobWFsbG93LnBuZ1wifSxcblx0XHQvLyB7bmFtZTpcImludHJvXCIsICAgICAgICAgICAgdXJsOlwic3BpbmUvaGQvaW50cm8ucG5nXCJ9LFxuXHRcdC8vIHtuYW1lOlwiaW50cm8yXCIsICAgICAgICAgICB1cmw6XCJzcGluZS9oZC9pbnRybzIucG5nXCJ9XG5cdF07XG5cblxuXHR2YXIgc291bmRzID1cblx0W1xuXHRcdFwibXhfZnJvemVuXzAxX2dhbWVwbGF5X2xwXCIsXG5cdFx0XCJteF9mcm96ZW5fMDFfZ2FtZXBsYXlfdGVuc2lvbl9scFwiLFxuXHRcdFwibXhfZnJvemVuXzAyX2NoYXJhY3Rlcl9zZWxlY3Rpb25cIixcblx0XHRcIm14X2Zyb3plbl8wM19tYWluX21lbnVfZWRpdFwiLFxuXHRcdFwibXhfZnJvemVuXzA0X3BhdXNlX2xwXCIsXG5cdFx0XCJteF9mcm96ZW5fMDVfbWFwX2xwXCIsXG5cdFx0XCJteF9mcm96ZW5fMDVfc2NvcmVfbHBcIixcblx0XHRcInNmeF9pbnRyb19hdWRpb18wMVwiLFxuXHRcdFwic2Z4X291dHJvX2F1ZGlvXzAxXCIsXG5cblx0XHRcInNmeF9idG5fcHJlc3NfMDBcIixcblx0XHRcInNmeF9idG5fcm9sbG92ZXJfMDBcIixcblx0XHRcInNmeF91aV9idXlfdXBncmFkZV8wMlwiLFxuXHRcdFwic2Z4X3B1bGxleV9kb3duX2xvb3BfMDRcIixcblx0XHRcInNmeF91aV9tYXBfbGV2ZWxfdW5sb2NrXzAyXCIsXG5cblx0XHRcInNmeF9waWNrdXBfc25vd2ZsYWtlXzAwXCIsXG5cdFx0XCJzZnhfcGlja3VwX2dlbV90aW5rbGVfMDFcIixcblx0XHRcInNmeF9waWNrdXBfdHJvbGxfMDFcIixcblx0XHRcInNmeF9nZW5lcmljX2hpdF9vYnN0YWNsZV8wMFwiLFxuXHRcdFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAwXCIsXG5cdFx0XCJzZnhfaWNlYmxvY2tfc21hc2hfMDFcIixcblx0XHRcInNmeF9pY2VibG9ja19zbWFzaF8wMlwiLFxuXHRcdFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAzXCIsXG5cdFx0XCJzZnhfaWNlYmxvY2tfc21hc2hfMDRcIixcblx0XHRcInNmeF9pY2VibG9ja19zbWFzaF8wNVwiLFxuXHRcdFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA2XCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzAwXCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzAxXCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzAyXCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzAzXCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzA0XCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzA1XCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzA2XCIsXG5cdFx0XCJzZnhfZ2VuZXJpY19oaXRfb2JzdGFjbGVfMDBcIixcblx0XHRcInNmeF9nZW5lcmljX2ZhbGxfb2Zmc2NyZWVuXzAxXCIsXG5cdFx0XCJzZnhfa3Jpc3RvZmZfc3dpbmdfYXhlXzAyXCIsXG5cdFx0XCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDBcIixcblx0XHRcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV8wMVwiLFxuXHRcdFwic2Z4X2Vsc2FfaWNlX21hZ2ljX3BsYXRmb3JtXzAyXCIsXG5cdFx0XCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDNcIixcblx0XHRcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV9mYWlsXzAwXCIsXG5cdFx0XCJteF90cm9sbF9tYWdpY19ydXNoX2xvb3BfMDJcIixcblx0XHRcInNmeF90cm9sbF9ub3RpZnlfMDBcIixcblx0XHRcInNmeF9zdmVuX2hpdG9ic3RhY2xlX3N0b3BfMDBcIixcblx0XHRcInNmeF9zdmVuX2p1bXBfMDBcIixcblx0XHRcInNmeF9zdmVuX2p1bXBfMDFcIixcblx0XHRcInNmeF9zdmVuX2p1bXBfMDJcIixcblx0XHRcInNmeF9zdmVuX2p1bXBfMDNcIixcblx0XHRcInNmeF9zdmVuX2p1bXBfMDRcIixcblx0XHRcInNmeF9zdmVuX3J1bl9zdG9wXzAwXCIsXG5cdFx0XCJzZnhfZ29hbHNfc2NyZWVuX3Nwb3RmeF8wMFwiLFxuXHRcdFwic2Z4X21haW5fc2NyZWVuX3Nwb3RmeF8wMVwiLFxuXHRcdFwic2Z4X3Byb21vX3NjcmVlbl9zcG90ZnhfMDBcIixcblx0XHRcInNmeF91aV9jaGFyYWN0ZXJfdW5sb2NrXzAxXCIsXG5cblx0XHRcInNmeF9hbm5hX3Nub3dfcnVudnNvZnRfMDBcIixcblx0XHRcInNmeF9rcmlzdG9mZl9zbm93X3J1bnZzb2Z0XzAwXCIsXG5cdFx0XCJzZnhfZ2VuZXJpY19vbGFmX3Nub3dfcnVudnNvZnRfMDBcIixcblx0XHRcInNmeF9zdmVuX3J1bl8wMlwiLFxuXHRcdFwic2Z4X3Nub3dfc2xpZGVfbG9vcF8wMFwiLFxuXG5cdFx0XCJzZnhfZ2VuZXJpY19qdW1wXzAwXCIsXG5cdFx0XCJzZnhfZ2VuZXJpY19qdW1wXzAxXCIsXG5cdFx0XCJzZnhfZ2VuZXJpY19qdW1wXzAyXCIsXG5cdFx0XCJzZnhfZ2VuZXJpY19sYW5kX3NvZnRfMDBcIixcblx0XHRcInNmeF9nZW5lcmljX2xhbmRfaGVhdnlfMDBcIixcblxuXHRcdFwic2Z4X21hcnNobWFsbG93X2ZhbGxfMDBcIixcblx0XHRcInNmeF9tYXJzaG1hbGxvd19tb3ZlXzAwXCIsXG5cdFx0XCJzZnhfbWFyc2htYWxsb3dfZW5kXzAwXCIsXG5cdFx0XCJzZnhfbWFyc2htYWxsb3dfZ3J1bnRfMDBcIlxuXHRdO1xuXHRpZiAoZmlsZXMubGVuZ3RoKVxuXHR7XG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmFkZEZpbGVzKGZpbGVzLCB3aW5kb3cub2cuZ2FtZURpciArIFwiYXNzZXRzL1wiKTtcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuc2lnbmFsUHJvZ3Jlc3MuYWRkKHRoaXMub25Mb2FkaW5nUHJvZ3Jlc3MsIHRoaXMpO1xuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5zaWduYWxDb21wbGV0ZWQuYWRkT25jZSh0aGlzLm9uTG9hZGluZ0NvbXBsZXRlZCwgdGhpcyk7XG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmxvYWQoKTtcblxuXHRcdHRoaXMuX3ByZWxvYWRlciA9IG5ldyBQcmVsb2FkZXIoKTtcblx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLmFkZCh0aGlzLl9wcmVsb2FkZXIpO1xuXG5cdFx0cDMuQXVkaW9NYW5hZ2VyLmluc3RhbmNlLmFkZFNvdW5kcyhzb3VuZHMsIFtcIi5tcDNcIiwgXCIub2dnXCJdLCB3aW5kb3cub2cuZ2FtZURpciArIFwiYXNzZXRzL2F1ZGlvL1wiKTtcblx0fVxuXHRlbHNlXG5cdHtcblx0XHR0aGlzLnN0YXJ0R2FtZSgpO1xuXHR9XG59O1xuXG4vKipcbiAqL1xuTWFpbi5wcm90b3R5cGUuc3RhcnRHYW1lID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgdGhhdCA9IHRoaXM7XG5cdHRoYXQuX2dhbWUgPSBuZXcgQXBwbGljYXRpb24oKTtcblx0dGhhdC5fZ2FtZS5pbml0KCk7XG59O1xuXG4vKipcbiAqL1xuTWFpbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxue1xuXHQvLyB0aGlzLl9zdGF0cy5iZWdpbigpO1xuXG5cdGlmKHAzLlRpbWVzdGVwLmRlbHRhVGltZSA+PSAxLzMwKVxuXHRcdHAzLlRpbWVzdGVwLmRlbHRhVGltZSA9IDEvMzA7XG5cblx0dGhpcy5fc2NyZWVuTWFuYWdlci51cGRhdGUoKTtcblx0Q29tbW9uLmFuaW1hdG9yLnVwZGF0ZSgpO1xuXHRDb21tb24ua2V5Ym9hcmQudXBkYXRlKCk7XG5cblx0aWYgKENvbW1vbi5ERUJVR19QQUlOVF9NT0RFID4gMClcblx0e1xuXHRcdHRoaXMucGFpbnRCYWRJbWFnZShDb21tb24uc3RhZ2UpO1xuXHR9XG5cblx0dGhpcy5fZnJhbWVDb3VudCsrO1xuXHRDb21tb24uZnJhbWVDb3VudCA9IHRoaXMuX2ZyYW1lQ291bnQ7XG59O1xuXG4vKipcbiAqL1xuTWFpbi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKVxue1xuXHRDb21tb24ucmVuZGVyZXIucmVuZGVyKENvbW1vbi5zdGFnZSk7XG5cblx0Ly8gdGhpcy5fc3RhdHMuZW5kKCk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IVBJWEkuRGlzcGxheU9iamVjdH0gZGlzcGxheVxuICogQHBhcmFtIHtOdW1iZXI9fSBjb2xvclxuICovXG5NYWluLnByb3RvdHlwZS5wYWludEJhZEltYWdlID0gZnVuY3Rpb24oZGlzcGxheSwgY29sb3IpXG57XG5cdGNvbG9yID0gY29sb3IgfHwgMHhBQTAwRkY7XG5cblx0dmFyIGNoaWxkO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRpc3BsYXkuY2hpbGRyZW4ubGVuZ3RoOyArKyBpKSB7XG5cdFx0Y2hpbGQgPSBkaXNwbGF5LmNoaWxkcmVuW2ldO1xuXHRcdGlmIChjaGlsZCBpbnN0YW5jZW9mIFBJWEkuU3ByaXRlKSB7XG5cdFx0XHRpZiAoQ29tbW9uLkRFQlVHX1BBSU5UX01PREUgPT0gMSkge1xuXHRcdFx0XHRpZiAoY2hpbGQudGV4dHVyZS53aWR0aCAlIDIgIT0gMCB8fCBjaGlsZC50ZXh0dXJlLmhlaWdodCAlIDIgIT0gMCkge1xuXHRcdFx0XHRcdGNoaWxkLnRpbnQgPSBjb2xvcjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjaGlsZC50aW50ID0gMHhGRkZGRkY7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChDb21tb24uREVCVUdfUEFJTlRfTU9ERSA9PSAyKSB7XG5cdFx0XHRcdGlmIChjaGlsZC5wb3NpdGlvbi54ICE9PSBwYXJzZUludChjaGlsZC5wb3NpdGlvbi54KSB8fCBjaGlsZC5wb3NpdGlvbi55ICE9PSBwYXJzZUludChjaGlsZC5wb3NpdGlvbi55KSkge1xuXHRcdFx0XHRcdGNoaWxkLnRpbnQgPSBjb2xvcjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjaGlsZC50aW50ID0gMHhGRkZGRkY7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5wYWludEJhZEltYWdlKGNoaWxkLCBjb2xvcik7XG5cdH1cbn07XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUklWQVRFIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cbk1haW4ucHJvdG90eXBlLm9uTG9hZGluZ1Byb2dyZXNzID0gZnVuY3Rpb24oZXZlbnQpXG57XG5cdHRoaXMuX3ByZWxvYWRlci5sb2FkZWRQZXJjZW50YWdlID0gZXZlbnQucHJvZ3Jlc3M7XG59O1xuXG4vLyBNYWluLnByb3RvdHlwZS5vbkxvYWRpbmdTcGluZVByb2dyZXNzID0gZnVuY3Rpb24oZXZlbnQpXG4vLyB7XG5cdC8vIHRoaXMuX3ByZWxvYWRlci5sb2FkZWRQZXJjZW50YWdlID0gMC41ICsgZXZlbnQucHJvZ3Jlc3MvMjAwO1xuLy8gfTtcblxuLyoqXG4gKi9cbk1haW4ucHJvdG90eXBlLm9uTG9hZGluZ0NvbXBsZXRlZCA9IGZ1bmN0aW9uKClcbntcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG5cblx0dmFyIGxvYWRlciA9ICBuZXcgUElYSS5sb2FkZXJzLkxvYWRlcigpO1xuXHRcblx0Ly8gbG9hZGVyLm9uKFwicHJvZ3Jlc3NcIiwgZnVuY3Rpb24oZXZlbnQpXG5cdC8vIHtcblx0XHQvLyB0aGF0Lm9uTG9hZGluZ1NwaW5lUHJvZ3Jlc3MoZXZlbnQpXG5cdC8vIH0pXHRcblx0XG5cdGxvYWRlci5hZGQoJ2NoYXJfZmVtYWxlJywgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2NoYXJfZmVtYWxlJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnY2hhcl9lbHNhJywgICAgICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnY2hhcl9lbHNhJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnY2hhcl9rcmlzdG9mZicsICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnY2hhcl9rcmlzdG9mZicgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ2NoYXJfb2xhZicsICAgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2NoYXJfb2xhZicgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ2NoYXJfcGFiYmllJywgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2NoYXJfcGFiYmllJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnY2hhcl9zdmVuJywgICAgICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnY2hhcl9zdmVuJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnc2xlZCcsICAgICAgICAgICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnc2xlZCcgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ2NoYXJfbWFyc2htYWxsb3cnLCBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2NoYXJfbWFyc2htYWxsb3cnICsgXCIuanNvblwiKVxuXHRcdFx0XHQuYWRkKCdjaGFyX3Ryb2xsJywgICAgICAgXCJhc3NldHMvc3BpbmUvXCIgKyB0aGF0Ll9zY2FsZSArICdjaGFyX3Ryb2xsX3NpZ24nICsgXCIuanNvblwiKVxuXHRcdFx0XHQuYWRkKCdpbnRybycsICAgICAgICAgICAgXCJhc3NldHMvc3BpbmUvXCIgKyB0aGF0Ll9zY2FsZSArICdpbnRybycgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ291dHJvJywgICAgICAgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ291dHJvJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnYW5uYScsICAgICAgICAgICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnYW5uYScgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ2tyaXN0b2ZmJywgICAgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2tyaXN0b2ZmJyArIFwiLmpzb25cIilcblx0XHRcdFx0LmFkZCgnb2xhZicsICAgICAgICAgICAgIFwiYXNzZXRzL3NwaW5lL1wiICsgdGhhdC5fc2NhbGUgKyAnb2xhZicgKyBcIi5qc29uXCIpXG5cdFx0XHRcdC5hZGQoJ2Vsc2EnLCAgICAgICAgICAgICBcImFzc2V0cy9zcGluZS9cIiArIHRoYXQuX3NjYWxlICsgJ2Vsc2EnICsgXCIuanNvblwiKVxuXHRcdFx0XHQuYWRkKCdwYWJiaWUnLCAgICAgICAgICAgXCJhc3NldHMvc3BpbmUvXCIgKyB0aGF0Ll9zY2FsZSArICdwYWJiaWUnICsgXCIuanNvblwiKVxuXHRcdFx0XHQubG9hZChmdW5jdGlvbihsb2FkZXIsIHJlc291cmNlcylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfZmVtYWxlICAgICAgPSByZXNvdXJjZXMuY2hhcl9mZW1hbGUuc3BpbmVEYXRhO1xuXHRcdFx0XHRcdENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfZWxzYSAgICAgICAgPSByZXNvdXJjZXMuY2hhcl9lbHNhLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX2tyaXN0b2ZmICAgID0gcmVzb3VyY2VzLmNoYXJfa3Jpc3RvZmYuc3BpbmVEYXRhO1xuXHRcdFx0XHRcdENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfb2xhZiAgICAgICAgPSByZXNvdXJjZXMuY2hhcl9vbGFmLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX3BhYmJpZSAgICAgID0gcmVzb3VyY2VzLmNoYXJfcGFiYmllLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX3N2ZW4gICAgICAgID0gcmVzb3VyY2VzLmNoYXJfc3Zlbi5zcGluZURhdGE7XG5cdFx0XHRcdFx0Q29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9zbGVkICAgICAgICA9IHJlc291cmNlcy5zbGVkLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX21hcnNobWFsbG93ID0gcmVzb3VyY2VzLmNoYXJfbWFyc2htYWxsb3cuc3BpbmVEYXRhO1xuXHRcdFx0XHRcdENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfdHJvbGwgICAgICAgPSByZXNvdXJjZXMuY2hhcl90cm9sbC5zcGluZURhdGE7XG5cdFx0XHRcdFx0Q29tbW9uLmludHJvQW5pbWF0aW9uRGF0YSAgICAgICAgICAgICAgICAgICAgICA9IHJlc291cmNlcy5pbnRyby5zcGluZURhdGE7XG5cdFx0XHRcdFx0Q29tbW9uLm91dHJvQW5pbWF0aW9uRGF0YSAgICAgICAgICAgICAgICAgICAgICA9IHJlc291cmNlcy5vdXRyby5zcGluZURhdGE7XG5cdFx0XHRcdFx0Q29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuYW5uYSAgICAgICAgICAgICA9IHJlc291cmNlcy5hbm5hLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5rcmlzdG9mZiAgICAgICAgID0gcmVzb3VyY2VzLmtyaXN0b2ZmLnNwaW5lRGF0YTtcblx0XHRcdFx0XHRDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5vbGFmICAgICAgICAgICAgID0gcmVzb3VyY2VzLm9sYWYuc3BpbmVEYXRhO1xuXHRcdFx0XHRcdENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmVsc2EgICAgICAgICAgICAgPSByZXNvdXJjZXMuZWxzYS5zcGluZURhdGE7XG5cdFx0XHRcdFx0Q29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEucGFiYmllICAgICAgICAgICA9IHJlc291cmNlcy5wYWJiaWUuc3BpbmVEYXRhO1xuXG5cdFx0XHRcdFx0dGhhdC5fcHJlbG9hZGVyLmxvYWRlZFBlcmNlbnRhZ2UgPSAxMDAuMDtcblx0XHRcdFx0XHR0aGF0Ll9wcmVsb2FkZXIuYW5pbWF0ZU91dChudWxsLCB0aGlzKTtcblx0XHRcdFx0XHR0aGF0Ll9wcmVsb2FkZXIgPSBudWxsO1xuXG5cdFx0XHRcdFx0dGhhdC5fYXNzZXRNYW5hZ2VyLnNpZ25hbFByb2dyZXNzLnJlbW92ZUFsbCgpO1xuXHRcdFx0XHRcdHRoYXQuX2Fzc2V0TWFuYWdlci5zaWduYWxDb21wbGV0ZWQucmVtb3ZlQWxsKCk7XG5cblx0XHRcdFx0XHR3aW5kb3cucjJsICAgICAgICAgID0gdGhhdC5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikucjJsO1xuXHRcdFx0XHRcdHdpbmRvdy53ZWJmb250ICAgICAgPSB0aGF0Ll9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS53ZWJmb250O1xuXHRcdFx0XHRcdENvbW1vbi5DT1VOVFJZX0NPREUgPSB0aGF0Ll9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5sb2NhbGU7XG5cblx0XHRcdFx0XHQvLyBFdmVudCBUcmFja2luZ1xuXHRcdFx0XHRcdENvbW1vbi5jdG93LnRyYWNrRXZlbnQoXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0ZXZlbnQgOiBcImdhbWVfbG9hZFwiXG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHR0aGF0LnN0YXJ0R2FtZSgpO1xuXHRcdFx0XHR9KTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHshQm9vbGVhbn0gY29ycmVjdFxuICovXG5NYWluLnByb3RvdHlwZS5vbkNhbnZhc1Jlc2l6ZSA9IGZ1bmN0aW9uKGNvcnJlY3QpXG57XG5cdGlmIChjb3JyZWN0KVxuXHR7XG5cdFx0Q29tbW9uLnJlbmRlcmVyLnJlc2l6ZShwMy5WaWV3LndpZHRoLCBwMy5WaWV3LmhlaWdodCk7XG5cblx0XHRpZiAodGhpcy5fc2NyZWVuTWFuYWdlcilcblx0XHR7XG5cdFx0XHR0aGlzLl9zY3JlZW5NYW5hZ2VyLnJlc2l6ZSgpO1xuXHRcdH1cblx0fVxufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEdFVFRFUlMvU0VUVEVSU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuIiwidmFyIENvbW1vbiA9IHJlcXVpcmUoXCIuL0NvbW1vblwiKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUUlVDVE9SXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5mdW5jdGlvbiBTYXZlZERhdGEoKVxue1xuXHR0aGlzLl9hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XG5cblx0dGhpcy5TQVZFX05BTUUgICAgPSBcImZyb3plbl9saWdodHNfbm9ydGhcIjtcblx0dGhpcy5TQVZFX1ZFUlNJT04gPSBcIjE2LjA5LjA5XCI7XG5cdHRoaXMuU0FWRV9TRUVEICAgID0gXCJ5NWswRW82UjE3N21Va2JcIjtcblxuXHQvLyBKdXN0IGxvYWRlZFxuXHR0aGlzLnNob3dTcGxhc2hJbnRybyA9IHRydWU7XG5cblx0Ly8gQ3VycmVudCBsZXZlbCAvIGNoYXJhY3RlclxuXHR0aGlzLmNoYXJhY3RlciAgICA9ICdhbm5hJztcblx0dGhpcy5sZXZlbHMgICAgICAgPSAxMjsgLy8gKHJlYWRvbmx5KVxuXHR0aGlzLmxldmVsICAgICAgICA9IDA7ICAvLyAwLTExXG5cdHRoaXMuZW5kbGVzcyAgICAgID0gZmFsc2U7XG5cdHRoaXMudW5pdCAgICAgICAgID0gMTAwOyAvLyBweC9tIChyZWFkb25seSlcblxuXHQvLyBEZWJ1Z1xuXHR0aGlzLmxldmVsRGVidWcgICAgID0gXCJcIjtcblx0dGhpcy5jaGFyYWN0ZXJEZWJ1ZyA9IFwiXCI7XG5cblx0Ly8gQ29pbnNcblx0dGhpcy5jb2lucyAgICAgICAgICA9IDA7XG5cdHRoaXMuZGFpbHlCb251c0RhdGUgPSBudWxsO1xuXG5cdC8vIExldmVscyB1bmxvY2tlZFxuXHR0aGlzLmxldmVsc1VubG9ja2VkICAgID0gMTsgLy8gWzEtdGhpcy5sZXZlbHNdXG5cdHRoaXMuc2hvd1VubG9ja2VkTGV2ZWwgPSBmYWxzZTtcblxuXHQvLyBUdXRvcmlhbFxuXHR0aGlzLmhhc1NlZW5JbnRybyAgICA9IGZhbHNlO1xuXHR0aGlzLmhhc1NlZW5PdXRybyAgICA9IGZhbHNlO1xuXHR0aGlzLmhhc1NlZW5UdXRvcmlhbCA9XG5cdHtcblx0XHRhbm5hICAgICAgICAgOiBmYWxzZSxcblx0XHRrcmlzdG9mZiAgICAgOiBmYWxzZSxcblx0XHRvbGFmICAgICAgICAgOiBmYWxzZSxcblx0XHRlbHNhICAgICAgICAgOiBmYWxzZSxcblx0XHRwYWJiaWUgICAgICAgOiBmYWxzZSxcblx0XHRlbmRsZXNzICAgICAgOiBmYWxzZVxuXHR9XG5cblx0Ly8gQ2hhcmFjdGVycyB1bmxvY2tlZFxuXHR0aGlzLmNoYXJhY3RlcnNVbmxvY2tlZCA9XG5cdHtcblx0XHRhbm5hICAgICAgICAgOiB0cnVlLCAvLyBBbHdheXMgdHJ1ZVxuXHRcdGtyaXN0b2ZmICAgICA6IGZhbHNlLFxuXHRcdG9sYWYgICAgICAgICA6IGZhbHNlLFxuXHRcdGVsc2EgICAgICAgICA6IGZhbHNlLFxuXHRcdHBhYmJpZSAgICAgICA6IGZhbHNlXG5cdH1cblx0dGhpcy5zaG93VW5sb2NrZWRDaGFyYWN0ZXIgPSBcIlwiO1xuXG5cdC8vIENoYXJhY3RlcnMgcG93ZXJ1cHMgKGZsaXAsIG1hZ25ldCwgbWFnaWMpXG5cdHRoaXMuY2hhcmFjdGVyc1Bvd2VyID1cblx0e1xuXHRcdGFubmEgICAgICAgICA6IFswLCAwLCAwXSxcblx0XHRrcmlzdG9mZiAgICAgOiBbMCwgMCwgMF0sXG5cdFx0b2xhZiAgICAgICAgIDogWzAsIDAsIDBdLFxuXHRcdGVsc2EgICAgICAgICA6IFswLCAwLCAwXSxcblx0XHRwYWJiaWUgICAgICAgOiBbMCwgMCwgMF1cblx0fVxuXG5cdC8vIENyeXN0YWxzXG5cdHRoaXMuY3J5c3RhbHMgPSBbXTtcblx0Zm9yKHZhciBsZXZlbCA9IDA7IGxldmVsIDwgdGhpcy5sZXZlbHM7IGxldmVsKyspXG5cdHtcblx0XHR0aGlzLmNyeXN0YWxzW2xldmVsXSA9IHt9O1xuXHRcdHRoaXMuY3J5c3RhbHNbbGV2ZWxdLmFubmEgICAgID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXHRcdHRoaXMuY3J5c3RhbHNbbGV2ZWxdLmtyaXN0b2ZmID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXHRcdHRoaXMuY3J5c3RhbHNbbGV2ZWxdLm9sYWYgICAgID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXHRcdHRoaXMuY3J5c3RhbHNbbGV2ZWxdLmVsc2EgICAgID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXHR9XG5cblx0Ly8gVHJvbGxzXG5cdHRoaXMudHJvbGxzID0gW107XG5cdGZvcih2YXIgbGV2ZWwgPSAwOyBsZXZlbCA8IHRoaXMubGV2ZWxzOyBsZXZlbCsrKVxuXHR7XG5cdFx0dGhpcy50cm9sbHNbbGV2ZWxdID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXHR9XG5cblx0Ly8gR29hbHNcblx0dGhpcy5nb2FscyA9IHt9O1xuXG5cdC8vIEhpZ2hzY29yZVxuXHR0aGlzLmhpZ2hzY29yZSA9IHt9O1xuXG5cdC8vIExvc3Mgc3RyZWFrIHJld2FyZFxuXHR0aGlzLmxvc3NTdHJlYWsgPVxuXHR7XG5cdFx0Y291bnQgICA6IDAsXG5cdFx0YXdhcmRlZCA6IGZhbHNlXG5cdH1cblxuXHQvLyBBbGwgbGV2ZWwgY29tcGxldGVkXG5cdHRoaXMuZW5kR2FtZU1lc3NhZ2UgPVxuXHR7XG5cdFx0ZW5kbGVzcyA6IC8vIFdoZW4gdGhlIHJlcXVpcmVkIGFtb3VudCBvZiBsZXZlbHMgdG8gdW5sb2NrZW5kbGVzcyBtb2RlIGhhdmUgYmVlbiBjb21wbGV0ZWRcblx0XHR7XG5cdFx0XHRzaG93ICA6IGZhbHNlLFxuXHRcdFx0c2hvd24gOiBmYWxzZVxuXHRcdH0sXG5cdFx0bGV2ZWxzIDogLy8gV2hlbiBhbGwgbGV2ZWxzIGhhdmUgYmVlbiBjb21wbGV0ZWRcblx0XHR7XG5cdFx0XHRzaG93ICA6IGZhbHNlLFxuXHRcdFx0c2hvd24gOiBmYWxzZVxuXHRcdH0sXG5cdFx0Y3J5c3RhbHMgOiAvLyB3aGVuIGFsbCBjcnlzdGFscyBoYXZlIGJlZW4gY29sbGVjdGVkIC8gcGFiYmllIHVubG9ja2VkXG5cdFx0e1xuXHRcdFx0c2hvdyAgOiBmYWxzZSxcblx0XHRcdHNob3duIDogZmFsc2Vcblx0XHR9LFxuXHRcdHRyb2xscyA6IC8vIHdoZW4gYWxsIHRyb2xscyBoYXZlIGJlZW4gY29sbGVjdGVkXG5cdFx0e1xuXHRcdFx0c2hvdyAgOiBmYWxzZSxcblx0XHRcdHNob3duIDogZmFsc2Vcblx0XHR9XG5cdH1cblxuXHQvLyBQcm9tb1xuXHR0aGlzLnByb21vVGltZSAgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLnByb21vLnRpbWU7XG5cdHRoaXMucHJvbW9TaG93biA9IFtdO1xuXHRcblx0Ly8gQ29kZXNcblx0dGhpcy5jb2Rlc1VzZWQgPSBbXTtcbn1cbm1vZHVsZS5leHBvcnRzID0gU2F2ZWREYXRhO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblNhdmVkRGF0YS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcblx0aWYoIXdpbmRvdy5sb2NhbFN0b3JhZ2VbdGhpcy5TQVZFX05BTUUgKyBcIl9cIiArIHRoaXMuU0FWRV9WRVJTSU9OXSlcblx0e1xuXHRcdGNvbnNvbGUubG9nKCdyZXNldCcpO1xuXHRcdHRoaXMucmVzZXQoKTtcblx0XHR0aGlzLnNhdmUoKTtcblx0fVxuXHRlbHNlXG5cdHtcblx0XHRjb25zb2xlLmxvZygnbG9hZCcpO1xuXHRcdHRoaXMubG9hZCgpO1xuXHR9XG59O1xuXG4vKipcbiAqIFJlc2V0XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXG57XG5cbn07XG5cbi8qKlxuICogTG9hZFxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpXG57XG5cdHZhciBkYXRhID0gd2luZG93LmxvY2FsU3RvcmFnZVt0aGlzLlNBVkVfTkFNRSArIFwiX1wiICsgdGhpcy5TQVZFX1ZFUlNJT05dO1xuXHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblxuXHR0aGlzLmNvaW5zICAgICAgICAgICAgICAgICAgICA9IHBhcnNlSW50KGRhdGEuY29pbnMpLFxuXHR0aGlzLmxldmVsc1VubG9ja2VkICAgICAgICAgICA9IHBhcnNlSW50KGRhdGEubGV2ZWxzVW5sb2NrZWQpLFxuXHR0aGlzLmhhc1NlZW5JbnRybyAgICAgICAgICAgICA9IGRhdGEuaGFzU2VlbkludHJvLFxuXHR0aGlzLmhhc1NlZW5PdXRybyAgICAgICAgICAgICA9IGRhdGEuaGFzU2Vlbk91dHJvLFxuXHR0aGlzLnNob3dVbmxvY2tlZExldmVsICAgICAgICA9IGRhdGEuc2hvd1VubG9ja2VkTGV2ZWw7XG5cdHRoaXMuc2hvd1VubG9ja2VkQ2hhcmFjdGVyICAgID0gZGF0YS5zaG93VW5sb2NrZWRDaGFyYWN0ZXI7XG5cdHRoaXMuaGFzU2VlblR1dG9yaWFsICAgICAgICAgID0gZGF0YS5oYXNTZWVuVHV0b3JpYWw7XG5cdHRoaXMuY2hhcmFjdGVyc1VubG9ja2VkICAgICAgID0gZGF0YS5jaGFyYWN0ZXJzVW5sb2NrZWQ7XG5cdHRoaXMuY2hhcmFjdGVyc1Bvd2VyICAgICAgICAgID0gZGF0YS5jaGFyYWN0ZXJzUG93ZXI7XG5cdHRoaXMuZ29hbHMgICAgICAgICAgICAgICAgICAgID0gZGF0YS5nb2Fscztcblx0dGhpcy5kYWlseUJvbnVzRGF0ZSAgICAgICAgICAgPSBkYXRhLmRhaWx5Qm9udXNEYXRlO1xuXHR0aGlzLmNyeXN0YWxzICAgICAgICAgICAgICAgICA9IGRhdGEuY3J5c3RhbHM7XG5cdHRoaXMudHJvbGxzICAgICAgICAgICAgICAgICAgID0gZGF0YS50cm9sbHM7XG5cdHRoaXMuaGlnaHNjb3JlICAgICAgICAgICAgICAgID0gZGF0YS5oaWdoc2NvcmU7XG5cdHRoaXMubG9zc1N0cmVhayAgICAgICAgICAgICAgID0gZGF0YS5sb3NzU3RyZWFrO1xuXHR0aGlzLmVuZEdhbWVNZXNzYWdlICAgICAgICAgICA9IGRhdGEuZW5kR2FtZU1lc3NhZ2U7XG5cdHRoaXMucHJvbW9TaG93biAgICAgICAgICAgICAgID0gISFkYXRhLnByb21vU2hvd24gPyBkYXRhLnByb21vU2hvd24gOiB0aGlzLnByb21vU2hvd247XG5cdHRoaXMuY29kZXNVc2VkICAgICAgICAgICAgICAgID0gISFkYXRhLmNvZGVzVXNlZCAgPyBkYXRhLmNvZGVzVXNlZCA6IHRoaXMuY29kZXNVc2VkO1xuXHR0aGlzLmxldmVsRGVidWcgICAgICAgICAgICAgICA9IGRhdGEubGV2ZWxEZWJ1Zztcblx0dGhpcy5jaGFyYWN0ZXJEZWJ1ZyAgICAgICAgICAgPSBkYXRhLmNoYXJhY3RlckRlYnVnO1xufTtcblxuLyoqXG4gKiBTYXZlXG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uKClcbntcblx0Y29uc29sZS5sb2coJ3NhdmUnKTtcblx0dmFyIGRhdGEgPVxuXHR7XG5cdFx0Y29pbnMgICAgICAgICAgICAgICAgICAgIDogdGhpcy5jb2lucyxcblx0XHRsZXZlbHNVbmxvY2tlZCAgICAgICAgICAgOiB0aGlzLmxldmVsc1VubG9ja2VkLFxuXHRcdGhhc1NlZW5JbnRybyAgICAgICAgICAgICA6IHRoaXMuaGFzU2VlbkludHJvLFxuXHRcdGhhc1NlZW5PdXRybyAgICAgICAgICAgICA6IHRoaXMuaGFzU2Vlbk91dHJvLFxuXHRcdHNob3dVbmxvY2tlZExldmVsICAgICAgICA6IHRoaXMuc2hvd1VubG9ja2VkTGV2ZWwsXG5cdFx0c2hvd1VubG9ja2VkQ2hhcmFjdGVyICAgIDogdGhpcy5zaG93VW5sb2NrZWRDaGFyYWN0ZXIsXG5cdFx0aGFzU2VlblR1dG9yaWFsICAgICAgICAgIDogdGhpcy5oYXNTZWVuVHV0b3JpYWwsXG5cdFx0Y2hhcmFjdGVyc1VubG9ja2VkICAgICAgIDogdGhpcy5jaGFyYWN0ZXJzVW5sb2NrZWQsXG5cdFx0Y2hhcmFjdGVyc1Bvd2VyICAgICAgICAgIDogdGhpcy5jaGFyYWN0ZXJzUG93ZXIsXG5cdFx0Z29hbHMgICAgICAgICAgICAgICAgICAgIDogdGhpcy5nb2Fscyxcblx0XHRkYWlseUJvbnVzRGF0ZSAgICAgICAgICAgOiB0aGlzLmRhaWx5Qm9udXNEYXRlLFxuXHRcdGNyeXN0YWxzICAgICAgICAgICAgICAgICA6IHRoaXMuY3J5c3RhbHMsXG5cdFx0dHJvbGxzICAgICAgICAgICAgICAgICAgIDogdGhpcy50cm9sbHMsXG5cdFx0aGlnaHNjb3JlICAgICAgICAgICAgICAgIDogdGhpcy5oaWdoc2NvcmUsXG5cdFx0bG9zc1N0cmVhayAgICAgICAgICAgICAgIDogdGhpcy5sb3NzU3RyZWFrLFxuXHRcdGVuZEdhbWVNZXNzYWdlICAgICAgICAgICA6IHRoaXMuZW5kR2FtZU1lc3NhZ2UsXG5cdFx0bGV2ZWxEZWJ1ZyAgICAgICAgICAgICAgIDogdGhpcy5sZXZlbERlYnVnLFxuXHRcdGNoYXJhY3RlckRlYnVnICAgICAgICAgICA6IHRoaXMuY2hhcmFjdGVyRGVidWcsXG5cdFx0cHJvbW9TaG93biAgICAgICAgICAgICAgIDogdGhpcy5wcm9tb1Nob3duLFxuXHRcdGNvZGVzVXNlZCAgICAgICAgICAgICAgICA6IHRoaXMuY29kZXNVc2VkXG5cdH07XG5cblx0dmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcblx0ZGF0YS5oYXNoID0gbWQ1KGpzb24gKyB0aGlzLlNBVkVfU0VFRCk7XG5cblx0d2luZG93LmxvY2FsU3RvcmFnZVt0aGlzLlNBVkVfTkFNRSArIFwiX1wiICsgdGhpcy5TQVZFX1ZFUlNJT05dID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG59O1xuXG4vKipcbiAqIFJldHVybiBob3cgbWFueSBjaGFyYWN0ZXIgaGF2ZSBiZWVuIHVubG9ja2VkXG4gKiBAcmV0dXJucyB7TnVtYmVyfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldFVubG9ja2VkQ2hhcmFjdGVyQ291bnQgPSBmdW5jdGlvbigpXG57XG5cdHZhciBjb3VudCA9IDA7XG5cblx0Zm9yICh2YXIga2V5IGluIHRoaXMuY2hhcmFjdGVyc1VubG9ja2VkKVxuXHR7XG5cdFx0Y291bnQgKz0gISF0aGlzLmNoYXJhY3RlcnNVbmxvY2tlZFtrZXldID8gMSA6IDA7XG5cdH1cblxuXHRyZXR1cm4gY291bnQ7XG59O1xuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmIGl0J3MgdGhlIGZpcnN0IHRpbWUgdGhlIHBsYXllciBwbGF5cyB0b2RheVxuICogQHJldHVybnMge0Jvb2xlYW59XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuY2FuQXdhcmREYWlseUJvbnVzID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG5cblx0aWYodGhpcy5kYWlseUJvbnVzRGF0ZSA9PSBudWxsKVxuXHR7XG5cdFx0dGhpcy5hd2FyZERhaWx5Qm9udXMoMCk7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5kYWlseUJvbnVzRGF0ZSAhPSBudWxsICYmIHRoaXMuZGFpbHlCb251c0RhdGUgIT0gKGRhdGUuZ2V0RnVsbFllYXIoKSArIFwiX1wiICsgZGF0ZS5nZXRNb250aCgpICsgXCJfXCIgKyBkYXRlLmdldERheSgpKTtcbn1cblxuLyoqXG4gKiBBd2FyZCBkYWlseSBib251cyBwb2ludHNcbiAqIEBwYXJhbSB7TnVtYmVyfSBhbW91bnRcbiAqL1xuU2F2ZWREYXRhLnByb3RvdHlwZS5hd2FyZERhaWx5Qm9udXMgPSBmdW5jdGlvbihhbW91bnQpXG57XG5cdHZhciBkYXRlID0gbmV3IERhdGUoKTtcblxuXHR0aGlzLmNvaW5zICs9IGFtb3VudDtcblx0dGhpcy5kYWlseUJvbnVzRGF0ZSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArIFwiX1wiICsgZGF0ZS5nZXRNb250aCgpICsgXCJfXCIgKyBkYXRlLmdldERheSgpO1xuXG5cdHRoaXMuc2F2ZSgpO1xufVxuXG4vKipcbiAqIFJldHVybiB0aGUgdG90YWwgYW1vdXQgb2YgY3J5c3RhbHMgY29sbGVjdGVkXG4gKiBAcmV0dXJucyB7TnVtYmVyfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldENvbGxlY3RlZENyeXN0YWxDb3VudCA9IGZ1bmN0aW9uKClcbntcblx0dmFyIGNvdW50ID0gMDtcblxuXHRmb3IodmFyIGxldmVsID0gMDsgbGV2ZWwgPCB0aGlzLmNyeXN0YWxzLmxlbmd0aDsgbGV2ZWwrKylcblx0e1xuXHRcdGZvcih2YXIga2V5IGluIHRoaXMuY3J5c3RhbHNbbGV2ZWxdKVxuXHRcdHtcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmNyeXN0YWxzW2xldmVsXVtrZXldLmxlbmd0aDsgaSsrKVxuXHRcdFx0e1xuXHRcdFx0XHRpZih0aGlzLmNyeXN0YWxzW2xldmVsXVtrZXldW2ldKVxuXHRcdFx0XHRcdGNvdW50Kys7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGNvdW50O1xufVxuXG4vKipcbiAqIFJldHVybiB0aGUgdG90YWwgYW1vdXQgb2YgY3J5c3RhbHMgdGhhdCBjYW4gYmUgY29sbGVjdGVkXG4gKiBAcmV0dXJucyB7TnVtYmVyfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldENyeXN0YWxDb3VudCA9IGZ1bmN0aW9uKClcbntcblx0dmFyIGNvdW50ID0gMDtcblxuXHRmb3IodmFyIGxldmVsID0gMDsgbGV2ZWwgPCB0aGlzLmNyeXN0YWxzLmxlbmd0aDsgbGV2ZWwrKylcblx0e1xuXHRcdGZvcih2YXIga2V5IGluIHRoaXMuY3J5c3RhbHNbbGV2ZWxdKVxuXHRcdHtcblx0XHRcdGNvdW50ICs9IHRoaXMuY3J5c3RhbHNbbGV2ZWxdW2tleV0ubGVuZ3RoO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBjb3VudDtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIHRvdGFsIGFtb3V0IG9mIGNyeXN0YWxzIGNvbGxlY3RlZCBpbiBhIGxldmVsIGJ5IGEgY2hhcmFjdGVyXG4gKiBAcGFyYW0ge051bWJlcn0gbGV2ZWxcbiAqIEBwYXJhbSB7U3RyaW5nfSBjaGFyYWN0ZXJcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuZ2V0TGV2ZWxDaGFyYWN0ZXJDcnlzdGFsQ291bnQgPSBmdW5jdGlvbihsZXZlbCwgY2hhcmFjdGVyKVxue1xuXHR2YXIgY291bnQgPSAwO1xuXG5cdGlmKCEhdGhpcy5jcnlzdGFsc1tsZXZlbF1bY2hhcmFjdGVyXSlcblx0e1xuXHRcdGZvcih2YXIgY3J5c3RhbCA9IDA7IGNyeXN0YWwgPCB0aGlzLmNyeXN0YWxzW2xldmVsXVtjaGFyYWN0ZXJdLmxlbmd0aDsgY3J5c3RhbCsrKVxuXHRcdHtcblx0XHRcdGlmKCEhdGhpcy5jcnlzdGFsc1tsZXZlbF1bY2hhcmFjdGVyXVtjcnlzdGFsXSkgY291bnQrKztcblx0XHR9XG5cdH1cblx0cmV0dXJuIGNvdW50O1xufVxuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmIGEgc3BlY2lmaWMgY3J5c3RhbCBoYXMgYmVlbiBjb2xsZWN0ZWRcbiAqIEBwYXJhbSB7TnVtYmVyfSBsZXZlbFxuICogQHBhcmFtIHtTdHJpbmd9IGNoYXJhY3RlclxuICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuaXNDcnlzdGFsQ29sbGVjdGVkID0gZnVuY3Rpb24obGV2ZWwsIGNoYXJhY3RlciwgaW5kZXgpXG57XG5cdHJldHVybiB0aGlzLmNyeXN0YWxzW2xldmVsXVtjaGFyYWN0ZXJdW2luZGV4XTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIHRvdGFsIGFtb3V0IG9mIHRyb2xscyBjb2xsZWN0ZWRcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuZ2V0Q29sbGVjdGVkVHJvbGxDb3VudCA9IGZ1bmN0aW9uKClcbntcblx0dmFyIGNvdW50ID0gMDtcblxuXHRmb3IodmFyIGxldmVsID0gMDsgbGV2ZWwgPCB0aGlzLnRyb2xscy5sZW5ndGg7IGxldmVsKyspXG5cdHtcblx0XHRmb3IodmFyIHRyb2xsID0gMDsgdHJvbGwgPCB0aGlzLnRyb2xsc1tsZXZlbF0ubGVuZ3RoOyB0cm9sbCsrKVxuXHRcdHtcblx0XHRcdGlmKCEhdGhpcy50cm9sbHNbbGV2ZWxdW3Ryb2xsXSlcblx0XHRcdFx0Y291bnQrKztcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gY291bnQ7XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSB0b3RhbCBhbW91dCBvZiB0cm9sbHMgdGhhdCBjYW4gYmUgY29sbGVjdGVkXG4gKiBAcmV0dXJucyB7TnVtYmVyfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldFRyb2xsQ291bnQgPSBmdW5jdGlvbigpXG57XG5cdHZhciBjb3VudCA9IDA7XG5cblx0Zm9yKHZhciBsZXZlbCA9IDA7IGxldmVsIDwgdGhpcy50cm9sbHMubGVuZ3RoOyBsZXZlbCsrKVxuXHR7XG5cdFx0Y291bnQgKz0gdGhpcy50cm9sbHNbbGV2ZWxdLmxlbmd0aDtcblx0fVxuXG5cdHJldHVybiBjb3VudDtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiBhIHNwZWNpZmljIHRyb2xsIGhhcyBiZWVuIGNvbGxlY3RlZFxuICogQHBhcmFtIHtOdW1iZXJ9IGxldmVsXG4gKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcbiAqL1xuU2F2ZWREYXRhLnByb3RvdHlwZS5pc1Ryb2xsQ29sbGVjdGVkID0gZnVuY3Rpb24obGV2ZWwsIGluZGV4KVxue1xuXHRyZXR1cm4gdGhpcy50cm9sbHNbbGV2ZWxdW2luZGV4XTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIHRvdGFsIGFtb3V0IG9mIHRyb2xscyBjb2xsZWN0ZWRcbiAqIEBwYXJhbSB7TnVtYmVyfSBsZXZlbFxuICogQHJldHVybnMge051bWJlcn1cbiAqL1xuU2F2ZWREYXRhLnByb3RvdHlwZS5nZXRMZXZlbENvbGxlY3RlZFRyb2xsQ291bnQgPSBmdW5jdGlvbihsZXZlbClcbntcblx0dmFyIGNvdW50ID0gMDtcblxuXHRmb3IodmFyIHRyb2xsID0gMDsgdHJvbGwgPCB0aGlzLnRyb2xsc1tsZXZlbF0ubGVuZ3RoOyB0cm9sbCsrKVxuXHR7XG5cdFx0aWYoISF0aGlzLnRyb2xsc1tsZXZlbF1bdHJvbGxdKVxuXHRcdFx0Y291bnQrKztcblx0fVxuXHRyZXR1cm4gY291bnQ7XG59XG5cblxuLyoqXG4gKiBSZXR1cm4gdGhlIGNvbG9yIGFzc2lnbmVkIHRvIGEgY2hhcmFjdGVyXG4gKiBAcGFyYW0ge1N0cmluZ30gY2hhcmFjdGVyXG4gKiBAcmV0dXJucyB7U3RyaW5nfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldENvbG9yQnlDaGFyYWN0ZXIgPSBmdW5jdGlvbihjaGFyYWN0ZXIpXG57XG5cdHZhciBjaGFyYWN0ZXJEYXRhID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuY2hhcmFjdGVycztcblx0cmV0dXJuIGNoYXJhY3RlckRhdGFbY2hhcmFjdGVyXS5jb2xvcjtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIGNoYXJhY3RlciBhc3NpZ25lZCB0byBhIGNvbG9yXG4gKiBAcGFyYW0ge1N0cmluZ30gY29sb3JcbiAqIEByZXR1cm5zIHtTdHJpbmd9XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQnlDb2xvciA9IGZ1bmN0aW9uKGNvbG9yKVxue1xuXHR2YXIgZGF0YSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpO1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgZGF0YS5wbGF5YWJsZUNoYXJhY3RlcnMubGVuZ3RoOyBpKyspXG5cdHtcblx0XHRpZihkYXRhLmNoYXJhY3RlcnNbZGF0YS5wbGF5YWJsZUNoYXJhY3RlcnNbaV1dLmNvbG9yID09IGNvbG9yKVxuXHRcdHtcblx0XHRcdHJldHVybiBkYXRhLnBsYXlhYmxlQ2hhcmFjdGVyc1tpXTtcblx0XHR9XG5cdH1cbn1cblxuLyoqXG4gKiBTYXZlIHRoZSBoaWdoc2NvcmUgZm9yIHRoZSBnaXZlbiBsZXZlbCwgaWYgaGlnaGVyXG4gKiBAcGFyYW0ge1N0cmluZ30gbW9kZVxuICogQHBhcmFtIHtOdW1iZXJ9IHNjb3JlXG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUucmVjb3JkSGlnaHNjb3JlID0gZnVuY3Rpb24obW9kZSwgc2NvcmUpXG57XG5cdGlmKCF0aGlzLmhpZ2hzY29yZVttb2RlXSB8fCB0aGlzLmhpZ2hzY29yZVttb2RlXSA8IHNjb3JlKVxuXHR7XG5cdFx0dGhpcy5oaWdoc2NvcmVbbW9kZV0gPSBzY29yZTtcblx0fVxufVxuXG4vKipcbiAqIFJldHVybiB0aGUgaGlnaHNjb3JlIGZvciB0aGUgZ2l2ZW4gbGV2ZWxcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuZ2V0SGlnaHNjb3JlID0gZnVuY3Rpb24obW9kZSlcbntcblx0cmV0dXJuICEhdGhpcy5oaWdoc2NvcmVbbW9kZV0gPyB0aGlzLmhpZ2hzY29yZVttb2RlXSA6IDA7XG59XG5cbi8qKlxuICogUmV0dXJuIGlmIGVub3VnaCB0aW1lIGhhcyBwYXNzZWQgdG8gc2hvdyBhIHByb21vIGFuZCB0aGVyZSBhcmUgc3RpbGwgcHJvbW9zIHRvIHNob3dcbiAqIEByZXR1cm5zIHtib29sfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmNhblNob3dQcm9tbyA9IGZ1bmN0aW9uKClcbntcblx0cmV0dXJuIChNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSA+IHRoaXMucHJvbW9UaW1lKSAmJiAodGhpcy5nZXROZXdQcm9tbygpICE9IG51bGwpO1xufVxuXG4vKipcbiAqIFJldHVybiBpZiB0aGUgZ2l2ZW4gcHJvbW8gaGFzIGJlZW4gc2hvd25cbiAqIEByZXR1cm5zIHtib29sfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmhhc1Nob3duUHJvbW8gPSBmdW5jdGlvbihwcm9tbylcbntcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMucHJvbW9TaG93bi5sZW5ndGg7IGkrKylcblx0e1xuXHRcdGlmKHByb21vLmltYWdlID09IHRoaXMucHJvbW9TaG93bltpXSlcblx0XHR7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21vIHRoYXQgaGFzIG5vdCBiZWVuIHNob3duIHlldFxuICogQHJldHVybnMge09iamVjdH1cbiAqL1xuU2F2ZWREYXRhLnByb3RvdHlwZS5nZXROZXdQcm9tbyA9IGZ1bmN0aW9uKClcbntcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKS5wcm9tb3MubGVuZ3RoOyBpKyspXG5cdHtcblx0XHRpZighdGhpcy5oYXNTaG93blByb21vKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKS5wcm9tb3NbaV1bQ29tbW9uLkNPVU5UUllfQ09ERV0pKVxuXHRcdHtcblx0XHRcdHJldHVybiB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIikucHJvbW9zW2ldW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGdpdmVuIHByb21vIGFzIHNob3duXG4gKiBAcGFyYW0ge09iamVjdHN9XG4gKi9cblNhdmVkRGF0YS5wcm90b3R5cGUuc2V0UHJvbW9Bc1Nob3duID0gZnVuY3Rpb24ocHJvbW8pXG57XG5cdHRoaXMucHJvbW9UaW1lID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5wcm9tby50aW1lO1xuXHRDb21tb24uc2F2ZWREYXRhLnByb21vU2hvd24ucHVzaChwcm9tby5pbWFnZSk7XG59XG5cbi8qKlxuICogUmV0dXJuIGlmIHRoZSBjb2RlIGlzIHZhbGlkXG4gKiBAcGFyYW0ge3N0cmluZ31cbiAqIEByZXR1cm5zIHtib29sfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmlzQ29kZVZhbGlkID0gZnVuY3Rpb24oY29kZSlcbntcblx0cmV0dXJuICEhdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuY29kZXNbY29kZV07XG59XG5cbi8qKlxuICogUmV0dXJuIGlmIHRoZSBjb2RlIGhhcyBiZWVuIHJlZGVlbWVkXG4gKiBAcGFyYW0ge3N0cmluZ31cbiAqIEByZXR1cm5zIHtib29sfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmlzQ29kZVJlZGVlbWVkID0gZnVuY3Rpb24oY29kZSlcbntcblx0cmV0dXJuIHRoaXMuY29kZXNVc2VkLmluZGV4T2YoY29kZSkgIT0gLTE7XG59XG5cbi8qKlxuICogU2V0IHRoZSBnaXZlbiBjb2RlIGFzIHVzZWRcbiAqIEBwYXJhbSB7c3RyaW5nfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLnNldENvZGVBc1VzZWQgPSBmdW5jdGlvbihjb2RlKVxue1xuXHRDb21tb24uc2F2ZWREYXRhLmNvZGVzVXNlZC5wdXNoKGNvZGUpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIGNvZGUncyByZXdhcmRcbiAqIEBwYXJhbSB7c3RyaW5nfVxuICovXG5TYXZlZERhdGEucHJvdG90eXBlLmdldENvZGVWYWx1ZSA9IGZ1bmN0aW9uKGNvZGUpXG57XG5cdHJldHVybiBwYXJzZUludCh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5jb2Rlc1tjb2RlXSk7XG59IiwidmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gQmV6aWVyUGF0aCgpXHJcbntcclxuXHR0aGlzLnBvaW50cyAgICAgICAgICAgICAgICA9IFtdO1xyXG5cdHRoaXMucXVhZFdpZHRoICAgICAgICAgICAgID0gOTY7XHJcblx0dGhpcy5jYWNoZURyYXdpbmdQb2ludHMgICAgPSB0cnVlO1xyXG5cdHRoaXMuX2RyYXdpbmdQb2ludHMgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLl9kcmF3aW5nUG9pbnRzTm9ybWFscyA9IG51bGw7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBCZXppZXJQYXRoO1xyXG5cclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5CZXppZXJQYXRoLnByb3RvdHlwZS5hZGRQb2ludCA9IGZ1bmN0aW9uKHgsIHksIGluZGV4KVxyXG57XHJcblx0aWYoIWluZGV4KVxyXG5cdFx0dGhpcy5wb2ludHMucHVzaCh7eDp4LCB5Onl9KTtcclxuXHRlbHNlXHJcblx0XHR0aGlzLnBvaW50cy5zcGxpY2UoaW5kZXgsIDAsIHt4OngsIHk6eX0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKlxyXG4gKi9cclxuQmV6aWVyUGF0aC5wcm90b3R5cGUuZGVsZXRlUG9pbnQgPSBmdW5jdGlvbihpbmRleClcclxue1xyXG5cdHRoaXMucG9pbnRzLnNwbGljZShpbmRleCwgMSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKlxyXG4gKi9cclxuQmV6aWVyUGF0aC5wcm90b3R5cGUuZ2V0Rmlyc3RQb2ludCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHJldHVybiB0aGlzLnBvaW50c1swXTtcclxufVxyXG5cclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5CZXppZXJQYXRoLnByb3RvdHlwZS5nZXRMYXN0UG9pbnQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRyZXR1cm4gdGhpcy5wb2ludHNbdGhpcy5wb2ludHMubGVuZ3RoLTFdO1xyXG59XHJcblxyXG5CZXppZXJQYXRoLnByb3RvdHlwZS5nZXRQZW51bHRpbWF0ZVBvaW50ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0cmV0dXJuIHRoaXMucG9pbnRzW3RoaXMucG9pbnRzLmxlbmd0aC0yXTtcclxufVxyXG5cclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5CZXppZXJQYXRoLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHJldHVybiB0aGlzLmdldExhc3RQb2ludCgpLnggLSB0aGlzLmdldEZpcnN0UG9pbnQoKS54O1xyXG59XHJcblxyXG4vKipcclxuICpcclxuICovXHJcbkJlemllclBhdGgucHJvdG90eXBlLmNhbGN1bGF0ZUJlemllclBvaW50ID0gZnVuY3Rpb24odCwgcDAsIHAxLCBwMiwgcDMpXHJcbntcclxuXHR2YXIgdSAgID0gMSAtIHQ7XHJcblx0dmFyIHR0ICA9IHQqdDtcclxuXHR2YXIgdXUgID0gdSp1O1xyXG5cdHZhciB1dXUgPSB1dSAqIHU7XHJcblx0dmFyIHR0dCA9IHR0ICogdDtcclxuXHJcblx0cCA9IHt4OiB1dXUgKiBwMC54LCB5OiB1dXUgKiBwMC55fTsgLy9maXJzdCB0ZXJtXHJcblx0cC54ICs9IDMgKiB1dSAqIHQgKiBwMS54OyAvL3NlY29uZCB0ZXJtXHJcblx0cC55ICs9IDMgKiB1dSAqIHQgKiBwMS55O1xyXG5cdHAueCArPSAzICogdSAqIHR0ICogcDIueDsgLy90aGlyZCB0ZXJtXHJcblx0cC55ICs9IDMgKiB1ICogdHQgKiBwMi55O1xyXG5cdHAueCArPSB0dHQgKiBwMy54OyAvL2ZvdXJ0aCB0ZXJtXHJcblx0cC55ICs9IHR0dCAqIHAzLnk7XHJcblxyXG5cdHJldHVybiBwO1xyXG59XHJcblxyXG4vKipcclxuICpcclxuICovXHJcbkJlemllclBhdGgucHJvdG90eXBlLmdldERyYXdpbmdQb2ludHMgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLmNhY2hlRHJhd2luZ1BvaW50cyAmJiB0aGlzLl9kcmF3aW5nUG9pbnRzICE9IG51bGwpIHJldHVybiB0aGlzLl9kcmF3aW5nUG9pbnRzO1xyXG5cclxuXHR0aGlzLl9kcmF3aW5nUG9pbnRzID0gW107XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMucG9pbnRzLmxlbmd0aCAtIDM7IGkrPTMpXHJcbiAgICB7XHJcblx0XHR2YXIgcDAgPSB0aGlzLnBvaW50c1tpXTtcclxuXHRcdHZhciBwMSA9IHRoaXMucG9pbnRzW2kgKyAxXTtcclxuXHRcdHZhciBwMiA9IHRoaXMucG9pbnRzW2kgKyAyXTtcclxuXHRcdHZhciBwMyA9IHRoaXMucG9pbnRzW2kgKyAzXTtcclxuXHJcblx0XHR2YXIgdGVudGF0aXZlTGVuZ3RoID0gTWF0aC5zcXJ0KE1hdGgucG93KHAwLnggIC0gcDMueCwgMikgKyBNYXRoLnBvdyhwMC55IC0gcDMueSwgMikpO1xyXG5cdFx0dmFyIG5TZWdtZW50cyAgICAgICA9IE1hdGguY2VpbCh0ZW50YXRpdmVMZW5ndGgvdGhpcy5xdWFkV2lkdGgpO1xyXG5cclxuXHRcdGlmKGkgPT0gMCkgLy8gRmlyc3QgZW5kcG9pbnRcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fZHJhd2luZ1BvaW50cy5wdXNoKHRoaXMuY2FsY3VsYXRlQmV6aWVyUG9pbnQoMCwgcDAsIHAxLCBwMiwgcDMpKTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IodmFyIGogPSAxOyBqIDw9IG5TZWdtZW50czsgaisrKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdCA9IGogLyBuU2VnbWVudHM7XHJcblx0XHRcdHRoaXMuX2RyYXdpbmdQb2ludHMucHVzaCh0aGlzLmNhbGN1bGF0ZUJlemllclBvaW50KHQsIHAwLCBwMSwgcDIsIHAzKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdGhpcy5fZHJhd2luZ1BvaW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5CZXppZXJQYXRoLnByb3RvdHlwZS5nZXREcmF3aW5nUG9pbnRzTm9ybWFscyA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuY2FjaGVEcmF3aW5nUG9pbnRzICYmIHRoaXMuX2RyYXdpbmdQb2ludHNOb3JtYWxzICE9IG51bGwpIHJldHVybiB0aGlzLl9kcmF3aW5nUG9pbnRzTm9ybWFscztcclxuXHJcblx0dmFyIGRyYXdpbmdQb2ludHMgPSB0aGlzLmdldERyYXdpbmdQb2ludHMoKTtcclxuXHJcblx0dGhpcy5fZHJhd2luZ1BvaW50c05vcm1hbHMgPSBbXTtcclxuXHJcblx0Zm9yKHZhciBpID0gMTsgaSA8IGRyYXdpbmdQb2ludHMubGVuZ3RoIC0gMTsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBwcmV2UG9pbnQgPSBkcmF3aW5nUG9pbnRzW2ktMV07XHJcblx0XHR2YXIgbmV4dFBvaW50ID0gZHJhd2luZ1BvaW50c1tpKzFdO1xyXG5cdFx0dmFyIGxpbmUgPSB7eDpuZXh0UG9pbnQueCAtIHByZXZQb2ludC54LCB5Om5leHRQb2ludC55IC0gcHJldlBvaW50Lnl9O1xyXG5cdFx0dmFyIHBlcnAgPSB7eDotbGluZS55LCB5OmxpbmUueH07XHJcblx0XHR2YXIgcGVycExlbmd0aCA9IE1hdGguc3FydChwZXJwLnggKiBwZXJwLnggKyBwZXJwLnkgKiBwZXJwLnkpO1xyXG5cdFx0dmFyIHBlcnBOb3JtID0ge3g6IHBlcnAueC9wZXJwTGVuZ3RoLCB5OiBwZXJwLnkvcGVycExlbmd0aH07XHJcblx0XHR0aGlzLl9kcmF3aW5nUG9pbnRzTm9ybWFsc1tpXSA9IHBlcnBOb3JtO1xyXG5cdH1cclxuXHJcblx0Ly8gVE9ETzogY2FuIGJlIGltcHJvdmVkXHJcblx0dGhpcy5fZHJhd2luZ1BvaW50c05vcm1hbHNbMF0gPSB7eDowLCB5OjF9O1xyXG5cdHRoaXMuX2RyYXdpbmdQb2ludHNOb3JtYWxzW2RyYXdpbmdQb2ludHMubGVuZ3RoLTFdID0ge3g6MCwgeToxfTtcclxuXHJcblx0cmV0dXJuIHRoaXMuX2RyYXdpbmdQb2ludHNOb3JtYWxzO1xyXG59XHJcblxyXG5cclxuQmV6aWVyUGF0aC5wcm90b3R5cGUuZ2V0R3JvdW5kU2VnbWVudHMgPSBmdW5jdGlvbihtaW5BbmdsZSwgbWF4QW5nbGUpXHJcbntcclxuXHR2YXIgc2VnbWVudHMgPSBbXTtcclxuXHR2YXIgc2VnbWVudCAgPSBudWxsO1xyXG5cclxuXHR2YXIgZHJhd2luZ1BvaW50cyAgICAgICAgPSB0aGlzLmdldERyYXdpbmdQb2ludHMoKTtcclxuXHR2YXIgZHJhd2luZ1BvaW50c05vcm1hbHMgPSB0aGlzLmdldERyYXdpbmdQb2ludHNOb3JtYWxzKCk7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBkcmF3aW5nUG9pbnRzLmxlbmd0aCAtIDE7IGkrKylcclxuXHR7XHJcblx0XHQgdmFyIGFuZ2xlID0gTWF0aC5hYnMoTWF0aC5hdGFuMihkcmF3aW5nUG9pbnRzW2krMV0ueSAtIGRyYXdpbmdQb2ludHNbaV0ueSwgZHJhd2luZ1BvaW50c1tpKzFdLnggLSBkcmF3aW5nUG9pbnRzW2ldLngpICogUElYSS5SQURfVE9fREVHKTtcclxuXHJcblx0XHQgaWYoYW5nbGUgPCBtaW5BbmdsZSB8fCBhbmdsZSA+IG1heEFuZ2xlKVxyXG5cdFx0IHtcclxuXHRcdFx0IGlmKHNlZ21lbnQgPT0gbnVsbCkgY29udGludWU7XHJcblx0XHRcdCBzZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xyXG5cdFx0XHQgc2VnbWVudCA9IG51bGw7XHJcblx0XHQgfVxyXG5cdFx0IGVsc2VcclxuXHRcdCB7XHJcblx0XHRcdCBpZihzZWdtZW50ID09IG51bGwpXHJcblx0XHRcdCB7XHJcblx0XHRcdFx0IHNlZ21lbnQgPVxyXG5cdFx0XHRcdCB7XHJcblx0XHRcdFx0XHQgcG9pbnRzICA6IFtkcmF3aW5nUG9pbnRzW2ldXSxcclxuXHRcdFx0XHRcdCBub3JtYWxzIDogW2RyYXdpbmdQb2ludHNOb3JtYWxzW2ldXVxyXG5cdFx0XHRcdCB9XHJcblx0XHRcdCB9XHJcblx0XHRcdCBzZWdtZW50LnBvaW50cy5wdXNoKGRyYXdpbmdQb2ludHNbaSsxXSk7XHJcblx0XHRcdCBzZWdtZW50Lm5vcm1hbHMucHVzaChkcmF3aW5nUG9pbnRzTm9ybWFsc1tpKzFdKTtcclxuXHRcdCB9XHJcblx0fVxyXG5cclxuXHRpZihzZWdtZW50ICE9IG51bGwpXHJcblx0e1xyXG5cdFx0c2VnbWVudHMucHVzaChzZWdtZW50KTtcclxuXHR9XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBzZWdtZW50cy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRpZihzZWdtZW50c1tpXS5ub3JtYWxzLmxlbmd0aCA+IDIpXHJcblx0XHR7XHJcblx0XHRcdHNlZ21lbnRzW2ldLm5vcm1hbHNbMF0gPSBzZWdtZW50c1tpXS5ub3JtYWxzWzFdO1xyXG5cdFx0XHRzZWdtZW50c1tpXS5ub3JtYWxzW3NlZ21lbnRzW2ldLm5vcm1hbHMubGVuZ3RoLTFdID0gc2VnbWVudHNbaV0ubm9ybWFsc1tzZWdtZW50c1tpXS5ub3JtYWxzLmxlbmd0aC0yXTtcclxuXHRcdFx0Ly8gc2VnbWVudHNbaV0ubm9ybWFsc1swXSA9IHt4OjAsIHk6MX07XHJcblx0XHRcdC8vIHNlZ21lbnRzW2ldLm5vcm1hbHNbc2VnbWVudHNbaV0ubm9ybWFscy5sZW5ndGgtMV0gPSB7eDowLCB5OjF9O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHNlZ21lbnRzO1xyXG59XHJcblxyXG4iLCJ2YXIgQ29tbW9uICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBMZXZlbCAgICAgID0gcmVxdWlyZShcIi4uL2VkaXRvci9MZXZlbFwiKTtcclxudmFyIExldmVsTGF5ZXIgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0xldmVsTGF5ZXJcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gRWRpdG9yKClcclxue1xyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcblx0dGhpcy5hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblxyXG5cdC8vIExldmVsIGxpc3RcclxuXHR0aGlzLmxldmVscyA9IFtdO1xyXG5cdHRoaXMubGV2ZWwgID0gbnVsbDtcclxuXHJcblx0Ly8gR3JpZFxyXG5cdHRoaXMuc25hcEdyaWQgPSAxNjtcclxuXHR0aGlzLmdyaWQgICAgID0gbnVsbDtcclxuXHJcblx0Ly8gUGFubmluZ1xyXG5cdHRoaXMuY21iID0gZmFsc2U7XHJcblx0dGhpcy5wYW5Nb3VzZVBvc2l0aW9uID0gbnVsbDtcclxuXHJcblx0Ly8gQ29uZmlnXHJcblx0dGhpcy5jb25maWcgPSB0aGlzLmFzc2V0TWFuYWdlci5nZXRKU09OKFwiZWRpdG9yQ29uZmlnXCIpO1xyXG5cdHZhciBzaWRlID0gMzM7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbmZpZy5vYmplY3RzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy5vYmplY3RzW2ldLnRleHR1cmUpKTtcclxuXHRcdHZhciBzY2FsZSAgPSBNYXRoLm1pbigxLyhzcHJpdGUud2lkdGgvc2lkZSksIDEvKHNwcml0ZS5oZWlnaHQvc2lkZSkpO1xyXG5cclxuXHRcdHZhciB0ZXh0dXJlID0gbmV3IFBJWEkuUmVuZGVyVGV4dHVyZShDb21tb24ucmVuZGVyZXIsIHNpZGUsIHNpZGUpO1xyXG5cclxuXHRcdFx0dmFyIG1hdHJpeCA9IG5ldyBQSVhJLk1hdHJpeCgpO1xyXG5cdFx0XHRtYXRyaXgudHJhbnNsYXRlKHNwcml0ZS53aWR0aCA8IHNwcml0ZS5oZWlnaHQgPyAoc3ByaXRlLmhlaWdodCAtIHNwcml0ZS53aWR0aCkvMiA6IDEsIHNwcml0ZS5oZWlnaHQgPCBzcHJpdGUud2lkdGggPyAoc3ByaXRlLndpZHRoIC0gc3ByaXRlLmhlaWdodCkvMiA6IDEpO1xyXG5cdFx0XHRtYXRyaXguc2NhbGUoc2NhbGUsIHNjYWxlKTtcclxuXHRcdFx0dGV4dHVyZS5yZW5kZXIoc3ByaXRlLCBtYXRyaXgpO1xyXG5cclxuXHRcdHRoaXMuY29uZmlnLm9iamVjdHNbaV0udGV4dHVyZUJhc2U2NCA9IHRleHR1cmUuZ2V0QmFzZTY0KCk7XHJcblx0fVxyXG5cclxuXHQvLyBIaXN0b3J5XHJcblx0dGhpcy5oaXN0b3J5ICAgID0gW107XHJcblx0dGhpcy5oaXN0b3J5SW5kZXggPSAwO1xyXG5cclxuXHQvLyBUZXN0XHJcblx0dGhpcy5jaGFyYWN0ZXIgPSBcImFubmFcIjtcclxuXHJcblx0Ly8gR3VpXHJcblx0dGhpcy5ndWkgPVxyXG5cdHtcclxuXHRcdHNlbGVjdG9yICAgICAgIDogXCIjY29udHJvbHNcIixcclxuXHRcdGxldmVsVGVtcGxhdGUgIDogXy50ZW1wbGF0ZSgkKFwiI3RlbXBsYXRlLWxldmVsXCIpLmh0bWwoKSwgIHt2YXJpYWJsZTogJ2VkaXRvcid9KSxcclxuXHRcdGxheWVyVGVtcGxhdGUgIDogXy50ZW1wbGF0ZSgkKFwiI3RlbXBsYXRlLWxheWVyXCIpLmh0bWwoKSwgIHt2YXJpYWJsZTogJ2VkaXRvcid9KSxcclxuXHRcdHBhdGhUZW1wbGF0ZSAgIDogXy50ZW1wbGF0ZSgkKFwiI3RlbXBsYXRlLXBhdGhcIikuaHRtbCgpLCAgIHt2YXJpYWJsZTogJ2VkaXRvcid9KSxcclxuXHRcdG9iamVjdFRlbXBsYXRlIDogXy50ZW1wbGF0ZSgkKFwiI3RlbXBsYXRlLW9iamVjdFwiKS5odG1sKCksIHt2YXJpYWJsZTogJ2VkaXRvcid9KVxyXG5cdH1cclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvcjtcclxuRWRpdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuRWRpdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEVkaXRvcjtcclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5FZGl0b3IucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnJlbmRlckdyaWQoKTtcclxuXHJcblx0dGhpcy5uZXdMZXZlbCgpO1xyXG5cclxuXHQvLyBab29tXHJcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNld2hlZWxcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHRpZigkKCcjY2FudmFzOmhvdmVyJykubGVuZ3RoICE9IDApXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuem9vbURlbHRhKC0wLjA1ICogTWF0aC5zaWduKGUud2hlZWxEZWx0YSkpO1xyXG5cdFx0fVxyXG5cdH0uYmluZCh0aGlzKSwgZmFsc2UpO1xyXG5cclxuXHQvLyBTYXZlL0xvYWRcclxuXHQkKFwiYm9keVwiKS5vbihcImNsaWNrXCIsIFwiLmxldmVsX25ld1wiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubmV3TGV2ZWwoKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNsaWNrXCIsIFwiLmxldmVsX2V4cG9ydFwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMuZXhwb3J0KCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjbGlja1wiLCBcIi5sZXZlbF9pbXBvcnRcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxvYWQoJChcInRleHRhcmVhW25hbWU9bGV2ZWxfaW1wb3J0X3RleHRdXCIpLnZhbCgpKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQvLyAkKFwiI2xldmVsX2ltcG9ydFwiKS5vbihcImNoYW5nZVwiLCBmdW5jdGlvbihlKVxyXG5cdC8vIHtcclxuXHRcdC8vIHZhciBsb2NhdGlvbiA9ICQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHJlYWRUZXh0RmlsZShsb2NhdGlvbikpO1xyXG5cdC8vIH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdC8vIEV4cG9ydCBpbWFnZVxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2xpY2tcIiwgXCIubGV2ZWxfaW1hZ2VcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR2YXIgYmFzZTY0ID0gdGhpcy5sZXZlbC50b0ltYWdlKCk7XHJcblx0XHRpZighIWJhc2U2NClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHdpbiA9IHdpbmRvdy5vcGVuKGJhc2U2NCwgJ2xldmVsX2ltYWdlJyk7XHJcblx0XHRcdHdpbi5mb2N1cygpO1xyXG5cdFx0fVxyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdC8vIExldmVsIGRlYnVnXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2VcIiwgXCJzZWxlY3RbbmFtZT1sZXZlbF9jaGFyYWN0ZXJdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5jaGFyYWN0ZXIgPSAkKGUuY3VycmVudFRhcmdldCkudmFsKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjbGlja1wiLCBcIi5sZXZlbF9kZWJ1Z1wiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyRGVidWcgPSB0aGlzLmNoYXJhY3RlcjtcclxuXHRcdENvbW1vbi5zYXZlZERhdGEubGV2ZWxEZWJ1ZyA9IEpTT04uc3RyaW5naWZ5KHRoaXMubGV2ZWwuZXhwb3J0KCkpO1xyXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XHJcblxyXG5cdFx0dmFyIHdpbiA9IHdpbmRvdy5vcGVuKFwiaW5kZXguaHRtbFwiLCAnbGV2ZWxfZGVidWcnKTtcclxuXHRcdHdpbi5mb2N1cygpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdC8vIExldmVsXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2VcIiwgXCJpbnB1dFtuYW1lPWxldmVsX25hbWVdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5zZXROYW1lKCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSk7XHJcblx0XHQkKFwidGV4dGFyZWFbbmFtZT1sZXZlbF9pbXBvcnRfdGV4dF1cIikudmFsKEpTT04uc3RyaW5naWZ5KHRoaXMubGV2ZWwuZXhwb3J0KCkpKTtcclxuXHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjbGlja1wiLCBcIi5uZXdfbGF5ZXJcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLm5ld0xheWVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjbGlja1wiLCBcIi5lZGl0X2xheWVyXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dmFyIGluZGV4ID0gcGFyc2VJbnQoJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoXCJkYXRhLWluZGV4XCIpKTtcclxuXHRcdHRoaXMubGV2ZWwuc2VsZWN0TGF5ZXIodGhpcy5sZXZlbC5nZXRMYXllckF0SW5kZXgoaW5kZXgpKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNsaWNrXCIsIFwiLmJhY2tcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmJhY2soKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHJcblx0Ly8gTGF5ZXJcclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZVwiLCBcImlucHV0W25hbWU9bGF5ZXJfbmFtZV1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNldE5hbWUoJChlLmN1cnJlbnRUYXJnZXQpLnZhbCgpKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNsaWNrXCIsIFwiLmRlbGV0ZV9sYXllclwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwuZGVsZXRlTGF5ZXIodGhpcy5sZXZlbC5sYXllcik7XHJcblx0XHR0aGlzLmJhY2soKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZVwiLCBcImlucHV0W25hbWU9bGF5ZXJfZGVwdGhdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZXREZXB0aChwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpKTtcclxuXHRcdHRoaXMucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjbGlja1wiLCBcIi5vYmplY3RzIGxpOm5vdCguc2VsZWN0ZWQpXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0JChcIi5vYmplY3RzIGxpLnNlbGVjdGVkXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XHJcblx0XHQvLyB0aGlzLmxldmVsLmxheWVyLmlkT2JqZWN0ID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoXCJkYXRhLWlkXCIpO1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZXRJZE9iamVjdCgkKGUuY3VycmVudFRhcmdldCkuYXR0cihcImRhdGEtaWRcIikpO1xyXG5cdFx0JChlLmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0Ly8gUGF0aFxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlXCIsIFwic2VsZWN0W25hbWU9cGF0aF9vcGVuXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwiY2xvc2VkXCIsICFwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2xpY2tcIiwgXCIuZGVsZXRlX3BhdGhcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLmRlbGV0ZVBhdGgodGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZCk7XHJcblx0XHR0aGlzLmJhY2soKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZVwiLCBcImlucHV0W25hbWU9cGF0aF9kZXB0aF0sIGlucHV0W25hbWU9b2JqZWN0X2RlcHRoXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2V0U2VsZWN0ZWREZXB0aChwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpKTtcclxuXHRcdHRoaXMucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2VcIiwgXCJzZWxlY3RbbmFtZT1wYXRoX2NvbGxpc2lvbnNdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5zZXRDb25maWcoXCJjb2xsaXNpb25zXCIsIHBhcnNlSW50KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZSBpbnB1dFwiLCBcImlucHV0W25hbWU9cGF0aF90ZXh0dXJlX3dhbGxzX2FuZ2xlXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwidGV4V2FsbEFuZ2xlXCIsIHBhcnNlSW50KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2UgaW5wdXRcIiwgXCJpbnB1dFtuYW1lPXBhdGhfdGV4dHVyZV9maWxsX3NpemVdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5zZXRDb25maWcoXCJ0ZXhGaWxsU2l6ZVwiLCBwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlIGlucHV0XCIsIFwiaW5wdXRbbmFtZT1wYXRoX3RleHR1cmVfZmlsbF9wYWRkaW5nXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwidGV4RmlsbFBhZGRpbmdcIiwgcGFyc2VJbnQoJChlLmN1cnJlbnRUYXJnZXQpLnZhbCgpKSwgZS50eXBlID09IFwiY2hhbmdlXCIpO1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5yZW5kZXIoKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZSBpbnB1dFwiLCBcImlucHV0W25hbWU9cGF0aF90ZXh0dXJlX2dyb3VuZF9zaXplXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwidGV4R3JvdW5kU2l6ZVwiLCBwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlIGlucHV0XCIsIFwiaW5wdXRbbmFtZT1wYXRoX3RleHR1cmVfZ3JvdW5kX2RlbHRhXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwidGV4R3JvdW5kRGVsdGFcIiwgcGFyc2VGbG9hdCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlIGlucHV0XCIsIFwiaW5wdXRbbmFtZT1wYXRoX3RleHR1cmVfd2FsbHNfc2l6ZV1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnNldENvbmZpZyhcInRleFdhbGxTaXplXCIsIHBhcnNlSW50KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2UgaW5wdXRcIiwgXCJpbnB1dFtuYW1lPXBhdGhfdGV4dHVyZV93YWxsc19kZWx0YV1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnNldENvbmZpZyhcInRleFdhbGxEZWx0YVwiLCBwYXJzZUZsb2F0KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2VcIiwgXCJzZWxlY3RbbmFtZT1wYXRoX3RleHR1cmVfZmlsbF1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnNldENvbmZpZyhcInRleEZpbGxcIiwgJChlLmN1cnJlbnRUYXJnZXQpLnZhbCgpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlXCIsIFwic2VsZWN0W25hbWU9cGF0aF90ZXh0dXJlX2dyb3VuZF1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnNldENvbmZpZyhcInRleEdyb3VuZFwiLCAkKGUuY3VycmVudFRhcmdldCkudmFsKCksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQucmVuZGVyKCk7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0JChcImJvZHlcIikub24oXCJjaGFuZ2VcIiwgXCJzZWxlY3RbbmFtZT1wYXRoX3RleHR1cmVfZ3JvdW5kX2VkZ2VdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5zZXRDb25maWcoXCJ0ZXhHcm91bmRFZGdlXCIsICQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSwgZS50eXBlID09IFwiY2hhbmdlXCIpO1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5yZW5kZXIoKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZVwiLCBcInNlbGVjdFtuYW1lPXBhdGhfdGV4dHVyZV9ncm91bmRfZWRnZV9zaWRlXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Q29uZmlnKFwidGV4R3JvdW5kRWRnZVNpZGVcIiwgJChlLmN1cnJlbnRUYXJnZXQpLnZhbCgpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnJlbmRlcigpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlXCIsIFwic2VsZWN0W25hbWU9cGF0aF90ZXh0dXJlX3dhbGxdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5zZXRDb25maWcoXCJ0ZXhXYWxsXCIsICQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSwgZS50eXBlID09IFwiY2hhbmdlXCIpO1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5yZW5kZXIoKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZSBpbnB1dFwiLCBcInRleHRhcmVhW25hbWU9cGF0aF9kYXRhXSwgdGV4dGFyZWFbbmFtZT1vYmplY3RfZGF0YV1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkLnNldENvbmZpZyhcImRhdGFcIiwgJChlLmN1cnJlbnRUYXJnZXQpLnZhbCgpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0XHQvLyBpZihlLnR5cGUgPT0gXCJjaGFuZ2VcIilcclxuXHRcdFx0Ly8gdGhpcy5yZW5kZXIoKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQvLyBPYmplY3RcclxuXHQkKFwiYm9keVwiKS5vbihcImNsaWNrXCIsIFwiLmRlbGV0ZV9vYmplY3RcIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyLmRlbGV0ZU9iamVjdCh0aGlzLmxldmVsLmxheWVyLnNlbGVjdGVkKTtcclxuXHRcdHRoaXMuYmFjaygpO1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlIGlucHV0XCIsIFwiaW5wdXRbbmFtZT1vYmplY3Rfc2NhbGVdXCIsIGZ1bmN0aW9uKGUpXHJcblx0e1xyXG5cdFx0dGhpcy5sZXZlbC5sYXllci5zZWxlY3RlZC5zZXRTY2FsZShwYXJzZUZsb2F0KCQoZS5jdXJyZW50VGFyZ2V0KS52YWwoKSksIGUudHlwZSA9PSBcImNoYW5nZVwiKTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuXHQkKFwiYm9keVwiKS5vbihcImNoYW5nZSBpbnB1dFwiLCBcImlucHV0W25hbWU9b2JqZWN0X3JvdGF0aW9uXVwiLCBmdW5jdGlvbihlKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIuc2VsZWN0ZWQuc2V0Um90YXRpb24ocGFyc2VGbG9hdCgkKGUuY3VycmVudFRhcmdldCkudmFsKCkpLCBlLnR5cGUgPT0gXCJjaGFuZ2VcIik7XHJcblx0fS5iaW5kKHRoaXMpKTtcclxuXHJcblx0Ly8gTWFrZSByYW5nZSBpbnB1dCBsb3NlIGZvY3VzIGFmdGVyIGNoYW5nZVxyXG5cdCQoXCJib2R5XCIpLm9uKFwiY2hhbmdlXCIsIFwiaW5wdXRbdHlwZT1yYW5nZV1cIiwgZnVuY3Rpb24oZSlcclxuXHR7XHJcblx0XHQkKHRoaXMpLmJsdXIoKTtcclxuXHR9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gUGFuXHJcblx0aWYodGhpcy5tb3VzZS5jZW50ZXJQcmVzc2VkKVxyXG5cdHtcclxuXHRcdGlmKCF0aGlzLmNtYilcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5jbWIgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLnBhbk1vdXNlUG9zaXRpb24gPSBuZXcgUElYSS5Qb2ludCh0aGlzLm1vdXNlLnBvc2l0aW9uLngsIHRoaXMubW91c2UucG9zaXRpb24ueSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHRoaXMubGV2ZWwueCArPSAodGhpcy5tb3VzZS5wb3NpdGlvbi54IC0gdGhpcy5wYW5Nb3VzZVBvc2l0aW9uLngpICogICgxL3RoaXMuc2NhbGUueCk7XHJcblx0XHRcdHRoaXMubGV2ZWwueSArPSAodGhpcy5tb3VzZS5wb3NpdGlvbi55IC0gdGhpcy5wYW5Nb3VzZVBvc2l0aW9uLnkpICogICgxL3RoaXMuc2NhbGUueSk7XHJcblx0XHRcdHRoaXMucGFuTW91c2VQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KHRoaXMubW91c2UucG9zaXRpb24ueCwgdGhpcy5tb3VzZS5wb3NpdGlvbi55KTtcclxuXHJcblx0XHRcdHRoaXMudXBkYXRlR3JpZFBvc2l0aW9uKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5jbWIpXHJcblx0e1xyXG5cdFx0dGhpcy5jbWIgPSBmYWxzZTtcclxuXHR9XHJcblxyXG5cdC8vIExldmVsIHVwZGF0ZVxyXG5cdGlmKHRoaXMubGV2ZWwgIT0gbnVsbClcclxuXHR7XHJcblx0XHRpZihcclxuXHRcdFx0KENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0NUUkwpICYmIENvbW1vbi5rZXlib2FyZC5nZXRLZXlQcmVzc2VkKENvbW1vbi5rZXlib2FyZC5LRVlfWikgJiYgQ29tbW9uLmtleWJvYXJkLmdldEtleVByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9TSElGVCkpIHx8XHJcblx0XHRcdChDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0NUUkwpICYmIENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX1opICYmIENvbW1vbi5rZXlib2FyZC5nZXRLZXlQcmVzc2VkKENvbW1vbi5rZXlib2FyZC5LRVlfU0hJRlQpKSB8fFxyXG5cdFx0XHQoQ29tbW9uLmtleWJvYXJkLmdldEtleVByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9DVFJMKSAmJiBDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX1opICYmIENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX1NISUZUKSkpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuaGlzdG9yeVJlZG8oKTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYoXHJcblx0XHRcdChDb21tb24ua2V5Ym9hcmQuZ2V0S2V5SnVzdFByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9DVFJMKSAmJiBDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX1opKSB8fFxyXG5cdFx0XHQoQ29tbW9uLmtleWJvYXJkLmdldEtleVByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9DVFJMKSAmJiBDb21tb24ua2V5Ym9hcmQuZ2V0S2V5SnVzdFByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9aKSkpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuaGlzdG9yeVVuZG8oKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0dGhpcy5sZXZlbC51cGRhdGUoKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5FZGl0b3IucHJvdG90eXBlLnVwZGF0ZUdyaWRQb3NpdGlvbiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuZ3JpZC50aWxlUG9zaXRpb24gPSBuZXcgUElYSS5Qb2ludCh0aGlzLmxldmVsLnggJSB0aGlzLnNuYXBHcmlkLCB0aGlzLmxldmVsLnkgJSB0aGlzLnNuYXBHcmlkKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5sZXZlbCA9PSBudWxsKSByZXR1cm47XHJcblxyXG5cdHRoaXMubGV2ZWwucmVuZGVyKCk7XHJcblx0dGhpcy5sZXZlbC5yZW5kZXJHVUkoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUuZ2V0TW91c2VQb3NpdGlvbiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHJldHVybiBuZXcgUElYSS5Qb2ludFxyXG5cdChcclxuXHRcdENvbW1vbi5TVEFHRV9XSURUSC8yICArICgodGhpcy5tb3VzZS5wb3NpdGlvbi54IC0gQ29tbW9uLlNUQUdFX1dJRFRILzIpL3RoaXMuc2NhbGUueCkgIC0gdGhpcy5sZXZlbC54LFxyXG5cdFx0Q29tbW9uLlNUQUdFX0hFSUdIVC8yICsgKCh0aGlzLm1vdXNlLnBvc2l0aW9uLnkgLSBDb21tb24uU1RBR0VfSEVJR0hULzIpL3RoaXMuc2NhbGUueSkgLSB0aGlzLmxldmVsLnlcclxuXHQpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuRWRpdG9yLnByb3RvdHlwZS56b29tRGVsdGEgPSBmdW5jdGlvbihkZWx0YVpvb20pXHJcbntcclxuXHRpZih0aGlzLnNjYWxlLnggLSBkZWx0YVpvb20gPCAwLjAxKSByZXR1cm47XHJcblxyXG5cdHZhciBvbGRXaWR0aCA9IENvbW1vbi5TVEFHRV9XSURUSCAqIHRoaXMuc2NhbGUueDtcclxuXHR2YXIgb2xkSGVpZ2h0ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAqIHRoaXMuc2NhbGUueTtcclxuXHJcblx0dGhpcy5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KHRoaXMuc2NhbGUueCAtIGRlbHRhWm9vbSwgdGhpcy5zY2FsZS55IC0gZGVsdGFab29tKTtcclxuXHJcblx0dmFyIG5ld1dpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRIICogdGhpcy5zY2FsZS54O1xyXG5cdHZhciBuZXdIZWlnaHQgPSBDb21tb24uU1RBR0VfSEVJR0hUICogdGhpcy5zY2FsZS55O1xyXG5cclxuXHR0aGlzLnggKz0gKG9sZFdpZHRoIC0gbmV3V2lkdGgpIC8yO1xyXG5cdHRoaXMueSArPSAob2xkSGVpZ2h0IC0gbmV3SGVpZ2h0KSAvMjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUucmVuZGVyR1VJID0gZnVuY3Rpb24od2hhdClcclxue1xyXG5cdHN3aXRjaCh3aGF0KVxyXG5cdHtcclxuXHRcdGNhc2UgXCJsZXZlbFwiOlxyXG5cdFx0XHR2YXIgaHRtbCA9IHRoaXMuZ3VpLmxldmVsVGVtcGxhdGUodGhpcyk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImxheWVyXCI6XHJcblx0XHRcdHZhciBodG1sID0gdGhpcy5ndWkubGF5ZXJUZW1wbGF0ZSh0aGlzKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwicGF0aFwiOlxyXG5cdFx0XHR2YXIgaHRtbCA9IHRoaXMuZ3VpLnBhdGhUZW1wbGF0ZSh0aGlzKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwib2JqZWN0XCI6XHJcblx0XHRcdHZhciBodG1sID0gdGhpcy5ndWkub2JqZWN0VGVtcGxhdGUodGhpcyk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0Y29uc29sZS5lcnJvcihcIkdVSSBsZXZlbCBub3QgZm91bmRcIik7XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxuXHJcblx0JCh0aGlzLmd1aS5zZWxlY3RvcikuaHRtbChodG1sKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUuYmFjayA9IGZ1bmN0aW9uKHdoYXQpXHJcbntcclxuXHRpZighdGhpcy5sZXZlbCkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmxldmVsLmJhY2soKTtcclxuXHR0aGlzLnJlbmRlcigpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuRWRpdG9yLnByb3RvdHlwZS5yZW5kZXJHcmlkID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gQkdcclxuXHR2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcblx0Y2FudmFzLndpZHRoICA9IHRoaXMuc25hcEdyaWQ7XHJcblx0Y2FudmFzLmhlaWdodCA9IHRoaXMuc25hcEdyaWQ7XHJcblx0dmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG5cdGN0eC5iZWdpblBhdGgoKTtcclxuXHRjdHguc3Ryb2tlU3R5bGUgPSBcIiM2NjY2NjZcIjtcclxuXHRjdHgubGluZVdpZHRoID0gMTtcclxuXHRjdHgubW92ZVRvKDAsMCk7XHJcblx0Y3R4LmxpbmVUbygwLHRoaXMuc25hcEdyaWQpO1xyXG5cdGN0eC5saW5lVG8odGhpcy5zbmFwR3JpZCx0aGlzLnNuYXBHcmlkKTtcclxuXHRjdHguc3Ryb2tlKCk7XHJcblxyXG5cdHRoaXMuZ3JpZCAgID0gbmV3IFBJWEkuZXh0cmFzLlRpbGluZ1Nwcml0ZShQSVhJLlRleHR1cmUuZnJvbUNhbnZhcyhjYW52YXMpLCB0aGlzLnNuYXBHcmlkLCB0aGlzLnNuYXBHcmlkKTtcclxuXHR0aGlzLmdyaWQueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdHRoaXMuZ3JpZC55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVC8yO1xyXG5cdHRoaXMuZ3JpZC5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcblx0dGhpcy5ncmlkLndpZHRoICA9IENvbW1vbi5TVEFHRV9XSURUSCAqIDI7XHJcblx0dGhpcy5ncmlkLmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQgKiAyO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5ncmlkKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUubmV3TGV2ZWwgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLmxldmVsICE9IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLmxldmVsKTtcclxuXHR9XHJcblxyXG5cdHZhciBsZXZlbCA9IG5ldyBMZXZlbCh0aGlzKTtcclxuXHR0aGlzLmxldmVsID0gbGV2ZWw7XHJcblx0dGhpcy5sZXZlbC5pbml0KCk7XHJcblx0dGhpcy5sZXZlbHMucHVzaChsZXZlbCk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLmxldmVsKTtcclxuXHJcblx0dGhpcy5yZW5kZXIoKTtcclxuXHJcblx0Ly8gVXBkYXRlIHBhbk1vdXNlUG9zaXRpb25cclxuXHR0aGlzLnVwZGF0ZUdyaWRQb3NpdGlvbigpO1xyXG5cclxuXHQvLyBSZXNldCBoaXN0b3J5XHJcblx0dGhpcy5oaXN0b3J5UmVzZXQoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUuZ2V0T2JqZWN0ID0gZnVuY3Rpb24oaWQpXHJcbntcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5jb25maWcub2JqZWN0cy5sZW5ndGggOyBpKyspXHJcblx0e1xyXG5cdFx0aWYodGhpcy5jb25maWcub2JqZWN0c1tpXS5pZCA9PSBpZClcclxuXHRcdHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY29uZmlnLm9iamVjdHNbaV07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbi8vIEVkaXRvci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uKClcclxuLy8ge1xyXG5cdC8vIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkodGhpcy5sZXZlbC5leHBvcnQoKSk7XHJcblx0Ly8gcmV0dXJuIGpzb247XHJcbi8vIH1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5FZGl0b3IucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbihqc29uKVxyXG57XHJcblx0dmFyIHNhdmUgPSBKU09OLnBhcnNlKGpzb24pO1xyXG5cclxuXHR0aGlzLm5ld0xldmVsKCk7XHJcblx0dGhpcy5sZXZlbC5pbXBvcnQoc2F2ZSk7XHJcblx0dGhpcy5yZW5kZXIoKTtcclxufVxyXG5cclxuXHJcbi8vIGZ1bmN0aW9uIHJlYWRUZXh0RmlsZShmaWxlKVxyXG4vLyB7XHJcbiAgICAvLyB2YXIgcmF3RmlsZSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgLy8gcmF3RmlsZS5vcGVuKFwiR0VUXCIsIGZpbGUsIGZhbHNlKTtcclxuICAgIC8vIHJhd0ZpbGUub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKClcclxuICAgIC8vIHtcclxuICAgICAgICAvLyBpZihyYXdGaWxlLnJlYWR5U3RhdGUgPT09IDQpXHJcbiAgICAgICAgLy8ge1xyXG4gICAgICAgICAgICAvLyBpZihyYXdGaWxlLnN0YXR1cyA9PT0gMjAwIHx8IHJhd0ZpbGUuc3RhdHVzID09IDApXHJcbiAgICAgICAgICAgIC8vIHtcclxuICAgICAgICAgICAgICAgIC8vIHZhciBhbGxUZXh0ID0gcmF3RmlsZS5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgICAgICAvLyBhbGVydChhbGxUZXh0KTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIH1cclxuICAgIC8vIH1cclxuICAgIC8vIHJhd0ZpbGUuc2VuZChudWxsKTtcclxuLy8gfVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUuaW1wb3J0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0JChcIiNsZXZlbF9pbXBvcnRcIikucmVwbGFjZVdpdGgoJChcIiNsZXZlbF9pbXBvcnRcIikudmFsKCcnKS5jbG9uZSh0cnVlKSk7XHJcblx0JChcIiNsZXZlbF9pbXBvcnRcIikudHJpZ2dlcihcImNsaWNrXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuRWRpdG9yLnByb3RvdHlwZS5leHBvcnQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHRoaXMubGV2ZWwuZXhwb3J0KCkpO1xyXG5cdHZhciBmaWxlbmFtZSA9IHRoaXMubGV2ZWwubmFtZSArIFwiX1wiICsgTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyBcIi5qc29uXCI7XHJcblxyXG5cdHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG5cdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgJ2RhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04LCcgKyBlbmNvZGVVUklDb21wb25lbnQoanNvbikpO1xyXG5cdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVuYW1lKTtcclxuXHJcblx0ZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcblxyXG5cdGVsZW1lbnQuY2xpY2soKTtcclxuXHJcblx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkVkaXRvci5wcm90b3R5cGUuaGlzdG9yeVJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Y29uc29sZS5pbmZvKFwiUmVzZXR0aW5nIGhpc3RvcnlcIik7XHJcblx0dGhpcy5oaXN0b3J5ID0gW0pTT04uc3RyaW5naWZ5KHRoaXMubGV2ZWwuZXhwb3J0KCkpXTtcclxuXHR0aGlzLmhpc3RvcnlJbmRleCA9IDA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5FZGl0b3IucHJvdG90eXBlLmhpc3RvcnlBZGRTdGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBzdGF0ZSA9IEpTT04uc3RyaW5naWZ5KHRoaXMubGV2ZWwuZXhwb3J0KCkpO1xyXG5cclxuXHQvLyBSZW1vdmUgZnV0dXJlIGV4cG9ydHNcclxuXHRpZih0aGlzLmhpc3RvcnlJbmRleCA8IHRoaXMuaGlzdG9yeS5sZW5ndGggLTEpXHJcblx0e1xyXG5cdFx0dGhpcy5oaXN0b3J5LnNwbGljZSh0aGlzLmhpc3RvcnlJbmRleCsxLCAxMDAwMCk7XHJcblx0fVxyXG5cclxuXHRpZihzdGF0ZSAhPSB0aGlzLmhpc3RvcnlbdGhpcy5oaXN0b3J5Lmxlbmd0aC0xXSlcclxuXHR7XHJcblx0XHR0aGlzLmhpc3RvcnkucHVzaChzdGF0ZSk7XHJcblx0XHR0aGlzLmhpc3RvcnlJbmRleCsrO1xyXG5cclxuXHRcdGNvbnNvbGUuaW5mbyhcIkFkZCBzdGF0ZSAlaVwiLCB0aGlzLmhpc3RvcnlJbmRleCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuRWRpdG9yLnByb3RvdHlwZS5oaXN0b3J5VW5kbyA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaGlzdG9yeUluZGV4ID09IDApIHJldHVybjtcclxuXHJcblx0dGhpcy5oaXN0b3J5SW5kZXgtLTtcclxuXHJcblx0Y29uc29sZS5pbmZvKFwiVW5kbyBzdGF0ZSAlaVwiLCB0aGlzLmhpc3RvcnlJbmRleCk7XHJcblx0dGhpcy5oaXN0b3J5UmVzdG9yZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuRWRpdG9yLnByb3RvdHlwZS5oaXN0b3J5UmVkbyA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaGlzdG9yeUluZGV4ID09IHRoaXMuaGlzdG9yeS5sZW5ndGgtMSkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmhpc3RvcnlJbmRleCsrO1xyXG5cclxuXHRjb25zb2xlLmluZm8oXCJSZWRvIHN0YXRlICVpXCIsIHRoaXMuaGlzdG9yeUluZGV4KTtcclxuXHR0aGlzLmhpc3RvcnlSZXN0b3JlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5FZGl0b3IucHJvdG90eXBlLmhpc3RvcnlSZXN0b3JlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbC5yZXNldCgpO1xyXG5cdHRoaXMubGV2ZWwuaW1wb3J0KEpTT04ucGFyc2UodGhpcy5oaXN0b3J5W3RoaXMuaGlzdG9yeUluZGV4XSkpO1xyXG5cdHRoaXMucmVuZGVyKCk7XHJcbn0iLCJ2YXIgQ29tbW9uICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBMZXZlbExheWVyID0gcmVxdWlyZShcIi4uL2VkaXRvci9FZGl0b3JcIik7XHJcbnZhciBMZXZlbExheWVyID0gcmVxdWlyZShcIi4uL2VkaXRvci9MZXZlbExheWVyXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBMZXZlbChlZGl0b3IpXHJcbntcclxuXHR0aGlzLmVkaXRvciA9IGVkaXRvcjtcclxuXHR0aGlzLm5hbWUgICA9IFwiTmV3IGxldmVsXCI7XHJcblx0dGhpcy5sYXllcnMgPSBbXTtcclxuXHR0aGlzLmxheWVyICA9IG51bGw7XHJcblxyXG5cdHRoaXMubG1iID0gZmFsc2U7XHJcblx0dGhpcy5ybWIgPSBmYWxzZTtcclxuXHR0aGlzLmRyYWdNb3ZlbWVudCA9IG51bGw7XHJcblxyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBMZXZlbDtcclxuTGV2ZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQSVhJLkNvbnRhaW5lci5wcm90b3R5cGUpO1xyXG5MZXZlbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMZXZlbDtcclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIEZvY3VzXHJcblx0dGhpcy54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzQ7XHJcblx0dGhpcy55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVC8yXHJcblxyXG5cdHRoaXMuc3RhcnRpbmdQb2ludCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcblx0dGhpcy5zdGFydGluZ1BvaW50LmJlZ2luRmlsbCgweDAwZmYwMCk7XHJcblx0dGhpcy5zdGFydGluZ1BvaW50LmRyYXdDaXJjbGUoMCwgMCwgNSk7XHJcblx0dGhpcy5zdGFydGluZ1BvaW50LmVuZEZpbGwoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuc3RhcnRpbmdQb2ludCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRmb3IodmFyIGkgPSB0aGlzLmNoaWxkcmVuLmxlbmd0aC0xOyBpID49IDA7IGktLSlcclxuXHR7XHJcblx0XHR0aGlzLnJlbW92ZUNoaWxkKHRoaXMuY2hpbGRyZW5baV0pO1xyXG5cdH1cclxuXHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLnN0YXJ0aW5nUG9pbnQpO1xyXG5cclxuXHR0aGlzLmxheWVycyA9IFtdO1xyXG5cdHRoaXMubGF5ZXIgID0gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLmxheWVyICE9IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5sYXllci51cGRhdGUoKTtcclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdC8vIFJpZ2h0IENsaWNrOiBtb3ZlIGV2ZXJ5dGhpbmdcclxuXHRcdGlmKHRoaXMuZWRpdG9yLm1vdXNlLnJpZ2h0UHJlc3NlZClcclxuXHRcdHtcclxuXHRcdFx0dmFyIG1vdXNlUG9zaXRpb24gPSB0aGlzLmVkaXRvci5nZXRNb3VzZVBvc2l0aW9uKCk7XHJcblxyXG5cdFx0XHRpZighdGhpcy5ybWIpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLnJtYiA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIFJlc3RvcmUgdGhlIG9sZCBwb3NpdGlvbiB0byBtYWtlIGFuIGFjY3VyYXRlIHNuYXBwaW5nXHJcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGF5ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHRoaXMubGF5ZXJzW2ldLm1vdmVBbGwobmV3IFBJWEkuUG9pbnQoLXRoaXMuZHJhZ01vdmVtZW50LngsIC10aGlzLmRyYWdNb3ZlbWVudC55KSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBNb3ZlIHBhdGhzIGFuZCBvYmplY3RzIHRvIHRoZSBjbG9zZXN0IHNuYXAgcG9pbnRcclxuXHRcdFx0XHR2YXIgbW91c2VNb3ZlbWVudCA9IHRoaXMuZWRpdG9yLm1vdXNlLm1vdmVtZW50O1xyXG5cdFx0XHRcdG1vdXNlTW92ZW1lbnQubXVsdGlwbHkoMS90aGlzLmVkaXRvci5zY2FsZS54KTtcclxuXHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQueCArPSBtb3VzZU1vdmVtZW50Lng7XHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQueSArPSBtb3VzZU1vdmVtZW50Lnk7XHJcblxyXG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0aGlzLmxheWVyc1tpXS5tb3ZlQWxsKG5ldyBQSVhJLlBvaW50KHRoaXMuZHJhZ01vdmVtZW50LngsIHRoaXMuZHJhZ01vdmVtZW50LnkpKTtcclxuXHRcdFx0XHRcdHRoaXMubGF5ZXJzW2ldLnJlbmRlcigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZih0aGlzLnJtYilcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5ybWIgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5yZW5kZXJHVUkoKTtcclxuXHJcblx0XHRcdC8vIEFkZCBoaXN0b3J5IHN0YXRlXHJcblx0XHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpXHJcbntcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sYXllcnMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dGhpcy5sYXllcnNbaV0ucmVuZGVyKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLnJlbmRlckdVSSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCEhdGhpcy5sYXllcilcclxuXHRcdHRoaXMubGF5ZXIucmVuZGVyR1VJKCk7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5lZGl0b3IucmVuZGVyR1VJKFwibGV2ZWxcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuYmFjayA9IGZ1bmN0aW9uKHdoYXQpXHJcbntcclxuXHRpZighIXRoaXMubGF5ZXIpXHJcblx0e1xyXG5cdFx0dGhpcy5sYXllci5iYWNrKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLm5ld0xheWVyID0gZnVuY3Rpb24obmFtZSlcclxue1xyXG5cdHRoaXMubGF5ZXIgPSBuZXcgTGV2ZWxMYXllcih0aGlzLCBuYW1lKTtcclxuXHR0aGlzLmxheWVycy5wdXNoKHRoaXMubGF5ZXIpO1xyXG5cdHRoaXMubGF5ZXIuaW5pdCgpO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5sYXllcik7XHJcblx0dGhpcy5zZWxlY3RMYXllcih0aGlzLmxheWVyKTtcclxuXHJcblx0Ly8gSGlzdG9yeVxyXG5cdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmRlbGV0ZUxheWVyID0gZnVuY3Rpb24obGF5ZXIpXHJcbntcclxuXHR2YXIgaW5kZXggPSB0aGlzLmxheWVycy5pbmRleE9mKGxheWVyKTtcclxuXHRpZiAoaW5kZXggPiAtMSlcclxuXHR7XHJcblx0XHR0aGlzLnJlbW92ZUNoaWxkKHRoaXMubGF5ZXJzW2luZGV4XSk7XHJcblx0XHR0aGlzLmxheWVycy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuXHRcdC8vIEhpc3RvcnlcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5zZWxlY3RMYXllciA9IGZ1bmN0aW9uKGxheWVyKVxyXG57XHJcblx0dGhpcy5sYXllciA9IGxheWVyO1xyXG5cdHRoaXMucmVuZGVyKCk7XHJcblx0dGhpcy5yZW5kZXJHVUkoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5nZXRMYXllckF0SW5kZXggPSBmdW5jdGlvbihpbmRleClcclxue1xyXG5cdHJldHVybiAhIXRoaXMubGF5ZXJzW2luZGV4XSA/IHRoaXMubGF5ZXJzW2luZGV4XSA6IG51bGxcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5leHBvcnQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIgb3V0cHV0ID1cclxuXHR7XHJcblx0XHRuYW1lICAgOiB0aGlzLm5hbWUsXHJcblx0XHRsYXllcnMgOiBbXSxcclxuXHRcdGxlbmd0aCA6IHRoaXMuZ2V0TGVuZ3RoKClcclxuXHR9XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRvdXRwdXQubGF5ZXJzLnB1c2godGhpcy5sYXllcnNbaV0uZXhwb3J0KCkpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIG91dHB1dDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5nZXRMZW5ndGggPSBmdW5jdGlvbigpXHJcbntcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sYXllcnMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0Zm9yKHZhciBvID0gMDsgbyA8IHRoaXMubGF5ZXJzW2ldLm9iamVjdHMubGVuZ3RoOyBvKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMubGF5ZXJzW2ldLm9iamVjdHNbb10uY29uZmlnLmlkID09IFwibGV2ZWxfZW5kXCIpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRyZXR1cm4gIE1hdGgucm91bmQodGhpcy5sYXllcnNbaV0ub2JqZWN0c1tvXS54IC0gdGhpcy5sYXllcnNbaV0ub2JqZWN0c1tvXS53aWR0aCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIDA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuZ2V0Qm91bmRzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIHgwID0gMDtcclxuXHR2YXIgeDEgPSAwO1xyXG5cdHZhciB5MCA9IDA7XHJcblx0dmFyIHkxID0gMDtcclxuXHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRmb3IodmFyIG8gPSAwOyBvIDwgdGhpcy5sYXllcnNbaV0ucGF0aHMubGVuZ3RoOyBvKyspXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgcCA9IDA7IHAgPCB0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzLmxlbmd0aDsgcCsrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYodGhpcy5sYXllcnNbaV0ucGF0aHNbb10uYmV6aWVyLnBvaW50c1twXS54IDwgeDApICAgICAgeDAgPSB0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLng7XHJcblx0XHRcdFx0ZWxzZSBpZih0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLnggPiB4MSkgeDEgPSB0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLng7XHJcblx0XHRcdFx0aWYodGhpcy5sYXllcnNbaV0ucGF0aHNbb10uYmV6aWVyLnBvaW50c1twXS55IDwgeTApICAgICAgeTAgPSB0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLnk7XHJcblx0XHRcdFx0ZWxzZSBpZih0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLnkgPiB5MSkgeTEgPSB0aGlzLmxheWVyc1tpXS5wYXRoc1tvXS5iZXppZXIucG9pbnRzW3BdLnk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJldHVybiBbeDAsIHkwLCB4MSwgeTFdO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLnNldE5hbWUgID0gZnVuY3Rpb24obmFtZSlcclxue1xyXG5cdG5hbWUgPSAkLnRyaW0obmFtZSk7XHJcblx0aWYobmFtZSA9PSBcIlwiKSByZXR1cm47XHJcblxyXG5cdHRoaXMubmFtZSA9IG5hbWU7XHJcblxyXG5cdC8vIEFkZCBoaXN0b3J5IHN0YXRlXHJcblx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuaW1wb3J0ID0gZnVuY3Rpb24oc2F2ZSlcclxue1xyXG5cdHRoaXMubmFtZSA9IHNhdmUubmFtZTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHNhdmUubGF5ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBsYXllciA9IG5ldyBMZXZlbExheWVyKHRoaXMsIFwiXCIpO1xyXG5cdFx0bGF5ZXIuaW1wb3J0KHNhdmUubGF5ZXJzW2ldKTtcclxuXHRcdHRoaXMubGF5ZXJzLnB1c2gobGF5ZXIpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZChsYXllcik7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLnRvSW1hZ2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIgYm91bmRzID0gdGhpcy5nZXRCb3VuZHMoKTtcclxuXHRpZihib3VuZHNbMl0gPT0gYm91bmRzWzBdKSByZXR1cm47XHJcblxyXG5cdC8vIEFkZCBzb21lIHBhZGRpbmdcclxuXHRib3VuZHNbMF0gLT0gMTI4O1xyXG5cdGJvdW5kc1sxXSAtPSAyNTY7XHJcblx0Ym91bmRzWzJdICs9IDEyODtcclxuXHRib3VuZHNbM10gKz0gMjU2O1xyXG5cclxuXHR2YXIgd2lkdGggID0gYm91bmRzWzJdLWJvdW5kc1swXTtcclxuXHR2YXIgaGVpZ2h0ID0gYm91bmRzWzNdLWJvdW5kc1sxXTtcclxuXHJcblx0Ly8gU2V0IHRoZSBzY2FsZSBzbyBpdCBkb2Vzbid0IGV4Y2VlZCBhIGNlcnRhaW4gd2lkdGhcclxuXHR2YXIgc2NhbGUgPSBNYXRoLm1pbigwLjUsIDgwMDAvd2lkdGgpO1xyXG5cclxuXHQvLyBSZW5kZXJcclxuXHR2YXIgcmVuZGVyVGV4dHVyZSA9IG5ldyBQSVhJLlJlbmRlclRleHR1cmUoQ29tbW9uLnJlbmRlcmVyLCB3aWR0aCpzY2FsZSwgaGVpZ2h0KnNjYWxlKTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGF5ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHRoaXMubGF5ZXJzW2ldLm1vdmVBbGwobmV3IFBJWEkuUG9pbnQoLWJvdW5kc1swXSwgLWJvdW5kc1sxXSkpO1xyXG5cdFx0dGhpcy5sYXllcnNbaV0uc2NhbGUuc2V0KHNjYWxlKVxyXG5cdFx0dGhpcy5sYXllcnNbaV0ucmVuZGVyKCk7XHJcblx0fVxyXG5cclxuXHRyZW5kZXJUZXh0dXJlLnJlbmRlcih0aGlzKTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGF5ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHRoaXMubGF5ZXJzW2ldLm1vdmVBbGwobmV3IFBJWEkuUG9pbnQoYm91bmRzWzBdLCBib3VuZHNbMV0pKTtcclxuXHRcdHRoaXMubGF5ZXJzW2ldLnNjYWxlLnNldCgxKVxyXG5cdFx0dGhpcy5sYXllcnNbaV0ucmVuZGVyKCk7XHJcblx0fVxyXG5cclxuXHQvLyBSZXR1cm4gYSBiYXNlNjQgc3RyaW5nIG9mIHRoZSB0ZXh0dXJlXHJcblx0dmFyIGltZyA9IHJlbmRlclRleHR1cmUuZ2V0QmFzZTY0KCk7XHJcblx0cmV0dXJuIGltZztcclxufSIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBFZGl0b3IgICAgICA9IHJlcXVpcmUoXCIuLi9lZGl0b3IvRWRpdG9yXCIpO1xyXG52YXIgTGV2ZWwgICAgICAgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0xldmVsXCIpO1xyXG52YXIgTGV2ZWxQYXRoICAgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0xldmVsUGF0aFwiKTtcclxudmFyIExldmVsT2JqZWN0ID0gcmVxdWlyZShcIi4uL2VkaXRvci9MZXZlbE9iamVjdFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBMZXZlbExheWVyKGxldmVsLCBuYW1lKVxyXG57XHJcblx0dGhpcy5lZGl0b3IgID0gbGV2ZWwuZWRpdG9yO1xyXG5cdHRoaXMubGV2ZWwgICA9IGxldmVsO1xyXG5cdHRoaXMubmFtZSAgICA9ICEhbmFtZSA/IG5hbWUgOiBcIk5ldyBsYXllciAjXCIgKyAodGhpcy5sZXZlbC5sYXllcnMubGVuZ3RoKzEpO1xyXG5cdHRoaXMucGF0aHMgICA9IFtdO1xyXG5cdHRoaXMub2JqZWN0cyA9IFtdO1xyXG5cdHRoaXMuZGVwdGggICA9IDA7XHJcblxyXG5cdHRoaXMuaWRPYmplY3QgPSBcIlwiO1xyXG5cdHRoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHR0aGlzLmxtYiA9IGZhbHNlO1xyXG5cdHRoaXMucm1iID0gZmFsc2U7XHJcblx0dGhpcy5kcmFnTW92ZW1lbnQgPSBudWxsO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gTGV2ZWxMYXllcjtcclxuTGV2ZWxMYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTGV2ZWxMYXllcjtcclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLnNlbGVjdGVkICE9IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zZWxlY3RlZC51cGRhdGUoKTtcclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdC8vIExlZnQgY2xpY2s6IHNlbGVjdCBwYXRoIG9yIG9iamVjdFxyXG5cdFx0aWYodGhpcy5lZGl0b3IubW91c2UubGVmdFByZXNzZWQpXHJcblx0XHR7XHJcblx0XHRcdHZhciBtb3VzZVBvc2l0aW9uID0gdGhpcy5lZGl0b3IuZ2V0TW91c2VQb3NpdGlvbigpO1xyXG5cclxuXHJcblx0XHRcdGlmKCF0aGlzLmxtYilcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMubG1iID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0dmFyIG9iaiA9IHRoaXMuZ2V0T2JqZWN0QXRQb2ludChtb3VzZVBvc2l0aW9uKTtcclxuXHJcblx0XHRcdFx0aWYob2JqICE9IG51bGwpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dGhpcy5zZWxlY3RPYmplY3Qob2JqKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBwYXRoID0gdGhpcy5nZXRQYXRoQXRQb2ludChtb3VzZVBvc2l0aW9uLCA1MCk7XHJcblxyXG5cdFx0XHRcdFx0aWYocGF0aCAhPSBudWxsKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHR0aGlzLnNlbGVjdE9iamVjdChwYXRoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0aWYodGhpcy5pZE9iamVjdCA9PSBcIlwiKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5uZXdQYXRoKG1vdXNlUG9zaXRpb24pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMubmV3T2JqZWN0KHRoaXMuaWRPYmplY3QsIG1vdXNlUG9zaXRpb24pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMubG1iKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmxtYiA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFJpZ2h0IENsaWNrOiBtb3ZlIGV2ZXJ5dGhpbmdcclxuXHRcdGlmKHRoaXMuZWRpdG9yLm1vdXNlLnJpZ2h0UHJlc3NlZClcclxuXHRcdHtcclxuXHRcdFx0dmFyIG1vdXNlUG9zaXRpb24gPSB0aGlzLmVkaXRvci5nZXRNb3VzZVBvc2l0aW9uKCk7XHJcblxyXG5cdFx0XHRpZighdGhpcy5ybWIpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLnJtYiA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIFJlc3RvcmUgdGhlIG9sZCBwb3NpdGlvbiB0byBtYWtlIGFuIGFjY3VyYXRlIHNuYXBwaW5nXHJcblx0XHRcdFx0dGhpcy5tb3ZlQWxsKG5ldyBQSVhJLlBvaW50KC10aGlzLmRyYWdNb3ZlbWVudC54LCAtdGhpcy5kcmFnTW92ZW1lbnQueSkpO1xyXG5cclxuXHRcdFx0XHQvLyBNb3ZlIHBhdGhzIGFuZCBvYmplY3RzIHRvIHRoZSBjbG9zZXN0IHNuYXAgcG9pbnRcclxuXHRcdFx0XHR2YXIgbW91c2VNb3ZlbWVudCA9IHRoaXMuZWRpdG9yLm1vdXNlLm1vdmVtZW50O1xyXG5cdFx0XHRcdG1vdXNlTW92ZW1lbnQubXVsdGlwbHkoMS90aGlzLmVkaXRvci5zY2FsZS54KTtcclxuXHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQueCArPSBtb3VzZU1vdmVtZW50Lng7XHJcblx0XHRcdFx0dGhpcy5kcmFnTW92ZW1lbnQueSArPSBtb3VzZU1vdmVtZW50Lnk7XHJcblxyXG5cdFx0XHRcdHRoaXMubW92ZUFsbChuZXcgUElYSS5Qb2ludCh0aGlzLmRyYWdNb3ZlbWVudC54LCB0aGlzLmRyYWdNb3ZlbWVudC55KSk7XHJcblxyXG5cdFx0XHRcdHRoaXMucmVuZGVyKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgaWYodGhpcy5ybWIpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMucm1iID0gZmFsc2U7XHJcblxyXG5cdFx0XHQvLyBBZGQgaGlzdG9yeSBzdGF0ZVxyXG5cdFx0XHR0aGlzLmVkaXRvci5oaXN0b3J5QWRkU3RhdGUoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHZhciBpbnB1dEZvY3VzID0gJChcImlucHV0OmZvY3VzLCB0ZXh0YXJlYTpmb2N1c1wiKS5sZW5ndGggPiAwO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gRmluZCB0aGUgbWluaW11bSBhbmQgbWF4aW11bSBkZXB0aCB2YWx1ZXNcclxuXHR2YXIgbWluRGVwdGggPSAwO1xyXG5cdHZhciBtYXhEZXB0aCA9IDA7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnBhdGhzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5wYXRoc1tpXSk7XHJcblx0XHRtaW5EZXB0aCA9IE1hdGgubWluKHRoaXMucGF0aHNbaV0uY29uZmlnLmRlcHRoLCBtaW5EZXB0aCk7XHJcblx0XHRtYXhEZXB0aCA9IE1hdGgubWF4KHRoaXMucGF0aHNbaV0uY29uZmlnLmRlcHRoLCBtYXhEZXB0aCk7XHJcblx0fVxyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5vYmplY3RzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5vYmplY3RzW2ldKTtcclxuXHRcdG1pbkRlcHRoID0gTWF0aC5taW4odGhpcy5vYmplY3RzW2ldLmNvbmZpZy5kZXB0aCwgbWluRGVwdGgpO1xyXG5cdFx0bWF4RGVwdGggPSBNYXRoLm1heCh0aGlzLm9iamVjdHNbaV0uY29uZmlnLmRlcHRoLCBtYXhEZXB0aCk7XHJcblx0fVxyXG5cclxuXHQvLyBSZW5kZXIgdGhlIG9iamVjdHMgYW5kIHBhdGhzIGluIG9yZGVyXHJcblx0Zm9yKHZhciBkZXB0aCA9IG1pbkRlcHRoOyBkZXB0aCA8PSBtYXhEZXB0aDsgZGVwdGgrKylcclxuXHR7XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXRocy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYodGhpcy5wYXRoc1tpXS5jb25maWcuZGVwdGggIT0gZGVwdGgpIGNvbnRpbnVlO1xyXG5cdFx0XHR0aGlzLmFkZENoaWxkKHRoaXMucGF0aHNbaV0pO1xyXG5cdFx0XHR0aGlzLnBhdGhzW2ldLnJlbmRlcigpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm9iamVjdHMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMub2JqZWN0c1tpXS5jb25maWcuZGVwdGggIT0gZGVwdGgpIGNvbnRpbnVlO1xyXG5cdFx0XHR0aGlzLmFkZENoaWxkKHRoaXMub2JqZWN0c1tpXSk7XHJcblx0XHRcdHRoaXMub2JqZWN0c1tpXS5yZW5kZXIoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIElmIHRoaXMgaXMgbm90IHRoZSBjdXJyZW50IGxheWVycywgZmFkZSBpdFxyXG5cdGlmKHRoaXMubGV2ZWwubGF5ZXIgIT0gbnVsbCAmJiB0aGlzLmxldmVsLmxheWVyICE9IHRoaXMpXHJcblx0XHR0aGlzLmFscGhhID0gMC41O1xyXG5cdGVsc2VcclxuXHRcdHRoaXMuYWxwaGEgPSAxO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUucmVuZGVyR1VJID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLnNlbGVjdGVkKVxyXG5cdFx0dGhpcy5zZWxlY3RlZC5yZW5kZXJHVUkoKTtcclxuXHRlbHNlXHJcblx0XHR0aGlzLmVkaXRvci5yZW5kZXJHVUkoXCJsYXllclwiKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmJhY2sgPSBmdW5jdGlvbih3aGF0KVxyXG57XHJcblx0aWYoISF0aGlzLnNlbGVjdGVkKVxyXG5cdFx0dGhpcy5zZWxlY3RlZC5iYWNrKCk7XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwubGF5ZXIgPSBudWxsO1xyXG5cdFx0dGhpcy5pZE9iamVjdCA9IFwiXCI7XHJcblxyXG5cdFx0Ly8gQWRkIGhpc3Rvcnkgc3RhdGVcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLnNldElkT2JqZWN0ID0gZnVuY3Rpb24oaWQpXHJcbntcclxuXHRpZih0aGlzLmxldmVsLmxheWVyLmlkT2JqZWN0ID09IGlkKSByZXR1cm47XHJcblxyXG5cdHRoaXMubGV2ZWwubGF5ZXIuaWRPYmplY3QgPSBpZDtcclxuXHJcblx0Ly8gQWRkIGhpc3Rvcnkgc3RhdGVcclxuXHR0aGlzLmVkaXRvci5oaXN0b3J5QWRkU3RhdGUoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLnNlbGVjdE9iamVjdCA9IGZ1bmN0aW9uKG9iailcclxue1xyXG5cdHRoaXMuc2VsZWN0ZWQgPSBvYmo7XHJcblx0dGhpcy5yZW5kZXIoKTtcclxuXHR0aGlzLnJlbmRlckdVSSgpO1xyXG5cclxuXHQvLyBBZGQgaGlzdG9yeSBzdGF0ZVxyXG5cdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUubmV3T2JqZWN0ID0gZnVuY3Rpb24oaWQsIHBvaW50KVxyXG57XHJcblx0dmFyIG9iakRCID0gdGhpcy5lZGl0b3IuZ2V0T2JqZWN0KGlkKTtcclxuXHRpZihvYmpEQiA9PSBudWxsKSByZXR1cm47XHJcblxyXG5cdC8vIENyZWF0ZSBuZXcgb2JqZWN0XHJcblx0dmFyIG9iaiA9IG5ldyBMZXZlbE9iamVjdCh0aGlzKTtcclxuXHRvYmouaW5pdChvYmpEQik7XHJcblx0b2JqLnggPSBwb2ludC54O1xyXG5cdG9iai55ID0gcG9pbnQueTtcclxuXHR0aGlzLm9iamVjdHMucHVzaChvYmopO1xyXG5cdHRoaXMuYWRkQ2hpbGQob2JqKTtcclxuXHJcblx0Ly8gU2VsZWN0IGl0XHJcblx0dGhpcy5zZWxlY3RPYmplY3Qob2JqKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLm5ld1BhdGggPSBmdW5jdGlvbihwb2ludClcclxue1xyXG5cdC8vIENyZWF0ZSBuZXcgcGF0aFxyXG5cdHZhciBwYXRoID0gbmV3IExldmVsUGF0aCh0aGlzKTtcclxuXHRwYXRoLmluaXQoKTtcclxuXHRwYXRoLmFkZFBvaW50KHBvaW50LngsIHBvaW50LnkpO1xyXG5cdHRoaXMucGF0aHMucHVzaChwYXRoKTtcclxuXHR0aGlzLmFkZENoaWxkKHBhdGgpO1xyXG5cclxuXHQvLyBTZWxlY3QgaXRcclxuXHR0aGlzLnNlbGVjdE9iamVjdChwYXRoKTtcclxuXHJcblx0Ly8gSGlzdG9yeVxyXG5cdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmRlbGV0ZU9iamVjdCA9IGZ1bmN0aW9uKG9iailcclxue1xyXG5cdHZhciBpbmRleCA9IHRoaXMub2JqZWN0cy5pbmRleE9mKG9iaik7XHJcblx0aWYgKGluZGV4ID4gLTEpXHJcblx0e1xyXG5cdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLm9iamVjdHNbaW5kZXhdKTtcclxuXHRcdHRoaXMub2JqZWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuXHRcdC8vIEhpc3RvcnlcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmRlbGV0ZVBhdGggPSBmdW5jdGlvbihwYXRoKVxyXG57XHJcblx0dmFyIGluZGV4ID0gdGhpcy5wYXRocy5pbmRleE9mKHBhdGgpO1xyXG5cdGlmIChpbmRleCA+IC0xKVxyXG5cdHtcclxuXHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5wYXRoc1tpbmRleF0pO1xyXG5cdFx0dGhpcy5wYXRocy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuXHRcdC8vIEhpc3RvcnlcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLm1vdmVBbGwgPSBmdW5jdGlvbih2KVxyXG57XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMucGF0aHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dGhpcy5wYXRoc1tpXS5tb3ZlXHJcblx0XHQoXHJcblx0XHRcdE1hdGgucm91bmQodi54L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkLFxyXG5cdFx0XHRNYXRoLnJvdW5kKHYueS90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZFxyXG5cdFx0KVxyXG5cdH1cclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMub2JqZWN0cy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLm9iamVjdHNbaV0ueCArPSBNYXRoLnJvdW5kKHYueC90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZDtcclxuXHRcdHRoaXMub2JqZWN0c1tpXS55ICs9IE1hdGgucm91bmQodi55L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5nZXRPYmplY3RBdFBvaW50ICA9IGZ1bmN0aW9uKHBvaW50KVxyXG57XHJcblx0dmFyIG9iaiA9IG51bGw7XHJcblxyXG5cdGZvcih2YXIgaSA9IHRoaXMub2JqZWN0cy5sZW5ndGgtMTsgaSA+PSAwOyBpLS0pXHJcblx0e1xyXG5cdFx0aWYodGhpcy5vYmplY3RzW2ldLmlzUG9pbnRJbnNpZGUocG9pbnQpICYmIChvYmogPT0gbnVsbCB8fCBvYmouZGVwdGggPCB0aGlzLm9iamVjdHNbaV0uZGVwdGgpKVxyXG5cdFx0e1xyXG5cdFx0XHRvYmogPSB0aGlzLm9iamVjdHNbaV07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gb2JqO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUuZ2V0UGF0aEF0UG9pbnQgID0gZnVuY3Rpb24ocG9pbnQsIG1heERpc3RhbmNlKVxyXG57XHJcblx0dmFyIHBhdGggICAgID0gbnVsbDtcclxuXHR2YXIgZGlzdGFuY2UgPSBudWxsO1xyXG5cclxuXHQvKlxyXG5cdGlmKHRoaXMud2lyZWZyYW1lKVxyXG5cdHtcclxuXHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy53aXJlZnJhbWUpO1xyXG5cdH1cclxuXHR0aGlzLndpcmVmcmFtZSA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLndpcmVmcmFtZSk7XHJcblx0Ki9cclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMucGF0aHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIHBvaW50cyA9IHRoaXMucGF0aHNbaV0uYmV6aWVyLmdldERyYXdpbmdQb2ludHMoKTtcclxuXHJcblx0XHRmb3IodmFyIHAgPSAwOyBwIDwgcG9pbnRzLmxlbmd0aC0xOyBwKyspXHJcblx0XHR7XHJcblx0XHRcdC8vIFNlZ21lbnQgb2YgdGhlIGJlemllciBjdXJ2ZVxyXG5cdFx0XHR2YXIgc2VnbWVudCA9IG5ldyBQSVhJLlBvaW50KHBvaW50c1twKzFdLnggLSBwb2ludHNbcF0ueCwgcG9pbnRzW3ArMV0ueSAtIHBvaW50c1twXS55KTtcclxuXHJcblx0XHRcdC8vIE5vcm1hbGl6ZWQgc2VnbWVudFxyXG5cdFx0XHR2YXIgc2VnbWVudE5vcm1hbGl6ZWQgPSBuZXcgUElYSS5Qb2ludChzZWdtZW50LngsIHNlZ21lbnQueSk7XHJcblx0XHRcdHNlZ21lbnROb3JtYWxpemVkLm5vcm1hbGl6ZSgpO1xyXG5cclxuXHRcdFx0Ly8gTW91c2UgdmVjdG9yLCBzdGFydHMgZnJvbSB0aGUgZmlyc3QgcG9pbnQgb2YgdGhlIHNlZ21lbnRcclxuXHRcdFx0dmFyIHZNb3VzZSA9IG5ldyBQSVhJLlBvaW50KHBvaW50LnggLSBwb2ludHNbcF0ueCwgcG9pbnQueSAtIHBvaW50c1twXS55KTtcclxuXHJcblx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgcHJvamVjdGlvbiBvZiB2TW91c2Ugb250byB0aGUgc2VnbWVudFxyXG5cdFx0XHR2YXIgdlByb2pMZW5ndGggPSB2TW91c2UuZG90UHJvZHVjdChzZWdtZW50KSAvIHNlZ21lbnQuZ2V0TGVuZ3RoKCk7XHJcblx0XHRcdHZhciB2UHJvaiAgICAgICA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnROb3JtYWxpemVkLnggKiB2UHJvakxlbmd0aCwgc2VnbWVudE5vcm1hbGl6ZWQueSAqIHZQcm9qTGVuZ3RoKTtcclxuXHJcblx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgZGlzdGFuY2VcclxuXHRcdFx0aWYoKCh2UHJvai54L3NlZ21lbnQueCA8IDAgfHwgdlByb2oueC9zZWdtZW50LnggPiAxKSAmJiAodlByb2oueCAhPSBzZWdtZW50LngpKSB8fCAodlByb2oueS9zZWdtZW50LnkgPCAwIHx8IHZQcm9qLnkvc2VnbWVudC55ID4gMSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBJZiB0aGUgcHJvamVjdGlvbiBkb2Vucyd0IGVuZCBvbiB0aGUgc2VnbWVudCB2ZWN0b3IsIGNhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgc2VnbWVudCdzIGVuZHNcclxuXHRcdFx0XHR2YXIgdjEgPSBuZXcgUElYSS5Qb2ludChwb2ludC54IC0gcG9pbnRzW3BdLngsICAgcG9pbnQueSAtIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHR2YXIgdjIgPSBuZXcgUElYSS5Qb2ludChwb2ludC54IC0gcG9pbnRzW3ArMV0ueCwgcG9pbnQueSAtIHBvaW50c1twKzFdLnkpO1xyXG5cdFx0XHRcdHZhciBjdXJyZW50RGlzdGFuY2UgPSBNYXRoLm1pbih2MS5nZXRMZW5ndGgoKSwgdjIuZ2V0TGVuZ3RoKCkpO1xyXG5cclxuXHRcdFx0XHQvKlxyXG5cdFx0XHRcdHZhciBpbmRleCA9IHYxLmdldExlbmd0aCgpIDwgdjIuZ2V0TGVuZ3RoKCkgPyAwIDogMTtcclxuXHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMiwgMHgwMGZmMDAsIDEpO1xyXG5cdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyhwb2ludHNbcCtpbmRleF0ueCwgcG9pbnRzW3AraW5kZXhdLnkpO1xyXG5cdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh4LCB5KTtcclxuXHRcdFx0XHQqL1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIENhbGN1bGF0aW5nIHRoZSBwZXJwZW5kaWN1bGFyIG9mIHRoZSBzZWdtZW50IGVuZGluZyBvbiB0aGUgdGhlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dmFyIHBlcnAgID0gbmV3IFBJWEkuUG9pbnQodk1vdXNlLnggLSB2UHJvai54LCB2TW91c2UueSAtIHZQcm9qLnkpO1xyXG5cdFx0XHRcdHZhciBjdXJyZW50RGlzdGFuY2UgPSBwZXJwLmdldExlbmd0aCgpO1xyXG5cclxuXHRcdFx0XHQvKlxyXG5cdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgyLCAweDAwZmYwMCwgMSk7XHJcblx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHBvaW50c1twXS54ICsgdlByb2oueCwgcG9pbnRzW3BdLnkgKyB2UHJvai55KTtcclxuXHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzW3BdLnggKyB2UHJvai54ICsgcGVycC54LCBwb2ludHNbcF0ueSArIHZQcm9qLnkgKyBwZXJwLnkpO1xyXG5cdFx0XHRcdCovXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKChwYXRoID09IG51bGwgfHwgZGlzdGFuY2UgPiBjdXJyZW50RGlzdGFuY2UpICYmIChjdXJyZW50RGlzdGFuY2UgPCBtYXhEaXN0YW5jZSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRwYXRoID0gdGhpcy5wYXRoc1tpXTtcclxuXHRcdFx0XHRkaXN0YW5jZSA9IGN1cnJlbnREaXN0YW5jZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0LypcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDIsIDB4ZmYwMDAwLCAxKTtcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHBvaW50c1twXS54LCBwb2ludHNbcF0ueSk7XHJcblx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwb2ludHNbcCsxXS54LCBwb2ludHNbcCsxXS55KTtcclxuXHRcdFx0Ki9cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJldHVybiBwYXRoO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUuc2V0TmFtZSAgPSBmdW5jdGlvbihuYW1lKVxyXG57XHJcblx0bmFtZSA9ICQudHJpbShuYW1lKTtcclxuXHRpZihuYW1lID09IFwiXCIpIHJldHVybjtcclxuXHJcblx0dGhpcy5uYW1lID0gbmFtZTtcclxuXHJcblx0Ly8gQWRkIGhpc3Rvcnkgc3RhdGVcclxuXHR0aGlzLmVkaXRvci5oaXN0b3J5QWRkU3RhdGUoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLnNldERlcHRoICA9IGZ1bmN0aW9uKGRlcHRoKVxyXG57XHJcblx0dGhpcy5kZXB0aCA9IGRlcHRoO1xyXG5cclxuXHR0aGlzLmxldmVsLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24oYSwgYilcclxuXHR7XHJcblx0XHRpZihhLmRlcHRoIDwgYi5kZXB0aCkgcmV0dXJuIC0xO1xyXG5cdFx0aWYoYS5kZXB0aCA+IGIuZGVwdGgpIHJldHVybiAxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcblxyXG5cdHRoaXMubGV2ZWwubGF5ZXJzLnNvcnQoZnVuY3Rpb24oYSwgYilcclxuXHR7XHJcblx0XHRpZihhLmRlcHRoIDwgYi5kZXB0aCkgcmV0dXJuIC0xO1xyXG5cdFx0aWYoYS5kZXB0aCA+IGIuZGVwdGgpIHJldHVybiAxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcblxyXG5cdC8vIEFkZCBoaXN0b3J5IHN0YXRlXHJcblx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5zZXRTZWxlY3RlZERlcHRoICA9IGZ1bmN0aW9uKGRlcHRoKVxyXG57XHJcblx0aWYodGhpcy5zZWxlY3RlZCA9PSBudWxsKSByZXR1cm47XHJcblxyXG5cdHRoaXMuc2VsZWN0ZWQuY29uZmlnLmRlcHRoID0gZGVwdGg7XHJcblxyXG5cdHRoaXMuY2hpbGRyZW4uc29ydChmdW5jdGlvbihhLCBiKVxyXG5cdHtcclxuXHRcdGlmKGEuY29uZmlnLmRlcHRoIDwgYi5jb25maWcuZGVwdGgpIHJldHVybiAtMTtcclxuXHRcdGlmKGEuY29uZmlnLmRlcHRoID4gYi5jb25maWcuZGVwdGgpIHJldHVybiAxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcblxyXG5cdHRoaXMucGF0aHMuc29ydChmdW5jdGlvbihhLCBiKVxyXG5cdHtcclxuXHRcdGlmKGEuZGVwdGggPCBiLmRlcHRoKSByZXR1cm4gLTE7XHJcblx0XHRpZihhLmRlcHRoID4gYi5kZXB0aCkgcmV0dXJuIDE7XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9KTtcclxuXHJcblx0dGhpcy5vYmplY3RzLnNvcnQoZnVuY3Rpb24oYSwgYilcclxuXHR7XHJcblx0XHRpZihhLmRlcHRoIDwgYi5kZXB0aCkgcmV0dXJuIC0xO1xyXG5cdFx0aWYoYS5kZXB0aCA+IGIuZGVwdGgpIHJldHVybiAxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcblxyXG5cdC8vIEFkZCBoaXN0b3J5IHN0YXRlXHJcblx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5leHBvcnQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIgb3V0cHV0ID1cclxuXHR7XHJcblx0XHRuYW1lICAgICA6IHRoaXMubmFtZSxcclxuXHRcdGRlcHRoICAgIDogdGhpcy5kZXB0aCxcclxuXHRcdHBhdGhzICAgIDogW10sXHJcblx0XHRvYmplY3RzICA6IFtdLFxyXG5cdH1cclxuXHJcblx0aWYodGhpcy5sZXZlbC5sYXllciA9PSB0aGlzKVxyXG5cdHtcclxuXHRcdG91dHB1dC5zZWxlY3RlZCA9IHRydWU7XHJcblx0XHRvdXRwdXQuaWRPYmplY3QgPSB0aGlzLmlkT2JqZWN0O1xyXG5cdH1cclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMub2JqZWN0cy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRvdXRwdXQub2JqZWN0cy5wdXNoKHRoaXMub2JqZWN0c1tpXS5leHBvcnQoKSk7XHJcblx0fVxyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXRocy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRvdXRwdXQucGF0aHMucHVzaCh0aGlzLnBhdGhzW2ldLmV4cG9ydCgpKTtcclxuXHR9XHJcblxyXG5cdG91dHB1dC5vYmplY3RzLnNvcnQoZnVuY3Rpb24oYSwgYilcclxuXHR7XHJcblx0XHRpZihhLnggPCBiLngpIHJldHVybiAtMTtcclxuXHRcdGlmKGEueCA+IGIueCkgcmV0dXJuIDE7XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9KTtcclxuXHJcblx0b3V0cHV0LnBhdGhzLnNvcnQoZnVuY3Rpb24oYSwgYilcclxuXHR7XHJcblx0XHRpZihhLmJvdW5kc1swXSA8IGIuYm91bmRzWzBdKSByZXR1cm4gLTE7XHJcblx0XHRpZihhLmJvdW5kc1swXSA+IGIuYm91bmRzWzBdKSByZXR1cm4gMTtcclxuXHRcdHJldHVybiAwO1xyXG5cdH0pO1xyXG5cclxuXHRyZXR1cm4gb3V0cHV0O1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUuaW1wb3J0ID0gZnVuY3Rpb24oc2F2ZSlcclxue1xyXG5cdHRoaXMubmFtZSAgPSBzYXZlLm5hbWU7XHJcblx0dGhpcy5kZXB0aCA9IHNhdmUuZGVwdGg7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBzYXZlLm9iamVjdHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIG9iaiA9IG5ldyBMZXZlbE9iamVjdCh0aGlzKTtcclxuXHRcdG9iai5pbXBvcnQoc2F2ZS5vYmplY3RzW2ldKTtcclxuXHRcdHRoaXMub2JqZWN0cy5wdXNoKG9iaik7XHJcblx0fVxyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgc2F2ZS5wYXRocy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgcGF0aCA9IG5ldyBMZXZlbFBhdGgodGhpcyk7XHJcblx0XHRwYXRoLmltcG9ydChzYXZlLnBhdGhzW2ldKTtcclxuXHRcdHRoaXMucGF0aHMucHVzaChwYXRoKTtcclxuXHR9XHJcblxyXG5cdGlmKCEhc2F2ZS5zZWxlY3RlZClcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLmxheWVyID0gdGhpcztcclxuXHRcdHRoaXMuaWRPYmplY3QgPSBzYXZlLmlkT2JqZWN0O1xyXG5cdH1cclxufSIsInZhciBDb21tb24gICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEVkaXRvciAgICAgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0VkaXRvclwiKTtcclxudmFyIExldmVsICAgICAgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0xldmVsXCIpO1xyXG52YXIgTGV2ZWxMYXllciA9IHJlcXVpcmUoXCIuLi9lZGl0b3IvTGV2ZWxMYXllclwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBMZXZlbE9iamVjdChsYXllcilcclxue1xyXG5cdHRoaXMuZWRpdG9yID0gbGF5ZXIuZWRpdG9yO1xyXG5cdHRoaXMubGF5ZXIgID0gbGF5ZXI7XHJcblx0dGhpcy5hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblxyXG5cdHRoaXMuY29uZmlnID1cclxuXHR7XHJcblx0XHRpZCAgICAgICA6IFwiXCIsXHJcblx0XHR0ZXh0dXJlICA6IFwiXCIsXHJcblx0XHRhbmNob3IgICA6IHt4OjAuNSwgeTowLjV9LFxyXG5cdFx0c2NhbGUgICAgOiB7eDoxLCAgIHk6MX0sXHJcblx0XHRyb3RhdGlvbiA6IDAsXHJcblx0XHRkZXB0aCAgICA6IDAsXHJcblx0XHRkYXRhICAgICA6IFwiXCJcclxuXHR9XHJcblxyXG5cdHRoaXMuc3ByaXRlICAgICA9IG51bGw7XHJcblx0dGhpcy53aXJlZnJhbWUgID0gbnVsbDtcclxuXHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuXHR0aGlzLmxtYiAgICAgICAgPSBmYWxzZTtcclxuXHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IExldmVsT2JqZWN0O1xyXG5MZXZlbE9iamVjdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsT2JqZWN0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExldmVsT2JqZWN0O1xyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsT2JqZWN0LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24ob2JqREIpXHJcbntcclxuXHR0aGlzLmNvbmZpZy5pZCAgICAgID0gb2JqREIuaWQ7XHJcblx0dGhpcy5jb25maWcudGV4dHVyZSA9IG9iakRCLnRleHR1cmU7XHJcblx0dGhpcy5jb25maWcuYW5jaG9yICA9IG9iakRCLmFuY2hvcjtcclxuXHRpZighIW9iakRCLnNjYWxlKVxyXG5cdFx0dGhpcy5jb25maWcuc2NhbGUgPSB7eDpvYmpEQi5zY2FsZSwgeTpvYmpEQi5zY2FsZX07XHJcblx0aWYoISFvYmpEQi5kYXRhKVxyXG5cdFx0dGhpcy5jb25maWcuZGF0YSA9IG9iakRCLmRhdGE7XHJcblx0aWYoISFvYmpEQi5kZXB0aClcclxuXHRcdHRoaXMuY29uZmlnLmRlcHRoID0gb2JqREIuZGVwdGg7XHJcblxyXG5cdHRoaXMubG1iID0gdHJ1ZTtcclxuXHR0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIExlZnQgQ2xpY2tcclxuXHRpZih0aGlzLmVkaXRvci5tb3VzZS5sZWZ0UHJlc3NlZClcclxuXHR7XHJcblx0XHR2YXIgbW91c2VQb3NpdGlvbiA9IHRoaXMuZWRpdG9yLmdldE1vdXNlUG9zaXRpb24oKTtcclxuXHJcblx0XHRpZighdGhpcy5sbWIpXHJcblx0XHR7XHJcblx0XHRcdHZhciBtb3VzZVBvc2l0aW9uID0gdGhpcy5lZGl0b3IuZ2V0TW91c2VQb3NpdGlvbigpO1xyXG5cdFx0XHR2YXIgb2JqID0gdGhpcy5sYXllci5nZXRPYmplY3RBdFBvaW50KG1vdXNlUG9zaXRpb24pO1xyXG5cclxuXHRcdFx0aWYoIXRoaXMuaXNQb2ludEluc2lkZShtb3VzZVBvc2l0aW9uKSAmJiBvYmogIT0gdGhpcylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKG9iaiAhPSBudWxsKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBvYmogPSB0aGlzLmxheWVyLmdldE9iamVjdEF0UG9pbnQobW91c2VQb3NpdGlvbik7XHJcblx0XHRcdFx0XHRpZihvYmogIT0gbnVsbClcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0dGhpcy5sYXllci5zZWxlY3RPYmplY3Qob2JqKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dGhpcy5sYXllci5uZXdPYmplY3QodGhpcy5jb25maWcuaWQsIG1vdXNlUG9zaXRpb24pO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmxtYiA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMuaXNEcmFnZ2luZylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBtb3VzZU1vdmVtZW50ID0gdGhpcy5lZGl0b3IubW91c2UubW92ZW1lbnQ7XHJcblx0XHRcdFx0bW91c2VNb3ZlbWVudC5tdWx0aXBseSgxL3RoaXMuZWRpdG9yLnNjYWxlLngpO1xyXG5cclxuXHRcdFx0XHR0aGlzLnggKz0gbW91c2VNb3ZlbWVudC54O1xyXG5cdFx0XHRcdHRoaXMueSArPSBtb3VzZU1vdmVtZW50Lnk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmxtYilcclxuXHR7XHJcblx0XHQvLyBFbmQgZHJhZ2dpbmdcclxuXHRcdHRoaXMubG1iID0gZmFsc2U7XHJcblx0XHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuXHJcblx0XHQvLyBIaXN0b3J5XHJcblx0XHR0aGlzLmVkaXRvci5oaXN0b3J5QWRkU3RhdGUoKTtcclxuXHR9XHJcblxyXG5cdHZhciBpbnB1dEZvY3VzID0gJChcImlucHV0OmZvY3VzLCB0ZXh0YXJlYTpmb2N1c1wiKS5sZW5ndGggPiAwO1xyXG5cclxuXHQvLyBEZWxldGVcclxuXHRpZihDb21tb24ua2V5Ym9hcmQuZ2V0S2V5SnVzdFByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9DKSAmJiAhQ29tbW9uLmtleWJvYXJkLmdldEtleVByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9DVFJMKSAmJiAhaW5wdXRGb2N1cylcclxuXHR7XHJcblx0XHQkKFwiLmRlbGV0ZV9vYmplY3RcIikudHJpZ2dlcihcImNsaWNrXCIpO1xyXG5cdH1cclxuXHJcblx0Ly8gQmFja1xyXG5cdGlmKENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0IpICYmICFDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0NUUkwpICYmICFpbnB1dEZvY3VzKVxyXG5cdHtcclxuXHRcdCQoXCIuYmFja1wiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0fVxyXG5cclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbE9iamVjdC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cdHRoaXMuc2NhbGUgICAgPSBuZXcgUElYSS5Qb2ludCh0aGlzLmNvbmZpZy5zY2FsZS54LCB0aGlzLmNvbmZpZy5zY2FsZS55KTtcclxuXHJcblx0aWYodGhpcy5zcHJpdGUgIT0gbnVsbCkgICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLnNwcml0ZSk7XHJcblx0aWYodGhpcy53aXJlZnJhbWUgIT0gbnVsbCkgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLndpcmVmcmFtZSk7XHJcblxyXG5cdHRoaXMuc3ByaXRlICAgICAgICAgID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4dHVyZSkpO1xyXG5cdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQodGhpcy5jb25maWcuYW5jaG9yLngsIHRoaXMuY29uZmlnLmFuY2hvci55KTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuc3ByaXRlKTtcclxuXHJcblx0dGhpcy53aXJlZnJhbWUgPSBuZXcgUElYSS5HcmFwaGljcygpO1xyXG5cdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgxLCAweGZmMDAwMCwgMSk7XHJcblx0dGhpcy53aXJlZnJhbWUubW92ZVRvKC0gdGhpcy5zcHJpdGUuYW5jaG9yLnggKiB0aGlzLnNwcml0ZS53aWR0aCwgICAgIC0gdGhpcy5zcHJpdGUuYW5jaG9yLnkgKiB0aGlzLnNwcml0ZS5oZWlnaHQpOyAgICAgLy8gVG9wIGxlZnRcclxuXHR0aGlzLndpcmVmcmFtZS5saW5lVG8oKyAoMS10aGlzLnNwcml0ZS5hbmNob3IueCkgKiB0aGlzLnNwcml0ZS53aWR0aCwgLSB0aGlzLnNwcml0ZS5hbmNob3IueSAqIHRoaXMuc3ByaXRlLmhlaWdodCk7ICAgICAvLyBUb3AgcmlnaHRcclxuXHR0aGlzLndpcmVmcmFtZS5saW5lVG8oKyAoMS10aGlzLnNwcml0ZS5hbmNob3IueCkgKiB0aGlzLnNwcml0ZS53aWR0aCwgKyAoMS10aGlzLnNwcml0ZS5hbmNob3IueSkgKiB0aGlzLnNwcml0ZS5oZWlnaHQpOyAvLyBCb3R0b20gcmlnaHRcclxuXHR0aGlzLndpcmVmcmFtZS5saW5lVG8oLSB0aGlzLnNwcml0ZS5hbmNob3IueCAqIHRoaXMuc3ByaXRlLndpZHRoLCAgICAgKyAoMS10aGlzLnNwcml0ZS5hbmNob3IueSkgKiB0aGlzLnNwcml0ZS5oZWlnaHQpOyAvLyBCb3R0b20gbGVmdFxyXG5cdHRoaXMud2lyZWZyYW1lLmxpbmVUbygtIHRoaXMuc3ByaXRlLmFuY2hvci54ICogdGhpcy5zcHJpdGUud2lkdGgsICAgICAtIHRoaXMuc3ByaXRlLmFuY2hvci55ICogdGhpcy5zcHJpdGUuaGVpZ2h0KTsgICAgIC8vIFRvcCBsZWZ0XHJcblxyXG5cdHRoaXMud2lyZWZyYW1lLmJlZ2luRmlsbCgweGZmMDAwMCk7XHJcblx0dGhpcy53aXJlZnJhbWUuZHJhd0NpcmNsZSgwLCAwLCA1KTtcclxuXHR0aGlzLndpcmVmcmFtZS5lbmRGaWxsO1xyXG5cclxuXHR0aGlzLndpcmVmcmFtZS52aXNpYmxlID0gdGhpcy5sYXllci5zZWxlY3RlZCA9PSB0aGlzO1xyXG5cclxuXHR0aGlzLmFkZENoaWxkKHRoaXMud2lyZWZyYW1lKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsT2JqZWN0LnByb3RvdHlwZS5yZW5kZXJHVUkgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmVkaXRvci5yZW5kZXJHVUkoXCJvYmplY3RcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbE9iamVjdC5wcm90b3R5cGUuYmFjayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGF5ZXIuc2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHQvLyBBZGQgaGlzdG9yeSBzdGF0ZVxyXG5cdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLnNldFNjYWxlID0gZnVuY3Rpb24oc2NhbGUsIHNhdmVTdGF0ZSlcclxue1xyXG5cdHRoaXMuY29uZmlnLnNjYWxlLnggPSBzY2FsZTtcclxuXHR0aGlzLmNvbmZpZy5zY2FsZS55ID0gc2NhbGU7XHJcblx0dGhpcy5zY2FsZS5zZXQoc2NhbGUpO1xyXG5cdFxyXG5cdC8vIEFkZCBoaXN0b3J5IHN0YXRlXHJcblx0aWYoc2F2ZVN0YXRlKVxyXG5cdHtcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1x0XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLnNldFJvdGF0aW9uID0gZnVuY3Rpb24oZGVncmVlcywgc2F2ZVN0YXRlKVxyXG57XHJcblx0dGhpcy5jb25maWcucm90YXRpb24gPSBkZWdyZWVzO1xyXG5cdHRoaXMucm90YXRpb24gPSB0aGlzLmNvbmZpZy5yb3RhdGlvbiAqIFBJWEkuREVHX1RPX1JBRDtcclxuXHRcclxuXHQvLyBBZGQgaGlzdG9yeSBzdGF0ZVxyXG5cdGlmKHNhdmVTdGF0ZSlcclxuXHR7XHRcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1x0XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLnNldENvbmZpZyA9IGZ1bmN0aW9uKHBhcmFtZXRlciwgdmFsdWUsIHNhdmVTdGF0ZSlcclxue1xyXG5cdHRoaXMuY29uZmlnW3BhcmFtZXRlcl0gPSB2YWx1ZTtcclxuXHJcblx0aWYoc2F2ZVN0YXRlKVxyXG5cdFx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbE9iamVjdC5wcm90b3R5cGUuaXNQb2ludEluc2lkZSA9IGZ1bmN0aW9uKHBvaW50KVxyXG57XHJcblx0dmFyIHAgPSBuZXcgUElYSS5Qb2ludChwb2ludC54LCBwb2ludC55KTtcclxuXHJcblx0aWYodGhpcy5yb3RhdGlvbiAhPSAwKVxyXG5cdHtcclxuXHRcdHAucm90YXRlQXJvdW5kKG5ldyBQSVhJLlBvaW50KHRoaXMueCwgdGhpcy55KSwgLXRoaXMucm90YXRpb24pO1xyXG5cdH1cclxuXHJcblx0aWYocC54IDwgdGhpcy54IC0gdGhpcy5zcHJpdGUud2lkdGggICogdGhpcy5zY2FsZS54ICogdGhpcy5zcHJpdGUuYW5jaG9yLngpICAgICByZXR1cm4gZmFsc2U7XHJcblx0aWYocC54ID4gdGhpcy54ICsgdGhpcy5zcHJpdGUud2lkdGggICogdGhpcy5zY2FsZS54ICogKDEtdGhpcy5zcHJpdGUuYW5jaG9yLngpKSByZXR1cm4gZmFsc2U7XHJcblx0aWYocC55IDwgdGhpcy55IC0gdGhpcy5zcHJpdGUuaGVpZ2h0ICogdGhpcy5zY2FsZS55ICogdGhpcy5zcHJpdGUuYW5jaG9yLnkpICAgICByZXR1cm4gZmFsc2U7XHJcblx0aWYocC55ID4gdGhpcy55ICsgdGhpcy5zcHJpdGUuaGVpZ2h0ICogdGhpcy5zY2FsZS55ICogKDEtdGhpcy5zcHJpdGUuYW5jaG9yLnkpKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLmV4cG9ydCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBvdXRwdXQgPSBqUXVlcnkuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLmNvbmZpZyk7XHJcblx0b3V0cHV0LnBvc2l0aW9uID0ge3g6TWF0aC5yb3VuZCh0aGlzLngpLCB5Ok1hdGgucm91bmQodGhpcy55KX07XHJcblxyXG5cdGlmKHRoaXMubGF5ZXIuc2VsZWN0ZWQgPT0gdGhpcylcclxuXHR7XHJcblx0XHRvdXRwdXQuc2VsZWN0ZWQgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIG91dHB1dDtcclxufVxyXG5cclxuTGV2ZWxPYmplY3QucHJvdG90eXBlLmltcG9ydCA9IGZ1bmN0aW9uKHNhdmUpXHJcbntcclxuXHR0aGlzLnggICAgICAgICAgICAgICA9IHNhdmUucG9zaXRpb24ueDtcclxuXHR0aGlzLnkgICAgICAgICAgICAgICA9IHNhdmUucG9zaXRpb24ueTtcclxuXHR0aGlzLmNvbmZpZy5pZCAgICAgICA9IHNhdmUuaWQ7XHJcblx0dGhpcy5jb25maWcudGV4dHVyZSAgPSBzYXZlLnRleHR1cmU7XHJcblx0dGhpcy5jb25maWcuYW5jaG9yICAgPSB7eDpzYXZlLmFuY2hvci54LCB5OnNhdmUuYW5jaG9yLnl9O1xyXG5cdHRoaXMuY29uZmlnLnNjYWxlICAgID0ge3g6c2F2ZS5zY2FsZS54LCB5OnNhdmUuc2NhbGUueX07XHJcblx0dGhpcy5jb25maWcucm90YXRpb24gPSBzYXZlLnJvdGF0aW9uO1xyXG5cdHRoaXMuY29uZmlnLmRlcHRoICAgID0gc2F2ZS5kZXB0aDtcclxuXHR0aGlzLmNvbmZpZy5kYXRhICAgICA9IHNhdmUuZGF0YTtcclxuXHRcclxuXHRpZighIXNhdmUuc2VsZWN0ZWQpXHJcblx0e1xyXG5cdFx0dGhpcy5sYXllci5zZWxlY3RlZCA9IHRoaXM7XHRcclxuXHR9XHJcbn0iLCJ2YXIgQ29tbW9uICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBFZGl0b3IgICAgID0gcmVxdWlyZShcIi4uL2VkaXRvci9FZGl0b3JcIik7XHJcbnZhciBMZXZlbCAgICAgID0gcmVxdWlyZShcIi4uL2VkaXRvci9MZXZlbFwiKTtcclxudmFyIExldmVsTGF5ZXIgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0xldmVsTGF5ZXJcIik7XHJcbnZhciBCZXppZXJQYXRoID0gcmVxdWlyZShcIi4uL2VkaXRvci9CZXppZXJQYXRoXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIExldmVsUGF0aChsYXllcilcclxue1xyXG5cdHRoaXMuZWRpdG9yID0gbGF5ZXIuZWRpdG9yO1xyXG5cdHRoaXMubGF5ZXIgID0gbGF5ZXI7XHJcblx0dGhpcy5hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblxyXG5cdHRoaXMuY29uZmlnID1cclxuXHR7XHJcblx0XHRjbG9zZWQgICAgICAgICAgICA6IGZhbHNlLFxyXG5cdFx0ZGVwdGggICAgICAgICAgICAgOiAwLFxyXG5cdFx0Y29sbGlzaW9ucyAgICAgICAgOiAxLCAvLzA6IG5vLCAxOiB5ZXMsIDI6IGdyb3VuZCBvbmx5XHJcblx0XHR0ZXhGaWxsICAgICAgICAgICA6IFwidGhlbWVfMDFfZmlsbFwiLFxyXG5cdFx0dGV4R3JvdW5kICAgICAgICAgOiBcInRoZW1lXzAxX2dyb3VuZFwiLFxyXG5cdFx0dGV4R3JvdW5kRWRnZSAgICAgOiBcInRoZW1lXzAxX2dyb3VuZF9lZGdlXCIsXHJcblx0XHR0ZXhXYWxsICAgICAgICAgICA6IFwidGhlbWVfMDFfd2FsbFwiLFxyXG5cdFx0dGV4RmlsbFBhZGRpbmcgICAgOiA1MTIsXHJcblx0XHR0ZXhGaWxsU2l6ZSAgICAgICA6IDI1NixcclxuXHRcdHRleEdyb3VuZFNpemUgICAgIDogMTYwLFxyXG5cdFx0dGV4R3JvdW5kRGVsdGEgICAgOiAwLjEsXHJcblx0XHR0ZXhXYWxsU2l6ZSAgICAgICA6IDE2MCxcclxuXHRcdHRleFdhbGxEZWx0YSAgICAgIDogMC4xLFxyXG5cdFx0dGV4V2FsbEFuZ2xlICAgICAgOiA3MCxcclxuXHRcdHRleEdyb3VuZEVkZ2VTaWRlIDogXCJcIixcclxuXHRcdGRhdGEgICAgICAgICAgICAgIDogXCJcIlxyXG5cdH1cclxuXHJcblx0dGhpcy5iZXppZXIgICAgID0gbmV3IEJlemllclBhdGgoKTtcclxuXHR0aGlzLmJlemllci5jYWNoZURyYXdpbmdQb2ludHMgPSBmYWxzZTtcclxuXHR0aGlzLnBvaW50SW5kZXggPSAtMTtcclxuXHJcblx0dGhpcy53aXJlZnJhbWUgPSBudWxsO1xyXG5cdHRoaXMudGV4dHVyZXMgID0gbnVsbDtcclxuXHJcblx0dGhpcy5sbWIgPSBmYWxzZTtcclxuXHR0aGlzLnJtYiA9IGZhbHNlO1xyXG5cdHRoaXMuZHJhZ01vdmVtZW50ID0gbnVsbDtcclxuXHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IExldmVsUGF0aDtcclxuTGV2ZWxQYXRoLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExldmVsUGF0aDtcclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIExlZnQgQ2xpY2tcclxuXHRpZih0aGlzLmVkaXRvci5tb3VzZS5sZWZ0UHJlc3NlZClcclxuXHR7XHJcblx0XHR2YXIgbW91c2VQb3NpdGlvbiA9IHRoaXMuZWRpdG9yLmdldE1vdXNlUG9zaXRpb24oKTtcclxuXHJcblx0XHRpZighdGhpcy5sbWIgJiYgdGhpcy5lZGl0b3IubW91c2UubGVmdEp1c3RQcmVzc2VkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmxtYiA9IHRydWU7XHJcblxyXG5cdFx0XHQvLyBHZXQgcG9pbnRcclxuXHRcdFx0dGhpcy5wb2ludEluZGV4ID0gdGhpcy5nZXRQb2ludEF0KG1vdXNlUG9zaXRpb24ueCwgbW91c2VQb3NpdGlvbi55KTtcclxuXHJcblx0XHRcdGlmKHRoaXMucG9pbnRJbmRleCA9PSAtMSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIEFkZCBuZXcgcG9pbnRcclxuXHRcdFx0XHR2YXIgcHJldlBvaW50ID0gdGhpcy5iZXppZXIucG9pbnRzW3RoaXMuYmV6aWVyLnBvaW50cy5sZW5ndGgtMV07XHJcblx0XHRcdFx0dmFyIG5ld1BvaW50ICA9IG1vdXNlUG9zaXRpb247XHJcblxyXG5cdFx0XHRcdGlmKHRoaXMuY29uZmlnLmNsb3NlZCB8fCBwcmV2UG9pbnQueCA8IG5ld1BvaW50LngpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Ly8gQWRkIHBvaW50IGF0IHRoZSBlbmQgaWYgY2xvc2VkIG9yIG9wZW4gYW5kIGFmdGVyIHRoZSBsYXN0IHBvaW50XHJcblx0XHRcdFx0XHR0aGlzLmFkZFBvaW50KHByZXZQb2ludC54ICsgKG5ld1BvaW50LnggLSBwcmV2UG9pbnQueCkvMiwgcHJldlBvaW50LnkpO1xyXG5cdFx0XHRcdFx0dGhpcy5hZGRQb2ludChuZXdQb2ludC54IC0gKG5ld1BvaW50LnggLSBwcmV2UG9pbnQueCkvMiwgbmV3UG9pbnQueSk7XHJcblx0XHRcdFx0XHR0aGlzLmFkZFBvaW50KG5ld1BvaW50LngsIG5ld1BvaW50LnkpO1xyXG5cdFx0XHRcdFx0dGhpcy5wb2ludEluZGV4ID0gdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aCAtIDE7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQvLyBBZGQgcG9pbnQgaW4gdGhlIG1pZGRsZSBvZiB0d28gcG9pbnRzIGlmIHRoZSBwYXRoIGlzIG9wZW4gaWYgdGhlIG5ldyBwb3NpdGlvbiBpcyBub3QgYWZ0ZXIgdGhlIGxhc3QgcG9pbnRcclxuXHRcdFx0XHRcdGlmKHRoaXMuYmV6aWVyLnBvaW50cy5sZW5ndGggPiAxICYmIG5ld1BvaW50LnggPiB0aGlzLmJlemllci5nZXRGaXJzdFBvaW50KCkueClcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Zm9yKHZhciBpID0gMzsgaSA8IHRoaXMuYmV6aWVyLnBvaW50cy5sZW5ndGg7IGkrPSAzKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0aWYodGhpcy5iZXppZXIucG9pbnRzW2ldLnggPiBuZXdQb2ludC54KVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBwcmV2UG9pbnQgPSB0aGlzLmJlemllci5wb2ludHNbaS0zXTtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBuZXh0UG9pbnQgPSB0aGlzLmJlemllci5wb2ludHNbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5hZGRQb2ludChuZXh0UG9pbnQueCAtIChuZXh0UG9pbnQueCAtIG5ld1BvaW50LngpLzIsIG5ld1BvaW50LnksIGktMSk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmFkZFBvaW50KG5ld1BvaW50LngsIG5ld1BvaW50LnksIGktMSk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmFkZFBvaW50KHByZXZQb2ludC54ICsgKG5ld1BvaW50LnggLSBwcmV2UG9pbnQueCkvMiwgbmV3UG9pbnQueSwgaS0xKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBvaW50SW5kZXggPSBpO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGlzLnJlbmRlcigpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMubG1iKVxyXG5cdFx0e1xyXG5cdFx0XHRpZih0aGlzLnBvaW50SW5kZXggIT0gLTEpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgbW92ZWQgPSB0aGlzLm1vdmVQb2ludCh0aGlzLnBvaW50SW5kZXgsIG1vdXNlUG9zaXRpb24ueCwgbW91c2VQb3NpdGlvbi55KTtcclxuXHJcblx0XHRcdFx0aWYobW92ZWQpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dGhpcy5yZW5kZXIoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmxtYilcclxuXHR7XHJcblx0XHR0aGlzLmxtYiA9IGZhbHNlO1xyXG5cdFx0dGhpcy5yZW5kZXIoKTtcclxuXHJcblx0XHQvLyBBZGQgaGlzdG9yeSBzdGF0ZVxyXG5cdFx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcblx0fVxyXG5cclxuXHJcblx0Ly8gUmlnaHQgQ2xpY2tcclxuXHRpZih0aGlzLmVkaXRvci5tb3VzZS5yaWdodFByZXNzZWQpXHJcblx0e1xyXG5cdFx0dmFyIG1vdXNlUG9zaXRpb24gPSB0aGlzLmVkaXRvci5nZXRNb3VzZVBvc2l0aW9uKCk7XHJcblxyXG5cdFx0aWYoIXRoaXMucm1iKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnJtYiA9IHRydWU7XHJcblx0XHRcdHRoaXMuZHJhZ01vdmVtZW50ID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIG1vdXNlTW92ZW1lbnQgPSB0aGlzLmVkaXRvci5tb3VzZS5tb3ZlbWVudDtcclxuXHRcdFx0bW91c2VNb3ZlbWVudC5tdWx0aXBseSgxL3RoaXMuZWRpdG9yLnNjYWxlLngpO1xyXG5cclxuXHRcdFx0dGhpcy5tb3ZlXHJcblx0XHRcdChcclxuXHRcdFx0XHQtTWF0aC5yb3VuZCh0aGlzLmRyYWdNb3ZlbWVudC54L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkLFxyXG5cdFx0XHRcdC1NYXRoLnJvdW5kKHRoaXMuZHJhZ01vdmVtZW50LnkvdGhpcy5lZGl0b3Iuc25hcEdyaWQpICogdGhpcy5lZGl0b3Iuc25hcEdyaWRcclxuXHRcdFx0KTtcclxuXHJcblx0XHRcdHRoaXMuZHJhZ01vdmVtZW50LnggKz0gbW91c2VNb3ZlbWVudC54O1xyXG5cdFx0XHR0aGlzLmRyYWdNb3ZlbWVudC55ICs9IG1vdXNlTW92ZW1lbnQueTtcclxuXHJcblx0XHRcdHRoaXMubW92ZVxyXG5cdFx0XHQoXHJcblx0XHRcdFx0TWF0aC5yb3VuZCh0aGlzLmRyYWdNb3ZlbWVudC54L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkLFxyXG5cdFx0XHRcdE1hdGgucm91bmQodGhpcy5kcmFnTW92ZW1lbnQueS90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZFxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0dGhpcy5yZW5kZXIoKTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLnJtYilcclxuXHR7XHJcblx0XHR0aGlzLnJtYiA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIEhpc3RvcnlcclxuXHRcdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG5cdH1cclxuXHJcblx0dmFyIGlucHV0Rm9jdXMgPSAkKFwiaW5wdXQ6Zm9jdXMsIHRleHRhcmVhOmZvY3VzXCIpLmxlbmd0aCA+IDA7XHJcblxyXG5cdC8vIERlbGV0ZSBwb2ludFxyXG5cdGlmKENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0MpICYmICFDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0NUUkwpICYmICFpbnB1dEZvY3VzKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMucG9pbnRJbmRleCAlIDMgPT0gMCAmJiB0aGlzLmJlemllci5wb2ludHMubGVuZ3RoID4gMSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGlzTGFzdFBvaW50ID0gdGhpcy5wb2ludEluZGV4ID09ICh0aGlzLmJlemllci5wb2ludHMubGVuZ3RoLTEpO1xyXG5cdFx0XHR0aGlzLmRlbGV0ZVBvaW50KHRoaXMucG9pbnRJbmRleCk7XHJcblx0XHRcdGlmKGlzTGFzdFBvaW50KSB0aGlzLnBvaW50SW5kZXgtPTM7XHJcblxyXG5cdFx0XHR0aGlzLnJlbmRlcigpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gQmFja1xyXG5cdGlmKENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0IpICYmICFDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0NUUkwpICYmICFpbnB1dEZvY3VzKVxyXG5cdHtcclxuXHRcdCQoXCIuYmFja1wiKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcblx0fVxyXG5cclxuXHQvLyBUb2dnbGUgd2lyZWZyYW1lXHJcblx0aWYoQ29tbW9uLmtleWJvYXJkLmdldEtleUp1c3RQcmVzc2VkKENvbW1vbi5rZXlib2FyZC5LRVlfVykgJiYgIWlucHV0Rm9jdXMpXHJcblx0e1xyXG5cdFx0dGhpcy53aXJlZnJhbWUudmlzaWJsZSA9ICF0aGlzLndpcmVmcmFtZS52aXNpYmxlO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy53aXJlZnJhbWUgIT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnJlbW92ZUNoaWxkKHRoaXMud2lyZWZyYW1lKTtcclxuXHR9XHJcblxyXG5cdGlmKHRoaXMudGV4dHVyZXMgIT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnJlbW92ZUNoaWxkKHRoaXMudGV4dHVyZXMpO1xyXG5cdH1cclxuXHJcblxyXG5cdHRoaXMud2lyZWZyYW1lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHR0aGlzLnRleHR1cmVzID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblxyXG5cclxuXHRpZih0aGlzLmJlemllci5wb2ludHMubGVuZ3RoID4gMSlcclxuXHR7XHJcblx0XHR2YXIgZHJhd2luZ1BvaW50cyA9IHRoaXMuYmV6aWVyLmdldERyYXdpbmdQb2ludHMoKTtcclxuXHRcdHZhciBkcmF3aW5nUG9pbnRzTm9ybWFscyA9IHRoaXMuYmV6aWVyLmdldERyYXdpbmdQb2ludHNOb3JtYWxzKCk7XHJcblxyXG5cdFx0Ly8gRHJhdyBmaWxsIHRleHR1cmVcclxuXHRcdGlmKHRoaXMuY29uZmlnLnRleEZpbGwgIT0gXCJcIiApXHJcblx0XHR7XHJcblx0XHRcdHZhciBsb3dlclBvaW50ID0gbnVsbDtcclxuXHRcdFx0dmFyIGNvbnRvdXIgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGRyYXdpbmdQb2ludHMubGVuZ3RoOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjb250b3VyLnB1c2gobmV3IHBvbHkydHJpLlBvaW50KGRyYXdpbmdQb2ludHNbaV0ueCwgZHJhd2luZ1BvaW50c1tpXS55KSk7XHJcblxyXG5cdFx0XHRcdGlmKGxvd2VyUG9pbnQgPT0gbnVsbCB8fCBsb3dlclBvaW50IDwgZHJhd2luZ1BvaW50c1tpXS55KVxyXG5cdFx0XHRcdFx0bG93ZXJQb2ludCA9IGRyYXdpbmdQb2ludHNbaV0ueTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYoIXRoaXMuY29uZmlnLmNsb3NlZClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNvbnRvdXIucHVzaCh7eDogZHJhd2luZ1BvaW50c1tkcmF3aW5nUG9pbnRzLmxlbmd0aC0xXS54LCB5OiBsb3dlclBvaW50ICsgdGhpcy5jb25maWcudGV4RmlsbFBhZGRpbmd9KTtcclxuXHRcdFx0XHRjb250b3VyLnB1c2goe3g6IGRyYXdpbmdQb2ludHNbMF0ueCwgeTogbG93ZXJQb2ludCArIHRoaXMuY29uZmlnLnRleEZpbGxQYWRkaW5nfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gUmVtb3ZlIGxhc3QgcG9pbnQgaWYgY29pbmNpZGVzIHdpdGggdGhlIGZpcnN0LCBvdGhlcndpc2UgdGhlIHRyaWFuZ3VsYXRpb24gd2lsbCBmYWlsXHJcblx0XHRcdFx0aWYoY29udG91clswXS54ID09IGNvbnRvdXJbY29udG91ci5sZW5ndGgtMV0ueCAmJiBjb250b3VyWzBdLnkgPT0gY29udG91cltjb250b3VyLmxlbmd0aC0xXS55KVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGNvbnRvdXIuc3BsaWNlKGNvbnRvdXIubGVuZ3RoLTEsIDEpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dHJ5XHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpO1xyXG5cdFx0XHRcdHN3Y3R4LnRyaWFuZ3VsYXRlKCk7XHJcblx0XHRcdFx0dmFyIHRyaWFuZ2xlcyA9IHN3Y3R4LmdldFRyaWFuZ2xlcygpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNhdGNoKGUpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlRyaWFuZ3VsYXRpb24gZmFpbGVkXCIpXHJcblx0XHRcdH1cclxuXHJcblxyXG5cdFx0XHRpZighIXRyaWFuZ2xlcylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIERyYXcgdGhlIGZpbGxpbmcgbWVzaFxyXG5cdFx0XHRcdHZhciB0ZXh0dXJlICAgID0gdGhpcy5hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXhGaWxsKTtcclxuXHRcdFx0XHR2YXIgdmVydGljZXMgICA9IG5ldyBGbG9hdDMyQXJyYXkoNiAqIHRyaWFuZ2xlcy5sZW5ndGgpO1xyXG5cdFx0XHRcdHZhciB1dnMgICAgICAgID0gbmV3IEZsb2F0MzJBcnJheSg2ICogdHJpYW5nbGVzLmxlbmd0aCk7XHJcblx0XHRcdFx0dmFyIGluZGljZXMgICAgPSBuZXcgVWludDE2QXJyYXkoMyAqIHRyaWFuZ2xlcy5sZW5ndGgpO1xyXG5cclxuXHRcdFx0XHR2YXIgc2l6ZSA9IHRoaXMuY29uZmlnLnRleEZpbGxTaXplO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBwb2ludHMgPSB0cmlhbmdsZXNbaV0uZ2V0UG9pbnRzKCk7XHJcblxyXG5cdFx0XHRcdFx0dmVydGljZXMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHRwb2ludHNbMF0ueCwgcG9pbnRzWzBdLnksXHJcblx0XHRcdFx0XHRcdHBvaW50c1sxXS54LCBwb2ludHNbMV0ueSxcclxuXHRcdFx0XHRcdFx0cG9pbnRzWzJdLngsIHBvaW50c1syXS55XHJcblx0XHRcdFx0XHRdLCBpKjYpXHJcblxyXG5cdFx0XHRcdFx0dXZzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0cG9pbnRzWzBdLngvc2l6ZSwgcG9pbnRzWzBdLnkvc2l6ZSxcclxuXHRcdFx0XHRcdFx0cG9pbnRzWzFdLngvc2l6ZSwgcG9pbnRzWzFdLnkvc2l6ZSxcclxuXHRcdFx0XHRcdFx0cG9pbnRzWzJdLngvc2l6ZSwgcG9pbnRzWzJdLnkvc2l6ZVxyXG5cdFx0XHRcdFx0XSwgaSAqIDYpO1xyXG5cclxuXHRcdFx0XHRcdGluZGljZXMuc2V0KFswICsgMyppLCAxICsgMyppLCAyICsgMyppXSwgaSAqIDMpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFdpcmVmcmFtZVxyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgxLCAweDAwZmYwMCwgMC41KTtcclxuXHRcdFx0XHRcdHZhciBwb2ludHMgPSB0cmlhbmdsZXNbaV0uZ2V0UG9pbnRzKCk7XHJcblxyXG5cdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHBvaW50c1swXS54LCBwb2ludHNbMF0ueSk7XHJcblx0XHRcdFx0XHRmb3IodmFyIHAgPSAxOyBwIDwgcG9pbnRzLmxlbmd0aDsgcCsrKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzW3BdLngsIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwb2ludHNbMF0ueCwgcG9pbnRzWzBdLnkpO1xyXG5cdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHZhciBtZXNoID0gbmV3IFBJWEkubWVzaC5NZXNoXHJcblx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0dGV4dHVyZSxcclxuXHRcdFx0XHRcdHZlcnRpY2VzLFxyXG5cdFx0XHRcdFx0dXZzLFxyXG5cdFx0XHRcdFx0aW5kaWNlcyxcclxuXHRcdFx0XHRcdFBJWEkubWVzaC5NZXNoLkRSQVdfTU9ERVMuVFJJQU5HTEVTXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdFx0LypcclxuXHRcdFx0XHR2YXIgc2hhZGVyID0gbmV3IFBJWEkuQWJzdHJhY3RGaWx0ZXIoJycsXHJcblx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0J3ByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OycsXHJcblxyXG5cdFx0XHRcdFx0J3ZhcnlpbmcgdmVjMiB2VGV4dHVyZUNvb3JkOycsXHJcblx0XHRcdFx0XHQndW5pZm9ybSBzYW1wbGVyMkQgdVNhbXBsZXI7JyxcclxuXHRcdFx0XHRcdCd1bmlmb3JtIHZlYzQgdVVWUzsnLFxyXG5cclxuXHRcdFx0XHRcdCd2b2lkIG1haW4odm9pZCknLFxyXG5cdFx0XHRcdFx0J3snLFxyXG5cdFx0XHRcdFx0XHQndmVjMiBjb29yZHMgPSB2VGV4dHVyZUNvb3JkOycsXHJcblx0XHRcdFx0XHRcdC8vICdjb29yZHMueCA9IHVVVlMueCArIGNvb3Jkcy54ICogKHVVVlMueiAtIHVVVlMueCk7JyxcclxuXHRcdFx0XHRcdFx0Ly8gJ2Nvb3Jkcy55ID0gdVVWUy55ICsgY29vcmRzLnkgKiAodVVWUy53IC0gdVVWUy55KTsnLFxyXG5cdFx0XHRcdFx0XHQnZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKHVTYW1wbGVyLCBjb29yZHMpOycsXHJcblx0XHRcdFx0XHRcdCdnbF9GcmFnQ29sb3IuciA9IGNvb3Jkcy54OycsXHJcblx0XHRcdFx0XHRcdCdnbF9GcmFnQ29sb3IuZyA9IGNvb3Jkcy55OycsXHJcblx0XHRcdFx0XHQnfScsXHJcblx0XHRcdFx0XS5qb2luKCdcXG4nKSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR1VVZTIDoge3R5cGU6ICc0ZnYnLCB2YWx1ZSA6IFt0ZXh0dXJlLl91dnMueDAsIHRleHR1cmUuX3V2cy55MCwgdGV4dHVyZS5fdXZzLngxLCB0ZXh0dXJlLl91dnMueTFdfVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdG1lc2guZmlsdGVycyA9IFtzaGFkZXJdO1xyXG5cdFx0XHRcdCovXHJcblxyXG5cdFx0XHRcdHRoaXMudGV4dHVyZXMuYWRkQ2hpbGQobWVzaCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblxyXG5cdFx0Ly8gRHJhdyB0aGUgaW5jbGluZWQgdGVycmFpblxyXG5cdFx0aWYodGhpcy5jb25maWcudGV4V2FsbCAhPSBcIlwiKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgc2VnbWVudHMgICAgICAgPSB0aGlzLmJlemllci5nZXRHcm91bmRTZWdtZW50cyh0aGlzLmNvbmZpZy50ZXhXYWxsQW5nbGUsIDM2MCk7XHJcblx0XHRcdHZhciB0ZXh0dXJlU2l6ZSAgICA9IHRoaXMuY29uZmlnLnRleFdhbGxTaXplO1xyXG5cdFx0XHR2YXIgdGV4dHVyZVRvcFBlcmMgPSB0aGlzLmNvbmZpZy50ZXhXYWxsRGVsdGFcclxuXHJcblx0XHRcdHZhciBzZWdtZW50c1NpemUgPSAwO1xyXG5cdFx0XHRmb3IodmFyIHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRzZWdtZW50c1NpemUgKz0gc2VnbWVudHNbc10ucG9pbnRzLmxlbmd0aC0xO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgdGV4dHVyZSAgICA9IHRoaXMuYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4V2FsbCk7XHJcblx0XHRcdHZhciB2ZXJ0aWNlcyAgID0gbmV3IEZsb2F0MzJBcnJheSg4ICogc2VnbWVudHNTaXplKTtcclxuXHRcdFx0dmFyIHV2cyAgICAgICAgPSBuZXcgRmxvYXQzMkFycmF5KDggKiBzZWdtZW50c1NpemUpO1xyXG5cdFx0XHR2YXIgaW5kaWNlcyAgICA9IG5ldyBVaW50MTZBcnJheSg2ICogc2VnbWVudHNTaXplKTtcclxuXHRcdFx0dmFyIGFycmF5SW5kZXggPSAwO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBzID0gMDsgcyA8IHNlZ21lbnRzLmxlbmd0aDsgcysrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRvdGFsTGVuZ3RoICA9IDA7XHJcblx0XHRcdFx0dmFyIHNlZ21lbnRMZW5ndGggPSAwO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGggLTE7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2ZXJ0aWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2ldLnggICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueCAgICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLCAgICAgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueSAgICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLFxyXG5cdFx0XHRcdFx0XHRcdHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnggLSBzZWdtZW50c1tzXS5ub3JtYWxzW2krMV0ueCAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSwgICAgIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnkgLSBzZWdtZW50c1tzXS5ub3JtYWxzW2krMV0ueSAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSxcclxuXHRcdFx0XHRcdFx0XHRzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLCBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnkgKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLFxyXG5cdFx0XHRcdFx0XHRcdHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnggICAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSksIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnkgICAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSlcclxuXHRcdFx0XHRcdF0sIGFycmF5SW5kZXgqOClcclxuXHJcblx0XHRcdFx0XHR2YXIgdiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLngsIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55IC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSk7XHJcblx0XHRcdFx0XHRzZWdtZW50TGVuZ3RoID0gdi5nZXRMZW5ndGgoKTtcclxuXHJcblx0XHRcdFx0XHR1dnMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHR0b3RhbExlbmd0aC90ZXh0dXJlU2l6ZSwgMCxcclxuXHRcdFx0XHRcdFx0KHRvdGFsTGVuZ3RoK3NlZ21lbnRMZW5ndGgpL3RleHR1cmVTaXplLCAwLFxyXG5cdFx0XHRcdFx0XHQodG90YWxMZW5ndGgrc2VnbWVudExlbmd0aCkvdGV4dHVyZVNpemUsIDEsXHJcblx0XHRcdFx0XHRcdHRvdGFsTGVuZ3RoL3RleHR1cmVTaXplLCAxXHJcblx0XHRcdFx0XHRdLCBhcnJheUluZGV4ICogOCk7XHJcblxyXG5cclxuXHRcdFx0XHRcdGluZGljZXMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHQwICsgNCphcnJheUluZGV4LFxyXG5cdFx0XHRcdFx0XHQxICsgNCphcnJheUluZGV4LFxyXG5cdFx0XHRcdFx0XHQyICsgNCphcnJheUluZGV4LFxyXG5cdFx0XHRcdFx0XHQwICsgNCphcnJheUluZGV4LFxyXG5cdFx0XHRcdFx0XHQyICsgNCphcnJheUluZGV4LFxyXG5cdFx0XHRcdFx0XHQzICsgNCphcnJheUluZGV4XHJcblx0XHRcdFx0XHRdLCBhcnJheUluZGV4ICogNik7XHJcblxyXG5cdFx0XHRcdFx0dG90YWxMZW5ndGggKz0gc2VnbWVudExlbmd0aDtcclxuXHJcblx0XHRcdFx0XHQvLyBXaXJlZnJhbWVcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgxLCAweDAwZmYwMCwgMC41KTtcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMCoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMSoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzEqMisxXSk7IC8vIDFcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMioyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzIqMisxXSk7IC8vIDJcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMyoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzMqMisxXSk7IC8vIDNcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMCoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMioyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzIqMisxXSk7IC8vIDJcclxuXHJcblx0XHRcdFx0XHRhcnJheUluZGV4Kys7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgbWVzaCA9IG5ldyBQSVhJLm1lc2guTWVzaFxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGV4dHVyZSxcclxuXHRcdFx0XHR2ZXJ0aWNlcyxcclxuXHRcdFx0XHR1dnMsXHJcblx0XHRcdFx0aW5kaWNlcyxcclxuXHRcdFx0XHRQSVhJLm1lc2guTWVzaC5EUkFXX01PREVTLlRSSUFOR0xFU1xyXG5cdFx0XHQpO1xyXG5cclxuXHRcdFx0dGhpcy50ZXh0dXJlcy5hZGRDaGlsZChtZXNoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBEcmF3IHRoZSB0ZXJyYWluXHJcblx0XHR2YXIgc2VnbWVudHMgICAgICAgPSB0aGlzLmJlemllci5nZXRHcm91bmRTZWdtZW50cygwLCB0aGlzLmNvbmZpZy50ZXhXYWxsQW5nbGUsIHRoaXMuY29uZmlnLnRleEdyb3VuZEVkZ2UgPT0gXCJcIik7XHJcblx0XHR2YXIgdGV4dHVyZVNpemVPciAgPSB0aGlzLmNvbmZpZy50ZXhHcm91bmRTaXplO1xyXG5cdFx0dmFyIHRleHR1cmVUb3BQZXJjID0gdGhpcy5jb25maWcudGV4R3JvdW5kRGVsdGFcclxuXHJcblx0XHRpZih0aGlzLmNvbmZpZy50ZXhHcm91bmQgIT0gXCJcIilcclxuXHRcdHtcclxuXHRcdFx0dmFyIHNlZ21lbnRzU2l6ZSA9IDA7XHJcblx0XHRcdGZvcih2YXIgcyA9IDA7IHMgPCBzZWdtZW50cy5sZW5ndGg7IHMrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHNlZ21lbnRzU2l6ZSArPSBzZWdtZW50c1tzXS5wb2ludHMubGVuZ3RoLTE7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciB0ZXh0dXJlICAgID0gdGhpcy5hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXhHcm91bmQpO1xyXG5cdFx0XHR2YXIgdmVydGljZXMgICA9IG5ldyBGbG9hdDMyQXJyYXkoOCAqIHNlZ21lbnRzU2l6ZSk7XHJcblx0XHRcdHZhciB1dnMgICAgICAgID0gbmV3IEZsb2F0MzJBcnJheSg4ICogc2VnbWVudHNTaXplKTtcclxuXHRcdFx0dmFyIGluZGljZXMgICAgPSBuZXcgVWludDE2QXJyYXkoNiAqIHNlZ21lbnRzU2l6ZSk7XHJcblx0XHRcdHZhciBhcnJheUluZGV4ID0gMDtcclxuXHJcblx0XHRcdGZvcih2YXIgcyA9IDA7IHMgPCBzZWdtZW50cy5sZW5ndGg7IHMrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIE1ha2UgdGhlIG5vcm1hbHMgcGVycGVuZGljdWxhciBpZiB0aGUgbGVmdC9yaWdodC1tb3N0IHNlZ21lbnRzIGRvbid0IGhhdmUgYSBjYXBcclxuXHRcdFx0XHRpZihzID09IDAgJiYgKHRoaXMuY29uZmlnLnRleEdyb3VuZEVkZ2VTaWRlID09IFwicmlnaHRcIiB8fCB0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcIm5vbmVcIikpXHJcblx0XHRcdFx0XHRzZWdtZW50c1tzXS5ub3JtYWxzWzBdID0ge3g6MCwgeToxfTtcclxuXHRcdFx0XHRpZihzID09IHNlZ21lbnRzLmxlbmd0aC0xICYmICh0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcImxlZnRcIiB8fCB0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcIm5vbmVcIikpXHJcblx0XHRcdFx0XHRzZWdtZW50c1tzXS5ub3JtYWxzW3NlZ21lbnRzW3NdLm5vcm1hbHMubGVuZ3RoLTFdID0ge3g6MCwgeToxfTtcclxuXHJcblx0XHRcdFx0Ly8gQ2FsY3VsYXRlIHRoZSB0b3RhbCBsZW5ndGggb2YgdGhlIHNlZ21lbnRcclxuXHRcdFx0XHR2YXIgc2VnbWVudExlbmd0aCAgPSAwO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGggLTE7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgdiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLngsIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55IC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSk7XHJcblx0XHRcdFx0XHRzZWdtZW50TGVuZ3RoICs9IHYuZ2V0TGVuZ3RoKCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBDb3VudCBob3cgbWFueSB0aW1lcyB0aGUgdGV4dHVyZSBjYW4gZml0IGluIHRoZSBzZWdtZW50IGxlbmd0aCwgdGhlbiByb3VuZCBpdCB0byBhZGp1c3QgdGhlIHRleHR1cmUgc2l6ZVxyXG5cdFx0XHRcdHZhciB0ZXh0dXJlU2l6ZSA9IHNlZ21lbnRMZW5ndGgvIE1hdGgubWF4KDEsIE1hdGgucm91bmQoc2VnbWVudExlbmd0aCAvIHRleHR1cmVTaXplT3IpKTtcclxuXHJcblx0XHRcdFx0Ly8gRHJhdyB0aGUgc2VnbWVudFxyXG5cdFx0XHRcdHZhciB0b3RhbExlbmd0aCAgID0gMDtcclxuXHRcdFx0XHR2YXIgc2VnbWVudExlbmd0aCA9IDA7XHJcblxyXG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aCAtMTsgaSsrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZlcnRpY2VzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0XHRzZWdtZW50c1tzXS5wb2ludHNbaV0ueCAgIC0gc2VnbWVudHNbc10ubm9ybWFsc1tpXS54ICAgKiAodGV4dHVyZVNpemUgKiB0ZXh0dXJlVG9wUGVyYyksICAgICBzZWdtZW50c1tzXS5wb2ludHNbaV0ueSAgIC0gc2VnbWVudHNbc10ubm9ybWFsc1tpXS55ICAgKiAodGV4dHVyZVNpemVPciAqIHRleHR1cmVUb3BQZXJjKSxcclxuXHRcdFx0XHRcdFx0XHRzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54IC0gc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnggKiAodGV4dHVyZVNpemUgKiB0ZXh0dXJlVG9wUGVyYyksICAgICBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55IC0gc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnkgKiAodGV4dHVyZVNpemVPciAqIHRleHR1cmVUb3BQZXJjKSxcclxuXHRcdFx0XHRcdFx0XHRzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLCBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnkgKiAodGV4dHVyZVNpemVPciAqICgxLXRleHR1cmVUb3BQZXJjKSksXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2ldLnggICArIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueCAgICogKHRleHR1cmVTaXplICogKDEtdGV4dHVyZVRvcFBlcmMpKSwgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgICArIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueSAgICogKHRleHR1cmVTaXplT3IgKiAoMS10ZXh0dXJlVG9wUGVyYykpXHJcblx0XHRcdFx0XHRdLCBhcnJheUluZGV4KjgpXHJcblxyXG5cdFx0XHRcdFx0dmFyIHYgPSBuZXcgUElYSS5Qb2ludChzZWdtZW50c1tzXS5wb2ludHNbaV0ueCAgLSBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54LCBzZWdtZW50c1tzXS5wb2ludHNbaV0ueSAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnkpO1xyXG5cdFx0XHRcdFx0c2VnbWVudExlbmd0aCA9IHYuZ2V0TGVuZ3RoKCk7XHJcblxyXG5cdFx0XHRcdFx0dXZzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0dG90YWxMZW5ndGgvdGV4dHVyZVNpemUsIDAsXHJcblx0XHRcdFx0XHRcdCh0b3RhbExlbmd0aCtzZWdtZW50TGVuZ3RoKS90ZXh0dXJlU2l6ZSwgMCxcclxuXHRcdFx0XHRcdFx0KHRvdGFsTGVuZ3RoK3NlZ21lbnRMZW5ndGgpL3RleHR1cmVTaXplLCAxLFxyXG5cdFx0XHRcdFx0XHR0b3RhbExlbmd0aC90ZXh0dXJlU2l6ZSwgMVxyXG5cdFx0XHRcdFx0XSwgYXJyYXlJbmRleCAqIDgpO1xyXG5cclxuXHJcblx0XHRcdFx0XHRpbmRpY2VzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0MCArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MSArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MiArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MCArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MiArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MyArIDQqYXJyYXlJbmRleFxyXG5cdFx0XHRcdFx0XSwgYXJyYXlJbmRleCAqIDYpO1xyXG5cclxuXHRcdFx0XHRcdHRvdGFsTGVuZ3RoICs9IHNlZ21lbnRMZW5ndGg7XHJcblxyXG5cdFx0XHRcdFx0Ly8gV2lyZWZyYW1lXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMSwgMHgwMGZmMDAsIDAuNSk7XHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzAqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzEqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCsxKjIrMV0pOyAvLyAxXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzIqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzMqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCszKjIrMV0pOyAvLyAzXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzAqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzIqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjIrMV0pOyAvLyAyXHJcblxyXG5cdFx0XHRcdFx0YXJyYXlJbmRleCsrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIG1lc2ggPSBuZXcgUElYSS5tZXNoLk1lc2hcclxuXHRcdFx0KFxyXG5cdFx0XHRcdHRleHR1cmUsXHJcblx0XHRcdFx0dmVydGljZXMsXHJcblx0XHRcdFx0dXZzLFxyXG5cdFx0XHRcdGluZGljZXMsXHJcblx0XHRcdFx0UElYSS5tZXNoLk1lc2guRFJBV19NT0RFUy5UUklBTkdMRVNcclxuXHRcdFx0KTtcclxuXHJcblx0XHRcdHRoaXMudGV4dHVyZXMuYWRkQ2hpbGQobWVzaCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gRHJhdyB0aGUgdGVycmFpbiBlZGdlc1xyXG5cdFx0aWYodGhpcy5jb25maWcudGV4R3JvdW5kRWRnZSAhPSBcIlwiKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGV4dHVyZSAgICA9IHRoaXMuYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4R3JvdW5kRWRnZSk7XHJcblx0XHRcdHZhciB2ZXJ0aWNlcyAgID0gbmV3IEZsb2F0MzJBcnJheSgyICogOCAqIHNlZ21lbnRzLmxlbmd0aCk7XHJcblx0XHRcdHZhciB1dnMgICAgICAgID0gbmV3IEZsb2F0MzJBcnJheSgyICogOCAqIHNlZ21lbnRzLmxlbmd0aCk7XHJcblx0XHRcdHZhciBpbmRpY2VzICAgID0gbmV3IFVpbnQxNkFycmF5ICgyICogNiAqIHNlZ21lbnRzLmxlbmd0aCk7XHJcblxyXG5cdFx0XHRmb3IodmFyIHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHRvdGFsIGxlbmd0aCBvZiB0aGUgc2VnbWVudFxyXG5cdFx0XHRcdHZhciBzZWdtZW50TGVuZ3RoICA9IDA7XHJcblxyXG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aCAtMTsgaSsrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciB2ID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudHNbc10ucG9pbnRzW2ldLnggIC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueCwgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgLSBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55KTtcclxuXHRcdFx0XHRcdHNlZ21lbnRMZW5ndGggKz0gdi5nZXRMZW5ndGgoKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIENvdW50IGhvdyBtYW55IHRpbWVzIHRoZSB0ZXh0dXJlIGNhbiBmaXQgaW4gdGhlIHNlZ21lbnQgbGVuZ3RoLCB0aGVuIHJvdW5kIGl0IHRvIGFkanVzdCB0aGUgdGV4dHVyZSBzaXplXHJcblx0XHRcdFx0dmFyIHRleHR1cmVTaXplID0gc2VnbWVudExlbmd0aC8gTWF0aC5yb3VuZChzZWdtZW50TGVuZ3RoIC8gdGV4dHVyZVNpemVPcik7XHJcblxyXG5cdFx0XHRcdC8vIExlZnQgZWRnZVxyXG5cdFx0XHRcdGlmKHMgPiAwIHx8ICh0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcImxlZnRcIiB8fCB0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcIlwiKSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgcCA9IHNlZ21lbnRzW3NdLnBvaW50c1swXTtcclxuXHRcdFx0XHRcdHZhciBuID0gc2VnbWVudHNbc10ubm9ybWFsc1swXTtcclxuXHRcdFx0XHRcdHZhciB2ID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudHNbc10ucG9pbnRzWzBdLnggLSBzZWdtZW50c1tzXS5wb2ludHNbMV0ueCwgc2VnbWVudHNbc10ucG9pbnRzWzBdLnkgLSBzZWdtZW50c1tzXS5wb2ludHNbMV0ueSk7XHJcblx0XHRcdFx0XHR2Lm5vcm1hbGl6ZSgpO1xyXG5cclxuXHRcdFx0XHRcdHZlcnRpY2VzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0cC54IC0gbi54ICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpICsodi54ICogdGV4dHVyZVNpemUpLCAgICAgcC55IC0gbi55ICogKHRleHR1cmVTaXplT3IgKiB0ZXh0dXJlVG9wUGVyYyAgICAgLSh2LnkgKiB0ZXh0dXJlU2l6ZU9yKSksXHJcblx0XHRcdFx0XHRcdHAueCAtIG4ueCAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSwgICAgICAgICAgICAgICAgICAgICAgICAgIHAueSAtIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogdGV4dHVyZVRvcFBlcmMpLFxyXG5cdFx0XHRcdFx0XHRwLnggKyBuLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLCAgICAgICAgICAgICAgICAgICAgICBwLnkgKyBuLnkgKiAodGV4dHVyZVNpemVPciAqICgxLXRleHR1cmVUb3BQZXJjKSksXHJcblx0XHRcdFx0XHRcdHAueCArIG4ueCAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSkgKyh2LnggKiB0ZXh0dXJlU2l6ZSksIHAueSArIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogKDEtdGV4dHVyZVRvcFBlcmMpICsodi55ICogdGV4dHVyZVNpemVPcikpXHJcblx0XHRcdFx0XHRdLCBzKjgqMik7XHJcblxyXG5cdFx0XHRcdFx0dXZzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0MCwgMCxcclxuXHRcdFx0XHRcdFx0MSwgMCxcclxuXHRcdFx0XHRcdFx0MSwgMSxcclxuXHRcdFx0XHRcdFx0MCwgMVxyXG5cdFx0XHRcdFx0XSwgcyo4KjIpO1xyXG5cclxuXHRcdFx0XHRcdGluZGljZXMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHQwICsgKHMqMikgKjQsXHJcblx0XHRcdFx0XHRcdDEgKyAocyoyKSAqNCxcclxuXHRcdFx0XHRcdFx0MiArIChzKjIpICo0LFxyXG5cdFx0XHRcdFx0XHQwICsgKHMqMikgKjQsXHJcblx0XHRcdFx0XHRcdDIgKyAocyoyKSAqNCxcclxuXHRcdFx0XHRcdFx0MyArIChzKjIpICo0XHJcblx0XHRcdFx0XHRdLCBzKjYqMik7XHJcblxyXG5cdFx0XHRcdFx0Ly8gV2lyZWZyYW1lXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMSwgMHgwMGZmMDAsIDAuNSk7XHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odmVydGljZXNbcyoyKjgrMCoyXSwgdmVydGljZXNbcyoyKjgrMCoyKzFdKTsgLy8gMFxyXG5cdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzEqMl0sIHZlcnRpY2VzW3MqMio4KzEqMisxXSk7IC8vIDFcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1tzKjIqOCsyKjJdLCB2ZXJ0aWNlc1tzKjIqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbcyoyKjgrMyoyXSwgdmVydGljZXNbcyoyKjgrMyoyKzFdKTsgLy8gM1xyXG5cdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzAqMl0sIHZlcnRpY2VzW3MqMio4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1tzKjIqOCsyKjJdLCB2ZXJ0aWNlc1tzKjIqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBSaWdodCBlZGdlXHJcblx0XHRcdFx0aWYocyA8IHNlZ21lbnRzLmxlbmd0aC0xIHx8ICh0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcInJpZ2h0XCIgfHwgdGhpcy5jb25maWcudGV4R3JvdW5kRWRnZVNpZGUgPT0gXCJcIikpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIGwgPSBzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aC0xO1xyXG5cdFx0XHRcdFx0dmFyIHAgPSBzZWdtZW50c1tzXS5wb2ludHNbc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGgtMV07XHJcblx0XHRcdFx0XHR2YXIgbiA9IHNlZ21lbnRzW3NdLm5vcm1hbHNbc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGgtMV07XHJcblx0XHRcdFx0XHR2YXIgdiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnRzW3NdLnBvaW50c1tsXS54IC0gc2VnbWVudHNbc10ucG9pbnRzW2wtMV0ueCwgc2VnbWVudHNbc10ucG9pbnRzW2xdLnkgLSBzZWdtZW50c1tzXS5wb2ludHNbbC0xXS55KTtcclxuXHRcdFx0XHRcdHYubm9ybWFsaXplKCk7XHJcblxyXG5cdFx0XHRcdFx0dmVydGljZXMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHRwLnggLSBuLnggKiAodGV4dHVyZVNpemUgKiB0ZXh0dXJlVG9wUGVyYykgKyh2LnggKiB0ZXh0dXJlU2l6ZSksICAgICBwLnkgLSBuLnkgKiAodGV4dHVyZVNpemVPciAqIHRleHR1cmVUb3BQZXJjIC0odi55ICogdGV4dHVyZVNpemVPcikpLFxyXG5cdFx0XHRcdFx0XHRwLnggLSBuLnggKiAodGV4dHVyZVNpemUgKiB0ZXh0dXJlVG9wUGVyYyksICAgICAgICAgICAgICAgICAgICAgICAgICBwLnkgLSBuLnkgKiAodGV4dHVyZVNpemVPciAqIHRleHR1cmVUb3BQZXJjKSxcclxuXHRcdFx0XHRcdFx0cC54ICsgbi54ICogKHRleHR1cmVTaXplICogKDEtdGV4dHVyZVRvcFBlcmMpKSwgICAgICAgICAgICAgICAgICAgICAgcC55ICsgbi55ICogKHRleHR1cmVTaXplT3IgKiAoMS10ZXh0dXJlVG9wUGVyYykpLFxyXG5cdFx0XHRcdFx0XHRwLnggKyBuLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpICsodi54ICogdGV4dHVyZVNpemUpLCBwLnkgKyBuLnkgKiAodGV4dHVyZVNpemVPciAqICgxLXRleHR1cmVUb3BQZXJjKSsodi55ICogdGV4dHVyZVNpemVPcikpXHJcblx0XHRcdFx0XHRdLCAocyoyKzEpKjgpO1xyXG5cclxuXHRcdFx0XHRcdHV2cy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdDAsIDAsXHJcblx0XHRcdFx0XHRcdDEsIDAsXHJcblx0XHRcdFx0XHRcdDEsIDEsXHJcblx0XHRcdFx0XHRcdDAsIDFcclxuXHRcdFx0XHRcdF0sIChzKjIrMSkqOCk7XHJcblxyXG5cdFx0XHRcdFx0aW5kaWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdDAgKyAocyoyKzEpICo0LFxyXG5cdFx0XHRcdFx0XHQxICsgKHMqMisxKSAqNCxcclxuXHRcdFx0XHRcdFx0MiArIChzKjIrMSkgKjQsXHJcblx0XHRcdFx0XHRcdDAgKyAocyoyKzEpICo0LFxyXG5cdFx0XHRcdFx0XHQyICsgKHMqMisxKSAqNCxcclxuXHRcdFx0XHRcdFx0MyArIChzKjIrMSkgKjRcclxuXHRcdFx0XHRcdF0sIChzKjIrMSkqNik7XHJcblxyXG5cdFx0XHRcdFx0Ly8gV2lyZWZyYW1lXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMSwgMHgwMGZmMDAsIDAuNSk7XHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odmVydGljZXNbKHMqMisxKSo4KzAqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzEqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCsxKjIrMV0pOyAvLyAxXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzIqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzMqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCszKjIrMV0pOyAvLyAzXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzAqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzIqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgbWVzaCA9IG5ldyBQSVhJLm1lc2guTWVzaFxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGV4dHVyZSxcclxuXHRcdFx0XHR2ZXJ0aWNlcyxcclxuXHRcdFx0XHR1dnMsXHJcblx0XHRcdFx0aW5kaWNlcyxcclxuXHRcdFx0XHRQSVhJLm1lc2guTWVzaC5EUkFXX01PREVTLlRSSUFOR0xFU1xyXG5cdFx0XHQpO1xyXG5cdFx0XHR0aGlzLnRleHR1cmVzLmFkZENoaWxkKG1lc2gpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gRHJhdyBiZXppZXJcclxuXHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odGhpcy5iZXppZXIucG9pbnRzWzBdLngsIHRoaXMuYmV6aWVyLnBvaW50c1swXS55KTtcclxuXHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMiwgMHhmZjAwMDApO1xyXG5cdGZvcih2YXIgaSA9IDE7IGkgPCB0aGlzLmJlemllci5wb2ludHMubGVuZ3RoOyBpICs9MylcclxuXHR7XHJcblx0XHR0aGlzLndpcmVmcmFtZS5iZXppZXJDdXJ2ZVRvKHRoaXMuYmV6aWVyLnBvaW50c1tpXS54LCB0aGlzLmJlemllci5wb2ludHNbaV0ueSwgdGhpcy5iZXppZXIucG9pbnRzW2krMV0ueCwgdGhpcy5iZXppZXIucG9pbnRzW2krMV0ueSwgdGhpcy5iZXppZXIucG9pbnRzW2krMl0ueCwgdGhpcy5iZXppZXIucG9pbnRzW2krMl0ueSk7XHJcblx0fVxyXG5cclxuXHQvLyBEcmF3IGFuY29yc1xyXG5cdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgyLCAweDk5MDAwMCwgMC41KTtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aC0xOyBpICs9IDMpXHJcblx0e1xyXG5cdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHRoaXMuYmV6aWVyLnBvaW50c1tpXS54LCB0aGlzLmJlemllci5wb2ludHNbaV0ueSk7XHJcblx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odGhpcy5iZXppZXIucG9pbnRzW2krMV0ueCwgdGhpcy5iZXppZXIucG9pbnRzW2krMV0ueSk7XHJcblxyXG5cdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHRoaXMuYmV6aWVyLnBvaW50c1tpKzJdLngsIHRoaXMuYmV6aWVyLnBvaW50c1tpKzJdLnkpO1xyXG5cdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHRoaXMuYmV6aWVyLnBvaW50c1tpKzNdLngsIHRoaXMuYmV6aWVyLnBvaW50c1tpKzNdLnkpO1xyXG5cdH1cclxuXHJcblx0Ly8gRHJhdyBtYWluIHBvaW50c1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmJlemllci5wb2ludHMubGVuZ3RoOyBpICsrKVxyXG5cdHtcclxuXHRcdGlmKGklMyAhPSAwKSBjb250aW51ZTtcclxuXHJcblx0XHRpZihpID09IHRoaXMucG9pbnRJbmRleClcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDIsIDB4MDBmZjAwICwgMSk7XHJcblx0XHRlbHNlXHJcblx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgwLCAweGZmMDAwMCwgMCk7XHJcblxyXG5cdFx0dGhpcy53aXJlZnJhbWUuYmVnaW5GaWxsKDB4ZmYwMDAwKTtcclxuXHRcdHRoaXMud2lyZWZyYW1lLmRyYXdDaXJjbGUodGhpcy5iZXppZXIucG9pbnRzW2ldLngsICB0aGlzLmJlemllci5wb2ludHNbaV0ueSwgNSk7XHJcblx0XHR0aGlzLndpcmVmcmFtZS5lbmRGaWxsKCk7XHJcblx0fVxyXG5cclxuXHQvLyBEcmF3IGFuY2hvciBwb2ludHNcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aDsgaSArKylcclxuXHR7XHJcblx0XHRpZihpJTMgPT0gMCkgY29udGludWU7XHJcblxyXG5cdFx0aWYoaSA9PSB0aGlzLnBvaW50SW5kZXgpXHJcblx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgyLCAweDAwZmYwMCAsIDEpO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMCwgMHhmZjAwMDAsIDApO1xyXG5cclxuXHRcdHRoaXMud2lyZWZyYW1lLmJlZ2luRmlsbCgweDk5MDA5OSk7XHJcblx0XHR0aGlzLndpcmVmcmFtZS5kcmF3Q2lyY2xlKHRoaXMuYmV6aWVyLnBvaW50c1tpXS54LCAgdGhpcy5iZXppZXIucG9pbnRzW2ldLnksIDMpO1xyXG5cdFx0dGhpcy53aXJlZnJhbWUuZW5kRmlsbCgpO1xyXG5cdH1cclxuXHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLnRleHR1cmVzKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMud2lyZWZyYW1lKTtcclxuXHJcblx0Ly8gU3RhdHVzXHJcblx0dGhpcy53aXJlZnJhbWUudmlzaWJsZSA9IHRoaXMubGF5ZXIuc2VsZWN0ZWQgPT0gdGhpcztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUucmVuZGVyR1VJID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5lZGl0b3IucmVuZGVyR1VJKFwicGF0aFwiKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUuYmFjayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGF5ZXIuc2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHRpZih0aGlzLmJlemllci5wb2ludHMubGVuZ3RoIDw9IDEpXHJcblx0e1xyXG5cdFx0dGhpcy5sYXllci5kZWxldGVQYXRoKHRoaXMpO1xyXG5cdH1cclxuXHJcblx0Ly8gUmVzZXQgaGlzdG9yeVxyXG5cdHRoaXMuZWRpdG9yLmhpc3RvcnlBZGRTdGF0ZSgpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUuYWRkUG9pbnQgPSBmdW5jdGlvbih4LCB5LCBpbmRleClcclxue1xyXG5cdHggPSBNYXRoLnJvdW5kKHgvdGhpcy5lZGl0b3Iuc25hcEdyaWQpICogdGhpcy5lZGl0b3Iuc25hcEdyaWQ7XHJcblx0eSA9IE1hdGgucm91bmQoeS90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZDtcclxuXHR0aGlzLmJlemllci5hZGRQb2ludCh4LHksaW5kZXgpO1xyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5kZWxldGVQb2ludCA9IGZ1bmN0aW9uKGluZGV4KVxyXG57XHJcblx0dmFyIGZpcnN0UG9pbnQgPSBpbmRleCA9PSAwO1xyXG5cdHZhciBsYXN0UG9pbnQgID0gaW5kZXggPT0gdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aC0xO1xyXG5cclxuXHRpZihmaXJzdFBvaW50KVxyXG5cdHtcclxuXHRcdHRoaXMuYmV6aWVyLmRlbGV0ZVBvaW50KGluZGV4KzIpO1xyXG5cdH1cclxuXHJcblx0aWYoIWxhc3RQb2ludClcclxuXHR7XHJcblx0XHR0aGlzLmJlemllci5kZWxldGVQb2ludChpbmRleCsxKTtcclxuXHR9XHJcblxyXG5cdHRoaXMuYmV6aWVyLmRlbGV0ZVBvaW50KGluZGV4KTtcclxuXHJcblx0aWYoIWZpcnN0UG9pbnQpXHJcblx0e1xyXG5cdFx0dGhpcy5iZXppZXIuZGVsZXRlUG9pbnQoaW5kZXgtMSk7XHJcblx0fVxyXG5cclxuXHRpZihsYXN0UG9pbnQpXHJcblx0e1xyXG5cdFx0dGhpcy5iZXppZXIuZGVsZXRlUG9pbnQoaW5kZXgtMik7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5tb3ZlUG9pbnQgPSBmdW5jdGlvbihpbmRleCwgeCwgeSlcclxue1xyXG5cdHZhciBvbGRQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KHRoaXMuYmV6aWVyLnBvaW50c1tpbmRleF0ueCwgdGhpcy5iZXppZXIucG9pbnRzW2luZGV4XS55KTtcclxuXHJcblx0dGhpcy5iZXppZXIucG9pbnRzW2luZGV4XS54ID0gTWF0aC5yb3VuZCh4L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkO1xyXG5cdHRoaXMuYmV6aWVyLnBvaW50c1tpbmRleF0ueSA9IE1hdGgucm91bmQoeS90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZDtcclxuXHJcblx0Ly8gTm90IG1vdmVkXHJcblx0aWYodGhpcy5iZXppZXIucG9pbnRzW2luZGV4XS54ID09IG9sZFBvc2l0aW9uLnggJiYgdGhpcy5iZXppZXIucG9pbnRzW2luZGV4XS55ID09IG9sZFBvc2l0aW9uLnkpIHJldHVybiBmYWxzZTtcclxuXHJcblx0Ly8gTW92ZSB0aGUgaGFuZGxlcyBpZiBtYWluIHBvaW50XHJcblx0aWYoaW5kZXggJSAzID09IDApXHJcblx0e1xyXG5cdFx0aWYoaW5kZXggPiAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmJlemllci5wb2ludHNbaW5kZXgtMV0ueCArPSB0aGlzLmJlemllci5wb2ludHNbaW5kZXhdLnggLSBvbGRQb3NpdGlvbi54O1xyXG5cdFx0XHR0aGlzLmJlemllci5wb2ludHNbaW5kZXgtMV0ueSArPSB0aGlzLmJlemllci5wb2ludHNbaW5kZXhdLnkgLSBvbGRQb3NpdGlvbi55O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKGluZGV4IDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aC0xKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmJlemllci5wb2ludHNbaW5kZXgrMV0ueCArPSB0aGlzLmJlemllci5wb2ludHNbaW5kZXhdLnggLSBvbGRQb3NpdGlvbi54O1xyXG5cdFx0XHR0aGlzLmJlemllci5wb2ludHNbaW5kZXgrMV0ueSArPSB0aGlzLmJlemllci5wb2ludHNbaW5kZXhdLnkgLSBvbGRQb3NpdGlvbi55O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLmdldFBvaW50QXQgPSBmdW5jdGlvbih4LCB5KVxyXG57XHJcblx0eCA9IE1hdGgucm91bmQoeC90aGlzLmVkaXRvci5zbmFwR3JpZCkgKiB0aGlzLmVkaXRvci5zbmFwR3JpZDtcclxuXHR5ID0gTWF0aC5yb3VuZCh5L3RoaXMuZWRpdG9yLnNuYXBHcmlkKSAqIHRoaXMuZWRpdG9yLnNuYXBHcmlkO1xyXG5cclxuXHQvLyBDaGVjayBhbmNob3IgcG9pbnRzIGZpcnN0XHJcblx0Zm9yKHZhciBpID0gdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aC0xOyBpID49IDA7IGktLSlcclxuXHR7XHJcblx0XHRpZihpJTMgPT0gMCkgY29udGludWU7XHJcblx0XHRpZih0aGlzLmJlemllci5wb2ludHNbaV0ueCA9PSB4ICYmIHRoaXMuYmV6aWVyLnBvaW50c1tpXS55ID09IHkpIHJldHVybiBpO1xyXG5cdH1cclxuXHJcblx0Ly8gSWYgbm8gYW5jaG9yIHBvaW50cyBoYXZlIGJlZW4gZm91bmQgbG9vayBhdCB0aGUgbWFpbiBwb2ludHNcclxuXHRmb3IodmFyIGkgPSB0aGlzLmJlemllci5wb2ludHMubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKVxyXG5cdHtcclxuXHRcdGlmKGklMyAhPSAwKSBjb250aW51ZTtcclxuXHRcdGlmKHRoaXMuYmV6aWVyLnBvaW50c1tpXS54ID09IHggJiYgdGhpcy5iZXppZXIucG9pbnRzW2ldLnkgPT0geSkgcmV0dXJuIGk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gLTE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbih4LCB5KVxyXG57XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYmV6aWVyLnBvaW50cy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLmJlemllci5wb2ludHNbaV0ueCArPSB4O1xyXG5cdFx0dGhpcy5iZXppZXIucG9pbnRzW2ldLnkgKz0geTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLnNldENvbmZpZyA9IGZ1bmN0aW9uKHBhcmFtZXRlciwgdmFsdWUsIHNhdmVTdGF0ZSlcclxue1xyXG5cdHRoaXMuY29uZmlnW3BhcmFtZXRlcl0gPSB2YWx1ZTtcclxuXHJcblx0aWYoc2F2ZVN0YXRlKVxyXG5cdFx0dGhpcy5lZGl0b3IuaGlzdG9yeUFkZFN0YXRlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLmV4cG9ydCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBvdXRwdXQgICAgICA9IGpRdWVyeS5leHRlbmQodHJ1ZSwge30sIHRoaXMuY29uZmlnKTtcclxuXHRvdXRwdXQucG9pbnRzICAgPSB0aGlzLmJlemllci5wb2ludHM7XHJcblx0b3V0cHV0LmJvdW5kcyAgID0gW251bGwsIG51bGxdO1xyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdG91dHB1dC5ib3VuZHNbMF0gPSBvdXRwdXQuYm91bmRzWzBdID09PSBudWxsID8gdGhpcy5iZXppZXIucG9pbnRzW2ldLnggOiBNYXRoLm1pbihvdXRwdXQuYm91bmRzWzBdLCB0aGlzLmJlemllci5wb2ludHNbaV0ueCk7XHJcblx0XHRvdXRwdXQuYm91bmRzWzFdID0gb3V0cHV0LmJvdW5kc1sxXSA9PT0gbnVsbCA/IHRoaXMuYmV6aWVyLnBvaW50c1tpXS54IDogTWF0aC5tYXgob3V0cHV0LmJvdW5kc1sxXSwgdGhpcy5iZXppZXIucG9pbnRzW2ldLngpO1xyXG5cdH1cclxuXHJcblx0aWYodGhpcy5sYXllci5zZWxlY3RlZCA9PSB0aGlzKVxyXG5cdHtcclxuXHRcdG91dHB1dC5zZWxlY3RlZCA9IHRydWU7XHJcblx0XHRvdXRwdXQucG9pbnRJbmRleCA9IHRoaXMucG9pbnRJbmRleDtcclxuXHR9XHJcblxyXG5cdHJldHVybiBvdXRwdXQ7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5pbXBvcnQgPSBmdW5jdGlvbihzYXZlKVxyXG57XHJcblx0dGhpcy5jb25maWcuY2xvc2VkICAgICAgICAgICAgPSBzYXZlLmNsb3NlZDtcclxuXHR0aGlzLmNvbmZpZy5kZXB0aCAgICAgICAgICAgICA9IHNhdmUuZGVwdGg7XHJcblx0dGhpcy5jb25maWcuY29sbGlzaW9ucyAgICAgICAgPSBzYXZlLmNvbGxpc2lvbnM7XHJcblx0dGhpcy5jb25maWcudGV4RmlsbCAgICAgICAgICAgPSBzYXZlLnRleEZpbGw7XHJcblx0dGhpcy5jb25maWcudGV4R3JvdW5kICAgICAgICAgPSBzYXZlLnRleEdyb3VuZDtcclxuXHR0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlICAgICA9IHNhdmUudGV4R3JvdW5kRWRnZTtcclxuXHR0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9IHNhdmUudGV4R3JvdW5kRWRnZVNpZGU7XHJcblx0dGhpcy5jb25maWcudGV4V2FsbCAgICAgICAgICAgPSBzYXZlLnRleFdhbGw7XHJcblx0dGhpcy5jb25maWcudGV4RmlsbFBhZGRpbmcgICAgPSBzYXZlLnRleEZpbGxQYWRkaW5nO1xyXG5cdHRoaXMuY29uZmlnLnRleEZpbGxTaXplICAgICAgID0gc2F2ZS50ZXhGaWxsU2l6ZTtcclxuXHR0aGlzLmNvbmZpZy50ZXhHcm91bmRTaXplICAgICA9IHNhdmUudGV4R3JvdW5kU2l6ZTtcclxuXHR0aGlzLmNvbmZpZy50ZXhHcm91bmREZWx0YSAgICA9IHNhdmUudGV4R3JvdW5kRGVsdGE7XHJcblx0dGhpcy5jb25maWcudGV4V2FsbFNpemUgICAgICAgPSBzYXZlLnRleFdhbGxTaXplO1xyXG5cdHRoaXMuY29uZmlnLnRleFdhbGxEZWx0YSAgICAgID0gc2F2ZS50ZXhXYWxsRGVsdGE7XHJcblx0dGhpcy5jb25maWcudGV4V2FsbEFuZ2xlICAgICAgPSBzYXZlLnRleFdhbGxBbmdsZTtcclxuXHR0aGlzLmNvbmZpZy5kYXRhICAgICAgICAgICAgICA9IHNhdmUuZGF0YTtcclxuXHJcblx0aWYoISFzYXZlLnNlbGVjdGVkKVxyXG5cdHtcclxuXHRcdHRoaXMubGF5ZXIuc2VsZWN0ZWQgPSB0aGlzO1xyXG5cdFx0dGhpcy5wb2ludEluZGV4ID0gc2F2ZS5wb2ludEluZGV4O1xyXG5cdH1cclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHNhdmUucG9pbnRzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHRoaXMuYmV6aWVyLmFkZFBvaW50KHNhdmUucG9pbnRzW2ldLngsIHNhdmUucG9pbnRzW2ldLnkpO1xyXG5cdH1cclxufSIsInZhciBDb21tb24gICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBSdW5uaW5nRW50aXR5ICA9IHJlcXVpcmUoXCIuL1J1bm5pbmdFbnRpdHlcIik7XHJcbnZhciBFbWl0dGVyICAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG52YXIgT2JqZWN0QXhlICAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0QXhlXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIEF2YXRhcigpXHJcbntcclxuXHRSdW5uaW5nRW50aXR5LmNhbGwodGhpcywgXCJhdmF0YXJcIik7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgICAgICAgICA9IG51bGw7XHJcblx0dGhpcy5hbGxvd1BhdGhDb2xsaXNpb25zID0gdHJ1ZTtcclxuXHJcblx0dGhpcy5zcGluZURhdGEgPSBDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX2ZlbWFsZTtcclxuXHR0aGlzLmN1cnJlbnRBbmltYXRpb25cdD0gXCJcIjtcclxuXHR0aGlzLnNwaW5lU3BlZWQgPSAxO1xyXG5cclxuXHR0aGlzLl9jaGFyYWN0ZXJEYXRhID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuY2hhcmFjdGVyc1tDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcl07XHJcblx0dGhpcy5fcG93ZXJ1cHNEYXRhICA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLnBvd2VydXBzO1xyXG5cclxuXHR0aGlzLmNvbmZpZyA9XHJcblx0e1xyXG5cdFx0ZGVwdGggOiAwLFxyXG5cdH1cclxuXHJcblx0dGhpcy5hYmlsaXRpZXMgPVxyXG5cdHtcclxuXHRcdGRvdWJsZUp1bXAgICAgICA6IGZhbHNlLFxyXG5cdFx0YnJpZGdlICAgICAgICAgIDogZmFsc2UsXHJcblx0XHRzbGFzaCAgICAgICAgICAgOiBmYWxzZSxcclxuXHRcdHNocmluayAgICAgICAgICA6IGZhbHNlLFxyXG5cdFx0aW52dWxuZXJhYmlsaXR5IDogZmFsc2VcclxuXHR9XHJcblxyXG5cdHRoaXMuYXJlSW5wdXRBY3RpdmUgPSB0cnVlO1xyXG5cclxuXHR0aGlzLmlzRGVhZCAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmlzSW1tb3J0YWwgPSBmYWxzZTtcclxuXHR0aGlzLmlzR3JvdW5kZWQgPSBmYWxzZTtcclxuXHR0aGlzLnZlbG9jaXR5ICAgPSBuZXcgcDMuVmVjdG9yMigwLjAsIDAuMCk7XHJcblxyXG5cdHRoaXMuanVtcFRpbWUgICAgICAgICAgICAgID0gMC40NTtcclxuXHR0aGlzLmp1bXBIZWlnaHRNaW4gICAgICAgICA9IDEyNTtcclxuXHR0aGlzLmp1bXBIZWlnaHQgICAgICAgICAgICA9IDMwMDtcclxuXHR0aGlzLmRvdWJsZUp1bXBIZWlnaHRNaW4gICA9IDEwMDtcclxuXHR0aGlzLmRvdWJsZUp1bXBIZWlnaHQgICAgICA9IDIwMDtcclxuXHR0aGlzLmp1bXBTbG9wZUFuZ2xlTWF4ICAgICA9IDY1O1xyXG5cclxuXHR0aGlzLnJ1blNwZWVkTWluICAgICAgICAgICA9IDYwMC4wO1xyXG5cdHRoaXMucnVuU3BlZWRNYXggICAgICAgICAgID0gOTAwLjA7XHJcblx0dGhpcy5zbGlkaW5nU3BlZWRNYXggICAgICAgPSAxMjAwLjA7XHJcblx0dGhpcy5hY2NlbGVyYXRpb25TbGlkaW5nICAgPSAzNTA7XHJcblx0dGhpcy5hY2NlbGVyYXRpb25TbG9wZURvd24gPSAxMDA7XHJcblx0dGhpcy5hY2NlbGVyYXRpb25TbG9wZVVwICAgPSAtNTAwO1xyXG5cdHRoaXMuYWNjZWxlcmF0aW9uTm9ybWFsICAgID0gLTIwMDtcclxuXHR0aGlzLnJ1blNwZWVkICAgICAgICAgICAgICA9IHRoaXMucnVuU3BlZWRNaW47XHJcblxyXG5cdHRoaXMuZmFsbFRpbWUgICAgICAgICAgICAgID0gMDtcclxuXHR0aGlzLmZhbGxUaW1lVG9MYW5kICAgICAgICA9IDAuNztcclxuXHJcblx0dGhpcy5pc1NsaWRpbmcgICAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLnRpbWVVbnNsaWRpbmcgICAgICAgICA9IDA7XHJcblx0dGhpcy50aW1lVW5zbGlkaW5nRW5kICAgICAgPSAwLjQ7XHJcblx0dGhpcy5zbGlkaW5nQW5nbGVTdGFydCAgICAgPSAzNTtcclxuXHR0aGlzLnNsaWRpbmdBbmdsZUVuZCAgICAgICA9IDE1O1xyXG5cdHRoaXMuc2xpZGluZ1NGWCAgICAgICAgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5jYW5UdW1ibGUgICAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmlzVHVtYmxpbmcgICAgICAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMudHVtYmxlU3BlZWQgICAgICAgICAgID0gMDtcclxuXHR0aGlzLnR1bWJsZVNwZWVkTWluICAgICAgICA9IDE4MDtcclxuXHR0aGlzLnR1bWJsZVNwZWVkTWF4ICAgICAgICA9IDcyMDtcclxuXHR0aGlzLnR1bWJsZVNwZWVkVGltZSAgICAgICA9IDAuNDtcclxuXHR0aGlzLnR1bWJsZUFuZ2xlICAgICAgICAgICA9IDA7XHJcblx0dGhpcy50dW1ibGVTcGVlZFlTdGFydCAgICAgPSAwOyAvLyBUaGUgdmVydGljYWwgc3BlZWQgYXQgd2hpY2ggdGhlIHR1bWJsaW5nIHN0YXJ0c1xyXG5cdHRoaXMudHVtYmxlRGVhdGhBbmdsZSAgICAgID0ge21pbjoxMzAsIG1heDoxMzB9OyAvLyBEaXNhYmxlZCBiZWNhdXNlIGl0J3MgdG9vIGhhcmQsIHBvb3IgdGhpbmdzXHJcblxyXG5cdHRoaXMuY2FuQ3JlYXRlQnJpZGdlICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5pZ25vcmVBcnRpZmljaWFsUGF0aHMgPSBmYWxzZTtcclxuXHJcblx0dGhpcy5pc1NsYXNoaW5nICAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLnNsYXNoVGltZSAgICAgICAgICAgICA9IDA7XHJcblx0dGhpcy5zbGFzaFRpbWVNYXggICAgICAgICAgPSAxLjU7XHJcblx0dGhpcy5zbGFzaFNGWCAgICAgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuYXhlICAgICAgICAgICAgICAgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5pc1Nocmlua2luZyAgICAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmlzVW5zaHJpbmtpbmcgICAgICAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuc2hyaW5rVGltZSAgICAgICAgICAgICAgID0gMDtcclxuXHR0aGlzLnNocmlua1RpbWVNYXggICAgICAgICAgICA9IDU7XHJcblx0dGhpcy5zaHJpbmtUcmFuc2l0aW9uVGltZSAgICAgPSAwLjI1O1xyXG5cdHRoaXMuaXNTaHJpbmtMb2NrZWQgICAgICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5wb3NpdGlvbkNhY2hlICAgICAgICAgICAgPSBbXTtcclxuXHR0aGlzLnNocmlua1BpZWNlRGVsYXkgICAgICAgICA9IDAuMDc1O1xyXG5cdHRoaXMuc2hyaW5rUGllY2VSb3RhdGlvblNwZWVkID0gMTQ0MDtcclxuXHJcblx0dGhpcy5pc0ludnVsbmVyYWJsZSAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmludnVsbmVyYWJpbGl0eVRpbWUgICAgICA9IDA7XHJcblx0dGhpcy5pbnZ1bG5lcmFiaWxpdHlUaW1lTWF4ICAgPSAxLjU7XHJcblxyXG5cdHRoaXMuaXNSaWRpbmdWZWhpY2xlICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy52ZWhpY2xlICAgICAgICAgICAgICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLnJ1blVwQW5nbGUgICAgICAgICAgICA9IC01MDtcclxuXHR0aGlzLnJ1bkRvd25BbmdsZSAgICAgICAgICA9IDEwO1xyXG5cclxuXHR0aGlzLnJvdGF0aW9uICAgICAgICAgICAgICA9IDA7XHJcblx0dGhpcy5hbmdsZVRhcmdldCAgICAgICAgICAgPSAwO1xyXG5cdHRoaXMuYW5nbGVTcGVlZCAgICAgICAgICAgID0gMC4xO1xyXG5cclxuXHR0aGlzLmhlYWRib2JUaW1lICAgICAgICAgICA9IDA7XHJcblx0dGhpcy5oZWFkYm9iRnJlcXVlbmN5ICAgICAgPSAxMTtcclxuXHR0aGlzLmhlYWRib2JIZWlnaHQgICAgICAgICA9IDE1O1xyXG5cclxuXHR0aGlzLmNvbGxpc2lvbkNpcmNsZVJhZGl1cyA9IDU1O1xyXG5cdHRoaXMucGlja3VwQ2lyY2xlICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLnBpY2t1cENpcmNsZVJhZGl1cyAgICA9IDcwO1xyXG5cdHRoaXMuYXhlQ2lyY2xlICAgICAgICAgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5pc1Ryb2xsTWFnaWMgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLnRyb2xsTWFnaWNUaW1lICAgICA9IDA7XHJcblx0dGhpcy50cm9sbE1hZ2ljRHVyYXRpb24gPSAxMDtcclxuXHJcblx0dGhpcy5mb2N1c1BvaW50TGFuZCAgICAgICAgPSB7cG9pbnQ6IG5ldyBQSVhJLlBvaW50KDAuMzAsIDAuNjApLCB0aW1lIDogMS40LCBkZWxheTogMH07XHJcblx0dGhpcy5mb2N1c1BvaW50SnVtcCAgICAgICAgPSB7cG9pbnQ6IG5ldyBQSVhJLlBvaW50KDAuMzIsIDAuNDUpLCB0aW1lIDogMC40LCBkZWxheTogMH07XHJcblx0dGhpcy5mb2N1c1BvaW50RmFsbCAgICAgICAgPSB7cG9pbnQ6IG5ldyBQSVhJLlBvaW50KDAuMzIsIDAuMzUpLCB0aW1lIDogMC40LCBkZWxheTogMC4xfTtcclxuXHR0aGlzLmZvY3VzUG9pbnRUdW1ibGUgICAgICA9IHtwb2ludDogbmV3IFBJWEkuUG9pbnQoMC4zMiwgMC4yNSksIHRpbWUgOiAwLjQsIGRlbGF5OiAwfTtcclxuXHR0aGlzLmZvY3VzUG9pbnRTbGlkZSAgICAgICA9IHtwb2ludDogbmV3IFBJWEkuUG9pbnQoMC4yOCwgMC41MCksIHRpbWUgOiAxLCBkZWxheTogMH07XHJcblx0dGhpcy5mb2N1c1BvaW50RGVhdGggICAgICAgPSB7cG9pbnQ6IG5ldyBQSVhJLlBvaW50KDAuNCwgMC42MCksICB0aW1lIDogMiwgZGVsYXk6IDB9O1xyXG5cdHRoaXMuem9vbVNsaWRlICAgICAgICAgICAgID0ge3pvb206LTAuMjUsIHRpbWU6IDF9O1xyXG5cdHRoaXMuem9vbVNsaWRlRW5kICAgICAgICAgID0ge3pvb206MCwgICAgIHRpbWU6IDEuNX07XHJcblx0dGhpcy56b29tRGVhdGggICAgICAgICAgICAgPSB7em9vbTorMC40LCAgdGltZTogMn07XHJcblxyXG5cdHRoaXMua0p1bXBTdGFydCAgICAgICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5rSnVtcFByZXNzZWQgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmtKdW1wRW5kICAgICAgICAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMua0FiaWxpdHkgICAgICAgICAgICAgID0gZmFsc2U7XHJcblxyXG5cdHRoaXMuc25vd1RyYWlsUFMgICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmRvdWJsZUp1bXBQUyAgICAgICAgICA9IG51bGw7XHJcblx0dGhpcy50cm9sbE1hZ2ljUFMgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuYnJpZGdlRmFpbE1hZ2ljUFMgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy53YWxrTG9vcCA9IFwiXCI7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBBdmF0YXI7XHJcbkF2YXRhci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFJ1bm5pbmdFbnRpdHkucHJvdG90eXBlKTtcclxuQXZhdGFyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEF2YXRhcjtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEluaXRcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGxldmVsKVxyXG57XHJcblx0dGhpcy5sZXZlbCA9IGxldmVsO1xyXG5cclxuXHR0aGlzLmluaXRDaGFyYWN0ZXIoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpO1xyXG5cclxuXHR0aGlzLnpvb21TbGlkZS56b29tICAgICs9IHRoaXMubGV2ZWwuZGVmYXVsdFpvb207XHJcblx0dGhpcy56b29tU2xpZGVFbmQuem9vbSArPSB0aGlzLmxldmVsLmRlZmF1bHRab29tO1xyXG5cdHRoaXMuem9vbURlYXRoLnpvb20gICAgKz0gdGhpcy5sZXZlbC5kZWZhdWx0Wm9vbTtcclxuXHJcblx0Ly8gQ29sbGlzaW9uIG1hc2tcclxuXHR0aGlzLmNvbGxpc2lvbkNpcmNsZSAgID0gbmV3IFBJWEkuQ2lyY2xlKDAsIDAsIHRoaXMuY29sbGlzaW9uQ2lyY2xlUmFkaXVzKTtcclxuXHR0aGlzLnBpY2t1cENpcmNsZSAgICAgID0gbmV3IFBJWEkuQ2lyY2xlKC0yMCwgLTIwLCB0aGlzLnBpY2t1cENpcmNsZVJhZGl1cyk7XHJcblx0dGhpcy5heGVDaXJjbGUgICAgICAgICA9IG5ldyBQSVhJLkNpcmNsZSg0MCwgLTMwLCAxMTApO1xyXG5cclxuXHQvLyBKdW1wXHJcblx0dGhpcy5qdW1wU3BlZWQgICAgID0gKDIgKiB0aGlzLmp1bXBIZWlnaHQpIC8gdGhpcy5qdW1wVGltZTtcclxuXHR0aGlzLmdyYXZpdHkgICAgICAgPSB0aGlzLmp1bXBTcGVlZC90aGlzLmp1bXBUaW1lO1xyXG5cdHRoaXMuanVtcFRpbWVNaW4gICA9IE1hdGguc3FydCgyICogdGhpcy5qdW1wSGVpZ2h0TWluL3RoaXMuZ3Jhdml0eSk7XHJcblx0dGhpcy5qdW1wU3BlZWRNaW4gID0gdGhpcy5ncmF2aXR5ICogdGhpcy5qdW1wVGltZU1pbjtcclxuXHJcblx0dGhpcy5kb3VibGVKdW1wVGltZU1pbiAgPSBNYXRoLnNxcnQoMiAqIHRoaXMuZG91YmxlSnVtcEhlaWdodE1pbi90aGlzLmdyYXZpdHkpO1xyXG5cdHRoaXMuZG91YmxlSnVtcFNwZWVkTWluID0gdGhpcy5ncmF2aXR5ICogdGhpcy5kb3VibGVKdW1wVGltZU1pbjtcclxuXHR0aGlzLmRvdWJsZUp1bXBUaW1lICAgICA9IE1hdGguc3FydCgyICogdGhpcy5kb3VibGVKdW1wSGVpZ2h0L3RoaXMuZ3Jhdml0eSk7XHJcblx0dGhpcy5kb3VibGVKdW1wU3BlZWQgICAgPSB0aGlzLmdyYXZpdHkgKiB0aGlzLmRvdWJsZUp1bXBUaW1lO1xyXG5cclxuXHQvLyBBbmltYXRpb25zXHJcblx0dGhpcy5hbmltYXRpb25Ib2xkZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuYW5pbWF0aW9uSG9sZGVyKTtcclxuXHJcblx0Ly8gU3BpbmVcclxuXHR0aGlzLnNwaW5lID0gbmV3IFBJWEkuc3BpbmUuU3BpbmUodGhpcy5zcGluZURhdGEpO1xyXG5cdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0VG9TZXR1cFBvc2UoKTtcclxuXHR0aGlzLnNwaW5lLnNrZWxldG9uLnNldFNraW4obnVsbCk7XHJcblx0dGhpcy5zcGluZS5za2VsZXRvbi5zZXRTa2luQnlOYW1lKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyKTtcclxuXHR0aGlzLnNwaW5lLnggPSAwO1xyXG5cdHRoaXMuc3BpbmUueSA9IHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cztcclxuXHR0aGlzLnNwaW5lLmF1dG9VcGRhdGUgPSBmYWxzZTtcclxuXHR0aGlzLnNwaW5lLnNjYWxlLnNldCgwLjUpO1xyXG5cdHRoaXMuYW5pbWF0aW9uSG9sZGVyLmFkZENoaWxkKHRoaXMuc3BpbmUpO1xyXG5cdHRoaXMuc2V0QW5pbWF0aW9uKCdmYWxsJywgdHJ1ZSk7XHJcblxyXG4gICAgdmFyIGFuaW1hdGlvbnMgPVxyXG5cdFtcclxuXHRcdCdydW5fZmxhdCcsXHJcblx0XHQncnVuX2ZsYXRfbWFnaWMnLFxyXG5cdFx0J3J1bl91cDInLFxyXG5cdFx0J3J1bl9kb3duJyxcclxuXHRcdCdydW5fZG93bl9zdGVlcCcsXHJcblx0XHQnc2xpZGVfZG93bl9zdGVlcCcsXHJcblx0XHQnc2xpZGVfZG93bl9leGl0JyxcclxuXHRcdCdqdW1wX25vcm1hbCcsXHJcblx0XHQnanVtcF9kb3VibGUnLFxyXG5cdFx0J2p1bXBfdHVjazInLFxyXG5cdFx0J2ZhbGwnLFxyXG5cdFx0J2xhbmQnLFxyXG5cdFx0J2xhbmRfYmFkJyxcclxuXHRcdCdyaWRlX3N2ZW4nLFxyXG5cdFx0J3JpZGVfc3Zlbl9mYWxsJyxcclxuXHRcdCdyaWRlX3NsZWQnLFxyXG5cdFx0J3JpZGVfc2xlZF9kb3duJyxcclxuXHRcdCdydW5fcm9sbCcsXHJcblx0XHQncnVuX2Rvd25fc3RlZXBfcm9sbGluZ19iYWxsJ1xyXG5cdF07XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBhbmltYXRpb25zLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBmb3VuZCA9IGZhbHNlO1xyXG5cdFx0Zm9yKHZhciB0ID0gMDsgdCA8IHRoaXMuc3BpbmUuc3BpbmVEYXRhLmFuaW1hdGlvbnMubGVuZ3RoOyB0KyspXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMuc3BpbmUuc3BpbmVEYXRhLmFuaW1hdGlvbnNbdF0ubmFtZSA9PSBhbmltYXRpb25zW2ldKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Zm91bmQgPSB0cnVlO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoIWZvdW5kKVxyXG5cdFx0e1xyXG5cdFx0XHRjb25zb2xlLmluZm8oXCJBbmltYXRpb24gJXMgbWlzc2luZ1wiLCBhbmltYXRpb25zW2ldKTtcclxuXHRcdFx0YW5pbWF0aW9ucy5zcGxpY2UoaSwxKTtcclxuXHRcdFx0aS0tO1xyXG5cdFx0XHRjb250aW51ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBhbmltYXRpb25zLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdGZvcih2YXIgaiA9IDA7IGogPCBhbmltYXRpb25zLmxlbmd0aDsgaisrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZihpID09IGopIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0aWYoYW5pbWF0aW9uc1tpXSA9PSBcImp1bXBfdHVjazJcIiB8fCBhbmltYXRpb25zW2pdID09IFwibGFuZF9iYWRcIiB8fCBhbmltYXRpb25zW2pdID09IFwianVtcF9kb3VibGVcIiB8fCAoYW5pbWF0aW9uc1tqXSA9PSBcInJ1bl9mbGF0X21hZ2ljXCIgJiYgdGhpcy5pc0tyaXN0b2ZmKCkpKVxyXG5cdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjEpO1xyXG5cdFx0XHRlbHNlIGlmKGFuaW1hdGlvbnNbal0gPT0gXCJsYW5kXCIpXHJcblx0XHRcdFx0dGhpcy5zcGluZS5zdGF0ZURhdGEuc2V0TWl4QnlOYW1lKGFuaW1hdGlvbnNbaV0sIGFuaW1hdGlvbnNbal0sIDApO1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0dGhpcy5zcGluZS5zdGF0ZURhdGEuc2V0TWl4QnlOYW1lKGFuaW1hdGlvbnNbaV0sIGFuaW1hdGlvbnNbal0sIDAuMik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHQvLyBQYXJ0aWNsZXNcclxuXHR0aGlzLnNub3dUcmFpbFBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5sZXZlbCxcclxuXHRbXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxyXG5cdF0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfc25vd19lbWl0dGVyX3YxXCIpKTtcclxuXHR0aGlzLnNub3dUcmFpbFBTLmVtaXQgPSBmYWxzZTtcclxuXHJcblx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHR7XHJcblx0XHR0aGlzLl9wYXJ0aWNsZU9yaWdpbiA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcblx0XHR0aGlzLl9wYXJ0aWNsZU9yaWdpbi5iZWdpbkZpbGwoMHhmZjAwMDApO1xyXG5cdFx0dGhpcy5fcGFydGljbGVPcmlnaW4uZHJhd0NpcmNsZSgwLCAwLCA0KTtcclxuXHRcdHRoaXMuX3BhcnRpY2xlT3JpZ2luLmVuZEZpbGwoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fcGFydGljbGVPcmlnaW4pO1xyXG5cdH1cclxuXHJcblx0dGhpcy5kb3VibGVKdW1wUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLmxldmVsLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAwXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDFcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAzXCIpXHJcblx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9kb3VibGVqdW1wXCIpKTtcclxuXHR0aGlzLmRvdWJsZUp1bXBQUy5lbWl0ID0gZmFsc2U7XHJcblxyXG5cdHRoaXMuYnJpZGdlRmFpbE1hZ2ljUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLmxldmVsLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAwXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDFcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAzXCIpXHJcblx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9kb3VibGVqdW1wXCIpKTtcclxuXHR0aGlzLmJyaWRnZUZhaWxNYWdpY1BTLmVtaXQgPSBmYWxzZTtcclxuXHJcblx0dGhpcy50cm9sbE1hZ2ljUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLmxldmVsLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV9vZmZzZXRfMDBcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV9vZmZzZXRfMDNcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21hZ2ljX3RyYWlsXCIpKTtcclxuXHR0aGlzLnRyb2xsTWFnaWNQUy5lbWl0ID0gZmFsc2U7XHJcblxyXG5cdC8vIERlYnVnXHJcblx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHR7XHJcblx0XHR0aGlzLmRyYXdDb2xsaXNpb24oKTtcclxuXHJcblx0XHR2YXIgcGlja3VwQ29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQocGlja3VwQ29sbGlzaW9uQ2lyY2xlKTtcclxuXHRcdHBpY2t1cENvbGxpc2lvbkNpcmNsZS5saW5lU3R5bGUoMSwgMHhGNzExMUQpO1xyXG5cdFx0cGlja3VwQ29sbGlzaW9uQ2lyY2xlLmRyYXdDaXJjbGUoMCwgMCwgdGhpcy5waWNrdXBDaXJjbGUucmFkaXVzKTtcclxuXHRcdHBpY2t1cENvbGxpc2lvbkNpcmNsZS54ID0gdGhpcy5waWNrdXBDaXJjbGUueDtcclxuXHRcdHBpY2t1cENvbGxpc2lvbkNpcmNsZS55ID0gdGhpcy5waWNrdXBDaXJjbGUueTtcclxuXHJcblx0XHR2YXIgYXhlQ29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQoYXhlQ29sbGlzaW9uQ2lyY2xlKTtcclxuXHRcdGF4ZUNvbGxpc2lvbkNpcmNsZS5saW5lU3R5bGUoMSwgMHgwMGZmMDApO1xyXG5cdFx0YXhlQ29sbGlzaW9uQ2lyY2xlLmRyYXdDaXJjbGUoMCwgMCwgdGhpcy5heGVDaXJjbGUucmFkaXVzKTtcclxuXHRcdGF4ZUNvbGxpc2lvbkNpcmNsZS54ID0gdGhpcy5heGVDaXJjbGUueDtcclxuXHRcdGF4ZUNvbGxpc2lvbkNpcmNsZS55ID0gdGhpcy5heGVDaXJjbGUueTtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBjaGFyYWN0ZXJcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUuaW5pdENoYXJhY3RlciA9IGZ1bmN0aW9uKGNoYXJhY3Rlcilcclxue1xyXG5cdHN3aXRjaChjaGFyYWN0ZXIpXHJcblx0e1xyXG5cdFx0Y2FzZSBcImFubmFcIjpcclxuXHRcdFx0dGhpcy5hYmlsaXRpZXMuZG91YmxlSnVtcCA9IHRydWU7XHJcblx0XHRcdHRoaXMuc3BpbmVEYXRhID0gQ29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9mZW1hbGU7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGNhc2UgXCJlbHNhXCI6XHJcblx0XHRcdHRoaXMuYWJpbGl0aWVzLmJyaWRnZSA9IHRydWU7XHJcblx0XHRcdHRoaXMuc3BpbmVEYXRhID0gQ29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9lbHNhO1xyXG5cdFx0XHRicmVhaztcclxuXHJcblx0XHRjYXNlIFwia3Jpc3RvZmZcIjpcclxuXHRcdFx0dGhpcy5hYmlsaXRpZXMuc2xhc2ggPSB0cnVlO1xyXG5cdFx0XHR0aGlzLnNwaW5lRGF0YSA9IENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfa3Jpc3RvZmY7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGNhc2UgXCJvbGFmXCI6XHJcblx0XHRcdHRoaXMuYWJpbGl0aWVzLnNocmluayA9IHRydWU7XHJcblx0XHRcdHRoaXMuc3BpbmVEYXRhID0gQ29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9vbGFmO1xyXG5cclxuXHRcdFx0dGhpcy5zaHJpbmtQaWVjZXMgPSBbXTtcclxuXHJcblx0XHRcdC8vIERlYnVnIHBpZWNlc1xyXG5cdFx0XHR2YXIgcGllY2VzID0gW1wib2xhZl9jaGVzdF91cHBlcl8wMVwiLCBcIm9sYWZfaGlwXzAxXCIsIFwib2xhZl9hbmtsZV9yXzAxXCIsIFwib2xhZl9hbmtsZV9sXzAxXCJdXHJcblxyXG5cdFx0XHRmb3IodmFyIGkgPSBwaWVjZXMubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHBpZWNlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHBpZWNlc1tpXSkpO1xyXG5cdFx0XHRcdHBpZWNlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRwaWVjZS5hbHBoYSA9IDA7XHJcblx0XHRcdFx0dGhpcy5hZGRDaGlsZChwaWVjZSk7XHJcblx0XHRcdFx0dGhpcy5zaHJpbmtQaWVjZXMucHVzaChwaWVjZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8qXHJcblx0XHRcdHZhciBwaWVjZXMgPVxyXG5cdFx0XHRbXHJcblx0XHRcdFx0e2NvbG9yOjB4RkYwMDAwLCBzaXplOjIwfSxcclxuXHRcdFx0XHR7Y29sb3I6MHgwMGZmMDAsIHNpemU6MTV9LFxyXG5cdFx0XHRcdHtjb2xvcjoweDAwMDBGRiwgc2l6ZToyMH1cclxuXHRcdFx0XTtcclxuXHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBwaWVjZXMubGVuZ3RoOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgcGllY2UgPSBuZXcgUElYSS5HcmFwaGljcygpO1xyXG5cdFx0XHRcdHRoaXMuYWRkQ2hpbGQocGllY2UpO1xyXG5cdFx0XHRcdHBpZWNlLmJlZ2luRmlsbChwaWVjZXNbaV0uY29sb3IpO1xyXG5cdFx0XHRcdHBpZWNlLmRyYXdDaXJjbGUoMCwgMCwgcGllY2VzW2ldLnNpemUpO1xyXG5cdFx0XHRcdHRoaXMuc2hyaW5rUGllY2VzLnB1c2gocGllY2UpO1xyXG5cdFx0XHRcdHBpZWNlLmFscGhhID0gMDtcclxuXHRcdFx0XHRwaWVjZS5lbmRGaWxsKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ki9cclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0Y2FzZSBcInBhYmJpZVwiOlxyXG5cdFx0XHR0aGlzLmFiaWxpdGllcy5pbnZ1bG5lcmFiaWxpdHkgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLnNwaW5lRGF0YSA9IENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfcGFiYmllO1xyXG5cdFx0XHR0aGlzLmNvbGxpc2lvbkNpcmNsZVJhZGl1cyA9IDQwO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcblxyXG5cclxuXHQvLyBBcHBseSBjaGFyYWN0ZXIgbW9kaWZpZXJzXHJcblx0aWYoISF0aGlzLl9jaGFyYWN0ZXJEYXRhLmp1bXBIZWlnaHQpICAgICAgICAgdGhpcy5qdW1wSGVpZ2h0ICAgICAgICAgPSB0aGlzLl9jaGFyYWN0ZXJEYXRhLmp1bXBIZWlnaHQ7XHJcblx0aWYoISF0aGlzLl9jaGFyYWN0ZXJEYXRhLmRvdWJsZUp1bXBIZWlnaHQpICAgdGhpcy5kb3VibGVKdW1wSGVpZ2h0ICAgPSB0aGlzLl9jaGFyYWN0ZXJEYXRhLmRvdWJsZUp1bXBIZWlnaHQ7XHJcblx0aWYoISF0aGlzLl9jaGFyYWN0ZXJEYXRhLnR1bWJsZVNwZWVkTWluKSAgICAgdGhpcy50dW1ibGVTcGVlZE1pbiAgICAgPSB0aGlzLl9jaGFyYWN0ZXJEYXRhLnR1bWJsZVNwZWVkTWluO1xyXG5cdGlmKCEhdGhpcy5fY2hhcmFjdGVyRGF0YS50dW1ibGVTcGVlZE1heCkgICAgIHRoaXMudHVtYmxlU3BlZWRNYXggICAgID0gdGhpcy5fY2hhcmFjdGVyRGF0YS50dW1ibGVTcGVlZE1heDtcclxuXHRpZighIXRoaXMuX2NoYXJhY3RlckRhdGEudHVtYmxlU3BlZWRUaW1lKSAgICB0aGlzLnR1bWJsZVNwZWVkVGltZSAgICA9IHRoaXMuX2NoYXJhY3RlckRhdGEudHVtYmxlU3BlZWRUaW1lO1xyXG5cdGlmKCEhdGhpcy5fY2hhcmFjdGVyRGF0YS5waWNrdXBDaXJjbGVSYWRpdXMpIHRoaXMucGlja3VwQ2lyY2xlUmFkaXVzID0gdGhpcy5fY2hhcmFjdGVyRGF0YS5waWNrdXBDaXJjbGVSYWRpdXM7XHJcblx0aWYoISF0aGlzLl9jaGFyYWN0ZXJEYXRhLnRyb2xsTWFnaWNEdXJhdGlvbikgdGhpcy50cm9sbE1hZ2ljRHVyYXRpb24gPSB0aGlzLl9jaGFyYWN0ZXJEYXRhLnRyb2xsTWFnaWNEdXJhdGlvbjtcclxuXHJcblx0Ly8gQXBwbHkgcG93ZXIgdXBzXHJcblx0dGhpcy50dW1ibGVTcGVlZE1heCAgICAgKj0gdGhpcy5fcG93ZXJ1cHNEYXRhWzBdLnBvd2VyW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2NoYXJhY3RlckRhdGEuaWRdWzBdXTtcclxuXHR0aGlzLnBpY2t1cENpcmNsZVJhZGl1cyAqPSB0aGlzLl9wb3dlcnVwc0RhdGFbMV0ucG93ZXJbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbdGhpcy5fY2hhcmFjdGVyRGF0YS5pZF1bMV1dO1xyXG5cdHRoaXMudHJvbGxNYWdpY0R1cmF0aW9uICo9IHRoaXMuX3Bvd2VydXBzRGF0YVsyXS5wb3dlcltDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlclt0aGlzLl9jaGFyYWN0ZXJEYXRhLmlkXVsyXV07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEaXNwb3NlXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnN0b3BMb29wcygpO1xyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBwcmV2RGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlO1xyXG5cclxuXHQvLyBBbmltYXRpb24gc3BlZWQgdXBkYXRlXHJcblx0aWYodGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHR0aGlzLnNwaW5lLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cdGVsc2VcclxuXHRcdHRoaXMuc3BpbmUudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSAqIHRoaXMuc3BpbmVTcGVlZCk7XHJcblxyXG5cdC8vIEFuaW1hdGlvbiB1cGRhdGVcclxuXHRpZih0aGlzLmlzRGVhZClcclxuXHR7XHJcblx0XHQvLyBEbyBub3RoaW5nXHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5pc1Nocmlua2luZyAmJiAhdGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0e1xyXG5cdFx0dGhpcy5zZXRBbmltYXRpb24oXCJydW5fcm9sbFwiLCB0cnVlKTtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmlzSW52dWxuZXJhYmxlICYmICF0aGlzLmlzUmlkaW5nVmVoaWNsZSlcclxuXHR7XHJcblx0XHR0aGlzLnNldEFuaW1hdGlvbihcInJ1bl9kb3duX3N0ZWVwX3JvbGxpbmdfYmFsbFwiLCB0cnVlKTtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmlzUmlkaW5nVmVoaWNsZSlcclxuXHR7XHJcblx0XHRjb25zb2xlLmxvZygnaXNSaWRpbmdWZWhpY2xlJyk7XHJcblx0XHRpZighdGhpcy5pc0dyb3VuZGVkICYmIHRoaXMudmVsb2NpdHkueSA+IDApXHJcblx0XHRcdHRoaXMuc2V0QW5pbWF0aW9uKHRoaXMudmVoaWNsZS5yaWRlckZhbGxBbmltYXRpb24sIHRydWUpO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR0aGlzLnNldEFuaW1hdGlvbih0aGlzLnZlaGljbGUucmlkZXJBbmltYXRpb24sIHRydWUpO1xyXG5cclxuXHRcdGlmKCF0aGlzLmlzR3JvdW5kZWQgJiYgdGhpcy52ZWxvY2l0eS55ID4gMClcclxuXHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbignZmFsbCcsIHRydWUpO1xyXG5cdFx0aWYodGhpcy5pc0dyb3VuZGVkICYmICF0aGlzLmlzU2xpZGluZylcclxuXHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbigncnVuX2ZsYXQnLCB0cnVlKTtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmlzU2xhc2hpbmcpXHJcblx0e1xyXG5cdFx0Ly8gRG8gbm90aGluZ1xyXG5cdH1cclxuXHRlbHNlIGlmKHRoaXMuaXNUdW1ibGluZylcclxuXHR7XHJcblx0XHQvLyBUdW1ibGUgYW5pbWF0aW9uXHJcblx0XHR0aGlzLnR1bWJsZVNwZWVkICs9ICh0aGlzLnR1bWJsZVNwZWVkTWF4IC0gdGhpcy50dW1ibGVTcGVlZE1pbikgKiAocDMuVGltZXN0ZXAuZGVsdGFUaW1lL3RoaXMudHVtYmxlU3BlZWRUaW1lKTtcclxuXHRcdGlmKHRoaXMudHVtYmxlU3BlZWQgPiB0aGlzLnR1bWJsZVNwZWVkTWF4KVxyXG5cdFx0XHR0aGlzLnR1bWJsZVNwZWVkID0gdGhpcy50dW1ibGVTcGVlZE1heDtcclxuXHJcblx0XHRpZighdGhpcy5rSnVtcFByZXNzZWQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuaXNUdW1ibGluZyA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHRpZih0aGlzLmN1cnJlbnRBbmltYXRpb24gIT0gJ2p1bXBfdHVjazInICYmIHRoaXMuY3VycmVudEFuaW1hdGlvbiAhPSAnJylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMubGV2ZWwuY2hhbmdlRm9jdXNQb2ludCh0aGlzLmZvY3VzUG9pbnRGYWxsLnBvaW50LCB0aGlzLmZvY3VzUG9pbnRGYWxsLnRpbWUsIHRoaXMuZm9jdXNQb2ludEZhbGwuZGVsYXkpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLnNldEFuaW1hdGlvbignanVtcF90dWNrMicsIHRydWUpO1xyXG5cdFx0XHR0aGlzLnR1bWJsZUFuZ2xlICs9IHRoaXMudHVtYmxlU3BlZWQgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWUgKiBQSVhJLkRFR19UT19SQUQ7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmICF0aGlzLmlzU2xpZGluZyAmJiAhIXRoaXMuY29sbGlzaW9uUG9pbnQpXHJcblx0e1xyXG5cdFx0Ly8gQ2xpbWJpbmcvcnVuIGFuaW1hdGlvblxyXG5cdFx0aWYodGhpcy5pc0dyb3VuZGVkICYmIHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUgKiBQSVhJLlJBRF9UT19ERUcgPCAgdGhpcy5ydW5VcEFuZ2xlKVxyXG5cdFx0XHR0aGlzLnNldEFuaW1hdGlvbigncnVuX3VwMicsIHRydWUpO1xyXG5cdFx0Ly8gZWxzZSBpZih0aGlzLmlzR3JvdW5kZWQgJiYgdGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSAqIFBJWEkuUkFEX1RPX0RFRyA8ICB0aGlzLnJ1blVwQW5nbGUpXHJcblx0XHRcdC8vIHRoaXMuc2V0QW5pbWF0aW9uKCdydW5fdXAnLCB0cnVlKTtcclxuXHRcdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmICEhdGhpcy5jb2xsaXNpb25Qb2ludC5wYXRoLmNvbmZpZy5hcnRpZmljaWFsKVxyXG5cdFx0XHR0aGlzLnNldEFuaW1hdGlvbigncnVuX2ZsYXRfbWFnaWMnLCB0cnVlKTtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy5zZXRBbmltYXRpb24oJ3J1bl9mbGF0JywgdHJ1ZSk7XHJcblx0fVxyXG5cdGVsc2UgaWYoIXRoaXMuaXNHcm91bmRlZCAmJiB0aGlzLnZlbG9jaXR5LnkgPiAwKVxyXG5cdHtcclxuXHRcdC8vIEZhbGwgYW5pbWF0aW9uXHJcblx0XHRpZih0aGlzLmN1cnJlbnRBbmltYXRpb24gIT0gJ2ZhbGwnICYmIHRoaXMuY3VycmVudEFuaW1hdGlvbiAhPSAnJylcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5sZXZlbC5jaGFuZ2VGb2N1c1BvaW50KHRoaXMuZm9jdXNQb2ludEZhbGwucG9pbnQsIHRoaXMuZm9jdXNQb2ludEZhbGwudGltZSwgdGhpcy5mb2N1c1BvaW50RmFsbC5kZWxheSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZXRBbmltYXRpb24oJ2ZhbGwnLCB0cnVlKTtcclxuXHR9XHJcblxyXG5cdC8vIFNsYXNoIHBvd2VyIHVwZGF0ZVxyXG5cdGlmKHRoaXMuaXNTbGFzaGluZylcclxuXHR7XHJcblx0XHR0aGlzLnNsYXNoVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0aWYodGhpcy5zbGFzaFRpbWUgPiB0aGlzLnNsYXNoVGltZU1heClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5pc1NsYXNoaW5nID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBJbnZ1bG5lcmFiaWxpdHkgdXBkYXRlXHJcblx0aWYodGhpcy5pc0ludnVsbmVyYWJsZSlcclxuXHR7XHJcblx0XHR0aGlzLmludnVsbmVyYWJpbGl0eVRpbWUgKz0gcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG5cclxuXHRcdGlmKHRoaXMuaW52dWxuZXJhYmlsaXR5VGltZSA+IHRoaXMuaW52dWxuZXJhYmlsaXR5VGltZU1heClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5pc0ludnVsbmVyYWJsZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmNhblR1bWJsZSA9IHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBJbmNyZW1lbnQgYW5pbWF0aW9uIHNwZWVkIHJlbGF0aXZlIHRvIHRoZSBydW5uaW5nIHNwZWVkXHJcblx0aWYodGhpcy5jdXJyZW50QW5pbWF0aW9uID09IFwicnVuX2ZsYXRcIiAmJiB0aGlzLnJ1blNwZWVkID4gdGhpcy5ydW5TcGVlZE1pbilcclxuXHRcdHRoaXMuc3BpbmVTcGVlZCA9IDEgKyAwLjUgKiAoKHRoaXMucnVuU3BlZWQtdGhpcy5ydW5TcGVlZE1pbikvKHRoaXMucnVuU3BlZWRNYXgtdGhpcy5ydW5TcGVlZE1pbikpO1xyXG5cdGVsc2VcclxuXHRcdHRoaXMuc3BpbmVTcGVlZCA9IDE7XHJcblxyXG5cdC8vIE1vdmVtZW50XHJcblx0dmFyIG9sZFZlbG9jaXR5ID0gbmV3IHAzLlZlY3RvcjIodGhpcy52ZWxvY2l0eS54LCB0aGlzLnZlbG9jaXR5LnkpO1xyXG5cdHZhciB3YXNTbGlkaW5nICA9IHRoaXMuaXNTbGlkaW5nO1xyXG5cdHZhciB3YXNHcm91bmRlZCA9IHRoaXMuaXNHcm91bmRlZDtcclxuXHR2YXIgd2FzUmlkaW5nICAgPSB0aGlzLmlzUmlkaW5nVmVoaWNsZTtcclxuXHJcblx0aWYoIXRoaXMuaXNEZWFkKVxyXG5cdHtcclxuXHRcdC8vIFdoZW4gdG91Y2hpbmcgcmVhbCBncm91bmQgcmVzZXQgdGhlIGNhbkNyZWF0ZUJyaWRnZSBmbGFnXHJcblx0XHRpZighdGhpcy5jYW5DcmVhdGVCcmlkZ2UgJiYgdGhpcy5pc0dyb3VuZGVkKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighdGhpcy5jb2xsaXNpb25Qb2ludC5wYXRoLmNvbmZpZy5hcnRpZmljaWFsKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5jYW5DcmVhdGVCcmlkZ2UgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gSW5wdXRcclxuXHRcdHRoaXMua0p1bXBTdGFydCA9IHRoaXMua0p1bXBTdGFydCB8fCBDb21tb24ua2V5Ym9hcmQuZ2V0S2V5SnVzdFByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9VUCk7XHJcblx0XHR0aGlzLmtKdW1wRW5kICAgPSB0aGlzLmtKdW1wRW5kICAgfHwgQ29tbW9uLmtleWJvYXJkLmdldEtleUp1c3RSZWxlYXNlZChDb21tb24ua2V5Ym9hcmQuS0VZX1VQKTtcclxuXHRcdHRoaXMua0FiaWxpdHkgICA9IHRoaXMua0FiaWxpdHkgICB8fCAoQ29tbW9uLmtleWJvYXJkLmdldEtleUp1c3RQcmVzc2VkKENvbW1vbi5rZXlib2FyZC5LRVlfWikgfHwgQ29tbW9uLmtleWJvYXJkLmdldEtleUp1c3RQcmVzc2VkKENvbW1vbi5rZXlib2FyZC5LRVlfRU5URVIpKTtcclxuXHJcblx0XHRpZih0aGlzLmFyZUlucHV0QWN0aXZlKVxyXG5cdFx0e1xyXG5cdFx0XHRpZih0aGlzLmtKdW1wU3RhcnQpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmp1bXAoKTtcclxuXHRcdFx0XHR0aGlzLmtKdW1wUHJlc3NlZCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZih0aGlzLmtKdW1wRW5kKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5qdW1wRW5kKCk7XHJcblx0XHRcdFx0dGhpcy5rSnVtcFByZXNzZWQgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmtBYmlsaXR5KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYodGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dGhpcy52ZWhpY2xlLmRpc21vdW50KGZhbHNlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGlmKHRoaXMuYWJpbGl0aWVzLmJyaWRnZSlcclxuXHRcdFx0XHRcdFx0dGhpcy5wb3dlckJyaWRnZSgpO1xyXG5cdFx0XHRcdFx0ZWxzZSBpZih0aGlzLmFiaWxpdGllcy5zbGFzaClcclxuXHRcdFx0XHRcdFx0dGhpcy5wb3dlclNsYXNoKCk7XHJcblx0XHRcdFx0XHRlbHNlIGlmKHRoaXMuYWJpbGl0aWVzLnNocmluaylcclxuXHRcdFx0XHRcdFx0dGhpcy5wb3dlclNocmluaygpO1xyXG5cdFx0XHRcdFx0ZWxzZSBpZih0aGlzLmFiaWxpdGllcy5pbnZ1bG5lcmFiaWxpdHkpXHJcblx0XHRcdFx0XHRcdHRoaXMucG93ZXJJbnZ1bG5lcmFiaWxpdHkoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmtKdW1wU3RhcnQgPSBmYWxzZTtcclxuXHRcdHRoaXMua0p1bXBFbmQgICA9IGZhbHNlO1xyXG5cdFx0dGhpcy5rQWJpbGl0eSAgID0gZmFsc2U7XHJcblxyXG5cdFx0Ly8gU3BlZWQgaW5jcmVhc2UvZGVjcmVhc2VcclxuXHRcdGlmKHRoaXMuaXNTbGlkaW5nKVxyXG5cdFx0XHR0aGlzLnJ1blNwZWVkICs9IHRoaXMuYWNjZWxlcmF0aW9uU2xpZGluZyAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmIHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUgKiBQSVhJLlJBRF9UT19ERUcgPiB0aGlzLnJ1bkRvd25BbmdsZSlcclxuXHRcdFx0dGhpcy5ydW5TcGVlZCArPSB0aGlzLmFjY2VsZXJhdGlvblNsb3BlRG93biAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmIHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUgKiBQSVhJLlJBRF9UT19ERUcgPCB0aGlzLnJ1blVwQW5nbGUpXHJcblx0XHRcdHRoaXMucnVuU3BlZWQgKz0gdGhpcy5hY2NlbGVyYXRpb25TbG9wZVVwICogcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR0aGlzLnJ1blNwZWVkICs9IHRoaXMuYWNjZWxlcmF0aW9uTm9ybWFsICogcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG5cclxuXHRcdHRoaXMucnVuU3BlZWQgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLnJ1blNwZWVkLCB0aGlzLmlzU2xpZGluZyA/IHRoaXMuc2xpZGluZ1NwZWVkTWF4IDogdGhpcy5ydW5TcGVlZE1heCksIHRoaXMucnVuU3BlZWRNaW4pO1xyXG5cdFx0dGhpcy52ZWxvY2l0eS54ID0gdGhpcy5ydW5TcGVlZDtcclxuXHJcblx0XHQvLyBTbGlkaW5nXHJcblx0XHRpZighdGhpcy5pc1NsaWRpbmcgJiYgdGhpcy5pc0dyb3VuZGVkICYmIHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUgKiBQSVhJLlJBRF9UT19ERUcgPiAgdGhpcy5zbGlkaW5nQW5nbGVTdGFydCAmJiAhdGhpcy5pc1NsYXNoaW5nKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmlzU2xpZGluZyAgICAgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLnRpbWVVbnNsaWRpbmcgPSAwO1xyXG5cclxuXHRcdFx0aWYodGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbignc2xpZGVfZG93bl9zdGVlcCcsIHRydWUpO1xyXG5cdFx0XHRlbHNlIGlmKHRoaXMuaXNPbGFmKCkpXHJcblx0XHRcdFx0dGhpcy5zZXRBbmltYXRpb24oJ3J1bl9kb3duX3N0ZWVwJywgdHJ1ZSk7XHJcblx0XHRcdGVsc2UgaWYodGhpcy5pc1BhYmJpZSgpKVxyXG5cdFx0XHRcdHRoaXMuc2V0QW5pbWF0aW9uKCdydW5fZG93bl9zdGVlcF9yb2xsaW5nX2JhbGwnLCB0cnVlKTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5zZXRBbmltYXRpb24oJ3NsaWRlX2Rvd25fc3RlZXAnLCB0cnVlKTtcclxuXHRcdFx0XHR0aGlzLmFuZ2xlVGFyZ2V0ID0gMDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gWm9vbSBpbiB3aGlsZSBzbGlkaW5nXHJcblx0XHRcdHRoaXMubGV2ZWwuY2hhbmdlWm9vbSh0aGlzLnpvb21TbGlkZS56b29tLCB0aGlzLnpvb21TbGlkZS50aW1lKTtcclxuXHRcdFx0dGhpcy5sZXZlbC5jaGFuZ2VGb2N1c1BvaW50KHRoaXMuZm9jdXNQb2ludFNsaWRlLnBvaW50LCB0aGlzLmZvY3VzUG9pbnRTbGlkZS50aW1lLCB0aGlzLmZvY3VzUG9pbnRTbGlkZS5kZWxheSk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMuaXNTbGlkaW5nICYmICghdGhpcy5jb2xsaXNpb25Qb2ludCB8fCAodGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSAqIFBJWEkuUkFEX1RPX0RFRyA8IHRoaXMuc2xpZGluZ0FuZ2xlRW5kKSkpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMudGltZVVuc2xpZGluZyArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0XHQgaWYodGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbignc2xpZGVfZG93bl9leGl0JywgdHJ1ZSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0aGlzLnNldEFuaW1hdGlvbignc2xpZGVfZG93bl9leGl0JywgdHJ1ZSk7XHJcblxyXG5cdFx0XHRpZih0aGlzLnRpbWVVbnNsaWRpbmcgPj0gdGhpcy50aW1lVW5zbGlkaW5nRW5kKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5pc1NsaWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLnNldEFuaW1hdGlvbigncnVuX2ZsYXQnLCB0cnVlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIE1hbnVhbCBtb3ZlbWVudFxyXG5cdFx0LyogaWYoQ29tbW9uLmtleWJvYXJkLmdldEtleVByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9BKSlcclxuXHRcdHtcclxuXHRcdFx0dGhpcy52ZWxvY2l0eS54ID0gLTgwMDtcclxuXHRcdFx0dGhpcy5hbmltYXRpb25Ib2xkZXIuc2NhbGUueCA9IC0xO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZihDb21tb24ua2V5Ym9hcmQuZ2V0S2V5UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX0QpKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnZlbG9jaXR5LnggPSArODAwO1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvbkhvbGRlci5zY2FsZS54ID0gMTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy52ZWxvY2l0eS54ID0gMDsgKi9cclxuXHJcblx0fVxyXG5cclxuXHQvLyBHcmF2aXR5XHJcblx0dGhpcy52ZWxvY2l0eS55ICs9IHRoaXMuZ3Jhdml0eSAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRpZih0aGlzLnZlbG9jaXR5LnkgPj0gdGhpcy5ncmF2aXR5LzIpIHRoaXMudmVsb2NpdHkueSA9IHRoaXMuZ3Jhdml0eS8yO1xyXG5cclxuXHQvLyBSb3RhdGlvbiB1cGRhdGVcclxuXHRpZih0aGlzLmlzU2hyaW5raW5nKVxyXG5cdHtcclxuXHRcdHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uID0gMDtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmlzVHVtYmxpbmcpXHJcblx0e1xyXG5cdFx0dGhpcy5hbmltYXRpb25Ib2xkZXIucm90YXRpb24gPSB0aGlzLmFuZ2xlVGFyZ2V0O1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dmFyIGFuZ2xlRGlmZiA9IE1hdGguYXRhbjIoTWF0aC5zaW4odGhpcy5hbmdsZVRhcmdldCAtIHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uKSwgTWF0aC5jb3ModGhpcy5hbmdsZVRhcmdldCAtIHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uKSk7XHJcblx0XHR0aGlzLmFuaW1hdGlvbkhvbGRlci5yb3RhdGlvbiA9IHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uICsgKGFuZ2xlRGlmZiAqIHRoaXMuYW5nbGVTcGVlZCk7XHJcblx0fVxyXG5cclxuXHJcblx0Ly8gQ29sbGlzaW9uIENoZWNrXHJcblx0dGhpcy5tb3ZlKHRoaXMudmVsb2NpdHkpO1xyXG5cclxuXHJcblx0Ly8gU2hyaW5rIHBvd2VyIHVwZGF0ZVxyXG5cdGlmKHRoaXMuaXNTaHJpbmtpbmcgfHwgdGhpcy5pc1Vuc2hyaW5raW5nKVxyXG5cdHtcclxuXHRcdHRoaXMuc2hyaW5rVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIG9sZCBwb3NpdGlvbidzIHRpbWVyXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5wb3NpdGlvbkNhY2hlLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnBvc2l0aW9uQ2FjaGVbaV0udGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0XHRpZih0aGlzLnBvc2l0aW9uQ2FjaGVbaV0udGltZSA+IHRoaXMuc2hyaW5rUGllY2VzLmxlbmd0aCAqIHRoaXMuc2hyaW5rUGllY2VEZWxheSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMucG9zaXRpb25DYWNoZS5zcGxpY2UoaSsxLCAxMDApO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQWRkIHRoZSBjdXJyZW50IHBvc2l0aW9uXHJcblx0XHR0aGlzLnBvc2l0aW9uQ2FjaGUudW5zaGlmdCh7dGltZTowLCBwb3NpdGlvbjpuZXcgUElYSS5Qb2ludCh0aGlzLngsIHRoaXMueSl9KTtcclxuXHJcblx0XHQvLyBVcGRhdGUgdGhlIHBpZWNlcyBwb3NpdGlvblxyXG5cdFx0Zm9yKHZhciBwID0gMDsgcCA8IHRoaXMuc2hyaW5rUGllY2VzLmxlbmd0aDsgcCsrKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGFyZ2V0VGltZSA9ICh0aGlzLnNocmlua1BpZWNlcy5sZW5ndGgtcCkgKiB0aGlzLnNocmlua1BpZWNlRGVsYXk7XHJcblxyXG5cdFx0XHQvLyBXaGVuIHVuc2hyaW5raW5nLCBtb3ZlIHRoZSBwaWVjZXMgdG8gdGhlIGNoYXJhY3RlcnNcclxuXHRcdFx0aWYodGhpcy5pc1Vuc2hyaW5raW5nKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGFyZ2V0VGltZSAqPSAoMSAtIHRoaXMuc2hyaW5rVGltZS90aGlzLnNocmlua1RyYW5zaXRpb25UaW1lKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gSWYgdGhlcmUgYXJlbid0IGVub3VnaCBwb2ludHMgeWV0IGtlZXAgdGhlIHBpZWNlcyB0byB0aGUgc3RhcnRpbmcgbG9jYXRpb25cclxuXHRcdFx0aWYodGhpcy5wb3NpdGlvbkNhY2hlW3RoaXMucG9zaXRpb25DYWNoZS5sZW5ndGgtMV0udGltZSA8IHRhcmdldFRpbWUpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLnNocmlua1BpZWNlc1twXS54ID0gdGhpcy5wb3NpdGlvbkNhY2hlW3RoaXMucG9zaXRpb25DYWNoZS5sZW5ndGgtMV0ucG9zaXRpb24ueCAtIHRoaXMueDtcclxuXHRcdFx0XHR0aGlzLnNocmlua1BpZWNlc1twXS55ID0gdGhpcy5wb3NpdGlvbkNhY2hlW3RoaXMucG9zaXRpb25DYWNoZS5sZW5ndGgtMV0ucG9zaXRpb24ueSAtIHRoaXMueTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHRmb3IodmFyIGkgPSB0aGlzLnBvc2l0aW9uQ2FjaGUubGVuZ3RoLTE7IGkgPiAwOyBpLS0pXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0aWYodGhpcy5wb3NpdGlvbkNhY2hlW2ktMV0udGltZSA8IHRhcmdldFRpbWUpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHZhciBwMCA9IHRoaXMucG9zaXRpb25DYWNoZVtpLTFdO1xyXG5cdFx0XHRcdFx0XHR2YXIgcDEgPSB0aGlzLnBvc2l0aW9uQ2FjaGVbaV07XHJcblx0XHRcdFx0XHRcdHZhciB0MCA9IHAwLnRpbWU7XHJcblx0XHRcdFx0XHRcdHZhciB0MSA9IHAxLnRpbWUgLSB0MDtcclxuXHRcdFx0XHRcdFx0dmFyIHBlcmMgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAodGFyZ2V0VGltZSAtIHQwKSAvIHQxKSk7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLnNocmlua1BpZWNlc1twXS54ID0gcDAucG9zaXRpb24ueCArIChwMS5wb3NpdGlvbi54LXAwLnBvc2l0aW9uLngpKnBlcmMgLSB0aGlzLng7XHJcblx0XHRcdFx0XHRcdHRoaXMuc2hyaW5rUGllY2VzW3BdLnkgPSBwMC5wb3NpdGlvbi55ICsgKHAxLnBvc2l0aW9uLnktcDAucG9zaXRpb24ueSkqcGVyYyAtIHRoaXMueSArIDIwO1xyXG5cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBVcGRhdGUgdGhlIHJvdGF0aW9uXHJcblx0XHRcdHRoaXMuc2hyaW5rUGllY2VzW3BdLnJvdGF0aW9uICs9IHRoaXMuc2hyaW5rUGllY2VSb3RhdGlvblNwZWVkICogUElYSS5ERUdfVE9fUkFEICogcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEF0IHRoZSBlbmQgb2YgdGhlIHNocmluayBkZWxheSwgdW5zaHJpbmtcclxuXHRcdGlmKHRoaXMuaXNTaHJpbmtpbmcgJiYgdGhpcy5zaHJpbmtUaW1lID4gdGhpcy5zaHJpbmtUaW1lTWF4ICYmICF0aGlzLmlzU2hyaW5rTG9ja2VkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnBvd2VyVW5zaHJpbmsoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIFVuZG8gZ3Jhdml0eSB3aGVuIHRvdWNoaW5nIGdyb3VuZFxyXG5cdGlmKHRoaXMuaXNHcm91bmRlZClcclxuXHR7XHJcblx0XHR0aGlzLnZlbG9jaXR5LnkgPSAwO1xyXG5cclxuXHRcdGlmKCF3YXNHcm91bmRlZCAmJiAhdGhpcy5pc0RlYWQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMubGFuZCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gRmFsbGluZyB0aW1lXHJcblx0aWYoIXRoaXMuaXNHcm91bmRlZCAmJiB0aGlzLnZlbG9jaXR5LnkgPiAwKVxyXG5cdFx0dGhpcy5mYWxsVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0ZWxzZSBpZih0aGlzLmZhbGxUaW1lICE9IDApXHJcblx0XHR0aGlzLmZhbGxUaW1lID0gMDtcclxuXHJcblx0Ly8gQ29sbGlzaW9ucyB3aXRoIG9iamVjdHNcclxuXHR0aGlzLmNvbGxpc2lvbnMoKTtcclxuXHJcblxyXG5cdGlmKCF0aGlzLmlzRGVhZClcclxuXHR7XHJcblx0XHQvLyBab29tXHJcblx0XHRpZih3YXNTbGlkaW5nICYmICF0aGlzLmlzU2xpZGluZylcclxuXHRcdHtcclxuXHRcdFx0Ly8gWm9vbSBvdXQgd2hlbiBub3Qgc2xpZGluZyBhbnltb3JlXHJcblx0XHRcdHRoaXMubGV2ZWwuY2hhbmdlWm9vbSh0aGlzLnpvb21TbGlkZUVuZC56b29tLCB0aGlzLnpvb21TbGlkZUVuZC50aW1lKTtcclxuXHJcblx0XHRcdC8vIFJlc2V0IHRoZSBmb2N1cyBwb2ludFxyXG5cdFx0XHRpZih0aGlzLmlzR3JvdW5kZWQpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmxldmVsLmNoYW5nZUZvY3VzUG9pbnQodGhpcy5mb2N1c1BvaW50TGFuZC5wb2ludCwgdGhpcy5mb2N1c1BvaW50TGFuZC50aW1lLCB0aGlzLmZvY3VzUG9pbnRMYW5kLmRlbGF5KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0U291bmRTRlguc3RvcChcInNmeF9zbm93X3NsaWRlX2xvb3BfMDBcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5jYW5UdW1ibGUgJiYgIXRoaXMuaXNHcm91bmRlZCAmJiAhdGhpcy5pc1JpZGluZ1ZlaGljbGUgJiYgb2xkVmVsb2NpdHkueSA8PSB0aGlzLnR1bWJsZVNwZWVkWVN0YXJ0ICYmIHRoaXMudmVsb2NpdHkueSA+IHRoaXMudHVtYmxlU3BlZWRZU3RhcnQgJiYgdGhpcy5rSnVtcFByZXNzZWQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuaXNUdW1ibGluZyAgICA9IHRydWU7XHJcblx0XHRcdHRoaXMudHVtYmxlQW5nbGUgICA9IDA7XHJcblx0XHRcdHRoaXMuY2FuVHVtYmxlICAgICA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmNhbkRvdWJsZUp1bXAgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy50dW1ibGVTcGVlZCAgID0gdGhpcy50dW1ibGVTcGVlZE1pbjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBIZWFkYm9iXHJcblx0XHQvKiBpZih0aGlzLmlzU2xpZGluZyB8fCAhdGhpcy5pc0dyb3VuZGVkIHx8IHRoaXMuaXNEZWFkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmhlYWRib2JUaW1lID0gMDtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5oZWFkYm9iVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHR9ICovXHJcblx0fVxyXG5cclxuXHQvLyBSdW5uaW5nIHNvdW5kc1xyXG5cdGlmKHRoaXMuaXNEZWFkKVxyXG5cdHtcclxuXHRcdHRoaXMuc3RvcExvb3BzKCk7XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmIHRoaXMuaXNSaWRpbmdWZWhpY2xlKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuaXNTbGlkaW5nICYmIHRoaXMudGltZVVuc2xpZGluZyA+IDApXHJcblx0XHRcdHRoaXMucGxheUxvb3AoXCJzZnhfc25vd19zbGlkZV9sb29wXzAwXCIpO1xyXG5cdFx0ZWxzZSBpZih0aGlzLnZlaGljbGUudHlwZSA9PSBcInN2ZW5cIilcclxuXHRcdFx0dGhpcy5wbGF5TG9vcChcInNmeF9zdmVuX3J1bl8wMlwiKTtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmlzR3JvdW5kZWQgJiYgKHRoaXMuaXNTbGlkaW5nIHx8IHRoaXMuaXNTaHJpbmtpbmcpKVxyXG5cdHtcclxuXHRcdHRoaXMucGxheUxvb3AoXCJzZnhfc25vd19zbGlkZV9sb29wXzAwXCIpO1xyXG5cdH1cclxuXHRlbHNlIGlmKHRoaXMuaXNHcm91bmRlZClcclxuXHR7XHJcblx0XHRzd2l0Y2goQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpXHJcblx0XHR7XHJcblx0XHRcdGNhc2UgXCJhbm5hXCI6XHJcblx0XHRcdGNhc2UgXCJlbHNhXCI6XHJcblx0XHRcdFx0dGhpcy5wbGF5TG9vcChcInNmeF9hbm5hX3Nub3dfcnVudnNvZnRfMDBcIik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlIFwia3Jpc3RvZmZcIjpcclxuXHRcdFx0XHR0aGlzLnBsYXlMb29wKFwic2Z4X2tyaXN0b2ZmX3Nub3dfcnVudnNvZnRfMDBcIik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlIFwib2xhZlwiOlxyXG5cdFx0XHRcdHRoaXMucGxheUxvb3AoXCJzZnhfZ2VuZXJpY19vbGFmX3Nub3dfcnVudnNvZnRfMDBcIik7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHR0aGlzLnN0b3BMb29wcygpO1xyXG5cdH1cclxuXHJcblx0Ly8gQXhlIHNvdW5kXHJcblx0aWYoISF0aGlzLnNsYXNoU0ZYICYmICF0aGlzLmlzU2xhc2hpbmcpXHJcblx0e1xyXG5cdFx0dGhpcy5zbGFzaFNGWC5zdG9wKCk7XHJcblx0XHR0aGlzLnNsYXNoU0ZYID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8vIEtyaXN0b2ZmJ3MgYXhlXHJcblx0Ly8gaWYodGhpcy5heGUpXHJcblx0XHQvLyB0aGlzLmF4ZS51cGRhdGUoKTtcclxuXHJcblxyXG5cdC8vIFRyb2xsIE1hZ2ljXHJcblx0aWYodGhpcy5pc1Ryb2xsTWFnaWMpXHJcblx0e1xyXG5cdFx0dGhpcy50cm9sbE1hZ2ljVGltZSAtPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0aWYodGhpcy50cm9sbE1hZ2ljVGltZSA8IDApXHJcblx0XHR7XHJcblx0XHRcdHRoaXMudHJvbGxNYWdpY0VuZCgpO1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvbkhvbGRlci5hbHBoYSA9IDE7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMudHJvbGxNYWdpY1RpbWUgPCAyLjUgJiYgdGhpcy50cm9sbE1hZ2ljVGltZSA+IDAuNSlcclxuXHRcdHtcclxuXHRcdFx0Ly8gQmxpbmsgd2hlbiB0aGUgZWZmZWN0IGlzIGFsbW9zdCBlbmRlZFxyXG5cdFx0XHR0aGlzLmFuaW1hdGlvbkhvbGRlci5hbHBoYSA9ICgoKHRoaXMudHJvbGxNYWdpY1RpbWUtMC41KSAlIDAuMikgPCAwLjEpID8gMC4yNSA6IDE7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuYW5pbWF0aW9uSG9sZGVyLmFscGhhID0gMTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIFBhcnRpY2xlc1xyXG5cdGlmKHRoaXMuaXNSaWRpbmdWZWhpY2xlICYmIHRoaXMuaXNHcm91bmRlZClcclxuXHR7XHJcblx0XHR2YXIgdjEgPSBuZXcgUElYSS5Qb2ludCh0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgKiBNYXRoLmNvcyh0aGlzLmNvbGxpc2lvblBvaW50LmFuZ2xlKSwgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICogTWF0aC5zaW4odGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSkpO1xyXG5cdFx0dmFyIHYyID0gbmV3IFBJWEkuUG9pbnQodGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICogTWF0aC5zaW4odGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSksIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyAqIE1hdGguY29zKHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUpKTtcclxuXHRcdHRoaXMuc25vd1RyYWlsUFMudXBkYXRlU3Bhd25Qb3ModGhpcy54ICsgdjEueCAtIHYyLngsIHRoaXMueSArIHYxLnkgKyB2Mi55KTtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLnRpbWVVbnNsaWRpbmcgPCAwLjEpXHJcblx0e1xyXG5cdFx0dGhpcy5zbm93VHJhaWxQUy51cGRhdGVTcGF3blBvcyh0aGlzLnggLSAxMCArIHAzLlV0aWxzLnJhbmRvbUludCgtNSw1KSwgdGhpcy55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICsgMzApO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy5zbm93VHJhaWxQUy51cGRhdGVTcGF3blBvcyh0aGlzLnggKyAxMCwgdGhpcy55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzIC0gMTApO1xyXG5cdH1cclxuXHJcblx0dGhpcy5zbm93VHJhaWxQUy5lbWl0ID0gdGhpcy5pc1NsaWRpbmc7XHJcblx0dGhpcy5zbm93VHJhaWxQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblxyXG5cdHRoaXMuZG91YmxlSnVtcFBTLnVwZGF0ZVNwYXduUG9zKHRoaXMueCwgdGhpcy55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKTtcclxuXHR0aGlzLmRvdWJsZUp1bXBQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0dGhpcy5icmlkZ2VGYWlsTWFnaWNQUy51cGRhdGVTcGF3blBvcyh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMsIHRoaXMueSAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyk7XHJcblx0dGhpcy5icmlkZ2VGYWlsTWFnaWNQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0dGhpcy50cm9sbE1hZ2ljUFMudXBkYXRlU3Bhd25Qb3ModGhpcy54LCB0aGlzLnkpO1xyXG5cdHRoaXMudHJvbGxNYWdpY1BTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5fcGFydGljbGVPcmlnaW4ucG9zaXRpb24uc2V0KHRoaXMuc25vd1RyYWlsUFMuc3Bhd25Qb3MueCAtIHRoaXMueCwgdGhpcy5zbm93VHJhaWxQUy5zcGF3blBvcy55IC0gdGhpcy55KVxyXG5cclxuXHQvLyBHb2FsczogbW92ZW1lbnRcclxuXHRpZighdGhpcy5pc0RlYWQgJiYgdGhpcy5hcmVJbnB1dEFjdGl2ZSAmJiBwcmV2RGlzdGFuY2UgPCB0aGlzLmRpc3RhbmNlKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuaXNTbGlkaW5nKVxyXG5cdFx0XHRDb21tb24uZ29hbHNNYW5hZ2VyLnRyYWNrRXZlbnQoXCJzbGlkZVwiLCB0aGlzLmRpc3RhbmNlIC0gcHJldkRpc3RhbmNlKTtcclxuXHJcblx0XHRpZih0aGlzLmlzUmlkaW5nVmVoaWNsZSlcclxuXHRcdHtcclxuXHRcdFx0Q29tbW9uLmdvYWxzTWFuYWdlci50cmFja0V2ZW50KFwicmlkZV9cIiArIHRoaXMudmVoaWNsZS50eXBlLCB0aGlzLmRpc3RhbmNlIC0gcHJldkRpc3RhbmNlKTtcclxuXHRcdH1cclxuXHJcblx0XHRDb21tb24uZ29hbHNNYW5hZ2VyLnRyYWNrRXZlbnQoXCJydW5cIiwgdGhpcy5kaXN0YW5jZSAtIHByZXZEaXN0YW5jZSk7XHJcblx0fVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN0b3AgdGhlIGN1cnJlbnQgbG9vcHNcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUuc3RvcExvb3BzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy53YWxrTG9vcCAhPSBcIlwiKVxyXG5cdHtcclxuXHRcdFNvdW5kU0ZYLnN0b3AodGhpcy53YWxrTG9vcCk7XHJcblx0XHR0aGlzLndhbGtMb29wID0gXCJcIjtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdG9wIHRoZSBjdXJyZW50IGxvb3AgYW5kIHBsYXkgYSBuZXcgb25lLCBpZiBkaWZmZXJlbnRcclxuICogQHBhcmFtIHtTdHJpbmd9IGF1ZGlvXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLnBsYXlMb29wID0gZnVuY3Rpb24oYXVkaW8pXHJcbntcclxuXHRpZih0aGlzLndhbGtMb29wID09IGF1ZGlvKSByZXR1cm47XHJcblxyXG5cdHRoaXMuc3RvcExvb3BzKCk7XHJcblx0dGhpcy53YWxrTG9vcCA9IGF1ZGlvO1xyXG5cdFNvdW5kU0ZYLnBsYXkodGhpcy53YWxrTG9vcCwge2xvb3A6dHJ1ZX0pO1xyXG59XHJcblxyXG4vKipcclxuICogSGFuZGxlIGNvbGxpc2lvbnMgd2l0aCBvYmplY3RzXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLmNvbGxpc2lvbnMgPSBmdW5jdGlvbigpXHJcbntcclxuXHR2YXIgYXZhdGFyT2JzdGFjbGVDb2xsaXNpb25DaXJjbGUgPSBuZXcgUElYSS5DaXJjbGUodGhpcy54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUueCwgIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnksIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyk7XHJcblx0dmFyIGF2YXRhclBpY2t1cENvbGxpc2lvbkNpcmNsZSAgID0gbmV3IFBJWEkuQ2lyY2xlKHRoaXMueCArIHRoaXMucGlja3VwQ2lyY2xlLngsICAgICB0aGlzLnkgKyB0aGlzLnBpY2t1cENpcmNsZS55LCAgICB0aGlzLnBpY2t1cENpcmNsZS5yYWRpdXMpO1xyXG5cdHZhciBhdmF0YXJBeGVDb2xsaXNpb25DaXJjbGUgICAgICA9IG5ldyBQSVhJLkNpcmNsZSh0aGlzLnggKyB0aGlzLmF4ZUNpcmNsZS54LCAgICAgICAgdGhpcy55ICsgdGhpcy5heGVDaXJjbGUueSwgICAgICAgdGhpcy5heGVDaXJjbGUucmFkaXVzKTtcclxuXHJcblxyXG5cdC8vIEVuZCBvZiBsZXZlbFxyXG5cdHZhciBsZXZlbF9lbmQgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcImxldmVsX2VuZFwiKTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IGxldmVsX2VuZC5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRpZighbGV2ZWxfZW5kW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdGlmKHRoaXMuY2hlY2tDb2xsaXNpb24oYXZhdGFyT2JzdGFjbGVDb2xsaXNpb25DaXJjbGUsIGxldmVsX2VuZFtpXSkpXHJcblx0XHR7XHJcblx0XHRcdGxldmVsX2VuZFtpXS5oaXQoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlmKCF0aGlzLmlzRGVhZClcclxuXHR7XHJcblx0XHQvLyBab29tXHJcblx0XHR2YXIgY2FtZXJhX3pvb20gPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcImNhbWVyYV96b29tXCIpO1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjYW1lcmFfem9vbS5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYoIWNhbWVyYV96b29tW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0aWYodGhpcy5jaGVja0NvbGxpc2lvbihhdmF0YXJPYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSwgY2FtZXJhX3pvb21baV0pKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y2FtZXJhX3pvb21baV0uaGl0KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBDb2luc1xyXG5cdFx0dmFyIGNvaW5zID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJjb2luXCIpO1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjb2lucy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYoIWNvaW5zW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0aWYodGhpcy5jaGVja0NvbGxpc2lvbihhdmF0YXJQaWNrdXBDb2xsaXNpb25DaXJjbGUsIGNvaW5zW2ldKSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdCBpZihjb2luc1tpXS5waWNrdXAodGhpcykpXHJcblx0XHRcdFx0IHtcclxuXHRcdFx0XHRcdCAvLyBTY29yZVxyXG5cdFx0XHRcdFx0IHRoaXMubGV2ZWwuc25vd2ZsYWtlcysrO1xyXG5cclxuXHRcdFx0XHRcdCAvLyBHb2FsczogY29pbnNcclxuXHRcdFx0XHRcdCBDb21tb24uZ29hbHNNYW5hZ2VyLnRyYWNrRXZlbnQoXCJjb2luc1wiKTtcclxuXHRcdFx0XHQgfVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ3J5c3RhbHNcclxuXHRcdHZhciBjcnlzdGFscyA9IHRoaXMubGV2ZWwub2JqZWN0TWFuYWdlci5nZXRPYmplY3RzT2ZUeXBlKFwiY3J5c3RhbFwiKTtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgY3J5c3RhbHMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKCFjcnlzdGFsc1tpXS5pbnRlcmFjdGl2ZSkgY29udGludWU7XHJcblx0XHRcdGlmKHRoaXMuY2hlY2tDb2xsaXNpb24oYXZhdGFyT2JzdGFjbGVDb2xsaXNpb25DaXJjbGUsIGNyeXN0YWxzW2ldKSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdCBpZihjcnlzdGFsc1tpXS5waWNrdXAodGhpcykpXHJcblx0XHRcdFx0IHtcclxuXHRcdFx0XHRcdCAvLyBHb2FsczogY3J5c3RhbHNcclxuXHRcdFx0XHRcdCBDb21tb24uZ29hbHNNYW5hZ2VyLnRyYWNrRXZlbnQoXCJjcnlzdGFsc1wiKTtcclxuXHRcdFx0XHQgfVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVHJvbGxcclxuXHRcdGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwicGFiYmllXCIpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0cm9sbHMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcInRyb2xsXCIpO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRyb2xscy5sZW5ndGg7IGkrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKCF0cm9sbHNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGlmKHRoaXMuY2hlY2tDb2xsaXNpb24oYXZhdGFyT2JzdGFjbGVDb2xsaXNpb25DaXJjbGUsIHRyb2xsc1tpXSkpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0IGlmKHRyb2xsc1tpXS5waWNrdXAodGhpcykpXHJcblx0XHRcdFx0XHQge1xyXG5cdFx0XHRcdFx0XHQgLy8gR29hbHM6IHRyb2xsc1xyXG5cdFx0XHRcdFx0XHQgLy8gQ29tbW9uLmdvYWxzTWFuYWdlci50cmFja0V2ZW50KFwidHJvbGxzXCIpO1xyXG5cdFx0XHRcdFx0IH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBUcm9sbCBtYWdpY1xyXG5cdFx0dmFyIHBvd2VydXBzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJwb3dlcnVwXCIpO1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBwb3dlcnVwcy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYoIXBvd2VydXBzW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0aWYodGhpcy5jaGVja0NvbGxpc2lvbihhdmF0YXJPYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSwgcG93ZXJ1cHNbaV0pKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0IGlmKHBvd2VydXBzW2ldLnBpY2t1cCh0aGlzKSlcclxuXHRcdFx0XHQge1xyXG5cdFx0XHRcdFx0IHRoaXMudHJvbGxNYWdpYygpO1xyXG5cclxuXHRcdFx0XHRcdCAvLyBHb2FsczogcG93ZXJ1cHNcclxuXHRcdFx0XHRcdCBDb21tb24uZ29hbHNNYW5hZ2VyLnRyYWNrRXZlbnQoXCJwb3dlcnVwc1wiKTtcclxuXHRcdFx0XHQgfVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gT2JzdGFjbGVzXHJcblx0XHR2YXIgb2JzdGFjbGVzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJvYnN0YWNsZVwiKTtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgb2JzdGFjbGVzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighb2JzdGFjbGVzW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0aWYodGhpcy5pc1NsYXNoaW5nICYmIG9ic3RhY2xlc1tpXS5pY2VCbG9jayAmJiB0aGlzLmNoZWNrQ29sbGlzaW9uKGF2YXRhckF4ZUNvbGxpc2lvbkNpcmNsZSwgb2JzdGFjbGVzW2ldKSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdG9ic3RhY2xlc1tpXS5kZXN0cm95KFwiYXhlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYodGhpcy5jaGVja0NvbGxpc2lvbihhdmF0YXJPYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSwgb2JzdGFjbGVzW2ldKSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKHRoaXMuaXNUcm9sbE1hZ2ljKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdG9ic3RhY2xlc1tpXS5kZXN0cm95KFwibWFnaWNcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYodGhpcy5pc0ludnVsbmVyYWJsZSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRvYnN0YWNsZXNbaV0uZGVzdHJveShcImludnVsbmVyYWJpbGl0eVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdG9ic3RhY2xlc1tpXS5oaXQodGhpcylcclxuXHRcdFx0XHRcdHRoaXMuZGVhdGgoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBTbm93YmFsbHNcclxuXHRcdHZhciBzbm93YmFsbHMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcInNub3diYWxsXCIpO1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzbm93YmFsbHMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKCFzbm93YmFsbHNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0XHRpZih0aGlzLmNoZWNrQ29sbGlzaW9uKGF2YXRhck9ic3RhY2xlQ29sbGlzaW9uQ2lyY2xlLCBzbm93YmFsbHNbaV0pKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYoIXRoaXMuaXNJbnZ1bG5lcmFibGUpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0c25vd2JhbGxzW2ldLmhpdCh0aGlzKTtcclxuXHRcdFx0XHRcdHRoaXMubGV2ZWwuc2hha2UoMC41LCBuZXcgUElYSS5Qb2ludCg4LDEyKSk7XHJcblx0XHRcdFx0XHR0aGlzLmRlYXRoKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRzbm93YmFsbHNbaV0uZGVzdHJveShmYWxzZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gUGxhdGZvcm1zXHJcblx0XHR2YXIganVtcF9wbGF0Zm9ybXMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcImp1bXBfcGxhdGZvcm1cIik7XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGp1bXBfcGxhdGZvcm1zLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighanVtcF9wbGF0Zm9ybXNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0XHRpZih0aGlzLmNoZWNrQ29sbGlzaW9uKGF2YXRhck9ic3RhY2xlQ29sbGlzaW9uQ2lyY2xlLCBqdW1wX3BsYXRmb3Jtc1tpXSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRqdW1wX3BsYXRmb3Jtc1tpXS5oaXQodGhpcylcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFZlaGljbGVzXHJcblx0XHRpZighdGhpcy5pc1Nocmlua2luZyAmJiAhdGhpcy5pc1Vuc2hyaW5raW5nICYmICF0aGlzLmlzUmlkaW5nVmVoaWNsZSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIHZlaGljbGVzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJzdmVuXCIpO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHZlaGljbGVzLmxlbmd0aDsgaSsrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYoIXZlaGljbGVzW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih0aGlzLmNoZWNrQ29sbGlzaW9uKGF2YXRhck9ic3RhY2xlQ29sbGlzaW9uQ2lyY2xlLCB2ZWhpY2xlc1tpXSkpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmVoaWNsZXNbaV0uaGl0KHRoaXMpO1xyXG5cdFx0XHRcdFx0Ly8gU2NvcmVcclxuXHRcdFx0XHRcdHRoaXMubGV2ZWwuc3R5bGVTY29yZSArPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5zY29yZS52ZWhpY2xlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCF0aGlzLmlzU2hyaW5raW5nICYmICF0aGlzLmlzVW5zaHJpbmtpbmcgJiYgIXRoaXMuaXNSaWRpbmdWZWhpY2xlKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdmVoaWNsZXMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcInNsZWRcIik7XHJcblxyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdmVoaWNsZXMubGVuZ3RoOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZighdmVoaWNsZXNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGlmKHRoaXMuY2hlY2tDb2xsaXNpb24oYXZhdGFyT2JzdGFjbGVDb2xsaXNpb25DaXJjbGUsIHZlaGljbGVzW2ldKSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2ZWhpY2xlc1tpXS5oaXQodGhpcyk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU2NvcmVcclxuXHRcdFx0XHRcdHRoaXMubGV2ZWwuc3R5bGVTY29yZSArPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5zY29yZS52ZWhpY2xlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNocmluayBsb2Nrc1xyXG5cdFx0aWYodGhpcy5hYmlsaXRpZXMuc2hyaW5rKVxyXG5cdFx0e1xyXG5cdFx0XHRpZih0aGlzLmlzU2hyaW5raW5nKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIGxvY2tzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJzaHJpbmtfbG9ja1wiKTtcclxuXHJcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGxvY2tzLmxlbmd0aDsgaSsrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGlmKCFsb2Nrc1tpXS5pbnRlcmFjdGl2ZSkgY29udGludWU7XHJcblx0XHRcdFx0XHRpZih0aGlzLmNoZWNrQ29sbGlzaW9uKGF2YXRhck9ic3RhY2xlQ29sbGlzaW9uQ2lyY2xlLCBsb2Nrc1tpXSkpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGxvY2tzW2ldLmhpdCh0aGlzKVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFR1dG9yaWFsXHJcblx0XHR2YXIgdHV0b3JpYWxzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJ0dXRvcmlhbFwiKTtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdHV0b3JpYWxzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighdHV0b3JpYWxzW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHRcdFx0aWYodGhpcy5jaGVja0NvbGxpc2lvbihhdmF0YXJPYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSwgdHV0b3JpYWxzW2ldKSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHR1dG9yaWFsc1tpXS5oaXQodGhpcylcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEp1bXBcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUuanVtcCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaXNEZWFkKSByZXR1cm47XHJcblxyXG5cdGlmKHRoaXMuaXNHcm91bmRlZClcclxuXHR7XHJcblx0XHQvLyBBdm9pZCBqdW1waW5nIG9uIHN0ZWVwIHNsb3BlcyAob25seSB3b3JrcyB3aGVuIGdvaW5nIHJpZ2h0KVxyXG5cdFx0aWYodGhpcy5jb2xsaXNpb25Qb2ludCAmJiAodGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSAqIFBJWEkuUkFEX1RPX0RFRykgPCAtdGhpcy5qdW1wU2xvcGVBbmdsZU1heCkgcmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuY2FuRG91YmxlSnVtcCA9IHRydWU7XHJcblx0XHR0aGlzLmlzU2xpZGluZyAgICAgPSBmYWxzZTtcclxuXHRcdHRoaXMucm90YXRpb24gICAgICA9IDA7XHJcblx0XHR0aGlzLmFuZ2xlVGFyZ2V0ICAgPSAwO1xyXG5cdFx0dGhpcy5pc0dyb3VuZGVkICAgID0gZmFsc2U7XHJcblxyXG5cdFx0dGhpcy52ZWxvY2l0eS55ICAgID0gLXRoaXMuanVtcFNwZWVkO1xyXG5cdFx0dGhpcy5jYW5UdW1ibGUgICAgID0gdHJ1ZTtcclxuXHJcblx0XHRpZighdGhpcy5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHRcdHRoaXMuc2V0QW5pbWF0aW9uKCdqdW1wX25vcm1hbCcsIGZhbHNlKTtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbignanVtcF9ub3JtYWwnLCBmYWxzZSk7XHJcblxyXG5cdFx0Ly8gUGFydGljbGVzXHJcblx0XHR0aGlzLmRvdWJsZUp1bXBQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0XHQvLyBBdWRpb1xyXG5cdFx0dGhpcy5zdG9wTG9vcHMoKTtcclxuXHJcblx0XHRpZih0aGlzLmlzUmlkaW5nVmVoaWNsZSAmJiB0aGlzLnZlaGljbGUudHlwZSA9PSBcInN2ZW5cIilcclxuXHRcdFx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X3N2ZW5fanVtcF8wMFwiLCBcInNmeF9zdmVuX2p1bXBfMDFcIiwgXCJzZnhfc3Zlbl9qdW1wXzAyXCIsIFwic2Z4X3N2ZW5fanVtcF8wM1wiLCBcInNmeF9zdmVuX2p1bXBfMDRcIl0pO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19qdW1wXzAwXCIsIFwic2Z4X2dlbmVyaWNfanVtcF8wMVwiLCBcInNmeF9nZW5lcmljX2p1bXBfMDJcIl0pO1xyXG5cdH1cclxuXHRlbHNlIGlmKHRoaXMuY2FuRG91YmxlSnVtcCAmJiAhdGhpcy5pc1JpZGluZ1ZlaGljbGUgJiYgdGhpcy5hYmlsaXRpZXMuZG91YmxlSnVtcClcclxuXHR7XHJcblx0XHR0aGlzLmNhbkRvdWJsZUp1bXAgPSBmYWxzZTtcclxuXHJcblx0XHR0aGlzLnZlbG9jaXR5LnkgPSAtdGhpcy5kb3VibGVKdW1wU3BlZWQ7XHJcblxyXG5cdFx0dGhpcy5zZXRBbmltYXRpb24oJ2p1bXBfZG91YmxlJywgZmFsc2UpO1xyXG5cclxuXHRcdC8vIFBhcnRpY2xlc1xyXG5cdFx0dGhpcy5kb3VibGVKdW1wUFMuZW1pdCA9IHRydWU7XHJcblxyXG5cdFx0Ly8gQXVkaW9cclxuXHRcdHRoaXMuc3RvcExvb3BzKCk7XHJcblx0XHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19qdW1wXzAwXCIsIFwic2Z4X2dlbmVyaWNfanVtcF8wMVwiLCBcInNmeF9nZW5lcmljX2p1bXBfMDJcIl0pO1xyXG5cdH1cclxuXHJcblx0Ly8gRm9jdXMgUG9pbnRcclxuXHQgdGhpcy5sZXZlbC5jaGFuZ2VGb2N1c1BvaW50KHRoaXMuZm9jdXNQb2ludEp1bXAucG9pbnQsIHRoaXMuZm9jdXNQb2ludEp1bXAudGltZSwgdGhpcy5mb2N1c1BvaW50SnVtcC5kZWxheSk7XHJcbn07XHJcblxyXG4vKipcclxuICogSnVtcCBlbmQsIHdoZW4gdGhlIHBsYXllciBzdG9wcyBwcmVzc2luZyB0aGUganVtcCBidXR0b25cclxuICogQWxsb3dzIHZhcmlhYmxlIGhlaWdodCBqdW1wc1xyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5qdW1wRW5kID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5pc0RlYWQpIHJldHVybjtcclxuXHRpZih0aGlzLmlzR3JvdW5kZWQpIHJldHVybjtcclxuXHJcblx0aWYodGhpcy5jYW5Eb3VibGVKdW1wIHx8ICF0aGlzLmFiaWxpdGllcy5kb3VibGVKdW1wKVxyXG5cdHtcclxuXHRcdC8vIGNvbnNvbGUuaW5mbyhcIkp1bXAgZW5kXCIpO1xyXG5cdFx0aWYodGhpcy52ZWxvY2l0eS55IDwgLXRoaXMuanVtcFNwZWVkTWluICYmIHRoaXMudmVsb2NpdHkueSA+PSAtdGhpcy5qdW1wU3BlZWQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMudmVsb2NpdHkueSA9IC10aGlzLmp1bXBTcGVlZE1pbjtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdC8vIGNvbnNvbGUuaW5mbyhcIkRvdWJsZSBqdW1wIGVuZFwiKTtcclxuXHRcdGlmKHRoaXMudmVsb2NpdHkueSA8IC10aGlzLmRvdWJsZUp1bXBTcGVlZE1pbiAmJiB0aGlzLnZlbG9jaXR5LnkgPj0gLXRoaXMuZG91YmxlSnVtcFNwZWVkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnZlbG9jaXR5LnkgPSAtdGhpcy5kb3VibGVKdW1wU3BlZWRNaW47XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogTGFuZFxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5sYW5kID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5jYW5Eb3VibGVKdW1wID0gZmFsc2U7XHJcblxyXG5cdC8vIExhbmQgYW5pbWF0aW9uIGFuZCBzY3JlZW4gc2hha2UgaWYgZmFsbGluZyBmcm9tIGhpZ2hcclxuXHRpZih0aGlzLmZhbGxUaW1lID49IHRoaXMuZmFsbFRpbWVUb0xhbmQpXHJcblx0e1xyXG5cdFx0aWYoIXRoaXMuaXNSaWRpbmdWZWhpY2xlKVxyXG5cdFx0XHR0aGlzLnNldEFuaW1hdGlvbignbGFuZCcsIGZhbHNlKTtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy52ZWhpY2xlLnNldEFuaW1hdGlvbignbGFuZCcsIGZhbHNlKTtcclxuXHJcblx0XHR0aGlzLmxldmVsLnNoYWtlKDAuMjUsIG5ldyBQSVhJLlBvaW50KDgsMTIpKTtcclxuXHJcblx0XHQvLyBBdWRpb1xyXG5cdFx0aWYodGhpcy5kaXN0YW5jZSA+IDUpIC8vIERvbid0IHBsYXkgdGhlIHNvdW5kIHJpZ2h0IGF0IHRoZSBzdGFydCBvZiB0aGUgbGV2ZWxcclxuXHRcdFNvdW5kU0ZYLnBsYXlSYW5kb21Gcm9tKFtcInNmeF9nZW5lcmljX2xhbmRfaGVhdnlfMDBcIl0pO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0Ly8gQXVkaW9cclxuXHRcdGlmKHRoaXMuZGlzdGFuY2UgPiA1KSAvLyBEb24ndCBwbGF5IHRoZSBzb3VuZCByaWdodCBhdCB0aGUgc3RhcnQgb2YgdGhlIGxldmVsXHJcblx0XHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19sYW5kX3NvZnRfMDBcIl0pO1xyXG5cdH1cclxuXHJcblx0Ly8gVHVtYmxlXHJcblx0dGhpcy5pc1R1bWJsaW5nID0gZmFsc2U7XHJcblx0dmFyIHR1bWJsZVRpbWVzID0gTWF0aC5mbG9vcigodGhpcy5hbmltYXRpb25Ib2xkZXIucm90YXRpb24gKiBQSVhJLlJBRF9UT19ERUcgKyAxODApIC8zNjApO1xyXG5cclxuXHR0aGlzLmFuaW1hdGlvbkhvbGRlci5yb3RhdGlvbiA9IHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uICUgKE1hdGguUEkgKiAyKTtcclxuXHR2YXIgYW5nbGUgPSB0aGlzLmFuaW1hdGlvbkhvbGRlci5yb3RhdGlvbiAqIFBJWEkuUkFEX1RPX0RFRztcclxuXHJcblx0aWYoKHRoaXMudHVtYmxlRGVhdGhBbmdsZS5taW4gIT0gdGhpcy50dW1ibGVEZWF0aEFuZ2xlLm1heCkgJiYgKGFuZ2xlID4gdGhpcy50dW1ibGVEZWF0aEFuZ2xlLm1pbikgJiYgKGFuZ2xlIDwgdGhpcy50dW1ibGVEZWF0aEFuZ2xlLm1heCkgJiYgIXRoaXMuaXNJbW1vcnRhbClcclxuXHR7XHJcblx0XHQvLyBUdW1ibGUgZGVhdGhcclxuXHRcdHRoaXMuZGVhdGgoKTtcclxuXHR9XHJcblx0ZWxzZSBpZih0dW1ibGVUaW1lcyA+IDApXHJcblx0e1xyXG5cdFx0Ly8gVHVtYmxlIGJvbnVzXHJcblx0XHQvLyBjb25zb2xlLmxvZyhcIlR1bWJsZSAlaVwiLCB0dW1ibGVUaW1lcyk7XHJcblxyXG5cdFx0Ly8gR29hbHM6IHR1bWJsZVxyXG5cdFx0Q29tbW9uLmdvYWxzTWFuYWdlci50cmFja0V2ZW50KFwidHVtYmxlXCIpO1xyXG5cclxuXHRcdGlmKHR1bWJsZVRpbWVzID49IDIpXHJcblx0XHRcdENvbW1vbi5nb2Fsc01hbmFnZXIudHJhY2tFdmVudChcInR1bWJsZV9kb3VibGVcIik7XHJcblxyXG5cdFx0aWYodHVtYmxlVGltZXMgPj0gMylcclxuXHRcdFx0Q29tbW9uLmdvYWxzTWFuYWdlci50cmFja0V2ZW50KFwidHVtYmxlX3RyaXBsZVwiKTtcclxuXHJcblx0XHQvLyBTY29yZVxyXG5cdFx0Ly90aGlzLmxldmVsLnN0eWxlU2NvcmUgKz0gTWF0aC5wb3codGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuc2NvcmUudHVtYmxlLCB0dW1ibGVUaW1lcyk7XHJcblx0XHR0aGlzLmxldmVsLnN0eWxlU2NvcmUgKz0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuc2NvcmUudHVtYmxlICogTWF0aC5wb3coMiwgdHVtYmxlVGltZXMtMSk7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHQvLyBHb2FsczoganVtcFxyXG5cdFx0aWYodGhpcy5kaXN0YW5jZSA+IDUpIC8vIElnbm9yZSBmYWxsIGF0IHRoZSBzdGFydCBvZiB0aGUgbGV2ZWxcclxuXHRcdENvbW1vbi5nb2Fsc01hbmFnZXIudHJhY2tFdmVudChcImp1bXBcIik7XHJcblx0fVxyXG5cclxuXHQvLyBGb2N1cyBQb2ludFxyXG5cdHRoaXMubGV2ZWwuY2hhbmdlRm9jdXNQb2ludCh0aGlzLmZvY3VzUG9pbnRMYW5kLnBvaW50LCB0aGlzLmZvY3VzUG9pbnRMYW5kLnRpbWUsIHRoaXMuZm9jdXNQb2ludExhbmQuZGVsYXkpO1xyXG5cclxuXHQvLyBQYXJ0aWNsZXNcclxuXHRpZih0aGlzLmRpc3RhbmNlID4gNSkgLy8gSWdub3JlIGZhbGwgYXQgdGhlIHN0YXJ0IG9mIHRoZSBsZXZlbFxyXG5cdFx0dGhpcy5kb3VibGVKdW1wUFMuZW1pdCA9IHRydWU7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogRGVhdGhcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUuZGVhdGggPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLmlzRGVhZCkgcmV0dXJuO1xyXG5cdGlmKHRoaXMuaXNJbW1vcnRhbCkgcmV0dXJuO1xyXG5cdGlmKHRoaXMuaXNSaWRpbmdWZWhpY2xlKVxyXG5cdHtcclxuXHRcdHRoaXMudmVoaWNsZS5kaXNtb3VudCh0cnVlKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdHRoaXMuaXNEZWFkICAgICA9IHRydWU7XHJcblx0dGhpcy5pc1NsaWRpbmcgID0gZmFsc2U7XHJcblx0dGhpcy5pc1R1bWJsaW5nID0gZmFsc2U7XHJcblx0dGhpcy5pc1NsYXNoaW5nID0gZmFsc2U7XHJcblxyXG5cdHRoaXMucG93ZXJVbnNocmluaygpO1xyXG5cdHRoaXMudHJvbGxNYWdpY0VuZCgpO1xyXG5cclxuXHR0aGlzLnZlbG9jaXR5LnggPSAtMTAwMDtcclxuXHJcblx0dGhpcy5kZWF0aFR3ZWVuID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0dGhpcy5kZWF0aFR3ZWVuLnRvKHRoaXMudmVsb2NpdHksIDAuNSwge3g6IDAsIGVhc2U6Qm91bmNlLmVhc2VPdXR9LCAgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLmRlYXRoVHdlZW4pO1xyXG5cclxuXHJcblx0dGhpcy5zZXRBbmltYXRpb24oJ2xhbmRfYmFkJywgZmFsc2UpO1xyXG5cclxuXHR0aGlzLmxldmVsLmNoYW5nZUZvY3VzUG9pbnQodGhpcy5mb2N1c1BvaW50RGVhdGgucG9pbnQsIHRoaXMuZm9jdXNQb2ludERlYXRoLnRpbWUsIHRoaXMuZm9jdXNQb2ludERlYXRoLmRlbGF5KTtcclxuXHR0aGlzLmxldmVsLmNoYW5nZVpvb20odGhpcy56b29tRGVhdGguem9vbSwgdGhpcy56b29tRGVhdGgudGltZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwuZ2FtZU92ZXIoKTtcclxuXHR0aGlzLnN0b3BMb29wcygpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIEJyaWRnZSBwb3dlclxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5wb3dlckJyaWRnZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxuXHQvLyBpZih0aGlzLmlzR3JvdW5kZWQpIGNvbnNvbGUubG9nKHRoaXMuY29sbGlzaW9uUG9pbnQuYW5nbGUpO1xyXG5cclxuXHQvLyBpZih0aGlzLmlzR3JvdW5kZWQpIHJldHVybjtcclxuXHRpZih0aGlzLmlzVHVtYmxpbmcpICAgICAgIHJldHVybjtcclxuXHRpZighdGhpcy5jYW5DcmVhdGVCcmlkZ2UpIHJldHVybjtcclxuXHJcblx0aWYodGhpcy5pc0dyb3VuZGVkICYmICh0aGlzLmNvbGxpc2lvblBvaW50LmFuZ2xlICogUElYSS5SQURfVE9fREVHKSA8IC01KVxyXG5cdHtcclxuXHRcdC8vIEZhaWxzXHJcblx0XHR0aGlzLmJyaWRnZUZhaWxNYWdpY1BTLmVtaXQgPSB0cnVlO1xyXG5cdFx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X2Vsc2FfaWNlX21hZ2ljX3BsYXRmb3JtX2ZhaWxfMDBcIl0pO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0dGhpcy5pc1R1bWJsaW5nICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmNhblR1bWJsZSAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuY2FuQ3JlYXRlQnJpZGdlID0gZmFsc2U7XHJcblxyXG5cdC8vIENyZWF0ZSBhbiBhcnRpZmljaWFsIHBhdGhcclxuXHR2YXIgcG9pbnRzID0gW107XHJcblx0cG9pbnRzLnB1c2goe3g6dGhpcy54LCB5OnRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyArICh0aGlzLmlzR3JvdW5kZWQgPyAxMCA6IDUwKX0pO1xyXG5cclxuXHR2YXIgc2VnbWVudHMgICAgICA9IDQ7XHJcblx0dmFyIHNlZ21lbnRMZW5ndGggPSAyMDA7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBzZWdtZW50czsgaSsrKVxyXG5cdHtcclxuXHRcdHBvaW50c1tpKjMrMSsyXSA9IHt4OnRoaXMueCArIHNlZ21lbnRMZW5ndGggKiAoaSsxKSwgeTogcG9pbnRzWzBdLnkgKyAoaSAlIDIgPT0gMCA/IDEwIDogLTEwKX07XHJcblxyXG5cdFx0cG9pbnRzW2kqMysxXSA9IHt4OnRoaXMueCArIHNlZ21lbnRMZW5ndGggKiAoaSswLjMzKSwgeTogcG9pbnRzW2kqM10ueX07XHJcblx0XHRwb2ludHNbaSozKzErMV0gPSB7eDp0aGlzLnggKyBzZWdtZW50TGVuZ3RoICogKGkrMC42NiksIHk6IHBvaW50c1soaSsxKSozXS55fTtcclxuXHR9XHJcblxyXG5cdHZhciBwYXRoID1cclxuXHR7XHJcblx0XHRib3VuZHMgICAgICAgICAgICA6IFtwb2ludHNbMF0ueCwgcG9pbnRzW3BvaW50cy5sZW5ndGgtMV0ueF0sXHJcblx0XHRjbG9zZWQgICAgICAgICAgICA6IGZhbHNlLFxyXG5cdFx0Y29sbGlzaW9ucyAgICAgICAgOiAyLFxyXG5cdFx0ZGF0YSAgICAgICAgICAgICAgOiBcIlwiLFxyXG5cdFx0ZGVwdGggICAgICAgICAgICAgOiAtMSxcclxuXHRcdHBvaW50cyAgICAgICAgICAgIDogcG9pbnRzLFxyXG5cdFx0dGV4RmlsbCAgICAgICAgICAgOiBcIlwiLFxyXG5cdFx0dGV4RmlsbFBhZGRpbmcgICAgOiAwLFxyXG5cdFx0dGV4RmlsbFNpemUgICAgICAgOiAyNTYsXHJcblx0XHR0ZXhHcm91bmQgICAgICAgICA6IFwiZWxzYV9pY2VfZmxvd19ncm91bmRfMDBcIixcclxuXHRcdHRleEdyb3VuZERlbHRhICAgIDogMC4zLFxyXG5cdFx0dGV4R3JvdW5kRWRnZSAgICAgOiBcImVsc2FfaWNlX2Zsb3dfY2FwbF8wMFwiLFxyXG5cdFx0dGV4R3JvdW5kRWRnZVNpZGUgOiBcIlwiLFxyXG5cdFx0dGV4R3JvdW5kU2l6ZSAgICAgOiA2NCxcclxuXHRcdHRleFdhbGwgICAgICAgICAgIDogXCJcIixcclxuXHRcdHRleFdhbGxBbmdsZSAgICAgIDogNzAsXHJcblx0XHR0ZXhXYWxsRGVsdGEgICAgICA6IDAsXHJcblx0XHR0ZXhXYWxsU2l6ZSAgICAgICA6IDY0LFxyXG5cdFx0YXJ0aWZpY2lhbCAgICAgICAgOiB0cnVlXHJcblx0fVxyXG5cclxuXHR0aGlzLmxldmVsLmdldExheWVyKFwiYnJpZGdlXCIpLnF1ZXVlUGF0aHMoW3BhdGhdKTtcclxuXHJcblx0Ly8gQXVkaW9cclxuXHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDBcIiwgXCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDFcIiwgXCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDJcIiwgXCJzZnhfZWxzYV9pY2VfbWFnaWNfcGxhdGZvcm1fMDNcIl0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2xhc2ggcG93ZXJcclxuICovXHJcbkF2YXRhci5wcm90b3R5cGUucG93ZXJTbGFzaCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaXNUdW1ibGluZykgcmV0dXJuO1xyXG5cdGlmKHRoaXMuaXNTbGFzaGluZykgcmV0dXJuO1xyXG5cclxuXHR0aGlzLnNsYXNoU0ZYID0gU291bmRTRlgucGxheShcInNmeF9rcmlzdG9mZl9zd2luZ19heGVfMDJcIiwge2xvb3A6dHJ1ZX0pO1xyXG5cclxuXHR0aGlzLnNldEFuaW1hdGlvbigncnVuX2ZsYXRfbWFnaWMnLCB0cnVlKTtcclxuXHR0aGlzLmlzU2xhc2hpbmcgPSB0cnVlO1xyXG5cdHRoaXMuc2xhc2hUaW1lID0gMDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEludnVsbmVyYWJpbGl0eSBwb3dlclxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5wb3dlckludnVsbmVyYWJpbGl0eSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaXNUdW1ibGluZykgcmV0dXJuO1xyXG5cdGlmKHRoaXMuaXNJbnZ1bG5lcmFibGUpIHJldHVybjtcclxuXHQvLyBpZih0aGlzLmlzU2xpZGluZykgcmV0dXJuO1xyXG5cclxuXHR0aGlzLnNldEFuaW1hdGlvbigncnVuX2Rvd25fc3RlZXBfcm9sbGluZ19iYWxsJywgdHJ1ZSk7XHJcblx0dGhpcy5pc0ludnVsbmVyYWJsZSA9IHRydWU7XHJcblx0dGhpcy5pbnZ1bG5lcmFiaWxpdHlUaW1lID0gMDtcclxuXHJcblx0dGhpcy5jYW5UdW1ibGUgPSBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNocmluayBwb3dlclxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5wb3dlclNocmluayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaXNTaHJpbmtpbmcpICAgIHJldHVybjtcclxuXHRpZih0aGlzLmlzVW5zaHJpbmtpbmcpICByZXR1cm47XHJcblx0aWYodGhpcy5pc1Nocmlua0xvY2tlZCkgcmV0dXJuO1xyXG5cdGlmKHRoaXMuaXNUdW1ibGluZykgICAgIHJldHVybjtcclxuXHJcblx0dGhpcy5pc1Nocmlua2luZyAgICA9IHRydWU7XHJcblx0dGhpcy5zaHJpbmtUaW1lICAgICA9IDA7XHJcblx0dGhpcy5pc1Nocmlua0xvY2tlZCA9IGZhbHNlO1xyXG5cdHRoaXMuY2FuVHVtYmxlICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLnBvc2l0aW9uQ2FjaGUgID0gW107XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdHRsLnRvKHRoaXMuY29sbGlzaW9uQ2lyY2xlLCB0aGlzLnNocmlua1RyYW5zaXRpb25UaW1lLCB7cmFkaXVzOjM1LCBlYXNlOkxpbmVhci5lYXNlTm9uZSwgb25VcGRhdGU6ZnVuY3Rpb24oKXt0aGlzLnNwaW5lLnkgPSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXM7IGlmKHRoaXMubGV2ZWwuZGVidWcpe3RoaXMuZHJhd0NvbGxpc2lvbigpO319LCBvblVwZGF0ZVNjb3BlOnRoaXN9LDApO1xyXG5cdC8vIHRsLnRvKHRoaXMuYW5pbWF0aW9uSG9sZGVyLnNjYWxlLCB0aGlzLnNocmlua1RyYW5zaXRpb25UaW1lLCB7eDowLjUsIHk6MC41LCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sMCk7XHJcblxyXG5cdGZvcih2YXIgcCA9IDA7IHAgPCB0aGlzLnNocmlua1BpZWNlcy5sZW5ndGg7IHArKylcclxuXHR7XHJcblx0XHR0aGlzLnNocmlua1BpZWNlc1twXS54ID0gMDtcclxuXHRcdHRoaXMuc2hyaW5rUGllY2VzW3BdLnkgPSAwO1xyXG5cdFx0dGwudG8odGhpcy5zaHJpbmtQaWVjZXNbcF0sIHRoaXMuc2hyaW5rVHJhbnNpdGlvblRpbWUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZU91dH0sMCk7XHJcblx0fVxyXG5cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVuc2hyaW5rXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLnBvd2VyVW5zaHJpbmsgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZighdGhpcy5pc1Nocmlua2luZykgIHJldHVybjtcclxuXHRpZih0aGlzLmlzVW5zaHJpbmtpbmcpIHJldHVybjtcclxuXHJcblx0dGhpcy5pc1Nocmlua2luZyAgICA9IGZhbHNlO1xyXG5cdHRoaXMuaXNVbnNocmlua2luZyAgPSB0cnVlO1xyXG5cdHRoaXMuc2hyaW5rVGltZSAgICAgPSAwO1xyXG5cdHRoaXMuaXNTaHJpbmtMb2NrZWQgPSBmYWxzZTtcclxuXHR0aGlzLmNhblR1bWJsZSAgICAgID0gdHJ1ZTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuaXNVbnNocmlua2luZyA9IGZhbHNlfX0pO1xyXG5cdHRsLnRvKHRoaXMuY29sbGlzaW9uQ2lyY2xlLCB0aGlzLnNocmlua1RyYW5zaXRpb25UaW1lLCB7cmFkaXVzOjU1LCBlYXNlOkxpbmVhci5lYXNlTm9uZSwgb25VcGRhdGU6ZnVuY3Rpb24oKXt0aGlzLnNwaW5lLnkgPSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXM7IGlmKHRoaXMubGV2ZWwuZGVidWcpe3RoaXMuZHJhd0NvbGxpc2lvbigpO319LCBvblVwZGF0ZVNjb3BlOnRoaXN9LDApO1xyXG5cdC8vIHRsLnRvKHRoaXMuYW5pbWF0aW9uSG9sZGVyLnNjYWxlLCB0aGlzLnNocmlua1RyYW5zaXRpb25UaW1lLCB7eDoxLCB5OjEsIGVhc2U6TGluZWFyLmVhc2VOb25lfSwwKTtcclxuXHJcblx0Zm9yKHZhciBwID0gMDsgcCA8IHRoaXMuc2hyaW5rUGllY2VzLmxlbmd0aDsgcCsrKVxyXG5cdHtcclxuXHRcdHRsLnRvKHRoaXMuc2hyaW5rUGllY2VzW3BdLCB0aGlzLnNocmlua1RyYW5zaXRpb25UaW1lLCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sMCk7XHJcblx0fVxyXG5cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBUcm9sbCBtYWdpY1xyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS50cm9sbE1hZ2ljID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5pc1Ryb2xsTWFnaWMgICAgICA9IHRydWU7XHJcblx0dGhpcy50cm9sbE1hZ2ljVGltZSAgICArPSB0aGlzLnRyb2xsTWFnaWNEdXJhdGlvbjtcclxuXHR0aGlzLnRyb2xsTWFnaWNQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0Q29tbW9uLmJnTXVzaWMuc3RvcCgpO1xyXG5cdENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgMjAwKTtcclxuXHRDb21tb24uYmdNdXNpYyA9IFNvdW5kU0ZYLnBsYXkoXCJteF90cm9sbF9tYWdpY19ydXNoX2xvb3BfMDJcIiwge2xvb3A6dHJ1ZX0pO1xyXG5cdENvbW1vbi5iZ011c2ljLmZhZGVJbihDb21tb24uYmdNdXNpY1ZvbHVtZSwgMjAwKTtcclxufVxyXG5cclxuQXZhdGFyLnByb3RvdHlwZS50cm9sbE1hZ2ljRW5kID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLmlzVHJvbGxNYWdpYylcclxuXHR7XHJcblx0XHR0aGlzLmlzVHJvbGxNYWdpYyAgICAgID0gZmFsc2U7XHJcblx0XHR0aGlzLnRyb2xsTWFnaWNUaW1lID0gMDtcclxuXHRcdHRoaXMudHJvbGxNYWdpY1BTLmVtaXQgPSBmYWxzZTtcclxuXHJcblx0XHRDb21tb24uYmdNdXNpYy5zdG9wKCk7XHJcblx0XHRDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDIwMCk7XHJcblx0XHRDb21tb24uYmdNdXNpYyA9IFNvdW5kU0ZYLnBsYXkoXCJteF9mcm96ZW5fMDFfZ2FtZXBsYXlfbHBcIik7XHJcblx0XHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDEwMCk7XHJcblx0fVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFNldCBhIHNwaW5lIGFuaW1hdGlvblxyXG4gKiBAcGFyYW0ge1N0cmluZ30gaWRcclxuICogQHBhcmFtIHtCb29sZWFufSBsb29wXHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uKGlkLCBsb29wKVxyXG57XHJcblx0aWYobG9vcCAmJiBpZCA9PSB0aGlzLmN1cnJlbnRBbmltYXRpb24pIHJldHVybjtcclxuXHJcblx0aWYodGhpcy5pc1Nocmlua2luZyAmJiBpZCAhPSBcInJ1bl9yb2xsXCIgJiYgaWQgIT0gXCJyaWRlX3N2ZW5cIiAmJiBpZCAhPSBcInJpZGVfc2xlZFwiICkgcmV0dXJuO1xyXG5cclxuXHRpZih0aGlzLmN1cnJlbnRBbmltYXRpb24gPT0gXCJsYW5kXCIpXHJcblx0XHR0aGlzLnNwaW5lLnN0YXRlLmFkZEFuaW1hdGlvbkJ5TmFtZSgwLCBpZCwgbG9vcCwgMC4yKTtcclxuXHRlbHNlXHJcblx0XHR0aGlzLnNwaW5lLnN0YXRlLnNldEFuaW1hdGlvbkJ5TmFtZSgwLCBpZCwgbG9vcCwgMCk7XHJcblxyXG5cdHRoaXMuY3VycmVudEFuaW1hdGlvbiA9IGlkO1xyXG59XHJcblxyXG4vKipcclxuICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAqL1xyXG5BdmF0YXIucHJvdG90eXBlLmlzT2xhZiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHJldHVybiBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcIm9sYWZcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5pc0tyaXN0b2ZmID0gZnVuY3Rpb24oKVxyXG57XHJcblx0cmV0dXJuIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwia3Jpc3RvZmZcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gKi9cclxuQXZhdGFyLnByb3RvdHlwZS5pc1BhYmJpZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHJldHVybiBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcInBhYmJpZVwiO1xyXG59XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEF2YXRhci5wcm90b3R5cGUsIFwiZGlyZWN0aW9uXCIsIHtcclxuXHJcblx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiBNYXRoLnNpZ24odGhpcy5zY2FsZS54KTtcclxuXHR9XHJcbn0pO1xyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEF2YXRhci5wcm90b3R5cGUsIFwiZGlzdGFuY2VcIiwge1xyXG5cclxuXHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIE1hdGguZmxvb3IodGhpcy54L0NvbW1vbi5zYXZlZERhdGEudW5pdCk7XHJcblx0fVxyXG59KTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIsInZhciBDb21tb24gICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmZ1bmN0aW9uIEdhbWVPYmplY3QodHlwZSwgcmVtb3ZlSWZPdXRzaWRlQm91bmRhcnkpXHJcbntcclxuICAgIHRoaXMuX2Fzc2V0TWFuYWdlciAgICA9IHAzLkFzc2V0TWFuYWdlci5pbnN0YW5jZTtcclxuXHJcbiAgICB0aGlzLnNpZ25hbHMgICAgICAgICAgPSB7fTtcclxuICAgIHRoaXMuc2lnbmFscy5kaXNwb3NlZCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuICAgIHRoaXMuaWQgICAgICAgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMudHlwZSAgICAgICAgICAgICAgPSB0eXBlO1xyXG5cdHRoaXMuY29sbGlzaW9uUmVjdCAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlICAgPSBudWxsO1xyXG5cdHRoaXMuYXJlYVJlY3QgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLnJlbW92ZVdoZW5PdXRzaWRlID0gdHJ1ZTtcclxuXHRcclxuXHR0aGlzLmNvbGxpc2lvbkdyYXBoaWMgPSBudWxsO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZU9iamVjdDtcclxuR2FtZU9iamVjdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkdhbWVPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2FtZU9iamVjdDtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5HYW1lT2JqZWN0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFxyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5HYW1lT2JqZWN0LnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMueCA9IDA7XHJcblx0dGhpcy55ID0gMDtcclxuICAgIHRoaXMucmVtb3ZlTWUgPSBmYWxzZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuR2FtZU9iamVjdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuc2lnbmFscy5kaXNwb3NlZC5kaXNwYXRjaCh0aGlzKTtcclxuICAgIHRoaXMucmVtb3ZlZCA9IHRydWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuR2FtZU9iamVjdC5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIFxyXG59XHJcblxyXG4vKipcclxuICovXHJcbkdhbWVPYmplY3QucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgXHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuR2FtZU9iamVjdC5wcm90b3R5cGUuZHJhd0NvbGxpc2lvbiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCEhdGhpcy5jb2xsaXNpb25HcmFwaGljKVxyXG5cdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLmNvbGxpc2lvbkdyYXBoaWMpO1xyXG5cdFxyXG4gICAgdGhpcy5jb2xsaXNpb25HcmFwaGljID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5jb2xsaXNpb25HcmFwaGljKTtcclxuICAgIHRoaXMuY29sbGlzaW9uR3JhcGhpYy5saW5lU3R5bGUoMiwgMHhGNzExMUQpO1xyXG5cdFxyXG5cdGlmKHRoaXMuY29sbGlzaW9uUmVjdCAhPSBudWxsKVxyXG5cdFx0dGhpcy5jb2xsaXNpb25HcmFwaGljLmRyYXdSZWN0KHRoaXMuY29sbGlzaW9uUmVjdC54LCB0aGlzLmNvbGxpc2lvblJlY3QueSwgdGhpcy5jb2xsaXNpb25SZWN0LndpZHRoLCB0aGlzLmNvbGxpc2lvblJlY3QuaGVpZ2h0KTtcclxuXHRlbHNlIGlmKHRoaXMuY29sbGlzaW9uQ2lyY2xlICE9IG51bGwpXHJcblx0XHR0aGlzLmNvbGxpc2lvbkdyYXBoaWMuZHJhd0NpcmNsZSh0aGlzLmNvbGxpc2lvbkNpcmNsZS54LCB0aGlzLmNvbGxpc2lvbkNpcmNsZS55LCB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMpO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBHYW1lVUkobGV2ZWwpXHJcbntcclxuXHR0aGlzLl9hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5sZXZlbCA9IGxldmVsO1xyXG5cclxuXHR0aGlzLl9jYW5TaG93R29hbCAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5fZ29hbHNRdWV1ZSAgICAgICA9IFtdO1xyXG5cdHRoaXMuX3Byb2dyZXNzQmFyV2lkdGggPSAwO1xyXG5cdHRoaXMuX2NoYXJhY3RlckRhdGEgICAgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5jaGFyYWN0ZXJzW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXTtcclxuXHR0aGlzLl9jcnlzdGFscyAgICAgICAgID0gW107XHJcblx0dGhpcy5fY3J5c3RhbFBhcnRpY2xlcyA9IFtdO1xyXG5cdHRoaXMuX2NyeXN0YWxTd2lybFBhcnRpY2xlID0gbnVsbDtcclxuXHJcblx0dGhpcy5fY2hhcmFjdGVycyA9IFtcImFubmFcIiwgXCJrcmlzdG9mZlwiLCBcIm9sYWZcIiwgXCJlbHNhXCJdO1xyXG5cclxuXHR0aGlzLl9nb2FscyA9IENvbW1vbi5nb2Fsc01hbmFnZXIuZ2V0QWN0aXZlR29hbHMoKTtcclxuXHJcblx0dGhpcy5fdG9wQ29udGFpbmVyVHdlZW4gPSBudWxsO1xyXG5cdHRoaXMuX3R1dG9yaWFsVHdlZW4gPSBudWxsO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZVVJO1xyXG5HYW1lVUkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQSVhJLkNvbnRhaW5lci5wcm90b3R5cGUpO1xyXG5HYW1lVUkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2FtZVVJO1xyXG5cclxuLyoqXHJcbiAqIEluaXRcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIFNpZGUgc3RhdHMgLSBjb2luc1xyXG5cdHRoaXMuX2NvaW5zQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5fY29pbnNDb250YWluZXIueSA9IDYwO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fY29pbnNDb250YWluZXIpO1xyXG5cclxuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl9iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3Nub3dmbGFrZV9iZ1wiKSk7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fYmcuYW5jaG9yLnNldCgwLCAwLjUpO1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX2JnLnNjYWxlLnNldCgwLjgpO1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX2JnLnggKz0gMTA7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9jb2luc0NvbnRhaW5lci5fYmcpO1xyXG5cclxuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoXCIwXCIsIHtmb250OiBcIjI4cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueCA9IC10aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMiAgKyB0aGlzLl9jb2luc0NvbnRhaW5lci53aWR0aC8yICsgMTg7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC55ID0gLXRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnRleHRIZWlnaHQvMjtcclxuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0KTtcclxuXHJcblx0XHQvLyB0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dCA9IG5ldyBQSVhJLlRleHQoXCI/XCIsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4ZmZmZmZmLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0Ly8gdGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueCA9IHRoaXMuX2NvaW5zQ29udGFpbmVyLndpZHRoLzIgKyAxNztcclxuXHRcdC8vIHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdC8vIHRoaXMuX2NvaW5zQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0KTtcclxuXHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9nYW1lcGxheV9zbm93Zmxha2VcIikpO1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3Nub3dmbGFrZS54ID0gMTU7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UpO1xyXG5cclxuXHQvLyBTaWRlIHN0YXRzIC0gc3R5bGVcclxuXHR0aGlzLl9zdHlsZUNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdHRoaXMuX3N0eWxlQ29udGFpbmVyLnkgPSB0aGlzLl9jb2luc0NvbnRhaW5lci55ICsgNjU7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9zdHlsZUNvbnRhaW5lcik7XHJcblxyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuX2JnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc25vd2ZsYWtlX2JnXCIpKTtcclxuXHRcdHRoaXMuX3N0eWxlQ29udGFpbmVyLl9iZy5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci5fYmcuc2NhbGUuc2V0KDAuOCk7XHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci5fYmcueCArPSAxMDtcclxuXHRcdHRoaXMuX3N0eWxlQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX3N0eWxlQ29udGFpbmVyLl9iZyk7XHJcblxyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIjBcIiwge2ZvbnQ6IFwiMjhweCBTdXBlcmNsYXJlbmRvbiBOdW1iZXJzXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC54ID0gLXRoaXMuX3N0eWxlQ29udGFpbmVyLl90ZXh0LnRleHRXaWR0aC8yICArIHRoaXMuX3N0eWxlQ29udGFpbmVyLndpZHRoLzIgKyAxODtcclxuXHRcdHRoaXMuX3N0eWxlQ29udGFpbmVyLl90ZXh0LnkgPSAtdGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQpO1xyXG5cclxuXHRcdC8vIHRoaXMuX3N0eWxlQ29udGFpbmVyLl90ZXh0ID0gbmV3IFBJWEkuVGV4dChcIj9cIiwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHQvLyB0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC54ID0gdGhpcy5fc3R5bGVDb250YWluZXIud2lkdGgvMiArIDE3O1xyXG5cdFx0Ly8gdGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0Ly8gdGhpcy5fc3R5bGVDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQpO1xyXG5cclxuXHRcdHZhciBzbm93Zmxha2UgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2dhbWVwbGF5X3N0eWxlXCIpKTtcclxuXHRcdHNub3dmbGFrZS54ID0gMTU7XHJcblx0XHRzbm93Zmxha2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuYWRkQ2hpbGQoc25vd2ZsYWtlKTtcclxuXHJcblx0Ly8gU2lkZSBzdGF0cyAtIGRpc3RhbmNlXHJcblx0aWYodGhpcy5sZXZlbC5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci55ID0gdGhpcy5fY29pbnNDb250YWluZXIueSArIDEzMDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fZGlzdGFuY2VDb250YWluZXIpO1xyXG5cclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX2JnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc25vd2ZsYWtlX2JnXCIpKTtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX2JnLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX2JnLnNjYWxlLnNldCgwLjgpO1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fYmcueCArPSAxMDtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fZGlzdGFuY2VDb250YWluZXIuX2JnKTtcclxuXHJcblx0XHRcdHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoXCIwXCIsIHtmb250OiBcIjI4cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC54ID0gLXRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0LnRleHRXaWR0aC8yICArIHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLndpZHRoLzIgKyAxODtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX3RleHQueSA9IC10aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC50ZXh0SGVpZ2h0LzI7XHJcblx0XHRcdHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0KTtcclxuXHJcblx0XHRcdC8vIHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0ID0gbmV3IFBJWEkuVGV4dChcIj9cIiwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdC8vIHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0LnggPSB0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci53aWR0aC8yICsgMTc7XHJcblx0XHRcdC8vIHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0Ly8gdGhpcy5fZGlzdGFuY2VDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fZGlzdGFuY2VDb250YWluZXIuX3RleHQpO1xyXG5cclxuXHRcdFx0dmFyIHNub3dmbGFrZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fZ2FtZXBsYXlfZGlzdGFuY2VcIikpO1xyXG5cdFx0XHRzbm93Zmxha2UueCA9IDE1O1xyXG5cdFx0XHRzbm93Zmxha2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5hZGRDaGlsZChzbm93Zmxha2UpO1xyXG5cdH1cclxuXHJcblxyXG5cdC8vIExldmVsIC0gQ3J5c3RhbHNcclxuXHRpZighdGhpcy5sZXZlbC5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdHRoaXMuX3RvcENvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0dGhpcy5fdG9wQ29udGFpbmVyLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHRcdHRoaXMuX3RvcENvbnRhaW5lci55ID0gNzA7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuX3RvcENvbnRhaW5lcik7XHJcblxyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgIT0gXCJwYWJiaWVcIilcclxuXHRcdHtcclxuXHRcdFx0dmFyIGxldmVsQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJpbmdhbWVfbGV2ZWxfYmdcIikpO1xyXG5cdFx0XHRsZXZlbEJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGhpcy5fdG9wQ29udGFpbmVyLmFkZENoaWxkKGxldmVsQmcpO1xyXG5cclxuXHRcdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkxFVkVMXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHkucmVwbGFjZShcInt2YWx1ZX1cIiwgKENvbW1vbi5zYXZlZERhdGEubGV2ZWwrMSkpLCB7Zm9udDogXCIyNHB4IFN1cGVyY2xhcmVuZG9uIExldmVsXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdFx0XHR0ZXh0LnggPSAtdGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiAtIDg7XHJcblx0XHRcdFx0XHR0ZXh0LmFscGhhID0gMC42NTtcclxuXHRcdFx0XHRcdGxldmVsQmcuYWRkQ2hpbGQodGV4dCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weS5yZXBsYWNlKFwie3ZhbHVlfVwiLCAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSksIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4NmQ1MzRhLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0XHR0ZXh0LnkgLT0gNDtcclxuXHRcdFx0XHRcdGxldmVsQmcuYWRkQ2hpbGQodGV4dCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBDcnlzdGFsIGNvbnRhaW5lclxyXG5cdFx0XHRcdHRoaXMuX2NyeXN0YWxzQ29udGFpbmVyID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbG9hZGluZ19jcnlzdGFsc19iZ1wiKSk7XHJcblx0XHRcdFx0dGhpcy5fY3J5c3RhbHNDb250YWluZXIuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdHRoaXMuX2NyeXN0YWxzQ29udGFpbmVyLnkgPSA2MFxyXG5cdFx0XHRcdHRoaXMuX3RvcENvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9jcnlzdGFsc0NvbnRhaW5lcik7XHJcblxyXG5cdFx0XHRcdHZhciBjcnlzdGFsc1Bvc2l0aW9uID1cclxuXHRcdFx0XHRbXHJcblx0XHRcdFx0XHR7eDo3MywgIHk6MTYxfSxcclxuXHRcdFx0XHRcdHt4OjEzNywgeToxNTd9LFxyXG5cdFx0XHRcdFx0e3g6MjA0LCB5OjE3MH0sXHJcblx0XHRcdFx0XHR7eDoyNjYsIHk6MTgwfSxcclxuXHRcdFx0XHRcdHt4OjMzNiwgeToxODB9LFxyXG5cdFx0XHRcdFx0e3g6NDA1LCB5OjE5MX0sXHJcblx0XHRcdFx0XHR7eDo0NjUsIHk6MTgwfSxcclxuXHRcdFx0XHRcdHt4OjUyNiwgeToxNzB9LFxyXG5cdFx0XHRcdFx0e3g6NTc4LCB5OjE4M30sXHJcblx0XHRcdFx0XHR7eDo2NDQsIHk6MTc0fSxcclxuXHRcdFx0XHRcdHt4OjcxNSwgeToxNTJ9LFxyXG5cdFx0XHRcdFx0e3g6NzkwLCB5OjEyOX1cclxuXHRcdFx0XHRdO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAxOyBpIDw9IDEyOyBpKyspXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Ly8gU3ByaXRlXHJcblx0XHRcdFx0XHR2YXIgY3J5c3RhbCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2xvYWRpbmdfY3J5c3RhbHNfXCIgKyBpKSk7XHJcblx0XHRcdFx0XHRjcnlzdGFsLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdFx0XHRcdGNyeXN0YWwuYWxwaGEgPSBDb21tb24uc2F2ZWREYXRhLmlzQ3J5c3RhbENvbGxlY3RlZChDb21tb24uc2F2ZWREYXRhLmxldmVsLCB0aGlzLl9jaGFyYWN0ZXJzW01hdGguZmxvb3IoKGktMSkvMyldLCAoaS0xKSUzKSA/IDEgOiAwO1xyXG5cdFx0XHRcdFx0dGhpcy5fY3J5c3RhbHNDb250YWluZXIuYWRkQ2hpbGQoY3J5c3RhbCk7XHJcblx0XHRcdFx0XHR0aGlzLl9jcnlzdGFscy5wdXNoKGNyeXN0YWwpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFBhcnRpY2xlIGVmZmVjdFxyXG5cdFx0XHRcdFx0dmFyIGNvbG91ciA9IENvbW1vbi5zYXZlZERhdGEuZ2V0Q29sb3JCeUNoYXJhY3Rlcih0aGlzLl9jaGFyYWN0ZXJzW01hdGguZmxvb3IoKGktMSkvMyldKTtcclxuXHJcblx0XHRcdFx0XHR2YXIgcGFydGljbGUgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLl9jcnlzdGFsc0NvbnRhaW5lcixcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlXzAwXCIpLFxyXG5cdFx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfMDFcIiksXHJcblx0XHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV8wMlwiKSxcclxuXHRcdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlXzAzXCIpLFxyXG5cdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfZ2VtX1wiICsgY29sb3VyICsgXCJfZW5kaW5nXCIpKTtcclxuXHJcblx0XHRcdFx0XHRwYXJ0aWNsZS5lbWl0ID0gZmFsc2U7XHJcblx0XHRcdFx0XHRwYXJ0aWNsZS51cGRhdGVTcGF3blBvcygtdGhpcy5fY3J5c3RhbHNDb250YWluZXIud2lkdGgvMiArIGNyeXN0YWxzUG9zaXRpb25baS0xXS54LzIsIC10aGlzLl9jcnlzdGFsc0NvbnRhaW5lci5oZWlnaHQvMiArIGNyeXN0YWxzUG9zaXRpb25baS0xXS55LzIpO1xyXG5cdFx0XHRcdFx0dGhpcy5fY3J5c3RhbFBhcnRpY2xlcy5wdXNoKHBhcnRpY2xlKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIFN3aXJsXHJcblx0XHRcdFx0Ly8gdGhpcy5fY3J5c3RhbFN3aXJsUGFydGljbGUgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLl9jcnlzdGFsc0NvbnRhaW5lcixcclxuXHRcdFx0XHQvLyBbXHJcblx0XHRcdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfMDBcIiksXHJcblx0XHRcdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfMDFcIiksXHJcblx0XHRcdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfMDJcIiksXHJcblx0XHRcdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfMDNcIiksXHJcblx0XHRcdFx0Ly8gXSxcclxuXHRcdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX2VuZF9zd2lybHRyYWlsXzAwXCIpKTtcclxuXHRcdFx0XHQvLyB0aGlzLl9jcnlzdGFsU3dpcmxQYXJ0aWNsZS5lbWl0ID0gZmFsc2U7XHJcblx0XHRcdFx0Ly8gdGhpcy5fY3J5c3RhbFN3aXJsUGFydGljbGUudXBkYXRlU3Bhd25Qb3MoY3J5c3RhbC54IC0gKGNyeXN0YWwud2lkdGgvMikgKyAoKGNyeXN0YWwud2lkdGgvMTIpKih0aGlzLl9jaGFyYWN0ZXJzLmluZGV4T2YoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpKjMpKSwgY3J5c3RhbC5oZWlnaHQgLSA1MCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdC8vIEN1cnJlbnQgbGV2ZWxcclxuXHRcdFx0dmFyIGxldmVsX2JnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbGV2ZWxfYmdfdHJvbGxcIikpO1xyXG5cdFx0XHRsZXZlbF9iZy5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMuX3RvcENvbnRhaW5lci5hZGRDaGlsZChsZXZlbF9iZyk7XHJcblxyXG5cdFx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiTEVWRUxcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weS5yZXBsYWNlKFwie3ZhbHVlfVwiLCAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSksIHtmb250OiBcIjI2cHggU3VwZXJjbGFyZW5kb24gTGV2ZWxcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0XHRcdHRleHQueCA9IC10ZXh0LnRleHRXaWR0aC8yICAtIDQwO1xyXG5cdFx0XHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yIC0gODtcclxuXHRcdFx0XHRcdGxldmVsX2JnLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KFwiTGV2ZWwgXCIgKyAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0XHR0ZXh0LnggPSAtIDQwO1xyXG5cdFx0XHRcdFx0dGV4dC55ID0gLTY7XHJcblx0XHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRcdGxldmVsX2JnLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dmFyIHRyb2xsQ29sbGVjdGVkID0gQ29tbW9uLnNhdmVkRGF0YS5nZXRMZXZlbENvbGxlY3RlZFRyb2xsQ291bnQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCk7XHJcblx0XHRcdFx0dmFyIHRyb2xsQ291bnQgPSAzO1xyXG5cclxuXHRcdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0aGlzLl90cm9sbENvdW50ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQodHJvbGxDb2xsZWN0ZWQgKyBcIi9cIiArIHRyb2xsQ291bnQsIHtmb250OiBcIjMycHggU3VwZXJjbGFyZW5kb24gTGV2ZWxcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0XHRcdHRoaXMuX3Ryb2xsQ291bnQueCA9IC10aGlzLl90cm9sbENvdW50LnRleHRXaWR0aC8yICArIDEyMDtcclxuXHRcdFx0XHRcdHRoaXMuX3Ryb2xsQ291bnQueSA9IC10aGlzLl90cm9sbENvdW50LnRleHRIZWlnaHQvMiAtIDEyO1xyXG5cdFx0XHRcdFx0bGV2ZWxfYmcuYWRkQ2hpbGQodGhpcy5fdHJvbGxDb3VudCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0aGlzLl90cm9sbENvdW50ID0gbmV3IFBJWEkuVGV4dCh0cm9sbENvbGxlY3RlZCArIFwiL1wiICsgdHJvbGxDb3VudCwge2ZvbnQ6XCIzMnB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0XHR0aGlzLl90cm9sbENvdW50LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRcdHRoaXMuX3Ryb2xsQ291bnQueCArPSAxMjA7XHJcblx0XHRcdFx0XHR0aGlzLl90cm9sbENvdW50LnkgKz0gLTEyO1xyXG5cdFx0XHRcdFx0bGV2ZWxfYmcuYWRkQ2hpbGQodGhpcy5fdHJvbGxDb3VudCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGlzLl90cm9sbENvdW50LnRyb2xsQ29sbGVjdGVkID0gdHJvbGxDb2xsZWN0ZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gSGlkZSBjcnlzdGFscyBVSSBhZnRlciBhIHdoaWxlXHJcblx0XHR0aGlzLl90b3BDb250YWluZXJUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5fdG9wQ29udGFpbmVyVHdlZW4udG8odGhpcy5fdG9wQ29udGFpbmVyLCAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAyKTtcclxuXHRcdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5fdG9wQ29udGFpbmVyVHdlZW4pO1xyXG5cdH1cclxuXHJcblx0Ly8gUHJvZ3Jlc3MgYmFyXHJcblx0aWYoIXRoaXMubGV2ZWwuZW5kbGVzcylcclxuXHR7XHJcblx0XHR0aGlzLnByb2dyZXNzQmFyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0XHR0aGlzLnByb2dyZXNzQmFyLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMiAtIHRoaXMucHJvZ3Jlc3NCYXIud2lkdGgvMjtcclxuXHRcdHRoaXMucHJvZ3Jlc3NCYXIueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLSA2MDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5wcm9ncmVzc0JhcilcclxuXHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuY2FwTGVmdCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9wcm9ncmVzc19jYXBfXCIgKyB0aGlzLl9jaGFyYWN0ZXJEYXRhLmNvbG9yICsgXCJfbFwiKSk7XHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuY2FwTGVmdC5hbmNob3Iuc2V0KDEsIDAuNSk7XHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuYWRkQ2hpbGQodGhpcy5wcm9ncmVzc0Jhci5jYXBMZWZ0KTtcclxuXHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuY2FwUmlnaHQgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJpbmdhbWVfcHJvZ3Jlc3NfY2FwX1wiICsgdGhpcy5fY2hhcmFjdGVyRGF0YS5jb2xvciArIFwiX3JcIikpO1xyXG5cdFx0XHR0aGlzLnByb2dyZXNzQmFyLmNhcFJpZ2h0LmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHRcdFx0dGhpcy5wcm9ncmVzc0Jhci5hZGRDaGlsZCh0aGlzLnByb2dyZXNzQmFyLmNhcFJpZ2h0KTtcclxuXHJcblx0XHRcdHZhciB0ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJpbmdhbWVfcHJvZ3Jlc3NfYmFyX1wiICsgdGhpcy5fY2hhcmFjdGVyRGF0YS5jb2xvciArIFwiX29mZlwiKTtcclxuXHRcdFx0dGhpcy5wcm9ncmVzc0Jhci5iYXJCZyA9IG5ldyBQSVhJLmV4dHJhcy5UaWxpbmdTcHJpdGUodGV4dHVyZSwgMCwgdGV4dHVyZS5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLnByb2dyZXNzQmFyLmJhckJnLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHRcdFx0dGhpcy5wcm9ncmVzc0Jhci5hZGRDaGlsZCh0aGlzLnByb2dyZXNzQmFyLmJhckJnKTtcclxuXHJcblx0XHRcdHZhciB0ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJpbmdhbWVfcHJvZ3Jlc3NfYmFyX1wiICsgdGhpcy5fY2hhcmFjdGVyRGF0YS5jb2xvciArIFwiX29uXCIpO1xyXG5cdFx0XHR0aGlzLnByb2dyZXNzQmFyLmJhciA9IG5ldyBQSVhJLmV4dHJhcy5UaWxpbmdTcHJpdGUodGV4dHVyZSwgMCwgdGV4dHVyZS5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLnByb2dyZXNzQmFyLmJhci5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuYWRkQ2hpbGQodGhpcy5wcm9ncmVzc0Jhci5iYXIpO1xyXG5cclxuXHRcdFx0dGhpcy5wcm9ncmVzc0Jhci5jaGFyYSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9wcm9ncmVzc19jaGFyX1wiICsgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpKTtcclxuXHRcdFx0dGhpcy5wcm9ncmVzc0Jhci5jaGFyYS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuY2hhcmEuc2NhbGUuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIuYmFyLmFkZENoaWxkKHRoaXMucHJvZ3Jlc3NCYXIuY2hhcmEpO1xyXG5cdH1cclxuXHJcblx0Ly8gVHV0b3JpYWxcclxuXHR0aGlzLl90dXRvcmlhbCA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdHRoaXMuX3R1dG9yaWFsLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHR0aGlzLl90dXRvcmlhbC55ID0gMTAwO1xyXG5cdHRoaXMuX3R1dG9yaWFsLnNjYWxlLnNldCgwKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3R1dG9yaWFsKTtcclxuXHJcblx0XHR0aGlzLl90dXRvcmlhbC5iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV90dXRvcmlhbF90ZXh0X2JnXCIpKTtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmFkZENoaWxkKHRoaXMuX3R1dG9yaWFsLmJnKTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fdHV0b3JpYWwubGFiZWwgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIlRlc3RcIiwge2ZvbnQ6IFwiMjRweCBTdXBlcmNsYXJlbmRvbiBMZXZlbFwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aGlzLl90dXRvcmlhbC5sYWJlbC54ID0gLXRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aGlzLl90dXRvcmlhbC5sYWJlbC55ID0gLXRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHRIZWlnaHQvMiAtNjtcclxuXHRcdFx0dGhpcy5fdHV0b3JpYWwuYWRkQ2hpbGQodGhpcy5fdHV0b3JpYWwubGFiZWwpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl90dXRvcmlhbC5sYWJlbCA9IG5ldyBQSVhJLlRleHQoXCJUZXh0XCIsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJywgd29yZFdyYXA6ZmFsc2UsIGxpbmVIZWlnaHQ6MzIsIHdvcmRXcmFwV2lkdGg6NDAwfSk7XHJcblx0XHRcdHRoaXMuX3R1dG9yaWFsLmxhYmVsLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGhpcy5fdHV0b3JpYWwuYWRkQ2hpbGQodGhpcy5fdHV0b3JpYWwubGFiZWwpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0Ly8gR29hbCBhY2hpZXZlZFxyXG5cdHRoaXMuX2dvYWwgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHR0aGlzLl9nb2FsLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHR0aGlzLl9nb2FsLnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzIrMjUwO1xyXG5cdHRoaXMuX2dvYWwuc2NhbGUuc2V0KDApO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fZ29hbCk7XHJcblxyXG5cdFx0dmFyIGdvYWwgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJpbmdhbWVfZ29hbF9iZ1wiKSk7XHJcblx0XHRnb2FsLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuX2dvYWwuYWRkQ2hpbGQoZ29hbCk7XHJcblxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2dvYWwubGFiZWwgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIlRleHRcIiwge2ZvbnQ6IFwiMjRweCBNaWthZGFuIFRpdGxlXCIsIGFsaWduOiBcImxlZnRcIn0pO1xyXG5cdFx0XHR0aGlzLl9nb2FsLmxhYmVsLnggPSAtMjcwO1xyXG5cdFx0XHR0aGlzLl9nb2FsLmxhYmVsLnkgPSAtdGhpcy5fZ29hbC5sYWJlbC50ZXh0SGVpZ2h0LzI7XHJcblx0XHRcdGdvYWwuYWRkQ2hpbGQodGhpcy5fZ29hbC5sYWJlbCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2dvYWwubGFiZWwgPSBuZXcgUElYSS5UZXh0KFwiVGV4dFwiLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDU4RUJEMiwgYWxpZ246J2xlZnQnLCB3b3JkV3JhcDp0cnVlLCB3b3JkV3JhcFdpZHRoOjQwMH0pO1xyXG5cdFx0XHR0aGlzLl9nb2FsLmxhYmVsLnggPSAtMjYwO1xyXG5cdFx0XHR0aGlzLl9nb2FsLmxhYmVsLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHRcdFx0Z29hbC5hZGRDaGlsZCh0aGlzLl9nb2FsLmxhYmVsKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9nb2FsLnNub3dmbGFrZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc25vd2ZsYWtlXCIpKTtcclxuXHRcdHRoaXMuX2dvYWwuc25vd2ZsYWtlLnggPSAyMjA7XHJcblx0XHR0aGlzLl9nb2FsLnNub3dmbGFrZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0aGlzLl9nb2FsLnNub3dmbGFrZS5zY2FsZS5zZXQoMC43NSk7XHJcblx0XHR0aGlzLl9nb2FsLmFkZENoaWxkKHRoaXMuX2dvYWwuc25vd2ZsYWtlKTtcclxuXHJcblx0XHR0aGlzLl9nb2FsLnJld2FyZCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KFwiMFwiLCB7Zm9udDogXCIyNHB4IFN1cGVyY2xhcmVuZG9uIE51bWJlcnNcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdHRoaXMuX2dvYWwucmV3YXJkLnggPSAtdGhpcy5fZ29hbC5yZXdhcmQudGV4dFdpZHRoLzIgKyAyODU7XHJcblx0XHR0aGlzLl9nb2FsLnJld2FyZC55ID0gLXRoaXMuX2dvYWwucmV3YXJkLnRleHRIZWlnaHQvMjtcclxuXHRcdGdvYWwuYWRkQ2hpbGQodGhpcy5fZ29hbC5yZXdhcmQpO1xyXG5cclxuXHRcdC8vIHRoaXMuX2dvYWwucmV3YXJkID0gbmV3IFBJWEkuVGV4dChcIj9cIiwge2ZvbnQ6XCIzMHB4IEFyaWFsXCIsIGZpbGw6MHg1OEVCRDIsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHQvLyB0aGlzLl9nb2FsLnJld2FyZC54ID0gMjg1XHJcblx0XHQvLyB0aGlzLl9nb2FsLnJld2FyZC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHQvLyB0aGlzLl9nb2FsLmFkZENoaWxkKHRoaXMuX2dvYWwucmV3YXJkKTtcclxuXHJcblx0XHR2YXIgcHJvZ3Jlc3MgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19jb21wbGV0ZVwiKSk7XHJcblx0XHRwcm9ncmVzcy54ID0gLTMxMDtcclxuXHRcdHByb2dyZXNzLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHByb2dyZXNzLnNjYWxlLnNldCgwLjYpO1xyXG5cdFx0Z29hbC5hZGRDaGlsZChwcm9ncmVzcyk7XHJcblxyXG5cdC8vIFNub3dmbGFrZXNcclxuXHR0aGlzLl9nb2FsU25vd2ZsYWtlcyA9IFtdO1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCAzMDsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBzbm93Zmxha2UgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3Nub3dmbGFrZVwiKSk7XHJcblx0XHRzbm93Zmxha2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0c25vd2ZsYWtlLmFscGhhID0gMDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQoc25vd2ZsYWtlKTtcclxuXHJcblx0XHR0aGlzLl9nb2FsU25vd2ZsYWtlcy5wdXNoKHNub3dmbGFrZSk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5HYW1lVUkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIENvaW5zLCB1cGRhdGUgdGhlIHBvc2l0aW9uIG9ubHkgaWYgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGNoYW5nZXNcclxuXHRpZih0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0Lmxlbmd0aCAhPSB0aGlzLmxldmVsLnNub3dmbGFrZXMudG9TdHJpbmcoKS5sZW5ndGgpXHJcblx0e1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueCArPSB0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnRleHQgPSB0aGlzLmxldmVsLnNub3dmbGFrZXM7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC52YWxpZGF0ZSgpO1xyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueCAtPSB0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0ICE9IHRoaXMubGV2ZWwuc25vd2ZsYWtlcylcclxuXHR7XHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0ID0gdGhpcy5sZXZlbC5zbm93Zmxha2VzO1xyXG5cdH1cclxuXHJcblx0Ly8gU3R5bGVcclxuXHRpZih0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC50ZXh0Lmxlbmd0aCAhPSB0aGlzLmxldmVsLnN0eWxlU2NvcmUudG9TdHJpbmcoKS5sZW5ndGgpXHJcblx0e1xyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQueCArPSB0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdHRoaXMuX3N0eWxlQ29udGFpbmVyLl90ZXh0LnRleHQgPSB0aGlzLmxldmVsLnN0eWxlU2NvcmU7XHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC52YWxpZGF0ZSgpO1xyXG5cdFx0dGhpcy5fc3R5bGVDb250YWluZXIuX3RleHQueCAtPSB0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC50ZXh0ICE9IHRoaXMubGV2ZWwuc3R5bGVTY29yZSlcclxuXHR7XHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci5fdGV4dC50ZXh0ID0gdGhpcy5sZXZlbC5zdHlsZVNjb3JlO1xyXG5cdH1cclxuXHJcblx0Ly8gRGlzdGFuY2VcclxuXHRpZih0aGlzLmxldmVsLmVuZGxlc3MpXHJcblx0e1xyXG5cdFx0dmFyIG5ld0Rpc3RhbmNlID0gdGhpcy5sZXZlbC5hdmF0YXIuZGlzdGFuY2UgKyBcIm1cIjtcclxuXHRcdGlmKHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0LnRleHQubGVuZ3RoICE9IG5ld0Rpc3RhbmNlLmxlbmd0aClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX3RleHQueCArPSB0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGhpcy5fZGlzdGFuY2VDb250YWluZXIuX3RleHQudGV4dCA9IG5ld0Rpc3RhbmNlO1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC52YWxpZGF0ZSgpO1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC54IC09IHRoaXMuX2Rpc3RhbmNlQ29udGFpbmVyLl90ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZih0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC50ZXh0ICE9IG5ld0Rpc3RhbmNlKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci5fdGV4dC50ZXh0ID0gbmV3RGlzdGFuY2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBQcm9ncmVzcyBiYXJcclxuXHRpZighdGhpcy5sZXZlbC5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdHRoaXMucHJvZ3Jlc3NCYXIuYmFyLndpZHRoID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHRoaXMubGV2ZWwuYXZhdGFyLnggLyB0aGlzLmxldmVsLmNvbmZpZy5sZW5ndGgpKSkgKiB0aGlzLl9wcm9ncmVzc0JhcldpZHRoO1xyXG5cdFx0dGhpcy5wcm9ncmVzc0Jhci5jaGFyYS54ID0gdGhpcy5wcm9ncmVzc0Jhci5iYXIud2lkdGg7XHJcblx0fVxyXG5cclxuXHQvLyBHb2Fsc1xyXG5cdGlmKHRoaXMuX2dvYWxzUXVldWUubGVuZ3RoID4gMCAmJiB0aGlzLl9jYW5TaG93R29hbClcclxuXHR7XHJcblx0XHR0aGlzLnNob3dHb2FsKCk7XHJcblx0fVxyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fY3J5c3RhbFBhcnRpY2xlcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLl9jcnlzdGFsUGFydGljbGVzW2ldLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpXHJcblx0fVxyXG5cclxuXHQvLyBpZih0aGlzLl9jcnlzdGFsU3dpcmxQYXJ0aWNsZSlcclxuXHQvLyB7XHJcblx0XHQvLyB0aGlzLl9jcnlzdGFsU3dpcmxQYXJ0aWNsZS51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHQvLyB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXNpemVcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5fY29pbnNDb250YWluZXIpXHJcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci54ID0gdGhpcy5wYXJlbnQuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCkgLSA0MDtcclxuXHJcblx0aWYodGhpcy5fc3R5bGVDb250YWluZXIpXHJcblx0XHR0aGlzLl9zdHlsZUNvbnRhaW5lci54ID0gdGhpcy5wYXJlbnQuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCkgLSA0MDtcclxuXHJcblx0aWYodGhpcy5fZGlzdGFuY2VDb250YWluZXIpXHJcblx0XHR0aGlzLl9kaXN0YW5jZUNvbnRhaW5lci54ID0gdGhpcy5wYXJlbnQuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCkgLSA0MDtcclxuXHJcblx0aWYoIXRoaXMubGV2ZWwuZW5kbGVzcylcclxuXHR7XHJcblx0XHR0aGlzLl9wcm9ncmVzc0JhcldpZHRoICAgICAgICA9IE1hdGgucm91bmQoTWF0aC5taW4oQ29tbW9uLlNUQUdFX1dJRFRILCBwMy5WaWV3LndpZHRoKSAtIDEwMCk7XHJcblx0XHR0aGlzLnByb2dyZXNzQmFyLmNhcExlZnQueCAgID0gLXRoaXMuX3Byb2dyZXNzQmFyV2lkdGgvMjtcclxuXHRcdHRoaXMucHJvZ3Jlc3NCYXIuY2FwUmlnaHQueCAgPSB0aGlzLl9wcm9ncmVzc0JhcldpZHRoLzI7XHJcblx0XHR0aGlzLnByb2dyZXNzQmFyLmJhckJnLnggICAgID0gLXRoaXMuX3Byb2dyZXNzQmFyV2lkdGgvMjtcclxuXHRcdHRoaXMucHJvZ3Jlc3NCYXIuYmFyQmcud2lkdGggPSB0aGlzLl9wcm9ncmVzc0JhcldpZHRoO1xyXG5cdFx0dGhpcy5wcm9ncmVzc0Jhci5iYXIueCAgICAgICA9IC10aGlzLl9wcm9ncmVzc0JhcldpZHRoLzI7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQWRkIGEgZ29hbCB0byB0aGUgZGlzcGxheSBxdWV1ZUdvYWxcclxuICogQHBhcmFtIHtTdHJpbmd9IHRleHRcclxuICogQHBhcmFtIHtOdW1iZXJ9IHJld2FyZFxyXG4gKi9cclxuR2FtZVVJLnByb3RvdHlwZS5xdWV1ZUdvYWwgPSBmdW5jdGlvbih0ZXh0LCByZXdhcmQpXHJcbntcclxuXHR0aGlzLl9nb2Fsc1F1ZXVlLnB1c2goe3RleHQ6dGV4dCwgcmV3YXJkOnJld2FyZH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2hvdyBhIGdvYWwgZnJvbSB0aGUgcXVldWVcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUuc2hvd0dvYWwgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLl9jYW5TaG93R29hbCA9IGZhbHNlO1xyXG5cdHZhciBnb2FsID0gdGhpcy5fZ29hbHNRdWV1ZS5zcGxpY2UoMCwxKVswXTtcclxuXHJcblx0dGhpcy5fZ29hbC5sYWJlbC50ZXh0ID0gZ29hbC50ZXh0O1xyXG5cclxuXHR0aGlzLl9nb2FsLnJld2FyZC54ICs9IHRoaXMuX2dvYWwucmV3YXJkLnRleHRXaWR0aDtcclxuXHR0aGlzLl9nb2FsLnJld2FyZC50ZXh0ID0gZ29hbC5yZXdhcmQudG9TdHJpbmcoKTtcclxuXHR0aGlzLl9nb2FsLnJld2FyZC52YWxpZGF0ZSgpO1xyXG5cdHRoaXMuX2dvYWwucmV3YXJkLnggLT0gdGhpcy5fZ29hbC5yZXdhcmQudGV4dFdpZHRoO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoXHJcblx0e1xyXG5cdFx0b25Db21wbGV0ZVNjb3BlOnRoaXMsXHJcblx0XHRvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7dGhpcy5fY2FuU2hvd0dvYWwgPSB0cnVlO31cclxuXHR9KTtcclxuXHJcblx0dGwudG8odGhpcy5fZ29hbC5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LDApO1xyXG5cdHRsLnRvKHRoaXMuX2dvYWwuc2NhbGUsIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LDIpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHQvLyBTbm93Zmxha2VzIGFuaW1hdGlvblxyXG5cdC8qXHJcblx0dmFyIGNvdW50ICAgID0gMDtcclxuXHR2YXIgY291bnRNYXggPSAxMDtcclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fZ29hbFNub3dmbGFrZXMubGVuZ3RoICYmIGNvdW50IDwgY291bnRNYXg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgcyA9IHRoaXMuX2dvYWxTbm93Zmxha2VzW2ldO1xyXG5cdFx0aWYocy5hbHBoYSA+IDApIGNvbnRpbnVlO1xyXG5cclxuXHRcdHMucG9zaXRpb24uc2V0KHRoaXMuX2dvYWwueCArIHRoaXMuX2dvYWwuc25vd2ZsYWtlLngsIHRoaXMuX2dvYWwueSArIHRoaXMuX2dvYWwuc25vd2ZsYWtlLnkpO1xyXG5cdFx0cy5zY2FsZS5zZXQoMCk7XHJcblx0XHRzLmFscGhhID0gMTtcclxuXHJcblx0XHR0bC50byhzLnNjYWxlLCAxLCB7eDogMSwgeTogMSwgZWFzZTpRdWFydC5lYXNlT3V0fSwgY291bnQgKiAwLjEpO1xyXG5cdFx0dGwudG8ocywgMSwge3g6IHRoaXMuX2NvaW5zQ29udGFpbmVyLnggKyB0aGlzLl9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLngsIHk6IHRoaXMuX2NvaW5zQ29udGFpbmVyLnkgKyB0aGlzLl9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLnksIGVhc2UgOiBTaW5lLmVhc2VJbk91dH0sIGNvdW50ICogMC4xKTtcclxuXHRcdHRsLnRvKHMsIDAuMDEsIHthbHBoYTogMCwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9KTtcclxuXHJcblx0XHRjb3VudCsrO1xyXG5cdH1cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHQqL1xyXG59XHJcblxyXG4vKipcclxuICogU2hvdyB0aGUgbGlzdCBvZiBhbGwgdGhlIGdvYWwgZm9yIHRoZSBjdXJyZW50IGxldmVsXHJcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gc2hvd1Jld2FyZHNcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUuc2hvd0dvYWxzID0gZnVuY3Rpb24oc2hvd1Jld2FyZHMpXHJcbntcclxuXHQvLyBHb2Fsc1xyXG5cdHZhciBnb2Fsc0NvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdGdvYWxzQ29udGFpbmVyLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHRnb2Fsc0NvbnRhaW5lci55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVC8yKzE1MDtcclxuXHR0aGlzLmFkZENoaWxkQXQoZ29hbHNDb250YWluZXIsIDApO1xyXG5cclxuXHR2YXIgdG90YWxSZXdhcmQgPSAwO1xyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fZ29hbHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIGlkID0gdGhpcy5fZ29hbHNbaV0uaWQ7XHJcblx0XHR2YXIgZ29hbFN0YXR1cyA9IENvbW1vbi5nb2Fsc01hbmFnZXIuZ2V0R29hbFN0YXR1cyhpZCk7XHJcblx0XHR2YXIgZ29hbFJld2FyZCA9IHRoaXMuX2dvYWxzW2ldLnJld2FyZDtcclxuXHJcblx0XHR2YXIgZ29hbCA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0Z29hbC55ID0gNTUgKiBpO1xyXG5cdFx0Z29hbHNDb250YWluZXIuYWRkQ2hpbGQoZ29hbCk7XHJcblxyXG5cdFx0dmFyIGJnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwiaW5nYW1lX2dvYWxfYmdcIikpO1xyXG5cdFx0YmcuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0Z29hbC5hZGRDaGlsZChiZyk7XHJcblxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQodGhpcy5fZ29hbHNbaV0ubGFiZWwsIHtmb250OiBcIjI0cHggTWlrYWRhbiBUaXRsZVwiLCBhbGlnbjogXCJsZWZ0XCJ9KTtcclxuXHRcdFx0dGV4dC54ID0gLTI3MDtcclxuXHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0XHRnb2FsLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQodGhpcy5fZ29hbHNbaV0ubGFiZWwsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOihnb2FsU3RhdHVzID09IDEgPyAweDU4RUJEMiA6IDB4RkZGRkZGKSwgYWxpZ246J2xlZnQnfSk7XHJcblx0XHRcdHRleHQueCA9IC0yNzA7XHJcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLCAwLjUpO1xyXG5cdFx0XHRnb2FsLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBwcm9ncmVzcyA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0cHJvZ3Jlc3MueCA9IC0zMTA7XHJcblx0XHRwcm9ncmVzcy5zY2FsZS5zZXQoMC42KTtcclxuXHRcdGdvYWwuYWRkQ2hpbGQocHJvZ3Jlc3MpO1xyXG5cclxuXHRcdFx0dmFyIHByb2dyZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19iYXJcIikpO1xyXG5cdFx0XHRwcm9ncmVzc0JnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCZyk7XHJcblxyXG5cdFx0XHRpZihnb2FsU3RhdHVzID09IDEpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgcHJvZ3Jlc3NCZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2dvYWxzX2NvbXBsZXRlXCIpKTtcclxuXHRcdFx0XHRwcm9ncmVzc0JnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRwcm9ncmVzcy5hZGRDaGlsZChwcm9ncmVzc0JnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgcHJvZ3Jlc3NCZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2dvYWxzX2JhclwiKSk7XHJcblx0XHRcdFx0cHJvZ3Jlc3NCZy5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCZyk7XHJcblxyXG5cdFx0XHRcdGlmKGdvYWxTdGF0dXMgPiAwKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBwcm9ncmVzc0JhciA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2dvYWxzX2ZpbGxcIikpO1xyXG5cdFx0XHRcdFx0cHJvZ3Jlc3NCYXIuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCYXIpO1xyXG5cclxuXHRcdFx0XHRcdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG5cdFx0XHRcdFx0XHRjYW52YXMud2lkdGggID0gMTI4O1xyXG5cdFx0XHRcdFx0XHRjYW52YXMuaGVpZ2h0ID0gMTI4O1xyXG5cdFx0XHRcdFx0XHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcblx0XHRcdFx0XHRcdGN0eC5tb3ZlVG8oY2FudmFzLndpZHRoLzIsIGNhbnZhcy5oZWlnaHQvMik7XHJcblx0XHRcdFx0XHRcdGN0eC5hcmMoY2FudmFzLndpZHRoLzIsIGNhbnZhcy5oZWlnaHQvMiwgY2FudmFzLndpZHRoLzIsIC1NYXRoLlBJLzIsIDIqTWF0aC5QSSpnb2FsU3RhdHVzLU1hdGguUEkvMik7XHJcblx0XHRcdFx0XHRcdGN0eC5saW5lVG8oY2FudmFzLndpZHRoLzIsIGNhbnZhcy5oZWlnaHQvMik7XHJcblx0XHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSAnd2hpdGUnO1xyXG5cdFx0XHRcdFx0XHRjdHguZmlsbCgpO1xyXG5cclxuXHRcdFx0XHRcdFx0dmFyIG1hc2sgPSBuZXcgUElYSS5TcHJpdGUoUElYSS5UZXh0dXJlLmZyb21DYW52YXMoY2FudmFzKSk7XHJcblx0XHRcdFx0XHRcdG1hc2suYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdFx0XHRwcm9ncmVzc0Jhci5hZGRDaGlsZChtYXNrKTtcclxuXHRcdFx0XHRcdFx0cHJvZ3Jlc3NCYXIubWFzayA9IG1hc2s7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0aWYoc2hvd1Jld2FyZHMgJiYgZ29hbFN0YXR1cyA9PSAxKVxyXG5cdFx0e1xyXG5cdFx0XHR0b3RhbFJld2FyZCArPSBnb2FsUmV3YXJkO1xyXG5cclxuXHRcdFx0dmFyIHNub3dmbGFrZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc25vd2ZsYWtlXCIpKTtcclxuXHRcdFx0c25vd2ZsYWtlLnggPSAyMjA7XHJcblx0XHRcdHNub3dmbGFrZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHNub3dmbGFrZS5zY2FsZS5zZXQoMC43NSk7XHJcblx0XHRcdGdvYWwuYWRkQ2hpbGQoc25vd2ZsYWtlKTtcclxuXHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChnb2FsUmV3YXJkLnRvU3RyaW5nKCksIHtmb250OiBcIjI0cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHRcdHRleHQueCA9IC10ZXh0LnRleHRXaWR0aC8yICsgMjg1O1xyXG5cdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMjtcclxuXHRcdFx0XHRnb2FsLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChnb2FsUmV3YXJkLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDogKGdvYWxTdGF0dXMgPT0gMSA/IDB4NThFQkQyIDogMHhGRkZGRkYpLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHRcdHRleHQueCA9IDI4NTtcclxuXHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRnb2FsLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBTbm93Zmxha2VzIHBhcnRpY2xlc1xyXG5cdFx0XHR2YXIgY291bnQgICAgPSAwO1xyXG5cdFx0XHR2YXIgY291bnRNYXggPSAxMDtcclxuXHRcdFx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHRcdGZvcih2YXIgcCA9IDA7IHAgPCB0aGlzLl9nb2FsU25vd2ZsYWtlcy5sZW5ndGggJiYgY291bnQgPCBjb3VudE1heDsgcCsrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHMgPSB0aGlzLl9nb2FsU25vd2ZsYWtlc1twXTtcclxuXHRcdFx0XHRpZihzLmFscGhhID4gMCkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdHMucG9zaXRpb24uc2V0KGdvYWxzQ29udGFpbmVyLnggKyBnb2FsLnggKyBzbm93Zmxha2UueCwgZ29hbHNDb250YWluZXIueSArIGdvYWwueSArIHNub3dmbGFrZS55KTtcclxuXHRcdFx0XHRzLnNjYWxlLnNldCgwKTtcclxuXHRcdFx0XHRzLmFscGhhID0gMTtcclxuXHJcblx0XHRcdFx0dGwudG8ocy5zY2FsZSwgMSwgICAge3g6IDEsIHk6IDEsIGVhc2U6UXVhcnQuZWFzZU91dH0sIChjb3VudCArIGkvMykgKiAwLjEpO1xyXG5cdFx0XHRcdHRsLnRvKHMsICAgICAgIDEsICAgIHt4OiB0aGlzLl9jb2luc0NvbnRhaW5lci54ICsgdGhpcy5fY29pbnNDb250YWluZXIuX3Nub3dmbGFrZS54LCB5OiB0aGlzLl9jb2luc0NvbnRhaW5lci55ICsgdGhpcy5fY29pbnNDb250YWluZXIuX3Nub3dmbGFrZS55LCBlYXNlIDogU2luZS5lYXNlSW5PdXR9LCAoY291bnQgKyBpLzMpICogMC4xKTtcclxuXHRcdFx0XHR0bC50byhzLCAgICAgICAxLCAgICB7cm90YXRpb246MiAqIE1hdGguUEksIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAoY291bnQgKyBpLzMpICogMC4xKTtcclxuXHRcdFx0XHR0bC50byhzLCAgICAgICAwLjAxLCB7YWxwaGE6IDAsIGVhc2U6TGluZWFyLmVhc2VOb25lfSk7XHJcblxyXG5cdFx0XHRcdGNvdW50Kys7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heChcclxuXHR7XHJcblx0XHRvbkNvbXBsZXRlU2NvcGU6dGhpcyxcclxuXHRcdG9uQ29tcGxldGU6ZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnJlbW92ZUNoaWxkKGdvYWxzQ29udGFpbmVyKTtcclxuXHRcdFx0dGhpcy5fY2FuU2hvd0dvYWwgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQvLyBTaG93IGdvYWxzXHJcblx0dGwudG8oZ29hbHNDb250YWluZXIsIC4zLCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcclxuXHR0bC50byhnb2Fsc0NvbnRhaW5lciwgLjMsIHt5OmdvYWxzQ29udGFpbmVyLnksIGVhc2U6U2luZS5lYXNlT3V0fSwgMCk7XHJcblxyXG5cdC8vIEhpZGUgZ29hbHNcclxuXHR0bC50byhnb2Fsc0NvbnRhaW5lciwgLjMsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZU91dH0sICAgICAgICAgICAgICAgICAgMi41KTtcclxuXHR0bC50byhnb2Fsc0NvbnRhaW5lciwgLjMsIHt5OmdvYWxzQ29udGFpbmVyLnkgKyAxMDAsIGVhc2U6U2luZS5lYXNlT3V0fSwgMi41KTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblxyXG5cdC8vIEluY3JlbWVudCBzbm93Zmxha2Ugc2NvcmVcclxuXHRpZih0b3RhbFJld2FyZCAhPSAwKVxyXG5cdHtcclxuXHRcdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGwudG8odGhpcy5sZXZlbCwgMSwge3Nub3dmbGFrZXM6dGhpcy5sZXZlbC5zbm93Zmxha2VzICsgdG90YWxSZXdhcmQsIGVhc2U6TGluZWFyLmVhc2VOb25lLCBvblVwZGF0ZVNjb3BlOnRoaXMsIG9uVXBkYXRlOmZ1bmN0aW9uKClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5sZXZlbC5zbm93Zmxha2VzID0gTWF0aC5mbG9vcih0aGlzLmxldmVsLnNub3dmbGFrZXMpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyh0aGlzLmxldmVsLnNub3dmbGFrZXMpO1xyXG5cdFx0fX0sIDAuOSk7XHJcblxyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcblx0fVxyXG5cclxuXHJcblx0Z29hbHNDb250YWluZXIuYWxwaGEgPSAwO1xyXG5cdGdvYWxzQ29udGFpbmVyLnkgKz0gMTAwO1xyXG5cclxuXHR0aGlzLl9jYW5TaG93R29hbCA9IGZhbHNlO1xyXG59XHJcblxyXG4vKipcclxuICogU2hvdyBhIGNyeXN0YWxcclxuICogQHBhcmFtIHtTdHJpbmd9IGNoYXJhY3RlclxyXG4gKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUuY3J5c3RhbENvbGxlY3RlZCA9IGZ1bmN0aW9uKGNoYXJhY3RlciwgaW5kZXgpXHJcbntcclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdHRsLnRvKHRoaXMuX2NyeXN0YWxzW3RoaXMuX2NoYXJhY3RlcnMuaW5kZXhPZihjaGFyYWN0ZXIpKjMraW5kZXhdLCAuMjUsIHthbHBoYToxLCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sIDAuMjUpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHQvLyBTaG93IGFuZCBoaWRlIHRoZSBjcnlzdGFsIGNvbnRhaW5lclxyXG5cdHRoaXMuX3RvcENvbnRhaW5lclR3ZWVuLmtpbGwoKTtcclxuXHR0aGlzLl90b3BDb250YWluZXJUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5fdG9wQ29udGFpbmVyVHdlZW4udG8odGhpcy5fdG9wQ29udGFpbmVyLCAuMjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHR0aGlzLl90b3BDb250YWluZXJUd2Vlbi50byh0aGlzLl90b3BDb250YWluZXIsIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDIpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5fdG9wQ29udGFpbmVyVHdlZW4pO1xyXG5cclxuXHRpZihDb21tb24uc2F2ZWREYXRhLmdldExldmVsQ2hhcmFjdGVyQ3J5c3RhbENvdW50KENvbW1vbi5zYXZlZERhdGEubGV2ZWwsIGNoYXJhY3RlcikgPT0gMylcclxuXHR7XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgMzsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRUd2Vlbk1heC50byh0aGlzLl9jcnlzdGFsUGFydGljbGVzW2ldLCAwLCB7ZGVsYXk6aSouMywgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGVQYXJhbXM6W2ldLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKGkpe1xyXG5cdFx0XHRcdHRoaXMuX2NyeXN0YWxQYXJ0aWNsZXNbdGhpcy5fY2hhcmFjdGVycy5pbmRleE9mKGNoYXJhY3RlcikqMytpXS5lbWl0ID0gdHJ1ZTtcclxuXHRcdFx0fX0pO1xyXG5cdFx0fVxyXG5cdFx0Ly8gdGhpcy5fY3J5c3RhbFN3aXJsUGFydGljbGUuZW1pdCA9IHRydWU7XHJcblx0fVxyXG5cclxufVxyXG5cclxuLyoqXHJcbiAqIFNob3cgdGhlIHRyb2xsIGNvdW50XHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBjaGFyYWN0ZXJcclxuICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XHJcbiAqL1xyXG5HYW1lVUkucHJvdG90eXBlLnRyb2xsQ29sbGVjdGVkID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5fdHJvbGxDb3VudC50cm9sbENvbGxlY3RlZCsrO1xyXG5cdHZhciB0cm9sbENvdW50ID0gMztcclxuXHR0aGlzLl90cm9sbENvdW50LnRleHQgPSB0aGlzLl90cm9sbENvdW50LnRyb2xsQ29sbGVjdGVkICsgXCIvXCIgKyB0cm9sbENvdW50O1xyXG5cclxuXHQvLyBTaG93IGFuZCBoaWRlIHRoZSBjcnlzdGFsIGNvbnRhaW5lclxyXG5cdHRoaXMuX3RvcENvbnRhaW5lclR3ZWVuLmtpbGwoKTtcclxuXHR0aGlzLl90b3BDb250YWluZXJUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5fdG9wQ29udGFpbmVyVHdlZW4udG8odGhpcy5fdG9wQ29udGFpbmVyLCAuMjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHR0aGlzLl90b3BDb250YWluZXJUd2Vlbi50byh0aGlzLl90b3BDb250YWluZXIsIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDIpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5fdG9wQ29udGFpbmVyVHdlZW4pO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFNob3cgYSB0dXRvcmlhbCBtZXNzYWdlXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0XHJcbiAqL1xyXG5HYW1lVUkucHJvdG90eXBlLnR1dG9yaWFsID0gZnVuY3Rpb24odGV4dClcclxue1xyXG5cdGlmKCF3ZWJmb250KVxyXG5cdHtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmxhYmVsLnggKz0gdGhpcy5fdHV0b3JpYWwubGFiZWwudGV4dFdpZHRoLzI7XHJcblx0XHR0aGlzLl90dXRvcmlhbC5sYWJlbC55ICs9IHRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHRIZWlnaHQvMjtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHQgPSB0ZXh0O1xyXG5cdFx0dGhpcy5fdHV0b3JpYWwubGFiZWwudmFsaWRhdGUoKTtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmxhYmVsLnggLT0gdGhpcy5fdHV0b3JpYWwubGFiZWwudGV4dFdpZHRoLzI7XHJcblx0XHR0aGlzLl90dXRvcmlhbC5sYWJlbC55IC09IHRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHRIZWlnaHQvMjtcclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdHRoaXMuX3R1dG9yaWFsLmxhYmVsLnRleHQgPSB0ZXh0O1xyXG5cdH1cclxuXHJcblx0Ly8gU2hvdyBhbmQgaGlkZSB0aGUgdHV0b3JpYWwgY29udGFpbmVyXHJcblx0dGhpcy5fdHV0b3JpYWxUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5fdHV0b3JpYWxUd2Vlbi50byh0aGlzLl90dXRvcmlhbC5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRoaXMuX3R1dG9yaWFsVHdlZW4udG8odGhpcy5fdHV0b3JpYWwuc2NhbGUsIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAyKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuX3R1dG9yaWFsKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEhpZ2hsaWdodCBhIFVJIGVsZW1lbnRcclxuICogQHBhcmFtIHtTdHJpbmd9IHRleHRcclxuICovXHJcbkdhbWVVSS5wcm90b3R5cGUuaGlnaGxpZ2h0ID0gZnVuY3Rpb24od2hhdClcclxue1xyXG5cdGlmKCF0aGlzLl9oaWdobGlnaHQpXHJcblx0e1xyXG5cdFx0dGhpcy5faGlnaGxpZ2h0ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfcGxheVwiKSk7XHJcblx0XHR0aGlzLl9oaWdobGlnaHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oaWdobGlnaHQpO1xyXG5cdH1cclxuXHJcblx0Ly8gUG9zaXRpb25cclxuXHRzd2l0Y2god2hhdClcclxuXHR7XHJcblx0XHRjYXNlIFwic3R5bGVcIjpcclxuXHRcdFx0dGhpcy5faGlnaGxpZ2h0LnBvc2l0aW9uLnNldCh0aGlzLl9zdHlsZUNvbnRhaW5lci54ICsgMjAwLCB0aGlzLl9zdHlsZUNvbnRhaW5lci55KTtcclxuXHRcdFx0dGhpcy5faGlnaGxpZ2h0LnNjYWxlLnNldCgtMSwgMSk7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGRlZmF1bHQ6XHJcblx0XHRcdHJldHVybjtcclxuXHRcdFx0dGhpcy5faGlnaGxpZ2h0LnNjYWxlLnNldCgwLCAwKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG5cclxuXHQvLyBBbmltYXRpb25cclxuXHRpZighIXRoaXMuX2hpZ2hsaWdodFR3ZWVuKVxyXG5cdFx0dGhpcy5faGlnaGxpZ2h0VHdlZW4ua2lsbCgpO1xyXG5cclxuXHR0aGlzLl9oaWdobGlnaHRUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5faGlnaGxpZ2h0VHdlZW4udG8odGhpcy5faGlnaGxpZ2h0LnNjYWxlLCAuMywge3g6dGhpcy5faGlnaGxpZ2h0LnNjYWxlLngsIHk6dGhpcy5faGlnaGxpZ2h0LnNjYWxlLnksIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0XHR0aGlzLl9oaWdobGlnaHRUd2Vlbi50byh0aGlzLl9oaWdobGlnaHQuc2NhbGUsIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAyKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuX2hpZ2hsaWdodFR3ZWVuKTtcclxuXHJcblx0dGhpcy5faGlnaGxpZ2h0LnNjYWxlLnNldCgwLCAwKTtcclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIaWRlIHRoZSBVSSB3aGVuIHRoZSBnYW1lJ3Mgb3ZlclxyXG4gKi9cclxuR2FtZVVJLnByb3RvdHlwZS5nYW1lT3ZlciA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cclxuXHRcdC8vIFNob3cgdGhlIGdvYWxzIGxpc3RcclxuXHRcdHRsLnRvKHRoaXMuX2dvYWwsIC41LCB7YWxwaGE6MCwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCAwKTtcclxuXHJcblx0XHQvLyBIaWRlIHRoZSBwcm9ncmVzcyBiYXJcclxuXHRcdGlmKCF0aGlzLmxldmVsLmVuZGxlc3MpXHJcblx0XHRcdHRsLnRvKHRoaXMucHJvZ3Jlc3NCYXIsIC41LCB7YWxwaGE6MCwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCAwKTtcclxuXHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcblxyXG5cdC8vIFNob3cgYW5kIGhpZGUgdGhlIGNyeXN0YWwgY29udGFpbmVyXHJcblx0aWYoIXRoaXMubGV2ZWwuZW5kbGVzcyAmJiB0aGlzLmxldmVsLmNvbXBsZXRlZClcclxuXHR7XHJcblx0XHR0aGlzLl90b3BDb250YWluZXJUd2Vlbi5raWxsKCk7XHJcblx0XHR0aGlzLl90b3BDb250YWluZXJUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy5fdG9wQ29udGFpbmVyVHdlZW4udG8odGhpcy5fdG9wQ29udGFpbmVyLCAuMjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuX3RvcENvbnRhaW5lclR3ZWVuKTtcclxuXHR9XHJcbn0iLCJ2YXIgQ29tbW9uICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcblxyXG52YXIgQmV6aWVyUGF0aCAgICAgICAgID0gcmVxdWlyZShcIi4uL2VkaXRvci9CZXppZXJQYXRoXCIpO1xyXG52YXIgTGV2ZWxMYXllciAgICAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvTGV2ZWxMYXllclwiKTtcclxudmFyIExldmVsUGF0aCAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL0xldmVsUGF0aFwiKTtcclxudmFyIEF2YXRhciAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL0F2YXRhclwiKTtcclxudmFyIE9iamVjdE1hbmFnZXIgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL09iamVjdE1hbmFnZXJcIik7XHJcbnZhciBPYmplY3RDb2luICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RDb2luXCIpO1xyXG52YXIgT2JqZWN0UG93ZXJ1cCAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0UG93ZXJ1cFwiKTtcclxudmFyIE9iamVjdENyeXN0YWwgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL09iamVjdENyeXN0YWxcIik7XHJcbnZhciBPYmplY3RPYnN0YWNsZSAgICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RPYnN0YWNsZVwiKTtcclxudmFyIE9iamVjdERlY29yYXRpb24gICA9IHJlcXVpcmUoXCIuLi9nYW1lL09iamVjdERlY29yYXRpb25cIik7XHJcbnZhciBPYmplY3RDYW1lcmFab29tICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RDYW1lcmFab29tXCIpO1xyXG52YXIgT2JqZWN0SnVtcFBsYXRmb3JtID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0SnVtcFBsYXRmb3JtXCIpO1xyXG52YXIgT2JqZWN0TGV2ZWxFbmQgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0TGV2ZWxFbmRcIik7XHJcbnZhciBPYmplY3RTaHJpbmtMb2NrICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RTaHJpbmtMb2NrXCIpO1xyXG52YXIgT2JqZWN0VHV0b3JpYWwgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0VHV0b3JpYWxcIik7XHJcbnZhciBPYmplY3RTdmVuICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RTdmVuXCIpO1xyXG52YXIgT2JqZWN0U2xlZCAgICAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0U2xlZFwiKTtcclxudmFyIE9iamVjdE1hcnNobWFsbG93ICA9IHJlcXVpcmUoXCIuLi9nYW1lL09iamVjdE1hcnNobWFsbG93XCIpO1xyXG52YXIgT2JqZWN0VHJvbGwgICAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvT2JqZWN0VHJvbGxcIik7XHJcbnZhciBPYmplY3RTbm93YmFsbCAgICAgPSByZXF1aXJlKFwiLi4vZ2FtZS9PYmplY3RTbm93YmFsbFwiKTtcclxudmFyIFNob2Nrd2F2ZSAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL1Nob2Nrd2F2ZVwiKTtcclxudmFyIExldmVsUmVjb3JkICAgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL0xldmVsUmVjb3JkXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIExldmVsKGVuZGxlc3MsIGRhdGEsIGJhY2tncm91bmRQcmVmaXgpXHJcbntcclxuXHR0aGlzLl9hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5kZWJ1ZyAgICAgICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5kYXRhICAgICAgICAgICAgID0gZGF0YTtcclxuXHR0aGlzLmJhY2tncm91bmRQcmVmaXggPSBiYWNrZ3JvdW5kUHJlZml4O1xyXG5cdHRoaXMubGF5ZXJDb250YWluZXIgICA9IG51bGw7XHJcblx0dGhpcy5sYXllcnMgICAgICAgICAgID0gW107XHJcblx0dGhpcy5vYmplY3RNYW5hZ2VyICAgID0gbnVsbDtcclxuXHR0aGlzLmVuZGxlc3MgICAgICAgICAgPSBlbmRsZXNzO1xyXG5cdHRoaXMuY29tcGxldGVkICAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuc25vd2ZsYWtlcyAgICAgICA9IDA7XHJcblx0dGhpcy5zY29yZSAgICAgICAgICAgID0gMDtcclxuXHR0aGlzLnN0eWxlU2NvcmUgICAgICAgPSAwO1xyXG5cdHRoaXMuZGVmYXVsdFpvb20gICAgICA9IDAuODtcclxuXHJcblx0aWYoZGF0YSAhPSBcIlwiKVxyXG5cdHtcclxuXHRcdGlmKCF0aGlzLmVuZGxlc3MpXHJcblx0XHR7XHJcblx0XHRcdGNvbnNvbGUubG9nKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKGRhdGEpKTtcclxuXHRcdFx0dGhpcy5jb25maWcgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihkYXRhKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5sb2codGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oZGF0YS5zdGFydFswXSkpO1xyXG5cdFx0XHR0aGlzLmNvbmZpZyAgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihkYXRhLnN0YXJ0WzBdKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEF2YXRhclxyXG5cdHRoaXMuYXZhdGFyICAgICA9IG5ldyBBdmF0YXIoKTtcclxuXHR0aGlzLmZvY3VzUG9pbnQgPSBuZXcgUElYSS5Qb2ludCh0aGlzLmF2YXRhci5mb2N1c1BvaW50TGFuZC5wb2ludC54LCB0aGlzLmF2YXRhci5mb2N1c1BvaW50TGFuZC5wb2ludC55KTtcclxuXHR0aGlzLmZvY3VzWEFjdGl2ZSA9IHRydWU7XHJcblx0dGhpcy5mb2N1c1lBY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuZm9jdXNQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0dGhpcy5mb2N1c1BvaW50VHdlZW4gPSBudWxsO1xyXG5cclxuXHQvLyBab29tXHJcblx0dGhpcy56b29tICAgICAgID0gMTtcclxuXHR0aGlzLnpvb21UYXJnZXQgPSAxO1xyXG5cdHRoaXMuem9vbVR3ZWVuICA9IG51bGw7XHJcblxyXG5cdC8vIFNoYWtlXHJcblx0dGhpcy5faXNTaGFrZSAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuX3NoYWtlVGltZSAgICAgPSAwO1xyXG5cdHRoaXMuX3NoYWtlVGltZUVuZCAgPSAxO1xyXG5cdHRoaXMuX3NoYWtlU3RyZW5ndGggPSBuZXcgUElYSS5Qb2ludCgxMCwxMCk7XHJcblxyXG5cdC8vIFNob2Nrd2F2ZSBlZmZlY3RcclxuXHR0aGlzLl9zaG9ja3dhdmUgPSBudWxsO1xyXG5cdHRoaXMuX3Nob2Nrd2F2ZVRleHR1cmUgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInNob2Nrd2F2ZVwiKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IExldmVsO1xyXG5MZXZlbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExldmVsO1xyXG5cclxuLyoqXHJcbiAqIEluaXRcclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gTG9hZCBvYmplY3RzXHJcblx0dmFyIHBvb2xzID1cclxuXHRbXHJcblx0XHR7aWQ6XCJkZWZhdWx0XCIsICAgICAgICAgcG9vbDpcImRlZmF1bHRcIiwgICAgICAgICBiYXNlOk9iamVjdERlY29yYXRpb24sICAgIGFyZ3M6W10sIHF1YW50aXR5OiAyMH0sXHJcblx0XHR7aWQ6XCJjb2luXCIsICAgICAgICAgICAgcG9vbDpcImNvaW5cIiwgICAgICAgICAgICBiYXNlOk9iamVjdENvaW4sICAgICAgICAgIGFyZ3M6W10sIHF1YW50aXR5OiAyMH0sXHJcblx0XHR7aWQ6XCJ0cm9sbF9tYWdpY1wiLCAgICAgcG9vbDpcInRyb2xsX21hZ2ljXCIsICAgICBiYXNlOk9iamVjdFBvd2VydXAsICAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwiY3J5c3RhbF9jeWFuXCIsICAgIHBvb2w6XCJjcnlzdGFsX2N5YW5cIiwgICAgYmFzZTpPYmplY3RDcnlzdGFsLCAgICAgICBhcmdzOltcImN5YW5cIl19LFxyXG5cdFx0e2lkOlwiY3J5c3RhbF9ncmVlblwiLCAgIHBvb2w6XCJjcnlzdGFsX2dyZWVuXCIsICAgYmFzZTpPYmplY3RDcnlzdGFsLCAgICAgICBhcmdzOltcImdyZWVuXCJdfSxcclxuXHRcdHtpZDpcImNyeXN0YWxfcGlua1wiLCAgICBwb29sOlwiY3J5c3RhbF9waW5rXCIsICAgIGJhc2U6T2JqZWN0Q3J5c3RhbCwgICAgICAgYXJnczpbXCJwaW5rXCJdfSxcclxuXHRcdHtpZDpcImNyeXN0YWxfcHVycGxlXCIsICBwb29sOlwiY3J5c3RhbF9wdXJwbGVcIiwgIGJhc2U6T2JqZWN0Q3J5c3RhbCwgICAgICAgYXJnczpbXCJwdXJwbGVcIl19LFxyXG5cdFx0e2lkOlwianVtcF9wbGF0Zm9ybVwiLCAgIHBvb2w6XCJqdW1wX3BsYXRmb3JtXCIsICAgYmFzZTpPYmplY3RKdW1wUGxhdGZvcm0sICBhcmdzOltdfSxcclxuXHRcdHtpZDpcImxldmVsX2VuZFwiLCAgICAgICBwb29sOlwibGV2ZWxfZW5kXCIsICAgICAgIGJhc2U6T2JqZWN0TGV2ZWxFbmQsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwibGV2ZWxfZ2FtZW92ZXJcIiwgIHBvb2w6XCJsZXZlbF9nYW1lb3ZlclwiLCAgYmFzZTpPYmplY3RMZXZlbEVuZCwgICAgICBhcmdzOltmYWxzZV19LFxyXG5cdFx0e2lkOlwiY2FtZXJhX3pvb21cIiwgICAgIHBvb2w6XCJjYW1lcmFfem9vbVwiLCAgICAgYmFzZTpPYmplY3RDYW1lcmFab29tLCAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInNocmlua19sb2NrXCIsICAgICBwb29sOlwic2hyaW5rX2xvY2tcIiwgICAgIGJhc2U6T2JqZWN0U2hyaW5rTG9jaywgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwic2hyaW5rX3VubG9ja1wiLCAgIHBvb2w6XCJzaHJpbmtfdW5sb2NrXCIsICAgYmFzZTpPYmplY3RTaHJpbmtMb2NrLCAgICBhcmdzOltmYWxzZV19LFxyXG5cdFx0e2lkOlwidHV0b3JpYWxcIiwgICAgICAgIHBvb2w6XCJ0dXRvcmlhbFwiLCAgICAgICAgYmFzZTpPYmplY3RUdXRvcmlhbCwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInN2ZW5cIiwgICAgICAgICAgICBwb29sOlwic3ZlblwiLCAgICAgICAgICAgIGJhc2U6T2JqZWN0U3ZlbiwgICAgICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJzbGVkXCIsICAgICAgICAgICAgcG9vbDpcInNsZWRcIiwgICAgICAgICAgICBiYXNlOk9iamVjdFNsZWQsICAgICAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwidHJvbGxcIiwgICAgICAgICAgIHBvb2w6XCJ0cm9sbFwiLCAgICAgICAgICAgYmFzZTpPYmplY3RUcm9sbCwgICAgICAgICBhcmdzOltmYWxzZV19LFxyXG5cdFx0e2lkOlwidHJvbGxfcGFiYmllXCIsICAgIHBvb2w6XCJ0cm9sbF9wYWJiaWVcIiwgICAgYmFzZTpPYmplY3RUcm9sbCwgICAgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJtYXJzaG1hbGxvd1wiLCAgICAgcG9vbDpcIm1hcnNobWFsbG93XCIsICAgICBiYXNlOk9iamVjdE1hcnNobWFsbG93LCAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwic25vd2JhbGxcIiwgICAgICAgIHBvb2w6XCJzbm93YmFsbFwiLCAgICAgICAgYmFzZTpPYmplY3RTbm93YmFsbCwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcImNyYXRlXzAxXzAwXCIsICAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXSwgcXVhbnRpdHk6IDZ9LFxyXG5cdFx0e2lkOlwiY3JhdGVfMDFfMDFcIiwgICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInNub3dtYW5fMDFfMDBcIiwgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJzbm93bWFuXzAyXzAwXCIsICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwic25vd21hbl8wM18wMFwiLCAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInN0b25lc18wMV8wMFwiLCAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJzdG9uZXNfMDJfMDBcIiwgICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwic3RvbmVzXzAzXzAwXCIsICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInN0b25lc18wMV8wMVwiLCAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJzdG9uZXNfMDJfMDFcIiwgICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwic3RvbmVzXzAzXzAxXCIsICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcInN0b25lc18wMV8wMlwiLCAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJzdG9uZXNfMDJfMDJcIiwgICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwic3RvbmVzXzAzXzAyXCIsICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcImJhcnJlbF8wMV8wMFwiLCAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJiYXJyZWxfMDJfMDBcIiwgICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwiYmFycmVsXzAzXzAwXCIsICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcIndvb2RfMDFfMDBcIiwgICAgICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHR7aWQ6XCJ3b29kXzAyXzAwXCIsICAgICAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0e2lkOlwid29vZF8wM18wMFwiLCAgICAgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdC8vIHtpZDpcImNhcnJpYWdlXzAxXzAwXCIsICBwb29sOlwib2JzdGFjbGVcIiwgICAgICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbXX0sXHJcblx0XHQvLyB7aWQ6XCJjYXJyaWFnZV8wMl8wMFwiLCAgcG9vbDpcIm9ic3RhY2xlXCIsICAgICAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W119LFxyXG5cdFx0Ly8ge2lkOlwiY2FycmlhZ2VfMDNfMDBcIiwgIHBvb2w6XCJvYnN0YWNsZVwiLCAgICAgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOltdfSxcclxuXHRcdHtpZDpcImljZWJsb2NrXzAxXzAwXCIsICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV0sIHF1YW50aXR5OiAxMH0sXHJcblx0XHR7aWQ6XCJpY2VibG9ja18wMl8wMFwiLCAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWJsb2NrXzAzXzAwXCIsICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wMFwiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzAwXCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDBcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wMVwiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzAxXCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDFcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wMlwiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzAyXCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDJcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wM1wiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzAzXCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDNcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wNFwiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzA0XCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDRcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19LFxyXG5cdFx0e2lkOlwiaWNlY3ViZV8wMV8wNVwiLCAgIHBvb2w6XCJvYnN0YWNsZV9pY2VcIiwgICAgYmFzZTpPYmplY3RPYnN0YWNsZSwgICAgICBhcmdzOlt0cnVlXX0sXHJcblx0XHR7aWQ6XCJpY2VjdWJlXzAyXzA1XCIsICAgcG9vbDpcIm9ic3RhY2xlX2ljZVwiLCAgICBiYXNlOk9iamVjdE9ic3RhY2xlLCAgICAgIGFyZ3M6W3RydWVdfSxcclxuXHRcdHtpZDpcImljZWN1YmVfMDNfMDVcIiwgICBwb29sOlwib2JzdGFjbGVfaWNlXCIsICAgIGJhc2U6T2JqZWN0T2JzdGFjbGUsICAgICAgYXJnczpbdHJ1ZV19XHJcblx0XTtcclxuXHJcblx0dGhpcy5vYmplY3RNYW5hZ2VyID0gbmV3IE9iamVjdE1hbmFnZXIocG9vbHMpO1xyXG5cdHRoaXMub2JqZWN0TWFuYWdlci5pbml0KCk7XHJcblxyXG5cdC8vIExheWVyc1xyXG5cdHRoaXMubGF5ZXJDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMubGF5ZXJDb250YWluZXIpO1xyXG5cclxuXHJcblx0Ly8gQmFja2dyb3VuZFxyXG5cdHRoaXMuY3JlYXRlQmFja2dyb3VuZExheWVycygpO1xyXG5cclxuXHQvLyBNYXAgbGF5ZXJzXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuY29uZmlnLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgbGF5ZXIgPSB0aGlzLmFkZExheWVyKHRoaXMuY29uZmlnLmxheWVyc1tpXS5uYW1lLCBuZXcgUElYSS5Qb2ludCgwLDApLCB0aGlzLmNvbmZpZy5sYXllcnNbaV0pO1xyXG5cdFx0bGF5ZXIuaW5pdCgpO1xyXG5cdH1cclxuXHJcblx0Ly8gQ2hhcmFjdGVyXHJcblx0dGhpcy5hZGRMYXllcihcImF2YXRhclwiLCBuZXcgUElYSS5Qb2ludCgwLDApLCB7bmFtZTpcImF2YXRhclwiLCBkZXB0aDo5LjV9KTtcclxuXHR0aGlzLmdldExheWVyKFwiYXZhdGFyXCIpLmFkZENoaWxkKHRoaXMuYXZhdGFyKTtcclxuXHR0aGlzLmF2YXRhci5pbml0KHRoaXMpO1xyXG5cdHRoaXMuYXZhdGFyLnggPSAwO1xyXG5cdHRoaXMuYXZhdGFyLnkgPSAwO1xyXG5cclxuXHQvLyBCcmlkZ2UgbGF5ZXJcclxuXHRpZih0aGlzLmF2YXRhci5hYmlsaXRpZXMuYnJpZGdlKVxyXG5cdFx0dGhpcy5hZGRMYXllcihcImJyaWRnZVwiLCBuZXcgUElYSS5Qb2ludCgwLDApLCB7bmFtZTpcImJyaWRnZVwiLCBkZXB0aDotMC41fSk7XHJcblxyXG5cdC8vIFJlY29yZFxyXG5cdGlmKHRoaXMuZW5kbGVzcyAmJiBDb21tb24uc2F2ZWREYXRhLmdldEhpZ2hzY29yZShcImVuZGxlc3NfZGlzdGFuY2VcIikgPiAwKVxyXG5cdHtcclxuXHRcdHRoaXMucmVjb3JkID0gbmV3IExldmVsUmVjb3JkKENvbW1vbi5zYXZlZERhdGEuZ2V0SGlnaHNjb3JlKFwiZW5kbGVzc19kaXN0YW5jZVwiKSk7XHJcblx0XHR0aGlzLnJlY29yZC5pbml0KHRoaXMpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLnJlY29yZCk7XHJcblx0fVxyXG5cclxuXHQvLyBTb3J0IGxheWVyc1xyXG5cdHRoaXMuc29ydENoaWxkcmVuKCk7XHJcblxyXG5cdC8vIFJlc2V0IGNyeXN0YWwgYW5kIHRyb2xsIGNhY2hlXHJcblx0T2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuaW5kZXhlcyAgID0ge307XHJcblx0T2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuY29sbGVjdGVkID0ge307XHJcblx0T2JqZWN0VHJvbGwucHJvdG90eXBlLmluZGV4ZXMgICA9IDA7XHJcblx0T2JqZWN0VHJvbGwucHJvdG90eXBlLmNvbGxlY3RlZCA9IFtdO1xyXG5cclxuXHQvLyBab29tZWQgYXQgc3RhcnRcclxuXHR0aGlzLnpvb20gPSAxLjU7XHJcblx0dGhpcy5jaGFuZ2Vab29tKHRoaXMuZGVmYXVsdFpvb20sIDMpO1xyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIG9sZFBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQodGhpcy5hdmF0YXIueCwgdGhpcy5hdmF0YXIueSk7XHJcblxyXG5cdHRoaXMuYXZhdGFyLnVwZGF0ZSgpO1xyXG5cclxuXHQvLyBTaGFrZVxyXG5cdGlmKHRoaXMuX2lzU2hha2UpXHJcblx0e1xyXG5cdFx0dGhpcy5fc2hha2VUaW1lICs9IHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdGlmKHRoaXMuX3NoYWtlVGltZSA+PSB0aGlzLl9zaGFrZVRpbWVFbmQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX3NoYWtlVGltZSA9IDA7XHJcblx0XHRcdHRoaXMuX2lzU2hha2UgPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEZvY3VzIHRoZSBjYW1lcmFcclxuXHRpZih0aGlzLmZvY3VzWEFjdGl2ZSkgdGhpcy5mb2N1c1Bvc2l0aW9uLnggPSB0aGlzLmF2YXRhci54O1xyXG5cdGlmKHRoaXMuZm9jdXNZQWN0aXZlKSB0aGlzLmZvY3VzUG9zaXRpb24ueSA9IHRoaXMuYXZhdGFyLnk7XHJcblxyXG5cdHRoaXMueCA9IENvbW1vbi5TVEFHRV9XSURUSCAgKiB0aGlzLmZvY3VzUG9pbnQueCAtIHRoaXMuZm9jdXNQb3NpdGlvbi54ICogdGhpcy56b29tO1xyXG5cdHRoaXMueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgKiB0aGlzLmZvY3VzUG9pbnQueSAtIHRoaXMuZm9jdXNQb3NpdGlvbi55ICogdGhpcy56b29tO1xyXG5cdC8vIHRoaXMueSArPSB0aGlzLmF2YXRhci5oZWFkYm9iSGVpZ2h0ICogTWF0aC5zaW4odGhpcy5hdmF0YXIuaGVhZGJvYlRpbWUgKiB0aGlzLmF2YXRhci5oZWFkYm9iRnJlcXVlbmN5KTtcclxuXHJcblx0aWYodGhpcy5faXNTaGFrZSlcclxuXHR7XHJcblx0XHR0aGlzLnggKz0gcDMuVXRpbHMucmFuZG9tSW50KC0xLDEpICogKHRoaXMuX3NoYWtlU3RyZW5ndGgueCAqICgxIC0gdGhpcy5fc2hha2VUaW1lL3RoaXMuX3NoYWtlVGltZUVuZCkpO1xyXG5cdFx0dGhpcy55ICs9IHAzLlV0aWxzLnJhbmRvbUludCgtMSwxKSAqICh0aGlzLl9zaGFrZVN0cmVuZ3RoLnkgKiAoMSAtIHRoaXMuX3NoYWtlVGltZS90aGlzLl9zaGFrZVRpbWVFbmQpKTtcclxuXHR9XHJcblxyXG5cdC8vIFpvb21cclxuXHR0aGlzLnNjYWxlLnggPSB0aGlzLnpvb207XHJcblx0dGhpcy5zY2FsZS55ID0gdGhpcy56b29tO1xyXG5cclxuXHQvLyBNb3ZlIHRoZSBsYXllcnNcclxuXHR2YXIgZGVsdGFNb3ZlbWVudCA9IG5ldyBQSVhJLlBvaW50KHRoaXMuZm9jdXNYQWN0aXZlID8gKHRoaXMuYXZhdGFyLnggLSBvbGRQb3NpdGlvbi54KSA6IDAsIHRoaXMuZm9jdXNZQWN0aXZlID8gKHRoaXMuYXZhdGFyLnkgLSBvbGRQb3NpdGlvbi55KSA6IDApO1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLmxheWVyc1tpXS51cGRhdGUoZGVsdGFNb3ZlbWVudCk7XHJcblx0fVxyXG5cclxuXHQvLyBFbmRsZXNzIG1vZGUsIGFkZCBuZXcgcGFydHMgaWYgbmVlZGVkXHJcblx0aWYodGhpcy5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdC8vIFVwZGF0ZSB0aGUgcmVjb3JkXHJcblx0XHRpZighIXRoaXMucmVjb3JkKVxyXG5cdFx0XHR0aGlzLnJlY29yZC51cGRhdGUoKTtcclxuXHJcblx0XHR2YXIgbGF5ZXIgPSB0aGlzLmdldExheWVyKFwicGF0aFwiKTsgLy8gSGFyZGNvZGVkLCBmb3Igbm93XHJcblxyXG5cdFx0aWYobGF5ZXIucGF0aHMubGVuZ3RoID09IDApXHJcblx0XHR7XHJcblx0XHRcdHZhciBsYXN0UG9pbnQgPSBuZXcgUElYSS5Qb2ludCgpO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGxheWVyLmNoaWxkcmVuUGF0aHMubGVuZ3RoOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZihsYXllci5jaGlsZHJlblBhdGhzW2ldLmNvbmZpZy5jbG9zZWQpIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRpZihsYXN0UG9pbnQueCA8IGxheWVyLmNoaWxkcmVuUGF0aHNbaV0uY29uZmlnLnBvaW50c1tsYXllci5jaGlsZHJlblBhdGhzW2ldLmNvbmZpZy5wb2ludHMubGVuZ3RoLTFdLngpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0bGFzdFBvaW50ID0gbGF5ZXIuY2hpbGRyZW5QYXRoc1tpXS5jb25maWcucG9pbnRzW2xheWVyLmNoaWxkcmVuUGF0aHNbaV0uY29uZmlnLnBvaW50cy5sZW5ndGgtMV07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBQaWNrIGEgcmFuZG9tIHBpZWNlXHJcblx0XHRcdGlmKHRoaXMuZGF0YS5wYXJ0cy5sZW5ndGggPiAwKVxyXG5cdFx0XHRcdHZhciBwaWVjZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKHRoaXMuZGF0YS5wYXJ0c1twMy5VdGlscy5yYW5kb21JbnQoMCwgdGhpcy5kYXRhLnBhcnRzLmxlbmd0aC0xKV0pO1xyXG5cdFx0XHRlbHNlIGlmKHRoaXMuZGF0YS5wYXJ0RGVidWcgIT0gXCJcIilcclxuXHRcdFx0XHR2YXIgcGllY2UgPSB0aGlzLmRhdGEucGFydERlYnVnO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBsID0gMDsgbCA8IHBpZWNlLmxheWVycy5sZW5ndGg7IGwrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBsYXllciA9IHRoaXMuZ2V0TGF5ZXIocGllY2UubGF5ZXJzW2xdLm5hbWUpO1xyXG5cclxuXHRcdFx0XHRpZihsYXllciA9PSBudWxsKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBsYXllciA9IHRoaXMuYWRkTGF5ZXIocGllY2UubGF5ZXJzW2xdLm5hbWUsIG5ldyBQSVhJLlBvaW50KDAsMCksIHBpZWNlLmxheWVyc1tsXSk7XHJcblx0XHRcdFx0XHR0aGlzLnNvcnRDaGlsZHJlbigpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dmFyIGNsb25lID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwaWVjZS5sYXllcnNbbF0pKTtcclxuXHRcdFx0XHRsYXllci5xdWV1ZVBhdGhzKGNsb25lLnBhdGhzLCBsYXN0UG9pbnQpO1xyXG5cdFx0XHRcdGxheWVyLnF1ZXVlT2JqZWN0cyhjbG9uZS5vYmplY3RzLCBsYXN0UG9pbnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogRGlzcG9zZVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmF2YXRhci5kaXNwb3NlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgYSBsYXllclxyXG4gKiBAcGFyYW0ge1N0cmluZ30gaWRcclxuICogQHBhcmFtIHtQSVhJLlBvaW50fSBwYXJhbGxheFxyXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXHJcbiAqIEByZXR1cm5zIHtMZXZlbExheWVyfVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmFkZExheWVyID0gZnVuY3Rpb24oaWQsIHBhcmFsbGF4LCBjb25maWcpXHJcbntcclxuXHR2YXIgbGF5ZXIgPSBuZXcgTGV2ZWxMYXllcihpZCwgcGFyYWxsYXgsIGNvbmZpZyA/IGNvbmZpZyA6IHtuYW1lOmlkLCBkZXB0aDowfSk7XHJcblx0bGF5ZXIubGV2ZWwgPSB0aGlzO1xyXG5cclxuXHR0aGlzLmxheWVycy5wdXNoKGxheWVyKTtcclxuXHR0aGlzLmxheWVyQ29udGFpbmVyLmFkZENoaWxkKGxheWVyKTtcclxuXHJcblx0cmV0dXJuIGxheWVyO1xyXG59XHJcblxyXG4vKipcclxuICogUmV0dXJuIGEgbGF5ZXIgb3IgbnVsbCBpZiBub3QgZm91bmRcclxuICogQHBhcmFtIHtTdHJpbmd9IGlkXHJcbiAqIEByZXR1cm5zIHtMZXZlbExheWVyfVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmdldExheWVyID0gZnVuY3Rpb24oaWQpXHJcbntcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sYXllcnMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0aWYodGhpcy5sYXllcnNbaV0uaWQgPT0gaWQpXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiB0aGlzLmxheWVyc1tpXTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYmFja2dyb3VuZCBsYXllcnNcclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5jcmVhdGVCYWNrZ3JvdW5kTGF5ZXJzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIGxheWVycyA9IFtdO1xyXG5cdC8vIGxheWVycy5wdXNoKHtpZDpcInNreVwiLCAgICAgICAgaW1hZ2U6dGhpcy5iYWNrZ3JvdW5kUHJlZml4ICsgXCJza3lfZ3JhZGllbnRzXzAwXCIsIHNjYWxlOjEsIHhTcGVlZDowLjAwLCB5OjB9KTtcclxuXHQvLyBsYXllcnMucHVzaCh7aWQ6XCJjbG91ZHNcIiwgICAgIGltYWdlOnRoaXMuYmFja2dyb3VuZFByZWZpeCArIFwibTFjbG91ZHNcIiwgICAgICAgICBzY2FsZToxLCB4U3BlZWQ6MC4wOCwgeTowfSk7XHJcblx0Ly9sYXllcnMucHVzaCh7aWQ6XCJtb3VudGFpbnNcIiwgIGltYWdlOnRoaXMuYmFja2dyb3VuZFByZWZpeCArIFwibTFiZzAwXCIsICAgICAgICAgICBzY2FsZToxLCB4U3BlZWQ6MC4wNSwgeToyMDB9KTtcclxuXHQvL2xheWVycy5wdXNoKHtpZDpcImZhckZpZWxkc1wiLCAgaW1hZ2U6dGhpcy5iYWNrZ3JvdW5kUHJlZml4ICsgXCJtMWJnMDFcIiwgICAgICAgICAgIHNjYWxlOjIsIHhTcGVlZDowLjA3LCB5OjM1MH0pO1xyXG5cdC8vbGF5ZXJzLnB1c2goe2lkOlwiTWlkRmllbGRzMVwiLCBpbWFnZTp0aGlzLmJhY2tncm91bmRQcmVmaXggKyBcIm0xYmcwMlwiLCAgICAgICAgICAgc2NhbGU6MiwgeFNwZWVkOjAuMSwgIHk6MzUwfSk7XHJcblxyXG5cdHZhciBsaWdodHNBbHBoYSA9IENvbW1vbi5zYXZlZERhdGEuZ2V0Q29sbGVjdGVkQ3J5c3RhbENvdW50KCkgLyBDb21tb24uc2F2ZWREYXRhLmdldENyeXN0YWxDb3VudCgpO1xyXG5cclxuXHRsYXllcnMucHVzaCh7aWQ6XCJza3lcIiwgICAgICAgICAgaW1hZ2U6dGhpcy5iYWNrZ3JvdW5kUHJlZml4ICsgXCJiZ18wMFwiLCAgICAgICAgICB4U2NhbGU6MSwgICB5U2NhbGU6MSwgICB4U3BlZWQ6MC4wMCwgeTotMTUwLCAgYWxwaGE6IDF9KTtcclxuXHRsYXllcnMucHVzaCh7aWQ6XCJzdGFyc1wiLCAgICAgICAgaW1hZ2U6XCJuaWdodF9zdGFyc1wiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICB4U2NhbGU6MSwgICB5U2NhbGU6MSwgICB4U3BlZWQ6MC4wMCwgeTowLCAgICAgYWxwaGE6IDF9KTtcclxuXHRsYXllcnMucHVzaCh7aWQ6XCJsaWdodHNfYmx1ZVwiLCAgaW1hZ2U6XCJub3J0aGVybl9saWdodHNfYmx1ZVwiLCAgICAgICAgICAgICAgICAgICB4U2NhbGU6NCwgICB5U2NhbGU6MiwgICB4U3BlZWQ6MC4wMCwgeTotMTgwLCAgYWxwaGE6IGxpZ2h0c0FscGhhLCB4VGlsaW5nOjE1LH0pO1xyXG5cdGxheWVycy5wdXNoKHtpZDpcImxpZ2h0c19ncmVlblwiLCBpbWFnZTpcIm5vcnRoZXJuX2xpZ2h0c19ncmVlblwiLCAgICAgICAgICAgICAgICAgIHhTY2FsZTo0LCAgIHlTY2FsZToyLCAgIHhTcGVlZDowLjAwLCB5Oi0yMTUsICBhbHBoYTogbGlnaHRzQWxwaGEsIHhUaWxpbmc6LTIwfSk7XHJcblx0bGF5ZXJzLnB1c2goe2lkOlwibGlnaHRzX3BpbmtcIiwgIGltYWdlOlwibm9ydGhlcm5fbGlnaHRzX3BpbmtcIiwgICAgICAgICAgICAgICAgICAgeFNjYWxlOjQsICAgeVNjYWxlOjIsICAgeFNwZWVkOjAuMDAsIHk6LTI1MCwgIGFscGhhOiBsaWdodHNBbHBoYSwgeFRpbGluZzoxMCwgfSk7XHJcblx0bGF5ZXJzLnB1c2goe2lkOlwibW91bnRhaW5zXCIsICAgIGltYWdlOnRoaXMuYmFja2dyb3VuZFByZWZpeCArIFwibW91bnRhaW5zXzAwXCIsICAgeFNjYWxlOjEsICAgeVNjYWxlOjEsICAgeFNwZWVkOjAuMDUsIHk6MjgwLCAgIGFscGhhOiAxfSk7XHJcblx0bGF5ZXJzLnB1c2goe2lkOlwiZmFyRmllbGRzXCIsICAgIGltYWdlOnRoaXMuYmFja2dyb3VuZFByZWZpeCArIFwiaGlsbHNfMDBcIiwgICAgICAgeFNjYWxlOjEuNSwgeVNjYWxlOjEuNSwgeFNwZWVkOjAuMDksIHk6MzAwLCBhbHBoYTogMX0pO1xyXG5cdGxheWVycy5wdXNoKHtpZDpcImZhckZpZWxkc1wiLCAgICBpbWFnZTp0aGlzLmJhY2tncm91bmRQcmVmaXggKyBcImhpbGxzXzAxXCIsICAgICAgIHhTY2FsZToxLjUsIHlTY2FsZToxLjUsIHhTcGVlZDowLjEyLCB5OjMwMCwgYWxwaGE6IDF9KTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IGxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgbGF5ZXIgPSB0aGlzLmFkZExheWVyKGxheWVyc1tpXS5pZCwgbmV3IFBJWEkuUG9pbnQobGF5ZXJzW2ldLnhTcGVlZCwgMCksIHtuYW1lOmxheWVyc1tpXS5pZCwgZGVwdGg6LTEwMDAgKyBpfSk7XHJcblx0XHRsYXllci5zZXRCYWNrZ3JvdW5kKGxheWVyc1tpXS5pbWFnZSwgbGF5ZXJzW2ldLnksIG5ldyBQSVhJLlBvaW50KGxheWVyc1tpXS54U2NhbGUsIGxheWVyc1tpXS55U2NhbGUpLCBsYXllcnNbaV0uYWxwaGEpO1xyXG5cclxuXHRcdGlmKGxheWVyc1tpXS54VGlsaW5nKVxyXG5cdFx0XHRsYXllci54VGlsaW5nID0gbGF5ZXJzW2ldLnhUaWxpbmc7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogUmVvcmRlciBsYXllcnMgaW4gY2FudmFzIHVzaW5nIHRoZWlyIGRlcHRoIHZhbHVlXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuc29ydENoaWxkcmVuID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sYXllckNvbnRhaW5lci5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uKGEsIGIpXHJcblx0e1xyXG5cdFx0Ly8gaWYoIWEuY29uZmlnIHx8ICFiLmNvbmZpZykgcmV0dXJuIDA7IC8vIFNraXAgcGFydGljbGVzIHdoZW4gYWRkaW5nIGxheWVycyBkdXJpbmcgZW5kbGVzcyBtb2RlXHJcblxyXG5cdFx0aWYoYS5jb25maWcuZGVwdGggPCBiLmNvbmZpZy5kZXB0aCkgcmV0dXJuIC0xO1xyXG5cdFx0aWYoYS5jb25maWcuZGVwdGggPiBiLmNvbmZpZy5kZXB0aCkgcmV0dXJuIDE7XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoYW5nZSB6b29tIG92ZXIgdGltZVxyXG4gKiBAcGFyYW0ge051bWJlcn0gem9vbSAoMTogMTAwJSlcclxuICogQHBhcmFtIHtOdW1iZXJ9IHRpbWVcclxuICogQHBhcmFtIHtOdW1iZXJ9IGRlbGF5XHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuY2hhbmdlWm9vbSA9IGZ1bmN0aW9uKHpvb20sIHRpbWUsIGRlbGF5KVxyXG57XHJcblx0aWYodGhpcy56b29tVHdlZW4gIT0gbnVsbClcclxuXHRcdHRoaXMuem9vbVR3ZWVuLmtpbGwoKTtcclxuXHJcblx0aWYoem9vbSA9PSB0aGlzLnpvb20pIHJldHVybjtcclxuXHJcblx0dGhpcy56b29tVHdlZW4gPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHR0aGlzLnpvb21Ud2Vlbi50byh0aGlzLCB0aW1lLCB7em9vbTogem9vbSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sICEhZGVsYXkgPyBkZWxheSA6IDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy56b29tVHdlZW4pO1xyXG5cclxuXHR0aGlzLnpvb21UYXJnZXQgPSB6b29tO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hhbmdlIHRoZSBmb2N1cyBwb2ludCBvdmVyIHRpbWVcclxuICogQHBhcmFtIHtQSVhJLlBvaW50fSBmb2N1c1BvaW50XHJcbiAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lXHJcbiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmNoYW5nZUZvY3VzUG9pbnQgPSBmdW5jdGlvbihmb2N1c1BvaW50LCB0aW1lLCBkZWxheSlcclxue1xyXG5cdGlmKHRoaXMuZm9jdXNQb2ludFR3ZWVuICE9IG51bGwpXHJcblx0XHR0aGlzLmZvY3VzUG9pbnRUd2Vlbi5raWxsKCk7XHJcblxyXG5cdGlmKHRoaXMuZm9jdXNQb2ludC5lcXVhbChmb2N1c1BvaW50KSkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmZvY3VzUG9pbnRUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdHRoaXMuZm9jdXNQb2ludFR3ZWVuLnRvKHRoaXMuZm9jdXNQb2ludCwgdGltZSwge3g6IGZvY3VzUG9pbnQueCwgeTpmb2N1c1BvaW50LnksIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAhIWRlbGF5ID8gZGVsYXkgOiAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuZm9jdXNQb2ludFR3ZWVuKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBFeGVjdXRlIGEgc2hha2UgZWZmZWN0XHJcbiAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lXHJcbiAqIEBwYXJhbSB7TnVtYmVyfSBhbW91bnRcclxuICovXHJcbkxldmVsLnByb3RvdHlwZS5zaGFrZSA9IGZ1bmN0aW9uKHRpbWUsIGFtb3VudClcclxue1xyXG5cdHRoaXMuX2lzU2hha2UgICAgICAgPSB0cnVlO1xyXG5cdHRoaXMuX3NoYWtlVGltZSAgICAgPSAwO1xyXG5cdHRoaXMuX3NoYWtlVGltZUVuZCAgPSB0aW1lO1xyXG5cdHRoaXMuX3NoYWtlU3RyZW5ndGggPSBhbW91bnQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeGVjdXRlIGEgc2hvY2t3YXZlIGVmZmVjdFxyXG4gKiBAcGFyYW0ge09iamVjdH0gZ2FtZW9iamVjdFxyXG4gKiBAcGFyYW0ge051bWJlcn0gdGltZVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLnNob2Nrd2F2ZSA9IGZ1bmN0aW9uKGdhbWVvYmplY3QsIHRpbWUpXHJcbntcclxuXHR0aGlzLl9zaG9ja3dhdmUgPSBuZXcgU2hvY2t3YXZlKHRoaXMsIHRoaXMuX3Nob2Nrd2F2ZVRleHR1cmUpO1xyXG5cdHRoaXMuX3Nob2Nrd2F2ZS5hbmltYXRlKHRpbWUpO1xyXG5cdGdhbWVvYmplY3QuYWRkQ2hpbGQodGhpcy5fc2hvY2t3YXZlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4ZWN0dXRlZCB3aGVuIHRoZSBnYW1lIGVuZHMsIGVpdGhlciBieSBjb2xsaWRpbmcgd2l0aCBhIE9iamVjdExldmVsRW5kIGVudGl0eVxyXG4gKi9cclxuTGV2ZWwucHJvdG90eXBlLmdhbWVPdmVyID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gU0NPUkVcclxuXHQvLyA9PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHQvLyBTY29yZVxyXG5cdHRoaXMuc2NvcmUgKz0gdGhpcy5hdmF0YXIuZGlzdGFuY2UgKiB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5zY29yZS5kaXN0YW5jZTtcclxuXHR0aGlzLnNjb3JlICs9IHRoaXMuc25vd2ZsYWtlcyAgICAgICogdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuc2NvcmUuc25vd2ZsYWtlO1xyXG5cdHRoaXMuc2NvcmUgKz0gdGhpcy5zdHlsZVNjb3JlO1xyXG5cclxuXHQvLyBIaWdoc2NvcmVcclxuXHRpZighdGhpcy5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdENvbW1vbi5zYXZlZERhdGEucmVjb3JkSGlnaHNjb3JlKENvbW1vbi5zYXZlZERhdGEubGV2ZWwsIHRoaXMuc2NvcmUpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5yZWNvcmRIaWdoc2NvcmUoXCJlbmRsZXNzXCIsIHRoaXMuc2NvcmUpO1xyXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5yZWNvcmRIaWdoc2NvcmUoXCJlbmRsZXNzX2Rpc3RhbmNlXCIsIHRoaXMuYXZhdGFyLmRpc3RhbmNlKTtcclxuXHR9XHJcblx0XHJcblx0Ly8gU05PV0ZMQUtFU1xyXG5cdC8vID09PT09PT09PT09PT09PT09PT09XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5jb2lucyArPSB0aGlzLnNub3dmbGFrZXM7XHJcblxyXG5cdC8vIENSWVNUQUxTXHJcblx0Ly8gPT09PT09PT09PT09PT09PT09PT1cclxuXHQvLyBTYXZlIGNvbGxlY3RlZCBjcnlzdGFscyAoZXZlbiB3aGVuIHRoZSBwbGF5ZXIgaGFzIGxvc3QpXHJcblx0Zm9yKHZhciBjaGFyYWN0ZXIgaW4gT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuY29sbGVjdGVkKVxyXG5cdHtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBPYmplY3RDcnlzdGFsLnByb3RvdHlwZS5jb2xsZWN0ZWRbY2hhcmFjdGVyXS5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5jcnlzdGFsc1tDb21tb24uc2F2ZWREYXRhLmxldmVsXVtjaGFyYWN0ZXJdW09iamVjdENyeXN0YWwucHJvdG90eXBlLmNvbGxlY3RlZFtjaGFyYWN0ZXJdW2ldXSA9IHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBBbGwgY3J5c3RhbHMgY29sbGVjdGVkIG1lc3NhZ2VcclxuXHRpZighQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93biAmJiBDb21tb24uc2F2ZWREYXRhLmdldENyeXN0YWxDb3VudCgpID09IENvbW1vbi5zYXZlZERhdGEuZ2V0Q29sbGVjdGVkQ3J5c3RhbENvdW50KCkpXHJcblx0e1xyXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93ID0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdC8vIFRST0xMU1xyXG5cdC8vID09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cdC8vIFNhdmUgY29sbGVjdGVkIHRyb2xsc1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBPYmplY3RUcm9sbC5wcm90b3R5cGUuY29sbGVjdGVkLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdENvbW1vbi5zYXZlZERhdGEudHJvbGxzW0NvbW1vbi5zYXZlZERhdGEubGV2ZWxdW09iamVjdFRyb2xsLnByb3RvdHlwZS5jb2xsZWN0ZWRbaV1dID0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdC8vIEFsbCB0cm9sbHMgY29sbGVjdGVkIG1lc3NhZ2VcclxuXHRpZighQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS50cm9sbHMuc2hvd24gJiYgQ29tbW9uLnNhdmVkRGF0YS5nZXRDb2xsZWN0ZWRUcm9sbENvdW50KCkgPT0gQ29tbW9uLnNhdmVkRGF0YS5nZXRUcm9sbENvdW50KCkpXHJcblx0e1xyXG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS50cm9sbHMuc2hvdyA9IHRydWU7XHJcblx0fVxyXG5cclxuXHQvLyBVTkxPQ0tBQkxFU1xyXG5cdC8vID09PT09PT09PT09PT09PT09PT09XHJcblx0aWYoIXRoaXMuZW5kbGVzcylcclxuXHR7XHJcblx0XHRpZih0aGlzLmNvbXBsZXRlZClcclxuXHRcdHtcclxuXHRcdFx0Ly8gVW5sb2NrIG5ldyBsZXZlbHNcclxuXHRcdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCA9PSBDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkLTEpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZihDb21tb24uc2F2ZWREYXRhLmxldmVsIDwgKENvbW1vbi5zYXZlZERhdGEubGV2ZWxzLTEpKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdENvbW1vbi5zYXZlZERhdGEubGV2ZWxzVW5sb2NrZWQrKztcclxuXHRcdFx0XHRcdENvbW1vbi5zYXZlZERhdGEuc2hvd1VubG9ja2VkTGV2ZWwgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0aWYoIUNvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UubGV2ZWxzLnNob3duKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRDb21tb24uc2F2ZWREYXRhLmVuZEdhbWVNZXNzYWdlLmxldmVscy5zaG93ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFVubG9jayBlbmRsZXNzXHJcblx0XHRcdGlmKCFDb21tb24uc2F2ZWREYXRhLmVuZEdhbWVNZXNzYWdlLmVuZGxlc3Muc2hvd24gJiYgQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCA9PSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5lbmRsZXNzLmxldmVsUmVxdWlyZWQtMSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UuZW5kbGVzcy5zaG93ID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gVW5sb2NrIG5ldyBjaGFyYWN0ZXJzXHJcblx0XHRcdGlmKENvbW1vbi5zYXZlZERhdGEubGV2ZWwgPT0gMCAmJiAhQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzVW5sb2NrZWQua3Jpc3RvZmYpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNVbmxvY2tlZC5rcmlzdG9mZiA9IHRydWU7XHJcblx0XHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRDaGFyYWN0ZXIgPSBcImtyaXN0b2ZmXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCA9PSAyICYmICFDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNVbmxvY2tlZC5vbGFmKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzVW5sb2NrZWQub2xhZiA9IHRydWU7XHJcblx0XHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRDaGFyYWN0ZXIgPSBcIm9sYWZcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihDb21tb24uc2F2ZWREYXRhLmxldmVsID09IDQgJiYgIUNvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1VubG9ja2VkLmVsc2EpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNVbmxvY2tlZC5lbHNhID0gdHJ1ZTtcclxuXHRcdFx0XHRDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZENoYXJhY3RlciA9IFwiZWxzYVwiO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVW5sb2NrIHBhYmJpZVxyXG5cdFx0aWYoKENvbW1vbi5zYXZlZERhdGEuZ2V0Q29sbGVjdGVkQ3J5c3RhbENvdW50KCkgPT0gQ29tbW9uLnNhdmVkRGF0YS5nZXRDcnlzdGFsQ291bnQoKSkgJiYgIUNvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1VubG9ja2VkLnBhYmJpZSlcclxuXHRcdHtcclxuXHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzVW5sb2NrZWQucGFiYmllID0gdHJ1ZTtcclxuXHRcdFx0Q29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRDaGFyYWN0ZXIgPSBcInBhYmJpZVwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEV2ZW50IFRyYWNraW5nXHJcblx0XHRpZihDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZENoYXJhY3RlciAhPSBcIlwiKVxyXG5cdFx0e1xyXG5cdFx0XHRDb21tb24uY3Rvdy50cmFja0V2ZW50KFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0ZXZlbnQgICAgICA6IFwiZ2FtZV9hY3Rpb25cIixcclxuXHRcdFx0XHRnYW1lX2xldmVsIDogKENvbW1vbi5zYXZlZERhdGEubGV2ZWwrMSksXHJcblx0XHRcdFx0Z2FtZV90aWVyMSA6IFwiY2hhcmFjdGVyX3VubG9ja2VkXCIsXHJcblx0XHRcdFx0Z2FtZV90aWVyMiA6IENvbW1vbi5zYXZlZERhdGEuc2hvd1VubG9ja2VkQ2hhcmFjdGVyXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gTG9zcyBTdHJlYWtcclxuXHRpZighdGhpcy5lbmRsZXNzKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuY29tcGxldGVkKVxyXG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLmxvc3NTdHJlYWsuY291bnQgPSAwO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLmxvc3NTdHJlYWsuY291bnQrKztcclxuXHR9XHJcblxyXG5cdC8vIFNBVkVcclxuXHQvLyA9PT09PT09PT09PT09PT09PT09PVxyXG5cdENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xyXG5cclxuXHR0aGlzLnBhcmVudC5nYW1lT3ZlcigpO1xyXG59XHJcblxyXG4vKipcclxuICogRXhlY3R1dGVkIHdoZW4gdGhlIGdhbWUgaXMgcGF1c2VkXHJcbiAqL1xyXG5MZXZlbC5wcm90b3R5cGUuc3RvcExvb3BzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gU3RvcCBsb29wc1xyXG5cdHRoaXMuYXZhdGFyLnN0b3BMb29wcygpO1xyXG5cclxuXHR2YXIgbWFyc2htYWxsb3dzID0gdGhpcy5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJtYXJzaG1hbGxvd1wiKTtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgbWFyc2htYWxsb3dzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdG1hcnNobWFsbG93c1tpXS5zdG9wTG9vcHMoKTtcclxuXHR9XHJcbn0iLCJ2YXIgQ29tbW9uICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBMZXZlbFBhdGggID0gcmVxdWlyZShcIi4uL2dhbWUvTGV2ZWxQYXRoXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIExldmVsTGF5ZXIoaWQsIHBhcmFsbGF4LCBjb25maWcpXHJcbntcclxuXHR0aGlzLmxldmVsICAgICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLmlkICAgICAgICAgICAgICA9IGlkO1xyXG5cdHRoaXMucGFyYWxsYXggICAgICAgID0gdHlwZW9mKHBhcmFsbGF4KSAhPSBcInVuZGVmaW5lZFwiID8gcGFyYWxsYXggOiBuZXcgUElYSS5Qb2ludCgxLDEpO1xyXG5cdHRoaXMuYmcgICAgICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICAgICA9ICEhY29uZmlnID8gY29uZmlnIDogbnVsbDtcclxuXHR0aGlzLnBhdGhzICAgICAgICAgICA9IFtdO1xyXG5cdHRoaXMub2JqZWN0cyAgICAgICAgID0gW107XHJcblx0dGhpcy5jaGlsZHJlblBhdGhzICAgPSBbXTtcclxuXHR0aGlzLmNoaWxkcmVuT2JqZWN0cyA9IFtdO1xyXG5cclxuXHR0aGlzLmFzc2V0TWFuYWdlciA9IHAzLkFzc2V0TWFuYWdlci5pbnN0YW5jZTtcclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gTGV2ZWxMYXllcjtcclxuTGV2ZWxMYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTGV2ZWxMYXllcjtcclxuXHJcbi8qKlxyXG4gKiBJbml0XHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5jb25maWcgPT0gbnVsbCkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLnF1ZXVlUGF0aHModGhpcy5jb25maWcucGF0aHMpO1xyXG5cdHRoaXMucXVldWVPYmplY3RzKHRoaXMuY29uZmlnLm9iamVjdHMpO1xyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihkZWx0YU1vdmVtZW50KVxyXG57XHJcblx0aWYoIXRoaXMuYmcpXHJcblx0e1xyXG5cdFx0aWYodGhpcy5wYXJhbGxheC54ICE9IDApXHJcblx0XHRcdHRoaXMueCArPSBkZWx0YU1vdmVtZW50LnggKiB0aGlzLnBhcmFsbGF4Lng7XHJcblxyXG5cdFx0aWYodGhpcy5wYXJhbGxheC55ICE9IDApXHJcblx0XHRcdHRoaXMueSArPSBkZWx0YU1vdmVtZW50LnkgKiB0aGlzLnBhcmFsbGF4Lnk7XHJcblxyXG5cdFx0dmFyIG5ld0VsZW1lbnRzID0gZmFsc2U7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIHBhdGhzXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlblBhdGhzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmNoaWxkcmVuUGF0aHNbaV0udXBkYXRlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQWRkIG5ldyBwYXRoc1xyXG5cdFx0d2hpbGUodGhpcy5wYXRocy5sZW5ndGggPiAwICYmICh0aGlzLnBhdGhzWzBdLmJvdW5kc1swXSA8IChDb21tb24uU1RBR0VfV0lEVEggLSB0aGlzLmxldmVsLngpICogKDEvdGhpcy5sZXZlbC56b29tKSkgJiYgKHRoaXMucGF0aHNbMF0uYm91bmRzWzFdID4gLSB0aGlzLmxldmVsLnggKiAoMS90aGlzLmxldmVsLnpvb20pKSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGxldmVsUGF0aCA9IG5ldyBMZXZlbFBhdGgodGhpcywgdGhpcy5wYXRoc1swXSk7XHJcblx0XHRcdGxldmVsUGF0aC5pbml0KCk7XHJcblx0XHRcdGxldmVsUGF0aC5yZW5kZXIoKTtcclxuXHRcdFx0dGhpcy5hZGRDaGlsZChsZXZlbFBhdGgpXHJcblx0XHRcdHRoaXMuY2hpbGRyZW5QYXRocy5wdXNoKGxldmVsUGF0aCk7XHJcblxyXG5cdFx0XHR0aGlzLnBhdGhzLnNwbGljZSgwLCAxKTtcclxuXHJcblx0XHRcdG5ld0VsZW1lbnRzID0gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZW1vdmUgcGF0aHMgb3V0c2lkZVxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW5QYXRocy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYodGhpcy5jaGlsZHJlblBhdGhzW2ldLmNvbmZpZy5ib3VuZHNbMV0gPCAtIHRoaXMubGV2ZWwueCAqICgxL3RoaXMubGV2ZWwuem9vbSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmNoaWxkcmVuUGF0aHNbaV0uZGlzcG9zZSgpO1xyXG5cdFx0XHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5jaGlsZHJlblBhdGhzW2ldKTtcclxuXHRcdFx0XHR0aGlzLmNoaWxkcmVuUGF0aHMuc3BsaWNlKGksIDEpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQWRkIG5ldyBvYmplY3RzXHJcblx0XHR3aGlsZSh0aGlzLm9iamVjdHMubGVuZ3RoID4gMCAmJiAodGhpcy5vYmplY3RzWzBdLnBvc2l0aW9uLnggPCAoQ29tbW9uLlNUQUdFX1dJRFRIIC0gdGhpcy5sZXZlbC54KSAqICgxL3RoaXMubGV2ZWwuem9vbSkpICYmICh0aGlzLm9iamVjdHNbMF0ucG9zaXRpb24ueCA+IC0gdGhpcy5sZXZlbC54ICogKDEvdGhpcy5sZXZlbC56b29tKSkpXHJcblx0XHR7XHJcblx0XHRcdC8vIEhhcmRjb2RlZCB0cm9sbCBiZWhhdmlvdXJcclxuXHRcdFx0Ly8gSGlkZSBzaWducyBhbmQgdHJvbGwgZm9yIHBhYmJpZSBhbmQgY29sbGVjdGFibGUgdHJvbGxzIGZvciBvdGhlciBjaGFyYWN0ZXJzXHJcblx0XHRcdGlmKChDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcInBhYmJpZVwiICYmICh0aGlzLm9iamVjdHNbMF0uaWQgPT0gXCJ0cm9sbF9zaWduXCIgfHwgdGhpcy5vYmplY3RzWzBdLmlkID09IFwidHJvbGxfc2lnbl9hcnJvd1wiIHx8IHRoaXMub2JqZWN0c1swXS5pZCA9PSBcInRyb2xsXCIpXHJcblx0XHRcdC8vfHwgKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyICE9IFwicGFiYmllXCIgJiYgKHRoaXMub2JqZWN0c1swXS5pZCA9PSBcInRyb2xsX3BhYmJpZVwiKSkpXHJcblx0XHRcdHx8ICghQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93biAmJiAodGhpcy5vYmplY3RzWzBdLmlkID09IFwidHJvbGxfcGFiYmllXCIpKSlcclxuXHRcdFx0KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5vYmplY3RzLnNwbGljZSgwLCAxKTtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gQWRkIG9iamVjdFxyXG5cdFx0XHR0aGlzLmFkZE9iamVjdCh0aGlzLm9iamVjdHNbMF0uaWQsIHRoaXMub2JqZWN0c1swXSk7XHJcblx0XHRcdHRoaXMub2JqZWN0cy5zcGxpY2UoMCwgMSk7XHJcblx0XHRcdG5ld0VsZW1lbnRzID0gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZW1vdmUgb2JqZWN0cyBvdXRzaWRlXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbk9iamVjdHMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMuY2hpbGRyZW5PYmplY3RzW2ldLnJlbW92ZVdoZW5PdXRzaWRlICYmIHRoaXMuY2hpbGRyZW5PYmplY3RzW2ldLnggPCAtIHRoaXMubGV2ZWwueCAqICgxL3RoaXMubGV2ZWwuem9vbSkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmNoaWxkcmVuT2JqZWN0c1tpXS5kaXNwb3NlKCk7XHJcblx0XHRcdFx0dGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmRpc3Bvc2UodGhpcy5jaGlsZHJlbk9iamVjdHNbaV0pOyAvLyBGcmVlIHRoZSByZXNvdXJjZSBmcm9tIHRoZSBwb29sXHJcblx0XHRcdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLmNoaWxkcmVuT2JqZWN0c1tpXSk7XHJcblx0XHRcdFx0dGhpcy5jaGlsZHJlbk9iamVjdHMuc3BsaWNlKGksIDEpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gU29ydCBvYmplY3RzIGFuZCBwYXRocyBpZiBuZXcgb25lcyBoYXZlIGJlZW4gYWRkZWRcclxuXHRcdGlmKG5ld0VsZW1lbnRzKVxyXG5cdFx0XHR0aGlzLnNvcnRDaGlsZHJlbigpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy54ID0gLXRoaXMubGV2ZWwueCAqIDEvdGhpcy5sZXZlbC56b29tO1xyXG5cdFx0dGhpcy55ID0gLXRoaXMubGV2ZWwueSAqIDEvdGhpcy5sZXZlbC56b29tOy8vICsgKENvbW1vbi5TVEFHRV9IRUlHSFQgKiAoMS10aGlzLmxldmVsLnpvb20pLzIpICogMS90aGlzLmxldmVsLnpvb207XHJcblx0XHR0aGlzLmJnLnRpbGVQb3NpdGlvbi54IC09IGRlbHRhTW92ZW1lbnQueCAqIHRoaXMucGFyYWxsYXgueDtcclxuXHRcdHRoaXMuYmcudGlsZVBvc2l0aW9uLnkgLT0gZGVsdGFNb3ZlbWVudC55ICogdGhpcy5wYXJhbGxheC55O1xyXG5cdFx0Ly8gdGhpcy5iZy53aWR0aCA9IENvbW1vbi5TVEFHRV9XSURUSCAqIDEvdGhpcy5sZXZlbC56b29tO1xyXG5cdFx0Ly8gdGhpcy5iZy50aWxlU2NhbGUgPSBuZXcgUElYSS5Qb2ludCh0aGlzLmJnU2NhbGUgKiAxL3RoaXMubGV2ZWwuem9vbSwgdGhpcy5iZ1NjYWxlICogMS90aGlzLmxldmVsLnpvb20pO1xyXG5cdFx0dGhpcy5iZy5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDEvdGhpcy5sZXZlbC56b29tLCAxL3RoaXMubGV2ZWwuem9vbSk7XHJcblx0XHR0aGlzLmJnLnkgPSB0aGlzLmJnLnlPciAqIDEvdGhpcy5sZXZlbC56b29tO1xyXG5cdFx0XHJcblx0XHRpZih0aGlzLnhUaWxpbmcpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuYmcudGlsZVBvc2l0aW9uLnggKz0gcDMuVGltZXN0ZXAuZGVsdGFUaW1lICogdGhpcy54VGlsaW5nO1x0XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBVcGRhdGUgY2hpbGRyZW5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbk9iamVjdHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dGhpcy5jaGlsZHJlbk9iamVjdHNbaV0udXBkYXRlKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogU3RvcmUgYSBsaXN0IG9mIHBhdGhzIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGUgbGV2ZWwgb25jZSB0aGV5IGFyZSBjbG9zZSBlbm91Z2hcclxuICogQHBhcmFtIHtBcnJheX0gcGF0aHNcclxuICogQHBhcmFtIHtQSVhJLlBvaW50fSBkZWx0YVxyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUucXVldWVQYXRocyA9IGZ1bmN0aW9uKHBhdGhzLCBkZWx0YSlcclxue1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBwYXRocy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRpZih0eXBlb2YoZGVsdGEpICE9IFwidW5kZWZpbmVkXCIpXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgcCA9IDA7IHAgPCBwYXRoc1tpXS5wb2ludHMubGVuZ3RoOyBwKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRwYXRoc1tpXS5wb2ludHNbcF0ueCArPSBkZWx0YS54O1xyXG5cdFx0XHRcdHBhdGhzW2ldLnBvaW50c1twXS55ICs9IGRlbHRhLnk7XHJcblx0XHRcdH1cclxuXHRcdFx0cGF0aHNbaV0uYm91bmRzWzBdICs9IGRlbHRhLng7XHJcblx0XHRcdHBhdGhzW2ldLmJvdW5kc1sxXSArPSBkZWx0YS54O1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMucGF0aHMucHVzaChwYXRoc1tpXSlcclxuXHR9XHJcblxyXG5cdHRoaXMucGF0aHMuc29ydChmdW5jdGlvbihhLCBiKVxyXG5cdHtcclxuXHRcdGlmKGEuYm91bmRzWzBdIDwgYi5ib3VuZHNbMF0pIHJldHVybiAtMTtcclxuXHRcdGlmKGEuYm91bmRzWzBdID4gYi5ib3VuZHNbMF0pIHJldHVybiAxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdG9yZSBhIGxpc3Qgb2Ygb2JqZWN0cyB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGxldmVsIG9uY2UgdGhleSBhcmUgY2xvc2UgZW5vdWdoXHJcbiAqIEBwYXJhbSB7QXJyYXl9IG9iamVjdHNcclxuICogQHBhcmFtIHtQSVhJLlBvaW50fSBkZWx0YVxyXG4gKi9cclxuTGV2ZWxMYXllci5wcm90b3R5cGUucXVldWVPYmplY3RzID0gZnVuY3Rpb24ob2JqZWN0cywgZGVsdGEpXHJcbntcclxuXHRpZighZGVsdGEpIGRlbHRhID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IG9iamVjdHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0aWYodHlwZW9mKGRlbHRhKSAhPSBcInVuZGVmaW5lZFwiKVxyXG5cdFx0e1xyXG5cdFx0XHRvYmplY3RzW2ldLnBvc2l0aW9uLnggKz0gZGVsdGEueDtcclxuXHRcdFx0b2JqZWN0c1tpXS5wb3NpdGlvbi55ICs9IGRlbHRhLnk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5vYmplY3RzLnB1c2gob2JqZWN0c1tpXSk7XHJcblx0fVxyXG5cclxuXHR0aGlzLm9iamVjdHMuc29ydChmdW5jdGlvbihhLCBiKVxyXG5cdHtcclxuXHRcdGlmKGEucG9zaXRpb24ueCA8IGIucG9zaXRpb24ueCkgcmV0dXJuIC0xO1xyXG5cdFx0aWYoYS5wb3NpdGlvbi54ID4gYi5wb3NpdGlvbi54KSByZXR1cm4gMTtcclxuXHRcdHJldHVybiAwO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIGFuIG9iamVjdCB0byB0aGUgbGV2ZWxcclxuICogQHBhcmFtIHtTdHJpbmd9IGlkXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLmFkZE9iamVjdCA9IGZ1bmN0aW9uKGlkLCBjb25maWcpXHJcbntcclxuXHR2YXIgb2JqID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdlbmVyYXRlKGlkKTtcclxuXHRvYmouY29uZmlndXJlKHRoaXMubGV2ZWwsIGNvbmZpZyk7XHJcblx0dGhpcy5hZGRDaGlsZChvYmopXHJcblx0dGhpcy5jaGlsZHJlbk9iamVjdHMucHVzaChvYmopO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBhIGJhY2tncm91bmQgbGF5ZXJYXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBpbWFnZVxyXG4gKiBAcGFyYW0ge051bWJlcn0geVxyXG4gKiBAcGFyYW0ge1BJWEkuUG9pbnR9IHNjYWxlXHJcbiAqL1xyXG5MZXZlbExheWVyLnByb3RvdHlwZS5zZXRCYWNrZ3JvdW5kID0gZnVuY3Rpb24oaW1hZ2UsIHksIHNjYWxlLCBhbHBoYSlcclxue1xyXG5cdHZhciB0ZXh0dXJlICAgICAgID0gdGhpcy5hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShpbWFnZSk7XHJcblx0dGhpcy5iZyAgICAgICAgICAgPSBuZXcgUElYSS5leHRyYXMuVGlsaW5nU3ByaXRlKHRleHR1cmUsIENvbW1vbi5TVEFHRV9XSURUSCwgdGV4dHVyZS5jcm9wLmhlaWdodCAqIHNjYWxlLnkpO1xyXG5cdHRoaXMuYmcudGlsZVNjYWxlID0gbmV3IFBJWEkuUG9pbnQoc2NhbGUueCwgc2NhbGUueSk7XHJcblx0dGhpcy5iZy55ICAgICAgICAgPSB5O1xyXG5cdHRoaXMuYmcuYWxwaGEgICAgID0gYWxwaGE7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLmJnKTtcclxuXHJcblx0dGhpcy5iZy55T3IgPSB5O1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFJlb3JkZXIgdGhlIGNoaWxkcmVuIGluIGNhbnZhcyB1c2luZyB0aGVpciBkZXB0aCB2YWx1ZVxyXG4gKiBJZiB0aGUgdmFsdWUgaXMgdGhlIHNhbWUgcmVuZGVyIG9iamVjdHMgb24gdG9wIG9mIHBhdGhzXHJcbiAqIElmIGJvdGggYXJlIHBhdGhzIG9yZGVyIHRoZW0gdXNpbmcgdGhlaXIgc3RhcnRpbmcgcG9zaXRpb25cclxuICovXHJcbkxldmVsTGF5ZXIucHJvdG90eXBlLnNvcnRDaGlsZHJlbiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuY2hpbGRyZW4uc29ydChmdW5jdGlvbihhLCBiKVxyXG5cdHtcclxuXHRcdGlmKGEuY29uZmlnLmRlcHRoIDwgYi5jb25maWcuZGVwdGgpXHJcblx0XHRcdHJldHVybiAtMTtcclxuXHRcdGVsc2UgaWYoYS5jb25maWcuZGVwdGggPiBiLmNvbmZpZy5kZXB0aClcclxuXHRcdFx0cmV0dXJuICsxO1xyXG5cdFx0ZWxzZSBpZighIWEuY29uZmlnLmJvdW5kcyAmJiAhYi5jb25maWcuYm91bmRzKVxyXG5cdFx0XHRyZXR1cm4gLTE7XHJcblx0XHRlbHNlIGlmKCFhLmNvbmZpZy5ib3VuZHMgJiYgISFiLmNvbmZpZy5ib3VuZHMpXHJcblx0XHRcdHJldHVybiArMTtcclxuXHRcdGVsc2UgaWYoISFhLmNvbmZpZy5ib3VuZHMgJiYgISFiLmNvbmZpZy5ib3VuZHMpXHJcblx0XHRcdHJldHVybiBhLmNvbmZpZy5ib3VuZHNbMF0gPCBiLmNvbmZpZy5ib3VuZHNbMF0gPyAtMSA6ICsxO1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fSk7XHJcbn0iLCJ2YXIgQ29tbW9uICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBCZXppZXJQYXRoID0gcmVxdWlyZShcIi4uL2VkaXRvci9CZXppZXJQYXRoXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIExldmVsUGF0aChsYXllciwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5fYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cclxuXHR0aGlzLmxheWVyICAgICA9IGxheWVyO1xyXG5cdHRoaXMubGV2ZWwgICAgID0gbGF5ZXIubGV2ZWw7XHJcblx0dGhpcy5jb25maWcgICAgPSBjb25maWc7XHJcblx0dGhpcy5iZXppZXIgICAgPSBuZXcgQmV6aWVyUGF0aCgpO1xyXG5cdHRoaXMud2lyZWZyYW1lID0gbnVsbDtcclxuXHR0aGlzLnRleHR1cmVzICA9IG51bGw7XHJcblx0dGhpcy50b0RlbGV0ZSAgPSBmYWxzZTtcclxuXHJcblx0dGhpcy5pY2VCcmlkZ2VQUyA9IG51bGw7XHJcblxyXG5cdHRoaXMuYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBMZXZlbFBhdGg7XHJcbkxldmVsUGF0aC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsUGF0aC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMZXZlbFBhdGg7XHJcblxyXG4vKipcclxuICogSW5pdFxyXG4gKi9cclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuY29uZmlnLnBvaW50cy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLmJlemllci5hZGRQb2ludCh0aGlzLmNvbmZpZy5wb2ludHNbaV0ueCwgdGhpcy5jb25maWcucG9pbnRzW2ldLnkpO1xyXG5cdH1cclxuXHJcblx0aWYodGhpcy5jb25maWcuZGF0YSAhPSBcIlwiKVxyXG5cdHtcclxuXHRcdC8vIFRPRE86IHBhcnNlIHRoZSBqc29uIG9ubHkgdGhlIGZpcnN0IHRpbWVcclxuXHRcdHRyeVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmNvbmZpZy5kYXRhID0gSlNPTi5wYXJzZSh0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdH1cclxuXHRcdGNhdGNoKGUpXHJcblx0XHR7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJDb3VsZG4ndCBwYXJzZSBwYXRoIEpTT05cIik7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhlKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVcclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLmljZUJyaWRnZVBTKVxyXG5cdHtcclxuXHRcdHRoaXMuaWNlQnJpZGdlUFMudXBkYXRlU3Bhd25Qb3ModGhpcy50ZXh0dXJlcy5tYXNrLnggKyB0aGlzLnRleHR1cmVzLm1hc2suYm91bmRzLndpZHRoICwgdGhpcy50ZXh0dXJlcy5tYXNrLnkrIDUwKTtcclxuXHRcdHRoaXMuaWNlQnJpZGdlUFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcblx0fVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFJlbmRlclxyXG4gKi9cclxuTGV2ZWxQYXRoLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLnRleHR1cmVzICE9IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLnRleHR1cmVzKTtcclxuXHR9XHJcblx0dGhpcy50ZXh0dXJlcyAgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHJcblx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHR7XHJcblx0XHRpZih0aGlzLndpcmVmcmFtZSAhPSBudWxsKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnJlbW92ZUNoaWxkKHRoaXMud2lyZWZyYW1lKTtcclxuXHRcdH1cclxuXHRcdHRoaXMud2lyZWZyYW1lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHR9XHJcblxyXG5cdGlmKHRoaXMuYmV6aWVyLnBvaW50cy5sZW5ndGggPiAxKVxyXG5cdHtcclxuXHRcdHZhciBkcmF3aW5nUG9pbnRzID0gdGhpcy5iZXppZXIuZ2V0RHJhd2luZ1BvaW50cygpO1xyXG5cclxuXHRcdC8vIERyYXcgZmlsbCB0ZXh0dXJlXHJcblx0XHRpZih0aGlzLmNvbmZpZy50ZXhGaWxsICE9IFwiXCIgJiYgIXRoaXMuaXNIaWRkZW4oKSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGxvd2VyUG9pbnQgPSBudWxsO1xyXG5cdFx0XHR2YXIgY29udG91ciA9IFtdO1xyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZHJhd2luZ1BvaW50cy5sZW5ndGg7IGkrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNvbnRvdXIucHVzaChuZXcgcG9seTJ0cmkuUG9pbnQoZHJhd2luZ1BvaW50c1tpXS54LCBkcmF3aW5nUG9pbnRzW2ldLnkpKTtcclxuXHJcblx0XHRcdFx0aWYobG93ZXJQb2ludCA9PSBudWxsIHx8IGxvd2VyUG9pbnQgPCBkcmF3aW5nUG9pbnRzW2ldLnkpXHJcblx0XHRcdFx0XHRsb3dlclBvaW50ID0gZHJhd2luZ1BvaW50c1tpXS55O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZighdGhpcy5jb25maWcuY2xvc2VkKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y29udG91ci5wdXNoKHt4OiBkcmF3aW5nUG9pbnRzW2RyYXdpbmdQb2ludHMubGVuZ3RoLTFdLngsIHk6IGxvd2VyUG9pbnQgKyB0aGlzLmNvbmZpZy50ZXhGaWxsUGFkZGluZ30pO1xyXG5cdFx0XHRcdGNvbnRvdXIucHVzaCh7eDogZHJhd2luZ1BvaW50c1swXS54LCB5OiBsb3dlclBvaW50ICsgdGhpcy5jb25maWcudGV4RmlsbFBhZGRpbmd9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBSZW1vdmUgbGFzdCBwb2ludCBpZiBjb2luY2lkZXMgd2l0aCB0aGUgZmlyc3QsIG90aGVyd2lzZSB0aGUgdHJpYW5ndWxhdGlvbiB3aWxsIGZhaWxcclxuXHRcdFx0XHRpZihjb250b3VyWzBdLnggPT0gY29udG91cltjb250b3VyLmxlbmd0aC0xXS54ICYmIGNvbnRvdXJbMF0ueSA9PSBjb250b3VyW2NvbnRvdXIubGVuZ3RoLTFdLnkpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Y29udG91ci5zcGxpY2UoY29udG91ci5sZW5ndGgtMSwgMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0cnlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7XHJcblx0XHRcdFx0c3djdHgudHJpYW5ndWxhdGUoKTtcclxuXHRcdFx0XHR2YXIgdHJpYW5nbGVzID0gc3djdHguZ2V0VHJpYW5nbGVzKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2goZSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiVHJpYW5ndWxhdGlvbiBmYWlsZWRcIilcclxuXHRcdFx0fVxyXG5cclxuXHJcblx0XHRcdGlmKCEhdHJpYW5nbGVzKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gRHJhdyB0aGUgZmlsbGluZyBtZXNoXHJcblx0XHRcdFx0dmFyIHRleHR1cmUgICAgPSB0aGlzLmFzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuY29uZmlnLnRleEZpbGwpO1xyXG5cdFx0XHRcdHZhciB2ZXJ0aWNlcyAgID0gbmV3IEZsb2F0MzJBcnJheSg2ICogdHJpYW5nbGVzLmxlbmd0aCk7XHJcblx0XHRcdFx0dmFyIHV2cyAgICAgICAgPSBuZXcgRmxvYXQzMkFycmF5KDYgKiB0cmlhbmdsZXMubGVuZ3RoKTtcclxuXHRcdFx0XHR2YXIgaW5kaWNlcyAgICA9IG5ldyBVaW50MTZBcnJheSgzICogdHJpYW5nbGVzLmxlbmd0aCk7XHJcblxyXG5cdFx0XHRcdHZhciBzaXplID0gdGhpcy5jb25maWcudGV4RmlsbFNpemU7XHJcblxyXG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIHBvaW50cyA9IHRyaWFuZ2xlc1tpXS5nZXRQb2ludHMoKTtcclxuXHJcblx0XHRcdFx0XHR2ZXJ0aWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdHBvaW50c1swXS54LCBwb2ludHNbMF0ueSxcclxuXHRcdFx0XHRcdFx0cG9pbnRzWzFdLngsIHBvaW50c1sxXS55LFxyXG5cdFx0XHRcdFx0XHRwb2ludHNbMl0ueCwgcG9pbnRzWzJdLnlcclxuXHRcdFx0XHRcdF0sIGkqNilcclxuXHJcblx0XHRcdFx0XHR1dnMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHRwb2ludHNbMF0ueC9zaXplLCBwb2ludHNbMF0ueS9zaXplLFxyXG5cdFx0XHRcdFx0XHRwb2ludHNbMV0ueC9zaXplLCBwb2ludHNbMV0ueS9zaXplLFxyXG5cdFx0XHRcdFx0XHRwb2ludHNbMl0ueC9zaXplLCBwb2ludHNbMl0ueS9zaXplXHJcblx0XHRcdFx0XHRdLCBpICogNik7XHJcblxyXG5cdFx0XHRcdFx0aW5kaWNlcy5zZXQoWzAgKyAzKmksIDEgKyAzKmksIDIgKyAzKmldLCBpICogMyk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gV2lyZWZyYW1lXHJcblx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHQvKlxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMSwgMHgwMDAwZmYsIDEpO1xyXG5cdFx0XHRcdFx0XHR2YXIgcG9pbnRzID0gdHJpYW5nbGVzW2ldLmdldFBvaW50cygpO1xyXG5cclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHBvaW50c1swXS54LCBwb2ludHNbMF0ueSk7XHJcblx0XHRcdFx0XHRcdGZvcih2YXIgcCA9IDE7IHAgPCBwb2ludHMubGVuZ3RoOyBwKyspXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzW3BdLngsIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzWzBdLngsIHBvaW50c1swXS55KTtcclxuXHRcdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHZhciBtZXNoID0gbmV3IFBJWEkubWVzaC5NZXNoXHJcblx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0dGV4dHVyZSxcclxuXHRcdFx0XHRcdHZlcnRpY2VzLFxyXG5cdFx0XHRcdFx0dXZzLFxyXG5cdFx0XHRcdFx0aW5kaWNlcyxcclxuXHRcdFx0XHRcdFBJWEkubWVzaC5NZXNoLkRSQVdfTU9ERVMuVFJJQU5HTEVTXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0XHR0aGlzLnRleHR1cmVzLmFkZENoaWxkKG1lc2gpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vIERyYXcgdGhlIGluY2xpbmVkIHRlcnJhaW5cclxuXHRcdGlmKHRoaXMuY29uZmlnLnRleFdhbGwgIT0gXCJcIiAmJiAhdGhpcy5pc0hpZGRlbigpKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgc2VnbWVudHMgICAgICAgPSB0aGlzLmJlemllci5nZXRHcm91bmRTZWdtZW50cyh0aGlzLmNvbmZpZy50ZXhXYWxsQW5nbGUsIDM2MCk7XHJcblx0XHRcdHZhciB0ZXh0dXJlU2l6ZSAgICA9IHRoaXMuY29uZmlnLnRleFdhbGxTaXplO1xyXG5cdFx0XHR2YXIgdGV4dHVyZVRvcFBlcmMgPSB0aGlzLmNvbmZpZy50ZXhXYWxsRGVsdGFcclxuXHJcblx0XHRcdHZhciBzZWdtZW50c1NpemUgPSAwO1xyXG5cdFx0XHRmb3IodmFyIHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRzZWdtZW50c1NpemUgKz0gc2VnbWVudHNbc10ucG9pbnRzLmxlbmd0aC0xO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgdGV4dHVyZSAgICA9IHRoaXMuYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4V2FsbCk7XHJcblx0XHRcdHZhciB2ZXJ0aWNlcyAgID0gbmV3IEZsb2F0MzJBcnJheSg4ICogc2VnbWVudHNTaXplKTtcclxuXHRcdFx0dmFyIHV2cyAgICAgICAgPSBuZXcgRmxvYXQzMkFycmF5KDggKiBzZWdtZW50c1NpemUpO1xyXG5cdFx0XHR2YXIgaW5kaWNlcyAgICA9IG5ldyBVaW50MTZBcnJheSg2ICogc2VnbWVudHNTaXplKTtcclxuXHRcdFx0dmFyIGFycmF5SW5kZXggPSAwO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBzID0gMDsgcyA8IHNlZ21lbnRzLmxlbmd0aDsgcysrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRvdGFsTGVuZ3RoICA9IDA7XHJcblx0XHRcdFx0dmFyIHNlZ21lbnRMZW5ndGggPSAwO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGggLTE7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2ZXJ0aWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2ldLnggICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueCAgICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLCAgICAgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueSAgICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLFxyXG5cdFx0XHRcdFx0XHRcdHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnggLSBzZWdtZW50c1tzXS5ub3JtYWxzW2krMV0ueCAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSwgICAgIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnkgLSBzZWdtZW50c1tzXS5ub3JtYWxzW2krMV0ueSAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSxcclxuXHRcdFx0XHRcdFx0XHRzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLCBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55ICsgc2VnbWVudHNbc10ubm9ybWFsc1tpKzFdLnkgKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLFxyXG5cdFx0XHRcdFx0XHRcdHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnggICAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSksIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnkgICAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSlcclxuXHRcdFx0XHRcdF0sIGFycmF5SW5kZXgqOClcclxuXHJcblx0XHRcdFx0XHR2YXIgdiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLngsIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55IC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSk7XHJcblx0XHRcdFx0XHRzZWdtZW50TGVuZ3RoID0gdi5nZXRMZW5ndGgoKTtcclxuXHJcblx0XHRcdFx0XHR1dnMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHR0b3RhbExlbmd0aC90ZXh0dXJlU2l6ZSwgMCxcclxuXHRcdFx0XHRcdFx0KHRvdGFsTGVuZ3RoK3NlZ21lbnRMZW5ndGgpL3RleHR1cmVTaXplLCAwLFxyXG5cdFx0XHRcdFx0XHQodG90YWxMZW5ndGgrc2VnbWVudExlbmd0aCkvdGV4dHVyZVNpemUsIDEsXHJcblx0XHRcdFx0XHRcdHRvdGFsTGVuZ3RoL3RleHR1cmVTaXplLCAxXHJcblx0XHRcdFx0XHRdLCBhcnJheUluZGV4ICogOCk7XHJcblxyXG5cdFx0XHRcdFx0aW5kaWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdDAgKyA0KmFycmF5SW5kZXgsXHJcblx0XHRcdFx0XHRcdDEgKyA0KmFycmF5SW5kZXgsXHJcblx0XHRcdFx0XHRcdDIgKyA0KmFycmF5SW5kZXgsXHJcblx0XHRcdFx0XHRcdDAgKyA0KmFycmF5SW5kZXgsXHJcblx0XHRcdFx0XHRcdDIgKyA0KmFycmF5SW5kZXgsXHJcblx0XHRcdFx0XHRcdDMgKyA0KmFycmF5SW5kZXhcclxuXHRcdFx0XHRcdF0sIGFycmF5SW5kZXggKiA2KTtcclxuXHJcblx0XHRcdFx0XHR0b3RhbExlbmd0aCArPSBzZWdtZW50TGVuZ3RoO1xyXG5cclxuXHRcdFx0XHRcdC8vIFdpcmVmcmFtZVxyXG5cdFx0XHRcdFx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDEsIDB4MDBmZjAwLCAwLjUpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzAqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMSoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzEqMisxXSk7IC8vIDFcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjJdLCB2ZXJ0aWNlc1thcnJheUluZGV4KjgrMioyKzFdKTsgLy8gMlxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzMqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCszKjIrMV0pOyAvLyAzXHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMCoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjJdLCB2ZXJ0aWNlc1thcnJheUluZGV4KjgrMioyKzFdKTsgLy8gMlxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGFycmF5SW5kZXgrKztcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgbWVzaCA9IG5ldyBQSVhJLm1lc2guTWVzaFxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGV4dHVyZSxcclxuXHRcdFx0XHR2ZXJ0aWNlcyxcclxuXHRcdFx0XHR1dnMsXHJcblx0XHRcdFx0aW5kaWNlcyxcclxuXHRcdFx0XHRQSVhJLm1lc2guTWVzaC5EUkFXX01PREVTLlRSSUFOR0xFU1xyXG5cdFx0XHQpO1xyXG5cdFx0XHR0aGlzLnRleHR1cmVzLmFkZENoaWxkKG1lc2gpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERyYXcgdGhlIHRlcnJhaW5cclxuXHRcdHZhciBzZWdtZW50cyAgICAgICA9IHRoaXMuYmV6aWVyLmdldEdyb3VuZFNlZ21lbnRzKDAsIHRoaXMuY29uZmlnLnRleFdhbGxBbmdsZSwgdGhpcy5jb25maWcudGV4R3JvdW5kRWRnZSA9PSBcIlwiKTtcclxuXHRcdHZhciB0ZXh0dXJlU2l6ZU9yICA9IHRoaXMuY29uZmlnLnRleEdyb3VuZFNpemU7XHJcblx0XHR2YXIgdGV4dHVyZVRvcFBlcmMgPSB0aGlzLmNvbmZpZy50ZXhHcm91bmREZWx0YVxyXG5cclxuXHRcdGlmKHRoaXMuY29uZmlnLnRleEdyb3VuZCAhPSBcIlwiICYmICF0aGlzLmlzSGlkZGVuKCkpXHJcblx0XHR7XHJcblx0XHRcdHZhciBzZWdtZW50c1NpemUgPSAwO1xyXG5cdFx0XHRmb3IodmFyIHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRzZWdtZW50c1NpemUgKz0gc2VnbWVudHNbc10ucG9pbnRzLmxlbmd0aC0xO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgdGV4dHVyZSAgICA9IHRoaXMuYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4R3JvdW5kKTtcclxuXHRcdFx0dmFyIHZlcnRpY2VzICAgPSBuZXcgRmxvYXQzMkFycmF5KDggKiBzZWdtZW50c1NpemUpO1xyXG5cdFx0XHR2YXIgdXZzICAgICAgICA9IG5ldyBGbG9hdDMyQXJyYXkoOCAqIHNlZ21lbnRzU2l6ZSk7XHJcblx0XHRcdHZhciBpbmRpY2VzICAgID0gbmV3IFVpbnQxNkFycmF5KDYgKiBzZWdtZW50c1NpemUpO1xyXG5cdFx0XHR2YXIgYXJyYXlJbmRleCA9IDA7XHJcblxyXG5cdFx0XHRmb3IodmFyIHMgPSAwOyBzIDwgc2VnbWVudHMubGVuZ3RoOyBzKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBNYWtlIHRoZSBub3JtYWxzIHBlcnBlbmRpY3VsYXIgaWYgdGhlIGxlZnQvcmlnaHQtbW9zdCBzZWdtZW50cyBkb24ndCBoYXZlIGEgY2FwXHJcblx0XHRcdFx0aWYocyA9PSAwICYmICh0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcInJpZ2h0XCIgfHwgdGhpcy5jb25maWcudGV4R3JvdW5kRWRnZVNpZGUgPT0gXCJub25lXCIpKVxyXG5cdFx0XHRcdFx0c2VnbWVudHNbc10ubm9ybWFsc1swXSA9IHt4OjAsIHk6MX07XHJcblx0XHRcdFx0aWYocyA9PSBzZWdtZW50cy5sZW5ndGgtMSAmJiAodGhpcy5jb25maWcudGV4R3JvdW5kRWRnZVNpZGUgPT0gXCJsZWZ0XCIgfHwgdGhpcy5jb25maWcudGV4R3JvdW5kRWRnZVNpZGUgPT0gXCJub25lXCIpKVxyXG5cdFx0XHRcdFx0c2VnbWVudHNbc10ubm9ybWFsc1tzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aC0xXSA9IHt4OjAsIHk6MX07XHJcblxyXG5cdFx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgdG90YWwgbGVuZ3RoIG9mIHRoZSBzZWdtZW50XHJcblx0XHRcdFx0dmFyIHNlZ21lbnRMZW5ndGggID0gMDtcclxuXHJcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNlZ21lbnRzW3NdLm5vcm1hbHMubGVuZ3RoIC0xOyBpKyspXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIHYgPSBuZXcgUElYSS5Qb2ludChzZWdtZW50c1tzXS5wb2ludHNbaV0ueCAgLSBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS54LCBzZWdtZW50c1tzXS5wb2ludHNbaV0ueSAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLnkpO1xyXG5cdFx0XHRcdFx0c2VnbWVudExlbmd0aCArPSB2LmdldExlbmd0aCgpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gQ291bnQgaG93IG1hbnkgdGltZXMgdGhlIHRleHR1cmUgY2FuIGZpdCBpbiB0aGUgc2VnbWVudCBsZW5ndGgsIHRoZW4gcm91bmQgaXQgdG8gYWRqdXN0IHRoZSB0ZXh0dXJlIHNpemVcclxuXHRcdFx0XHR2YXIgdGV4dHVyZVNpemUgPSBzZWdtZW50TGVuZ3RoLyBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKHNlZ21lbnRMZW5ndGggLyB0ZXh0dXJlU2l6ZU9yKSk7XHJcblxyXG5cdFx0XHRcdC8vIERyYXcgdGhlIHNlZ21lbnRcclxuXHRcdFx0XHR2YXIgdG90YWxMZW5ndGggICA9IDA7XHJcblx0XHRcdFx0dmFyIHNlZ21lbnRMZW5ndGggPSAwO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGggLTE7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2ZXJ0aWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2ldLnggICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueCAgICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLCAgICAgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgICAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaV0ueSAgICogKHRleHR1cmVTaXplT3IgKiB0ZXh0dXJlVG9wUGVyYyksXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2krMV0ueCAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaSsxXS54ICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLCAgICAgc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSAtIHNlZ21lbnRzW3NdLm5vcm1hbHNbaSsxXS55ICogKHRleHR1cmVTaXplT3IgKiB0ZXh0dXJlVG9wUGVyYyksXHJcblx0XHRcdFx0XHRcdFx0c2VnbWVudHNbc10ucG9pbnRzW2krMV0ueCArIHNlZ21lbnRzW3NdLm5vcm1hbHNbaSsxXS54ICogKHRleHR1cmVTaXplICogKDEtdGV4dHVyZVRvcFBlcmMpKSwgc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSArIHNlZ21lbnRzW3NdLm5vcm1hbHNbaSsxXS55ICogKHRleHR1cmVTaXplT3IgKiAoMS10ZXh0dXJlVG9wUGVyYykpLFxyXG5cdFx0XHRcdFx0XHRcdHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnggICAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSksIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55ICAgKyBzZWdtZW50c1tzXS5ub3JtYWxzW2ldLnkgICAqICh0ZXh0dXJlU2l6ZU9yICogKDEtdGV4dHVyZVRvcFBlcmMpKVxyXG5cdFx0XHRcdFx0XSwgYXJyYXlJbmRleCo4KVxyXG5cclxuXHRcdFx0XHRcdHZhciB2ID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudHNbc10ucG9pbnRzW2ldLnggIC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueCwgc2VnbWVudHNbc10ucG9pbnRzW2ldLnkgLSBzZWdtZW50c1tzXS5wb2ludHNbaSsxXS55KTtcclxuXHRcdFx0XHRcdHNlZ21lbnRMZW5ndGggPSB2LmdldExlbmd0aCgpO1xyXG5cclxuXHRcdFx0XHRcdHV2cy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdHRvdGFsTGVuZ3RoL3RleHR1cmVTaXplLCAwLFxyXG5cdFx0XHRcdFx0XHQodG90YWxMZW5ndGgrc2VnbWVudExlbmd0aCkvdGV4dHVyZVNpemUsIDAsXHJcblx0XHRcdFx0XHRcdCh0b3RhbExlbmd0aCtzZWdtZW50TGVuZ3RoKS90ZXh0dXJlU2l6ZSwgMSxcclxuXHRcdFx0XHRcdFx0dG90YWxMZW5ndGgvdGV4dHVyZVNpemUsIDFcclxuXHRcdFx0XHRcdF0sIGFycmF5SW5kZXggKiA4KTtcclxuXHJcblx0XHRcdFx0XHRpbmRpY2VzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0MCArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MSArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MiArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MCArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MiArIDQqYXJyYXlJbmRleCxcclxuXHRcdFx0XHRcdFx0MyArIDQqYXJyYXlJbmRleFxyXG5cdFx0XHRcdFx0XSwgYXJyYXlJbmRleCAqIDYpO1xyXG5cclxuXHRcdFx0XHRcdHRvdGFsTGVuZ3RoICs9IHNlZ21lbnRMZW5ndGg7XHJcblxyXG5cdFx0XHRcdFx0Ly8gV2lyZWZyYW1lXHJcblx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMSwgMHgwMGZmMDAsIDAuNSk7XHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMCoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW2FycmF5SW5kZXgqOCsxKjJdLCB2ZXJ0aWNlc1thcnJheUluZGV4KjgrMSoyKzFdKTsgLy8gMVxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzIqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1thcnJheUluZGV4KjgrMyoyXSwgdmVydGljZXNbYXJyYXlJbmRleCo4KzMqMisxXSk7IC8vIDNcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW2FycmF5SW5kZXgqOCswKjJdLCB2ZXJ0aWNlc1thcnJheUluZGV4KjgrMCoyKzFdKTsgLy8gMFxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbYXJyYXlJbmRleCo4KzIqMl0sIHZlcnRpY2VzW2FycmF5SW5kZXgqOCsyKjIrMV0pOyAvLyAyXHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0YXJyYXlJbmRleCsrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIG1lc2ggPSBuZXcgUElYSS5tZXNoLk1lc2hcclxuXHRcdFx0KFxyXG5cdFx0XHRcdHRleHR1cmUsXHJcblx0XHRcdFx0dmVydGljZXMsXHJcblx0XHRcdFx0dXZzLFxyXG5cdFx0XHRcdGluZGljZXMsXHJcblx0XHRcdFx0UElYSS5tZXNoLk1lc2guRFJBV19NT0RFUy5UUklBTkdMRVNcclxuXHRcdFx0KTtcclxuXHJcblx0XHRcdHRoaXMudGV4dHVyZXMuYWRkQ2hpbGQobWVzaCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gRHJhdyB0aGUgdGVycmFpbiBlZGdlc1xyXG5cdFx0aWYodGhpcy5jb25maWcudGV4R3JvdW5kRWRnZSAhPSBcIlwiICYmICF0aGlzLmlzSGlkZGVuKCkpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0ZXh0dXJlICAgID0gdGhpcy5hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlKTtcclxuXHRcdFx0dmFyIHZlcnRpY2VzICAgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiA4ICogc2VnbWVudHMubGVuZ3RoKTtcclxuXHRcdFx0dmFyIHV2cyAgICAgICAgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiA4ICogc2VnbWVudHMubGVuZ3RoKTtcclxuXHRcdFx0dmFyIGluZGljZXMgICAgPSBuZXcgVWludDE2QXJyYXkoMiAqIDYgKiBzZWdtZW50cy5sZW5ndGgpO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBzID0gMDsgcyA8IHNlZ21lbnRzLmxlbmd0aDsgcysrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gQ2FsY3VsYXRlIHRoZSB0b3RhbCBsZW5ndGggb2YgdGhlIHNlZ21lbnRcclxuXHRcdFx0XHR2YXIgc2VnbWVudExlbmd0aCAgPSAwO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2VnbWVudHNbc10ubm9ybWFscy5sZW5ndGggLTE7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgdiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnRzW3NdLnBvaW50c1tpXS54ICAtIHNlZ21lbnRzW3NdLnBvaW50c1tpKzFdLngsIHNlZ21lbnRzW3NdLnBvaW50c1tpXS55IC0gc2VnbWVudHNbc10ucG9pbnRzW2krMV0ueSk7XHJcblx0XHRcdFx0XHRzZWdtZW50TGVuZ3RoICs9IHYuZ2V0TGVuZ3RoKCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBDb3VudCBob3cgbWFueSB0aW1lcyB0aGUgdGV4dHVyZSBjYW4gZml0IGluIHRoZSBzZWdtZW50IGxlbmd0aCwgdGhlbiByb3VuZCBpdCB0byBhZGp1c3QgdGhlIHRleHR1cmUgc2l6ZVxyXG5cdFx0XHRcdHZhciB0ZXh0dXJlU2l6ZSA9IHNlZ21lbnRMZW5ndGgvIE1hdGgubWF4KDEsIE1hdGgucm91bmQoc2VnbWVudExlbmd0aCAvIHRleHR1cmVTaXplT3IpKTtcclxuXHJcblx0XHRcdFx0Ly8gTGVmdCBlZGdlXHJcblx0XHRcdFx0aWYocyA+IDAgfHwgKHRoaXMuY29uZmlnLnRleEdyb3VuZEVkZ2VTaWRlID09IFwibGVmdFwiIHx8IHRoaXMuY29uZmlnLnRleEdyb3VuZEVkZ2VTaWRlID09IFwiXCIpKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHZhciBwID0gc2VnbWVudHNbc10ucG9pbnRzWzBdO1xyXG5cdFx0XHRcdFx0dmFyIG4gPSBzZWdtZW50c1tzXS5ub3JtYWxzWzBdO1xyXG5cdFx0XHRcdFx0dmFyIHYgPSBuZXcgUElYSS5Qb2ludChzZWdtZW50c1tzXS5wb2ludHNbMF0ueCAtIHNlZ21lbnRzW3NdLnBvaW50c1sxXS54LCBzZWdtZW50c1tzXS5wb2ludHNbMF0ueSAtIHNlZ21lbnRzW3NdLnBvaW50c1sxXS55KTtcclxuXHRcdFx0XHRcdHYubm9ybWFsaXplKCk7XHJcblxyXG5cdFx0XHRcdFx0dmVydGljZXMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHRwLnggLSBuLnggKiAodGV4dHVyZVNpemUgKiB0ZXh0dXJlVG9wUGVyYykgKyh2LnggKiB0ZXh0dXJlU2l6ZSksICAgICBwLnkgLSBuLnkgKiAodGV4dHVyZVNpemVPciAqIHRleHR1cmVUb3BQZXJjICAgICAtKHYueSAqIHRleHR1cmVTaXplT3IpKSxcclxuXHRcdFx0XHRcdFx0cC54IC0gbi54ICogKHRleHR1cmVTaXplICogdGV4dHVyZVRvcFBlcmMpLCAgICAgICAgICAgICAgICAgICAgICAgICAgcC55IC0gbi55ICogKHRleHR1cmVTaXplT3IgKiB0ZXh0dXJlVG9wUGVyYyksXHJcblx0XHRcdFx0XHRcdHAueCArIG4ueCAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSksICAgICAgICAgICAgICAgICAgICAgIHAueSArIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogKDEtdGV4dHVyZVRvcFBlcmMpKSxcclxuXHRcdFx0XHRcdFx0cC54ICsgbi54ICogKHRleHR1cmVTaXplICogKDEtdGV4dHVyZVRvcFBlcmMpKSArKHYueCAqIHRleHR1cmVTaXplKSwgcC55ICsgbi55ICogKHRleHR1cmVTaXplT3IgKiAoMS10ZXh0dXJlVG9wUGVyYykgKyh2LnkgKiB0ZXh0dXJlU2l6ZU9yKSlcclxuXHRcdFx0XHRcdF0sIHMqOCoyKTtcclxuXHJcblx0XHRcdFx0XHR1dnMuc2V0KFxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHQwLCAwLFxyXG5cdFx0XHRcdFx0XHQxLCAwLFxyXG5cdFx0XHRcdFx0XHQxLCAxLFxyXG5cdFx0XHRcdFx0XHQwLCAxXHJcblx0XHRcdFx0XHRdLCBzKjgqMik7XHJcblxyXG5cdFx0XHRcdFx0aW5kaWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdDAgKyAocyoyKSAqNCxcclxuXHRcdFx0XHRcdFx0MSArIChzKjIpICo0LFxyXG5cdFx0XHRcdFx0XHQyICsgKHMqMikgKjQsXHJcblx0XHRcdFx0XHRcdDAgKyAocyoyKSAqNCxcclxuXHRcdFx0XHRcdFx0MiArIChzKjIpICo0LFxyXG5cdFx0XHRcdFx0XHQzICsgKHMqMikgKjRcclxuXHRcdFx0XHRcdF0sIHMqNioyKTtcclxuXHJcblx0XHRcdFx0XHQvLyBXaXJlZnJhbWVcclxuXHRcdFx0XHRcdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgxLCAweDAwZmYwMCwgMC41KTtcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHZlcnRpY2VzW3MqMio4KzAqMl0sIHZlcnRpY2VzW3MqMio4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzEqMl0sIHZlcnRpY2VzW3MqMio4KzEqMisxXSk7IC8vIDFcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzIqMl0sIHZlcnRpY2VzW3MqMio4KzIqMisxXSk7IC8vIDJcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzMqMl0sIHZlcnRpY2VzW3MqMio4KzMqMisxXSk7IC8vIDNcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzAqMl0sIHZlcnRpY2VzW3MqMio4KzAqMisxXSk7IC8vIDBcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzW3MqMio4KzIqMl0sIHZlcnRpY2VzW3MqMio4KzIqMisxXSk7IC8vIDJcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIFJpZ2h0IGVkZ2VcclxuXHRcdFx0XHRpZihzIDwgc2VnbWVudHMubGVuZ3RoLTEgfHwgKHRoaXMuY29uZmlnLnRleEdyb3VuZEVkZ2VTaWRlID09IFwicmlnaHRcIiB8fCB0aGlzLmNvbmZpZy50ZXhHcm91bmRFZGdlU2lkZSA9PSBcIlwiKSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgbCA9IHNlZ21lbnRzW3NdLm5vcm1hbHMubGVuZ3RoLTE7XHJcblx0XHRcdFx0XHR2YXIgcCA9IHNlZ21lbnRzW3NdLnBvaW50c1tzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aC0xXTtcclxuXHRcdFx0XHRcdHZhciBuID0gc2VnbWVudHNbc10ubm9ybWFsc1tzZWdtZW50c1tzXS5ub3JtYWxzLmxlbmd0aC0xXTtcclxuXHRcdFx0XHRcdHZhciB2ID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudHNbc10ucG9pbnRzW2xdLnggLSBzZWdtZW50c1tzXS5wb2ludHNbbC0xXS54LCBzZWdtZW50c1tzXS5wb2ludHNbbF0ueSAtIHNlZ21lbnRzW3NdLnBvaW50c1tsLTFdLnkpO1xyXG5cdFx0XHRcdFx0di5ub3JtYWxpemUoKTtcclxuXHJcblx0XHRcdFx0XHR2ZXJ0aWNlcy5zZXQoXHJcblx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdHAueCAtIG4ueCAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSArKHYueCAqIHRleHR1cmVTaXplKSwgICAgIHAueSAtIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogdGV4dHVyZVRvcFBlcmMgLSh2LnkgKiB0ZXh0dXJlU2l6ZU9yKSksXHJcblx0XHRcdFx0XHRcdHAueCAtIG4ueCAqICh0ZXh0dXJlU2l6ZSAqIHRleHR1cmVUb3BQZXJjKSwgICAgICAgICAgICAgICAgICAgICAgICAgIHAueSAtIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogdGV4dHVyZVRvcFBlcmMpLFxyXG5cdFx0XHRcdFx0XHRwLnggKyBuLnggKiAodGV4dHVyZVNpemUgKiAoMS10ZXh0dXJlVG9wUGVyYykpLCAgICAgICAgICAgICAgICAgICAgICBwLnkgKyBuLnkgKiAodGV4dHVyZVNpemVPciAqICgxLXRleHR1cmVUb3BQZXJjKSksXHJcblx0XHRcdFx0XHRcdHAueCArIG4ueCAqICh0ZXh0dXJlU2l6ZSAqICgxLXRleHR1cmVUb3BQZXJjKSkgKyh2LnggKiB0ZXh0dXJlU2l6ZSksIHAueSArIG4ueSAqICh0ZXh0dXJlU2l6ZU9yICogKDEtdGV4dHVyZVRvcFBlcmMpKyh2LnkgKiB0ZXh0dXJlU2l6ZU9yKSlcclxuXHRcdFx0XHRcdF0sIChzKjIrMSkqOCk7XHJcblxyXG5cdFx0XHRcdFx0dXZzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0MCwgMCxcclxuXHRcdFx0XHRcdFx0MSwgMCxcclxuXHRcdFx0XHRcdFx0MSwgMSxcclxuXHRcdFx0XHRcdFx0MCwgMVxyXG5cdFx0XHRcdFx0XSwgKHMqMisxKSo4KTtcclxuXHJcblx0XHRcdFx0XHRpbmRpY2VzLnNldChcclxuXHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0MCArIChzKjIrMSkgKjQsXHJcblx0XHRcdFx0XHRcdDEgKyAocyoyKzEpICo0LFxyXG5cdFx0XHRcdFx0XHQyICsgKHMqMisxKSAqNCxcclxuXHRcdFx0XHRcdFx0MCArIChzKjIrMSkgKjQsXHJcblx0XHRcdFx0XHRcdDIgKyAocyoyKzEpICo0LFxyXG5cdFx0XHRcdFx0XHQzICsgKHMqMisxKSAqNFxyXG5cdFx0XHRcdFx0XSwgKHMqMisxKSo2KTtcclxuXHJcblx0XHRcdFx0XHQvLyBXaXJlZnJhbWVcclxuXHRcdFx0XHRcdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgxLCAweDAwZmYwMCwgMC41KTtcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHZlcnRpY2VzWyhzKjIrMSkqOCswKjJdLCB2ZXJ0aWNlc1socyoyKzEpKjgrMCoyKzFdKTsgLy8gMFxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzEqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCsxKjIrMV0pOyAvLyAxXHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1socyoyKzEpKjgrMioyXSwgdmVydGljZXNbKHMqMisxKSo4KzIqMisxXSk7IC8vIDJcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHZlcnRpY2VzWyhzKjIrMSkqOCszKjJdLCB2ZXJ0aWNlc1socyoyKzEpKjgrMyoyKzFdKTsgLy8gM1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8odmVydGljZXNbKHMqMisxKSo4KzAqMl0sIHZlcnRpY2VzWyhzKjIrMSkqOCswKjIrMV0pOyAvLyAwXHJcblx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyh2ZXJ0aWNlc1socyoyKzEpKjgrMioyXSwgdmVydGljZXNbKHMqMisxKSo4KzIqMisxXSk7IC8vIDJcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBtZXNoID0gbmV3IFBJWEkubWVzaC5NZXNoXHJcblx0XHRcdChcclxuXHRcdFx0XHR0ZXh0dXJlLFxyXG5cdFx0XHRcdHZlcnRpY2VzLFxyXG5cdFx0XHRcdHV2cyxcclxuXHRcdFx0XHRpbmRpY2VzLFxyXG5cdFx0XHRcdFBJWEkubWVzaC5NZXNoLkRSQVdfTU9ERVMuVFJJQU5HTEVTXHJcblx0XHRcdCk7XHJcblx0XHRcdHRoaXMudGV4dHVyZXMuYWRkQ2hpbGQobWVzaCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR0aGlzLmFkZENoaWxkKHRoaXMudGV4dHVyZXMpO1xyXG5cclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdHtcclxuXHRcdC8vIERyYXcgYmV6aWVyXHJcblx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8odGhpcy5iZXppZXIucG9pbnRzWzBdLngsIHRoaXMuYmV6aWVyLnBvaW50c1swXS55KTtcclxuXHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgyLCAweGZmMDAwMCk7XHJcblx0XHRmb3IodmFyIGkgPSAxOyBpIDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aDsgaSArPTMpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMud2lyZWZyYW1lLmJlemllckN1cnZlVG8odGhpcy5iZXppZXIucG9pbnRzW2ldLngsIHRoaXMuYmV6aWVyLnBvaW50c1tpXS55LCB0aGlzLmJlemllci5wb2ludHNbaSsxXS54LCB0aGlzLmJlemllci5wb2ludHNbaSsxXS55LCB0aGlzLmJlemllci5wb2ludHNbaSsyXS54LCB0aGlzLmJlemllci5wb2ludHNbaSsyXS55KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBEcmF3IG1haW4gcG9pbnRzXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5iZXppZXIucG9pbnRzLmxlbmd0aDsgaSArKylcclxuXHRcdHtcclxuXHRcdFx0aWYoaSUzICE9IDApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0aWYoaSA9PSB0aGlzLnBvaW50SW5kZXgpXHJcblx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDIsIDB4MDBmZjAwICwgMSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoMCwgMHhmZjAwMDAsIDApO1xyXG5cclxuXHRcdFx0dGhpcy53aXJlZnJhbWUuYmVnaW5GaWxsKDB4ZmYwMDAwKTtcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUuZHJhd0NpcmNsZSh0aGlzLmJlemllci5wb2ludHNbaV0ueCwgIHRoaXMuYmV6aWVyLnBvaW50c1tpXS55LCA1KTtcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUuZW5kRmlsbCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy53aXJlZnJhbWUpO1xyXG5cdH1cclxuXHJcblx0Ly8gQXJ0aWZpY2lhbDogY3JlYXRlZCBieSB0aGUgYXZhdGFyXHJcblx0aWYoISF0aGlzLmNvbmZpZy5hcnRpZmljaWFsKVxyXG5cdHtcclxuXHRcdHZhciBib3VuZHMgPSB0aGlzLnRleHR1cmVzLmdldEJvdW5kcygpO1xyXG5cclxuXHRcdHRoaXMudGV4dHVyZXMubWFzayA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcblx0XHR0aGlzLnRleHR1cmVzLm1hc2suYmVnaW5GaWxsKCk7XHJcblx0XHR0aGlzLnRleHR1cmVzLm1hc2suZHJhd1JlY3QoMCwgMCwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KTtcclxuXHRcdHRoaXMudGV4dHVyZXMubWFzay5lbmRGaWxsKCk7XHJcblx0XHR0aGlzLnRleHR1cmVzLm1hc2sueCA9IGJvdW5kcy54IC0gYm91bmRzLndpZHRoO1xyXG5cdFx0dGhpcy50ZXh0dXJlcy5tYXNrLnkgPSBib3VuZHMueTtcclxuXHRcdHRoaXMudGV4dHVyZXMubWFzay5ib3VuZHMgPSBib3VuZHM7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMudGV4dHVyZXMubWFzayk7XHJcblxyXG5cdFx0dGhpcy5tYXNrVHdlZW4gPSBuZXcgVGltZWxpbmVNYXgoXHJcblx0XHR7XHJcblx0XHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuY29uZmlnLmNvbGxpc2lvbnMgPSAwXHJcblx0XHRcdH0sXHJcblx0XHRcdG9uQ29tcGxldGVTY29wZTogdGhpc1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLm1hc2tUd2Vlbi50byh0aGlzLnRleHR1cmVzLm1hc2ssIDAuNSwge3g6IGJvdW5kcy54LCBlYXNlOlNpbmUuZWFzZU91dCwgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuaWNlQnJpZGdlUFMuZW1pdCA9IGZhbHNlO30sIG9uQ29tcGxldGVTY29wZTp0aGlzfSwgIDApO1xyXG5cdFx0dGhpcy5tYXNrVHdlZW4udG8odGhpcy50ZXh0dXJlcywgMC41LCB7YWxwaGE6IDAsIGVhc2U6U2luZS5lYXNlSW59LCAgMC45KTtcclxuXHRcdC8vIHRoaXMubWFza1R3ZWVuLnRvKHRoaXMubWFzaywgMC41LCB7eDogYm91bmRzLnggKyBib3VuZHMud2lkdGgsIGVhc2U6U2luZS5lYXNlSW59LCAgMC43NSk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMubWFza1R3ZWVuKTtcclxuXHJcblx0XHQvLyBQYXJ0aWNsZXNcclxuXHRcdHRoaXMuaWNlQnJpZGdlUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLmxldmVsLFxyXG5cdFx0W1xyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDFcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAyXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxyXG5cdFx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9pY2VfYnJpZGdlXCIpKTtcclxuXHJcblx0XHR0aGlzLmljZUJyaWRnZVBTLmVtaXQgPSB0cnVlO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIERpc3Bvc2VcclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCEhdGhpcy5pY2VCcmlkZ2VQUylcclxuXHR7XHJcblx0XHR0aGlzLmljZUJyaWRnZVBTLmRlc3Ryb3koKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgcGF0aCBpcyBpbnZpc2libGVcclxuICogQHJldHVybiB7Qm9vbGVhbn1cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUuaXNIaWRkZW4gPSBmdW5jdGlvbigpXHJcbntcclxuXHRyZXR1cm4gKHRoaXMuY29uZmlnLmRhdGEgIT0gXCJcIiAmJiAhIXRoaXMuY29uZmlnLmRhdGEuaGlkZGVuKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybiB0cnVlIGlmIGl0J3MgYSBwYXRoIHRoYXQgc2hvdWxkIGJlIGlnbm9yZWQgd2hlbiB0aGUgYXZhdGFyIGlzIHVzaW5nIHRoZSBzaHJpbmsgcG93ZXJcclxuICogQHJldHVybiB7Qm9vbGVhbn1cclxuICovXHJcbkxldmVsUGF0aC5wcm90b3R5cGUuaXNTaHJpbmtQYXRoID0gZnVuY3Rpb24oKVxyXG57XHJcblx0cmV0dXJuICh0aGlzLmNvbmZpZy5kYXRhICE9IFwiXCIgJiYgISF0aGlzLmNvbmZpZy5kYXRhLnNocmlua1BhdGgpO1xyXG59XHJcblxyXG4vKipcclxuICogUmV0dXJuIHRydWUgaWYgaXQncyBhIHBhdGggdGhhdCBoYXMgYmVlbiBjcmVhdGVkIGJ5IHRoZSBwbGF5ZXIgYW5kIHNob3VsZCBiZSBpZ25vcmVkIGJ5IG90aGVyIGVudGl0aWVzXHJcbiAqIEByZXR1cm4ge0Jvb2xlYW59XHJcbiAqL1xyXG5MZXZlbFBhdGgucHJvdG90eXBlLmlzQXJ0aWZpY2lhbFBhdGggPSBmdW5jdGlvbigpXHJcbntcclxuXHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcnRpZmljaWFsO1xyXG59IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxuLy8gdmFyIEVtaXR0ZXIgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gTGV2ZWxSZWNvcmQocmVjb3JkKVxyXG57XHJcblx0dGhpcy5fYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcblxyXG5cdHRoaXMubGV2ZWwgID0gbnVsbDtcclxuXHR0aGlzLnJlY29yZCA9IHJlY29yZDtcclxuXHJcblx0dGhpcy5jb25maWcgPVxyXG5cdHtcclxuXHRcdGRlcHRoIDogMTAwXHJcblx0fVxyXG5cclxuXHR0aGlzLmxheWVycyA9XHJcblx0W1xyXG5cdFx0e3RleHR1cmU6IFwiaW5nYW1lX3BlcnNvbmFsX2Jlc3RfMDFcIiwgc3BlZWQgOiAtMTYwfSxcclxuXHRcdHt0ZXh0dXJlOiBcImluZ2FtZV9wZXJzb25hbF9iZXN0XzAxXCIsIHNwZWVkIDogLTEyMH0sXHJcblx0XHR7dGV4dHVyZTogXCJpbmdhbWVfcGVyc29uYWxfYmVzdF8wMFwiLCBzcGVlZCA6IC04MH1cclxuXHRdO1xyXG5cdFxyXG5cdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gTGV2ZWxSZWNvcmQ7XHJcbkxldmVsUmVjb3JkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5MZXZlbFJlY29yZC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMZXZlbFJlY29yZDtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuTGV2ZWxSZWNvcmQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsZXZlbClcclxue1xyXG5cdHRoaXMubGV2ZWwgPSBsZXZlbDtcclxuXHJcblx0dGhpcy54ID0gdGhpcy5yZWNvcmQgKiBDb21tb24uc2F2ZWREYXRhLnVuaXQ7XHJcblxyXG5cdC8vIFNwYXJrc1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgdGV4dHVyZSAgID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5sYXllcnNbaV0udGV4dHVyZSk7XHJcblx0XHR2YXIgc3ByaXRlICAgID0gbmV3IFBJWEkuZXh0cmFzLlRpbGluZ1Nwcml0ZSh0ZXh0dXJlLCB0ZXh0dXJlLndpZHRoLCB0ZXh0dXJlLmhlaWdodCk7XHJcblx0XHRzcHJpdGUud2lkdGggID0gdGV4dHVyZS53aWR0aDtcclxuXHRcdHNwcml0ZS5oZWlnaHQgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG5cdFx0c3ByaXRlLmFuY2hvci5zZXQoMC41LCAwKTtcclxuXHRcdHNwcml0ZS5zY2FsZS54ID0gaSAlIDIgPT0gMCA/IDEgOiAtMTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQoc3ByaXRlKTtcclxuXHRcdHRoaXMubGF5ZXJzW2ldLnNwcml0ZSA9IHNwcml0ZTtcclxuXHR9XHJcblxyXG5cdC8vIEljb25cclxuXHR2YXIgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9nYW1lcGxheV9kaXN0YW5jZV9yZWNvcmRcIikpO1xyXG5cdHNwcml0ZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0c3ByaXRlLnkgPSAxMDA7XHJcblx0dGhpcy5hZGRDaGlsZChzcHJpdGUpO1xyXG59O1xyXG5cclxuXHJcbkxldmVsUmVjb3JkLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5MZXZlbFJlY29yZC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy52aXNpYmxlID0gKHRoaXMueCA+IHRoaXMubGV2ZWwuYXZhdGFyLnggLSBDb21tb24uU1RBR0VfV0lEVEgpICYmICh0aGlzLnggPCB0aGlzLmxldmVsLmF2YXRhci54ICsgQ29tbW9uLlNUQUdFX1dJRFRIKTtcclxuXHRcclxuXHRpZighdGhpcy52aXNpYmxlKSByZXR1cm47XHJcblx0XHJcblx0dmFyIG9sZFkgPSB0aGlzLnk7XHJcblxyXG5cdHRoaXMueSA9IC10aGlzLmxldmVsLnkgKiAxL3RoaXMubGV2ZWwuem9vbTtcclxuXHR0aGlzLnNjYWxlLnNldCgxL3RoaXMubGV2ZWwuem9vbSk7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLmxheWVyc1tpXS5zcHJpdGUudGlsZVBvc2l0aW9uLnkgKz0gdGhpcy5sYXllcnNbaV0uc3BlZWQgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWUgLSAodGhpcy55IC0gb2xkWSk7XHJcblx0fVxyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbi8vIHZhciBFbWl0dGVyICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdEF4ZShhdmF0YXIpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJheGVcIiwgZmFsc2UpO1xyXG5cclxuXHR0aGlzLmF2YXRhciAgPSBhdmF0YXI7XHJcblx0dGhpcy5sZXZlbCAgID0gbnVsbDtcclxuXHR0aGlzLnNwcml0ZSAgPSBudWxsO1xyXG5cclxuXHR0aGlzLnZlbG9jaXR5ID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLmdyYXZpdHkgID0gMDtcclxuXHJcblx0dGhpcy5hY3RpdmUgICA9IGZhbHNlO1xyXG5cdHRoaXMudGltZWxpbmUgPSBudWxsO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0QXhlO1xyXG5PYmplY3RBeGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHYW1lT2JqZWN0LnByb3RvdHlwZSk7XHJcbk9iamVjdEF4ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RBeGU7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBJbml0XHJcbiAqL1xyXG5PYmplY3RBeGUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsKVxyXG57XHJcblx0dGhpcy5sZXZlbCA9IGw7XHJcblx0dGhpcy5ncmF2aXR5ID0gdGhpcy5sZXZlbC5hdmF0YXIuZ3Jhdml0eTtcclxuXHJcblx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJrcmlzdG9mZl9heGVfMDBcIikpO1xyXG5cdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQoLjUpO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cclxuXHJcblx0dGhpcy5jb2xsaXNpb25DaXJjbGUgPSBuZXcgUElYSS5DaXJjbGUoMCwgMCwgNjUpO1xyXG5cclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5PYmplY3RBeGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCF0aGlzLmFjdGl2ZSkgcmV0dXJuO1xyXG5cclxuXHQvLyBVcGRhdGUgdmVsb2NpdHkgYW5kIHBvc2l0aW9uXHJcblx0dGhpcy52ZWxvY2l0eS54IC09IDEwMCAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHR0aGlzLnZlbG9jaXR5LnkgKz0gdGhpcy5ncmF2aXR5ICogcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG5cdGlmKHRoaXMudmVsb2NpdHkueCA8IDApIHRoaXMudmVsb2NpdHkueCA9IDA7XHJcblxyXG5cdHRoaXMueCArPSB0aGlzLnZlbG9jaXR5LnggKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0dGhpcy55ICs9IHRoaXMudmVsb2NpdHkueSAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHJcblx0dGhpcy5yb3RhdGlvbiArPSAzNjAgKiBQSVhJLkRFR19UT19SQUQgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdC8vIENvbGxpc2lvbnMgd2l0aCBvYnN0YWNsZXNcclxuXHR2YXIgY29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuQ2lyY2xlKHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLngsICB0aGlzLnkgKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS55LCAgICB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMpO1xyXG5cdHZhciBvYnN0YWNsZXMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcIm9ic3RhY2xlXCIpO1xyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgb2JzdGFjbGVzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdGlmKCFvYnN0YWNsZXNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0aWYoIW9ic3RhY2xlc1tpXS5kZXN0cm95YWJsZSkgY29udGludWU7XHJcblxyXG5cdFx0aWYodGhpcy5hdmF0YXIuY2hlY2tDb2xsaXNpb24oY29sbGlzaW9uQ2lyY2xlLCBvYnN0YWNsZXNbaV0pKVxyXG5cdFx0e1xyXG5cdFx0XHRvYnN0YWNsZXNbaV0uZGVzdHJveSgpO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBUaHJvd1xyXG4gKi9cclxuT2JqZWN0QXhlLnByb3RvdHlwZS50aHJvdyA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuYWN0aXZlID0gdHJ1ZTtcclxuXHR0aGlzLnNwcml0ZS5hbHBoYSA9IDE7XHJcblx0dGhpcy52ZWxvY2l0eS5zZXQoMTgwMCwgLTQwMCk7XHJcblxyXG5cdGlmKCEhdGhpcy50aW1lbGluZSlcclxuXHRcdHRoaXMudGltZWxpbmUua2lsbCgpO1xyXG5cclxuXHR0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlID0gZmFsc2U7fX0pO1xyXG5cdFx0dGhpcy50aW1lbGluZS50byh0aGlzLnNwcml0ZSwgMiwge2FscGhhOiAwLCBlYXNlOlF1YXJ0LmVhc2VJbn0sICAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMudGltZWxpbmUpO1xyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbnZhciBFbWl0dGVyXHRcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0Q2FtZXJhWm9vbSgpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJjYW1lcmFfem9vbVwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICA9IG51bGw7XHJcblx0dGhpcy5jYW1lcmFab29tID1cclxuXHR7XHJcblx0XHR6b29tICA6IDEsXHJcblx0XHR0aW1lICA6IDAuNCxcclxuXHRcdGRlbGF5IDogMFxyXG5cdH1cclxuXHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RDYW1lcmFab29tO1xyXG5PYmplY3RDYW1lcmFab29tLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5PYmplY3RDYW1lcmFab29tLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE9iamVjdENhbWVyYVpvb207XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbk9iamVjdENhbWVyYVpvb20ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsKVxyXG57XHJcblx0aWYodGhpcy5zcHJpdGUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSgpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLnNwcml0ZSk7XHJcblx0fVxyXG59O1xyXG5cclxuT2JqZWN0Q2FtZXJhWm9vbS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmxldmVsICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgID0gbnVsbDtcclxufVxyXG5cclxuT2JqZWN0Q2FtZXJhWm9vbS5wcm90b3R5cGUuY29uZmlndXJlID0gZnVuY3Rpb24obGV2ZWwsIGNvbmZpZylcclxue1xyXG5cdHRoaXMubGV2ZWwgID0gbGV2ZWw7XHJcblx0dGhpcy5jb25maWcgPSBjb25maWc7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHR0aGlzLnNwcml0ZS50ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4dHVyZSk7XHJcblx0dGhpcy5zcHJpdGUuYW5jaG9yLnNldCh0aGlzLmNvbmZpZy5hbmNob3IueCwgdGhpcy5jb25maWcuYW5jaG9yLnkpO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlIC5zZXQodGhpcy5jb25maWcuc2NhbGUueCwgdGhpcy5jb25maWcuc2NhbGUueSk7XHJcblx0dGhpcy5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cclxuXHRpZih0aGlzLmNvbmZpZy5kYXRhICE9IFwiXCIpXHJcblx0e1xyXG5cdFx0dHJ5XHJcblx0XHR7XHJcblx0XHRcdHZhciBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdFx0dGhpcy5jYW1lcmFab29tLnpvb20gID0gISFkYXRhLnpvb20gPyBkYXRhLnpvb20gICA6IHRoaXMuY2FtZXJhWm9vbS56b29tO1xyXG5cdFx0XHR0aGlzLmNhbWVyYVpvb20udGltZSAgPSAhIWRhdGEudGltZSA/IGRhdGEudGltZSAgIDogdGhpcy5jYW1lcmFab29tLnRpbWU7XHJcblx0XHRcdHRoaXMuY2FtZXJhWm9vbS5kZWxheSA9ICEhZGF0YS5kZWxheSA/IGRhdGEuZGVsYXkgOiB0aGlzLmNhbWVyYVpvb20uZGVsYXk7XHJcblx0XHR9XHJcblx0XHRjYXRjaChlKVxyXG5cdFx0e1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKFwiQ2FtZXJhIHpvb20gb2JqZWN0IGRhdGEgZXJyb3IgJXNcIiwgdGhpcy5jb25maWcuZGF0YSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFx0XHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgICA9IHRydWU7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSA9IHRoaXMubGV2ZWwuZGVidWc7XHJcblx0dmFyIHdpZHRoICA9IHRoaXMuc3ByaXRlLndpZHRoO1xyXG5cdHZhciBoZWlnaHQgPSB0aGlzLnNwcml0ZS5oZWlnaHQ7XHJcblx0dGhpcy5jb2xsaXNpb25SZWN0ID0gbmV3IFBJWEkuUmVjdGFuZ2xlKC13aWR0aCAqIHRoaXMuc3ByaXRlLmFuY2hvci54LCAoLXRoaXMuc3ByaXRlLmFuY2hvci55KSAqIGhlaWdodCwgd2lkdGgsIGhlaWdodCk7XHJcbn1cclxuXHJcbk9iamVjdENhbWVyYVpvb20ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdENhbWVyYVpvb20ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufTtcclxuXHJcbk9iamVjdENhbWVyYVpvb20ucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHR0aGlzLmxldmVsLmNoYW5nZVpvb20odGhpcy5jYW1lcmFab29tLnpvb20sIHRoaXMuY2FtZXJhWm9vbS50aW1lLCB0aGlzLmNhbWVyYVpvb20uZGVsYXkpO1xyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbi8vIHZhciBFbWl0dGVyICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdENvaW4oKVxyXG57XHJcblx0R2FtZU9iamVjdC5jYWxsKHRoaXMsIFwiY29pblwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICAgICAgICA9IG51bGw7XHJcblxyXG5cdHRoaXMuc3ByaXRlICAgICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmF0dHJhY3RlZCAgICAgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuYXR0cmFjdGlvblRpbWVNYXggID0gMC4zO1xyXG5cdHRoaXMuYXR0cmFjdGlvblBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQoKTtcclxuXHJcblx0dGhpcy50aW1lbGluZSA9IG51bGw7XHJcblxyXG5cdC8vIFBhcnRpY2xlc1xyXG5cdHRoaXMucGlja3VwUFMgICAgICA9IG5ldyBjbG91ZGtpZC5FbWl0dGVyKHRoaXMsIFt0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKV0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfY29pbl9jb2xsZWN0X2J1cnN0XCIpKTtcclxuXHR0aGlzLnBpY2t1cFBTLmVtaXQgPSBmYWxzZTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdENvaW47XHJcbk9iamVjdENvaW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHYW1lT2JqZWN0LnByb3RvdHlwZSk7XHJcbk9iamVjdENvaW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gT2JqZWN0Q29pbjtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuT2JqZWN0Q29pbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGwpXHJcbntcclxuXHRpZih0aGlzLnNwcml0ZSA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKCk7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuc3ByaXRlKTtcclxuXHR9XHJcbn07XHJcblxyXG5PYmplY3RDb2luLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLmV4cGxvc2lvblR3ZWVuID0gbnVsbDtcclxuXHRpZighIXRoaXMuZXhwbG9zaW9uVHdlZW4pXHJcblx0e1xyXG5cdFx0dGhpcy5leHBsb3Npb25Ud2Vlbi5raWxsKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQ29uZmlndXJlXHJcbiAqIEBwYXJhbSB7TGV2ZWx9IGxldmVsXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcclxuICovXHJcbk9iamVjdENvaW4ucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHR0aGlzLmxldmVsICA9IGxldmVsO1xyXG5cdHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG5cclxuXHR0aGlzLnggPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi54O1xyXG5cdHRoaXMueSA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLnk7XHJcblx0dGhpcy5zcHJpdGUudGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9nYW1lcGxheV9zbm93Zmxha2VcIik7XHJcblx0dGhpcy5zcHJpdGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlIC5zZXQoMSk7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSA9IHRydWU7XHJcblxyXG5cdC8vIEluaXQgY29kZVxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgICA9IHRydWU7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSAgID0gdHJ1ZTtcclxuXHR0aGlzLmF0dHJhY3RlZCAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmF0dHJhY3Rpb25UYXJnZXQgPSAwO1xyXG5cdHRoaXMuYXR0cmFjdGlvblRpbWUgICA9IDA7XHJcblx0dGhpcy5yb3RhdGlvbiAgPSBNYXRoLnJhbmRvbSgwLDM2MCkgKiBQSVhJLkRFR19UT19SQUQ7XHJcblx0dGhpcy5jb2xsaXNpb25DaXJjbGUgPSBuZXcgUElYSS5DaXJjbGUoMCwgMCwgNTUpO1xyXG5cclxuXHQvLyBBbmltYXRpb25cclxuXHRpZighdGhpcy50aW1lbGluZSlcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZS5wb3NpdGlvbi5zZXQoMCwgLTEwKVxyXG5cdFx0dGhpcy50aW1lbGluZSA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuc3ByaXRlLCAwLjc1LCB7eTogMTAsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgIE1hdGgucmFuZG9tKCkpO1xyXG5cdFx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuc3ByaXRlLnNjYWxlLCAwLjUsIHt4OiAxLjMsIHk6IDEuMywgZWFzZTpTaW5lLmVhc2VJbk91dCwgcmVwZWF0Oi0xLCB5b3lvOnRydWV9LCAgMCk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMudGltZWxpbmUpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy50aW1lbGluZS5yZXN1bWUoKTtcclxuXHR9XHJcblxyXG5cclxuXHQvLyBFeHBsb3Npb25cclxuXHRpZighIWNvbmZpZy5leHBsb3Npb24pXHJcblx0XHR0aGlzLmV4cGxvc2lvbihjb25maWcuZXhwbG9zaW9uLmFuZ2xlLCBjb25maWcuZXhwbG9zaW9uLmRpc3RhbmNlLCBjb25maWcuZXhwbG9zaW9uLnRpbWUpXHJcblxyXG5cdC8vIERlYnVnXHJcblx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHRcdHRoaXMuZHJhd0NvbGxpc2lvbigpO1xyXG59XHJcblxyXG4vKipcclxuICogRGlzcG9zZVxyXG4gKi9cclxuT2JqZWN0Q29pbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCEhdGhpcy50aW1lbGluZSlcclxuXHRcdHRoaXMudGltZWxpbmUucGF1c2UoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZVxyXG4gKi9cclxuT2JqZWN0Q29pbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5waWNrdXBQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0aWYodGhpcy5hdHRyYWN0ZWQpXHJcblx0e1xyXG5cdFx0dGhpcy5hdHRyYWN0aW9uVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0aWYodGhpcy5hdHRyYWN0aW9uVGltZSA+IHRoaXMuYXR0cmFjdGlvblRpbWVNYXgpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuc3ByaXRlLnZpc2libGUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5hdHRyYWN0ZWQgICAgICA9IGZhbHNlO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy54ID0gdGhpcy5hdHRyYWN0aW9uUG9zaXRpb24ueCArICh0aGlzLmF0dHJhY3Rpb25UYXJnZXQueCAtIDIwIC0gdGhpcy5hdHRyYWN0aW9uUG9zaXRpb24ueCkgKiB0aGlzLmF0dHJhY3Rpb25UaW1lL3RoaXMuYXR0cmFjdGlvblRpbWVNYXg7XHJcblx0XHR0aGlzLnkgPSB0aGlzLmF0dHJhY3Rpb25Qb3NpdGlvbi55ICsgKHRoaXMuYXR0cmFjdGlvblRhcmdldC55IC0gMjAgLSB0aGlzLmF0dHJhY3Rpb25Qb3NpdGlvbi55KSAqIHRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHRcdHRoaXMuc3ByaXRlLnNjYWxlLnggPSAxLXRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHRcdHRoaXMuc3ByaXRlLnNjYWxlLnkgPSAxLXRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogQW4gZW50aXR5IGhhcyBwaWNrZWQgdXAgdGhlIGNvaW5cclxuICogQHBhcmFtIHtHYW1lT2JqZWN0fSB0YXJnZXRcclxuICovXHJcbk9iamVjdENvaW4ucHJvdG90eXBlLnBpY2t1cCA9IGZ1bmN0aW9uKHRhcmdldClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuYXR0cmFjdGVkICAgICAgICA9IHRydWU7XHJcblx0dGhpcy5hdHRyYWN0aW9uVGFyZ2V0ID0gdGFyZ2V0O1xyXG5cdHRoaXMuYXR0cmFjdGlvblBvc2l0aW9uLnNldCh0aGlzLngsIHRoaXMueSk7XHJcblx0dGhpcy5waWNrdXBQUy5lbWl0ICAgID0gdHJ1ZTtcclxuXHJcblx0aWYoISF0aGlzLmV4cGxvc2lvblR3ZWVuKVxyXG5cdFx0dGhpcy5leHBsb3Npb25Ud2Vlbi5raWxsKCk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfcGlja3VwX3Nub3dmbGFrZV8wMFwiKTtcclxuXHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG4vKipcclxuICogTW92ZSB0aGUgc25vZmxha2UgaW4gYSBjZXJ0YWluIGRpcmVjdGlvbiBmcm9tIHRoZSBzcGF3biBwb3NpdGlvblxyXG4gKi9cclxuT2JqZWN0Q29pbi5wcm90b3R5cGUuZXhwbG9zaW9uID0gZnVuY3Rpb24oYW5nbGUsIGRpc3RhbmNlLCB0aW1lKVxyXG57XHJcblx0dGhpcy5leHBsb3Npb25Ud2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdHRoaXMuZXhwbG9zaW9uVHdlZW4udG8odGhpcywgdGltZSxcclxuXHR7XHJcblx0XHR4OiB0aGlzLnggKyBNYXRoLmNvcyhhbmdsZSAqIFBJWEkuREVHX1RPX1JBRCkgKiBkaXN0YW5jZSwgZWFzZTpRdWFkLmVhc2VPdXQsXHJcblx0XHR5OiB0aGlzLnkgKyBNYXRoLnNpbihhbmdsZSAqIFBJWEkuREVHX1RPX1JBRCkgKiBkaXN0YW5jZSwgZWFzZTpRdWFkLmVhc2VPdXRcclxuXHR9LCAgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLmV4cGxvc2lvblR3ZWVuKTtcclxuXHJcbn0iLCJ2YXIgQ29tbW9uICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgR2FtZU9iamVjdCAgPSByZXF1aXJlKFwiLi9HYW1lT2JqZWN0XCIpO1xyXG4vLyB2YXIgRW1pdHRlciAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBPYmplY3RDcnlzdGFsKGNvbG9yKVxyXG57XHJcblx0R2FtZU9iamVjdC5jYWxsKHRoaXMsIFwiY3J5c3RhbFwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICA9IG51bGw7XHJcblx0dGhpcy5jb2xvciAgICAgICAgPSBjb2xvcjtcclxuXHR0aGlzLmNoYXJhY3RlciAgICA9IENvbW1vbi5zYXZlZERhdGEuZ2V0Q2hhcmFjdGVyQnlDb2xvcih0aGlzLmNvbG9yKTtcclxuXHR0aGlzLmluZGV4ICAgICAgICA9IDA7XHJcblxyXG5cdHRoaXMuaGlnaGxpZ2h0ID0gbnVsbDtcclxuXHR0aGlzLnNwcml0ZSAgICA9IG51bGw7XHJcblx0dGhpcy5hdHRyYWN0ZWQgPSBmYWxzZTtcclxuXHR0aGlzLmF0dHJhY3Rpb25UaW1lTWF4ID0gMC4zO1xyXG5cdHRoaXMuYXR0cmFjdGlvblBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQoKTtcclxuXHJcblx0dGhpcy5jYW5CZVBpY2tlZFVwID0gdHJ1ZTtcclxuXHR0aGlzLnBpY2t1cFBTICAgICAgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLCBbdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDBcIildLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX2NvaW5fY29sbGVjdF9idXJzdFwiKSk7XHJcblx0dGhpcy5waWNrdXBQUy5lbWl0ID0gZmFsc2U7XHJcblxyXG5cdHRoaXMuZ2xvdyAgICAgPSBudWxsO1xyXG5cdHRoaXMudGltZWxpbmUgPSBudWxsO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0Q3J5c3RhbDtcclxuT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RDcnlzdGFsO1xyXG5cclxuT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuaW5kZXhlcyAgICA9IHt9O1xyXG5PYmplY3RDcnlzdGFsLnByb3RvdHlwZS5jb2xsZWN0ZWQgID0ge307XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuZ2xvdyA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuZ2xvdyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9jcnlzdGFsX2dsb3dcIikpO1xyXG5cdFx0dGhpcy5nbG93LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5nbG93KTtcclxuXHR9XHJcblxyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdENyeXN0YWwucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICA9IG51bGw7XHJcblxyXG5cdHRoaXMuY2FuQmVQaWNrZWRVcCA9IHRydWU7XHJcblxyXG5cdGlmKHRoaXMuY2hhcmFjdGVyID09IFwia3Jpc3RvZmZcIilcclxuXHRcdHRoaXMuY2FuQmVQaWNrZWRVcCA9IGZhbHNlO1xyXG5cdGVsc2VcclxuXHRcdHRoaXMuY2FuQmVQaWNrZWRVcCA9IHRydWU7XHJcbn1cclxuXHJcbk9iamVjdENyeXN0YWwucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHR0aGlzLnJlc2V0KCk7XHJcblx0XHJcblx0Ly8gQ3VycmVudCBpbmRleCwgc2hhcmVkIGFtb25nIGFsbCBjcnlzdGFscyAoc3RhdGljKVxyXG5cdGlmKCF0aGlzLmluZGV4ZXNbdGhpcy5jaGFyYWN0ZXJdKVxyXG5cdFx0dGhpcy5pbmRleGVzW3RoaXMuY2hhcmFjdGVyXSA9IDE7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5pbmRleGVzW3RoaXMuY2hhcmFjdGVyXSsrO1xyXG5cclxuXHQvLyBJbmRleCBvZiB0aGUgY3VycmVudCBjb2xvcmVkIGNyeXN0YWxcclxuXHR0aGlzLmluZGV4ID0gdGhpcy5pbmRleGVzW3RoaXMuY2hhcmFjdGVyXS0xO1xyXG5cclxuXHQvLyBDb25maWdcclxuXHR0aGlzLmxldmVsICA9IGxldmVsO1xyXG5cdHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG5cclxuXHR0aGlzLnggPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi54O1xyXG5cdHRoaXMueSA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLnk7XHJcblx0dGhpcy5hbHBoYSA9IDE7XHJcblx0dGhpcy5zcHJpdGUudGV4dHVyZSAgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXh0dXJlKTtcclxuXHR0aGlzLnNwcml0ZS5hbmNob3Iuc2V0KHRoaXMuY29uZmlnLmFuY2hvci54LCB0aGlzLmNvbmZpZy5hbmNob3IueSk7XHJcblx0dGhpcy5zcHJpdGUucm90YXRpb24gPSB0aGlzLmNvbmZpZy5yb3RhdGlvbiAqIFBJWEkuREVHX1RPX1JBRDtcclxuXHR0aGlzLnNwcml0ZS5zY2FsZS5zZXQoMSk7XHJcblx0dGhpcy5zcHJpdGUuYWxwaGEgPSAxO1xyXG5cclxuXHR0aGlzLmdsb3cucm90YXRpb24gPSAwO1xyXG5cdHRoaXMuZ2xvdy5zY2FsZS5zZXQoMSk7XHJcblx0dGhpcy5nbG93LnZpc2libGUgPSB0cnVlO1xyXG5cdHRoaXMuZ2xvdy5hbHBoYSA9IDE7XHJcblxyXG5cdC8vIEluaXQgY29kZVxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgICA9IHRydWU7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSAgID0gdHJ1ZTtcclxuXHR0aGlzLmF0dHJhY3RlZCAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmF0dHJhY3Rpb25UYXJnZXQgPSAwO1xyXG5cdHRoaXMuYXR0cmFjdGlvblRpbWUgICA9IDA7XHJcblx0dGhpcy5hdHRyYWN0aW9uUG9zaXRpb24gPSBuZXcgUElYSS5Qb2ludCh0aGlzLngsIHRoaXMueSk7XHJcblx0dGhpcy5yb3RhdGlvbiAgPSBNYXRoLnJhbmRvbSgwLDM2MCkgKiBQSVhJLkRFR19UT19SQUQ7XHJcblxyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuQ2lyY2xlKDAsIDAsIDE1MCk7XHJcblxyXG5cdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHR0aGlzLmRyYXdDb2xsaXNpb24oKTtcclxuXHJcblx0Ly8gQW5pbWF0aW9uXHJcblx0aWYoISF0aGlzLmdsb3cgJiYgdGhpcy5jaGFyYWN0ZXIgPT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUucG9zaXRpb24uc2V0KDAsIC0xMClcclxuXHJcblx0XHR0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHRcdGlmKHRoaXMuY2hhcmFjdGVyICE9IFwia3Jpc3RvZmZcIilcclxuXHRcdFx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuc3ByaXRlLCAxLCAgICB7eTogMjAsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlLCBvblVwZGF0ZVNjb3BlOnRoaXMsIG9uVXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5nbG93LnkgPSB0aGlzLnNwcml0ZS55fX0sICAwKTtcclxuXHRcdFx0dGhpcy50aW1lbGluZS50byh0aGlzLmdsb3csIDgsIHtyb3RhdGlvbjogTWF0aC5QSSAqIDIsIGVhc2U6TGluZWFyLmVhc2VOb25lLCByZXBlYXQ6LTF9LCAgMCk7XHJcblx0XHRcdHRoaXMudGltZWxpbmUudG8odGhpcy5nbG93LnNjYWxlLCAwLjUsIHt4OiAxLjUsIHk6IDEuNSwgZWFzZTpRdWFkLmVhc2VJbk91dCwgcmVwZWF0Oi0xLCB5b3lvOnRydWV9LCAgMCk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMudGltZWxpbmUpO1xyXG5cdH1cclxuXHJcblx0Ly8gQWxyZWFkeSBwaWNrZWQgdXA/XHJcblx0aWYoQ29tbW9uLnNhdmVkRGF0YS5pc0NyeXN0YWxDb2xsZWN0ZWQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCwgdGhpcy5jaGFyYWN0ZXIsIHRoaXMuaW5kZXgpKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuY2hhcmFjdGVyICE9IENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmFscGhhID0gMDtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLnNwcml0ZS5hbHBoYSA9IDAuNTtcclxuXHJcblx0XHRcdGlmKCEhdGhpcy5nbG93KVxyXG5cdFx0XHRcdHRoaXMuZ2xvdy52aXNpYmxlID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBEb24ndCBwaWNrIHVwIG90aGVyIGNoYXJhY3RlcnMnIGNyeXN0YWxzXHJcblx0aWYoISF0aGlzLmNoYXJhKVxyXG5cdFx0dGhpcy5yZW1vdmVDaGlsZCh0aGlzLmNoYXJhKTtcclxuXHJcblx0aWYodGhpcy5jaGFyYWN0ZXIgIT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpXHJcblx0e1xyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgIT0gXCJwYWJiaWVcIilcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLnNwcml0ZS5hbHBoYSA9IDAuNTtcclxuXHJcblx0XHRcdGlmKCEhdGhpcy5nbG93KVxyXG5cdFx0XHRcdHRoaXMuZ2xvdy52aXNpYmxlID0gZmFsc2U7XHJcblxyXG5cdFx0XHQvLyBBZGQgaGVhZFxyXG5cdFx0XHR0aGlzLmNoYXJhID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwiaW5nYW1lX3Byb2dyZXNzX2NoYXJfXCIgKyB0aGlzLmNoYXJhY3RlcikpO1xyXG5cdFx0XHR0aGlzLmNoYXJhLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGhpcy5jaGFyYS55ID0gdGhpcy5jaGFyYWN0ZXIgPT0gXCJrcmlzdG9mZlwiID8gLTEyMCA6IC05MDtcclxuXHRcdFx0dGhpcy5jaGFyYS54ID0gKzEwO1xyXG5cdFx0XHR0aGlzLmFkZENoaWxkKHRoaXMuY2hhcmEpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwia3Jpc3RvZmZcIilcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZS5hbHBoYSA9IHRoaXMuaW50ZXJhY3RpdmUgPyAwLjc1IDogMDtcclxuXHRcdC8vIHRoaXMuZ2xvdy5hbHBoYSAgID0gMDtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuT2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCEhdGhpcy50aW1lbGluZSlcclxuXHR7XHJcblx0XHR0aGlzLnRpbWVsaW5lLmtpbGwoKTtcclxuXHRcdHRoaXMudGltZWxpbmUgPSBudWxsO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqL1xyXG5PYmplY3RDcnlzdGFsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnBpY2t1cFBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cclxuXHRpZih0aGlzLmF0dHJhY3RlZClcclxuXHR7XHJcblx0XHR0aGlzLmF0dHJhY3Rpb25UaW1lICs9IHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHJcblx0XHRpZih0aGlzLmF0dHJhY3Rpb25UaW1lID4gdGhpcy5hdHRyYWN0aW9uVGltZU1heClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5zcHJpdGUudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy54ID0gdGhpcy5hdHRyYWN0aW9uUG9zaXRpb24ueCArICh0aGlzLmF0dHJhY3Rpb25UYXJnZXQueCAtIDIwIC0gdGhpcy5hdHRyYWN0aW9uUG9zaXRpb24ueCkgKiB0aGlzLmF0dHJhY3Rpb25UaW1lL3RoaXMuYXR0cmFjdGlvblRpbWVNYXg7XHJcblx0XHR0aGlzLnkgPSB0aGlzLmF0dHJhY3Rpb25Qb3NpdGlvbi55ICsgKHRoaXMuYXR0cmFjdGlvblRhcmdldC55IC0gMjAgLSB0aGlzLmF0dHJhY3Rpb25Qb3NpdGlvbi55KSAqIHRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHRcdHRoaXMuc3ByaXRlLnNjYWxlLnggPSAxLXRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHRcdHRoaXMuc3ByaXRlLnNjYWxlLnkgPSAxLXRoaXMuYXR0cmFjdGlvblRpbWUvdGhpcy5hdHRyYWN0aW9uVGltZU1heDtcclxuXHR9XHJcblxyXG5cdC8vIHRoaXMuaGlnaGxpZ2h0LnJvdGF0aW9uICs9IDkwICogUElYSS5ERUdfVE9fUkFEICogcDMuVGltZXN0ZXAuZGVsdGFUaW1lO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEl0ZW0gY29sbGVjdGVkXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRcclxuICovXHJcbk9iamVjdENyeXN0YWwucHJvdG90eXBlLnBpY2t1cCA9IGZ1bmN0aW9uKHRhcmdldClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0aWYoIXRoaXMuY2FuQmVQaWNrZWRVcCkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmludGVyYWN0aXZlICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmF0dHJhY3RlZCAgICAgICAgPSB0cnVlO1xyXG5cdHRoaXMuYXR0cmFjdGlvblRhcmdldCA9IHRhcmdldDtcclxuXHR0aGlzLnBpY2t1cFBTLmVtaXQgICAgPSB0cnVlO1xyXG5cclxuXHQvLyBTdG9yZSBpbiB0aGUgc3RhdGljIGZpZWxkIHRoYXQgdGhpcyBjcnlzdGFsIGhhcyBiZWVuIGNvbGxlY3RlZFxyXG5cdGlmKCFPYmplY3RDcnlzdGFsLnByb3RvdHlwZS5jb2xsZWN0ZWRbdGhpcy5jaGFyYWN0ZXJdKVxyXG5cdFx0T2JqZWN0Q3J5c3RhbC5wcm90b3R5cGUuY29sbGVjdGVkW3RoaXMuY2hhcmFjdGVyXSA9IFtdO1xyXG5cclxuXHRPYmplY3RDcnlzdGFsLnByb3RvdHlwZS5jb2xsZWN0ZWRbdGhpcy5jaGFyYWN0ZXJdLnB1c2godGhpcy5pbmRleCk7XHJcblxyXG5cdENvbW1vbi5zYXZlZERhdGEuY3J5c3RhbHNbQ29tbW9uLnNhdmVkRGF0YS5sZXZlbF1bdGhpcy5jaGFyYWN0ZXJdW3RoaXMuaW5kZXhdID0gdHJ1ZTtcclxuXHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxuXHJcblx0dGhpcy5sZXZlbC5wYXJlbnQuZ2FtZVVJLmNyeXN0YWxDb2xsZWN0ZWQodGhpcy5jaGFyYWN0ZXIsIHRoaXMuaW5kZXgpO1xyXG5cclxuXHQvLyBIaWRlIHRoZSBnbG93XHJcblx0aWYoISF0aGlzLnRpbWVsaW5lKVxyXG5cdHtcclxuXHRcdHRoaXMudGltZWxpbmUua2lsbCgpO1xyXG5cdFx0dGhpcy50aW1lbGluZSA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuZ2xvdy5zY2FsZSwgdGhpcy5hdHRyYWN0aW9uVGltZU1heCwge3g6IDAsIHk6IDAsIGVhc2U6UXVhZC5lYXNlT3V0fSwgIDApO1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLnRpbWVsaW5lKTtcclxuXHR9XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfcGlja3VwX2dlbV90aW5rbGVfMDFcIik7XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbi8vIHZhciBFbWl0dGVyICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdERlY29yYXRpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnID0gbnVsbDtcclxuXHJcblx0dGhpcy5zcHJpdGUgICAgPSBudWxsO1xyXG5cdHRoaXMuY2hhcmFjdGVyID0gbnVsbDtcclxuXHR0aGlzLmNyeXN0YWwgICA9IG51bGw7XHJcblxyXG5cdEdhbWVPYmplY3QuY2FsbCh0aGlzLCBcImRlY29yYXRpb25cIiwgZmFsc2UpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0RGVjb3JhdGlvbjtcclxuT2JqZWN0RGVjb3JhdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0RGVjb3JhdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3REZWNvcmF0aW9uO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3REZWNvcmF0aW9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdERlY29yYXRpb24ucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgID0gbnVsbDtcclxuXHR0aGlzLnZpc2libGUgICA9IHRydWU7XHJcblx0dGhpcy5jaGFyYWN0ZXIgPSBudWxsO1xyXG59XHJcblxyXG5PYmplY3REZWNvcmF0aW9uLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbihsZXZlbCwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBsZXZlbDtcclxuXHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuXHJcblx0dGhpcy54ID0gdGhpcy5jb25maWcucG9zaXRpb24ueDtcclxuXHR0aGlzLnkgPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi55O1xyXG5cdHRoaXMuc3ByaXRlLnRleHR1cmUgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXh0dXJlKTtcclxuXHR0aGlzLnNwcml0ZS5hbmNob3Iuc2V0KHRoaXMuY29uZmlnLmFuY2hvci54LCB0aGlzLmNvbmZpZy5hbmNob3IueSk7XHJcblx0dGhpcy5zcHJpdGUuc2NhbGUgLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LCB0aGlzLmNvbmZpZy5zY2FsZS55KTtcclxuXHR0aGlzLnNwcml0ZS5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cclxuXHRpZih0aGlzLmNvbmZpZy5kYXRhICE9IFwiXCIpXHJcblx0e1xyXG5cdFx0dHJ5XHJcblx0XHR7XHJcblx0XHRcdHZhciBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdFx0dGhpcy5jaGFyYWN0ZXIgPSAhIWRhdGEuY2hhcmFjdGVyID8gZGF0YS5jaGFyYWN0ZXIgOiBudWxsO1xyXG5cdFx0XHR0aGlzLmNyeXN0YWwgICA9ICEhZGF0YS5jcnlzdGFsID8gKHBhcnNlSW50KGRhdGEuY3J5c3RhbCktMSkgOiBudWxsO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2goZSlcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihcIkRlY29yYXRpb24gZGF0YSBlcnJvciAlc1wiLCB0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEhpZGUgaWYgY2hhcmFjdGVyIGlzIGRpZmZlcmVudCB0aGFuIHRoZSBvbmUgc2V0XHJcblx0aWYodGhpcy5jaGFyYWN0ZXIgIT0gbnVsbCAmJiB0aGlzLmNoYXJhY3RlciAhPSBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcilcclxuXHR7XHJcblx0XHR0aGlzLnZpc2libGUgPSBmYWxzZTtcclxuXHR9XHJcblx0XHJcblx0Ly8gSGlkZSBpZiBjaGFyYWN0ZXIgaXMgdGhlIG9uZSBzZXQgYnV0IHRoZSBjcnlzdGFsIGhhcyBiZWVuIGNvbGxlY3RlZFxyXG5cdGlmKHRoaXMuY2hhcmFjdGVyICE9IG51bGwgJiYgdGhpcy5jcnlzdGFsICE9IG51bGwgJiYgdGhpcy5jaGFyYWN0ZXIgPT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgJiYgQ29tbW9uLnNhdmVkRGF0YS5pc0NyeXN0YWxDb2xsZWN0ZWQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCwgdGhpcy5jaGFyYWN0ZXIsIHRoaXMuY3J5c3RhbCkpXHJcblx0e1xyXG5cdFx0dGhpcy52aXNpYmxlID0gZmFsc2U7XHJcblx0fVx0XHJcbn1cclxuXHJcbk9iamVjdERlY29yYXRpb24ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdERlY29yYXRpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufTsiLCJ2YXIgQ29tbW9uICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgR2FtZU9iamVjdCAgPSByZXF1aXJlKFwiLi9HYW1lT2JqZWN0XCIpO1xyXG52YXIgRW1pdHRlclx0XHQ9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdEp1bXBQbGF0Zm9ybSgpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJqdW1wX3BsYXRmb3JtXCIsIGZhbHNlKTtcclxuXHJcblx0dGhpcy5sZXZlbCAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmp1bXBQbGF0Zm9ybSA9XHJcblx0e1xyXG5cdFx0c3BlZWQgIDogMTgwMFxyXG5cdH1cclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdEp1bXBQbGF0Zm9ybTtcclxuT2JqZWN0SnVtcFBsYXRmb3JtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5PYmplY3RKdW1wUGxhdGZvcm0ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gT2JqZWN0SnVtcFBsYXRmb3JtO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RKdW1wUGxhdGZvcm0ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsKVxyXG57XHJcblx0aWYodGhpcy5zcHJpdGUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSgpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLnNwcml0ZSk7XHJcblx0fVxyXG59O1xyXG5cclxuT2JqZWN0SnVtcFBsYXRmb3JtLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG59XHJcblxyXG5PYmplY3RKdW1wUGxhdGZvcm0ucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHR0aGlzLmxldmVsICA9IGxldmVsO1xyXG5cdHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG5cclxuXHR0aGlzLnggPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi54O1xyXG5cdHRoaXMueSA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLnk7XHJcblx0dGhpcy5zcHJpdGUudGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuY29uZmlnLnRleHR1cmUpO1xyXG5cdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQodGhpcy5jb25maWcuYW5jaG9yLngsIHRoaXMuY29uZmlnLmFuY2hvci55KTtcclxuXHR0aGlzLnNwcml0ZS5zY2FsZSAuc2V0KHRoaXMuY29uZmlnLnNjYWxlLngsIHRoaXMuY29uZmlnLnNjYWxlLnkpO1xyXG5cdHRoaXMucm90YXRpb24gPSB0aGlzLmNvbmZpZy5yb3RhdGlvbiAqIFBJWEkuREVHX1RPX1JBRDtcclxuXHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0dmFyIHdpZHRoICAgICAgICA9IHRoaXMuc3ByaXRlLndpZHRoICAqIDAuNjtcclxuXHR2YXIgaGVpZ2h0ICAgICAgID0gdGhpcy5zcHJpdGUuaGVpZ2h0O1xyXG5cdHRoaXMuY29sbGlzaW9uUmVjdCA9IG5ldyBQSVhJLlJlY3RhbmdsZSgtd2lkdGggKiB0aGlzLnNwcml0ZS5hbmNob3IueCwgKC10aGlzLnNwcml0ZS5hbmNob3IueSkgKiBoZWlnaHQsIHdpZHRoLCBoZWlnaHQpO1xyXG59XHJcblxyXG5PYmplY3RKdW1wUGxhdGZvcm0ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdEp1bXBQbGF0Zm9ybS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59O1xyXG5cclxuT2JqZWN0SnVtcFBsYXRmb3JtLnByb3RvdHlwZS5oaXQgPSBmdW5jdGlvbih0YXJnZXQpXHJcbntcclxuXHRpZih0YXJnZXQudmVsb2NpdHkgPCAwKSByZXR1cm47XHJcblxyXG5cdHRhcmdldC52ZWxvY2l0eS55ID0gLXRoaXMuanVtcFBsYXRmb3JtLnNwZWVkO1xyXG5cclxuXHRpZighIXRhcmdldC5pc1JpZGluZ1ZlaGljbGUpXHJcblx0XHR0YXJnZXQudmVoaWNsZS5zZXRBbmltYXRpb24oJ2p1bXBfbm9ybWFsJywgZmFsc2UpO1xyXG5cdGVsc2VcclxuXHRcdHRhcmdldC5zZXRBbmltYXRpb24oJ2p1bXBfbm9ybWFsJywgZmFsc2UpO1xyXG5cdHRhcmdldC55IC09IDEwO1xyXG5cdHRhcmdldC5pc0dyb3VuZGVkID0gZmFsc2U7XHJcblx0dGFyZ2V0LmlzVHVtYmxpbmcgPSBmYWxzZTtcclxuXHR0YXJnZXQuY2FuVHVtYmxlICA9IHRydWU7XHJcblx0XHJcblx0Ly8gQXVkaW9cclxuXHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19qdW1wXzAwXCIsIFwic2Z4X2dlbmVyaWNfanVtcF8wMVwiLCBcInNmeF9nZW5lcmljX2p1bXBfMDJcIl0pO1xyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbnZhciBFbWl0dGVyXHRcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0TGV2ZWxFbmQoYXJncylcclxue1xyXG5cdEdhbWVPYmplY3QuY2FsbCh0aGlzLCBcImxldmVsX2VuZFwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG5cdHRoaXMuZ2FtZU92ZXIgPSAhYXJncztcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdExldmVsRW5kO1xyXG5PYmplY3RMZXZlbEVuZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0TGV2ZWxFbmQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gT2JqZWN0TGV2ZWxFbmQ7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbk9iamVjdExldmVsRW5kLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdExldmVsRW5kLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG59XHJcblxyXG5PYmplY3RMZXZlbEVuZC5wcm90b3R5cGUuY29uZmlndXJlID0gZnVuY3Rpb24obGV2ZWwsIGNvbmZpZylcclxue1xyXG5cdHRoaXMubGV2ZWwgID0gbGV2ZWw7XHJcblx0dGhpcy5jb25maWcgPSBjb25maWc7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHR0aGlzLnNwcml0ZS50ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4dHVyZSk7XHJcblx0dGhpcy5zcHJpdGUuYW5jaG9yLnNldCh0aGlzLmNvbmZpZy5hbmNob3IueCwgdGhpcy5jb25maWcuYW5jaG9yLnkpO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlIC5zZXQodGhpcy5jb25maWcuc2NhbGUueCwgdGhpcy5jb25maWcuc2NhbGUueSk7XHJcblx0dGhpcy5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cclxuXHQvLyBJbml0IGNvZGVcclxuXHR0aGlzLmludGVyYWN0aXZlICAgID0gdHJ1ZTtcclxuXHR0aGlzLnNwcml0ZS52aXNpYmxlID0gdGhpcy5sZXZlbC5kZWJ1ZztcclxuXHR2YXIgd2lkdGggID0gdGhpcy5zcHJpdGUud2lkdGg7XHJcblx0dmFyIGhlaWdodCA9IHRoaXMuc3ByaXRlLmhlaWdodDtcclxuXHR0aGlzLmNvbGxpc2lvblJlY3QgPSBuZXcgUElYSS5SZWN0YW5nbGUoLXdpZHRoICogdGhpcy5zcHJpdGUuYW5jaG9yLngsICgtdGhpcy5zcHJpdGUuYW5jaG9yLnkpICogaGVpZ2h0LCB3aWR0aCwgaGVpZ2h0KTtcclxufVxyXG5cclxuT2JqZWN0TGV2ZWxFbmQucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdExldmVsRW5kLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZighIXRoaXMuZGVhdGhQUylcclxuXHRcdHRoaXMuZGVhdGhQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKVxyXG59O1xyXG5cclxuT2JqZWN0TGV2ZWxFbmQucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuXHQvLyBJZiB0aGUgY2hhcmFjdGVyIHdhcyBhbHJlYWR5IGRlYWQgKGJ5IGZhaWxpbmcgYSB0dW1ibGUgZm9yIGV4YW1wbGUpXHJcblx0aWYodGhpcy5sZXZlbC5hdmF0YXIuaXNEZWFkKVxyXG5cdHtcclxuXHRcdHRoaXMubGV2ZWwuZm9jdXNZQWN0aXZlID0gZmFsc2U7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHRpZighdGhpcy5nYW1lT3ZlcilcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5sZXZlbC5jb21wbGV0ZWQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmxldmVsLmF2YXRhci5pc0ltbW9ydGFsID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGlmKHRoaXMuZ2FtZU92ZXIpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMubGV2ZWwuYXZhdGFyLmlzRGVhZCA9IHRydWU7XHJcblx0XHRcdHRoaXMubGV2ZWwuYXZhdGFyLnZlbG9jaXR5LnggPSAwO1xyXG5cclxuXHRcdFx0dGhpcy5sZXZlbC5mb2N1c1lBY3RpdmUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5sZXZlbC5jaGFuZ2VGb2N1c1BvaW50KG5ldyBQSVhJLlBvaW50KDAuNDMsIDAuNSksIDEuMjUpO1xyXG5cdFx0XHQvLyB0aGlzLmxldmVsLmF2YXRhci5kZWF0aFBTLmVtaXQgPSB0cnVlO1xyXG5cdFx0XHQvLyB0aGlzLmxldmVsLmF2YXRhci5hbHBoYSA9IDA7XHJcblxyXG5cdFx0XHQvLyBEZWF0aCBhbmltYXRpb25cclxuXHRcdFx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5kZWF0aFBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5sZXZlbCxcclxuXHRcdFx0XHRbXHJcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcclxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAxXCIpLFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDJcIiksXHJcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxyXG5cdFx0XHRcdF0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfZGVhdGhcIikpO1xyXG5cclxuXHRcdFx0XHR0aGlzLmRlYXRoUFMudXBkYXRlU3Bhd25Qb3ModGhpcy5sZXZlbC5hdmF0YXIueCwgKC10aGlzLmxldmVsLnkgKyBDb21tb24uU1RBR0VfSEVJR0hUKSAqICgxL3RoaXMubGV2ZWwuem9vbSkpO1xyXG5cdFx0XHRcdHRoaXMuZGVhdGhQUy5lbWl0ID0gdHJ1ZTtcclxuXHRcdFx0XHRcclxuXHRcdFx0fSwgMC41LCB0aGlzKTtcclxuXHRcdFx0XHJcblx0XHRcdENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfZ2VuZXJpY19mYWxsX29mZnNjcmVlbl8wMVwiKTtcclxuXHRcdFx0fSwgMC4yLCB0aGlzKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5sZXZlbC5hdmF0YXIuYXJlSW5wdXRBY3RpdmUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5sZXZlbC5mb2N1c1hBY3RpdmUgPSBmYWxzZTtcclxuXHJcblx0XHRcdGlmKHRoaXMubGV2ZWwuYXZhdGFyLmlzU2hyaW5raW5nKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5sZXZlbC5hdmF0YXIucG93ZXJVbnNocmluaygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5sZXZlbC5nYW1lT3ZlcigpO1xyXG5cdH1cclxufTsiLCJ2YXIgQ29tbW9uICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0TWFuYWdlcihwb29scylcclxue1xyXG5cdHRoaXMuYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cclxuXHR0aGlzLl9wb29sRGF0YSA9IHBvb2xzO1xyXG5cdHRoaXMuX3Bvb2xzICAgID0gbnVsbDtcclxuXHR0aGlzLl9vYmplY3RzICA9IFtdO1xyXG5cdHRoaXMuX2lkMlBvb2wgID0gW107XHJcblxyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RNYW5hZ2VyO1xyXG5PYmplY3RNYW5hZ2VyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuT2JqZWN0TWFuYWdlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RNYW5hZ2VyO1xyXG5cclxuLyoqXHJcbiAqIFRPRE9cclxuICovXHJcbk9iamVjdE1hbmFnZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLl9wb29scyA9IHt9O1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLl9wb29sRGF0YS5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRpZighdGhpcy5fcG9vbHNbdGhpcy5fcG9vbERhdGFbaV0ucG9vbF0pXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX3Bvb2xzW3RoaXMuX3Bvb2xEYXRhW2ldLnBvb2xdID0gbmV3IHAzLk9iamVjdFBvb2wodGhpcy5fcG9vbERhdGFbaV0uYmFzZSwgISF0aGlzLl9wb29sRGF0YVtpXS5xdWFudGl0eSA/IHRoaXMuX3Bvb2xEYXRhW2ldLnF1YW50aXR5IDogMSwgdGhpcy5fcG9vbERhdGFbaV0uYXJncyk7XHJcblx0XHR9XHJcblx0XHR0aGlzLl9pZDJQb29sW3RoaXMuX3Bvb2xEYXRhW2ldLmlkXSA9IHRoaXMuX3Bvb2xEYXRhW2ldLnBvb2w7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuT2JqZWN0TWFuYWdlci5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbihpZClcclxue1xyXG5cdGlmKCEhdGhpcy5faWQyUG9vbFtpZF0gJiYgISF0aGlzLl9wb29sc1t0aGlzLl9pZDJQb29sW2lkXV0pXHJcblx0XHR2YXIgcG9vbCA9IHRoaXMuX3Bvb2xzW3RoaXMuX2lkMlBvb2xbaWRdXTtcclxuXHRlbHNlXHJcblx0XHR2YXIgcG9vbCA9IHRoaXMuX3Bvb2xzW1wiZGVmYXVsdFwiXTtcclxuXHJcblx0Ly8gR2V0IG9uZSBmcmVlIGVudGl0eSBmcm9tIHRoZSBwb29sXHJcblx0dmFyIG9iaiA9IHBvb2wuY3JlYXRlKCk7XHJcblxyXG5cdC8vIElmIHRoZXJlIGFyZSBubyBmcmVlIGVudGl0aWVzIGNyZWF0ZSBzb21lXHJcblx0aWYob2JqID09IG51bGwpXHJcblx0e1xyXG5cdFx0cG9vbC5leHBhbmQoMik7XHJcblx0XHRvYmogPSBwb29sLmNyZWF0ZSgpO1xyXG5cdH1cclxuXHJcblx0Ly8gQ2FjaGUgaXQgaW4gYW4gYXJyYXkgYnkgdHlwZVxyXG5cdGlmKCF0aGlzLl9vYmplY3RzW29iai50eXBlXSlcclxuXHR7XHJcblx0XHR0aGlzLl9vYmplY3RzW29iai50eXBlXSA9IFtdO1xyXG5cdH1cclxuXHR0aGlzLl9vYmplY3RzW29iai50eXBlXS5wdXNoKG9iaik7XHJcblxyXG5cdHJldHVybiBvYmo7XHJcbn07XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuT2JqZWN0TWFuYWdlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKG9iailcclxue1xyXG5cdGZvcih2YXIgaSBpbiB0aGlzLl9wb29scylcclxuICAgIHtcclxuICAgIFx0aWYodGhpcy5fcG9vbHNbaV0uX3VzZWQuaW5kZXhPZihvYmopID4gLTEpXHJcbiAgICBcdHtcclxuICAgIFx0XHR0aGlzLl9wb29sc1tpXS5mcmVlKG9iaik7XHJcblxyXG5cdFx0XHR2YXIgaW5kZXggPSB0aGlzLl9vYmplY3RzW29iai50eXBlXS5pbmRleE9mKG9iaik7XHJcblx0XHRcdGlmKGluZGV4ICE9IC0xKVxyXG5cdFx0XHRcdHRoaXMuX29iamVjdHNbb2JqLnR5cGVdLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICBcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogVE9ET1xyXG4gKi9cclxuT2JqZWN0TWFuYWdlci5wcm90b3R5cGUuZ2V0T2JqZWN0c09mVHlwZSA9IGZ1bmN0aW9uKHR5cGUpXHJcbntcclxuXHRyZXR1cm4gISF0aGlzLl9vYmplY3RzW3R5cGVdID8gdGhpcy5fb2JqZWN0c1t0eXBlXSA6IFtdO1xyXG59OyIsInZhciBDb21tb24gICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBSdW5uaW5nRW50aXR5ICA9IHJlcXVpcmUoXCIuL1J1bm5pbmdFbnRpdHlcIik7XHJcbnZhciBFbWl0dGVyXHRcdCAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0TWFyc2htYWxsb3coKVxyXG57XHJcblx0UnVubmluZ0VudGl0eS5jYWxsKHRoaXMsIFwibWFyc2htYWxsb3dcIik7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmF2YXRhciAgICAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICAgICAgPSBudWxsO1xyXG5cdHRoaXMucmVtb3ZlV2hlbk91dHNpZGUgPSB0cnVlO1xyXG5cclxuXHR0aGlzLnNwaW5lICAgICAgICAgICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLmN1cnJlbnRCb2R5QW5pbWF0aW9uID0gXCJcIjtcclxuXHR0aGlzLmN1cnJlbnRMZWdzQW5pbWF0aW9uID0gXCJcIjtcclxuXHJcblx0dGhpcy5pc0pvYlN0YXJ0ZWQgPSBmYWxzZTtcclxuXHR0aGlzLmlzSm9iRG9uZSAgICA9IGZhbHNlO1xyXG5cdHRoaXMudGltZSAgICA9IDA7XHJcblx0dGhpcy50aW1lRW5kID0gNztcclxuXHJcblx0dGhpcy5pc0F0dGFja2luZyAgICAgICAgID0gZmFsc2U7XHJcblx0dGhpcy5hdHRhY2tUaW1lICAgICAgICAgID0gMDtcclxuXHR0aGlzLmF0dGFja1RpbWVFbmQgICAgICAgPSAxO1xyXG5cdHRoaXMuYXR0YWNrQ29sbGlzaW9uVGltZSA9IDAuMztcclxuXHRcclxuXHR0aGlzLndhbGtMb29wID0gXCJcIjtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdE1hcnNobWFsbG93O1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFJ1bm5pbmdFbnRpdHkucHJvdG90eXBlKTtcclxuT2JqZWN0TWFyc2htYWxsb3cucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gT2JqZWN0TWFyc2htYWxsb3c7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBJbml0XHJcbiAqL1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGwpXHJcbntcclxuXHQvLyBDb2xsaWRlclxyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlICAgID0gbmV3IFBJWEkuQ2lyY2xlKDAsIDAsIDEwMCk7XHJcblxyXG5cclxuXHQvLyBJbml0IHNwaW5lIGFuaW1hdGlvblxyXG5cdGlmKHRoaXMuc3BpbmUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLmFuaW1hdGlvbkhvbGRlciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLmFuaW1hdGlvbkhvbGRlcik7XHJcblxyXG5cdFx0dGhpcy5zcGluZURhdGEgPSBDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YS5jaGFyX21hcnNobWFsbG93O1xyXG5cdFx0dGhpcy5zcGluZSA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKHRoaXMuc3BpbmVEYXRhKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0VG9TZXR1cFBvc2UoKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbihudWxsKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbkJ5TmFtZShcIm9sYWZcIik7XHJcblx0XHR0aGlzLnNwaW5lLmF1dG9VcGRhdGUgPSBmYWxzZTtcclxuXHRcdHRoaXMuc3BpbmUueSA9IHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cztcclxuXHRcdHRoaXMuYW5pbWF0aW9uSG9sZGVyLmFkZENoaWxkKHRoaXMuc3BpbmUpO1xyXG5cclxuXHRcdHZhciBhbmltYXRpb25zID1cclxuXHRcdFtcclxuXHRcdFx0J2lkbGVfYm9keScsXHJcblx0XHRcdCdpZGxlX2xlZ3MnLFxyXG5cdFx0XHQnaWRsZV9sZWdzJyxcclxuXHRcdFx0J3J1bl9mbGF0X2JvZHknLFxyXG5cdFx0XHQncnVuX2ZsYXRfYm9keV9zd2lwZScsXHJcblx0XHRcdCdydW5fZmxhdF9sZWdzJyxcclxuXHRcdFx0Ly8gJ2p1bXBfbm9ybWFsJyxcclxuXHRcdFx0J2ZhbGxfYm9keScsXHJcblx0XHRcdCdmYWxsX2xlZ3MnLFxyXG5cdFx0XHQnbGFuZF9ib2R5JyxcclxuXHRcdFx0J2xhbmRfbGVncycsXHJcblx0XHRcdCdlbmRfd2F2ZSdcclxuXHRcdF07XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGFuaW1hdGlvbnMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBhbmltYXRpb25zLmxlbmd0aDsgaisrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYoaSA9PSBqKSBjb250aW51ZTtcclxuXHJcblx0XHRcdFx0aWYoYW5pbWF0aW9uc1tpXSA9PSBcImZhbGxfYm9keVwiIHx8IGFuaW1hdGlvbnNbaV0gPT0gXCJmYWxsX2xlZ3NcIilcclxuXHRcdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjEpO1xyXG5cdFx0XHRcdGVsc2UgaWYoYW5pbWF0aW9uc1tqXSA9PSBcInJ1bl9mbGF0X2JvZHlfc3dpcGVcIilcclxuXHRcdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjEpO1xyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR0aGlzLmF0dGFja0NvbGxpc2lvbkNpcmNsZSA9IG5ldyBQSVhJLkNpcmNsZSgzMDAsIC01MCwgMzAwKTtcclxuXHJcblx0Ly8gdmFyIGRlYnVnQ2lyY2xlID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHQvLyB0aGlzLmFkZENoaWxkKGRlYnVnQ2lyY2xlKTtcclxuXHQvLyBkZWJ1Z0NpcmNsZS5saW5lU3R5bGUoMSwgMHhGNzExMUQpO1xyXG5cdC8vIGRlYnVnQ2lyY2xlLmRyYXdDaXJjbGUoMCwgMCwgdGhpcy5hdHRhY2tDb2xsaXNpb25DaXJjbGUucmFkaXVzKTtcclxuXHQvLyBkZWJ1Z0NpcmNsZS54ID0gdGhpcy5hdHRhY2tDb2xsaXNpb25DaXJjbGUueDtcclxuXHQvLyBkZWJ1Z0NpcmNsZS55ID0gdGhpcy5hdHRhY2tDb2xsaXNpb25DaXJjbGUueTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZXNldFxyXG4gKi9cclxuT2JqZWN0TWFyc2htYWxsb3cucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnID0gbnVsbDtcclxuXHJcblx0dGhpcy5jdXJyZW50QW5pbWF0aW9uID0gXCJcIjtcclxuXHJcblx0dGhpcy52ZWxvY2l0eS5zZXQoMCk7XHJcblx0dGhpcy5ncmF2aXR5ICAgICAgICA9IDA7XHJcblx0dGhpcy5pc0dyb3VuZGVkICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuY29sbGlzaW9uUG9pbnQgPSBudWxsO1xyXG5cclxuXHR0aGlzLmlzSm9iU3RhcnRlZCA9IGZhbHNlO1xyXG5cdHRoaXMuaXNKb2JEb25lICAgID0gZmFsc2U7XHJcblx0dGhpcy50aW1lICAgICAgICAgPSAwO1xyXG59XHJcblxyXG4vKipcclxuICogQ29uZmlndXJlXHJcbiAqIEBwYXJhbSB7TGV2ZWx9IGxldmVsXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcclxuICovXHJcbk9iamVjdE1hcnNobWFsbG93LnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbihsZXZlbCwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgID0gbGV2ZWw7XHJcblx0dGhpcy5hdmF0YXIgID0gbGV2ZWwuYXZhdGFyO1xyXG5cdHRoaXMuY29uZmlnICA9IGNvbmZpZztcclxuXHR0aGlzLmdyYXZpdHkgPSB0aGlzLmF2YXRhci5ncmF2aXR5O1xyXG5cclxuXHQvLyBQb3NpdGlvblxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHR0aGlzLnJvdGF0aW9uID0gdGhpcy5jb25maWcucm90YXRpb24gKiBQSVhJLkRFR19UT19SQUQ7XHJcblxyXG5cdC8vIEFuaW1hdGlvblxyXG5cdHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDAsICdmYWxsX2JvZHknLCB0cnVlLCAwLjIpO1xyXG5cdHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDEsICdmYWxsX2xlZ3MnLCB0cnVlLCAwLjIpO1xyXG5cclxuXHQvLyBQYXJ0aWNsZXNcclxuXHRpZighdGhpcy5zbm93TGFuZFBTKVxyXG5cdHtcclxuXHRcdHRoaXMuc25vd0xhbmRQUyA9IG5ldyBjbG91ZGtpZC5FbWl0dGVyKHRoaXMubGV2ZWwsIFxyXG5cdFx0W1xyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSwgXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAxXCIpLCBcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDJcIiksIFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxyXG5cdFx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9tYXJzaG1hbGxvd19sYW5kXCIpKTtcclxuXHR9XHJcblx0dGhpcy5zbm93TGFuZFBTLmVtaXQgPSBmYWxzZTtcclxuXHJcblx0Ly8gRGVidWdcclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEaXNwb3NlXHJcbiAqL1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuc3RvcExvb3BzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVcclxuICovXHJcbk9iamVjdE1hcnNobWFsbG93LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxuXHQvLyBQYXJ0aWNsZXMgdXBkYXRlXHJcblx0dGhpcy5zbm93TGFuZFBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cclxuXHQvLyBBbmltYXRpb24gdXBkYXRlXHJcblx0dGhpcy5zcGluZS51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0Ly8gQW5pbWF0aW9uXHJcblx0aWYodGhpcy5pc0dyb3VuZGVkICYmICEhdGhpcy5jb2xsaXNpb25Qb2ludCAmJiAhdGhpcy5pc0pvYlN0YXJ0ZWQpXHJcblx0e1xyXG5cdFx0dGhpcy5zZXRCb2R5QW5pbWF0aW9uKCdpZGxlX2JvZHknLCB0cnVlKTtcclxuXHRcdHRoaXMuc2V0TGVnc0FuaW1hdGlvbignaWRsZV9sZWdzJywgdHJ1ZSk7XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5pc0dyb3VuZGVkICYmICEhdGhpcy5jb2xsaXNpb25Qb2ludCAmJiB0aGlzLmlzSm9iU3RhcnRlZCAmJiAhdGhpcy5pc0pvYkRvbmUpXHJcblx0e1xyXG5cdFx0dGhpcy5zZXRCb2R5QW5pbWF0aW9uKCdydW5fZmxhdF9ib2R5JywgdHJ1ZSk7XHJcblx0XHR0aGlzLnNldExlZ3NBbmltYXRpb24oJ3J1bl9mbGF0X2xlZ3MnLCB0cnVlKTtcclxuXHR9XHJcblx0ZWxzZSBpZighdGhpcy5pc0dyb3VuZGVkICYmIHRoaXMudmVsb2NpdHkueSA+IDApXHJcblx0e1xyXG5cdFx0dGhpcy5zZXRCb2R5QW5pbWF0aW9uKCdmYWxsX2JvZHknLCB0cnVlKTtcclxuXHRcdHRoaXMuc2V0TGVnc0FuaW1hdGlvbignZmFsbF9sZWdzJywgdHJ1ZSk7XHJcblx0fVxyXG5cclxuXHQvLyBTcGVlZFxyXG5cdGlmKHRoaXMuaXNKb2JEb25lIHx8ICF0aGlzLmlzSm9iU3RhcnRlZClcclxuXHRcdHRoaXMudmVsb2NpdHkueCA9IDA7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy52ZWxvY2l0eS54ID0gdGhpcy5hdmF0YXIudmVsb2NpdHkueDtcclxuXHJcblx0Ly8gR3Jhdml0eVxyXG5cdHRoaXMudmVsb2NpdHkueSArPSB0aGlzLmdyYXZpdHkgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0aWYodGhpcy52ZWxvY2l0eS55ID49IHRoaXMuZ3Jhdml0eS8yKSB0aGlzLnZlbG9jaXR5LnkgPSB0aGlzLmdyYXZpdHkvMjtcclxuXHJcblx0Ly8gUm90YXRpb24gdXBkYXRlXHJcblx0Ly8gdmFyIGFuZ2xlRGlmZiA9IE1hdGguYXRhbjIoTWF0aC5zaW4odGhpcy5hbmdsZVRhcmdldCAtIHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uKSwgTWF0aC5jb3ModGhpcy5hbmdsZVRhcmdldCAtIHRoaXMuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uKSk7XHJcblx0Ly8gdGhpcy5hbmltYXRpb25Ib2xkZXIucm90YXRpb24gPSB0aGlzLmFuaW1hdGlvbkhvbGRlci5yb3RhdGlvbiArIChhbmdsZURpZmYgKiAwLjAxKTtcclxuXHJcblx0Ly8gTW92ZW1lbnRcclxuXHR2YXIgd2FzR3JvdW5kZWQgPSB0aGlzLmlzR3JvdW5kZWQ7XHJcblx0dGhpcy5tb3ZlKHRoaXMudmVsb2NpdHkpO1xyXG5cclxuXHQvLyBVbmRvIGdyYXZpdHkgd2hlbiB0b3VjaGluZyBncm91bmRcclxuXHRpZih0aGlzLmlzR3JvdW5kZWQpXHJcblx0e1xyXG5cdFx0dGhpcy52ZWxvY2l0eS55ID0gMDtcclxuXHJcblx0XHRpZighd2FzR3JvdW5kZWQgJiYgIXRoaXMuaXNEZWFkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmxhbmQoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIFdoZW4gY2xvc2UgdG8gdGhlIGNoYXJhY3RlciBzdGFydHMgd2Fsa2luZ1xyXG5cdGlmKCF0aGlzLmlzSm9iU3RhcnRlZClcclxuXHR7XHJcblx0XHQvLyB2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5wb3codGhpcy54IC0gdGhpcy5hdmF0YXIueCwgMikgKyBNYXRoLnBvdyh0aGlzLnkgLSB0aGlzLmF2YXRhci55LCAyKSk7XHJcblx0XHR2YXIgZGlzdGFuY2UgPSBNYXRoLmFicyh0aGlzLnggLSB0aGlzLmF2YXRhci54KTtcclxuXHRcdGlmKGRpc3RhbmNlIDwgMzUwKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmlzSm9iU3RhcnRlZCA9IHRydWU7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBHb2FsczogbWFyc2htYWxsb3dcclxuXHRcdFx0Q29tbW9uLmdvYWxzTWFuYWdlci50cmFja0V2ZW50KFwibWFyc2htYWxsb3dcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8vIFdoZW4gdGhlIHRpbWVyIGVuZHMgb3IgdGhlIGNoYXJhY3RlciBkaWVzLCBzdG9wXHJcblx0ZWxzZSBpZighdGhpcy5pc0pvYkRvbmUpXHJcblx0e1xyXG5cdFx0dGhpcy50aW1lICs9IHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdGlmKHRoaXMudGltZSA+PSB0aGlzLnRpbWVFbmQgfHwgdGhpcy5hdmF0YXIuaXNEZWFkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnN0b3AoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHZhciBhdHRhY2sgPSBmYWxzZTtcclxuXHRpZih0aGlzLmlzQXR0YWNraW5nKVxyXG5cdHtcclxuXHRcdHRoaXMuYXR0YWNrVGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHRpZih0aGlzLmF0dGFja1RpbWUgPiB0aGlzLmF0dGFja1RpbWVFbmQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuYXR0YWNrVGltZSA9IDA7XHJcblx0XHRcdHRoaXMuaXNBdHRhY2tpbmcgPSBmYWxzZTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYodGhpcy5hdHRhY2tUaW1lID4gdGhpcy5hdHRhY2tDb2xsaXNpb25UaW1lICYmIHRoaXMuYXR0YWNrVGltZS1wMy5UaW1lc3RlcC5kZWx0YVRpbWUgPD0gdGhpcy5hdHRhY2tDb2xsaXNpb25UaW1lKSBhdHRhY2sgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0Ly8gQ29sbGlzaW9ucyB3aXRoIG9iamVjdHNcclxuXHR0aGlzLmNvbGxpc2lvbnMoYXR0YWNrKTtcclxuXHRcclxuXHQvLyBBdWRpb1xyXG5cdGlmKHRoaXMuaXNKb2JTdGFydGVkICYmICF0aGlzLmlzSm9iRG9uZSAmJiB0aGlzLmlzR3JvdW5kZWQpXHJcblx0XHR0aGlzLnBsYXlMb29wKFwic2Z4X21hcnNobWFsbG93X21vdmVfMDBcIik7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5zdG9wTG9vcHMoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBjb2xsaXNpb25zIHdpdGggb2JqZWN0c1xyXG4gKiBAcGFyYW0ge0Jvb2x9IGF0dGFja1xyXG4gKi9cclxuT2JqZWN0TWFyc2htYWxsb3cucHJvdG90eXBlLmNvbGxpc2lvbnMgPSBmdW5jdGlvbihhdHRhY2spXHJcbntcclxuXHQvLyBDaGVjayBpZiBlbmVtaWVzIG5lYXJieSB0byBhdHRhY2tcclxuXHRpZih0aGlzLmlzSm9iU3RhcnRlZCAmJiAhdGhpcy5pc0pvYkRvbmUgJiYgIXRoaXMuaXNBdHRhY2tpbmcpXHJcblx0e1xyXG5cdFx0Ly8gU25vd2JhbGxzXHJcblx0XHR2YXIgc25vd2JhbGxzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJzbm93YmFsbFwiKTtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc25vd2JhbGxzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZihzbm93YmFsbHNbaV0ueCA8IHRoaXMueCkgICBjb250aW51ZTtcclxuXHRcdFx0aWYoIXNub3diYWxsc1tpXS5pbnRlcmFjdGl2ZSkgY29udGludWU7XHJcblx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdyh0aGlzLnggLSBzbm93YmFsbHNbaV0ueCwgMiksIE1hdGgucG93KHRoaXMueSAtIHNub3diYWxsc1tpXS55LCAyKSk7XHJcblxyXG5cdFx0XHRpZihkaXN0YW5jZSA8IDcwMClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuaXNBdHRhY2tpbmcgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMuc2V0Qm9keUFuaW1hdGlvbigncnVuX2ZsYXRfYm9keV9zd2lwZScsIGZhbHNlKTtcclxuXHRcdFx0XHRTb3VuZFNGWC5wbGF5KFwic2Z4X21hcnNobWFsbG93X2dydW50XzAwXCIpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBBdHRhY2tcclxuXHRpZihhdHRhY2spXHJcblx0e1xyXG5cdFx0dmFyIGF0dGFja0NvbGxpc2lvbkNpcmNsZSA9IG5ldyBQSVhJLkNpcmNsZSh0aGlzLnggKyB0aGlzLmF0dGFja0NvbGxpc2lvbkNpcmNsZS54LCAgdGhpcy55ICsgdGhpcy5hdHRhY2tDb2xsaXNpb25DaXJjbGUueSwgIHRoaXMuYXR0YWNrQ29sbGlzaW9uQ2lyY2xlLnJhZGl1cyk7XHJcblxyXG5cdFx0Ly8gU25vd2JhbGxzXHJcblx0XHR2YXIgc25vd2JhbGxzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJzbm93YmFsbFwiKTtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc25vd2JhbGxzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighc25vd2JhbGxzW2ldLmludGVyYWN0aXZlKSBjb250aW51ZTtcclxuXHJcblx0XHRcdGlmKHRoaXMuY2hlY2tDb2xsaXNpb24oYXR0YWNrQ29sbGlzaW9uQ2lyY2xlLCBzbm93YmFsbHNbaV0pKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0c25vd2JhbGxzW2ldLmRlc3Ryb3kodHJ1ZSlcclxuXHRcdFx0XHR0aGlzLmxldmVsLnNoYWtlKDAuNCwgbmV3IFBJWEkuUG9pbnQoOCwxMikpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKlxyXG5cdHZhciBvYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSA9IG5ldyBQSVhJLkNpcmNsZSh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54LCAgdGhpcy55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUueSwgICAgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKTtcclxuXHJcblx0Ly8gT2JzdGFjbGVzXHJcblx0dmFyIG9ic3RhY2xlcyA9IHRoaXMubGV2ZWwub2JqZWN0TWFuYWdlci5nZXRPYmplY3RzT2ZUeXBlKFwib2JzdGFjbGVcIik7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBvYnN0YWNsZXMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0aWYoIW9ic3RhY2xlc1tpXS5pbnRlcmFjdGl2ZSkgY29udGludWU7XHJcblx0XHRpZih0aGlzLmNoZWNrQ29sbGlzaW9uKG9ic3RhY2xlQ29sbGlzaW9uQ2lyY2xlLCBvYnN0YWNsZXNbaV0pKVxyXG5cdFx0e1xyXG5cdFx0XHRvYnN0YWNsZXNbaV0uaGl0KHRoaXMpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBQbGF0Zm9ybXNcclxuXHR2YXIganVtcF9wbGF0Zm9ybXMgPSB0aGlzLmxldmVsLm9iamVjdE1hbmFnZXIuZ2V0T2JqZWN0c09mVHlwZShcImp1bXBfcGxhdGZvcm1cIik7XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBqdW1wX3BsYXRmb3Jtcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHRpZighanVtcF9wbGF0Zm9ybXNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0aWYodGhpcy5jaGVja0NvbGxpc2lvbihvYnN0YWNsZUNvbGxpc2lvbkNpcmNsZSwganVtcF9wbGF0Zm9ybXNbaV0pKVxyXG5cdFx0e1xyXG5cdFx0XHRqdW1wX3BsYXRmb3Jtc1tpXS5oaXQodGhpcylcclxuXHRcdH1cclxuXHR9Ki9cclxufVxyXG5cclxuLyoqXHJcbiAqIExhbmRcclxuICovXHJcbk9iamVjdE1hcnNobWFsbG93LnByb3RvdHlwZS5sYW5kID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5zZXRCb2R5QW5pbWF0aW9uKCdsYW5kX2JvZHknLCBmYWxzZSk7XHJcblx0dGhpcy5zZXRMZWdzQW5pbWF0aW9uKCdsYW5kX2xlZ3MnLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwuc2hha2UoMC44LCBuZXcgUElYSS5Qb2ludCgxNiwzMCkpO1xyXG5cclxuXHR0aGlzLnNub3dMYW5kUFMudXBkYXRlU3Bhd25Qb3ModGhpcy54LCB0aGlzLnkgKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgLSAxMCk7XHJcblx0dGhpcy5zbm93TGFuZFBTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X21hcnNobWFsbG93X2ZhbGxfMDBcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdG9wXHJcbiAqL1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuaXNKb2JEb25lKSByZXR1cm47XHJcblxyXG5cdHRoaXMuaXNKb2JEb25lID0gdHJ1ZTtcclxuXHJcblx0dGhpcy5zZXRCb2R5QW5pbWF0aW9uKCdlbmRfd2F2ZScsIHRydWUpO1xyXG5cdHRoaXMuc2V0TGVnc0FuaW1hdGlvbignaWRsZV9sZWdzJywgZmFsc2UpO1xyXG5cclxuXHR0aGlzLnN0b3BMb29wcygpO1xyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfbWFyc2htYWxsb3dfZW5kXzAwXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogSGl0XHJcbiAqIEBwYXJhbSB7R2FtZU9iamVjdH0gdGFyZ2V0XHJcbiAqL1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUuaGl0ID0gZnVuY3Rpb24odGFyZ2V0KVxyXG57XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0IHRoZSBhbmltYXRpb24gZm9yIHRoZSBib2R5XHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBpZFxyXG4gKiBAcGFyYW0ge0Jvb2x9IGxvb3BcclxuICovXHJcbk9iamVjdE1hcnNobWFsbG93LnByb3RvdHlwZS5zZXRCb2R5QW5pbWF0aW9uID0gZnVuY3Rpb24oaWQsIGxvb3ApXHJcbntcclxuXHRpZihsb29wICYmIGlkID09IHRoaXMuY3VycmVudEJvZHlBbmltYXRpb24pIHJldHVybjtcclxuXHJcblx0aWYoaWQgPT0gJycpXHJcblx0XHR0aGlzLnNwaW5lLnN0YXRlLmNsZWFyVHJhY2soMSk7XHJcblx0ZWxzZSBpZih0aGlzLmN1cnJlbnRCb2R5QW5pbWF0aW9uID09IFwibGFuZF9ib2R5XCIpIC8vIERlbGF5cyBhbmltYXRpb24gYWZ0ZXIgbGFuZGluZ1xyXG5cdFx0dGhpcy5zcGluZS5zdGF0ZS5hZGRBbmltYXRpb25CeU5hbWUoMSwgaWQsIGxvb3AsIDAuMik7XHJcblx0ZWxzZSBpZih0aGlzLmN1cnJlbnRCb2R5QW5pbWF0aW9uID09IFwicnVuX2ZsYXRfYm9keV9zd2lwZVwiKSAvLyBEZWxheXMgYW5pbWF0aW9uIGFmdGVyIGF0dGFja2luZ1xyXG5cdFx0dGhpcy5zcGluZS5zdGF0ZS5hZGRBbmltYXRpb25CeU5hbWUoMSwgaWQsIGxvb3AsIDAuNyk7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5zcGluZS5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMSwgaWQsIGxvb3AsIDApO1xyXG5cclxuXHR0aGlzLmN1cnJlbnRCb2R5QW5pbWF0aW9uID0gaWQ7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogU2V0IHRoZSBhbmltYXRpb24gZm9yIHRoZSBsZWdzXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBpZFxyXG4gKiBAcGFyYW0ge0Jvb2x9IGxvb3BcclxuICovXHJcbk9iamVjdE1hcnNobWFsbG93LnByb3RvdHlwZS5zZXRMZWdzQW5pbWF0aW9uID0gZnVuY3Rpb24oaWQsIGxvb3ApXHJcbntcclxuXHRpZihsb29wICYmIGlkID09IHRoaXMuY3VycmVudExlZ3NBbmltYXRpb24pIHJldHVybjtcclxuXHJcblx0aWYoaWQgPT0gJycpXHJcblx0XHR0aGlzLnNwaW5lLnN0YXRlLmNsZWFyVHJhY2soMCk7XHJcblx0ZWxzZSBpZih0aGlzLmN1cnJlbnRMZWdzQW5pbWF0aW9uID09IFwibGFuZF9sZWdzXCIpIC8vIERlbGF5cyBhbmltYXRpb24gYWZ0ZXIgbGFuZGluZ1xyXG5cdFx0dGhpcy5zcGluZS5zdGF0ZS5hZGRBbmltYXRpb25CeU5hbWUoMCwgaWQsIGxvb3AsIDAuMik7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5zcGluZS5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMCwgaWQsIGxvb3AsIDApO1xyXG5cclxuXHR0aGlzLmN1cnJlbnRMZWdzQW5pbWF0aW9uID0gaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdG9wIHRoZSBjdXJyZW50IGxvb3BzXHJcbiAqL1xyXG5PYmplY3RNYXJzaG1hbGxvdy5wcm90b3R5cGUuc3RvcExvb3BzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy53YWxrTG9vcCAhPSBcIlwiKVxyXG5cdHtcdFx0XHJcblx0XHRTb3VuZFNGWC5zdG9wKHRoaXMud2Fsa0xvb3ApO1xyXG5cdFx0dGhpcy53YWxrTG9vcCA9IFwiXCI7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogU3RvcCB0aGUgY3VycmVudCBsb29wIGFuZCBwbGF5IGEgbmV3IG9uZSwgaWYgZGlmZmVyZW50XHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBhdWRpb1xyXG4gKi9cclxuT2JqZWN0TWFyc2htYWxsb3cucHJvdG90eXBlLnBsYXlMb29wID0gZnVuY3Rpb24oYXVkaW8pXHJcbntcclxuXHRpZih0aGlzLndhbGtMb29wID09IGF1ZGlvKSByZXR1cm47XHJcblx0XHJcblx0dGhpcy5zdG9wTG9vcHMoKTtcclxuXHR0aGlzLndhbGtMb29wID0gYXVkaW87XHJcblx0U291bmRTRlgucGxheSh0aGlzLndhbGtMb29wLCB7bG9vcDp0cnVlfSk7XHJcbn1cclxuIiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxudmFyIEVtaXR0ZXJcdFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBPYmplY3RPYnN0YWNsZShpY2VCbG9jaywgZXhwbG9kZXMpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJvYnN0YWNsZVwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgICAgPSBudWxsO1xyXG5cdHRoaXMuaWNlQmxvY2sgICAgPSAhIWljZUJsb2NrO1xyXG5cdHRoaXMuZXhwbG9kZXMgICAgPSAhIWV4cGxvZGVzO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0T2JzdGFjbGU7XHJcbk9iamVjdE9ic3RhY2xlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5PYmplY3RPYnN0YWNsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RPYnN0YWNsZTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5PYmplY3RPYnN0YWNsZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGwpXHJcbntcclxuXHRpZih0aGlzLnNwcml0ZSA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKCk7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuc3ByaXRlKTtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbk9iamVjdE9ic3RhY2xlLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG59XHJcblxyXG4vKipcclxuICovXHJcbk9iamVjdE9ic3RhY2xlLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbihsZXZlbCwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBsZXZlbDtcclxuXHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuXHJcblx0dGhpcy54ID0gdGhpcy5jb25maWcucG9zaXRpb24ueDtcclxuXHR0aGlzLnkgPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi55O1xyXG5cdHRoaXMuc3ByaXRlLnRleHR1cmUgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXh0dXJlKTtcclxuXHR0aGlzLnNwcml0ZS5hbmNob3Iuc2V0KHRoaXMuY29uZmlnLmFuY2hvci54LCB0aGlzLmNvbmZpZy5hbmNob3IueSk7XHJcblx0dGhpcy5zcHJpdGUuc2NhbGUgLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LCB0aGlzLmNvbmZpZy5zY2FsZS55KTtcclxuXHR0aGlzLnJvdGF0aW9uID0gdGhpcy5jb25maWcucm90YXRpb24gKiBQSVhJLkRFR19UT19SQUQ7XHJcblxyXG5cdC8vIEluaXQgY29kZVxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgPSB0cnVlO1xyXG5cdHRoaXMuc3ByaXRlLnZpc2libGUgPSB0cnVlO1xyXG5cdHZhciB3aWR0aCAgPSB0aGlzLnNwcml0ZS53aWR0aCAgKiAwLjY7XHJcblx0dmFyIGhlaWdodCA9IHRoaXMuc3ByaXRlLmhlaWdodCAqIDAuNztcclxuXHR0aGlzLmNvbGxpc2lvblJlY3QgPSBuZXcgUElYSS5SZWN0YW5nbGUoLXdpZHRoICogdGhpcy5zcHJpdGUuYW5jaG9yLngsICgtdGhpcy5zcHJpdGUuYW5jaG9yLnkpICogaGVpZ2h0LCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcblx0Ly8gQ3VzdG9tIHNwcml0ZSBjb2xsaWRlcnNcclxuXHRpZih0aGlzLmNvbmZpZy5pZC5tYXRjaCgvY2FycmlhZ2VcXF8oWzAtOV17Mn0pXFxfKFswLTldezJ9KS9pKSlcclxuXHR7XHJcblx0XHR2YXIgd2lkdGggID0gdGhpcy5zcHJpdGUud2lkdGggKiAwLjM7XHJcblx0XHR0aGlzLmNvbGxpc2lvblJlY3QgPSBuZXcgUElYSS5SZWN0YW5nbGUoLXdpZHRoICogdGhpcy5zcHJpdGUuYW5jaG9yLngqMiwgKC10aGlzLnNwcml0ZS5hbmNob3IueSkgKiBoZWlnaHQsIHdpZHRoLCBoZWlnaHQpO1xyXG5cdH1cclxuXHJcblx0Ly8gRXhwbG9zaW9uIGVmZmVjdFxyXG5cdGlmKHRoaXMuZXhwbG9kZXMpXHJcblx0e1xyXG5cdFx0aWYoISF0aGlzLmV4cGxvc2lvblBTKVxyXG5cdFx0XHR0aGlzLmV4cGxvc2lvblBTLmRlc3Ryb3koKTtcclxuXHJcblx0XHR0aGlzLmV4cGxvc2lvblBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcyxcclxuXHRcdFtcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9iYXJyZWxfMFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9iYXJyZWxfMVwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9iYXJyZWxfMlwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9iYXJyZWxfM1wiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtMWR1c3QzXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcIm0xZHVzdDNcIilcclxuXHRcdF0sXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX2JhcnJlbF9leHBsb3Npb25cIikpO1xyXG5cclxuXHRcdHRoaXMuZXhwbG9zaW9uUFMuZW1pdCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5leHBsb3Npb25QUy51cGRhdGVTcGF3blBvcygwLCAtdGhpcy5zcHJpdGUuaGVpZ2h0LzMpO1xyXG5cdH1cclxuXHJcblx0Ly8gRGVzdHJveSBlZmZlY3RcclxuXHRpZighIXRoaXMuZGVzdHJveVBTKVxyXG5cdHtcclxuXHRcdHRoaXMuZGVzdHJveVBTLmRlc3Ryb3koKTtcclxuXHRcdHRoaXMuZGVzdHJveVBTID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdHZhciB0aGVtZSA9IHRoaXMuY29uZmlnLnRleHR1cmUubWF0Y2goL3RoZW1lXFxfKFswLTldezJ9KVxcXyhbYS16MC05XFxfXSspL2kpWzFdO1xyXG5cclxuXHRpZih0aGlzLmljZUJsb2NrKVxyXG5cdHtcclxuXHRcdHRoaXMuZGVzdHJveVBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcyxcclxuXHRcdFtcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ0aGVtZV9cIiArIHRoZW1lICsgXCJfaWNlX2Jsb2NrXzAxXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInRoZW1lX1wiICsgdGhlbWUgKyBcIl9pY2VfYmxvY2tfMDJcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidGhlbWVfXCIgKyB0aGVtZSArIFwiX2ljZV9ibG9ja18wM1wiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ0aGVtZV9cIiArIHRoZW1lICsgXCJfaWNlX2Jsb2NrXzA0XCIpXHJcblx0XHRdLCBcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfaWNlX2V4cGxvc2lvblwiKSk7XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5jb25maWcuaWQubWF0Y2goL2NyYXRlXFxfKFswLTldezJ9KVxcXyhbMC05XXsyfSkvaSkgfHxcclxuXHRcdFx0dGhpcy5jb25maWcuaWQubWF0Y2goL2JhcnJlbFxcXyhbMC05XXsyfSlcXF8oWzAtOV17Mn0pL2kpIHx8XHJcblx0XHRcdHRoaXMuY29uZmlnLmlkLm1hdGNoKC93b29kXFxfKFswLTldezJ9KVxcXyhbMC05XXsyfSkvaSkpXHJcblx0e1xyXG5cdFx0dGhpcy5kZXN0cm95UFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLFxyXG5cdFx0W1xyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3dvb2RfMDBcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfd29vZF8wMVwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV93b29kXzAyXCIpXHJcblx0XHRdLCBcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfaWNlX2V4cGxvc2lvblwiKSk7XHRcdFx0XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5jb25maWcuaWQubWF0Y2goL3Nub3dtYW5cXF8oWzAtOV17Mn0pXFxfKFswLTldezJ9KS9pKSlcclxuXHR7XHJcblx0XHR0aGlzLmRlc3Ryb3lQUyA9IG5ldyBjbG91ZGtpZC5FbWl0dGVyKHRoaXMsXHJcblx0XHRbXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAwXCIpXHJcblx0XHRdLCBcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfaWNlX2V4cGxvc2lvblwiKSk7XHRcclxuXHR9XHJcblx0ZWxzZSBpZih0aGlzLmNvbmZpZy5pZC5tYXRjaCgvc3RvbmVzXFxfKFswLTldezJ9KVxcXyhbMC05XXsyfSkvaSkpXHJcblx0e1xyXG5cdFx0dGhpcy5kZXN0cm95UFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLFxyXG5cdFx0W1xyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3JvY2tfMDBcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfcm9ja18wMVwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9yb2NrXzAyXCIpXHJcblx0XHRdLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9pY2VfZXhwbG9zaW9uXCIpKTtcdFxyXG5cdH1cclxuXHRcdFxyXG5cdGlmKHRoaXMuZGVzdHJveVBTICE9IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5kZXN0cm95UFMuZW1pdCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5kZXN0cm95UFMudXBkYXRlU3Bhd25Qb3MoMCwgLXRoaXMuc3ByaXRlLmhlaWdodC8yKTtcclxuXHR9XHJcblxyXG5cclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuT2JqZWN0T2JzdGFjbGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZighIXRoaXMuZXhwbG9zaW9uUFMpXHJcblx0e1xyXG5cdFx0dGhpcy5leHBsb3Npb25QUy5kZXN0cm95KCk7XHJcblx0XHR0aGlzLmV4cGxvc2lvblBTID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdGlmKCEhdGhpcy5kZXN0cm95UFMpXHJcblx0e1xyXG5cdFx0dGhpcy5kZXN0cm95UFMuZGVzdHJveSgpO1xyXG5cdFx0dGhpcy5kZXN0cm95UFMgPSBudWxsO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqL1xyXG5PYmplY3RPYnN0YWNsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLmV4cGxvc2lvblBTKVxyXG5cdFx0dGhpcy5leHBsb3Npb25QUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0aWYoISF0aGlzLmRlc3Ryb3lQUylcclxuXHRcdHRoaXMuZGVzdHJveVBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5PYmplY3RPYnN0YWNsZS5wcm90b3R5cGUuaGl0ID0gZnVuY3Rpb24odGFyZ2V0KVxyXG57XHJcblx0aWYoIXRoaXMuaW50ZXJhY3RpdmUpIHJldHVybjtcclxuXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuXHRpZih0aGlzLmV4cGxvZGVzKVxyXG5cdHtcclxuXHRcdHRoaXMuc3ByaXRlLnZpc2libGUgPSBmYWxzZTtcclxuXHRcdHRoaXMubGV2ZWwuc2hha2UoMC42LCBuZXcgUElYSS5Qb2ludCg2MCw0MCkpO1xyXG5cdFx0dGhpcy5sZXZlbC5zaG9ja3dhdmUodGhpcywxKTtcclxuXHJcblx0XHR0aGlzLmV4cGxvc2lvblBTLmVtaXQgPSB0cnVlO1xyXG5cdH1cclxuXHRcclxuXHRpZih0aGlzLmljZUJsb2NrKVxyXG5cdFx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X2ljZWJsb2NrX3NtYXNoXzAwXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAxXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAyXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAzXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA0XCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA1XCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA2XCJdKTtcclxuXHRlbHNlXHJcblx0XHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19oaXRfb2JzdGFjbGVfMDBcIl0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5PYmplY3RPYnN0YWNsZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKHNvdXJjZSlcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0aWYoc291cmNlID09IFwiYXhlXCIgJiYgIXRoaXMuaWNlQmxvY2spIHJldHVybjtcclxuXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFxyXG5cdGlmKHRoaXMuZGVzdHJveVBTID09IG51bGwpIHJldHVybjtcclxuXHRcclxuXHR0aGlzLnNwcml0ZS52aXNpYmxlID0gZmFsc2U7XHJcblx0dGhpcy5sZXZlbC5zaGFrZSgwLjQsIG5ldyBQSVhJLlBvaW50KDIwLDEwKSk7XHJcblx0dGhpcy5kZXN0cm95UFMuZW1pdCA9IHRydWU7XHJcblx0XHJcblx0Ly8gRnJlZSBjcnlzdGFscyBmcm9tIHdpdGhpblxyXG5cdGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwia3Jpc3RvZmZcIilcclxuXHR7XHJcblx0XHRpZih0aGlzLmNvbmZpZy5pZC5tYXRjaCgvaWNlYmxvY2tcXF8oWzAtOV17Mn0pXFxfKFswLTldezJ9KS9pKSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGNyeXN0YWxzID0gdGhpcy5sZXZlbC5vYmplY3RNYW5hZ2VyLmdldE9iamVjdHNPZlR5cGUoXCJjcnlzdGFsXCIpO1xyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgY3J5c3RhbHMubGVuZ3RoOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZighY3J5c3RhbHNbaV0uaW50ZXJhY3RpdmUpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGguYWJzKHRoaXMueCAtIGNyeXN0YWxzW2ldLngpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmKGRpc3RhbmNlIDwgNDApXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Y3J5c3RhbHNbaV0uY2FuQmVQaWNrZWRVcCA9IHRydWU7XHJcblx0XHRcdFx0XHRjcnlzdGFsc1tpXS5zcHJpdGUuYWxwaGEgICAgID0gMTtcclxuXHRcdFx0XHRcdGNyeXN0YWxzW2ldLmdsb3cuYWxwaGEgICAgICAgPSAxO1xyXG5cdFx0XHRcdFx0Ly8gY3J5c3RhbHNbaV0ucGlja3VwKHRoaXMuYXZhdGFyKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0c3dpdGNoKHNvdXJjZSlcclxuXHR7XHJcblx0XHRjYXNlIFwiYXhlXCI6XHJcblx0XHRcdFNvdW5kU0ZYLnBsYXlSYW5kb21Gcm9tKFtcInNmeF9rcmlzdG9mZl9zbWFzaF9pY2VfMDBcIiwgXCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzAxXCIsIFwic2Z4X2tyaXN0b2ZmX3NtYXNoX2ljZV8wMlwiLCBcInNmeF9rcmlzdG9mZl9zbWFzaF9pY2VfMDNcIiwgXCJzZnhfa3Jpc3RvZmZfc21hc2hfaWNlXzA0XCIsIFwic2Z4X2tyaXN0b2ZmX3NtYXNoX2ljZV8wNVwiLCBcInNmeF9rcmlzdG9mZl9zbWFzaF9pY2VfMDZcIl0pO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0XHJcblx0XHRjYXNlIFwibWFnaWNcIjpcclxuXHRcdGNhc2UgXCJpbnZ1bG5lcmFiaWxpdHlcIjpcclxuXHRcdFx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X2ljZWJsb2NrX3NtYXNoXzAwXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAxXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAyXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzAzXCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA0XCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA1XCIsIFwic2Z4X2ljZWJsb2NrX3NtYXNoXzA2XCJdKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG59IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxuLy8gdmFyIEVtaXR0ZXIgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0UG93ZXJ1cCgpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJwb3dlcnVwXCIsIGZhbHNlKTtcclxuXHJcblx0dGhpcy5sZXZlbCAgICAgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgICAgICAgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5zcHJpdGUgICAgICAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMudGltZWxpbmUgICAgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmR1cmF0aW9uICAgICAgICAgICA9IDEwO1xyXG5cclxuXHQvLyBQYXJ0aWNsZXNcclxuXHR0aGlzLmZ4UFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV9vZmZzZXRfMDBcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV9vZmZzZXRfMDNcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX3Ryb2xsX21hZ2ljXCIpKTtcclxuXHR0aGlzLmZ4UFMuZW1pdCA9IGZhbHNlO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0UG93ZXJ1cDtcclxuT2JqZWN0UG93ZXJ1cC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0UG93ZXJ1cC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RQb3dlcnVwO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RQb3dlcnVwLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdFBvd2VydXAucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICA9IG51bGw7XHJcblxyXG5cdHRoaXMuZXhwbG9zaW9uVHdlZW4gPSBudWxsO1xyXG5cdGlmKCEhdGhpcy5leHBsb3Npb25Ud2VlbilcclxuXHR7XHJcblx0XHR0aGlzLmV4cGxvc2lvblR3ZWVuLmtpbGwoKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25maWd1cmVcclxuICogQHBhcmFtIHtMZXZlbH0gbGV2ZWxcclxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xyXG4gKi9cclxuT2JqZWN0UG93ZXJ1cC5wcm90b3R5cGUuY29uZmlndXJlID0gZnVuY3Rpb24obGV2ZWwsIGNvbmZpZylcclxue1xyXG5cdHRoaXMubGV2ZWwgID0gbGV2ZWw7XHJcblx0dGhpcy5jb25maWcgPSBjb25maWc7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHJcblx0dGhpcy5zcHJpdGUudGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuY29uZmlnLnRleHR1cmUpO1xyXG5cdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLnNwcml0ZS5zY2FsZS5zZXQoMSk7XHJcblx0dGhpcy5zcHJpdGUucm90YXRpb24gPSAwO1xyXG5cdHRoaXMuc3ByaXRlLnZpc2libGUgPSB0cnVlO1xyXG5cdHRoaXMuc3ByaXRlLmJsZW5kTW9kZSA9IFBJWEkuQkxFTkRfTU9ERVMuU0NSRUVOO1xyXG5cclxuXHQvLyBJbml0IGNvZGVcclxuXHR0aGlzLmludGVyYWN0aXZlICAgICAgPSB0cnVlO1xyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuQ2lyY2xlKDAsIDAsIDcwKTtcclxuXHJcblx0Ly8gUGFydGljbGVzXHJcblx0dGhpcy5meFBTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHQvLyBBbmltYXRpb25cclxuXHRpZighIXRoaXMudGltZWxpbmUpXHJcblx0XHR0aGlzLnRpbWVsaW5lLmtpbGwoKTtcclxuXHJcblx0dGhpcy50aW1lbGluZSA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy50aW1lbGluZS50byh0aGlzLnNwcml0ZS5zY2FsZSwgMC41LCB7eDogMS4zLCB5OiAxLjMsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgIDApO1xyXG5cdFx0dGhpcy50aW1lbGluZS50byh0aGlzLnNwcml0ZSwgMC43NSwge3JvdGF0aW9uOiAzNjAgKiBQSVhJLkRFR19UT19SQUQsIGVhc2U6TGluZWFyLmVhc2VOb25lLCByZXBlYXQ6LTF9LCAgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLnRpbWVsaW5lKTtcclxuXHJcblx0Ly8gRGVidWdcclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEaXNwb3NlXHJcbiAqL1xyXG5PYmplY3RQb3dlcnVwLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLnRpbWVsaW5lKVxyXG5cdFx0dGhpcy50aW1lbGluZS5raWxsKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVcclxuICovXHJcbk9iamVjdFBvd2VydXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIFBhcnRpY2xlcyB1cGRhdGVcclxuXHR0aGlzLmZ4UFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcbn07XHJcblxyXG4vKipcclxuICogQW4gZW50aXR5IGhhcyBwaWNrZWQgdXAgdGhlIGNvaW5cclxuICogQHBhcmFtIHtHYW1lT2JqZWN0fSB0YXJnZXRcclxuICovXHJcbk9iamVjdFBvd2VydXAucHJvdG90eXBlLnBpY2t1cCA9IGZ1bmN0aW9uKHRhcmdldClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgICA9IGZhbHNlO1xyXG5cdHRoaXMuZnhQUy5lbWl0ICAgICAgICA9IGZhbHNlO1xyXG5cclxuXHRpZighIXRoaXMudGltZWxpbmUpXHJcblx0XHR0aGlzLnRpbWVsaW5lLmtpbGwoKTtcclxuXHRcclxuXHR0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuc3ByaXRlLnNjYWxlLCAwLjI1LCB7eDogMCwgeTogMCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sICAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMudGltZWxpbmUpO1x0XHJcblx0XHJcblx0cmV0dXJuIHRydWU7XHJcbn07IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxudmFyIEVtaXR0ZXJcdFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBPYmplY3RTaHJpbmtMb2NrKGFyZ3MpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJzaHJpbmtfbG9ja1wiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICA9IG51bGw7XHJcblx0dGhpcy5sb2NrICAgICAgICAgPSBhcmdzO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0U2hyaW5rTG9jaztcclxuT2JqZWN0U2hyaW5rTG9jay5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0U2hyaW5rTG9jay5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RTaHJpbmtMb2NrO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RTaHJpbmtMb2NrLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcHJpdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdFNocmlua0xvY2sucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICA9IG51bGw7XHJcbn1cclxuXHJcbk9iamVjdFNocmlua0xvY2sucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHR0aGlzLmxldmVsICA9IGxldmVsO1xyXG5cdHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG5cclxuXHR0aGlzLnggPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi54O1xyXG5cdHRoaXMueSA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLnk7XHJcblx0dGhpcy5zcHJpdGUudGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuY29uZmlnLnRleHR1cmUpO1xyXG5cdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQodGhpcy5jb25maWcuYW5jaG9yLngsIHRoaXMuY29uZmlnLmFuY2hvci55KTtcclxuXHR0aGlzLnNwcml0ZS5zY2FsZSAuc2V0KHRoaXMuY29uZmlnLnNjYWxlLngsIHRoaXMuY29uZmlnLnNjYWxlLnkpO1xyXG5cdHRoaXMucm90YXRpb24gPSB0aGlzLmNvbmZpZy5yb3RhdGlvbiAqIFBJWEkuREVHX1RPX1JBRDtcclxuXHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgICA9IHRydWU7XHJcblx0dmFyIHdpZHRoICA9IHRoaXMuc3ByaXRlLndpZHRoO1xyXG5cdHZhciBoZWlnaHQgPSB0aGlzLnNwcml0ZS5oZWlnaHQ7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSA9IHRoaXMubGV2ZWwuZGVidWc7XHJcblx0dGhpcy5jb2xsaXNpb25SZWN0ID0gbmV3IFBJWEkuUmVjdGFuZ2xlKC13aWR0aCAqIHRoaXMuc3ByaXRlLmFuY2hvci54LCAoLXRoaXMuc3ByaXRlLmFuY2hvci55KSAqIGhlaWdodCwgd2lkdGgsIGhlaWdodCk7XHJcbn1cclxuXHJcbk9iamVjdFNocmlua0xvY2sucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdFNocmlua0xvY2sucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufTtcclxuXHJcbk9iamVjdFNocmlua0xvY2sucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKGF2YXRhcilcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuXHRpZihhdmF0YXIuaXNTaHJpbmtpbmcpXHJcblx0e1xyXG5cdFx0aWYodGhpcy5sb2NrKVxyXG5cdFx0e1xyXG5cdFx0XHRhdmF0YXIuaXNTaHJpbmtMb2NrZWQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZighdGhpcy5sb2NrICYmIGF2YXRhci5pc1Nocmlua0xvY2tlZClcclxuXHRcdHtcclxuXHRcdFx0YXZhdGFyLnBvd2VyVW5zaHJpbmsoKTtcclxuXHRcdH1cclxuXHR9XHJcbn07IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxudmFyIEVtaXR0ZXJcdFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBPYmplY3RTbGVkKClcclxue1xyXG5cdEdhbWVPYmplY3QuY2FsbCh0aGlzLCBcInNsZWRcIiwgZmFsc2UpO1xyXG5cclxuXHR0aGlzLnJlbW92ZVdoZW5PdXRzaWRlID0gdHJ1ZTtcclxuXHJcblx0dGhpcy5sZXZlbCAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmF2YXRhciAgICAgICA9IG51bGw7XHJcblxyXG5cdHRoaXMuc3BpbmUgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLnRpbWUgICAgICAgICA9IDA7XHJcblx0dGhpcy50aW1lTWF4ICAgICAgPSAxNTtcclxuXHR0aGlzLm9sZFBhcmVudCAgICA9IG51bGw7XHJcblx0dGhpcy5zcGVlZEJvb3N0ICAgPSA0MDA7XHJcblx0dGhpcy5tYWduZXRCb29zdCAgPSAxLjI1O1xyXG5cdHRoaXMuanVtcFNwZWVkICAgID0gLTE1MDA7XHJcblxyXG5cdHRoaXMubW91bnRUd2VlbiAgICAgPSBudWxsO1xyXG5cdHRoaXMubW91bnRTcGluZVggICAgPSAwO1xyXG5cdHRoaXMubW91bnRTcGluZVkgICAgPSAwO1xyXG5cdHRoaXMubW91bnRTcGluZVRpbWUgPSAwLjY7XHJcblx0dGhpcy5tb3VudFNwaW5lUGVyYyA9IDA7XHJcblxyXG5cdHRoaXMuZmFkZVRpbWUgPSAwLjc1O1xyXG5cdHRoaXMuaXNGYWRpbmcgPSBmYWxzZTtcclxuXHJcblx0dGhpcy5yaWRlckFuaW1hdGlvbiAgICAgPSBcInJpZGVfc2xlZF9kb3duXCI7XHJcblx0dGhpcy5yaWRlckZhbGxBbmltYXRpb24gPSBcInJpZGVfc2xlZFwiO1xyXG5cclxuXHQvLyBQYXJ0aWNsZXNcclxuXHQvLyB0aGlzLmZ4UFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLFxyXG5cdC8vIFtcclxuXHRcdC8vIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc3BhcmtsZV9vZmZzZXRfMDJcIiksXHJcblx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAzXCIpXHJcblx0Ly8gXSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9zbGVkX3NoaW5lXCIpKTtcclxuXHQvLyB0aGlzLmZ4UFMuZW1pdCA9IGZhbHNlO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0U2xlZDtcclxuT2JqZWN0U2xlZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0U2xlZC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RTbGVkO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RTbGVkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuZ2xvdyA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuZ2xvdyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9jcnlzdGFsX2dsb3dcIikpO1xyXG5cdFx0dGhpcy5nbG93LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuZ2xvdy5wb3NpdGlvbi5zZXQoMCwgLTIwKTtcclxuXHRcdHRoaXMuZ2xvdy50aW50ID0gMHhmZmY0OTU7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuZ2xvdyk7XHJcblx0fVxyXG5cdFxyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHR9XHJcblxyXG5cdC8vIEluaXQgc3BpbmUgYW5pbWF0aW9uXHJcblx0aWYodGhpcy5zcGluZSA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuc3BpbmVEYXRhID0gQ29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9zbGVkO1xyXG5cdFx0dGhpcy5zcGluZSA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKHRoaXMuc3BpbmVEYXRhKTtcclxuXHRcdC8vIHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0VG9TZXR1cFBvc2UoKTtcclxuXHRcdC8vIHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbihudWxsKTtcclxuXHRcdC8vIHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbkJ5TmFtZShcInNsZWRcIik7XHJcblx0XHR0aGlzLnNwaW5lLmF1dG9VcGRhdGUgPSBmYWxzZTtcclxuXHRcdHRoaXMuc3BpbmUuc2NhbGUuc2V0KDAuNSk7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuc3BpbmUpO1xyXG5cclxuXHRcdHZhciBhbmltYXRpb25zID1cclxuXHRcdFtcclxuXHRcdF07XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGFuaW1hdGlvbnMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBhbmltYXRpb25zLmxlbmd0aDsgaisrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYoaSA9PSBqKSBjb250aW51ZTtcclxuXHJcblx0XHRcdFx0dGhpcy5zcGluZS5zdGF0ZURhdGEuc2V0TWl4QnlOYW1lKGFuaW1hdGlvbnNbaV0sIGFuaW1hdGlvbnNbal0sIDAuMik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIHRoaXMuZnhQUy5lbWl0ID0gdHJ1ZTtcclxufTtcclxuXHJcbk9iamVjdFNsZWQucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICA9IG51bGw7XHJcblxyXG5cdHRoaXMuY3VycmVudEFuaW1hdGlvbiA9IFwiXCI7XHJcblx0dGhpcy50aW1lID0gMDtcclxufVxyXG5cclxuT2JqZWN0U2xlZC5wcm90b3R5cGUuY29uZmlndXJlID0gZnVuY3Rpb24obGV2ZWwsIGNvbmZpZylcclxue1xyXG5cdHRoaXMubGV2ZWwgID0gbGV2ZWw7XHJcblx0dGhpcy5jb25maWcgPSBjb25maWc7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHR0aGlzLnNwcml0ZS50ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4dHVyZSk7XHJcblx0dGhpcy5zcHJpdGUuYW5jaG9yLnNldCh0aGlzLmNvbmZpZy5hbmNob3IueCwgdGhpcy5jb25maWcuYW5jaG9yLnkpO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LzIsIHRoaXMuY29uZmlnLnNjYWxlLnkvMik7XHJcblx0dGhpcy5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cclxuXHR0aGlzLmdsb3cucm90YXRpb24gPSAwO1xyXG5cdHRoaXMuZ2xvdy5zY2FsZS5zZXQoMSk7XHJcblx0dGhpcy5nbG93LnZpc2libGUgPSB0cnVlO1xyXG5cdHRoaXMuZ2xvdy5hbHBoYSA9IDE7XHRcclxuXHRcclxuXHQvLyBJbml0IGFuaW1hdGlvblxyXG5cdC8vIHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDAsICdpZGxlJywgdHJ1ZSwgMC4yKTtcclxuXHR0aGlzLmFscGhhID0gMTtcclxuXHR0aGlzLmlzRmFkaW5nID0gZmFsc2U7XHJcblxyXG5cdC8vIEluaXQgY29kZVxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgPSB0cnVlO1xyXG5cdHRoaXMuc3ByaXRlLnZpc2libGUgPSBmYWxzZTtcclxuXHR2YXIgd2lkdGggID0gdGhpcy5zcHJpdGUud2lkdGg7XHJcblx0dmFyIGhlaWdodCA9IHRoaXMuc3ByaXRlLmhlaWdodDtcclxuXHR0aGlzLmNvbGxpc2lvblJlY3QgPSBuZXcgUElYSS5SZWN0YW5nbGUoMjAsICgtdGhpcy5zcHJpdGUuYW5jaG9yLnkpICogaGVpZ2h0LCAyMCwgaGVpZ2h0KTtcclxuXHJcblx0Ly8gRGVidWdcclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcblx0XHJcblx0Ly8gQW5pbWF0aW9uXHJcblx0dGhpcy50aW1lbGluZSA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGhpcy50aW1lbGluZS50byh0aGlzLmdsb3csIDgsIHtyb3RhdGlvbjogTWF0aC5QSSAqIDIsIGVhc2U6TGluZWFyLmVhc2VOb25lLCByZXBlYXQ6LTF9LCAgMCk7XHJcblx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuZ2xvdy5zY2FsZSwgMC41LCB7eDogMS41LCB5OiAxLjUsIGVhc2U6UXVhZC5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgIDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy50aW1lbGluZSk7XHJcblxyXG59XHJcblxyXG5PYmplY3RTbGVkLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gdGhpcy5meFBTLmVtaXQgPSBmYWxzZTtcclxuXHRcclxuXHRpZighIXRoaXMudGltZWxpbmUpXHJcblx0e1xyXG5cdFx0dGhpcy50aW1lbGluZS5raWxsKCk7XHJcblx0XHR0aGlzLnRpbWVsaW5lID0gbnVsbDtcclxuXHR9XHRcclxufVxyXG5cclxuT2JqZWN0U2xlZC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gUGFydGljbGVzIHVwZGF0ZVxyXG5cdC8vIHRoaXMuZnhQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0Ly8gQW5pbWF0aW9uIHVwZGF0ZVxyXG5cdHRoaXMuc3BpbmUudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcblxyXG5cdC8vIE1vdW50IHVwZGF0ZVxyXG5cdGlmKHRoaXMuYXZhdGFyKVxyXG5cdHtcclxuXHRcdC8vIEF1dG9tYXRpYyBkaXNtb3V0IGNvdW50ZG93blxyXG5cdFx0Ly8gdGhpcy50aW1lICs9IHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHJcblx0XHQvLyBpZih0aGlzLnRpbWUgPj0gdGhpcy50aW1lTWF4ICYmIHRoaXMuYXZhdGFyLmlzR3JvdW5kZWQpXHJcblx0XHQvLyB7XHJcblx0XHRcdC8vIHRoaXMuZGlzbW91bnQoKTtcclxuXHRcdC8vIH1cclxuXHRcdGlmKHRoaXMuYXZhdGFyLmlzR3JvdW5kZWQgJiYgdGhpcy5hdmF0YXIuY29sbGlzaW9uUG9pbnQuYW5nbGUgPCAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmRpc21vdW50KCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdGlmKHRoaXMubW91bnRTcGluZVBlcmMgPCAxKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gVHdlZW4gdGhlIG1vdW50aW5nXHJcblx0XHRcdFx0dGhpcy5hdmF0YXIuc3BpbmUueCA9IHRoaXMubW91bnRTcGluZVggKyAoKHRoaXMuc3BpbmVSaWRlckxvY2sud29ybGRYICogdGhpcy5zcGluZS5zY2FsZS54KS10aGlzLm1vdW50U3BpbmVYKSAqIHRoaXMubW91bnRTcGluZVBlcmM7XHJcblx0XHRcdFx0dGhpcy5hdmF0YXIuc3BpbmUueSA9IHRoaXMubW91bnRTcGluZVkgKyAoKHRoaXMuc3BpbmVSaWRlckxvY2sud29ybGRZICogdGhpcy5zcGluZS5zY2FsZS55ICsgdGhpcy5hdmF0YXIuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyktdGhpcy5tb3VudFNwaW5lWSkqIHRoaXMubW91bnRTcGluZVBlcmM7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBtb3VudCBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMuYXZhdGFyLnNwaW5lLnggPSB0aGlzLnNwaW5lUmlkZXJMb2NrLndvcmxkWCAqIHRoaXMuc3BpbmUuc2NhbGUueDtcclxuXHRcdFx0XHR0aGlzLmF2YXRhci5zcGluZS55ID0gdGhpcy5zcGluZVJpZGVyTG9jay53b3JsZFkgKiB0aGlzLnNwaW5lLnNjYWxlLnkgKyB0aGlzLmF2YXRhci5jb2xsaXNpb25DaXJjbGUucmFkaXVzO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZighdGhpcy5hdmF0YXIuaXNHcm91bmRlZClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuYXZhdGFyLmFuZ2xlU3BlZWQgPSAwLjA1O1xyXG5cdFx0XHRcdGlmKHRoaXMuYXZhdGFyLnZlbG9jaXR5LnkgPCA1MClcclxuXHRcdFx0XHRcdHRoaXMuYXZhdGFyLmFuZ2xlVGFyZ2V0ID0gLTIwICogUElYSS5ERUdfVE9fUkFEO1xyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdHRoaXMuYXZhdGFyLmFuZ2xlVGFyZ2V0ID0gKzIwICogUElYSS5ERUdfVE9fUkFEO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuYXZhdGFyLmFuZ2xlU3BlZWQgPSAwLjE7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblx0fVxyXG5cdC8vIEZhZGUgb3V0XHJcblx0ZWxzZSBpZih0aGlzLmlzRmFkaW5nKVxyXG5cdHtcclxuXHRcdHRoaXMuYWxwaGEgLT0gcDMuVGltZXN0ZXAuZGVsdGFUaW1lL3RoaXMuZmFkZVRpbWU7XHJcblx0XHRpZih0aGlzLmFscGhhIDwgMClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5hbHBoYSA9IDA7XHJcblx0XHRcdHRoaXMuaXNGYWRpbmcgPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5PYmplY3RTbGVkLnByb3RvdHlwZS5oaXQgPSBmdW5jdGlvbih0YXJnZXQpXHJcbntcclxuXHRpZighdGhpcy5pbnRlcmFjdGl2ZSkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XHJcblx0dGhpcy5tb3VudCh0YXJnZXQpO1xyXG59O1xyXG5cclxuT2JqZWN0U2xlZC5wcm90b3R5cGUubW91bnQgPSBmdW5jdGlvbihhdmF0YXIpXHJcbntcclxuXHR0aGlzLnJlbW92ZVdoZW5PdXRzaWRlID0gZmFsc2U7XHJcblxyXG5cdC8vIFNhdmUgYSByZWZlcmVuY2Ugb2YgdGhlIGxheWVyXHJcblx0dGhpcy5vbGRQYXJlbnQgPSB0aGlzLnBhcmVudDtcclxuXHJcblx0Ly8gTWFrZSB0aGUgY2hhcmFjdGVyIHJpZGluZyB0aGUgdmVoaWNsZVxyXG5cdHRoaXMuYXZhdGFyID0gYXZhdGFyO1xyXG5cdHRoaXMuYXZhdGFyLnZlaGljbGUgPSB0aGlzO1xyXG5cdHRoaXMuYXZhdGFyLmlzUmlkaW5nVmVoaWNsZSA9IHRydWU7XHJcblxyXG5cdC8vIFBhcmVudCB0aGUgdmVoaWNsZSBpbnNpZGUgdGhlIGNoYXJhY3RlXHJcblx0dGhpcy5hdmF0YXIuYW5pbWF0aW9uSG9sZGVyLmFkZENoaWxkQXQodGhpcywwKTtcclxuXHR0aGlzLnJvdGF0aW9uID0gMDtcclxuXHR0aGlzLnggPSAwO1xyXG5cdHRoaXMueSA9IHRoaXMuYXZhdGFyLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXM7XHJcblxyXG5cdC8vIFBvd2VydXAgdGhlIGNoYXJhY3RlclxyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkICAgICAgICAgICAgKz0gdGhpcy5zcGVlZEJvb3N0O1xyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkTWluICAgICAgICAgKz0gdGhpcy5zcGVlZEJvb3N0O1xyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkTWF4ICAgICAgICAgKz0gdGhpcy5zcGVlZEJvb3N0KjI7XHJcblx0dGhpcy5hdmF0YXIuc2xpZGluZ1NwZWVkTWF4ICAgICArPSB0aGlzLnNwZWVkQm9vc3QqMjtcclxuXHR0aGlzLmF2YXRhci5waWNrdXBDaXJjbGUucmFkaXVzICo9IHRoaXMubWFnbmV0Qm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIuaXNUdW1ibGluZyA9IGZhbHNlO1xyXG5cdHRoaXMuYXZhdGFyLnR1bWJsZUFuZ2xlID0gMDtcclxuXHR0aGlzLmF2YXRhci5zbGlkaW5nQW5nbGVTdGFydCAtPSAzMDtcclxuXHJcblx0Ly8gR2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBib25lIHdoZXJlIHRoZSBjaGFyYWN0ZXIgaGFzIHRvIHNpdCBvblxyXG5cdHRoaXMuc3BpbmVSaWRlckxvY2sgPSB0aGlzLnNwaW5lLnNrZWxldG9uLmZpbmRCb25lKFwicmlkZXJfbG9ja1wiKTtcclxuXHJcblx0Ly8gRWFzZSB0aGUgbW92ZW1lbnQgb2YgdGhlIGNoYXJhY3RlciB3aGVuIG1vdW50aW5nIHRoZSB2ZWhpY2xlXHJcblx0dGhpcy5tb3VudFNwaW5lWCAgICA9IHRoaXMuYXZhdGFyLnNwaW5lLng7XHJcblx0dGhpcy5tb3VudFNwaW5lWSAgICA9IHRoaXMuYXZhdGFyLnNwaW5lLnk7XHJcblx0dGhpcy5tb3VudFNwaW5lUGVyYyA9IDA7XHJcblxyXG5cdC8vIHRoaXMuZnhQUy5lbWl0ID0gZmFsc2U7XHJcblx0XHJcblx0Ly8gSGlkZSB0aGUgZ2xvd1xyXG5cdGlmKCEhdGhpcy50aW1lbGluZSlcclxuXHR7XHJcblx0XHR0aGlzLnRpbWVsaW5lLmtpbGwoKTtcclxuXHRcdHRoaXMudGltZWxpbmUgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdFx0dGhpcy50aW1lbGluZS50byh0aGlzLmdsb3cuc2NhbGUsIDAuMywge3g6IDAsIHk6IDAsIGVhc2U6UXVhZC5lYXNlT3V0fSwgIDApO1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLnRpbWVsaW5lKTtcclxuXHR9XHJcblxyXG5cdHRoaXMubW91bnRUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdHRoaXMubW91bnRUd2Vlbi50byh0aGlzLCB0aGlzLm1vdW50U3BpbmVUaW1lLCB7bW91bnRTcGluZVBlcmM6IDEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLm1vdW50VHdlZW4pO1xyXG59XHJcblxyXG5PYmplY3RTbGVkLnByb3RvdHlwZS5kaXNtb3VudCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIFJlbW92ZSB0aGUgdmVoaWNsZSBmcm9tIHRoZSBhdmF0YXIgYW5kIGFkZCBpdCBiYWNrIHRvIGl0cyBsYXllclxyXG5cdHRoaXMucmVtb3ZlV2hlbk91dHNpZGUgPSB0cnVlO1xyXG5cdHRoaXMueCA9IHRoaXMuYXZhdGFyLng7XHJcblx0dGhpcy55ID0gdGhpcy5hdmF0YXIueSArIHRoaXMuYXZhdGFyLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXM7XHJcblx0dGhpcy5hdmF0YXIuYW5pbWF0aW9uSG9sZGVyLnJlbW92ZUNoaWxkKHRoaXMpO1xyXG5cdHRoaXMub2xkUGFyZW50LmFkZENoaWxkKHRoaXMpO1xyXG5cclxuXHQvLyBJZiB0aGUgdmVoaWNsZSB3YXMgb24gZ3JvdW5kIHNob3cgdGhlIHNsaWRpbmcgYW5pbWF0aW9uLCBvdGhlcndpc2UsIHRvIGF2b2lkIGNvbGxpc2lvbiBjaGVja3Mgd2l0aCB0aGUgZ3JvdW5kLCBncmF2aXR5IGFuZCBzdWNoIGp1c3QgZmFkZSBpdCBvdXRcclxuXHRpZih0aGlzLmF2YXRhci5pc0dyb3VuZGVkKVxyXG5cdFx0dGhpcy5zZXRBbmltYXRpb24oXCJzbGlkZV9kb3duX2V4aXRcIiwgdHJ1ZSk7XHJcblx0ZWxzZVxyXG5cdFx0dGhpcy5pc0ZhZGluZyA9IHRydWU7XHJcblxyXG5cdC8vIERpc21vdW50IHRoZSBjaHJhY3RlclxyXG5cdHRoaXMuYXZhdGFyLnZlaGljbGUgPSBmYWxzZTtcclxuXHR0aGlzLmF2YXRhci5pc1JpZGluZ1ZlaGljbGUgPSBmYWxzZTtcclxuXHR0aGlzLmF2YXRhci55IC09IC10aGlzLmF2YXRhci5zcGluZS55O1xyXG5cdHRoaXMuYXZhdGFyLnNwaW5lLnggPSAwO1xyXG5cdHRoaXMuYXZhdGFyLnNwaW5lLnkgPSB0aGlzLmF2YXRhci5jb2xsaXNpb25DaXJjbGUucmFkaXVzO1xyXG5cclxuXHQvLyBNYWtlIHRoZSBjaGFyYWN0ZXIganVtcFxyXG5cdHRoaXMuYXZhdGFyLmlzR3JvdW5kZWQgPSBmYWxzZTtcclxuXHR0aGlzLmF2YXRhci5pc1R1bWJsaW5nID0gZmFsc2U7XHJcblx0dGhpcy5hdmF0YXIuaXNTbGlkaW5nICA9IGZhbHNlO1xyXG5cdHRoaXMuYXZhdGFyLmNhblR1bWJsZSAgPSB0cnVlO1xyXG5cdHRoaXMuYXZhdGFyLnZlbG9jaXR5LnkgPSB0aGlzLmp1bXBTcGVlZDtcclxuXHR0aGlzLmF2YXRhci55IC09IDEwO1xyXG5cdHRoaXMuYXZhdGFyLnNldEFuaW1hdGlvbignanVtcF9ub3JtYWwnLCBmYWxzZSk7XHJcblx0dGhpcy5hdmF0YXIuc2xpZGluZ0FuZ2xlU3RhcnQgKz0gMzA7XHJcblxyXG5cdC8vIEF1ZGlvXHJcblx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X2dlbmVyaWNfanVtcF8wMFwiLCBcInNmeF9nZW5lcmljX2p1bXBfMDFcIiwgXCJzZnhfZ2VuZXJpY19qdW1wXzAyXCJdKTtcclxuXHJcblx0Ly8gUmVzdG9yZSBzcGVlZCBhbmQgbWFnbmV0IHJhZGl1c1xyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkICAgICAgICAgICAgLT0gdGhpcy5zcGVlZEJvb3N0O1xyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkTWluICAgICAgICAgLT0gdGhpcy5zcGVlZEJvb3N0O1xyXG5cdHRoaXMuYXZhdGFyLnJ1blNwZWVkTWF4ICAgICAgICAgLT0gdGhpcy5zcGVlZEJvb3N0KjI7XHJcblx0dGhpcy5hdmF0YXIuc2xpZGluZ1NwZWVkTWF4ICAgICAtPSB0aGlzLnNwZWVkQm9vc3QqMjtcclxuXHR0aGlzLmF2YXRhci5waWNrdXBDaXJjbGUucmFkaXVzICA9IHRoaXMuYXZhdGFyLnBpY2t1cENpcmNsZS5yYWRpdXMvdGhpcy5tYWduZXRCb29zdDtcclxuXHJcblx0dGhpcy5hdmF0YXIgPSBudWxsO1xyXG59XHJcblxyXG5PYmplY3RTbGVkLnByb3RvdHlwZS5zZXRBbmltYXRpb24gPSBmdW5jdGlvbihpZCwgbG9vcClcclxue1xyXG5cdHJldHVybjtcclxuXHRpZihsb29wICYmIGlkID09IHRoaXMuY3VycmVudEFuaW1hdGlvbikgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmN1cnJlbnRBbmltYXRpb24gPSBpZDtcclxuXHR0aGlzLnNwaW5lLnN0YXRlLnNldEFuaW1hdGlvbkJ5TmFtZSgwLCBpZCwgbG9vcCwgMCk7XHJcbn0iLCJ2YXIgQ29tbW9uICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgUnVubmluZ0VudGl0eSAgPSByZXF1aXJlKFwiLi9SdW5uaW5nRW50aXR5XCIpO1xyXG52YXIgRW1pdHRlclx0XHQgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdFNub3diYWxsKClcclxue1xyXG5cdFJ1bm5pbmdFbnRpdHkuY2FsbCh0aGlzLCBcInNub3diYWxsXCIpO1xyXG5cclxuXHR0aGlzLmxldmVsICAgICAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICAgICAgPSBudWxsO1xyXG5cdHRoaXMucmVtb3ZlV2hlbk91dHNpZGUgPSB0cnVlO1xyXG5cclxuXHR0aGlzLnNwZWVkID0gNTAwO1xyXG5cdHRoaXMuZGVzdHJveWVkID0gZmFsc2U7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RTbm93YmFsbDtcclxuT2JqZWN0U25vd2JhbGwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShSdW5uaW5nRW50aXR5LnByb3RvdHlwZSk7XHJcbk9iamVjdFNub3diYWxsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE9iamVjdFNub3diYWxsO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogSW5pdFxyXG4gKi9cclxuT2JqZWN0U25vd2JhbGwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsKVxyXG57XHJcblx0aWYodGhpcy5zcHJpdGUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9vYnN0YWNsZV9zbm93YmFsbF8xXCIpKTtcclxuXHRcdHRoaXMuc3ByaXRlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuc3ByaXRlLnNjYWxlIC5zZXQoMSk7XHJcblx0XHR0aGlzLnNwcml0ZS5yb3RhdGlvbiA9IDA7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuc3ByaXRlKTtcclxuXHJcblx0XHR0aGlzLnNwcml0ZS5zaGFkaW5nID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwiaW5nYW1lX29ic3RhY2xlX3Nub3diYWxsXzJcIikpO1xyXG5cdFx0dGhpcy5zcHJpdGUuc2hhZGluZy5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0aGlzLnNwcml0ZS5hZGRDaGlsZCh0aGlzLnNwcml0ZS5zaGFkaW5nKTtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogUmVzZXRcclxuICovXHJcbk9iamVjdFNub3diYWxsLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMubGV2ZWwgICAgPSBudWxsO1xyXG5cdHRoaXMuY29uZmlnICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLnZlbG9jaXR5LnNldCgwKTtcclxuXHR0aGlzLmdyYXZpdHkgICAgICAgID0gMDtcclxuXHR0aGlzLmlzR3JvdW5kZWQgICAgID0gZmFsc2U7XHJcblx0dGhpcy5jb2xsaXNpb25Qb2ludCA9IG51bGw7XHJcblxyXG5cdHRoaXMuc3ByaXRlLnJvdGF0aW9uID0gMDtcclxuXHR0aGlzLnNwcml0ZS5zaGFkaW5nLnJvdGF0aW9uID0gMDtcclxuXHR0aGlzLnNwcml0ZS5hbHBoYSA9IDE7XHJcblx0dGhpcy5hbHBoYSA9IDE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25maWd1cmVcclxuICogQHBhcmFtIHtMZXZlbH0gbGV2ZWxcclxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xyXG4gKi9cclxuT2JqZWN0U25vd2JhbGwucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHR0aGlzLmxldmVsICAgPSBsZXZlbDtcclxuXHR0aGlzLmNvbmZpZyAgPSBjb25maWc7XHJcblx0dGhpcy5ncmF2aXR5ID0gbGV2ZWwuYXZhdGFyLmdyYXZpdHk7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgICAgID0gdHJ1ZTtcclxuXHR0aGlzLnNwcml0ZS52aXNpYmxlICAgPSB0cnVlO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LCB0aGlzLmNvbmZpZy5zY2FsZS55KVxyXG5cdHRoaXMuZGVzdHJveWVkICAgICAgICA9IGZhbHNlO1xyXG5cclxuXHQvLyBDb2xsaWRlclxyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuQ2lyY2xlKDAsIDAsIHRoaXMuc3ByaXRlLndpZHRoKjAuNDI1KTtcclxuXHJcblx0Ly8gUGFydGljbGVzXHJcblx0aWYoIXRoaXMudHJhaWxQUylcclxuXHR7XHJcblx0XHR0aGlzLnRyYWlsUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLmxldmVsLFxyXG5cdFx0W1xyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDFcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAyXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxyXG5cdFx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9zbm93YmFsbFwiKSk7XHJcblx0fVxyXG5cdHRoaXMudHJhaWxQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0dGhpcy5kZXN0cm95UFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAwXCIpXHJcblx0XSxcclxuXHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX2ljZV9leHBsb3Npb25cIikpO1xyXG5cdHRoaXMuZGVzdHJveVBTLnVwZGF0ZVNwYXduUG9zKDAsIC10aGlzLnNwcml0ZS5oZWlnaHQvMik7XHJcblx0dGhpcy5kZXN0cm95UFMuZW1pdCA9IGZhbHNlO1xyXG5cclxuXHQvLyBEZWJ1Z1xyXG5cdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHR0aGlzLmRyYXdDb2xsaXNpb24oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERpc3Bvc2VcclxuICovXHJcbk9iamVjdFNub3diYWxsLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gU3RvcCBwYXJ0aWNsZXNcclxuXHR0aGlzLnRyYWlsUFMuZW1pdCA9IGZhbHNlO1xyXG5cdHRoaXMuZGVzdHJveVBTLmVtaXQgPSBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZVxyXG4gKi9cclxuT2JqZWN0U25vd2JhbGwucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIFBhcnRpY2xlcyB1cGRhdGVcclxuXHR0aGlzLnRyYWlsUFMudXBkYXRlU3Bhd25Qb3ModGhpcy54LCB0aGlzLnkpO1xyXG5cdHRoaXMudHJhaWxQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHR0aGlzLmRlc3Ryb3lQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0Ly8gVXBkYXRlIHBvc2l0aW9uXHJcblx0aWYoIXRoaXMuZGVzdHJveWVkKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuaXNHcm91bmRlZClcclxuXHRcdFx0dGhpcy52ZWxvY2l0eS54ID0gLXRoaXMuc3BlZWQ7XHJcblx0XHRlbHNlXHJcblx0XHRcdHRoaXMudmVsb2NpdHkueCA9IDA7XHJcblxyXG5cdFx0Ly8gR3Jhdml0eVxyXG5cdFx0dGhpcy52ZWxvY2l0eS55ICs9IHRoaXMuZ3Jhdml0eSAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdGlmKHRoaXMudmVsb2NpdHkueSA+PSB0aGlzLmdyYXZpdHkvMikgdGhpcy52ZWxvY2l0eS55ID0gdGhpcy5ncmF2aXR5LzI7XHJcblxyXG5cdFx0Ly8gTW92ZW1lbnRcclxuXHRcdHZhciB3YXNHcm91bmRlZCA9IHRoaXMuaXNHcm91bmRlZDtcclxuXHRcdHRoaXMubW92ZSh0aGlzLnZlbG9jaXR5KTtcclxuXHJcblx0XHQvLyBVbmRvIGdyYXZpdHkgd2hlbiB0b3VjaGluZyBncm91bmRcclxuXHRcdGlmKHRoaXMuaXNHcm91bmRlZClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy52ZWxvY2l0eS55ID0gMDtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNwcml0ZS5yb3RhdGlvbiAtPSAzNjAgKiBQSVhJLkRFR19UT19SQUQgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHR0aGlzLnNwcml0ZS5zaGFkaW5nLnJvdGF0aW9uID0gLXRoaXMuc3ByaXRlLnJvdGF0aW9uO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEhpdFxyXG4gKiBAcGFyYW0ge0dhbWVPYmplY3R9IHRhcmdldFxyXG4gKi9cclxuT2JqZWN0U25vd2JhbGwucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKHRhcmdldClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuXHR0aGlzLmRlc3Ryb3lQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0U291bmRTRlgucGxheVJhbmRvbUZyb20oW1wic2Z4X2dlbmVyaWNfaGl0X29ic3RhY2xlXzAwXCJdKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEZXN0cm95XHJcbiAqIEBwYXJhbSB7Ym9vbH0gcmV3YXJkXHJcbiAqL1xyXG5PYmplY3RTbm93YmFsbC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKHJld2FyZClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblx0dGhpcy5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdHRoaXMuZGVzdHJveWVkICAgPSB0cnVlO1xyXG5cclxuXHQvLyBTdG9wIHBhcnRpY2xlc1xyXG5cdHRoaXMudHJhaWxQUy5lbWl0ICAgPSBmYWxzZTtcclxuXHR0aGlzLmRlc3Ryb3lQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0Ly8gRmFkZSBvdXRcclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHR0bC50byh0aGlzLnNwcml0ZSwgMC4xNSwge2FscGhhOiAwLCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sICAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0Ly8gR2VuZXJhdGUgc25vd2ZsYWtlc1xyXG5cdGlmKHJld2FyZClcclxuXHR7XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgNTsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnBhcmVudC5hZGRPYmplY3QoXCJjb2luXCIsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRwb3NpdGlvbiA6IHt4OnRoaXMueCwgeTp0aGlzLnl9LFxyXG5cdFx0XHRcdGV4cGxvc2lvbiA6IHthbmdsZSA6IC02MCAtIDIwICogaSwgZGlzdGFuY2U6IDMwMCwgdGltZTogMC41fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cclxuXHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfaWNlYmxvY2tfc21hc2hfMDBcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDFcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDJcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDNcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDRcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDVcIiwgXCJzZnhfaWNlYmxvY2tfc21hc2hfMDZcIl0pO1xyXG59OyIsInZhciBDb21tb24gICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBHYW1lT2JqZWN0ICA9IHJlcXVpcmUoXCIuL0dhbWVPYmplY3RcIik7XHJcbnZhciBFbWl0dGVyXHRcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvRW1pdHRlclwiKTtcclxudmFyIFNvdW5kU0ZYICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gT2JqZWN0U3ZlbigpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJzdmVuXCIsIGZhbHNlKTtcclxuXHJcblx0dGhpcy5yZW1vdmVXaGVuT3V0c2lkZSA9IHRydWU7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICA9IG51bGw7XHJcblx0dGhpcy5hdmF0YXIgICAgICAgPSBudWxsO1xyXG5cclxuXHR0aGlzLnNwaW5lICAgICAgICA9IG51bGw7XHJcblx0dGhpcy50aW1lICAgICAgICAgPSAwO1xyXG5cdHRoaXMudGltZU1heCAgICAgID0gMTA7XHJcblx0dGhpcy5vbGRQYXJlbnQgICAgPSBudWxsO1xyXG5cdHRoaXMuc3BlZWRCb29zdCAgID0gMjAwO1xyXG5cdHRoaXMubWFnbmV0Qm9vc3QgID0gMS4yNTtcclxuXHR0aGlzLmp1bXBTcGVlZCAgICA9IC0xNTAwO1xyXG5cclxuXHR0aGlzLm1vdW50VHdlZW4gICAgID0gbnVsbDtcclxuXHR0aGlzLm1vdW50U3BpbmVYICAgID0gMDtcclxuXHR0aGlzLm1vdW50U3BpbmVZICAgID0gMDtcclxuXHR0aGlzLm1vdW50U3BpbmVUaW1lID0gMC42O1xyXG5cdHRoaXMubW91bnRTcGluZVBlcmMgPSAwO1xyXG5cclxuXHR0aGlzLmZhZGVUaW1lID0gMC43NTtcclxuXHR0aGlzLmlzRmFkaW5nID0gZmFsc2U7XHJcblx0XHJcblx0dGhpcy5yaWRlckFuaW1hdGlvbiAgICAgPSBcInJpZGVfc3ZlblwiO1xyXG5cdHRoaXMucmlkZXJGYWxsQW5pbWF0aW9uID0gXCJyaWRlX3N2ZW5fZmFsbFwiO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0U3ZlbjtcclxuT2JqZWN0U3Zlbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdhbWVPYmplY3QucHJvdG90eXBlKTtcclxuT2JqZWN0U3Zlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RTdmVuO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RTdmVuLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24obClcclxue1xyXG5cdGlmKHRoaXMuc3ByaXRlID09IG51bGwpXHJcblx0e1xyXG5cdFx0dGhpcy5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuXHR9XHJcblxyXG5cdC8vIEluaXQgc3BpbmUgYW5pbWF0aW9uXHJcblx0aWYodGhpcy5zcGluZSA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuc3BpbmVEYXRhID0gQ29tbW9uLmNoYXJhY3RlckFuaW1hdGlvbkRhdGEuY2hhcl9zdmVuO1xyXG5cdFx0dGhpcy5zcGluZSA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKHRoaXMuc3BpbmVEYXRhKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0VG9TZXR1cFBvc2UoKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbihudWxsKTtcclxuXHRcdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbkJ5TmFtZShcInN2ZW5cIik7XHJcblx0XHR0aGlzLnNwaW5lLmF1dG9VcGRhdGUgPSBmYWxzZTtcclxuXHRcdHRoaXMuc3BpbmUuc2NhbGUuc2V0KDAuNSk7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuc3BpbmUpO1xyXG5cclxuXHRcdHZhciBhbmltYXRpb25zID1cclxuXHRcdFtcclxuXHRcdFx0J2lkbGUnLFxyXG5cdFx0XHQncnVuX2ZsYXQnLFxyXG5cdFx0XHQnanVtcF9ub3JtYWwnLFxyXG5cdFx0XHQnc2xpZGVfZG93bl9zdGVlcCcsXHJcblx0XHRcdCdzbGlkZV9kb3duX2V4aXQnLFxyXG5cdFx0XHQnZmFsbCcsXHJcblx0XHRcdCdsYW5kX2JhZCdcclxuXHRcdF07XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGFuaW1hdGlvbnMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBhbmltYXRpb25zLmxlbmd0aDsgaisrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYoaSA9PSBqKSBjb250aW51ZTtcclxuXHJcblx0XHRcdFx0aWYoYW5pbWF0aW9uc1tpXSA9PSBcImZhbGxcIilcclxuXHRcdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjEpO1xyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGVEYXRhLnNldE1peEJ5TmFtZShhbmltYXRpb25zW2ldLCBhbmltYXRpb25zW2pdLCAwLjIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuT2JqZWN0U3Zlbi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmxldmVsICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5jdXJyZW50QW5pbWF0aW9uID0gXCJcIjtcclxuXHR0aGlzLnRpbWUgPSAwO1xyXG59XHJcblxyXG5PYmplY3RTdmVuLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbihsZXZlbCwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBsZXZlbDtcclxuXHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuXHJcblx0dGhpcy54ID0gdGhpcy5jb25maWcucG9zaXRpb24ueDtcclxuXHR0aGlzLnkgPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi55O1xyXG5cdHRoaXMuc3ByaXRlLnRleHR1cmUgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXh0dXJlKTtcclxuXHR0aGlzLnNwcml0ZS5hbmNob3Iuc2V0KHRoaXMuY29uZmlnLmFuY2hvci54LCB0aGlzLmNvbmZpZy5hbmNob3IueSk7XHJcblx0dGhpcy5zcHJpdGUuc2NhbGUuc2V0KHRoaXMuY29uZmlnLnNjYWxlLngvMiwgdGhpcy5jb25maWcuc2NhbGUueS8yKTtcclxuXHR0aGlzLnJvdGF0aW9uID0gdGhpcy5jb25maWcucm90YXRpb24gKiBQSVhJLkRFR19UT19SQUQ7XHJcblxyXG5cdC8vIEluaXQgYW5pbWF0aW9uXHJcblx0dGhpcy5zcGluZS5zdGF0ZS5hZGRBbmltYXRpb25CeU5hbWUoMCwgJ2lkbGUnLCB0cnVlLCAwLjIpO1xyXG5cdHRoaXMuYWxwaGEgPSAxO1xyXG5cdHRoaXMuaXNGYWRpbmcgPSBmYWxzZTtcclxuXHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgICA9IHRydWU7XHJcblx0dGhpcy5zcHJpdGUudmlzaWJsZSA9IGZhbHNlO1xyXG5cdHZhciB3aWR0aCAgPSB0aGlzLnNwcml0ZS53aWR0aDtcclxuXHR2YXIgaGVpZ2h0ID0gdGhpcy5zcHJpdGUuaGVpZ2h0O1xyXG5cdHRoaXMuY29sbGlzaW9uUmVjdCA9IG5ldyBQSVhJLlJlY3RhbmdsZSg1NSwgKC10aGlzLnNwcml0ZS5hbmNob3IueSkgKiBoZWlnaHQvMiwgMjAsIGhlaWdodC8yKTtcclxuXHJcblx0Ly8gSXMgdGhlcmUgYWxyZWFkeSBhbm90aGVyIFN2ZW4/IERpc2FibGUgaXQgaWYgc29cclxuXHRpZih0aGlzLmxldmVsLmF2YXRhci5pc1JpZGluZ1ZlaGljbGUgJiYgdGhpcy5sZXZlbC5hdmF0YXIudmVoaWNsZS50eXBlID09IHRoaXMudHlwZSlcclxuXHR7XHJcblx0XHR0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XHJcblx0XHR0aGlzLmFscGhhID0gMDtcclxuXHR9XHJcblx0XHJcblx0Ly8gRGVidWdcclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn1cclxuXHJcbk9iamVjdFN2ZW4ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbk9iamVjdFN2ZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIEFuaW1hdGlvbiB1cGRhdGVcclxuXHR0aGlzLnNwaW5lLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cclxuXHQvLyBNb3VudCB1cGRhdGVcclxuXHRpZih0aGlzLmF2YXRhcilcclxuXHR7XHJcblx0XHQvLyBBdXRvbWF0aWMgZGlzbW91dCBjb3VudGRvd25cclxuXHRcdHRoaXMudGltZSArPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdFx0aWYodGhpcy50aW1lID49IHRoaXMudGltZU1heCAmJiB0aGlzLmF2YXRhci5pc0dyb3VuZGVkKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmRpc21vdW50KGZhbHNlKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0aWYodGhpcy5tb3VudFNwaW5lUGVyYyA8IDEpXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBUd2VlbiB0aGUgbW91bnRpbmdcclxuXHRcdFx0XHR0aGlzLmF2YXRhci5zcGluZS54ID0gdGhpcy5tb3VudFNwaW5lWCArICgodGhpcy5zcGluZVJpZGVyTG9jay53b3JsZFggKiB0aGlzLnNwaW5lLnNjYWxlLngpLXRoaXMubW91bnRTcGluZVgpICogdGhpcy5tb3VudFNwaW5lUGVyYztcclxuXHRcdFx0XHR0aGlzLmF2YXRhci5zcGluZS55ID0gdGhpcy5tb3VudFNwaW5lWSArICgodGhpcy5zcGluZVJpZGVyTG9jay53b3JsZFkgKiB0aGlzLnNwaW5lLnNjYWxlLnkgKyB0aGlzLmF2YXRhci5jb2xsaXNpb25DaXJjbGUucmFkaXVzKS10aGlzLm1vdW50U3BpbmVZKSogdGhpcy5tb3VudFNwaW5lUGVyYztcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIG1vdW50IHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5hdmF0YXIuc3BpbmUueCA9IHRoaXMuc3BpbmVSaWRlckxvY2sud29ybGRYICogdGhpcy5zcGluZS5zY2FsZS54O1xyXG5cdFx0XHRcdHRoaXMuYXZhdGFyLnNwaW5lLnkgPSB0aGlzLnNwaW5lUmlkZXJMb2NrLndvcmxkWSAqIHRoaXMuc3BpbmUuc2NhbGUueSArIHRoaXMuYXZhdGFyLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXM7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Ly8gRmFkZSBvdXRcclxuXHRlbHNlIGlmKHRoaXMuaXNGYWRpbmcpXHJcblx0e1xyXG5cdFx0dGhpcy5hbHBoYSAtPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWUvdGhpcy5mYWRlVGltZTtcclxuXHRcdGlmKHRoaXMuYWxwaGEgPCAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmFscGhhID0gMDtcclxuXHRcdFx0dGhpcy5pc0ZhZGluZyA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdFN2ZW4ucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKHRhcmdldClcclxue1xyXG5cdGlmKCF0aGlzLmludGVyYWN0aXZlKSByZXR1cm47XHJcblxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHR0aGlzLm1vdW50KHRhcmdldCk7XHJcbn07XHJcblxyXG5PYmplY3RTdmVuLnByb3RvdHlwZS5tb3VudCA9IGZ1bmN0aW9uKGF2YXRhcilcclxue1xyXG5cdHRoaXMucmVtb3ZlV2hlbk91dHNpZGUgPSBmYWxzZTtcclxuXHJcblx0Ly8gU2F2ZSBhIHJlZmVyZW5jZSBvZiB0aGUgbGF5ZXJcclxuXHR0aGlzLm9sZFBhcmVudCA9IHRoaXMucGFyZW50O1xyXG5cclxuXHQvLyBNYWtlIHRoZSBjaGFyYWN0ZXIgcmlkaW5nIHRoZSB2ZWhpY2xlXHJcblx0dGhpcy5hdmF0YXIgPSBhdmF0YXI7XHJcblx0dGhpcy5hdmF0YXIudmVoaWNsZSA9IHRoaXM7XHJcblx0dGhpcy5hdmF0YXIuaXNSaWRpbmdWZWhpY2xlID0gdHJ1ZTtcclxuXHJcblx0Ly8gUGFyZW50IHRoZSB2ZWhpY2xlIGluc2lkZSB0aGUgY2hhcmFjdGVcclxuXHR0aGlzLmF2YXRhci5hbmltYXRpb25Ib2xkZXIuYWRkQ2hpbGRBdCh0aGlzLDApO1xyXG5cdHRoaXMucm90YXRpb24gPSAwO1xyXG5cdHRoaXMueCA9IDA7XHJcblx0dGhpcy55ID0gdGhpcy5hdmF0YXIuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cztcclxuXHJcblx0Ly8gUG93ZXJ1cCB0aGUgY2hhcmFjdGVyXHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWQgICAgICAgICAgICArPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWRNaW4gICAgICAgICArPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWRNYXggICAgICAgICArPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIuc2xpZGluZ1NwZWVkTWF4ICAgICArPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucGlja3VwQ2lyY2xlLnJhZGl1cyAqPSB0aGlzLm1hZ25ldEJvb3N0O1xyXG5cdHRoaXMuYXZhdGFyLmlzVHVtYmxpbmcgPSBmYWxzZTtcclxuXHR0aGlzLmF2YXRhci50dW1ibGVBbmdsZSA9IDA7XHJcblx0dGhpcy5hdmF0YXIuYW5pbWF0aW9uSG9sZGVyLnJvdGF0aW9uID0gMDtcclxuXHJcblx0Ly8gR2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBib25lIHdoZXJlIHRoZSBjaGFyYWN0ZXIgaGFzIHRvIHNpdCBvblxyXG5cdHRoaXMuc3BpbmVSaWRlckxvY2sgPSB0aGlzLnNwaW5lLnNrZWxldG9uLmZpbmRCb25lKFwicmlkZXJfbG9ja1wiKTtcclxuXHJcblx0Ly8gRWFzZSB0aGUgbW92ZW1lbnQgb2YgdGhlIGNoYXJhY3RlciB3aGVuIG1vdW50aW5nIHRoZSB2ZWhpY2xlXHJcblx0dGhpcy5tb3VudFNwaW5lWCAgICA9IHRoaXMuYXZhdGFyLnNwaW5lLng7XHJcblx0dGhpcy5tb3VudFNwaW5lWSAgICA9IHRoaXMuYXZhdGFyLnNwaW5lLnk7XHJcblx0dGhpcy5tb3VudFNwaW5lUGVyYyA9IDA7XHJcblxyXG5cdHRoaXMubW91bnRUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdHRoaXMubW91bnRUd2Vlbi50byh0aGlzLCB0aGlzLm1vdW50U3BpbmVUaW1lLCB7bW91bnRTcGluZVBlcmM6IDEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLm1vdW50VHdlZW4pO1xyXG59XHJcblxyXG5PYmplY3RTdmVuLnByb3RvdHlwZS5kaXNtb3VudCA9IGZ1bmN0aW9uKGhpdEJ5T2JzdGFjbGUpXHJcbntcclxuXHQvLyBSZW1vdmUgdGhlIHZlaGljbGUgZnJvbSB0aGUgYXZhdGFyIGFuZCBhZGQgaXQgYmFjayB0byBpdHMgbGF5ZXJcclxuXHR0aGlzLnJlbW92ZVdoZW5PdXRzaWRlID0gdHJ1ZTtcclxuXHR0aGlzLnggPSB0aGlzLmF2YXRhci54O1xyXG5cdHRoaXMueSA9IHRoaXMuYXZhdGFyLnkgKyB0aGlzLmF2YXRhci5jb2xsaXNpb25DaXJjbGUucmFkaXVzO1xyXG5cdHRoaXMuYXZhdGFyLmFuaW1hdGlvbkhvbGRlci5yZW1vdmVDaGlsZCh0aGlzKTtcclxuXHR0aGlzLm9sZFBhcmVudC5hZGRDaGlsZCh0aGlzKTtcclxuXHJcblx0Ly8gSWYgdGhlIHZlaGljbGUgd2FzIG9uIGdyb3VuZCBzaG93IHRoZSBzbGlkaW5nIGFuaW1hdGlvbiwgb3RoZXJ3aXNlLCB0byBhdm9pZCBjb2xsaXNpb24gY2hlY2tzIHdpdGggdGhlIGdyb3VuZCwgZ3Jhdml0eSBhbmQgc3VjaCBqdXN0IGZhZGUgaXQgb3V0XHJcblx0aWYodGhpcy5hdmF0YXIuaXNHcm91bmRlZClcclxuXHRcdHRoaXMuc2V0QW5pbWF0aW9uKFwibGFuZF9iYWRcIiwgZmFsc2UpO1xyXG5cdGVsc2VcclxuXHRcdHRoaXMuaXNGYWRpbmcgPSB0cnVlO1xyXG5cdFxyXG5cdC8vIEF1ZGlvXHJcblx0aWYoaGl0QnlPYnN0YWNsZSlcclxuXHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfc3Zlbl9oaXRvYnN0YWNsZV9zdG9wXzAwXCIpO1xyXG5cdGVsc2VcclxuXHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfc3Zlbl9ydW5fc3RvcF8wMFwiKTtcdFx0XHJcblxyXG5cdC8vIERpc21vdW50IHRoZSBjaGFyYWN0ZXJcclxuXHR0aGlzLmF2YXRhci52ZWhpY2xlID0gZmFsc2U7XHJcblx0dGhpcy5hdmF0YXIuaXNSaWRpbmdWZWhpY2xlID0gZmFsc2U7XHJcblx0dGhpcy5hdmF0YXIueSAtPSAtdGhpcy5hdmF0YXIuc3BpbmUueTtcclxuXHR0aGlzLmF2YXRhci5zcGluZS54ID0gMDtcclxuXHR0aGlzLmF2YXRhci5zcGluZS55ID0gdGhpcy5hdmF0YXIuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cztcclxuXHJcblx0Ly8gTWFrZSB0aGUgY2hhcmFjdGVyIGp1bXBcclxuXHR0aGlzLmF2YXRhci5pc0dyb3VuZGVkID0gZmFsc2U7XHJcblx0dGhpcy5hdmF0YXIuaXNUdW1ibGluZyA9IGZhbHNlO1xyXG5cdHRoaXMuYXZhdGFyLmlzU2xpZGluZyAgPSBmYWxzZTtcclxuXHR0aGlzLmF2YXRhci5jYW5UdW1ibGUgID0gdHJ1ZTtcclxuXHR0aGlzLmF2YXRhci52ZWxvY2l0eS55ID0gdGhpcy5qdW1wU3BlZWQ7XHJcblx0dGhpcy5hdmF0YXIuc2V0QW5pbWF0aW9uKCdqdW1wX25vcm1hbCcsIGZhbHNlKTtcclxuXHJcblx0Ly8gQXVkaW9cclxuXHRTb3VuZFNGWC5wbGF5UmFuZG9tRnJvbShbXCJzZnhfZ2VuZXJpY19qdW1wXzAwXCIsIFwic2Z4X2dlbmVyaWNfanVtcF8wMVwiLCBcInNmeF9nZW5lcmljX2p1bXBfMDJcIl0pO1xyXG5cclxuXHQvLyBSZXN0b3JlIHNwZWVkIGFuZCBtYWduZXQgcmFkaXVzXHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWQgICAgICAgICAgICAtPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWRNaW4gICAgICAgICAtPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucnVuU3BlZWRNYXggICAgICAgICAtPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIuc2xpZGluZ1NwZWVkTWF4ICAgICAtPSB0aGlzLnNwZWVkQm9vc3Q7XHJcblx0dGhpcy5hdmF0YXIucGlja3VwQ2lyY2xlLnJhZGl1cyAgPSB0aGlzLmF2YXRhci5waWNrdXBDaXJjbGUucmFkaXVzL3RoaXMubWFnbmV0Qm9vc3Q7XHJcblxyXG5cdHRoaXMuYXZhdGFyID0gbnVsbDtcclxufVxyXG5cclxuT2JqZWN0U3Zlbi5wcm90b3R5cGUuc2V0QW5pbWF0aW9uID0gZnVuY3Rpb24oaWQsIGxvb3ApXHJcbntcclxuXHRpZihsb29wICYmIGlkID09IHRoaXMuY3VycmVudEFuaW1hdGlvbikgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmN1cnJlbnRBbmltYXRpb24gPSBpZDtcclxuXHR0aGlzLnNwaW5lLnN0YXRlLnNldEFuaW1hdGlvbkJ5TmFtZSgwLCBpZCwgbG9vcCwgMCk7XHJcbn0iLCJ2YXIgQ29tbW9uICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgR2FtZU9iamVjdCAgPSByZXF1aXJlKFwiLi9HYW1lT2JqZWN0XCIpO1xyXG52YXIgRW1pdHRlclx0XHQ9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0VtaXR0ZXJcIik7XHJcbnZhciBTb3VuZFNGWCAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE9iamVjdFRyb2xsKGlzQ29sbGVjdGFibGUpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJ0cm9sbFwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMucmVtb3ZlV2hlbk91dHNpZGUgPSB0cnVlO1xyXG5cclxuXHR0aGlzLmxldmVsICAgICAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICAgICAgPSBudWxsO1xyXG5cdHRoaXMuYXZhdGFyICAgICAgID0gbnVsbDtcclxuXHJcblx0dGhpcy5zcGluZSAgICAgICAgPSBudWxsO1xyXG5cdHRoaXMudGltZSAgICAgICAgID0gMDtcclxuXHR0aGlzLnRpbWVNYXggICAgICA9IDEwO1xyXG5cclxuXHR0aGlzLmlzQ29sbGVjdGFibGUgPSBpc0NvbGxlY3RhYmxlO1xyXG5cdHRoaXMuaXNDb2xsZWN0ZWQgICA9IGZhbHNlO1xyXG5cclxuXHR0aGlzLmZhZGVUaW1lID0gMC43NTtcclxuXHR0aGlzLmlzRmFkaW5nID0gZmFsc2U7XHJcblxyXG5cdHRoaXMuZ2xvdyAgICAgPSBudWxsO1xyXG5cdHRoaXMudGltZWxpbmUgPSBudWxsO1xyXG5cclxuXHR0aGlzLmNoYXJhY3RlciA9IFwiXCI7XHJcblx0dGhpcy5jcnlzdGFsICAgPSBcIlwiO1xyXG5cdHRoaXMuaGFzQmxpbmtlZCA9IGZhbHNlO1xyXG5cclxuXHR0aGlzLnBpY2t1cFBTICAgICAgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLCBbdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDBcIildLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX2NvaW5fY29sbGVjdF9idXJzdFwiKSk7XHJcblx0dGhpcy5waWNrdXBQUy5lbWl0ID0gZmFsc2U7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RUcm9sbDtcclxuT2JqZWN0VHJvbGwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHYW1lT2JqZWN0LnByb3RvdHlwZSk7XHJcbk9iamVjdFRyb2xsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE9iamVjdFRyb2xsO1xyXG5cclxuT2JqZWN0VHJvbGwucHJvdG90eXBlLmluZGV4ZXMgICAgPSAwO1xyXG5PYmplY3RUcm9sbC5wcm90b3R5cGUuY29sbGVjdGVkICA9IFtdO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5PYmplY3RUcm9sbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGwpXHJcbntcclxuXHRpZih0aGlzLnNwcml0ZSA9PSBudWxsKVxyXG5cdHtcclxuXHRcdHRoaXMuc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKCk7XHJcblx0fVxyXG5cclxuXHQvLyBJbml0IHNwaW5lIGFuaW1hdGlvblxyXG5cdGlmKHRoaXMuc3BpbmUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnNwaW5lRGF0YSA9IENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhLmNoYXJfdHJvbGw7XHJcblx0XHR0aGlzLnNwaW5lID0gbmV3IFBJWEkuc3BpbmUuU3BpbmUodGhpcy5zcGluZURhdGEpO1xyXG5cdFx0dGhpcy5zcGluZS5za2VsZXRvbi5zZXRUb1NldHVwUG9zZSgpO1xyXG5cdFx0dGhpcy5zcGluZS5za2VsZXRvbi5zZXRTa2luKG51bGwpO1xyXG5cdFx0dGhpcy5zcGluZS5za2VsZXRvbi5zZXRTa2luQnlOYW1lKFwidHJvbGxfc2lnblwiKTtcclxuXHRcdHRoaXMuc3BpbmUuYXV0b1VwZGF0ZSA9IGZhbHNlO1xyXG5cdFx0dGhpcy5zcGluZS5zY2FsZS5zZXQoMC41KTtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5zcGluZSk7XHJcblxyXG5cdFx0dmFyIGFuaW1hdGlvbnMgPVxyXG5cdFx0W1xyXG5cdFx0XHQnaWRsZTEnLFxyXG5cdFx0XHQnaWRsZTInLFxyXG5cdFx0XHQnaWRsZTMnXHJcblx0XHRdO1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBhbmltYXRpb25zLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgYW5pbWF0aW9ucy5sZW5ndGg7IGorKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKGkgPT0gaikgY29udGludWU7XHJcblx0XHRcdFx0dGhpcy5zcGluZS5zdGF0ZURhdGEuc2V0TWl4QnlOYW1lKGFuaW1hdGlvbnNbaV0sIGFuaW1hdGlvbnNbal0sIDAuMik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5PYmplY3RUcm9sbC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmxldmVsICAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICAgPSBudWxsO1xyXG5cdHRoaXMudmlzaWJsZSAgID0gdHJ1ZTtcclxuXHR0aGlzLmNoYXJhY3RlciA9IFwiXCI7XHJcblxyXG5cdHRoaXMuY3VycmVudEFuaW1hdGlvbiA9IFwiXCI7XHJcblx0dGhpcy50aW1lID0gMDtcclxufVxyXG5cclxuT2JqZWN0VHJvbGwucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGxldmVsLCBjb25maWcpXHJcbntcclxuXHRpZih0aGlzLmlzQ29sbGVjdGFibGUpXHJcblx0e1xyXG5cdFx0Ly8gQ3VycmVudCBpbmRleCwgc2hhcmVkIGFtb25nIGFsbCB0cnBsbHMgKHN0YXRpYylcclxuXHRcdHRoaXMuaW5kZXhlcysrO1xyXG5cclxuXHRcdC8vIEluZGV4IG9mIHRoZSBjdXJyZW50IHRyb2xsXHJcblx0XHR0aGlzLmluZGV4ID0gdGhpcy5pbmRleGVzLTE7XHJcblxyXG5cdFx0Ly8gQ29sbGVjdGVkXHJcblx0XHR0aGlzLmlzQ29sbGVjdGVkID0gQ29tbW9uLnNhdmVkRGF0YS5pc1Ryb2xsQ29sbGVjdGVkKENvbW1vbi5zYXZlZERhdGEubGV2ZWwsIHRoaXMuaW5kZXgpXHJcblxyXG5cdFx0Ly8gR2xvd1xyXG5cdFx0aWYodGhpcy5nbG93ID09IG51bGwpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuZ2xvdyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImluZ2FtZV9jcnlzdGFsX2dsb3dcIikpO1xyXG5cdFx0XHR0aGlzLmdsb3cuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aGlzLmdsb3cueSAtPSAyMDtcclxuXHRcdFx0dGhpcy5hZGRDaGlsZEF0KHRoaXMuZ2xvdywgMCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5nbG93LnJvdGF0aW9uID0gMDtcclxuXHRcdHRoaXMuZ2xvdy5zY2FsZS5zZXQoMSk7XHJcblxyXG5cdFx0Ly8gQW5pbWF0aW9uXHJcblx0XHR0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHRcdHRoaXMudGltZWxpbmUudG8odGhpcy5nbG93LCA4LCB7cm90YXRpb246IE1hdGguUEkgKiAyLCBlYXNlOkxpbmVhci5lYXNlTm9uZSwgcmVwZWF0Oi0xfSwgIDApO1xyXG5cdFx0XHR0aGlzLnRpbWVsaW5lLnRvKHRoaXMuZ2xvdy5zY2FsZSwgMC41LCB7eDogMS41LCB5OiAxLjUsIGVhc2U6UXVhZC5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgIDApO1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLnRpbWVsaW5lKTtcclxuXHR9XHJcblxyXG5cdC8vIENvbmZpZ1xyXG5cdHRoaXMubGV2ZWwgID0gbGV2ZWw7XHJcblx0dGhpcy5jb25maWcgPSBjb25maWc7XHJcblxyXG5cdHRoaXMueCA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLng7XHJcblx0dGhpcy55ID0gdGhpcy5jb25maWcucG9zaXRpb24ueTtcclxuXHR0aGlzLnNwcml0ZS50ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5jb25maWcudGV4dHVyZSk7XHJcblx0dGhpcy5zcHJpdGUuYW5jaG9yLnNldCh0aGlzLmNvbmZpZy5hbmNob3IueCwgdGhpcy5jb25maWcuYW5jaG9yLnkpO1xyXG5cdHRoaXMuc3ByaXRlLnNjYWxlLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LzIsIHRoaXMuY29uZmlnLnNjYWxlLnkvMik7XHJcblx0dGhpcy5yb3RhdGlvbiA9IHRoaXMuY29uZmlnLnJvdGF0aW9uICogUElYSS5ERUdfVE9fUkFEO1xyXG5cdHRoaXMuaGFzQmxpbmtlZCA9IGZhbHNlO1xyXG5cclxuXHQvLyBJbml0IGFuaW1hdGlvblxyXG5cdHRoaXMuYWxwaGEgPSAxO1xyXG5cdHRoaXMuaXNGYWRpbmcgPSBmYWxzZTtcclxuXHJcblx0aWYodGhpcy5pc0NvbGxlY3RhYmxlKVxyXG5cdHtcclxuXHRcdGlmKHRoaXMuaXNDb2xsZWN0ZWQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDAsICdpZGxlMicsIHRydWUsIDAuMik7XHJcblx0XHRcdHRoaXMuZ2xvdy52aXNpYmxlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHRpZihDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSAncGFiYmllJylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDAsICdpZGxlMycsIHRydWUsIDAuMik7XHJcblx0XHRcdFx0dGhpcy5nbG93LnZpc2libGUgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuZ2xvdy52aXNpYmxlID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zcGluZS5hbHBoYSA9IDAuNTtcclxuXHJcblx0XHRcdFx0Ly8gQWRkIGhlYWRcclxuXHRcdFx0XHR0aGlzLmNoYXJhID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwiaW5nYW1lX3Byb2dyZXNzX2NoYXJfcGFiYmllXCIpKTtcclxuXHRcdFx0XHR0aGlzLmNoYXJhLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHR0aGlzLmNoYXJhLnkgPSAtMTIwO1xyXG5cdFx0XHRcdHRoaXMuY2hhcmEueCA9IDEwO1xyXG5cdFx0XHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5jaGFyYSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdHRoaXMuc3BpbmUuc3RhdGUuYWRkQW5pbWF0aW9uQnlOYW1lKDAsICdpZGxlMScsIHRydWUsIDAuMik7XHJcblxyXG5cdFx0aWYodGhpcy5jb25maWcuZGF0YSAhPSBcIlwiKVxyXG5cdFx0e1xyXG5cdFx0XHR0cnlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdFx0XHR0aGlzLmNoYXJhY3RlciA9ICEhZGF0YS5jaGFyYWN0ZXIgPyBkYXRhLmNoYXJhY3RlciA6IG51bGw7XHJcblx0XHRcdFx0dGhpcy5jcnlzdGFsICAgPSAhIWRhdGEuY3J5c3RhbCA/IChwYXJzZUludChkYXRhLmNyeXN0YWwpLTEpIDogbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXRjaChlKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkRlY29yYXRpb24gZGF0YSBlcnJvciAlc1wiLCB0aGlzLmNvbmZpZy5kYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMuY2hhcmFjdGVyICE9IG51bGwgJiYgdGhpcy5jaGFyYWN0ZXIgIT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMuY2hhcmFjdGVyICE9IG51bGwgJiYgdGhpcy5jcnlzdGFsICE9IG51bGwgJiYgdGhpcy5jaGFyYWN0ZXIgPT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgJiYgQ29tbW9uLnNhdmVkRGF0YS5pc0NyeXN0YWxDb2xsZWN0ZWQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCwgdGhpcy5jaGFyYWN0ZXIsIHRoaXMuY3J5c3RhbCkpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gSW5pdCBjb2RlXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgICA9IHRoaXMuaXNDb2xsZWN0YWJsZSAmJiAhdGhpcy5pc0NvbGxlY3RlZDtcclxuXHR0aGlzLnNwcml0ZS52aXNpYmxlID0gZmFsc2U7XHJcblx0dmFyIHdpZHRoICA9IHRoaXMuc3ByaXRlLndpZHRoO1xyXG5cdHZhciBoZWlnaHQgPSB0aGlzLnNwcml0ZS5oZWlnaHQ7XHJcblxyXG5cdHRoaXMuY29sbGlzaW9uQ2lyY2xlID0gbmV3IFBJWEkuQ2lyY2xlKDAsIC10aGlzLnNwcml0ZS5oZWlnaHQvMiwgMTAwKTtcclxuXHJcblx0Ly8gRGVidWdcclxuXHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0dGhpcy5kcmF3Q29sbGlzaW9uKCk7XHJcbn1cclxuXHJcbk9iamVjdFRyb2xsLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYoISF0aGlzLnRpbWVsaW5lKVxyXG5cdHtcclxuXHRcdHRoaXMudGltZWxpbmUua2lsbCgpO1xyXG5cdFx0dGhpcy50aW1lbGluZSA9IG51bGw7XHJcblx0fVxyXG59XHJcblxyXG5PYmplY3RUcm9sbC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5waWNrdXBQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0Ly8gQW5pbWF0aW9uIHVwZGF0ZVxyXG5cdHRoaXMuc3BpbmUudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcblxyXG5cdC8vIEZhZGUgb3V0XHJcblx0aWYodGhpcy5pc0ZhZGluZylcclxuXHR7XHJcblx0XHR0aGlzLmFscGhhIC09IHAzLlRpbWVzdGVwLmRlbHRhVGltZS90aGlzLmZhZGVUaW1lO1xyXG5cdFx0aWYodGhpcy5hbHBoYSA8IDApXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuYWxwaGEgPSAwO1xyXG5cdFx0XHR0aGlzLmlzRmFkaW5nID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBCbGluayB3aGVuIGNsb3NlIGVub3VnaFxyXG5cdGlmKCF0aGlzLmhhc0JsaW5rZWQgJiYgdGhpcy52aXNpYmxlKVxyXG5cdHtcclxuXHRcdGlmKE1hdGguc3FydChNYXRoLnBvdyh0aGlzLmxldmVsLmF2YXRhci54IC0gdGhpcy54LCAyKSArIE1hdGgucG93KHRoaXMubGV2ZWwuYXZhdGFyLnkgLSB0aGlzLnksIDIpKSA8IDEwMDApXHJcblx0XHR7XHJcblx0XHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfdHJvbGxfbm90aWZ5XzAwXCIpO1xyXG5cdFx0XHR0aGlzLmhhc0JsaW5rZWQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbk9iamVjdFRyb2xsLnByb3RvdHlwZS5waWNrdXAgPSBmdW5jdGlvbih0YXJnZXQpXHJcbntcclxuXHRpZighdGhpcy5pbnRlcmFjdGl2ZSkgcmV0dXJuO1xyXG5cdGlmKCF0aGlzLmlzQ29sbGVjdGFibGUpIHJldHVybjtcclxuXHJcblx0dGhpcy5pbnRlcmFjdGl2ZSAgID0gZmFsc2U7XHJcblx0dGhpcy5waWNrdXBQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0Ly8gU3RvcmUgaW4gdGhlIHN0YXRpYyBmaWVsZCB0aGF0IHRoaXMgdHJvbGwgaGFzIGJlZW4gY29sbGVjdGVkXHJcblx0T2JqZWN0VHJvbGwucHJvdG90eXBlLmNvbGxlY3RlZC5wdXNoKHRoaXMuaW5kZXgpO1xyXG5cclxuXHRDb21tb24uc2F2ZWREYXRhLnRyb2xsc1tDb21tb24uc2F2ZWREYXRhLmxldmVsXVt0aGlzLmluZGV4XSA9IHRydWU7XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XHJcblxyXG5cdHRoaXMuc2V0QW5pbWF0aW9uKFwiaWRsZTJcIik7XHJcblxyXG5cdC8vIFNob3cgdGhlIHRvcCBjb250YWluZXJcclxuXHR0aGlzLmxldmVsLnBhcmVudC5nYW1lVUkudHJvbGxDb2xsZWN0ZWQoKTtcclxuXHJcblx0dGhpcy5zcGluZS5zdGF0ZS5hZGRBbmltYXRpb25CeU5hbWUoMCwgJ2NvbGxlY3RlZCcsIHRydWUsIDAuMik7XHJcblx0U291bmRTRlgucGxheShcInNmeF9waWNrdXBfdHJvbGxfMDFcIik7XHJcblxyXG5cdC8vIEhpZGUgdGhlIGdsb3dcclxuXHRpZighIXRoaXMudGltZWxpbmUpXHJcblx0e1xyXG5cdFx0dGhpcy50aW1lbGluZS5raWxsKCk7XHJcblx0XHR0aGlzLnRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHRcdHRoaXMudGltZWxpbmUudG8odGhpcy5nbG93LnNjYWxlLCAwLjMsIHt4OiAwLCB5OiAwLCBlYXNlOlF1YWQuZWFzZU91dH0sICAwKTtcclxuXHRcdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy50aW1lbGluZSk7XHJcblx0fVxyXG59O1xyXG5cclxuT2JqZWN0VHJvbGwucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uKGlkLCBsb29wKVxyXG57XHJcblx0aWYobG9vcCAmJiBpZCA9PSB0aGlzLmN1cnJlbnRBbmltYXRpb24pIHJldHVybjtcclxuXHJcblx0dGhpcy5jdXJyZW50QW5pbWF0aW9uID0gaWQ7XHJcblx0dGhpcy5zcGluZS5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMCwgaWQsIGxvb3AsIDApO1xyXG59IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxudmFyIEVtaXR0ZXJcdFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBPYmplY3RUdXRvcmlhbCgpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgXCJ0dXRvcmlhbFwiLCBmYWxzZSk7XHJcblxyXG5cdHRoaXMubGV2ZWwgICAgICAgID0gbnVsbDtcclxuXHR0aGlzLmNvbmZpZyAgICAgICA9IG51bGw7XHJcblx0dGhpcy50ZXh0ICAgICAgICAgPSBcIlwiO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0VHV0b3JpYWw7XHJcbk9iamVjdFR1dG9yaWFsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5PYmplY3RUdXRvcmlhbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBPYmplY3RUdXRvcmlhbDtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuT2JqZWN0VHV0b3JpYWwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihsKVxyXG57XHJcblx0aWYodGhpcy5zcHJpdGUgPT0gbnVsbClcclxuXHR7XHJcblx0XHR0aGlzLnNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSgpO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLnNwcml0ZSk7XHJcblx0fVxyXG59O1xyXG5cclxuT2JqZWN0VHV0b3JpYWwucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgICA9IG51bGw7XHJcblx0dGhpcy5jb25maWcgICA9IG51bGw7XHJcbn1cclxuXHJcbk9iamVjdFR1dG9yaWFsLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbihsZXZlbCwgY29uZmlnKVxyXG57XHJcblx0dGhpcy5sZXZlbCAgPSBsZXZlbDtcclxuXHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuXHJcblx0dGhpcy54ID0gdGhpcy5jb25maWcucG9zaXRpb24ueDtcclxuXHR0aGlzLnkgPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi55O1xyXG5cdHRoaXMuc3ByaXRlLnRleHR1cmUgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmNvbmZpZy50ZXh0dXJlKTtcclxuXHR0aGlzLnNwcml0ZS5hbmNob3Iuc2V0KHRoaXMuY29uZmlnLmFuY2hvci54LCB0aGlzLmNvbmZpZy5hbmNob3IueSk7XHJcblx0dGhpcy5zcHJpdGUuc2NhbGUgLnNldCh0aGlzLmNvbmZpZy5zY2FsZS54LCB0aGlzLmNvbmZpZy5zY2FsZS55KTtcclxuXHR0aGlzLnJvdGF0aW9uID0gdGhpcy5jb25maWcucm90YXRpb24gKiBQSVhJLkRFR19UT19SQUQ7XHJcblxyXG5cdGlmKHRoaXMuY29uZmlnLmRhdGEgIT0gXCJcIilcclxuXHR7XHJcblx0XHR0cnlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGRhdGEgPSBKU09OLnBhcnNlKHRoaXMuY29uZmlnLmRhdGEpO1xyXG5cdFx0XHR0aGlzLnRleHQgID0gISFkYXRhLnRleHQgPyBkYXRhLnRleHQgOiBcIldFTExfRE9ORVwiO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2goZSlcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihcIlR1dG9yaWFsIG9iamVjdCBkYXRhIGVycm9yICVzXCIsIHRoaXMuY29uZmlnLmRhdGEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcdFxyXG5cdC8vIEluaXQgY29kZVxyXG5cdHRoaXMuaW50ZXJhY3RpdmUgICAgPSBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciAhPSBcInBhYmJpZVwiO1xyXG5cdHRoaXMuc3ByaXRlLnZpc2libGUgPSB0aGlzLmxldmVsLmRlYnVnO1xyXG5cdHZhciB3aWR0aCAgPSB0aGlzLnNwcml0ZS53aWR0aDtcclxuXHR2YXIgaGVpZ2h0ID0gdGhpcy5zcHJpdGUuaGVpZ2h0O1xyXG5cdHRoaXMuY29sbGlzaW9uUmVjdCA9IG5ldyBQSVhJLlJlY3RhbmdsZSgtd2lkdGggKiB0aGlzLnNwcml0ZS5hbmNob3IueCwgKC10aGlzLnNwcml0ZS5hbmNob3IueSkgKiBoZWlnaHQsIHdpZHRoLCBoZWlnaHQpO1xyXG59XHJcblxyXG5PYmplY3RUdXRvcmlhbC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufVxyXG5cclxuT2JqZWN0VHV0b3JpYWwucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufTtcclxuXHJcbk9iamVjdFR1dG9yaWFsLnByb3RvdHlwZS5oaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZighdGhpcy5pbnRlcmFjdGl2ZSkgcmV0dXJuO1xyXG5cclxuXHR0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XHJcblx0dGhpcy5sZXZlbC5wYXJlbnQuZ2FtZVVJLnR1dG9yaWFsKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVt0aGlzLnRleHRdW0NvbW1vbi5DT1VOVFJZX0NPREVdKTtcclxuXHRcclxuXHRpZih0aGlzLnRleHQgPT0gXCJUVVRPUklBTF9UVU1CTEVcIilcclxuXHR7XHJcblx0XHR0aGlzLmxldmVsLnBhcmVudC5nYW1lVUkuaGlnaGxpZ2h0KFwic3R5bGVcIilcclxuXHR9XHJcbn07IiwidmFyIENvbW1vbiAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIEdhbWVPYmplY3QgID0gcmVxdWlyZShcIi4vR2FtZU9iamVjdFwiKTtcclxudmFyIEVtaXR0ZXJcdFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9FbWl0dGVyXCIpO1xyXG52YXIgU291bmRTRlggICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBSdW5uaW5nRW50aXR5KG5hbWUpXHJcbntcclxuXHRHYW1lT2JqZWN0LmNhbGwodGhpcywgbmFtZSwgZmFsc2UpO1xyXG5cclxuXHR0aGlzLmFsbG93UGF0aENvbGxpc2lvbnMgICA9IHRydWU7XHJcblx0dGhpcy5pc0dyb3VuZGVkICAgICAgICAgICAgPSBmYWxzZTtcclxuXHR0aGlzLmNvbGxpc2lvblBvaW50ICAgICAgICA9IG51bGw7XHJcblx0dGhpcy5hbmdsZVRhcmdldCAgICAgICAgICAgPSAwO1xyXG5cdHRoaXMudmVsb2NpdHkgICAgICAgICAgICAgID0gbmV3IFBJWEkuUG9pbnQoKTtcclxuXHR0aGlzLmlnbm9yZUFydGlmaWNpYWxQYXRocyA9IHRydWU7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBSdW5uaW5nRW50aXR5O1xyXG5SdW5uaW5nRW50aXR5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR2FtZU9iamVjdC5wcm90b3R5cGUpO1xyXG5SdW5uaW5nRW50aXR5LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFJ1bm5pbmdFbnRpdHk7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBNb3ZlIHRoZSBjaGFyYWN0ZXIgYW5kIGhhbmRsZSBjb2xsaXNpb25zXHJcbiAqIEBwYXJhbSB7UElYSS5Qb2ludH0gdmVsb2NpdHlcclxuICovXHJcblJ1bm5pbmdFbnRpdHkucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbih2ZWxvY2l0eSlcclxue1xyXG5cdHZhciBkaXJlY3Rpb25ZID0gTWF0aC5zaWduKHZlbG9jaXR5LnkpO1xyXG5cdFxyXG5cdC8vIENhbGN1bGF0ZSBzcGVlZFxyXG5cdHZhciB2ZWxvY2l0eSA9IG5ldyBQSVhJLlBvaW50XHJcblx0KFxyXG5cdFx0dmVsb2NpdHkueCAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZSxcclxuXHRcdHZlbG9jaXR5LnkgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWVcclxuXHQpO1xyXG5cclxuXHQvLyBRdWlja2ZpeDogTGltaXQgdmVydGljYWwgc3BlZWQgdG8gZGlhbWV0ZXIgdG8gYXZvaWQgcGFzc2luZyB0aHJvdWdoIGNvbGxpc2lvbiBsaW5lc1xyXG5cdGlmKHZlbG9jaXR5LnkgPiAwICYmIHZlbG9jaXR5LnkgPj0gdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKVxyXG5cdHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKFwic3BlZWQgbGltaXQgYWN0aXZhdGVkXCIpXHJcblx0XHR2ZWxvY2l0eS55ID0gdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICogMC45OTtcclxuXHR9XHJcblxyXG5cdC8vIEFkanVzdCBzcGVlZCB0byBzbG9wZSBhbmdsZVxyXG5cdGlmKHRoaXMuaXNHcm91bmRlZCAmJiAhIXRoaXMuY29sbGlzaW9uUG9pbnQpXHJcblx0e1xyXG5cdFx0dmVsb2NpdHkueCAqPSAgTWF0aC5jb3ModGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZSlcclxuXHR9XHJcblxyXG5cdC8vIEFwcGx5IG1vdmVtZW50XHJcblx0dGhpcy54ICs9IHZlbG9jaXR5Lng7XHJcblx0dGhpcy55ICs9IHZlbG9jaXR5Lnk7XHJcblxyXG5cdC8vIENvbGxpc2lvbnNcclxuXHRpZih0aGlzLmFsbG93UGF0aENvbGxpc2lvbnMpXHJcblx0e1xyXG5cdFx0dmFyIHdhc0dyb3VuZGVkICAgICA9IHRoaXMuaXNHcm91bmRlZDtcclxuXHRcdHRoaXMuY29sbGlzaW9uUG9pbnQgPSBudWxsO1xyXG5cdFx0dGhpcy5pc0dyb3VuZGVkICAgICA9IGZhbHNlO1xyXG5cclxuXHRcdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHR7XHJcblx0XHRcdGlmKCEhdGhpcy53aXJlZnJhbWUpXHJcblx0XHRcdFx0dGhpcy5sZXZlbC5yZW1vdmVDaGlsZCh0aGlzLndpcmVmcmFtZSlcclxuXHJcblx0XHRcdHRoaXMud2lyZWZyYW1lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHRcdFx0dGhpcy53aXJlZnJhbWUuY29uZmlnID0ge2RlcHRoOjEwMDB9O1xyXG5cdFx0XHR0aGlzLmxldmVsLmFkZENoaWxkKHRoaXMud2lyZWZyYW1lKVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFRvcCBjb2xsaXNpb25zXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZXZlbC5sYXllcnMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzLmxlbmd0aDsgaisrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly8gQ29sbGlkZSBvbmx5IHdpdGggY2xvc2VkIHBhdGhzXHJcblx0XHRcdFx0Ly8gaWYoIXRoaXMubGV2ZWwubGF5ZXJzW2ldLmNoaWxkcmVuUGF0aHNbal0uY29uZmlnLmNsb3NlZCkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBwYXRoIGlzIHJlbGV2YW50XHJcblx0XHRcdFx0aWYodGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5jb25maWcuY29sbGlzaW9ucyAhPSAxKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy5ib3VuZHNbMF0gPiB0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICogMikgY29udGludWU7XHJcblx0XHRcdFx0aWYodGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5jb25maWcuYm91bmRzWzFdIDwgdGhpcy54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUueCAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyAqIDIpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGlmKHRoaXMuaXNTaHJpbmtpbmcgJiYgdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5pc1Nocmlua1BhdGgoKSkgY29udGludWU7XHJcblx0XHRcdFx0aWYodGhpcy5pZ25vcmVBcnRpZmljaWFsUGF0aHMgJiYgdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5pc0FydGlmaWNpYWxQYXRoKCkpIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHQvLyBMb29wIHRocm91Z2ggdGhlIHBhdGggc2VnbWVudHNcclxuXHRcdFx0XHR2YXIgcG9pbnRzID0gdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5iZXppZXIuZ2V0RHJhd2luZ1BvaW50cygpO1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIHAgPSAwOyBwIDwgcG9pbnRzLmxlbmd0aC0xOyBwKyspXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Ly8gU2VnbWVudCBwb2ludHNcclxuXHRcdFx0XHRcdHZhciBwMSA9IHBvaW50c1twKzFdO1xyXG5cdFx0XHRcdFx0dmFyIHAyID0gcG9pbnRzW3BdO1xyXG5cclxuXHRcdFx0XHRcdC8vIFNraXAgc2VnbWVudHMgZmFjaW5nIHVwXHJcblx0XHRcdFx0XHRpZihwMS54ID4gcDIueCkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQ2lyY2xlIGNvbGxpZGVyIGNlbnRlclxyXG5cdFx0XHRcdFx0dmFyIHBBdmF0YXIgPSBuZXcgUElYSS5Qb2ludCh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54LCB0aGlzLnkgKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS55KTtcclxuXHJcblx0XHRcdFx0XHQvLyBJcyB0aGUgc2VnbWVudCBjbG9zZSB0byB0aGUgY29sbGlkZXI/XHJcblx0XHRcdFx0XHRpZihwMS54ID4gcEF2YXRhci54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmKHAyLnggPCBwQXZhdGFyLnggLSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0aWYocDEueSA+IHBBdmF0YXIueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cyAmJiBwMi55ID4gcEF2YXRhci55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmKHAxLnkgPCBwQXZhdGFyLnkgLSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgJiYgcDIueSA8IHBBdmF0YXIueSAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU2VnbWVudCBvZiB0aGUgYmV6aWVyIGN1cnZlXHJcblx0XHRcdFx0XHR2YXIgc2VnbWVudCA9IG5ldyBQSVhJLlBvaW50KHBvaW50c1twKzFdLnggLSBwb2ludHNbcF0ueCwgcG9pbnRzW3ArMV0ueSAtIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHRcdHZhciBzZWdtZW50Tm9ybWFsaXplZCA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnQueCwgc2VnbWVudC55KTtcclxuXHRcdFx0XHRcdHNlZ21lbnROb3JtYWxpemVkLm5vcm1hbGl6ZSgpO1xyXG5cclxuXHRcdFx0XHRcdC8vIEF2YXRhci1zZWdtZW50IHZlY3RvclxyXG5cdFx0XHRcdFx0dmFyIHZBdmF0YXIgPSBuZXcgUElYSS5Qb2ludCh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54IC0gcG9pbnRzW3BdLngsIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnkgLSBwb2ludHNbcF0ueSk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQ2FsY3VsYXRlIHRoZSBwcm9qZWN0aW9uIG9mIHZBdmF0YXIgb250byB0aGUgc2VnbWVudFxyXG5cdFx0XHRcdFx0dmFyIHZQcm9qTGVuZ3RoID0gdkF2YXRhci5kb3RQcm9kdWN0KHNlZ21lbnQpIC8gc2VnbWVudC5nZXRMZW5ndGgoKTtcclxuXHRcdFx0XHRcdHZhciB2UHJvaiAgICAgICA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnROb3JtYWxpemVkLnggKiB2UHJvakxlbmd0aCwgc2VnbWVudE5vcm1hbGl6ZWQueSAqIHZQcm9qTGVuZ3RoKTtcclxuXHJcblx0XHRcdFx0XHQvLyBDbGFtcCB0aGUgcHJvamVjdGlvbiB2ZWN0b3JcclxuXHRcdFx0XHRcdGlmKHZQcm9qLnggIT0gc2VnbWVudC54KVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRpZih2UHJvai54L3NlZ21lbnQueCA8IDApXHJcblx0XHRcdFx0XHRcdFx0dlByb2ogPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdFx0XHRcdFx0XHRpZih2UHJvai54L3NlZ21lbnQueCA+IDEpXHJcblx0XHRcdFx0XHRcdFx0dlByb2ogPSBuZXcgUElYSS5Qb2ludChzZWdtZW50LngsIHNlZ21lbnQueSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGlmKHZQcm9qLnkvc2VnbWVudC55IDwgMClcclxuXHRcdFx0XHRcdFx0XHR2UHJvaiA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0XHRcdFx0XHRcdGlmKHZQcm9qLnkvc2VnbWVudC55ID4gMSlcclxuXHRcdFx0XHRcdFx0XHR2UHJvaiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnQueCwgc2VnbWVudC55KTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHBlcnBlbmRpY3VsYXJcclxuXHRcdFx0XHRcdHZhciBwZXJwID0gbmV3IFBJWEkuUG9pbnQodlByb2oueCAtIHZBdmF0YXIueCwgdlByb2oueSAtIHZBdmF0YXIueSk7XHJcblx0XHRcdFx0XHR2YXIgcGVycExlbmd0aCA9IHBlcnAuZ2V0TGVuZ3RoKCk7XHJcblxyXG5cdFx0XHRcdFx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDgsIDB4ZmZmZmZmLCAxKTtcclxuXHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHAxLngsIHAxLnkpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocDIueCwgcDIueSk7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoNiwgMHgwMDAwZmYsIDEpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8ocEF2YXRhci54LCBwQXZhdGFyLnkpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocEF2YXRhci54IC0gdkF2YXRhci54LCBwQXZhdGFyLnkgLSB2QXZhdGFyLnkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIElmIHRoZSBsZW5ndGggb2YgdGhlIHBlcnBlbmRpY3VsYXIgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMgdGhlIHNlZ21lbnQgY29sbGlkZXMgd2l0aCB0aGUgY2lyY2xlXHJcblx0XHRcdFx0XHRpZihwZXJwTGVuZ3RoIDwgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDMsIDB4ZmYwMGZmLCAxKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8ocG9pbnRzW3BdLngsIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzW3BdLnggKyB2UHJvai54LCBwb2ludHNbcF0ueSArIHZQcm9qLnkpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoNSwgMHgwMGZmMDAsIDEpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyhwb2ludHNbcF0ueCArIHZQcm9qLngsIHBvaW50c1twXS55ICsgdlByb2oueSk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHBvaW50c1twXS54ICsgdlByb2oueCAtIHBlcnAueCwgcG9pbnRzW3BdLnkgKyB2UHJvai55IC0gcGVycC55KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0Ly8gSWYgdGhlIGNoYXJhY3RlciB3YXMgbW92aW5nIGFnYWluc3QgdGhlIHdhbGwsIHB1c2ggaXQgYmFja1xyXG5cdFx0XHRcdFx0XHRpZih2ZWxvY2l0eS54ICE9IDApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnggKz0gLU1hdGguc2lnbih2ZWxvY2l0eS54KSAqICh0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgLSBwZXJwTGVuZ3RoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0Ly8gSWYgdGhlIGNoYXJhY3RlciB3YXMganVtcGluZyBtYWtlIGl0IGZhbGxcclxuXHRcdFx0XHRcdFx0aWYodGhpcy52ZWxvY2l0eS55IDwgMClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMueSAtPSB2ZWxvY2l0eS55O1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudmVsb2NpdHkueSA9IDIwMDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdyb3VuZCBjb2xsaXNpb25cclxuXHRcdHZhciBzbG9wZUFuZ2xlTWF4ID0gODA7XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGV2ZWwubGF5ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRocy5sZW5ndGg7IGorKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBwYXRoIGlzIHJlbGV2YW50XHJcblx0XHRcdFx0aWYodGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5jb25maWcuY29sbGlzaW9ucyA9PSAwKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy5jb2xsaXNpb25zID09IDIgJiYgZGlyZWN0aW9uWSA8IDApIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGlmKHRoaXMubGV2ZWwubGF5ZXJzW2ldLmNoaWxkcmVuUGF0aHNbal0uY29uZmlnLmJvdW5kc1swXSA+IHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgKiAyKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy5ib3VuZHNbMV0gPCB0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54IC0gdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICogMikgY29udGludWU7XHJcblx0XHRcdFx0aWYodGhpcy5pc1Nocmlua2luZyAmJiB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmlzU2hyaW5rUGF0aCgpKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih0aGlzLmlnbm9yZUFydGlmaWNpYWxQYXRocyAmJiB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmlzQXJ0aWZpY2lhbFBhdGgoKSkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdC8vIExvb3AgdGhyb3VnaCB0aGUgcGF0aCBzZWdtZW50c1xyXG5cdFx0XHRcdHZhciBwb2ludHMgPSB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmJlemllci5nZXREcmF3aW5nUG9pbnRzKCk7XHJcblxyXG5cdFx0XHRcdGRvXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIHJlcGVhdCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHRcdGZvcih2YXIgcCA9IDA7IHAgPCBwb2ludHMubGVuZ3RoLTE7IHArKylcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Ly8gU2VnbWVudCBwb2ludHNcclxuXHRcdFx0XHRcdFx0dmFyIHAxID0gcG9pbnRzW3BdO1xyXG5cdFx0XHRcdFx0XHR2YXIgcDIgPSBwb2ludHNbcCsxXTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIFNraXAgc2VnbWVudHMgZmFjaW5nIGRvd25cclxuXHRcdFx0XHRcdFx0aWYocDEueCA+IHAyLngpIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gQ2lyY2xlIGNvbGxpZGVyIGNlbnRlclxyXG5cdFx0XHRcdFx0XHR2YXIgcEF2YXRhciA9IG5ldyBQSVhJLlBvaW50KHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLngsIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnkpO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gSXMgdGhlIHNlZ21lbnQgY2xvc2UgdG8gdGhlIGNvbGxpZGVyP1xyXG5cdFx0XHRcdFx0XHRpZihwMS54ID4gcEF2YXRhci54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdFx0aWYocDIueCA8IHBBdmF0YXIueCAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblx0XHRcdFx0XHRcdGlmKHAxLnkgPiBwQXZhdGFyLnkgKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgJiYgcDIueSA+IHBBdmF0YXIueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblx0XHRcdFx0XHRcdGlmKHAxLnkgPCBwQXZhdGFyLnkgLSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgJiYgcDIueSA8IHBBdmF0YXIueSAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBTa2lwIHNsb3BlcyB0aGF0IGFyZSB0b28gaW5jbGluZWRcclxuXHRcdFx0XHRcdFx0dmFyIHNlZ21lbnRBbmdsZSA9IE1hdGguYXRhbjIoKHAyLnkgLSBwMS55KSwgKHAyLnggLSBwMS54KSk7XHJcblx0XHRcdFx0XHRcdGlmKE1hdGguYWJzKHNlZ21lbnRBbmdsZSAqIFBJWEkuUkFEX1RPX0RFRykgPj0gc2xvcGVBbmdsZU1heCkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBKdW1wdGhyb3VnaCBwYXRoc1xyXG5cdFx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy5jb2xsaXNpb25zID09IDIpXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRpZighd2FzR3JvdW5kZWQpXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gSWYgaXQncyBhIHBhdGggdGhhdCBjYW4gYmUganVtcGVkIHRocm91Z2gsIG1ha2Ugc3VyZSB0aGF0IHRoZSBib3R0b20gb2YgdGhlIGNpcmNsZSBjb2xsaWRlciBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIHBhdGggYmVmb3JlIGF0dGVtcHRpbmcgdG8gc3RpY2sgdG8gaXRcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBkWCA9IChwQXZhdGFyLnggLSBwMS54KS8ocDIueCAtIHAxLngpO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZFggPSBNYXRoLm1pbihNYXRoLm1heChkWCwgMCksIDEpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHNZID0gcDEueSArIChwMi55IC0gcDEueSkgKiBkWDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRpZihwQXZhdGFyLnkgPiBzWSkgY29udGludWU7XHJcblx0XHRcdFx0XHRcdFx0fSBcclxuXHJcblx0XHRcdFx0XHRcdFx0aWYoTWF0aC5hYnMoc2VnbWVudEFuZ2xlICogUElYSS5SQURfVE9fREVHKSA+PSB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy50ZXhXYWxsQW5nbGUpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBTZWdtZW50IG9mIHRoZSBiZXppZXIgY3VydmVcclxuXHRcdFx0XHRcdFx0dmFyIHNlZ21lbnQgPSBuZXcgUElYSS5Qb2ludChwb2ludHNbcCsxXS54IC0gcG9pbnRzW3BdLngsIHBvaW50c1twKzFdLnkgLSBwb2ludHNbcF0ueSk7XHJcblx0XHRcdFx0XHRcdHZhciBzZWdtZW50Tm9ybWFsaXplZCA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnQueCwgc2VnbWVudC55KTtcclxuXHRcdFx0XHRcdFx0c2VnbWVudE5vcm1hbGl6ZWQubm9ybWFsaXplKCk7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBBdmF0YXItc2VnbWVudCB2ZWN0b3JcclxuXHRcdFx0XHRcdFx0dmFyIHZBdmF0YXIgPSBuZXcgUElYSS5Qb2ludCh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54IC0gcG9pbnRzW3BdLngsIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnkgLSBwb2ludHNbcF0ueSk7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHByb2plY3Rpb24gb2YgdkF2YXRhciBvbnRvIHRoZSBzZWdtZW50XHJcblx0XHRcdFx0XHRcdHZhciB2UHJvakxlbmd0aCA9IHZBdmF0YXIuZG90UHJvZHVjdChzZWdtZW50KSAvIHNlZ21lbnQuZ2V0TGVuZ3RoKCk7XHJcblx0XHRcdFx0XHRcdHZhciB2UHJvaiAgICAgICA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnROb3JtYWxpemVkLnggKiB2UHJvakxlbmd0aCwgc2VnbWVudE5vcm1hbGl6ZWQueSAqIHZQcm9qTGVuZ3RoKTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIENsYW1wIHRoZSBwcm9qZWN0aW9uIHZlY3RvclxyXG5cdFx0XHRcdFx0XHRpZih2UHJvai54ICE9IHNlZ21lbnQueClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdGlmKHZQcm9qLngvc2VnbWVudC54IDwgMCAmJiAhd2FzR3JvdW5kZWQpIGNvbnRpbnVlOyAvLyBUZXN0IGZpeDogZG9uJ3QgZXh0cmFwb2xhdGUgdGhlIHByb2plY3Rpb24gcG9pbnQgaWYganVtcGluZ1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZih2UHJvai54L3NlZ21lbnQueCA8IDApXHJcblx0XHRcdFx0XHRcdFx0XHR2UHJvaiA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0XHRcdFx0XHRcdFx0aWYodlByb2oueC9zZWdtZW50LnggPiAxKVxyXG5cdFx0XHRcdFx0XHRcdFx0dlByb2ogPSBuZXcgUElYSS5Qb2ludChzZWdtZW50LngsIHNlZ21lbnQueSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0aWYodlByb2oueS9zZWdtZW50LnkgPCAwKVxyXG5cdFx0XHRcdFx0XHRcdFx0dlByb2ogPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdFx0XHRcdFx0XHRcdGlmKHZQcm9qLnkvc2VnbWVudC55ID4gMSlcclxuXHRcdFx0XHRcdFx0XHRcdHZQcm9qID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudC54LCBzZWdtZW50LnkpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHBlcnBlbmRpY3VsYXJcclxuXHRcdFx0XHRcdFx0dmFyIHBlcnAgPSBuZXcgUElYSS5Qb2ludCh2UHJvai54IC0gdkF2YXRhci54LCB2UHJvai55IC0gdkF2YXRhci55KTtcclxuXHRcdFx0XHRcdFx0dmFyIHBlcnBMZW5ndGggPSBwZXJwLmdldExlbmd0aCgpO1xyXG5cclxuXHRcdFx0XHRcdFx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSg4LCAweGZmZmZmZiwgMSk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHAxLngsIHAxLnkpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwMi54LCBwMi55KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDYsIDB4MDAwMGZmLCAxKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8ocEF2YXRhci54LCBwQXZhdGFyLnkpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwQXZhdGFyLnggLSB2QXZhdGFyLngsIHBBdmF0YXIueSAtIHZBdmF0YXIueSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vIElmIHRoZSBsZW5ndGggb2YgdGhlIHBlcnBlbmRpY3VsYXIgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMgdGhlIHNlZ21lbnQgY29sbGlkZXMgd2l0aCB0aGUgY2lyY2xlXHJcblx0XHRcdFx0XHRcdGlmKHBlcnBMZW5ndGggPCB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMpXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmRlYnVnKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSgzLCAweGZmMDBmZiwgMSk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8ocG9pbnRzW3BdLngsIHBvaW50c1twXS55KTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwb2ludHNbcF0ueCArIHZQcm9qLngsIHBvaW50c1twXS55ICsgdlByb2oueSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDUsIDB4ZmYwMDAwLCAxKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyhwb2ludHNbcF0ueCArIHZQcm9qLngsIHBvaW50c1twXS55ICsgdlByb2oueSk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lVG8ocG9pbnRzW3BdLnggKyB2UHJvai54IC0gcGVycC54LCBwb2ludHNbcF0ueSArIHZQcm9qLnkgLSBwZXJwLnkpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gQ29sbGlzaW9uIVxyXG5cdFx0XHRcdFx0XHRcdHZlbG9jaXR5LnkgPSAwO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaXNHcm91bmRlZCA9IHRydWU7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIE1vdmUgdGhlIGNoYXJhY3RlciB1cCBieSB0aGUgdmVydGljYWwgZGlzdGFuY2UgYmV0d2VlbiB0aGUgcHJvamVjdGlvbiBlbmQgcG9pbnQgYW5kIHRoZSBwb2ludCBvbiB0aGUgY2lyY3VtZmVyZW5jZVxyXG5cdFx0XHRcdFx0XHRcdHBlcnAubm9ybWFsaXplKCk7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGFuZ2xlRG93biA9IHBlcnAuYW5nbGUobmV3IFBJWEkuUG9pbnQoMCwxKSlcclxuXHRcdFx0XHRcdFx0XHR2YXIgZGVsdGEgICAgID0gKE1hdGguc2luKE1hdGguYWNvcyhNYXRoLnNpbihhbmdsZURvd24pKSkgKiB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMpIC0gKE1hdGguYWJzKE1hdGguY29zKGFuZ2xlRG93bikpICogcGVycExlbmd0aCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy55ICAgICAgICAtPSBkZWx0YTtcclxuXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5jb2xsaXNpb25Qb2ludCA9XHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0cGF0aCA6IHRoaXMubGV2ZWwubGF5ZXJzW2ldLmNoaWxkcmVuUGF0aHNbal0sXHJcblx0XHRcdFx0XHRcdFx0XHRwb3NpdGlvbjpcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0eDogcG9pbnRzW3BdLnggKyB2UHJvai54LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR5OiBwb2ludHNbcF0ueSArIHZQcm9qLnlcclxuXHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRhbmdsZTogc2VnbWVudEFuZ2xlXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRpZihkZWx0YSA+PSAxKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHJlcGVhdCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSB3aGlsZShyZXBlYXQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gV2hlbiBkZXNjZW5kaW5nIGEgc2xvcGUsIHN0aWNrIHRvIGl0XHJcblx0XHRpZighdGhpcy5pc0dyb3VuZGVkICYmIHdhc0dyb3VuZGVkICYmIHZlbG9jaXR5LnkgPiAwKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgc2xvcGVBbmdsZU1heCAgID0gODA7XHJcblx0XHRcdHZhciBzbG9wZVRvbGxlcmFuY2UgPSA1MDtcclxuXHRcdFx0dmFyIHNsb3BlRGlzdGFuY2UgICA9IHNsb3BlVG9sbGVyYW5jZTtcclxuXHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxldmVsLmxheWVycy5sZW5ndGg7IGkrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzLmxlbmd0aDsgaisrKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBwYXRoIGlzIHJlbGV2YW50XHJcblx0XHRcdFx0XHRpZih0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmNvbmZpZy5jb2xsaXNpb25zID09IDApIGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0aWYodGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5jb25maWcuY29sbGlzaW9ucyA9PSAyICYmIGRpcmVjdGlvblkgPCAwKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmKHRoaXMubGV2ZWwubGF5ZXJzW2ldLmNoaWxkcmVuUGF0aHNbal0uY29uZmlnLmJvdW5kc1swXSA+IHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgKiAyKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmKHRoaXMubGV2ZWwubGF5ZXJzW2ldLmNoaWxkcmVuUGF0aHNbal0uY29uZmlnLmJvdW5kc1sxXSA8IHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnggLSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgKiAyKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdGlmKHRoaXMuaXNTaHJpbmtpbmcgJiYgdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5pc1Nocmlua1BhdGgoKSkgY29udGludWU7XHJcblx0XHRcdFx0XHRpZih0aGlzLmlnbm9yZUFydGlmaWNpYWxQYXRocyAmJiB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLmlzQXJ0aWZpY2lhbFBhdGgoKSkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0Ly8gTG9vcCB0aHJvdWdoIHRoZSBwYXRoIHNlZ21lbnRzXHJcblx0XHRcdFx0XHR2YXIgcG9pbnRzID0gdGhpcy5sZXZlbC5sYXllcnNbaV0uY2hpbGRyZW5QYXRoc1tqXS5iZXppZXIuZ2V0RHJhd2luZ1BvaW50cygpO1xyXG5cclxuXHRcdFx0XHRcdGZvcih2YXIgcCA9IDA7IHAgPCBwb2ludHMubGVuZ3RoLTE7IHArKylcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Ly8gU2VnbWVudCBwb2ludHNcclxuXHRcdFx0XHRcdFx0dmFyIHAxID0gcG9pbnRzW3BdO1xyXG5cdFx0XHRcdFx0XHR2YXIgcDIgPSBwb2ludHNbcCsxXTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIFNraXAgc2VnbWVudHMgZmFjaW5nIGRvd25cclxuXHRcdFx0XHRcdFx0aWYocDEueCA+IHAyLngpIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gQ2lyY2xlIGNvbGxpZGVyIGNlbnRlclxyXG5cdFx0XHRcdFx0XHR2YXIgcEF2YXRhciA9IG5ldyBQSVhJLlBvaW50KHRoaXMueCArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLngsIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnkpO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gSXMgdGhlIHNlZ21lbnQgY2xvc2UgdG8gdGhlIGNvbGxpZGVyP1xyXG5cdFx0XHRcdFx0XHRpZihwMS54ID4gcEF2YXRhci54ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzKSBjb250aW51ZTtcclxuXHRcdFx0XHRcdFx0aWYocDIueCA8IHBBdmF0YXIueCAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblx0XHRcdFx0XHRcdGlmKHAxLnkgPCBwQXZhdGFyLnkgLSB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgJiYgcDIueSA8IHBBdmF0YXIueSAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cykgY29udGludWU7XHJcblx0XHRcdFx0XHRcdGlmKHAxLnkgPiBwQXZhdGFyLnkgKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS5yYWRpdXMgKyA1MCAmJiBwMi55ID4gcEF2YXRhci55ICsgdGhpcy5jb2xsaXNpb25DaXJjbGUucmFkaXVzICsgNTApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gU2tpcCBzbG9wZXMgdGhhdCBhcmUgdG9vIGluY2xpbmVkXHJcblx0XHRcdFx0XHRcdHZhciBzZWdtZW50QW5nbGUgPSBNYXRoLmF0YW4yKChwMi55IC0gcDEueSksIChwMi54IC0gcDEueCkpO1xyXG5cdFx0XHRcdFx0XHRpZihNYXRoLmFicyhzZWdtZW50QW5nbGUgKiBQSVhJLlJBRF9UT19ERUcpID4gc2xvcGVBbmdsZU1heCkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBTZWdtZW50IG9mIHRoZSBiZXppZXIgY3VydmVcclxuXHRcdFx0XHRcdFx0dmFyIHNlZ21lbnQgPSBuZXcgUElYSS5Qb2ludChwb2ludHNbcCsxXS54IC0gcG9pbnRzW3BdLngsIHBvaW50c1twKzFdLnkgLSBwb2ludHNbcF0ueSk7XHJcblx0XHRcdFx0XHRcdHZhciBzZWdtZW50Tm9ybWFsaXplZCA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnQueCwgc2VnbWVudC55KTtcclxuXHRcdFx0XHRcdFx0c2VnbWVudE5vcm1hbGl6ZWQubm9ybWFsaXplKCk7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBBdmF0YXItc2VnbWVudCB2ZWN0b3JcclxuXHRcdFx0XHRcdFx0dmFyIHZBdmF0YXIgPSBuZXcgUElYSS5Qb2ludCh0aGlzLnggKyB0aGlzLmNvbGxpc2lvbkNpcmNsZS54IC0gcG9pbnRzW3BdLngsIHRoaXMueSArIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnkgLSBwb2ludHNbcF0ueSk7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHByb2plY3Rpb24gb2YgdkF2YXRhciBvbnRvIHRoZSBzZWdtZW50XHJcblx0XHRcdFx0XHRcdHZhciB2UHJvakxlbmd0aCA9IHZBdmF0YXIuZG90UHJvZHVjdChzZWdtZW50KSAvIHNlZ21lbnQuZ2V0TGVuZ3RoKCk7XHJcblx0XHRcdFx0XHRcdHZhciB2UHJvaiAgICAgICA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnROb3JtYWxpemVkLnggKiB2UHJvakxlbmd0aCwgc2VnbWVudE5vcm1hbGl6ZWQueSAqIHZQcm9qTGVuZ3RoKTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIENsYW1wIHRoZSBwcm9qZWN0aW9uIHZlY3RvclxyXG5cdFx0XHRcdFx0XHRpZih2UHJvai54ICE9IHNlZ21lbnQueClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdGlmKHZQcm9qLngvc2VnbWVudC54IDwgMClcclxuXHRcdFx0XHRcdFx0XHRcdHZQcm9qID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHRcdFx0XHRcdFx0XHRpZih2UHJvai54L3NlZ21lbnQueCA+IDEpXHJcblx0XHRcdFx0XHRcdFx0XHR2UHJvaiA9IG5ldyBQSVhJLlBvaW50KHNlZ21lbnQueCwgc2VnbWVudC55KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRpZih2UHJvai55L3NlZ21lbnQueSA8IDApXHJcblx0XHRcdFx0XHRcdFx0XHR2UHJvaiA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0XHRcdFx0XHRcdFx0aWYodlByb2oueS9zZWdtZW50LnkgPiAxKVxyXG5cdFx0XHRcdFx0XHRcdFx0dlByb2ogPSBuZXcgUElYSS5Qb2ludChzZWdtZW50LngsIHNlZ21lbnQueSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgcGVycGVuZGljdWxhclxyXG5cdFx0XHRcdFx0XHR2YXIgcGVycCAgPSBuZXcgUElYSS5Qb2ludCh2UHJvai54IC0gdkF2YXRhci54LCB2UHJvai55IC0gdkF2YXRhci55KTtcclxuXHRcdFx0XHRcdFx0dmFyIHBlcnBMZW5ndGggPSBwZXJwLmdldExlbmd0aCgpO1xyXG5cclxuXHRcdFx0XHRcdFx0aWYodGhpcy5sZXZlbC5kZWJ1ZylcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVTdHlsZSg4LCAweGZmZmZmZiwgMSk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHAxLngsIHAxLnkpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwMi54LCBwMi55KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDYsIDB4MDAwMGZmLCAxKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5tb3ZlVG8ocEF2YXRhci54LCBwQXZhdGFyLnkpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwQXZhdGFyLnggLSB2QXZhdGFyLngsIHBBdmF0YXIueSAtIHZBdmF0YXIueSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vIElmIHRoZSBsZW5ndGggb2YgdGhlIHBlcnBlbmRpY3VsYXIgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMgdGhlIHNlZ21lbnQgY29sbGlkZXMgd2l0aCB0aGUgY2lyY2xlXHJcblx0XHRcdFx0XHRcdGlmKHBlcnAueSA+IDAgJiYgcGVycExlbmd0aCA+IHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cylcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdGlmKHRoaXMubGV2ZWwuZGVidWcpXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVN0eWxlKDMsIDB4ZmYwMGZmLCAxKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLm1vdmVUbyhwb2ludHNbcF0ueCwgcG9pbnRzW3BdLnkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubGluZVRvKHBvaW50c1twXS54ICsgdlByb2oueCwgcG9pbnRzW3BdLnkgKyB2UHJvai55KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLndpcmVmcmFtZS5saW5lU3R5bGUoNSwgMHhmZjY2MDAsIDEpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy53aXJlZnJhbWUubW92ZVRvKHBvaW50c1twXS54ICsgdlByb2oueCwgcG9pbnRzW3BdLnkgKyB2UHJvai55KTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMud2lyZWZyYW1lLmxpbmVUbyhwb2ludHNbcF0ueCArIHZQcm9qLnggLSBwZXJwLngsIHBvaW50c1twXS55ICsgdlByb2oueSAtIHBlcnAueSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRwZXJwLm5vcm1hbGl6ZSgpO1xyXG5cdFx0XHRcdFx0XHRcdHZhciBhbmdsZURvd24gPSBwZXJwLmFuZ2xlKG5ldyBQSVhJLlBvaW50KDAsMSkpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHR2YXIgY29zTGVuZ3RoID0gcGVycExlbmd0aCAtIHRoaXMuY29sbGlzaW9uQ2lyY2xlLnJhZGl1cztcclxuXHRcdFx0XHRcdFx0XHR2YXIgc2luTGVuZ3RoID0gKGNvc0xlbmd0aCAqIE1hdGguc2luKGFuZ2xlRG93bikpIC8gTWF0aC5jb3MoYW5nbGVEb3duKTtcclxuXHRcdFx0XHRcdFx0XHR2YXIgZGlzdGFuY2UgID0gTWF0aC5zcXJ0KE1hdGgucG93KGNvc0xlbmd0aCwyKSArIE1hdGgucG93KHNpbkxlbmd0aCwyKSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmKGRpc3RhbmNlIDwgc2xvcGVEaXN0YW5jZSlcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRzbG9wZURpc3RhbmNlID0gZGlzdGFuY2U7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5jb2xsaXNpb25Qb2ludCA9XHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHBhdGggOiB0aGlzLmxldmVsLmxheWVyc1tpXS5jaGlsZHJlblBhdGhzW2pdLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRwb3NpdGlvbjpcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHg6IHBvaW50c1twXS54ICsgdlByb2oueCxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR5OiBwb2ludHNbcF0ueSArIHZQcm9qLnlcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0YW5nbGU6IHNlZ21lbnRBbmdsZVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYoc2xvcGVEaXN0YW5jZSA8IHNsb3BlVG9sbGVyYW5jZSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZlbG9jaXR5LnkgPSAwO1xyXG5cdFx0XHRcdHRoaXMueSArPSBzbG9wZURpc3RhbmNlO1xyXG5cdFx0XHRcdHRoaXMuaXNHcm91bmRlZCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBTcHJpdGUgYW5nbGVcclxuXHRcdGlmKHRoaXMuaXNHcm91bmRlZCAmJiAgKCEoKHRoaXMuaXNTbGlkaW5nICYmIHRoaXMudGltZVVuc2xpZGluZyA9PSAwKSkgfHwgKCh0aGlzLmlzT2xhZigpIHx8IHRoaXMuaXNSaWRpbmdWZWhpY2xlKSAmJiB0aGlzLmlzU2xpZGluZykpKVxyXG5cdFx0XHR0aGlzLmFuZ2xlVGFyZ2V0ID0gdGhpcy5jb2xsaXNpb25Qb2ludC5hbmdsZTtcclxuXHRcdGVsc2UgaWYodGhpcy5pc1R1bWJsaW5nKVxyXG5cdFx0XHR0aGlzLmFuZ2xlVGFyZ2V0ID0gMCArIHRoaXMudHVtYmxlQW5nbGU7XHJcblx0XHRlbHNlXHJcblx0XHRcdHRoaXMuYW5nbGVUYXJnZXQgPSAwO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBUT0RPXHJcbiAqL1xyXG5SdW5uaW5nRW50aXR5LnByb3RvdHlwZS5jaGVja0NvbGxpc2lvbiA9IGZ1bmN0aW9uKGMxLCBvYmopXHJcbntcclxuXHRpZihvYmouY29sbGlzaW9uUmVjdCAhPSBudWxsKVxyXG5cdHtcclxuXHRcdHZhciBwb2ludHMgPSBbXTtcclxuXHRcdHBvaW50cy5wdXNoKG5ldyBQSVhJLlBvaW50KG9iai54ICsgb2JqLmNvbGxpc2lvblJlY3QueCwgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoueSArIG9iai5jb2xsaXNpb25SZWN0LnkpKTtcclxuXHRcdHBvaW50cy5wdXNoKG5ldyBQSVhJLlBvaW50KG9iai54ICsgb2JqLmNvbGxpc2lvblJlY3QueCArIG9iai5jb2xsaXNpb25SZWN0LndpZHRoLCBvYmoueSArIG9iai5jb2xsaXNpb25SZWN0LnkpKTtcclxuXHRcdHBvaW50cy5wdXNoKG5ldyBQSVhJLlBvaW50KG9iai54ICsgb2JqLmNvbGxpc2lvblJlY3QueCArIG9iai5jb2xsaXNpb25SZWN0LndpZHRoLCBvYmoueSArIG9iai5jb2xsaXNpb25SZWN0LnkgKyBvYmouY29sbGlzaW9uUmVjdC5oZWlnaHQpKTtcclxuXHRcdHBvaW50cy5wdXNoKG5ldyBQSVhJLlBvaW50KG9iai54ICsgb2JqLmNvbGxpc2lvblJlY3QueCwgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoueSArIG9iai5jb2xsaXNpb25SZWN0LnkgKyBvYmouY29sbGlzaW9uUmVjdC5oZWlnaHQpKTtcclxuXHJcblx0XHR2YXIgcGl2b3QgPSBuZXcgUElYSS5Qb2ludChvYmoueCwgb2JqLnkpO1xyXG5cclxuXHRcdGZvcih2YXIgIGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRwb2ludHNbaV0ucm90YXRlQXJvdW5kKHBpdm90LCBvYmoucm90YXRpb24pO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvLyBpZighIW9iai50ZXN0KVxyXG5cdFx0XHQvLyB0aGlzLmxldmVsLnJlbW92ZUNoaWxkKG9iai50ZXN0KVxyXG5cclxuXHRcdC8vIG9iai50ZXN0ID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHRcdC8vIHRoaXMubGV2ZWwuYWRkQ2hpbGQob2JqLnRlc3QpO1xyXG5cdFx0Ly8gb2JqLnRlc3QubGluZVN0eWxlKDIsIDB4MDBmZjAwKTtcclxuXHJcblx0XHQvLyBvYmoudGVzdC5tb3ZlVG8ocG9pbnRzWzBdLngsIHBvaW50c1swXS55KTtcclxuXHRcdC8vIG9iai50ZXN0LmxpbmVUbyhwb2ludHNbMV0ueCwgcG9pbnRzWzFdLnkpO1xyXG5cdFx0Ly8gb2JqLnRlc3QubGluZVRvKHBvaW50c1syXS54LCBwb2ludHNbMl0ueSk7XHJcblx0XHQvLyBvYmoudGVzdC5saW5lVG8ocG9pbnRzWzNdLngsIHBvaW50c1szXS55KTtcclxuXHRcdC8vIG9iai50ZXN0LmxpbmVUbyhwb2ludHNbMF0ueCwgcG9pbnRzWzBdLnkpO1xyXG5cdFx0XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZihNYXRoLnNxcnQoTWF0aC5wb3cocG9pbnRzW2ldLnggLSBjMS54LDIpICsgTWF0aC5wb3cocG9pbnRzW2ldLnkgLSBjMS55LDIpKSA8IGMxLnJhZGl1cylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yKHZhciBwID0gMDsgcCA8IHBvaW50cy5sZW5ndGg7IHArKylcclxuXHRcdHtcclxuXHRcdFx0dmFyIHNlZ21lbnQgPSBuZXcgUElYSS5Qb2ludChwb2ludHNbKHArMSklcG9pbnRzLmxlbmd0aF0ueCAtIHBvaW50c1twXS54LCBwb2ludHNbKHArMSklcG9pbnRzLmxlbmd0aF0ueSAtIHBvaW50c1twXS55KTtcclxuXHRcdFx0dmFyIHNlZ21lbnROb3JtYWxpemVkID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudC54LCBzZWdtZW50LnkpO1xyXG5cdFx0XHRzZWdtZW50Tm9ybWFsaXplZC5ub3JtYWxpemUoKTtcclxuXHJcblx0XHRcdC8vIEF2YXRhci1zZWdtZW50IHZlY3RvclxyXG5cdFx0XHR2YXIgdkF2YXRhciA9IG5ldyBQSVhJLlBvaW50KGMxLnggLSBwb2ludHNbcF0ueCwgYzEueSAtIHBvaW50c1twXS55KTtcclxuXHJcblx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgcHJvamVjdGlvbiBvZiB2QXZhdGFyIG9udG8gdGhlIHNlZ21lbnRcclxuXHRcdFx0dmFyIHZQcm9qTGVuZ3RoID0gdkF2YXRhci5kb3RQcm9kdWN0KHNlZ21lbnQpIC8gc2VnbWVudC5nZXRMZW5ndGgoKTtcclxuXHRcdFx0dmFyIHZQcm9qICAgICAgID0gbmV3IFBJWEkuUG9pbnQoc2VnbWVudE5vcm1hbGl6ZWQueCAqIHZQcm9qTGVuZ3RoLCBzZWdtZW50Tm9ybWFsaXplZC55ICogdlByb2pMZW5ndGgpO1xyXG5cclxuXHRcdFx0Ly8gTWFrZSBzdXJlIHRoZSBwcm9qZWN0aW9uIHZlY3RvciBpcyB3aXRoaW4gdGhlIHNlZ21lbnRcclxuXHRcdFx0aWYodlByb2oueCAhPSBzZWdtZW50LngpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpZih2UHJvai54L3NlZ21lbnQueCA8IDApIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGlmKHZQcm9qLngvc2VnbWVudC54ID4gMSkgY29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYodlByb2oueS9zZWdtZW50LnkgPCAwKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZih2UHJvai55L3NlZ21lbnQueSA+IDEpIGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBDYWxjdWxhdGUgdGhlIHBlcnBlbmRpY3VsYXJcclxuXHRcdFx0dmFyIHBlcnAgID0gbmV3IFBJWEkuUG9pbnQodlByb2oueCAtIHZBdmF0YXIueCwgdlByb2oueSAtIHZBdmF0YXIueSk7XHJcblx0XHRcdHZhciBwZXJwTGVuZ3RoID0gcGVycC5nZXRMZW5ndGgoKTtcclxuXHJcblx0XHRcdGlmKHBlcnBMZW5ndGggPCBjMS5yYWRpdXMpXHJcblx0XHRcdHtcclxuXHRcdFx0XHQvLyBvYmoudGVzdC5saW5lU3R5bGUoMSwgMHgwMDAwZmYsIDEpO1xyXG5cdFx0XHRcdC8vIG9iai50ZXN0Lm1vdmVUbyhjMS54LCBjMS55KTtcclxuXHRcdFx0XHQvLyBvYmoudGVzdC5saW5lVG8oYzEueCAtIHZBdmF0YXIueCwgYzEueSAtIHZBdmF0YXIueSk7XHJcblxyXG5cdFx0XHRcdC8vIG9iai50ZXN0LmxpbmVTdHlsZSgyLCAweGZmMDBmZiwgMSk7XHJcblx0XHRcdFx0Ly8gb2JqLnRlc3QubW92ZVRvKHBvaW50c1twXS54LCBwb2ludHNbcF0ueSk7XHJcblx0XHRcdFx0Ly8gb2JqLnRlc3QubGluZVRvKHBvaW50c1twXS54ICsgdlByb2oueCwgcG9pbnRzW3BdLnkgKyB2UHJvai55KTtcclxuXHJcblx0XHRcdFx0Ly8gb2JqLnRlc3QubGluZVN0eWxlKDMsIDB4ZmY2NjAwLCAxKTtcclxuXHRcdFx0XHQvLyBvYmoudGVzdC5tb3ZlVG8ocG9pbnRzW3BdLnggKyB2UHJvai54LCBwb2ludHNbcF0ueSArIHZQcm9qLnkpO1xyXG5cdFx0XHRcdC8vIG9iai50ZXN0LmxpbmVUbyhwb2ludHNbcF0ueCArIHZQcm9qLnggLSBwZXJwLngsIHBvaW50c1twXS55ICsgdlByb2oueSAtIHBlcnAueSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYob2JqLmNvbGxpc2lvbkNpcmNsZSAhPSBudWxsKVxyXG5cdHtcclxuXHRcdHZhciBjMiA9IG5ldyBQSVhJLkNpcmNsZShvYmoueCwgb2JqLnksIG9iai5jb2xsaXNpb25DaXJjbGUucmFkaXVzKVxyXG5cclxuXHRcdC8vIENpcmNsZS1jaXJjbGUgY29sbGlzaW9uXHJcblx0XHR2YXIgZGlmZiA9IG5ldyBQSVhJLlBvaW50KGMxLnggLSBjMi54LCBjMS55IC0gYzIueSk7XHJcblx0XHRyZXR1cm4gKChNYXRoLnBvdyhkaWZmLngsIDIpICsgTWF0aC5wb3coZGlmZi55LCAyKSkgPD0gTWF0aC5wb3coYzEucmFkaXVzICsgYzIucmFkaXVzLCAyKSk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn0iLCIvKipcclxuICogIFNob2Nrd2F2ZVxyXG4gKlxyXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gMTAvMDUvMjAxNi5cclxuICpcclxuICovXHJcblxyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBDb21tb24gPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7IVBJWEkuRGlzcGxheU9iamVjdH0gdmlld1xyXG4gKiBAcGFyYW0geyFQSVhJLlRleHR1cmV9IHRleHR1cmVcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBTaG9ja3dhdmUodmlldywgdGV4dHVyZSlcclxue1xyXG5cdC8qKlxyXG5cdCAqIEB0eXBlIHtQSVhJLkRpc3BsYXlPYmplY3R9XHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHR0aGlzLl92aWV3ID0gdmlldztcclxuXHJcblx0LyoqXHJcblx0ICogQHR5cGUge251bGx9XHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHR0aGlzLl9maWx0ZXIgPSBudWxsO1xyXG5cclxuXHRQSVhJLlNwcml0ZS5jYWxsKHRoaXMsIHRleHR1cmUpO1xyXG5cclxuXHR0aGlzLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHJcblx0dGhpcy5fZmlsdGVyID0gbmV3IFBJWEkuZmlsdGVycy5EaXNwbGFjZW1lbnRGaWx0ZXIodGhpcyk7XHJcblxyXG5cdGlmICh0aGlzLl92aWV3LmZpbHRlcnMpIHtcclxuXHRcdHRoaXMuX3ZpZXcuZmlsdGVycy5wdXNoKHRoaXMuX2ZpbHRlcik7XHJcblx0fSBlbHNlIHtcclxuXHRcdHRoaXMuX3ZpZXcuZmlsdGVycyA9IFt0aGlzLl9maWx0ZXJdO1xyXG5cdH1cclxufVxyXG5tb2R1bGUuZXhwb3J0c1x0XHQ9IFNob2Nrd2F2ZTtcclxuU2hvY2t3YXZlLnByb3RvdHlwZVx0PSBPYmplY3QuY3JlYXRlKFBJWEkuU3ByaXRlLnByb3RvdHlwZSk7XHJcblNob2Nrd2F2ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTaG9ja3dhdmU7XHJcblxyXG5TaG9ja3dhdmUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZiAodGhpcy5fdmlldy5maWx0ZXJzKSB7XHJcblx0XHR2YXIgaW5kZXggPSB0aGlzLl92aWV3LmZpbHRlcnMuaW5kZXhPZih0aGlzLl9maWx0ZXIpO1xyXG5cdFx0aWYgKGluZGV4ICE9IC0xKSB7XHJcblx0XHRcdGlmICh0aGlzLl92aWV3LmZpbHRlcnMubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuZmlsdGVycy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuZmlsdGVycyA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHRoaXMucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpO1xyXG5cdFBJWEkuU3ByaXRlLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtudW1iZXI9fSBkdXJhdGlvblxyXG4gKi9cclxuU2hvY2t3YXZlLnByb3RvdHlwZS5hbmltYXRlID0gZnVuY3Rpb24oZHVyYXRpb24pXHJcbntcclxuXHRkdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDEuNDtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtcclxuXHRcdG9uQ29tcGxldGU6IHRoaXMuZGVzdHJveSxcclxuXHRcdG9uQ29tcGxldGVTY29wZTogdGhpc1xyXG5cdH0pO1xyXG5cclxuXHR0aGlzLnNjYWxlLnggPSAwLjAxO1xyXG5cdHRoaXMuc2NhbGUueSA9IDAuMDE7XHJcblx0dGwuaW5zZXJ0KFR3ZWVuTWF4LnRvKHRoaXMuc2NhbGUsIGR1cmF0aW9uLCB7XHJcblx0XHR4OiA1LjAsXHJcblx0XHR5OiA1LjAsXHJcblx0XHRlYXNlOiBQb3dlcjEuZWFzZU91dFxyXG5cdH0pKTtcclxuXHJcblx0dGwuaW5zZXJ0KFR3ZWVuTWF4LnRvKHRoaXMuZmlsdGVyLnNjYWxlLCBkdXJhdGlvbiAqIDAuMywge1xyXG5cdFx0ZGVsYXk6IGR1cmF0aW9uIC0gZHVyYXRpb24gKiAwLjMsXHJcblx0XHR4OiAwLjEsXHJcblx0XHR5OiAwLjEsXHJcblx0XHRlYXNlOiBQb3dlcjEuZWFzZUluT3V0XHJcblx0fSkpO1xyXG59O1xyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KFNob2Nrd2F2ZS5wcm90b3R5cGUsIFwidmlld1wiLFxyXG57XHJcblx0LyoqXHJcblx0ICogQHJldHVybnMge0Rpc3BsYXlPYmplY3R9XHJcblx0ICovXHJcblx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB0aGlzLl92aWV3O1xyXG5cdH1cclxufSk7XHJcblxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoU2hvY2t3YXZlLnByb3RvdHlwZSwgXCJmaWx0ZXJcIixcclxue1xyXG5cdC8qKlxyXG5cdCAqIEByZXR1cm5zIHtQSVhJLmZpbHRlcnMuRGlzcGxhY2VtZW50RmlsdGVyfVxyXG5cdCAqL1xyXG5cdGdldDogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fZmlsdGVyO1xyXG5cdH1cclxufSk7XHJcbiIsInZhciBDb21tb24gICAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNvdW5kU0ZYICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBDaGFyYWN0ZXJTZWxlY3RQYW5lbChzY3JlZW4sIGRhdGEpXHJcbntcclxuXHR0aGlzLl9zY3JlZW4gICAgICAgICA9IHNjcmVlbjtcclxuXHR0aGlzLl9hc3NldE1hbmFnZXIgICA9IHAzLkFzc2V0TWFuYWdlci5pbnN0YW5jZTtcclxuXHR0aGlzLl9wb3dlcnVwRGF0YSAgICA9ICQuZXh0ZW5kKHRydWUsIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLnBvd2VydXBzLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIikucG93ZXJ1cHMpO1xyXG5cdHRoaXMuX3Bvd2VydXBLZXlzICAgID0gW1widHVtYmxlX3NwZWVkXCIsIFwic25vd19tYWduZXRcIiwgXCJ0cm9sbF9tYWdpY1wiXTtcclxuXHR0aGlzLl9kYXRhICAgICAgICAgICA9IGRhdGE7XHJcblx0dGhpcy5fc3ViUGFuZWxBY3RpdmUgPSBmYWxzZTtcclxuXHR0aGlzLl9zdWJQYW5lbFBvd2VyICA9IDA7XHJcblxyXG5cdFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IENoYXJhY3RlclNlbGVjdFBhbmVsO1xyXG5DaGFyYWN0ZXJTZWxlY3RQYW5lbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkNoYXJhY3RlclNlbGVjdFBhbmVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENoYXJhY3RlclNlbGVjdFBhbmVsO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6YXRpb25cclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFBhbmVsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gdmFyIGNoYXJhY3RlciA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2NoYXJfXCIgKyB0aGlzLl9kYXRhLmlkKSk7XHJcblx0Ly8gY2hhcmFjdGVyLmFuY2hvci5zZXQoMC41LCAxKTtcclxuXHQvLyBjaGFyYWN0ZXIueCA9IDIwMDtcclxuXHQvLyBjaGFyYWN0ZXIueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQvMjtcclxuICAgIC8vIHRoaXMuYWRkQ2hpbGQoY2hhcmFjdGVyKTtcclxuXHJcblx0dGhpcy5zcGluZSA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhW3RoaXMuX2RhdGEuaWRdKTtcclxuXHR0aGlzLnNwaW5lLnNrZWxldG9uLnNldFRvU2V0dXBQb3NlKCk7XHJcblx0dGhpcy5zcGluZS5za2VsZXRvbi5zZXRTa2luKG51bGwpO1xyXG5cdHRoaXMuc3BpbmUuc2tlbGV0b24uc2V0U2tpbkJ5TmFtZShcImRlZmF1bHRcIik7XHJcblx0dGhpcy5zcGluZS54ID0gMjAwO1xyXG5cdHRoaXMuc3BpbmUueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQvMjtcclxuXHR0aGlzLnNwaW5lLmF1dG9VcGRhdGUgPSB0cnVlO1xyXG5cdHRoaXMuc3BpbmUuc2NhbGUuc2V0KDAuNSk7XHJcblx0dGhpcy5zcGluZS5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMCwgXCJsb29rX2xlZnRcIiwgdHJ1ZSwgMCk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLnNwaW5lKTtcclxuXHRcclxuXHRcdHRoaXMudXBncmFkZVBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcyxcclxuXHRcdFtcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDBcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAxXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDNcIilcclxuXHRcdF0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfY2hhcl91cGdyYWRlXCIpKTtcclxuXHJcblx0XHR0aGlzLnVwZ3JhZGVQUy51cGRhdGVTcGF3blBvcyh0aGlzLnNwaW5lLngsIHRoaXMuc3BpbmUueSAtMjAwKTtcclxuXHRcdHRoaXMudXBncmFkZVBTLmVtaXQgPSBmYWxzZTtcclxuXHJcblxyXG5cdC8vIFVwZ3JhZGUgc3VicGFuZWxcclxuXHR2YXIgdXBncmFkZV9wYW5lbCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3VwZ3JhZGVfcGFuZWxcIikpO1xyXG5cdHVwZ3JhZGVfcGFuZWwueCA9IC0zNTA7XHJcblx0dXBncmFkZV9wYW5lbC55ID0gLTExMDtcclxuICAgIHRoaXMuYWRkQ2hpbGQodXBncmFkZV9wYW5lbCk7XHJcblxyXG5cdFx0dGhpcy5fdXBncmFkZV9pbmZvID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdXBncmFkZV9pbmZvXzJcIikpO1xyXG5cdFx0dGhpcy5fdXBncmFkZV9pbmZvLnhTdGFydCA9IDUwO1xyXG5cdFx0dGhpcy5fdXBncmFkZV9pbmZvLnhFbmQgICA9IDM3MDtcclxuXHRcdHRoaXMuX3VwZ3JhZGVfaW5mby54ICAgICAgPSB0aGlzLl91cGdyYWRlX2luZm8ueFN0YXJ0O1xyXG5cdFx0dGhpcy5fdXBncmFkZV9pbmZvLnkgICAgICA9IDQwO1xyXG5cdFx0dGhpcy5fdXBncmFkZV9pbmZvLmFscGhhICA9IDA7XHJcblx0XHR1cGdyYWRlX3BhbmVsLmFkZENoaWxkKHRoaXMuX3VwZ3JhZGVfaW5mbyk7XHJcblxyXG5cdFx0XHQvLyBDbG9zZSBidXR0b25cclxuXHRcdFx0dmFyIGJ1eUNsb3NlID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fdXBncmFkZV9jbG9zZV9vdXRcIiksXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fdXBncmFkZV9jbG9zZV9vdmVyXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3VwZ3JhZGVfY2xvc2VfZG93blwiKVxyXG5cdFx0XHQpO1xyXG5cdFx0XHRidXlDbG9zZS5wb3NpdGlvbi5zZXQoMjgwLCA0MCk7XHJcblx0XHRcdGJ1eUNsb3NlLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vblVwZ3JhZGVDbG9zZUNsaWNrZWQsIHRoaXMpO1xyXG5cdFx0XHRidXlDbG9zZS5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0XHRcdHRoaXMuX3VwZ3JhZGVfaW5mby5hZGRDaGlsZChidXlDbG9zZSk7XHJcblxyXG5cdFx0XHQvLyBQb3dlciBpY29uXHJcblx0XHRcdHRoaXMuX2J1eUljb24gPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3VwZ3JhZGVfdHVtYmxlXCIpKTtcclxuXHRcdFx0dGhpcy5fYnV5SWNvbi5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMuX2J1eUljb24ucG9zaXRpb24uc2V0KDE2OCwgNzApO1xyXG5cdFx0XHR0aGlzLl91cGdyYWRlX2luZm8uYWRkQ2hpbGQodGhpcy5fYnV5SWNvbik7XHJcblxyXG5cdFx0XHQvLyBQb3dlci11cCB0ZXh0XHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGVzY3JpcHRpb24gPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIkRlc2NyaXB0aW9uXCIsIHtmb250OiBcIjMwcHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcclxuXHRcdFx0XHR0aGlzLl9idXlEZXNjcmlwdGlvbi54ID0gLXRoaXMuX2J1eURlc2NyaXB0aW9uLnRleHRXaWR0aC8yICArIDE2ODtcclxuXHRcdFx0XHR0aGlzLl9idXlEZXNjcmlwdGlvbi55ID0gLXRoaXMuX2J1eURlc2NyaXB0aW9uLnRleHRIZWlnaHQvMiArIDE3NTtcclxuXHRcdFx0XHR0aGlzLl91cGdyYWRlX2luZm8uYWRkQ2hpbGQodGhpcy5fYnV5RGVzY3JpcHRpb24pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuX2J1eURlc2NyaXB0aW9uID0gbmV3IFBJWEkuVGV4dChcIkRlc2NyaXB0aW9uXCIsIHtmb250OlwiMzBweCBBcmlhbFwiLCBmaWxsOjB4NmQzOGFiLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHRcdHRoaXMuX2J1eURlc2NyaXB0aW9uLnBvc2l0aW9uLnNldCgxNjgsIDE3NSk7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGVzY3JpcHRpb24uYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdHRoaXMuX3VwZ3JhZGVfaW5mby5hZGRDaGlsZCh0aGlzLl9idXlEZXNjcmlwdGlvbik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEJ1eSBidXR0b25cclxuXHRcdFx0dGhpcy5fYnV5QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fYnV5X291dFwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9idXlfb3ZlclwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9idXlfZG93blwiKVxyXG5cdFx0XHQpO1xyXG5cdFx0XHR0aGlzLl9idXlCdXR0b24ucG9zaXRpb24uc2V0KDE3NSwgMjkwKTtcclxuXHRcdFx0dGhpcy5fYnV5QnV0dG9uLnNjYWxlLnNldCgwKTtcclxuXHRcdFx0dGhpcy5fYnV5QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkJ1eUNsaWNrLCB0aGlzKTtcclxuXHRcdFx0dGhpcy5fYnV5QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHRcdFx0dGhpcy5fdXBncmFkZV9pbmZvLmFkZENoaWxkKHRoaXMuX2J1eUJ1dHRvbik7XHJcblxyXG5cdFx0XHRcdHZhciBzbm93Zmxha2UgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3Nub3dmbGFrZVwiKSk7XHJcblx0XHRcdFx0c25vd2ZsYWtlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRzbm93Zmxha2UucG9zaXRpb24uc2V0KC05MiwgMCk7XHJcblx0XHRcdFx0dGhpcy5fYnV5QnV0dG9uLmFkZENoaWxkKHNub3dmbGFrZSk7XHJcblxyXG5cdFx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIjBcIiwge2ZvbnQ6IFwiNDBweCBTdXBlcmNsYXJlbmRvbiBOdW1iZXJzXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlCdXR0b24uX3ByaWNlLnggPSAtdGhpcy5fYnV5QnV0dG9uLl9wcmljZS50ZXh0V2lkdGgvMiArIDU7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlCdXR0b24uX3ByaWNlLnkgPSAtdGhpcy5fYnV5QnV0dG9uLl9wcmljZS50ZXh0SGVpZ2h0LzI7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlCdXR0b24uYWRkQ2hpbGQodGhpcy5fYnV5QnV0dG9uLl9wcmljZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlCdXR0b24uX3ByaWNlID0gbmV3IFBJWEkuVGV4dChcIj9cIiwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlCdXR0b24uX3ByaWNlLnBvc2l0aW9uLnNldCg1LCAwKTtcclxuXHRcdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdFx0dGhpcy5fYnV5QnV0dG9uLmFkZENoaWxkKHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdC8vIERpc2FibGVkIGJ1eSBidXR0b24gd2l0aG91dCByb2xsb3ZlciBvciBldmVudHNcclxuXHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0XHRcdChcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9idXlfb3V0X2luYWN0aXZlXCIpXHJcblx0XHRcdCk7XHJcblx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLnBvc2l0aW9uID0gdGhpcy5fYnV5QnV0dG9uLnBvc2l0aW9uO1xyXG5cdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5zY2FsZS5zZXQoMCk7XHJcblx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkJ1eURpc2FibGVkQ2xpY2ssIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl91cGdyYWRlX2luZm8uYWRkQ2hpbGQodGhpcy5fYnV5RGlzYWJsZWRCdXR0b24pO1xyXG5cclxuXHRcdFx0XHR2YXIgc25vd2ZsYWtlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zbm93Zmxha2VcIikpO1xyXG5cdFx0XHRcdHNub3dmbGFrZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0c25vd2ZsYWtlLnBvc2l0aW9uLnNldCgtOTIsIDApO1xyXG5cdFx0XHRcdHNub3dmbGFrZS5maWx0ZXJzID0gW25ldyBQSVhJLmZpbHRlcnMuR3JheUZpbHRlcigpXTtcclxuXHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5hZGRDaGlsZChzbm93Zmxha2UpO1xyXG5cclxuXHRcdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIjBcIiwge2ZvbnQ6IFwiNDBweCBTdXBlcmNsYXJlbmRvbiBOdW1iZXJzXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UueCA9IC10aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UudGV4dFdpZHRoLzIgKyA1O1xyXG5cdFx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnkgPSAtdGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnRleHRIZWlnaHQvMjtcclxuXHRcdFx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLmFkZENoaWxkKHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLl9wcmljZSk7XHJcblxyXG5cdFx0XHRcdFx0dmFyIGNvbG9yTWF0cml4ID0gbmV3IFBJWEkuZmlsdGVycy5Db2xvck1hdHJpeEZpbHRlcigpO1xyXG5cdFx0XHRcdFx0Y29sb3JNYXRyaXguZGVzYXR1cmF0ZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLmZpbHRlcnMgPSBbY29sb3JNYXRyaXhdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlID0gbmV3IFBJWEkuVGV4dChcIj9cIiwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UucG9zaXRpb24uc2V0KDUsIDApO1xyXG5cdFx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLmFkZENoaWxkKHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLl9wcmljZSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdC8vIFBhbmVsXHJcblx0XHR2YXIgcGFuZWxfYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV91cGdyYWRlX2luZm9fMVwiKSk7XHJcblx0XHR1cGdyYWRlX3BhbmVsLmFkZENoaWxkKHBhbmVsX2JnKTtcclxuXHJcblx0XHQvLyBQb3dlcnNcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCAzOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh0aGlzLl9wb3dlcnVwRGF0YVt0aGlzLl9wb3dlcnVwS2V5c1tpXV0udGV4dFtDb21tb24uQ09VTlRSWV9DT0RFXSwge2ZvbnQ6IFwiMjRweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImxlZnRcIiwgdGludDogMHg2ZDM4YWJ9KTtcclxuXHRcdFx0XHR0ZXh0LnggPSAxMjA7XHJcblx0XHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yICsgNTggKyAxMDAgKiBpO1xyXG5cdFx0XHRcdHVwZ3JhZGVfcGFuZWwuYWRkQ2hpbGQodGV4dCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KHRoaXMuX3Bvd2VydXBEYXRhW3RoaXMuX3Bvd2VydXBLZXlzW2ldXS50ZXh0W0NvbW1vbi5DT1VOVFJZX0NPREVdLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDZkMzhhYiwgYWxpZ246J2xlZnQnfSk7XHJcblx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KHIybCA/IDEgOiAwLCAwLjUpO1xyXG5cdFx0XHRcdHRleHQucG9zaXRpb24uc2V0KHIybCA/IDM3MCA6IDEyMCwgNTggKyAxMDAgKiBpKTtcclxuXHRcdFx0XHR1cGdyYWRlX3BhbmVsLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fZ2VtcyA9IFtdO1xyXG5cdFx0dGhpcy5fZ2Vtc0J1dHRvbiA9IFtdO1xyXG5cclxuXHRcdGZvcih2YXIgcCA9IDA7IHAgPCAzOyBwKyspXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2dlbXNbcF0gPSBbXTtcclxuXHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCAzOyBpKyspXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgZ2VtID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdXBncmFkZV9nZW1cIikpO1xyXG5cdFx0XHRcdGdlbS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0Z2VtLnggPSAxNzAgKyA4MyAqIGk7XHJcblx0XHRcdFx0Z2VtLnkgPSAxMDIgKyA5OSAqIHA7XHJcblx0XHRcdFx0dXBncmFkZV9wYW5lbC5hZGRDaGlsZChnZW0pO1xyXG5cclxuXHRcdFx0XHRpZihDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlclt0aGlzLl9kYXRhLmlkXVtwXSA8PSBpKVxyXG5cdFx0XHRcdFx0Z2VtLnZpc2libGUgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0dGhpcy5fZ2Vtc1twXS5wdXNoKGdlbSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2RhdGEuaWRdW3BdIDwgMylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBwbHVzID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0XHRcdChcclxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3VwZ3JhZGVfb3V0XCIpLFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fdXBncmFkZV9vdmVyXCIpLFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fdXBncmFkZV9kb3duXCIpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0XHRwbHVzLnggPSAxNzAgKyA4NCAgKiBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlclt0aGlzLl9kYXRhLmlkXVtwXTtcclxuXHRcdFx0XHRwbHVzLnkgPSAxMDIgKyAxMDAgKiBwO1xyXG5cdFx0XHRcdHBsdXMuaWQgPSBwO1xyXG5cdFx0XHRcdHBsdXMuc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uUGx1c0NsaWNrZWQsIHRoaXMpO1xyXG5cdFx0XHRcdHBsdXMub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdFx0XHRcdHVwZ3JhZGVfcGFuZWwuYWRkQ2hpbGQocGx1cyk7XHJcblxyXG5cdFx0XHRcdHRoaXMuX2dlbXNCdXR0b25bcF0gPSBwbHVzO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIFBsdXMgcHVsc2UgYW5pbWF0aW9uXHJcblx0XHRcdFx0dmFyIGNvc3QgPSB0aGlzLl9wb3dlcnVwRGF0YVtwXS5jb3N0W0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2RhdGEuaWRdW3BdXTtcclxuXHRcdFx0XHRpZihjb3N0IDw9IENvbW1vbi5zYXZlZERhdGEuY29pbnMpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0cGx1cy50aW1lbGluZSA9ICBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdFx0XHRcdHBsdXMudGltZWxpbmUudG8ocGx1cy5zY2FsZSwgMC41LCB7eDoxLjE1LCB5OjEuMTUsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHlveW86dHJ1ZSwgcmVwZWF0Oi0xfSk7XHJcblx0XHRcdFx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHBsdXMudGltZWxpbmUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIGNvbG9yTWF0cml4ID0gbmV3IFBJWEkuZmlsdGVycy5Db2xvck1hdHJpeEZpbHRlcigpO1xyXG5cdFx0XHRcdFx0Y29sb3JNYXRyaXguZGVzYXR1cmF0ZSgpO1xyXG5cdFx0XHRcdFx0cGx1cy5maWx0ZXJzID0gW2NvbG9yTWF0cml4XTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0Ly8gQ3VycmVudCBsZXZlbFxyXG5cdHZhciBsZXZlbF9iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLl9kYXRhLmlkID09IFwicGFiYmllXCIgPyBcInVpX2xldmVsX2JnX3Ryb2xsXCIgOiBcInVpX2xldmVsX2JnXCIpKTtcclxuXHRsZXZlbF9iZy5wb3NpdGlvbi5zZXQodXBncmFkZV9wYW5lbC54LCAtMjIwKTtcclxuXHJcblx0aWYoIUNvbW1vbi5zYXZlZERhdGEuZW5kbGVzcykgdGhpcy5hZGRDaGlsZChsZXZlbF9iZyk7XHJcblxyXG5cdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJMRVZFTFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LnJlcGxhY2UoXCJ7dmFsdWV9XCIsIChDb21tb24uc2F2ZWREYXRhLmxldmVsKzEpKSwge2ZvbnQ6IFwiMjZweCBTdXBlcmNsYXJlbmRvbiBMZXZlbFwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0ZXh0LnggPSAtdGV4dC50ZXh0V2lkdGgvMiAgKyBsZXZlbF9iZy53aWR0aC8yIC0gNDA7XHJcblx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiArIDU1O1xyXG5cdFx0XHRsZXZlbF9iZy5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KFwiTGV2ZWwgXCIgKyAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRleHQueCA9IGxldmVsX2JnLndpZHRoLzIgLSA1MDtcclxuXHRcdFx0dGV4dC55ID0gNTc7XHJcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRsZXZlbF9iZy5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0aGlzLl9kYXRhLmlkID09IFwicGFiYmllXCIpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0cm9sbENvbGxlY3RlZCA9IENvbW1vbi5zYXZlZERhdGEuZ2V0TGV2ZWxDb2xsZWN0ZWRUcm9sbENvdW50KENvbW1vbi5zYXZlZERhdGEubGV2ZWwpO1xyXG5cdFx0XHR2YXIgdHJvbGxDb3VudCAgICAgPSAzO1xyXG5cclxuXHRcdFx0aWYoIXdlYmZvbnQpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KHRyb2xsQ29sbGVjdGVkICsgXCIvXCIgKyB0cm9sbENvdW50LCB7Zm9udDogXCIzMnB4IFN1cGVyY2xhcmVuZG9uIExldmVsXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzIgICsgMzQwO1xyXG5cdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiArIDUwO1xyXG5cdFx0XHRcdGxldmVsX2JnLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dCh0cm9sbENvbGxlY3RlZCArIFwiL1wiICsgdHJvbGxDb3VudCwge2ZvbnQ6XCIzMnB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0dGV4dC54ICs9IDM0MDtcclxuXHRcdFx0XHR0ZXh0LnkgKz0gNTc7XHJcblx0XHRcdFx0bGV2ZWxfYmcuYWRkQ2hpbGQodGV4dCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0Ly8gQ2hhcmFjdGVyIGNyeXN0YWxzIGZvciB0aGUgbGV2ZWxcclxuXHRcdFx0aWYoISFDb21tb24uc2F2ZWREYXRhLmNyeXN0YWxzW0NvbW1vbi5zYXZlZERhdGEubGV2ZWxdW3RoaXMuX2RhdGEuaWRdKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IDM7IGkrKylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRpZighQ29tbW9uLnNhdmVkRGF0YS5jcnlzdGFsc1tDb21tb24uc2F2ZWREYXRhLmxldmVsXVt0aGlzLl9kYXRhLmlkXVtpXSkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdFx0dmFyIGNyeXN0YWwgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9sZXZlbF9jcnlzdGFsX1wiICsgdGhpcy5fZGF0YS5jb2xvciArIFwiX1wiICsgKGkrMSkpKTtcclxuXHRcdFx0XHRcdGxldmVsX2JnLmFkZENoaWxkKGNyeXN0YWwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZ1bmN0aW9uIGNhbGxlZCB3aGVuIGEgcGx1cyBidXR0b24gaXMgY2xpY2tlZCwgd2lsbCBvcGVuIHRoZSBzdWJwYW5lbFxyXG4gKiBAcGFyYW0ge051bWJlcn0gcGx1cyAtIHRoZSBpbmRleCBvZiB0aGUgcG93ZXIgKDAsMSwyKVxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0UGFuZWwucHJvdG90eXBlLm9uUGx1c0NsaWNrZWQgPSBmdW5jdGlvbihwbHVzKVxyXG57XHJcblx0Ly8gU2tpcCBpZiB0aGUgcGFuZWwgZm9yIHRoYXQgcG93ZXIgaXMgYWxyZWFkeSBvcGVuXHJcblx0aWYodGhpcy5fc3ViUGFuZWxBY3RpdmUgJiYgdGhpcy5fc3ViUGFuZWxQb3dlciA9PSBwbHVzLmlkKSByZXR1cm47XHJcblxyXG5cdHRoaXMuX3N1YlBhbmVsUG93ZXIgID0gcGx1cy5pZDtcclxuXHJcblx0aWYoISF0aGlzLl9zdWJQYW5lbFRpbWVsaW5lKVxyXG5cdFx0dGhpcy5fc3ViUGFuZWxUaW1lbGluZS5raWxsKCk7XHJcblxyXG5cdHRoaXMuX3N1YlBhbmVsVGltZWxpbmUgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHJcblx0XHQvLyBIaWRlIHByZXZpb3VzIHBhbmVsIGlmIG9wZW5cclxuXHRcdGlmKHRoaXMuX3N1YlBhbmVsQWN0aXZlKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9zdWJQYW5lbFRpbWVsaW5lLnRvKHRoaXMuX2J1eUJ1dHRvbi5zY2FsZSwgICAgICAgICAuMTUsIHt4OjAsIHk6MCwgZWFzZTpTaW5lLmVhc2VJbn0pO1xyXG5cdFx0XHR0aGlzLl9zdWJQYW5lbFRpbWVsaW5lLnRvKHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLnNjYWxlLCAuMTUsIHt4OjAsIHk6MCwgZWFzZTpTaW5lLmVhc2VJbn0pO1xyXG5cdFx0XHR0aGlzLl9zdWJQYW5lbFRpbWVsaW5lLnRvKHRoaXMuX3VwZ3JhZGVfaW5mbywgICAgICAgICAgICAuMzAsIHt4OnRoaXMuX3VwZ3JhZGVfaW5mby54U3RhcnQsIGFscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LDAuMDUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFNob3cgdGhlIG5ldyBvbmVcclxuXHRcdHRoaXMuX3N1YlBhbmVsQWN0aXZlID0gdHJ1ZTtcclxuXHRcdHZhciBjb3N0ID0gdGhpcy5fcG93ZXJ1cERhdGFbdGhpcy5fc3ViUGFuZWxQb3dlcl0uY29zdFtDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlclt0aGlzLl9kYXRhLmlkXVt0aGlzLl9zdWJQYW5lbFBvd2VyXV07XHJcblxyXG5cdFx0dGhpcy5fc3ViUGFuZWxUaW1lbGluZS50byh0aGlzLl91cGdyYWRlX2luZm8sIC40MCwge3g6dGhpcy5fdXBncmFkZV9pbmZvLnhFbmQsIGFscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fYnV5SWNvbi50ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGhpcy5fcG93ZXJ1cERhdGFbdGhpcy5fc3ViUGFuZWxQb3dlcl0udGV4dHVyZSk7XHJcblxyXG5cdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuX2J1eURlc2NyaXB0aW9uLnggKz0gdGhpcy5fYnV5RGVzY3JpcHRpb24udGV4dFdpZHRoLzI7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGVzY3JpcHRpb24ueSArPSB0aGlzLl9idXlEZXNjcmlwdGlvbi50ZXh0SGVpZ2h0LzI7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGVzY3JpcHRpb24udGV4dCA9IHRoaXMuX3Bvd2VydXBEYXRhW3RoaXMuX3Bvd2VydXBLZXlzW3RoaXMuX3N1YlBhbmVsUG93ZXJdXS5kZXNjcmlwdGlvbltDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdFx0XHR0aGlzLl9idXlEZXNjcmlwdGlvbi52YWxpZGF0ZSgpO1xyXG5cdFx0XHRcdHRoaXMuX2J1eURlc2NyaXB0aW9uLnggLT0gdGhpcy5fYnV5RGVzY3JpcHRpb24udGV4dFdpZHRoLzI7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGVzY3JpcHRpb24ueSAtPSB0aGlzLl9idXlEZXNjcmlwdGlvbi50ZXh0SGVpZ2h0LzI7XHJcblxyXG5cdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UueCArPSB0aGlzLl9idXlCdXR0b24uX3ByaWNlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UudGV4dCA9IGNvc3Q7XHJcblx0XHRcdFx0dGhpcy5fYnV5QnV0dG9uLl9wcmljZS52YWxpZGF0ZSgpO1xyXG5cdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UueCAtPSB0aGlzLl9idXlCdXR0b24uX3ByaWNlLnRleHRXaWR0aC8yO1xyXG5cclxuXHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UueCArPSB0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UudGV4dFdpZHRoLzI7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnRleHQgPSBjb3N0O1xyXG5cdFx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLl9wcmljZS52YWxpZGF0ZSgpO1xyXG5cdFx0XHRcdHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLl9wcmljZS54IC09IHRoaXMuX2J1eURpc2FibGVkQnV0dG9uLl9wcmljZS50ZXh0V2lkdGgvMjtcclxuXHJcblx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnggKz0gdGhpcy5fYnV5QnV0dG9uLl9wcmljZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0XHR0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5fcHJpY2UudGV4dCA9IGNvc3Q7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnZhbGlkYXRlKCk7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnggLT0gdGhpcy5fYnV5QnV0dG9uLl9wcmljZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLl9idXlEZXNjcmlwdGlvbi50ZXh0ID0gdGhpcy5fcG93ZXJ1cERhdGFbdGhpcy5fcG93ZXJ1cEtleXNbdGhpcy5fc3ViUGFuZWxQb3dlcl1dLmRlc2NyaXB0aW9uW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0XHRcdHRoaXMuX2J1eUJ1dHRvbi5fcHJpY2UudGV4dCA9IGNvc3Q7XHJcblx0XHRcdFx0dGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uX3ByaWNlLnRleHQgPSBjb3N0O1xyXG5cdFx0XHR9XHJcblx0XHR9fSk7XHJcblxyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5jb2lucyA+PSBjb3N0KVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9zdWJQYW5lbFRpbWVsaW5lLnRvKHRoaXMuX2J1eUJ1dHRvbi5zY2FsZSwgLjI1LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSk7XHJcblx0XHRcdHRoaXMuX3N1YlBhbmVsVGltZWxpbmUudG8odGhpcy5fYnV5QnV0dG9uLnNjYWxlLCAxLCB7eDowLjkzLCB5OjAuOTMsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHlveW86dHJ1ZSwgcmVwZWF0Oi0xfSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX3N1YlBhbmVsVGltZWxpbmUudG8odGhpcy5fYnV5RGlzYWJsZWRCdXR0b24uc2NhbGUsIC4yNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0pO1xyXG5cdFx0fVxyXG5cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuX3N1YlBhbmVsVGltZWxpbmUpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBGdW5jdGlvbiBjYWxsZWQgd2hlbiB0aGUgY2xvc2UgYnV0dG9uIG9mIHRoZSBzdWJwYW5lbCBpcyBjbGlja2VkXHJcbiAqL1xyXG5DaGFyYWN0ZXJTZWxlY3RQYW5lbC5wcm90b3R5cGUub25VcGdyYWRlQ2xvc2VDbGlja2VkID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5jbG9zZVN1YlBhbmVsKCk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogQ2xvc2VzIHRoZSBzdWJwYW5lbCwgaWYgaXQgd2FzIGFjdGl2ZVxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0UGFuZWwucHJvdG90eXBlLmNsb3NlU3ViUGFuZWwgPSBmdW5jdGlvbihvbkNvbXBsZXRlU2NvcGUsIG9uQ29tcGxldGUpXHJcbntcclxuXHRpZighdGhpcy5fc3ViUGFuZWxBY3RpdmUpIHJldHVybjtcclxuXHJcblx0aWYoISF0aGlzLl9zdWJQYW5lbFRpbWVsaW5lKVxyXG5cdFx0dGhpcy5fc3ViUGFuZWxUaW1lbGluZS5raWxsKCk7XHJcblxyXG5cdHRoaXMuX3N1YlBhbmVsVGltZWxpbmUgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpvbkNvbXBsZXRlU2NvcGUsIG9uQ29tcGxldGU6b25Db21wbGV0ZX0pO1xyXG5cdHRoaXMuX3N1YlBhbmVsVGltZWxpbmUudG8odGhpcy5fYnV5QnV0dG9uLnNjYWxlLCAgICAgICAgIC4xNSwge3g6MCwgeTowLCBlYXNlOlNpbmUuZWFzZUlufSk7XHJcblx0dGhpcy5fc3ViUGFuZWxUaW1lbGluZS50byh0aGlzLl9idXlEaXNhYmxlZEJ1dHRvbi5zY2FsZSwgLjE1LCB7eDowLCB5OjAsIGVhc2U6U2luZS5lYXNlSW59KTtcclxuXHR0aGlzLl9zdWJQYW5lbFRpbWVsaW5lLnRvKHRoaXMuX3VwZ3JhZGVfaW5mbywgICAgICAgICAgICAuMzAsIHt4OnRoaXMuX3VwZ3JhZGVfaW5mby54U3RhcnQsIGFscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LDAuMDUpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5fc3ViUGFuZWxUaW1lbGluZSk7XHJcblxyXG5cdHRoaXMuX3N1YlBhbmVsQWN0aXZlID0gZmFsc2U7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFNob3cgdGhlIGNvbmZpcm1hdGlvbiBzY3JlZW4gd2hlbiB0aGUgYnV5IHBhbmVsIGlzIHByZXNzZWRcclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFBhbmVsLnByb3RvdHlwZS5vbkJ1eUNsaWNrID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIGNvc3QgPSB0aGlzLl9wb3dlcnVwRGF0YVt0aGlzLl9zdWJQYW5lbFBvd2VyXS5jb3N0W0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2RhdGEuaWRdW3RoaXMuX3N1YlBhbmVsUG93ZXJdXTtcclxuXHR0aGlzLl9zY3JlZW4uc2lnbmFscy5idXlQcmVzc2VkLmRpc3BhdGNoKHRoaXMsIGNvc3QpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNob3cgdGhhdCB0aGUgY29pbnMgYXJlIGluc3VmZmljaWVudFxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0UGFuZWwucHJvdG90eXBlLm9uQnV5RGlzYWJsZWRDbGljayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdC8vIE1ha2UgdGhlIHNub3dmbGFrZSBpbiB0aGUgY29pbnMgY29udGFpbmVyIHNoYWtlXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0dGwudG8odGhpcy5wYXJlbnQucGFyZW50Ll9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLCAuMSwge3JvdGF0aW9uOlBJWEkuREVHX1RPX1JBRCAqIDE4LCBlYXNlOlNpbmUuZWFzZU91dH0sMCk7XHJcblx0dGwudG8odGhpcy5wYXJlbnQucGFyZW50Ll9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLCAuMSwge3JvdGF0aW9uOlBJWEkuREVHX1RPX1JBRCAqIC0xMiwgZWFzZTpTaW5lLmVhc2VPdXR9KTtcclxuXHR0bC50byh0aGlzLnBhcmVudC5wYXJlbnQuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UsIC4xLCB7cm90YXRpb246UElYSS5ERUdfVE9fUkFEICogNiwgZWFzZTpTaW5lLmVhc2VPdXR9KTtcclxuXHR0bC50byh0aGlzLnBhcmVudC5wYXJlbnQuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UsIC4xLCB7cm90YXRpb246UElYSS5ERUdfVE9fUkFEICogMCwgZWFzZTpTaW5lLmVhc2VPdXR9KTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV9mYWlsXzAwXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogQnV5IHRoZSBwb3dlcnVwIGFuZCBjbG9zZSB0aGUgc3VicGFuZWwgd2hlbiB0aGUgcHVyY2hhc2UgaXMgY29uZmlybWVkXHJcbiAqL1xyXG5DaGFyYWN0ZXJTZWxlY3RQYW5lbC5wcm90b3R5cGUuYnV5ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIGNvc3QgPSB0aGlzLl9wb3dlcnVwRGF0YVt0aGlzLl9zdWJQYW5lbFBvd2VyXS5jb3N0W0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2RhdGEuaWRdW3RoaXMuX3N1YlBhbmVsUG93ZXJdXTtcclxuXHRDb21tb24uc2F2ZWREYXRhLmNvaW5zIC09IGNvc3Q7XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbdGhpcy5fZGF0YS5pZF1bdGhpcy5fc3ViUGFuZWxQb3dlcl0rKztcclxuXHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxuXHJcblx0Ly8gVXBkYXRlIHRoZSBzdGF0dXMgb2YgdGhlIHBsdXMgYnV0dG9ucyBvZiBBTEwgdGhlIHBhbmVsc1xyXG5cdGZvcih2YXIgYyA9IDA7IGMgPCB0aGlzLnBhcmVudC5wYXJlbnQuX2NoYXJhY3RlclBhbmVscy5sZW5ndGg7IGMrKylcclxuXHR7XHJcblx0XHR2YXIgcGFuZWwgPSB0aGlzLnBhcmVudC5wYXJlbnQuX2NoYXJhY3RlclBhbmVsc1tjXTtcclxuXHRcdFxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3BhbmVsLl9kYXRhLmlkXS5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbcGFuZWwuX2RhdGEuaWRdW2ldID49IDMpXHJcblx0XHRcdHtcclxuXHRcdFx0XHRwYW5lbC5fZ2Vtc0J1dHRvbltpXS52aXNpYmxlID0gZmFsc2U7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gU3RvcCBhbmltYXRpbmcgdGhlIHBsdXNcclxuXHRcdFx0XHRpZighIXBhbmVsLl9nZW1zQnV0dG9uW2ldLnRpbWVsaW5lKVxyXG5cdFx0XHRcdFx0cGFuZWwuX2dlbXNCdXR0b25baV0udGltZWxpbmUua2lsbCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKHBhbmVsID09IHRoaXMgJiYgaSA9PSBwYW5lbC5fc3ViUGFuZWxQb3dlcilcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRwYW5lbC5fZ2Vtc0J1dHRvbltpXS54ICs9IDg0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBTdG9wIGFuaW1hdGluZyB0aGUgcGx1cyBpZiBpbnN1ZmZpY2llbnQgY29pbnNcclxuXHRcdFx0XHR2YXIgY29zdCA9IHBhbmVsLl9wb3dlcnVwRGF0YVtpXS5jb3N0W0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3BhbmVsLl9kYXRhLmlkXVtpXV07XHJcblx0XHRcdFx0aWYoY29zdCA+IENvbW1vbi5zYXZlZERhdGEuY29pbnMpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Ly8gU3RvcCBhbmltYXRpbmcgdGhlIHBsdXNcclxuXHRcdFx0XHRcdGlmKCEhcGFuZWwuX2dlbXNCdXR0b25baV0udGltZWxpbmUpXHJcblx0XHRcdFx0XHRcdHBhbmVsLl9nZW1zQnV0dG9uW2ldLnRpbWVsaW5lLmtpbGwoKTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0dmFyIGNvbG9yTWF0cml4ID0gbmV3IFBJWEkuZmlsdGVycy5Db2xvck1hdHJpeEZpbHRlcigpO1xyXG5cdFx0XHRcdFx0Y29sb3JNYXRyaXguZGVzYXR1cmF0ZSgpO1xyXG5cdFx0XHRcdFx0cGFuZWwuX2dlbXNCdXR0b25baV0uZmlsdGVycyA9IFtjb2xvck1hdHJpeF07XHRcdFx0XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cdFxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRcclxuXHQvLyBTaG93IHRoZSBnZW1cclxuXHR0aGlzLl9nZW1zW3RoaXMuX3N1YlBhbmVsUG93ZXJdW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW3RoaXMuX2RhdGEuaWRdW3RoaXMuX3N1YlBhbmVsUG93ZXJdLTFdLnZpc2libGUgPSB0cnVlO1xyXG5cclxuXHQvLyBVcGRhdGUgY29pbiB2YWx1ZVxyXG5cdHRoaXMucGFyZW50LnBhcmVudC5fY29pbnNDb250YWluZXIuX3RleHQudGV4dCA9IENvbW1vbi5zYXZlZERhdGEuY29pbnM7XHJcblxyXG5cdC8vIEV2ZW50IFRyYWNraW5nXHJcblx0Q29tbW9uLmN0b3cudHJhY2tFdmVudChcclxuXHR7XHJcblx0XHRldmVudCAgICAgIDogXCJnYW1lX2FjdGlvblwiLFxyXG5cdFx0Z2FtZV90aWVyMSA6IFwic2hvcFwiLFxyXG5cdFx0Z2FtZV90aWVyMiA6IFwiY2hhcmFjdGVyX3NjcmVlblwiLFxyXG5cdFx0Z2FtZV9tZXRhICA6IFwie1wiICtcclxuXHRcdFx0XHRcdFx0IFwiQ2hhcmFjdGVyTmFtZT1cIiAgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciArIFwiLFwiICtcclxuXHRcdFx0XHRcdFx0IFwidHVtYmxlPVwiICAgICAgICAgICsgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJdWzBdICsgXCIsXCIgK1xyXG5cdFx0XHRcdFx0XHQgXCJtYWduZXQ9XCIgICAgICAgICAgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlcltDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcl1bMV0gKyBcIixcIiArXHJcblx0XHRcdFx0XHRcdCBcIm1hZ2ljPVwiICAgICAgICAgICArIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXVsyXSArIFwiLFwiICtcclxuXHRcdFx0XHRcdFx0IFwicmVtYWluaW5nX2NvaW5zPVwiICsgQ29tbW9uLnNhdmVkRGF0YS5jb2lucyArXHJcblx0XHRcdFx0XHQgXCJ9XCJcclxuXHR9KTtcclxuXHJcblx0Ly8gQ2xvc2UgdGhlIHN1YnBhbmVsXHJcblx0dGhpcy5jbG9zZVN1YlBhbmVsXHJcblx0KFxyXG5cdFx0dGhpcyxcclxuXHRcdGZ1bmN0aW9uKClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy51cGdyYWRlUFMuZW1pdCA9IHRydWU7XHJcblx0XHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfdWlfYnV5X3VwZ3JhZGVfMDJcIik7XHJcblx0XHR9XHJcblx0KTtcclxufSIsIlxyXG52YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBFbWl0dGVyKCkge1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7IVBJWEkuQ29udGFpbmVyfSBwYXJlbnRcclxuICogQHBhcmFtIHshQXJyYXk8U3RyaW5nPn0gdGV4dHVyZXNcclxuICogQHBhcmFtIHshU3RyaW5nfSBqc29uXHJcbiAqIEBwYXJhbSB7TnVtYmVyPX0geFxyXG4gKiBAcGFyYW0ge051bWJlcj19IHlcclxuICogQHBhcmFtIHtOdW1iZXI9fSByZW1vdmVUaW1lXHJcbiAqIEBwYXJhbSB7Qm9vbGVhbj19IGF1dG9FbWl0XHJcbiAqIEByZXR1cm5zIHtjbG91ZGtpZC5FbWl0dGVyfSBlbWl0dGVyXHJcbiAqL1xyXG5FbWl0dGVyLmFkZCA9IGZ1bmN0aW9uKHBhcmVudCwgdGV4dHVyZXMsIGpzb24sIHgsIHksIHJlbW92ZVRpbWUsIGF1dG9FbWl0LCBkZXN0cm95VGltZSlcclxue1xyXG4gICAgaWYoYXV0b0VtaXQgPT0gdW5kZWZpbmVkKSBhdXRvRW1pdCA9IHRydWU7XHJcbiAgICBpZihkZXN0cm95VGltZSA9PSB1bmRlZmluZWQpIGRlc3Ryb3lUaW1lID0gMTtcclxuXHJcbiAgICB4ID0geCB8fCAwO1xyXG4gICAgeSA9IHkgfHwgMDtcclxuXHJcbiAgICB2YXIgYXNzZXRNYW5hZ2VyID0gcDMuQXNzZXRNYW5hZ2VyLmluc3RhbmNlO1xyXG5cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0ZXh0dXJlcy5sZW5ndGg7IGkrKylcclxuICAgIHtcclxuICAgICAgICB0ZXh0dXJlc1tpXSA9IGFzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRleHR1cmVzW2ldKTtcclxuICAgIH0gICAgXHJcblxyXG4gICAgdmFyIGVtaXR0ZXIgPSBuZXcgY2xvdWRraWQuRW1pdHRlcihcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgdGV4dHVyZXMsXHJcbiAgICAgICAgYXNzZXRNYW5hZ2VyLmdldEpTT04oanNvbilcclxuICAgICk7XHJcbiAgICBpZihhdXRvRW1pdClcclxuICAgICAgICBlbWl0dGVyLmVtaXQgPSB0cnVlO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIGVtaXR0ZXIuZW1pdCA9IGZhbHNlO1xyXG5cclxuICAgIGVtaXR0ZXIudXBkYXRlT3duZXJQb3MoeCwgeSk7XHJcblxyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChlbWl0dGVyKTtcclxuXHJcbiAgICBpZihyZW1vdmVUaW1lICE9IG51bGwpXHJcbiAgICB7ICAgIFxyXG4gICAgICAgIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIEVtaXR0ZXIuZGVzdHJveShlbWl0dGVyLCBkZXN0cm95VGltZSk7XHJcbiAgICAgICAgfSwgcmVtb3ZlVGltZSwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVtaXR0ZXI7XHJcbn07XHJcblxyXG5FbWl0dGVyLmRlc3Ryb3kgPSBmdW5jdGlvbihlbWl0dGVyLCBkZXN0cm95RGVsYXkpXHJcbntcclxuICAgIGlmKGVtaXR0ZXIgIT0gbnVsbClcclxuICAgIHsgICAgXHJcbiAgICAgICAgZGVzdHJveURlbGF5ID0gZGVzdHJveURlbGF5IHx8IDA7XHJcblxyXG4gICAgICAgIGVtaXR0ZXIuZW1pdCA9IGZhbHNlO1xyXG4gICAgICAgIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIENvbW1vbi5hbmltYXRvci5yZW1vdmUoZW1pdHRlcik7XHJcbiAgICAgICAgICAgIGVtaXR0ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIH0sIGRlc3Ryb3lEZWxheSwgdGhpcyk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IiwidmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gTGV2ZWxTZWxlY3RCdXR0b24obGV2ZWwsIGFjdGl2ZSlcclxue1xyXG5cdHRoaXMuX2Fzc2V0TWFuYWdlciA9IHAzLkFzc2V0TWFuYWdlci5pbnN0YW5jZTtcclxuXHJcblx0dGhpcy5faWQgPSBsZXZlbDtcclxuXHJcblx0dGhpcy5zaWduYWxzICAgICAgICAgID0ge307XHJcblx0dGhpcy5zaWduYWxzLmNsaWNrZWQgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcblx0dGhpcy5zaWduYWxzLmRvd24gICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcblx0dGhpcy5zaWduYWxzLnVwICAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcblxyXG5cdHRoaXMuYWN0aXZlICAgICAgICAgICA9IGFjdGl2ZTtcclxuXHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IExldmVsU2VsZWN0QnV0dG9uO1xyXG5MZXZlbFNlbGVjdEJ1dHRvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbkxldmVsU2VsZWN0QnV0dG9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExldmVsU2VsZWN0QnV0dG9uO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5MZXZlbFNlbGVjdEJ1dHRvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuYWN0aXZlKVxyXG5cdHtcclxuXHRcdC8vIEJnXHJcblx0XHR2YXIgY3J5c3RhbHNfYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfY3J5c3RhbHNfYmdcIikpO1xyXG5cdFx0Y3J5c3RhbHNfYmcuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwKTtcclxuXHRcdGNyeXN0YWxzX2JnLnkgPSAzODtcclxuXHRcdHRoaXMuYWRkQ2hpbGQoY3J5c3RhbHNfYmcpO1xyXG5cclxuXHRcdC8vIENyeXN0YWxzXHJcblx0XHR2YXIgY2hhcmFjdGVycyA9IFtcImFubmFcIiwgXCJrcmlzdG9mZlwiLCBcIm9sYWZcIiwgXCJlbHNhXCJdXHJcblx0XHR2YXIgdGV4dHVyZXMgICA9IFtcInVpX21hcF9jcnlzdGFsc19waW5rXCIsIFwidWlfbWFwX2NyeXN0YWxzX2dyZWVuXCIsIFwidWlfbWFwX2NyeXN0YWxzX2N5YW5cIiwgXCJ1aV9tYXBfY3J5c3RhbHNfcHVycGxlXCJdXHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGNoYXJhY3RlcnMubGVuZ3RoOyBpKyspXHJcblx0XHR7XHJcblx0XHRcdGlmKENvbW1vbi5zYXZlZERhdGEuZ2V0TGV2ZWxDaGFyYWN0ZXJDcnlzdGFsQ291bnQodGhpcy5faWQsIGNoYXJhY3RlcnNbaV0pIDwgMykgY29udGludWU7XHJcblxyXG5cdFx0XHR2YXIgY3J5c3RhbCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0ZXh0dXJlc1tpXSkpO1xyXG5cdFx0XHRjcnlzdGFsLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMCk7XHJcblx0XHRcdGNyeXN0YWxzX2JnLmFkZENoaWxkKGNyeXN0YWwpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEJ1dHRvblxyXG5cdFx0dGhpcy5fYnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0KFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9tYXBfb3V0XCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9tYXBfb3ZlclwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbWFwX2Rvd25cIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9tYXBfcGxheVwiKVxyXG5cdFx0KTtcclxuXHRcdHRoaXMuX2J1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25DbGljaywgdGhpcyk7XHJcblx0XHR0aGlzLl9idXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9idXR0b24pO1xyXG5cclxuXHRcdC8vIExldmVsIG51bWJlclxyXG5cdFx0Ly8gdmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KHRoaXMuX2lkKzEsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0Ly8gdGV4dC5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcblx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KFwiXCIgKyAodGhpcy5faWQrMSksIHtmb250OiBcIjI4cHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0ZXh0LnggPSAtIHRleHQudGV4dFdpZHRoLzIgLSAyO1xyXG5cdFx0dGV4dC55ID0gLSA5NjtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGV4dCk7XHJcblxyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93bilcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRyb2xsc0NvdW50ZXIgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfdHJvbGxzX2JnXCIpKTtcclxuXHRcdFx0dHJvbGxzQ291bnRlci5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcblx0XHRcdHRyb2xsc0NvdW50ZXIueSA9IDU3O1xyXG5cdFx0XHR0aGlzLmFkZENoaWxkKHRyb2xsc0NvdW50ZXIpO1xyXG5cclxuXHRcdFx0dmFyIHRyb2xsc1RleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChDb21tb24uc2F2ZWREYXRhLmdldExldmVsQ29sbGVjdGVkVHJvbGxDb3VudCh0aGlzLl9pZCkgKyBcIi8zXCIsIHtmb250OiBcIjIwcHggU3VwZXJjbGFyZW5kb24gTGV2ZWxcIiwgYWxpZ246IFwibGVmdFwifSk7XHJcblx0XHRcdHRyb2xsc1RleHQueCA9IDA7XHJcblx0XHRcdHRyb2xsc1RleHQueSA9IC0xOTtcclxuXHRcdFx0dHJvbGxzQ291bnRlci5hZGRDaGlsZCh0cm9sbHNUZXh0KTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdHRoaXMuX2J1dHRvbiA9IG5ldyBwMy5NdXRlQnV0dG9uXHJcblx0XHQoXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX21hcF9vdXRfaW5hY3RpdmVcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX21hcF9vdXRfaW5hY3RpdmVcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX21hcF9vdXRfaW5hY3RpdmVcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9tYXBfbG9ja1wiKVxyXG5cdFx0KTtcclxuXHRcdHRoaXMuX2J1dHRvbi5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9idXR0b24pO1xyXG5cdH1cclxufTtcclxuXHJcbkxldmVsU2VsZWN0QnV0dG9uLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5fYnV0dG9uLmFscGhhID0gMC41O1xyXG5cdHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5MZXZlbFNlbGVjdEJ1dHRvbi5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuc2lnbmFscy5jbGlja2VkLmRpc3BhdGNoKHRoaXMpO1xyXG59O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIsInZhciBDb21tb24gICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU291bmRTRlggICAgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gTmV4dEJ1dHRvbihidXR0b25TdHJpbmcsIGRlbGF5KVxyXG57XHJcblx0LyoqXHJcbiAgICAgKiBAdHlwZSB7cDMuQXNzZXRNYW5hZ2VyfVxyXG4gICAgICovXHJcbiAgICB0aGlzLl9hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XHJcblxyXG5cdC8qKlxyXG4gICAgICogQHR5cGUge3NpZ25hbHMuU2lnbmFsfVxyXG4gICAgICovXHJcbiAgICB0aGlzLnNpZ25hbHMgPSB7fTtcclxuXHR0aGlzLnNpZ25hbHMuY2xpY2tlZCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cdHRoaXMuc2lnbmFscy5jbGlja0ZpbmlzaCA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuXHQvKipcclxuICAgICAqIEB0eXBlIHtQSVhJLlNwcml0ZX1cclxuICAgICAqL1xyXG4gICAgdGhpcy5fYmFubmVyID0gbnVsbDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtwMy5CaXRtYXBUZXh0fVxyXG4gICAgICovXHJcbiAgICB0aGlzLl9idXR0b24gPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge1N0cmluZ31cclxuICAgICAqL1xyXG4gICAgdGhpcy5fYnV0dG9uU3RyaW5nID0gYnV0dG9uU3RyaW5nIHx8IFwibmV4dFwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge051bWJlcn1cclxuICAgICAqL1xyXG4gICAgdGhpcy5fZGVsYXkgPSBkZWxheSB8fCAwO1xyXG5cclxuXHRQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gTmV4dEJ1dHRvbjtcclxuTmV4dEJ1dHRvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcbk5leHRCdXR0b24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTmV4dEJ1dHRvbjtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbi8qKlxyXG4gKi9cclxuTmV4dEJ1dHRvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblxyXG5cdFx0dGhpcy5fYmFubmVyID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlcIikpO1xyXG5cdFx0dGhpcy5fYmFubmVyLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdC8vIHRoaXMuX2Jhbm5lci5zY2FsZS54ID0gMDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmFubmVyKTtcclxuXHJcblx0XHR0aGlzLl9idXR0b24gPSBuZXcgcDMuQnV0dG9uKFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImJ1dF9iaWdfZGVmXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcImJ1dF9iaWdfb3ZlclwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJidXRfYmlnX3ByZXNzXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLl9idXR0b25TdHJpbmcpKTtcclxuXHRcdFxyXG5cdFx0Ly8gdGhpcy5fYnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMub25CdXR0b25DbGljaywgdGhpcyk7XHJcblx0XHR0aGlzLl9idXR0b24uc2lnbmFscy5vdmVyLmFkZCh0aGlzLm9uQnV0dG9uT3ZlciwgdGhpcyk7XHJcblx0XHR0aGlzLl9idXR0b24uYW5pbWF0ZSA9IGZhbHNlO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9idXR0b24pO1xyXG5cclxuXHRcdC8vIHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0Ly8gdGwudG8odGhpcy5fYmFubmVyLnNjYWxlLCAxLCB7eDoxLCBlYXNlOkJhY2suZWFzZU91dH0pO1xyXG5cdFx0Ly8gdGwudG8odGhpcy5fYnV0dG9uLnNjYWxlLCAxLjMsIHt4OjEsIGVhc2U6RWxhc3RpYy5lYXNlT3V0fSwgMCk7XHJcblx0XHQvLyB0bC50byh0aGlzLl9idXR0b24uc2NhbGUsIDEuMywge3k6MSwgZWFzZTpFbGFzdGljLmVhc2VPdXR9LCAwLjEpO1xyXG5cdFx0Ly8gQ29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcblxyXG5cdH0sIHRoaXMuX2RlbGF5LCB0aGlzKTtcclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICovXHJcbk5leHRCdXR0b24ucHJvdG90eXBlLm9uQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbigpXHJcbntcclxuLyogICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZih0aGlzLl9idXR0b24uc2NhbGUpO1xyXG4gICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9idXR0b24uc2NhbGUsIC4yLCB7eDowLjYsIHk6MC42LCBlYXNlOlNpbmUuZWFzZUluT3V0LCBvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgQ29tbW9uLmFuaW1hdG9yLmFkZChUd2Vlbk1heC50byh0aGlzLl9idXR0b24uc2NhbGUsIDEsIHt4OjEsIHk6MSwgZWFzZTpFbGFzdGljLmVhc2VPdXQsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBcdHRoaXMuc2lnbmFscy5jbGlja0ZpbmlzaC5kaXNwYXRjaCgpO1xyXG4gICAgICAgIH0sIG9uQ29tcGxldGVTY29wZTp0aGlzfSkpO1xyXG4gICAgfSwgb25Db21wbGV0ZVNjb3BlOnRoaXN9KSk7ICovXHJcblxyXG4gICAgLy8gU291bmRTRlgucGxheShcInNmeF9idXR0b25fcGxheVwiKTtcclxuXHR0aGlzLnNpZ25hbHMuY2xpY2tlZC5kaXNwYXRjaCgpO1xyXG59XHJcblxyXG5OZXh0QnV0dG9uLnByb3RvdHlwZS5vbkJ1dHRvbk92ZXIgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIC8vIFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCIpO1xyXG59XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG5cclxuIiwiLyoqXG4gKiAgU291bmRTRlhcbiAqXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gMTEvMDYvMjAxNS5cbiAqXG4gKi9cblxudmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05TVFJVQ1RPUlxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gU291bmRTRlgoKSB7XG59XG5tb2R1bGUuZXhwb3J0cyA9IFNvdW5kU0ZYO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQHBhcmFtIHshcDMuQnV0dG9ufSBidXR0b25cbiAqIEBwYXJhbSB7Qm9vbGVhbj19IGVuYWJsZUNsaWNrU291bmRcbiAqIEBwYXJhbSB7Qm9vbGVhbj19IGVuYWJsZU92ZXJTb3VuZFxuICovXG5Tb3VuZFNGWC5idXR0b24gPSBmdW5jdGlvbihidXR0b24sIGVuYWJsZUNsaWNrU291bmQsIGVuYWJsZU92ZXJTb3VuZCkge1xuICAgIGVuYWJsZUNsaWNrU291bmQgPSBlbmFibGVDbGlja1NvdW5kID09IHVuZGVmaW5lZCA/IHRydWUgOiBlbmFibGVDbGlja1NvdW5kO1xuICAgIGVuYWJsZU92ZXJTb3VuZCA9IGVuYWJsZU92ZXJTb3VuZCA9PSB1bmRlZmluZWQgPyB0cnVlIDogZW5hYmxlT3ZlclNvdW5kO1xuXG4gICAgaWYoZW5hYmxlQ2xpY2tTb3VuZClcbiAgICB7ICAgIFxuICAgICAgICBidXR0b24uc2lnbmFscy5jbGljay5hZGQoZnVuY3Rpb24oYnV0dG9uKSB7XG4gICAgICAgICAgICBwMy5BdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVNvdW5kKFwic2Z4X2J0bl9wcmVzc19yZXZlcmJcIik7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIGlmKGVuYWJsZU92ZXJTb3VuZClcbiAgICB7ICAgIFxuICAgICAgICBidXR0b24uc2lnbmFscy5vdmVyLmFkZChmdW5jdGlvbihidXR0b24pIHtcbiAgICAgICAgICAgIHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5U291bmQoXCJzZnhfYnRuX3JvbGxvdmVyX3JldmVyYlwiKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0geyFTdHJpbmd9IHNvdW5kXG4gKiBAcGFyYW0ge09iamVjdD19IHBhcmFtc1xuICogQHBhcmFtIHtOdW1iZXI9fSBkZWxheVxuICovXG5Tb3VuZFNGWC5wbGF5ID0gZnVuY3Rpb24oc291bmQsIHBhcmFtcywgZGVsYXkpIHtcblxuICAgIGlmKGRlbGF5ID09IG51bGwpXG4gICAgeyAgICBcbiAgICAgICAgcmV0dXJuIHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5U291bmQoc291bmQsIHBhcmFtcyk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7ICAgIFxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBwMy5BdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVNvdW5kKHNvdW5kLCBwYXJhbXMpO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxufTtcblxuU291bmRTRlgucGxheU11c2ljID0gZnVuY3Rpb24oc291bmQsIHBhcmFtcywgZGVsYXkpIHtcblxuICAgIGlmKGRlbGF5ID09IG51bGwpXG4gICAgeyAgICBcbiAgICAgICAgcDMuQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlNdXNpYyhzb3VuZCwgcGFyYW1zKTtcbiAgICB9XG4gICAgZWxzZVxuICAgIHsgICAgXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TXVzaWMoc291bmQsIHBhcmFtcyk7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IVN0cmluZ30gc291bmRcbiAqL1xuU291bmRTRlguc3RvcCA9IGZ1bmN0aW9uKHNvdW5kKSB7XG4gICAgdmFyIGN1cnJlbnRTb3VuZHMgPSBwMy5BdWRpb01hbmFnZXIuaW5zdGFuY2Uuc291bmRzU0ZYO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjdXJyZW50U291bmRzLmxlbmd0aDsgaSsrKVxuICAgIHtcbiAgICAgICAgaWYoY3VycmVudFNvdW5kc1tpXS5uYW1lID09IHNvdW5kKVxuICAgICAgICB7XG4gICAgICAgICAgIHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5zdG9wU291bmQoc291bmQpO1xuICAgICAgICB9ICAgXG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0geyFBcnJheSA8U3RyaW5nPn0gc291bmRzXG4gKi9cblNvdW5kU0ZYLnBsYXlSYW5kb21Gcm9tID0gZnVuY3Rpb24oc291bmRzKSB7XG5cdHAzLkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5U291bmQoc291bmRzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpzb3VuZHMubGVuZ3RoKV0pO1xufTtcblxuXG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBSSVZBVEUgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEdFVFRFUlMvU0VUVEVSU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuIiwidmFyIENvbW1vbiAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gV2lyZWZyYW1lQnV0dG9uKHRleHQpXHJcbntcclxuXHR0aGlzLl90ZXh0XHRcdFx0XHQ9IHRleHQ7XHJcblxyXG5cdHRoaXMuX2J1dHRvblx0XHRcdD0gbnVsbDtcclxuXHJcblx0dGhpcy5zaWduYWxzIFx0XHRcdD0ge307XHJcblx0dGhpcy5zaWduYWxzLmNsaWNrZWQgXHQ9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cdHRoaXMuc2lnbmFscy5kb3duIFx0XHQ9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cdHRoaXMuc2lnbmFscy51cFx0IFx0XHQ9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xyXG5cclxuXHR0aGlzLmRpc2FibGVkXHRcdFx0PSBmYWxzZTtcclxuXHJcblx0dGhpcy50ZXh0dXJlIFx0XHRcdD0gbnVsbDtcclxuXHJcblx0UElYSS5Db250YWluZXIuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IFdpcmVmcmFtZUJ1dHRvbjtcclxuV2lyZWZyYW1lQnV0dG9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcclxuV2lyZWZyYW1lQnV0dG9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFdpcmVmcmFtZUJ1dHRvbjtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuV2lyZWZyYW1lQnV0dG9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdHZhciBncmFwaGljID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuXHRncmFwaGljLmJlZ2luRmlsbCgweEZGRkZGRik7XHJcblx0Z3JhcGhpYy5kcmF3UmVjdCgwLCAwLCAyMDAsIDEwMCk7XHJcblx0Y29udGFpbmVyLmFkZENoaWxkKGdyYXBoaWMpO1xyXG5cdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dCh0aGlzLl90ZXh0LCB7Zm9udDonMzBweCBUYWhvbWEnLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdHRleHQueCA9IDEwMCAtICh0ZXh0LndpZHRoLzIpO1xyXG5cdHRleHQueSA9IDMwO1xyXG5cdGNvbnRhaW5lci5hZGRDaGlsZCh0ZXh0KTtcclxuXHR2YXIgdGV4dHVyZSA9IGNvbnRhaW5lci5nZW5lcmF0ZVRleHR1cmUoQ29tbW9uLnJlbmRlcmVyLCAxLjAsIFBJWEkuU0NBTEVfTU9ERVMuTElORUFSKTtcclxuXHJcblx0dGhpcy50ZXh0dXJlID0gdGV4dHVyZTtcclxuXHJcblx0dGhpcy5fYnV0dG9uID0gbmV3IHAzLkJ1dHRvbih0ZXh0dXJlLCB0ZXh0dXJlLCB0ZXh0dXJlKTtcclxuXHR0aGlzLl9idXR0b24uYW5pbWF0ZSA9IGZhbHNlO1xyXG5cdHRoaXMuX2J1dHRvbi5zaWduYWxzLmNsaWNrLmFkZCh0aGlzLmJ1dHRvbkNsaWNrZWQsIHRoaXMpO1xyXG5cdHRoaXMuX2J1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMuYnV0dG9uRG93biwgdGhpcyk7XHJcblx0dGhpcy5fYnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMuYnV0dG9uVXAsIHRoaXMpO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYnV0dG9uKTtcclxufTtcclxuXHJcbldpcmVmcmFtZUJ1dHRvbi5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuX2J1dHRvbi5hbHBoYSA9IDAuNTtcclxuXHR0aGlzLmRpc2FibGVkID0gdHJ1ZTtcclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuV2lyZWZyYW1lQnV0dG9uLnByb3RvdHlwZS5idXR0b25DbGlja2VkID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5zaWduYWxzLmNsaWNrZWQuZGlzcGF0Y2godGhpcyk7XHJcbn07XHJcblxyXG5XaXJlZnJhbWVCdXR0b24ucHJvdG90eXBlLmJ1dHRvbkRvd24gPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnNpZ25hbHMuZG93bi5kaXNwYXRjaCh0aGlzKTtcclxuXHRjb25zb2xlLmxvZygnZG93bicpO1xyXG59O1xyXG5cclxuV2lyZWZyYW1lQnV0dG9uLnByb3RvdHlwZS5idXR0b25VcCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuc2lnbmFscy51cC5kaXNwYXRjaCh0aGlzKTtcclxuXHRjb25zb2xlLmxvZygndXAnKTtcclxufTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiLyoqXHJcbiAqIEBwYXJhbSB7IVBJWEkuVGV4dHVyZX0gdGV4dHVyZVxyXG4gKiBAcGFyYW0ge051bWJlcj19IHNjYWxlXHJcbiAqIEBwYXJhbSB7UElYSS5Qb2ludD19IHJhdGlvXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gQ3V0b3V0U2hhZGVyKHRleHR1cmUsIHNjYWxlLCByYXRpbykge1xyXG4gICAgc2NhbGUgICA9IHNjYWxlIHx8IDAuNTtcclxuICAgIHJhdGlvICAgPSByYXRpbyB8fCBuZXcgUElYSS5Qb2ludCgxLjAsIDEuMCk7XHJcblxyXG4gICAgUElYSS5BYnN0cmFjdEZpbHRlci5jYWxsKFxyXG4gICAgICAgIHRoaXMsXHJcbiAgICAgICAgbnVsbCxcclxuICAgICAgICBcInByZWNpc2lvbiBoaWdocCBmbG9hdDtcIiArXHJcblxyXG4gICAgICAgIFwidmFyeWluZyB2ZWMyIHZUZXh0dXJlQ29vcmQ7XCIgK1xyXG4gICAgICAgIFwidmFyeWluZyB2ZWM0IHZDb2xvcjtcIiArXHJcblxyXG4gICAgICAgIFwidW5pZm9ybSBzYW1wbGVyMkQgdUN1dG91dE1hcDtcIiArXHJcbiAgICAgICAgXCJ1bmlmb3JtIGZsb2F0IHVTY2FsZTtcIiArXHJcbiAgICAgICAgXCJ1bmlmb3JtIHZlYzIgdVJhdGlvO1wiICtcclxuXHJcbiAgICAgICAgXCJ2b2lkIG1haW4odm9pZCkge1wiICtcclxuICAgICAgICAgICAgXCJ2ZWMyIHRleHR1cmVDb29yZCAgPSAoKCh2VGV4dHVyZUNvb3JkIC0gdmVjMigwLjUsIDAuNSkpICogdVJhdGlvKSAqIHVTY2FsZSkgKyB2ZWMyKDAuNSwgMC41KTtcIiArXHJcbiAgICAgICAgICAgIFwidmVjNCBtYXNrICAgICAgICAgID0gdGV4dHVyZTJEKHVDdXRvdXRNYXAsIHRleHR1cmVDb29yZCk7XCIgK1xyXG4gICAgICAgICAgICBcImZsb2F0IGFscGhhICAgICAgICA9IDEuMCAtIG1hc2suYTtcIiArXHJcbiAgICAgICAgICAgIFwiZ2xfRnJhZ0NvbG9yICAgICAgID0gdmVjNCh2Q29sb3IuciAqIGFscGhhLCB2Q29sb3IuZyAqIGFscGhhLCB2Q29sb3IuYiAqIGFscGhhLCB2Q29sb3IuYSAqIGFscGhhKTtcIiArXHJcbiAgICAgICAgXCJ9XCIsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB1Q3V0b3V0TWFwOiAgICAge3R5cGU6IFwic2FtcGxlcjJEXCIsICAgICB2YWx1ZTogdGV4dHVyZX0sXHJcbiAgICAgICAgICAgIHVTY2FsZTogICAgICAgICB7dHlwZTogXCJmXCIsICAgICAgICAgICAgIHZhbHVlOiAxLjAgLyBNYXRoLm1heCgwLjAwMSwgc2NhbGUpfSxcclxuICAgICAgICAgICAgdVJhdGlvOiAgICAgICAgIHt0eXBlOiBcInYyXCIsICAgICAgICAgICAgdmFsdWU6IHt4OiByYXRpby54LCB5OiByYXRpby55fX1cclxuICAgICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIHRleHR1cmUuYmFzZVRleHR1cmUuaXNQb3dlck9mVHdvID0gZmFsc2U7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgICAgICAgICAgICAgICAgICAgICAgICAgID0gQ3V0b3V0U2hhZGVyO1xyXG5DdXRvdXRTaGFkZXIucHJvdG90eXBlICAgICAgICAgICAgICAgICAgPSBPYmplY3QuY3JlYXRlKFBJWEkuQWJzdHJhY3RGaWx0ZXIucHJvdG90eXBlKTtcclxuQ3V0b3V0U2hhZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciAgICAgID0gQ3V0b3V0U2hhZGVyO1xyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEN1dG91dFNoYWRlci5wcm90b3R5cGUsIFwic2NhbGVcIiwge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAxLjAgLyB0aGlzLnVuaWZvcm1zLnVTY2FsZS52YWx1ZTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB7IU51bWJlcn0gdmFsdWVcclxuICAgICAqL1xyXG4gICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMudW5pZm9ybXMudVNjYWxlLnZhbHVlID0gMS4wIC8gTWF0aC5tYXgoMC4wMDEsIHZhbHVlKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoQ3V0b3V0U2hhZGVyLnByb3RvdHlwZSwgXCJyYXRpb1wiLCB7XHJcbiAgICAvKipcclxuICAgICAqIEByZXR1cm5zIHtQSVhJLlBvaW50fVxyXG4gICAgICovXHJcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUElYSS5Qb2ludCh0aGlzLnVuaWZvcm1zLnVSYXRpby52YWx1ZS54LCB0aGlzLnVuaWZvcm1zLnVSYXRpby52YWx1ZS55KTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB7IVBJWEkuUG9pbnR9IHZhbHVlXHJcbiAgICAgKi9cclxuICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICB0aGlzLnVuaWZvcm1zLnVSYXRpby52YWx1ZS54ID0gdmFsdWUueDtcclxuICAgICAgICB0aGlzLnVuaWZvcm1zLnVSYXRpby52YWx1ZS55ID0gdmFsdWUueTtcclxuICAgIH1cclxufSk7IiwidmFyIEN1dG91dFNoYWRlciAgICA9IHJlcXVpcmUoXCIuL0N1dG91dFNoYWRlclwiKTtcclxudmFyIEZhZGVUcmFuc2l0aW9uICA9IHJlcXVpcmUoXCIuL0ZhZGVUcmFuc2l0aW9uXCIpO1xyXG52YXIgVHJhbnNpdGlvbiAgICAgID0gcmVxdWlyZShcIi4vVHJhbnNpdGlvblwiKTtcclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0geyFQSVhJLlRleHR1cmV9IHRleHR1cmVcclxuICogQHBhcmFtIHshTnVtYmVyfSBjb2xvclxyXG4gKiBAcGFyYW0geyFOdW1iZXJ9IGR1cmF0aW9uXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gQ3V0b3V0VHJhbnNpdGlvbih0ZXh0dXJlLCBjb2xvciwgZHVyYXRpb24pIHtcclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge051bWJlcn1cclxuICAgICAqL1xyXG4gICAgdGhpcy5zdGFydFNjYWxlID0gMztcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtOdW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIHRoaXMuZW5kU2NhbGUgPSAwLjA7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7UElYSS5UZXh0dXJlfVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgdGhpcy5fdGV4dHVyZSA9IHRleHR1cmU7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7TnVtYmVyfVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgdGhpcy5fY29sb3IgPSAweERERjdGRDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtOdW1iZXJ9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDEuMjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtQSVhJLlNwcml0ZX1cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIHRoaXMuX2N1dG91dCA9IG51bGw7XHJcblxyXG4gICAgVHJhbnNpdGlvbi5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMucmVxdWlyZXNXZWJHTCA9IHRydWU7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IEN1dG91dFRyYW5zaXRpb247XHJcbkN1dG91dFRyYW5zaXRpb24ucHJvdG90eXBlICAgICAgICAgICAgICAgICAgPSBPYmplY3QuY3JlYXRlKFRyYW5zaXRpb24ucHJvdG90eXBlKTtcclxuQ3V0b3V0VHJhbnNpdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgICAgICA9IEN1dG91dFRyYW5zaXRpb247XHJcblxyXG5DdXRvdXRUcmFuc2l0aW9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgcXVhZCA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcbiAgICBxdWFkLmRyYXdSZWN0KDAuMCwgMC4wLCAxLjAsIDEuMCk7XHJcblxyXG4gICAgdmFyIHJhdGlvICAgICAgICAgICA9IG5ldyBQSVhJLlBvaW50KDAuMCwgMC4wKTtcclxuICAgIHZhciBjYW52YXNSYXRpbyAgICAgPSBwMy5WaWV3LndpZHRoIC8gcDMuVmlldy5oZWlnaHQ7XHJcbiAgICB2YXIgdGV4dHVyZVJhdGlvICAgID0gdGhpcy5fdGV4dHVyZS53aWR0aCAvIHRoaXMuX3RleHR1cmUuaGVpZ2h0O1xyXG5cclxuICAgIGlmIChjYW52YXNSYXRpbyAvIHRleHR1cmVSYXRpbyA+IDEuMCkge1xyXG4gICAgICAgIHJhdGlvLnggPSAxLjA7XHJcbiAgICAgICAgcmF0aW8ueSA9IDEuMCAvIChjYW52YXNSYXRpbyAvIHRleHR1cmVSYXRpbyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJhdGlvLnggPSAxLjAgLyAoY2FudmFzUmF0aW8gLyB0ZXh0dXJlUmF0aW8pO1xyXG4gICAgICAgIHJhdGlvLnkgPSAxLjA7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY3V0b3V0ICAgICAgICA9IG5ldyBQSVhJLlNwcml0ZShxdWFkLmdlbmVyYXRlVGV4dHVyZSgpKTtcclxuICAgIHRoaXMuX2N1dG91dC5zY2FsZSAgPSBuZXcgUElYSS5Qb2ludChwMy5WaWV3LndpZHRoLCBwMy5WaWV3LmhlaWdodCk7XHJcbiAgICB0aGlzLl9jdXRvdXQudGludCAgID0gdGhpcy5fY29sb3I7XHJcbiAgICB0aGlzLl9jdXRvdXQuc2hhZGVyID0gbmV3IEN1dG91dFNoYWRlcih0aGlzLl90ZXh0dXJlLCAwLjAsIHJhdGlvKTtcclxuXHR0aGlzLl9jdXRvdXQuaW50ZXJhY3RpdmUgPSB0cnVlOyAvLyBBdm9pZCB0cmlnZ2VyaW5nIG90aGVyIHRyYW5zaXRpb25zIGlmIG9uZSBpcyBhbHJlYWR5IGFjdGl2ZVxyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9jdXRvdXQpO1xyXG59O1xyXG5cclxuQ3V0b3V0VHJhbnNpdGlvbi5wcm90b3R5cGUuaW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuX2N1dG91dC5zaGFkZXIuc2NhbGUgPSB0aGlzLnN0YXJ0U2NhbGU7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9jdXRvdXQuc2hhZGVyLCB0aGlzLl9kdXJhdGlvbiAqIDAuNSwge1xyXG4gICAgICAgIHNjYWxlOiB0aGlzLmVuZFNjYWxlLFxyXG4gICAgICAgIGVhc2U6IFBvd2VyMi5lYXNlT3V0LFxyXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5pbi5jYWxsKHRoaXMsIHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25Db21wbGV0ZVNjb3BlOiB0aGlzXHJcbiAgICB9KTtcclxufTtcclxuXHJcbkN1dG91dFRyYW5zaXRpb24ucHJvdG90eXBlLm91dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5fY3V0b3V0LnNoYWRlci5zY2FsZSA9IHRoaXMuZW5kU2NhbGU7XHJcbiAgICBUd2Vlbk1heC50byh0aGlzLl9jdXRvdXQuc2hhZGVyLCB0aGlzLl9kdXJhdGlvbiAqIDAuNSwge1xyXG4gICAgICAgIHNjYWxlOiB0aGlzLnN0YXJ0U2NhbGUsXHJcbiAgICAgICAgZWFzZTogUG93ZXIyLmVhc2VJbixcclxuICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgVHJhbnNpdGlvbi5wcm90b3R5cGUub3V0LmNhbGwodGhpcywgdGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkNvbXBsZXRlU2NvcGU6IHRoaXNcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQ3V0b3V0VHJhbnNpdGlvbi5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgcmF0aW8gICAgICAgICAgID0gbmV3IFBJWEkuUG9pbnQoMC4wLCAwLjApO1xyXG4gICAgdmFyIGNhbnZhc1JhdGlvICAgICA9IHAzLlZpZXcud2lkdGggLyBwMy5WaWV3LmhlaWdodDtcclxuICAgIHZhciB0ZXh0dXJlUmF0aW8gICAgPSB0aGlzLl90ZXh0dXJlLndpZHRoIC8gdGhpcy5fdGV4dHVyZS5oZWlnaHQ7XHJcblxyXG4gICAgaWYgKGNhbnZhc1JhdGlvIC8gdGV4dHVyZVJhdGlvID4gMS4wKSB7XHJcbiAgICAgICAgcmF0aW8ueCA9IDEuMDtcclxuICAgICAgICByYXRpby55ID0gMS4wIC8gKGNhbnZhc1JhdGlvIC8gdGV4dHVyZVJhdGlvKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmF0aW8ueCA9IDEuMCAvIChjYW52YXNSYXRpbyAvIHRleHR1cmVSYXRpbyk7XHJcbiAgICAgICAgcmF0aW8ueSA9IDEuMDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9jdXRvdXQuc2NhbGUgICAgICAgICAgPSBuZXcgUElYSS5Qb2ludChwMy5WaWV3LndpZHRoLCBwMy5WaWV3LmhlaWdodCk7XHJcbiAgICB0aGlzLl9jdXRvdXQuc2hhZGVyLnJhdGlvICAgPSByYXRpbztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBAcmV0dXJucyB7VHJhbnNpdGlvbn1cclxuICovXHJcbkN1dG91dFRyYW5zaXRpb24ucHJvdG90eXBlLmZhbGxiYWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IEZhZGVUcmFuc2l0aW9uKHRoaXMuX2NvbG9yKTtcclxufTsiLCJ2YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFRyYW5zaXRpb24gICAgICA9IHJlcXVpcmUoXCIuL1RyYW5zaXRpb25cIik7XHJcblxyXG4vKipcclxuICogQHBhcmFtIHshTnVtYmVyfSBjb2xvclxyXG4gKiBAcGFyYW0geyFOdW1iZXJ9IGR1cmF0aW9uXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gRmFkZVRyYW5zaXRpb24oY29sb3IsIGR1cmF0aW9uKSB7XHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtOdW1iZXJ9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICB0aGlzLl9jb2xvciA9IGNvbG9yIHx8IDB4MDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtOdW1iZXJ9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDAuODtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtQSVhJLkdyYXBoaWNzfVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgdGhpcy5fcXVhZCA9IG51bGw7XHJcblxyXG4gICAgVHJhbnNpdGlvbi5jYWxsKHRoaXMpO1xyXG59XHJcbm1vZHVsZS5leHBvcnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBGYWRlVHJhbnNpdGlvbjtcclxuRmFkZVRyYW5zaXRpb24ucHJvdG90eXBlICAgICAgICAgICAgICAgICAgICA9IE9iamVjdC5jcmVhdGUoVHJhbnNpdGlvbi5wcm90b3R5cGUpO1xyXG5GYWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgICAgICAgID0gRmFkZVRyYW5zaXRpb247XHJcblxyXG5GYWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5fcXVhZCAgICAgICAgICA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XHJcbiAgICB0aGlzLl9xdWFkLnZpc2libGUgID0gZmFsc2U7XHJcbiAgICB0aGlzLl9xdWFkLmJlZ2luRmlsbCh0aGlzLl9jb2xvcik7XHJcbiAgICB0aGlzLl9xdWFkLmRyYXdSZWN0KDAuMCwgMC4wLCBwMy5WaWV3LndpZHRoLCBwMy5WaWV3LmhlaWdodCk7XHJcbiAgICB0aGlzLl9xdWFkLmVuZEZpbGwoKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fcXVhZCk7XHJcbn07XHJcblxyXG5GYWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuaW4gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuX3F1YWQuYWxwaGEgICAgPSAwLjA7XHJcbiAgICB0aGlzLl9xdWFkLnZpc2libGUgID0gdHJ1ZTtcclxuICAgIFR3ZWVuTWF4LnRvKHRoaXMuX3F1YWQsIHRoaXMuX2R1cmF0aW9uICogMC41LCB7XHJcbiAgICAgICAgYWxwaGE6IDEuMCxcclxuICAgICAgICBlYXNlOiBQb3dlcjIuZWFzZUluT3V0LFxyXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5pbi5jYWxsKHRoaXMsIHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25Db21wbGV0ZVNjb3BlOiB0aGlzXHJcbiAgICB9KTtcclxufTtcclxuXHJcbkZhZGVUcmFuc2l0aW9uLnByb3RvdHlwZS5vdXQgPSBmdW5jdGlvbigpIHtcclxuICAgIFR3ZWVuTWF4LnRvKHRoaXMuX3F1YWQsIHRoaXMuX2R1cmF0aW9uICogMC41LCB7XHJcbiAgICAgICAgYWxwaGE6IDAuMCxcclxuICAgICAgICBlYXNlOiBQb3dlcjIuZWFzZUluT3V0LFxyXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9xdWFkLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgVHJhbnNpdGlvbi5wcm90b3R5cGUub3V0LmNhbGwodGhpcywgdGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkNvbXBsZXRlU2NvcGU6IHRoaXNcclxuICAgIH0pO1xyXG59O1xyXG5cclxuRmFkZVRyYW5zaXRpb24ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5fcXVhZC5jbGVhcigpO1xyXG4gICAgdGhpcy5fcXVhZC5iZWdpbkZpbGwodGhpcy5fY29sb3IpO1xyXG4gICAgdGhpcy5fcXVhZC5kcmF3UmVjdCgwLjAsIDAuMCwgcDMuVmlldy53aWR0aCwgcDMuVmlldy5oZWlnaHQpO1xyXG4gICAgdGhpcy5fcXVhZC5lbmRGaWxsKCk7XHJcbn07IiwiLyoqXG4gKiAgTXV0ZUJ1dHRvblxuICpcbiAqICBDcmVhdGVkIGJ5IExlZ21hbiBvbiAxNi8wOS8yMDE1LlxuICpcbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7IVBJWEkuVGV4dHVyZX0gb25Ob3JtYWxUZXh0dXJlXG4gKiBAcGFyYW0geyFQSVhJLlRleHR1cmV9IG9mZk5vcm1hbFRleHR1cmVcbiAqIEBwYXJhbSB7UElYSS5UZXh0dXJlPX0gb25PdmVyVGV4dHVyZVxuICogQHBhcmFtIHtQSVhJLlRleHR1cmU9fSBvZmZPdmVyVGV4dHVyZVxuICogQHBhcmFtIHtQSVhJLlRleHR1cmU9fSBvbkRvd25UZXh0dXJlXG4gKiBAcGFyYW0ge1BJWEkuVGV4dHVyZT19IG9mZkRvd25UZXh0dXJlXG4gKiBAcGFyYW0ge1BJWEkuVGV4dHVyZT19IG9uRGlzYWJsZWRUZXh0dXJlXG4gKiBAcGFyYW0ge1BJWEkuVGV4dHVyZT19IG9mZkRpc2FibGVkVGV4dHVyZVxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIE11dGVCdXR0b24oXG4gICAgb25Ob3JtYWxUZXh0dXJlLFxuICAgIG9mZk5vcm1hbFRleHR1cmUsXG4gICAgb25PdmVyVGV4dHVyZSxcbiAgICBvZmZPdmVyVGV4dHVyZSxcbiAgICBvbkRvd25UZXh0dXJlLFxuICAgIG9mZkRvd25UZXh0dXJlXG4pIHtcbiAgICB2YXIgYXVkaW8gPSBwMy5BdWRpb01hbmFnZXIuaW5zdGFuY2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UElYSS5UZXh0dXJlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fb25Ob3JtYWxUZXh0dXJlID0gb25Ob3JtYWxUZXh0dXJlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge1BJWEkuVGV4dHVyZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX29mZk5vcm1hbFRleHR1cmUgPSBvZmZOb3JtYWxUZXh0dXJlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge1BJWEkuVGV4dHVyZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX29uT3ZlclRleHR1cmUgPSBvbk92ZXJUZXh0dXJlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge1BJWEkuVGV4dHVyZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX29mZk92ZXJUZXh0dXJlID0gb2ZmT3ZlclRleHR1cmU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UElYSS5UZXh0dXJlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fb25Eb3duVGV4dHVyZSA9IG9uRG93blRleHR1cmU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UElYSS5UZXh0dXJlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fb2ZmRG93blRleHR1cmUgPSBvZmZEb3duVGV4dHVyZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtQSVhJLlRleHR1cmV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9ub3JtYWxUZXh0dXJlID0gYXVkaW8uaXNNdXRlID8gb2ZmTm9ybWFsVGV4dHVyZSA6IG9uTm9ybWFsVGV4dHVyZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtQSVhJLlRleHR1cmV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9vdmVyVGV4dHVyZSA9IGF1ZGlvLmlzTXV0ZSA/IG9mZk92ZXJUZXh0dXJlIDogb25PdmVyVGV4dHVyZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtQSVhJLlRleHR1cmV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9kb3duVGV4dHVyZSA9IGF1ZGlvLmlzTXV0ZSA/IG9mZk92ZXJUZXh0dXJlIDogb25Eb3duVGV4dHVyZTtcblxuXG4gICAgcDMuQnV0dG9uLmNhbGwoXG4gICAgICAgIHRoaXMsXG4gICAgICAgIHRoaXMuX25vcm1hbFRleHR1cmUsXG4gICAgICAgIHRoaXMuX292ZXJUZXh0dXJlLFxuICAgICAgICB0aGlzLl9kb3duVGV4dHVyZVxuICAgICk7XG59XG5tb2R1bGUuZXhwb3J0cyAgICAgICAgICAgICAgICAgICAgICA9IE11dGVCdXR0b247XG5NdXRlQnV0dG9uLnByb3RvdHlwZSAgICAgICAgICAgICAgICA9IE9iamVjdC5jcmVhdGUocDMuQnV0dG9uLnByb3RvdHlwZSk7XG5NdXRlQnV0dG9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciAgICA9IE11dGVCdXR0b247XG5cbi8qKlxuICogQHBhcmFtIHshRXZlbnR9IGV2ZW50XG4gKi9cbk11dGVCdXR0b24ucHJvdG90eXBlLm9uTW91c2VDbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGF1ZGlvID0gcDMuQXVkaW9NYW5hZ2VyLmluc3RhbmNlO1xuICAgIGF1ZGlvLm11dGUoIWF1ZGlvLmlzTXV0ZSk7XG5cbiAgICB0aGlzLl9ub3JtYWxUZXh0dXJlICAgICA9IGF1ZGlvLmlzTXV0ZSA/IHRoaXMuX29mZk5vcm1hbFRleHR1cmUgICAgOiB0aGlzLl9vbk5vcm1hbFRleHR1cmU7XG4gICAgdGhpcy5fb3ZlclRleHR1cmUgICAgICAgPSBhdWRpby5pc011dGUgPyB0aGlzLl9vZmZPdmVyVGV4dHVyZSAgICAgIDogdGhpcy5fb25PdmVyVGV4dHVyZTtcbiAgICB0aGlzLl9kb3duVGV4dHVyZSAgICAgICA9IGF1ZGlvLmlzTXV0ZSA/IHRoaXMuX29mZkRvd25UZXh0dXJlICAgICAgOiB0aGlzLl9vbkRvd25UZXh0dXJlO1xuICAgIHRoaXMuX2Rpc2FibGVkVGV4dHVyZSAgID0gYXVkaW8uaXNNdXRlID8gdGhpcy5fb2ZmRGlzYWJsZWRUZXh0dXJlICA6IHRoaXMuX29uRGlzYWJsZWRUZXh0dXJlO1xuXG4gICAgcDMuQnV0dG9uLnByb3RvdHlwZS5vbk1vdXNlQ2xpY2suY2FsbCh0aGlzLCBldmVudCk7XG59O1xuIiwiLyoqXG4gKiAgU2NlbmVcbiAqXG4gKiAgQ3JlYXRlZCBieSBMZWdtYW4gb24gNC8wOS8yMDE1LlxuICpcbiAqL1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBTY2VuZSgpIHtcbiAgICB0aGlzLnNpZ25hbHMgICAgICAgICAgICA9IHt9O1xuICAgIHRoaXMuc2lnbmFscy5uZXh0ICAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zaWduYWxzLnByZXZpb3VzICAgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcbiAgICB0aGlzLnNpZ25hbHMuaG9tZSAgICAgICA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuc2lnbmFscy5wYXVzZSAgICAgID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG5cbiAgICBQSVhJLkNvbnRhaW5lci5jYWxsKHRoaXMpO1xufVxubW9kdWxlLmV4cG9ydHMgICAgICAgICAgICAgICAgICA9IFNjZW5lO1xuU2NlbmUucHJvdG90eXBlICAgICAgICAgICAgICAgICA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcblNjZW5lLnByb3RvdHlwZS5jb25zdHJ1Y3RvciAgICAgPSBTY2VuZTtcblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgd2hlbiBhIHNjZW5lIGlzIGluaXRpYWxpemVkLlxuICovXG5TY2VuZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIG92ZXJyaWRlXG59O1xuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aGVuIGEgc2NlbmUgaXMgZGVzdHJveWVkLlxuICovXG5TY2VuZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2lnbmFscy5uZXh0LmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMucHJldmlvdXMuZGlzcG9zZSgpO1xuICAgIHRoaXMuc2lnbmFscy5ob21lLmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMucGF1c2UuZGlzcG9zZSgpO1xuXG4gICAgdGhpcy5yZW1vdmVDaGlsZHJlbigpO1xufTtcblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgd2hlbiB0aGUgZGV2aWNlIGRpbWVuc2lvbnMgYXJlIGNoYW5nZWQuXG4gKi9cblNjZW5lLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBvdmVycmlkZVxufTtcblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgd2hlbiB0aGUgc2NlbmUgaXMgJ3RvcCcgb2YgdGhlIHN0YWNrLlxuICovXG5TY2VuZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gb3ZlcnJpZGVcbn07XG5cbi8qKlxuICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gdGhlIHNjZW5lIGlzIHNob3duIGZvciB0aGUgZmlyc3QgdGltZS5cbiAqL1xuU2NlbmUucHJvdG90eXBlLmFwcGVhciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuYW5pbWF0ZUluKCk7XG59O1xuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aGVuIHRoZSBzY2VuZSBpcyBzaG93biAtIHJlZ2FyZGxlc3Mgb2YgYWN0dWFsIHZpc2liaWxpdHkuXG4gKi9cblNjZW5lLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5hbmltYXRlSW4oKTtcbn07XG5cbi8qKlxuICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gdGhlIHNjZW5lIGlzIGhpZGRlbiAtIHJlZ2FyZGxlc3Mgb2YgYWN0dWFsIHZpc2liaWxpdHkuXG4gKi9cblNjZW5lLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gb3ZlcnJpZGVcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5TY2VuZS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKSB7XG4gICAgc2NvcGUgPSBzY29wZSB8fCB3aW5kb3c7XG4gICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUpO1xuICAgIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHshRnVuY3Rpb259IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5TY2VuZS5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSkge1xuICAgIHNjb3BlID0gc2NvcGUgfHwgd2luZG93O1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjay5jYWxsKHNjb3BlKTtcbiAgICB9XG59OyIsIi8qKlxuICogIFNjZW5lTWFuYWdlclxuICpcbiAqICBDcmVhdGVkIGJ5IExlZ21hbiBvbiA0LzA5LzIwMTUuXG4gKlxuICovXG5cbnZhciBTY2VuZSAgICAgICA9IHJlcXVpcmUoXCIuL1NjZW5lXCIpO1xudmFyIFRyYW5zaXRpb24gID0gcmVxdWlyZShcIi4vVHJhbnNpdGlvblwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gU2NlbmVNYW5hZ2VyKCkge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtQSVhJLkRpc3BsYXlPYmplY3R9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLl9zdGFnZSA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UElYSS5DYW52YXNSZW5kZXJlciB8IFBJWEkuV2ViR0xSZW5kZXJlcn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuX3JlbmRlcmVyID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtBcnJheS48U2NlbmU+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fc3RhY2sgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtUcmFuc2l0aW9ufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5fdHJhbnNpdGlvbiA9IG51bGw7XG59XG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lTWFuYWdlcjtcblxuLyoqXG4gKiBAcGFyYW0geyFQSVhJLkRpc3BsYXlPYmplY3R9IHN0YWdlXG4gKiBAcGFyYW0geyFQSVhJLkNhbnZhc1JlbmRlcmVyIHwgIVBJWEkuV2ViR0xSZW5kZXJlcn0gcmVuZGVyZXJcbiAqL1xuU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oc3RhZ2UsIHJlbmRlcmVyKSB7XG4gICAgdGhpcy5fc3RhZ2UgICAgICAgICA9IHN0YWdlO1xuICAgIHRoaXMuX3JlbmRlcmVyICAgICAgPSByZW5kZXJlcjtcbn07XG5cbi8qKlxuICovXG5TY2VuZU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLl9zdGFjay5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy50b3AudXBkYXRlKCk7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0geyFTY2VuZX0gc2NlbmVcbiAqIEBwYXJhbSB7VHJhbnNpdGlvbj19IHRyYW5zaXRpb25cbiAqL1xuU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbihzY2VuZSwgdHJhbnNpdGlvbikge1xuICAgIGlmICh0aGlzLnRyYW5zaXRpb25JblByb2dyZXNzKSByZXR1cm47XG5cbiAgICB0aGlzLl90cmFuc2l0aW9uID0gdHJhbnNpdGlvbiB8fCBuZXcgVHJhbnNpdGlvbigpO1xuICAgIGlmICh0aGlzLl90cmFuc2l0aW9uLnJlcXVpcmVzV2ViR0wgJiYgISh0aGlzLl9yZW5kZXJlciBpbnN0YW5jZW9mIFBJWEkuV2ViR0xSZW5kZXJlcikpIHtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbiAgICAgICAgICAgID0gdHJhbnNpdGlvbi5mYWxsYmFjaygpO1xuICAgICAgICB0aGlzLl90cmFuc2l0aW9uLnB1c2ggICAgICAgPSB0cmFuc2l0aW9uLnB1c2g7XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24ucmVwbGFjZSAgICA9IHRyYW5zaXRpb24ucmVwbGFjZTtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbi53YWl0ICAgICAgID0gdHJhbnNpdGlvbi53YWl0O1xuICAgIH1cbiAgICB0aGlzLl90cmFuc2l0aW9uLmluaXQoKTtcbiAgICB0aGlzLl9zdGFnZS5hZGRDaGlsZCh0aGlzLl90cmFuc2l0aW9uKTtcblxuICAgIHRoaXMuX3RyYW5zaXRpb24uc2lnbmFscy5pbi5hZGRPbmNlKGZ1bmN0aW9uKHRyYW5zaXRpb24pIHtcbiAgICAgICAgcDMuVGltZXN0ZXAucXVldWVDYWxsKHN3YXAsIFtzY2VuZV0sIHRoaXMpO1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuX3RyYW5zaXRpb24uc2lnbmFscy5vdXQuYWRkT25jZShmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24gPSBudWxsO1xuXG4gICAgICAgIHRyYW5zaXRpb24ucGFyZW50LnJlbW92ZUNoaWxkKHRyYW5zaXRpb24pO1xuICAgICAgICB0cmFuc2l0aW9uLmRpc3Bvc2UoKTtcblxuICAgICAgICBpZiAodHJhbnNpdGlvbi53YWl0KSB7XG4gICAgICAgICAgICBwMy5UaW1lc3RlcC5xdWV1ZUNhbGwoc2NlbmUuYXBwZWFyLCBudWxsLCBzY2VuZSk7XG4gICAgICAgIH1cbiAgICB9LCB0aGlzKTtcbiAgICB0aGlzLl90cmFuc2l0aW9uLmluKCk7XG5cbiAgICBmdW5jdGlvbiBzd2FwKHNjZW5lKSB7XG4gICAgICAgIGlmICh0aGlzLnRvcCkge1xuICAgICAgICAgICAgdGhpcy50b3AuaGlkZSgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl90cmFuc2l0aW9uLnB1c2gpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3AucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3AuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3RyYW5zaXRpb24ucmVwbGFjZSkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fc3RhY2subGVuZ3RoOyArKyBpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSB0aGlzLl9zdGFja1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXAucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLnBhcmVudC5yZW1vdmVDaGlsZCh0ZW1wKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHNjZW5lLmluaXQoKTtcbiAgICAgICAgc2NlbmUucmVzaXplKCk7XG4gICAgICAgIGlmICghc2NlbmUucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnN0YWdlLmFkZENoaWxkQXQoc2NlbmUsIHRoaXMuX3RyYW5zaXRpb24ucGFyZW50LmdldENoaWxkSW5kZXgodGhpcy5fdHJhbnNpdGlvbikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0YWNrLnB1c2goc2NlbmUpO1xuXG4gICAgICAgIGlmICghdGhpcy5fdHJhbnNpdGlvbi53YWl0KSB7XG4gICAgICAgICAgICBwMy5UaW1lc3RlcC5xdWV1ZUNhbGwoc2NlbmUuYXBwZWFyLCBudWxsLCBzY2VuZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbi5vdXQoKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9zdGFjayk7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0ge1RyYW5zaXRpb249fSB0cmFuc2l0aW9uXG4gKiBAcGFyYW0ge051bWJlcj19IGNvdW50XG4gKi9cblNjZW5lTWFuYWdlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24odHJhbnNpdGlvbiwgY291bnQpIHtcbiAgICBpZiAodGhpcy50cmFuc2l0aW9uSW5Qcm9ncmVzcykgcmV0dXJuO1xuXG4gICAgdGhpcy5fdHJhbnNpdGlvbiAgICA9IHRyYW5zaXRpb24gfHwgbmV3IFRyYW5zaXRpb24oKTtcbiAgICBjb3VudCAgICAgICAgICAgICAgID0gTWF0aC5tYXgoMSwgY291bnQpIHx8IDE7XG4gICAgaWYgKHRoaXMuX3RyYW5zaXRpb24ucmVxdWlyZXNXZWJHTCAmJiAhKHRoaXMuX3JlbmRlcmVyIGluc3RhbmNlb2YgUElYSS5XZWJHTFJlbmRlcmVyKSkge1xuICAgICAgICB0aGlzLl90cmFuc2l0aW9uICAgICAgICAgICAgPSB0cmFuc2l0aW9uLmZhbGxiYWNrKCk7XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24ucHVzaCAgICAgICA9IHRyYW5zaXRpb24ucHVzaDtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbi5yZXBsYWNlICAgID0gdHJhbnNpdGlvbi5yZXBsYWNlO1xuICAgICAgICB0aGlzLl90cmFuc2l0aW9uLndhaXQgICAgICAgPSB0cmFuc2l0aW9uLndhaXQ7XG4gICAgfVxuICAgIHRoaXMuX3RyYW5zaXRpb24uaW5pdCgpO1xuICAgIHRoaXMuX3N0YWdlLmFkZENoaWxkKHRoaXMuX3RyYW5zaXRpb24pO1xuXG4gICAgdGhpcy5fdHJhbnNpdGlvbi5zaWduYWxzLmluLmFkZE9uY2UoZnVuY3Rpb24odHJhbnNpdGlvbikge1xuICAgICAgICBwMy5UaW1lc3RlcC5xdWV1ZUNhbGwoc3dhcCwgW2NvdW50XSwgdGhpcyk7XG4gICAgfSwgdGhpcyk7XG4gICAgdGhpcy5fdHJhbnNpdGlvbi5zaWduYWxzLm91dC5hZGRPbmNlKGZ1bmN0aW9uKHRyYW5zaXRpb24pIHtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbiA9IG51bGw7XG5cbiAgICAgICAgdHJhbnNpdGlvbi5wYXJlbnQucmVtb3ZlQ2hpbGQodHJhbnNpdGlvbik7XG4gICAgICAgIHRyYW5zaXRpb24uZGlzcG9zZSgpO1xuXG4gICAgICAgIGlmICh0cmFuc2l0aW9uLndhaXQpIHtcbiAgICAgICAgICAgIHRoaXMudG9wLnNob3coKTtcbiAgICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuX3RyYW5zaXRpb24uaW4oKTtcblxuICAgIGZ1bmN0aW9uIHN3YXAoY291bnQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKysgaSkge1xuICAgICAgICAgICAgdGhpcy50b3AuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy50b3AucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMudG9wKTtcbiAgICAgICAgICAgIHRoaXMudG9wLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YWNrLnBvcCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNjZW5lID0gdGhpcy50b3A7XG4gICAgICAgIHNjZW5lLnJlc2l6ZSgpO1xuICAgICAgICBpZiAoIXNjZW5lLnBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5zdGFnZS5hZGRDaGlsZEF0KHNjZW5lLCB0aGlzLl90cmFuc2l0aW9uLnBhcmVudC5nZXRDaGlsZEluZGV4KHRoaXMuX3RyYW5zaXRpb24pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5fdHJhbnNpdGlvbi53YWl0KSB7XG4gICAgICAgICAgICBzY2VuZS5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbi5vdXQoKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9zdGFjayk7XG4gICAgfVxufTtcblxuLyoqXG4gKi9cblNjZW5lTWFuYWdlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbn07XG5cbi8qKlxuICovXG5TY2VuZU1hbmFnZXIucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzY2VuZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3N0YWNrLmxlbmd0aDsgKysgaSkge1xuICAgICAgICBzY2VuZSA9IHRoaXMuX3N0YWNrW2ldO1xuICAgICAgICBzY2VuZS5yZXNpemUoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX3RyYW5zaXRpb24pIHtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbi5yZXNpemUoKTtcbiAgICB9XG59O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoU2NlbmVNYW5hZ2VyLnByb3RvdHlwZSwgXCJzdGFnZVwiLCB7XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge1BJWEkuRGlzcGxheU9iamVjdH1cbiAgICAgKi9cbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhZ2U7XG4gICAgfVxufSk7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY2VuZU1hbmFnZXIucHJvdG90eXBlLCBcInRvcFwiLCB7XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge1NjZW5lfVxuICAgICAqL1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGFjay5sZW5ndGggPyB0aGlzLl9zdGFja1t0aGlzLl9zdGFjay5sZW5ndGggLSAxXSA6IG51bGw7XG4gICAgfVxufSk7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY2VuZU1hbmFnZXIucHJvdG90eXBlLCBcInRyYW5zaXRpb25JblByb2dyZXNzXCIsIHtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX3RyYW5zaXRpb24gIT0gbnVsbCA/IHRydWUgOiBmYWxzZSk7XG4gICAgfVxufSk7XG4iLCIvKipcbiAqICBUcmFuc2l0aW9uXG4gKlxuICogIENyZWF0ZWQgYnkgTGVnbWFuIG9uIDQvMDkvMjAxNS5cbiAqXG4gKi9cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gVHJhbnNpdGlvbigpIHtcbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Kn1cbiAgICAgKi9cbiAgICB0aGlzLnNpZ25hbHMgICAgICAgID0ge307XG4gICAgdGhpcy5zaWduYWxzLmluICAgICA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuc2lnbmFscy5vdXQgICAgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtCb29sZWFufVxuICAgICAqL1xuICAgIHRoaXMucHVzaCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge0Jvb2xlYW59XG4gICAgICovXG4gICAgdGhpcy5yZXBsYWNlID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtCb29sZWFufVxuICAgICAqL1xuICAgIHRoaXMud2FpdCA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICB0aGlzLnJlcXVpcmVzV2ViR0wgPSBmYWxzZTtcblxuICAgIFBJWEkuQ29udGFpbmVyLmNhbGwodGhpcyk7XG59XG5tb2R1bGUuZXhwb3J0cyAgICAgICAgICAgICAgICAgICAgICA9IFRyYW5zaXRpb247XG5UcmFuc2l0aW9uLnByb3RvdHlwZSAgICAgICAgICAgICAgICA9IE9iamVjdC5jcmVhdGUoUElYSS5Db250YWluZXIucHJvdG90eXBlKTtcblRyYW5zaXRpb24ucHJvdG90eXBlLmNvbnN0cnVjdG9yICAgID0gVHJhbnNpdGlvbjtcblxuVHJhbnNpdGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIG92ZXJyaWRlXG59O1xuXG5UcmFuc2l0aW9uLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zaWduYWxzLmluLmRpc3Bvc2UoKTtcbiAgICB0aGlzLnNpZ25hbHMub3V0LmRpc3Bvc2UoKTtcblxuICAgIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcbn07XG5cblRyYW5zaXRpb24ucHJvdG90eXBlLmluID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zaWduYWxzLmluLmRpc3BhdGNoKHRoaXMpO1xufTtcblxuVHJhbnNpdGlvbi5wcm90b3R5cGUub3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zaWduYWxzLm91dC5kaXNwYXRjaCh0aGlzKTtcbn07XG5cbi8qKlxuICogQHJldHVybnMge1RyYW5zaXRpb259XG4gKi9cblRyYW5zaXRpb24ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIG92ZXJyaWRlXG59O1xuXG5UcmFuc2l0aW9uLnByb3RvdHlwZS5mYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIG92ZXJyaWRlXG59OyIsInZhciBDb21tb24gICAgICAgXHRcdD0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcbnZhciBTaW1wbGVTY3JlZW4gXHRcdD0gcmVxdWlyZShcIi4uL3NjcmVlbnMvU2ltcGxlU2NyZWVuXCIpO1xudmFyIFdpcmVmcmFtZUJ1dHRvbiBcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uXCIpO1xudmFyIFNvdW5kU0ZYICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUUlVDVE9SXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBDaGFyYWN0ZXJVbmxvY2tlZE92ZXJsYXkoY2hhcmFjdGVyKVxue1xuXHR0aGlzLl9jaGFyYWN0ZXIgICA9IGNoYXJhY3RlcjtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IG51bGw7XG5cblx0U2ltcGxlU2NyZWVuLmNhbGwodGhpcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5O1xuQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XG5DaGFyYWN0ZXJVbmxvY2tlZE92ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5O1xuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQVUJMSUMgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cbkNoYXJhY3RlclVubG9ja2VkT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XG5cblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFja1NxdWFyZSddKTtcblx0dGhpcy5fYmcuYWxwaGEgICAgICAgPSAwLjc1O1xuXHR0aGlzLl9iZy53aWR0aCAgICAgICA9IENvbW1vbi5TVEFHRV9XSURUSDtcblx0dGhpcy5fYmcuaGVpZ2h0ICAgICAgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xuXHR0aGlzLl9iZy5oaXRBcmVhICAgICA9IG5ldyBQSVhJLlJlY3RhbmdsZSgwLCAwLCBDb21tb24uU1RBR0VfV0lEVEgsIENvbW1vbi5TVEFHRV9IRUlHSFQpO1xuXHR0aGlzLl9iZy5pbnRlcmFjdGl2ZSA9IHRydWU7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xuXG5cblx0dGhpcy5fdGl0bGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV90aXRsZV9iZ1wiKSk7XG5cdHRoaXMuX3RpdGxlLmFuY2hvci5zZXQoMC41KTtcblx0dGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl90aXRsZS55ID0gMTAwO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcblxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiVU5MT0NLRURcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XG5cblx0XHRpZighd2ViZm9udClcblx0XHR7XG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcblx0XHRcdHRpdGxlLnkgPSAtdGl0bGUudGV4dEhlaWdodC8yIC0gNDtcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHR0aXRsZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aXRsZS55ID0gLTY7XG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XG5cdFx0fVxuXG4gICAgdGhpcy5fbWVzc2FnZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3BvcHVwX2JnXCIpKTtcblx0dGhpcy5fbWVzc2FnZUJveC5hbmNob3Iuc2V0KDAuNSk7XG5cdHRoaXMuX21lc3NhZ2VCb3gueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl9tZXNzYWdlQm94LnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzIgKyA3MDtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX21lc3NhZ2VCb3gpO1xuXG5cdFx0Ly8gQ2hhcmFjdGVyXG5cdFx0Ly8gdGhpcy5fY2hhciA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2NoYXJfXCIgKyB0aGlzLl9jaGFyYWN0ZXIpKTtcblx0XHQvLyB0aGlzLl9jaGFyLnBvc2l0aW9uLnNldCgyNTAsMzQwKTtcblx0XHQvLyB0aGlzLl9jaGFyLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHQvLyB0aGlzLl9jaGFyLnNjYWxlLnggPSAtMTtcblx0XHQvLyB0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2NoYXIpO1xuXHRcdFxuXHRcdHRoaXMuX2NoYXIgPSBuZXcgUElYSS5zcGluZS5TcGluZShDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YVt0aGlzLl9jaGFyYWN0ZXJdKTtcblx0XHR0aGlzLl9jaGFyLnNrZWxldG9uLnNldFRvU2V0dXBQb3NlKCk7XG5cdFx0dGhpcy5fY2hhci5za2VsZXRvbi5zZXRTa2luKG51bGwpO1xuXHRcdHRoaXMuX2NoYXIuc2tlbGV0b24uc2V0U2tpbkJ5TmFtZShcImRlZmF1bHRcIik7XG5cdFx0dGhpcy5fY2hhci54ID0gMjAwO1xuXHRcdHRoaXMuX2NoYXIueSA9IDM0MDtcblx0XHR0aGlzLl9jaGFyLmF1dG9VcGRhdGUgPSB0cnVlO1xuXHRcdHRoaXMuX2NoYXIuc2NhbGUuc2V0KDAuNSk7XG5cdFx0dGhpcy5fY2hhci5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMCwgXCJsb29rX2xlZnRcIiwgdHJ1ZSwgMCk7XG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9jaGFyKTtcdFx0XHRcdFxuXG5cdFx0Ly8gVGV4dFxuXHRcdHZhciBkYXRhID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuY2hhcmFjdGVyc1t0aGlzLl9jaGFyYWN0ZXJdO1xuXG5cdFx0dmFyIGRlY28gPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2RlY29cIikpO1xuXHRcdGRlY28uYW5jaG9yLnNldCgwLjUpO1xuXHRcdGRlY28ucG9zaXRpb24uc2V0KC0xNjAsIC0xMzApO1xuXHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQoZGVjbyk7XG5cblx0XHR2YXIgbG9jayA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLl9jaGFyYWN0ZXIgIT0gXCJwYWJiaWVcIiA/IFwidWlfaWNvbl9jaGFyX2NyeXN0YWxfXCIgKyBkYXRhLmNvbG9yIDogXCJ1aV9pY29uX3Jlc3VsdHNfdHJvbGxzXCIpKTtcblx0XHRsb2NrLmFuY2hvci5zZXQoMC41KTtcblx0XHRsb2NrLnBvc2l0aW9uID0gZGVjby5wb3NpdGlvbjtcblx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKGxvY2spO1xuXG5cdFx0Ly8gTmFtZVxuXHRcdHZhciBjb3B5ID0gZGF0YS5uYW1lW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0aWYoIXdlYmZvbnQpXG5cdFx0e1xuXHRcdFx0dGhpcy5fbmFtZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjQycHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XG5cdFx0XHR0aGlzLl9uYW1lLnggPSAtIHRoaXMuX25hbWUudGV4dFdpZHRoLzIgLSAxNjA7XG5cdFx0XHR0aGlzLl9uYW1lLnkgPSAtIHRoaXMuX25hbWUudGV4dEhlaWdodC8yIC0gNTtcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fbmFtZSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGlzLl9uYW1lID0gbmV3IFBJWEkuVGV4dChkYXRhLm5hbWVbQ29tbW9uLkNPVU5UUllfQ09ERV0sIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGhpcy5fbmFtZS5wb3NpdGlvbi5zZXQoLTE2MCwtMTApO1xuXHRcdFx0dGhpcy5fbmFtZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX25hbWUpO1xuXHRcdH1cblxuXHRcdC8vIERlc2Ncblx0XHR2YXIgY29weSA9IGRhdGEuZGVzY3JpcHRpb25bQ29tbW9uLkNPVU5UUllfQ09ERV07XG5cblx0XHRpZighd2ViZm9udClcblx0XHR7XG5cdFx0XHR0aGlzLl9kZXNjcmlwdGlvbiA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjI0cHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcblx0XHRcdHRoaXMuX2Rlc2NyaXB0aW9uLnggPSAtIHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRXaWR0aC8yIC0gMTYwO1xuXHRcdFx0dGhpcy5fZGVzY3JpcHRpb24ueSA9ICsgNDA7XG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Rlc2NyaXB0aW9uKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoaXMuX2Rlc2NyaXB0aW9uID0gbmV3IFBJWEkuVGV4dChkYXRhLmRlc2NyaXB0aW9uW0NvbW1vbi5DT1VOVFJZX0NPREVdLnJlcGxhY2UoL1xcbi9naSwgXCJcIiksIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJywgd29yZFdyYXA6dHJ1ZSwgd29yZFdyYXBXaWR0aDozMDB9KTtcblx0XHRcdHRoaXMuX2Rlc2NyaXB0aW9uLnBvc2l0aW9uLnNldCgtMTYwLDEwMCk7XG5cdFx0XHR0aGlzLl9kZXNjcmlwdGlvbi5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Rlc2NyaXB0aW9uKTtcblx0XHR9XG5cblx0dGhpcy5fY2xvc2VCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdChcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdmVyXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfY3Jvc3NcIilcblx0KTtcblx0dGhpcy5fY2xvc2VCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHR0aGlzLl9jbG9zZUJ1dHRvbi54ID0gcjJsID8gLTQwMCA6IDQwMDtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi55ID0gLTI0MDtcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Nsb3NlQnV0dG9uKTtcblx0XG5cdC8vIEludHJvXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfdWlfY2hhcmFjdGVyX3VubG9ja18wMVwiKTtcblxuXHR0aGlzLnNub3dQU0NvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLnNub3dQU0NvbnRhaW5lci54ID0gdGhpcy5fZ2V0Qm9yZGVyQnV0dG9uUG9zaXRpb25SaWdodCgpO1xuXHR0aGlzLnNub3dQU0NvbnRhaW5lci55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVC8yO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuc25vd1BTQ29udGFpbmVyKTtcblx0XG5cdHRoaXMuc25vd1BTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5zbm93UFNDb250YWluZXIsXG5cdFtcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV9vZmZzZXRfMDBcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2Vfb2Zmc2V0XzAxXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wMlwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV9vZmZzZXRfMDNcIilcblx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9jaGFyYWN0ZXJfdW5sb2NrXCIpKTtcblx0dGhpcy5zbm93UFMuZW1pdCA9IHRydWU7XHRcblx0XG5cdFxufTtcblxuLyoqXG4gKi9cbkNoYXJhY3RlclVubG9ja2VkT3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLnNub3dQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcbn07XG5cbi8qKlxuICovXG5DaGFyYWN0ZXJVbmxvY2tlZE92ZXJsYXkucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcbntcblxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xufTtcblxuLyoqXG4gKi9cbkNoYXJhY3RlclVubG9ja2VkT3ZlcmxheS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcbntcblxufVxuXG5DaGFyYWN0ZXJVbmxvY2tlZE92ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcblxuXHR0aGlzLl9iZy5hbHBoYSA9IDA7XG5cdHRoaXMuX3RpdGxlLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcblxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLjc1LCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XG5cdFx0dGwudG8odGhpcy5fY2xvc2VCdXR0b24uc2NhbGUsICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNik7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xufTtcblxuQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcblxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sICAwKTtcblx0XHR0bC50byh0aGlzLl90aXRsZS5zY2FsZSwgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5zY2FsZSwgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcbn07XG5cblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFJJVkFURSBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuQ2hhcmFjdGVyVW5sb2NrZWRPdmVybGF5LnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuYW5pbWF0ZU91dChmdW5jdGlvbigpXG5cdHtcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcblx0fSwgdGhpcyk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVRURVJTL1NFVFRFUlNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiIsInZhciBDb21tb24gICAgICAgXHRcdD0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiBcdFx0PSByZXF1aXJlKFwiLi4vc2NyZWVucy9TaW1wbGVTY3JlZW5cIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gQ29kZU92ZXJsYXkoKVxyXG57XHJcblx0dGhpcy5fY29kZSAgICAgICAgPSBcIlwiO1xyXG5cdHRoaXMuX21heExlbmd0aCAgID0gMTA7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IG51bGw7XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IENvZGVPdmVybGF5O1xyXG5Db2RlT3ZlcmxheS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5Db2RlT3ZlcmxheS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDb2RlT3ZlcmxheTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5Db2RlT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xyXG5cdHRoaXMuX2JnLmFscGhhICAgICAgID0gMC43NTtcclxuXHR0aGlzLl9iZy53aWR0aCAgICAgICA9IENvbW1vbi5TVEFHRV9XSURUSDtcclxuXHR0aGlzLl9iZy5oZWlnaHQgICAgICA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XHJcblx0dGhpcy5fYmcuaGl0QXJlYSAgICAgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuXHR0aGlzLl9iZy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9iZyk7XHJcblxyXG5cclxuXHQvLyBDb2RlIHNjcmVlblxyXG5cdHRoaXMuX2NvZGVTY3JlZW4gPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2NvZGVTY3JlZW4pO1xyXG5cclxuXHRcdC8vIFRpdGxlXHJcblx0XHR0aGlzLl9jb2RlU2NyZWVuLl90aXRsZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3RpdGxlX2JnXCIpKTtcclxuXHRcdHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHRcdHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlLnkgPSAxMDA7XHJcblx0XHR0aGlzLl9jb2RlU2NyZWVuLmFkZENoaWxkKHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlKTtcclxuXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5URVJfQ09ERVwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDJweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0XHR0aXRsZS54ID0gLXRpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHRcdHRpdGxlLnkgPSAtdGl0bGUudGV4dEhlaWdodC8yIC0gNDtcclxuXHRcdFx0XHR0aGlzLl9jb2RlU2NyZWVuLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjM2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuXHRcdFx0XHR0aXRsZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0dGl0bGUueSA9IC02O1xyXG5cdFx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdC8vIENvZGVib2FyZFxyXG5cdFx0dGhpcy5fY29kZVNjcmVlbi5fY29kZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3JlZGVlbV9wYW5lbFwiKSk7XHJcblx0XHR0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3gueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdFx0dGhpcy5fY29kZVNjcmVlbi5fY29kZUJveC55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVC8yICsgNzA7XHJcblx0XHR0aGlzLl9jb2RlU2NyZWVuLmFkZENoaWxkKHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3gpO1xyXG5cclxuXHRcdFx0Ly8gQ2xvc2UgYnV0dG9uXHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0XHQoXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X291dFwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfZG93blwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X2Nyb3NzXCIpXHJcblx0XHRcdCk7XHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2Nsb3NlQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHRcdFx0dGhpcy5fY29kZVNjcmVlbi5fY2xvc2VCdXR0b24ueCA9IChyMmwgPyAtMSA6IDEpICogMjYwO1xyXG5cdFx0XHR0aGlzLl9jb2RlU2NyZWVuLl9jbG9zZUJ1dHRvbi55ID0gLTIzMDtcclxuXHRcdFx0dGhpcy5fY29kZVNjcmVlbi5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmFkZENoaWxkKHRoaXMuX2NvZGVTY3JlZW4uX2Nsb3NlQnV0dG9uKTtcclxuXHJcblx0XHRcdC8vIFRleHRcclxuXHRcdFx0dGhpcy5fY29kZVNjcmVlbi5fY29kZUJveC5jb2RlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoXCJcIiwge2ZvbnQ6IFwiNDBweCBNaWthZGFuIFRpdGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guY29kZS54ID0gLSB0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmNvZGUudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guY29kZS55ID0gLSB0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmNvZGUudGV4dEhlaWdodC8yIC0gMTQ4O1xyXG5cdFx0XHR0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmFkZENoaWxkKHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guY29kZSk7XHJcblxyXG5cdFx0XHQvLyBEaWdpdHMgYnV0dG9uXHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2RpZ2l0QnV0dG9ucyA9IFtdO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IDk7IGkrKylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciB4ID0gaSAlIDM7XHJcblx0XHRcdFx0dmFyIHkgPSBNYXRoLmZsb29yKGkvMyk7XHJcblxyXG5cdFx0XHRcdHZhciBidXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5faW5wdXRfbm9ybWFsXCIpLFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5faW5wdXRfb3ZlclwiKSxcclxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2lucHV0X3ByZXNzXCIpLFxyXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2lucHV0XzAwXCIgKyAoaSsxKSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0XHRcdFx0YnV0dG9uLnggPSAtMTQ4ICsgeCAqIDk0O1xyXG5cdFx0XHRcdGJ1dHRvbi55ID0gLTYwICArIHkgKiA5ODtcclxuXHRcdFx0XHRidXR0b24uZGlnaXQgPSBpKzE7XHJcblx0XHRcdFx0YnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkRpZ2l0Q2xpY2ssIHRoaXMpO1xyXG5cdFx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guYWRkQ2hpbGQoYnV0dG9uKTtcclxuXHJcblx0XHRcdFx0dGhpcy5fY29kZVNjcmVlbi5fZGlnaXRCdXR0b25zLnB1c2goYnV0dG9uKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gQ2FuY2VsIGJ1dHRvblxyXG5cdFx0XHR0aGlzLl9kZWxldGVCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0XHRcdChcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9pbnB1dF9kZWxldGVfbm9ybWFsXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2lucHV0X2RlbGV0ZV9vdmVyXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2lucHV0X2RlbGV0ZV9wcmVzc1wiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25faW5wdXRfZGVsZXRlXCIpXHJcblx0XHRcdCk7XHJcblx0XHRcdHRoaXMuX2RlbGV0ZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0XHRcdHRoaXMuX2RlbGV0ZUJ1dHRvbi54ID0gdGhpcy5fY29kZVNjcmVlbi5fZGlnaXRCdXR0b25zWzJdLnggKyAodGhpcy5fY29kZVNjcmVlbi5fZGlnaXRCdXR0b25zWzJdLnggLSB0aGlzLl9jb2RlU2NyZWVuLl9kaWdpdEJ1dHRvbnNbMV0ueCk7XHJcblx0XHRcdHRoaXMuX2RlbGV0ZUJ1dHRvbi55ID0gdGhpcy5fY29kZVNjcmVlbi5fZGlnaXRCdXR0b25zWzJdLnk7XHJcblx0XHRcdHRoaXMuX2RlbGV0ZUJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25EZWxldGVDbGljaywgdGhpcyk7XHJcblx0XHRcdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guYWRkQ2hpbGQodGhpcy5fZGVsZXRlQnV0dG9uKTtcclxuXHJcblx0XHRcdC8vIEVudGVyIGJ1dHRvblxyXG5cdFx0XHR0aGlzLl9lbnRlckJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHRcdFx0KFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2lucHV0X2VudGVyX25vcm1hbFwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9pbnB1dF9lbnRlcl9vdmVyXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2lucHV0X2VudGVyX3ByZXNzXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9pbnB1dF9lbnRlclwiKVxyXG5cdFx0XHQpO1xyXG5cdFx0XHR0aGlzLl9lbnRlckJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0XHRcdHRoaXMuX2VudGVyQnV0dG9uLnggPSB0aGlzLl9jb2RlU2NyZWVuLl9kaWdpdEJ1dHRvbnNbNV0ueCArICh0aGlzLl9jb2RlU2NyZWVuLl9kaWdpdEJ1dHRvbnNbNV0ueCAtIHRoaXMuX2NvZGVTY3JlZW4uX2RpZ2l0QnV0dG9uc1s0XS54KTtcclxuXHRcdFx0dGhpcy5fZW50ZXJCdXR0b24ueSA9IHRoaXMuX2NvZGVTY3JlZW4uX2RpZ2l0QnV0dG9uc1s1XS55IC0gdGhpcy5fY29kZVNjcmVlbi5fZGlnaXRCdXR0b25zWzVdLmhlaWdodC8yICsgdGhpcy5fZW50ZXJCdXR0b24uaGVpZ2h0LzI7XHJcblx0XHRcdHRoaXMuX2VudGVyQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkVudGVyQ2xpY2ssIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmFkZENoaWxkKHRoaXMuX2VudGVyQnV0dG9uKTtcclxuXHJcblx0Ly8gUmV3YXJkIHNjcmVlblxyXG5cdHRoaXMuX3Jld2FyZFNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fcmV3YXJkU2NyZWVuKTtcclxuXHJcblx0XHQvLyBUaXRsZVxyXG5cdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3RpdGxlX2JnXCIpKTtcclxuXHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fdGl0bGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZS54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzI7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX3RpdGxlLnkgPSAxMDA7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uYWRkQ2hpbGQodGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZSk7XHJcblxyXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlJFV0FSRFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDJweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0XHR0aXRsZS54ID0gLXRpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHRcdHRpdGxlLnkgPSAtdGl0bGUudGV4dEhlaWdodC8yIC0gNDtcclxuXHRcdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHRcdHRpdGxlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHR0aXRsZS55ID0gLTY7XHJcblx0XHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3ggPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9iZ1wiKSk7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3guYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiwgQ29tbW9uLlNUQUdFX0hFSUdIVC8yICsgNzApO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gpO1xyXG5cclxuXHRcdFx0dmFyIGJnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfc25vd2ZsYWtlc19iZ1wiKSk7XHJcblx0XHRcdGJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0YmcucG9zaXRpb24uc2V0KDAsIC00MCk7XHJcblx0XHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5hZGRDaGlsZChiZyk7XHJcblxyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIj8/XCIsIHtmb250OiBcIjU2cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUueCA9IC0gdGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnZhbHVlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUueSA9IC0gdGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnZhbHVlLnRleHRIZWlnaHQvMiAtIDYyO1xyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnZhbHVlKTtcclxuXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiUkVXQVJEX01FU1NBR0VcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMzZweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS54ID0gLSB0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS55ID0gLSB0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0SGVpZ2h0LzIgKyAxNDA7XHJcblx0XHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlLnBvc2l0aW9uLnNldCgwLCAxNTApO1xyXG5cdFx0XHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0KFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X2Rvd25cIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfY3Jvc3NcIilcclxuXHRcdCk7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX2Nsb3NlQnV0dG9uLnggPSAocjJsID8gLTEgOiAxKSAqIDQwMDtcclxuXHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fY2xvc2VCdXR0b24ueSA9IC0yNDA7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX2Nsb3NlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMub25DbG9zZUNsaWNrLCB0aGlzKTtcclxuXHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveCAuYWRkQ2hpbGQodGhpcy5fcmV3YXJkU2NyZWVuLl9jbG9zZUJ1dHRvbik7XHJcblxyXG5cdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZS5zY2FsZS5zZXQoMCk7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3guc2NhbGUuc2V0KDApO1xyXG5cdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9jbG9zZUJ1dHRvbi5zY2FsZS5zZXQoMCk7XHJcblxyXG5cdC8vIEVycm9yIHNjcmVlblxyXG5cdHRoaXMuX2Vycm9yU2NyZWVuID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9lcnJvclNjcmVlbik7XHJcblxyXG5cdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3ggPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9iZ1wiKSk7XHJcblx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMik7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94KTtcclxuXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiU09SUllcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0XHRpZighd2ViZm9udClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0OHB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCA9IC0gdGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlLnkgPSAtIHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dEhlaWdodC8yIC0gMTYwO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiNDhweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UucG9zaXRpb24uc2V0KDAsIC0xNTApO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9yZWRlZW1fd2FybmluZ1wiKSk7XHJcblx0XHRcdGJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0YmcucG9zaXRpb24uc2V0KDAsIC0xNSk7XHJcblx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94LmFkZENoaWxkKGJnKTtcclxuXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiQ09ERV9XUk9OR1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjMycHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS54ID0gLSB0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UueSA9IC0gdGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0SGVpZ2h0LzIgKyAxNDA7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzMnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS5wb3NpdGlvbi5zZXQoMCwgMTUwKTtcclxuXHRcdFx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9jbG9zZUJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHRcdChcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X291dFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X2Nyb3NzXCIpXHJcblx0XHQpO1xyXG5cdFx0dGhpcy5fZXJyb3JTY3JlZW4uX2Nsb3NlQnV0dG9uLnggPSAocjJsID8gLTEgOiAxKSAqIDQwMDtcclxuXHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9jbG9zZUJ1dHRvbi55ID0gLTI0MDtcclxuXHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9jbG9zZUJ1dHRvbi5zaWduYWxzLmRvd24uYWRkT25jZSh0aGlzLm9uQ2xvc2VDbGljaywgdGhpcyk7XHJcblx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveCAuYWRkQ2hpbGQodGhpcy5fZXJyb3JTY3JlZW4uX2Nsb3NlQnV0dG9uKTtcclxuXHJcblx0XHR0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5zY2FsZS5zZXQoMCk7XHJcblx0XHR0aGlzLl9lcnJvclNjcmVlbi5fY2xvc2VCdXR0b24uc2NhbGUuc2V0KDApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5Db2RlT3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkNvZGVPdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuQ29kZU92ZXJsYXkucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbkNvZGVPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl9iZy5hbHBoYSA9IDA7XHJcblx0dGhpcy5fY29kZVNjcmVlbi5fdGl0bGUuc2NhbGUgICAgICAgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guc2NhbGUgICAgID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLl9jb2RlU2NyZWVuLl9jbG9zZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MC43NSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2NvZGVTY3JlZW4uX3RpdGxlLnNjYWxlLCAgICAgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guc2NhbGUsICAgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2NvZGVTY3JlZW4uX2Nsb3NlQnV0dG9uLnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuQ29kZU92ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUlufSwgIDApO1xyXG5cdFx0dGwudG8odGhpcy5fY29kZVNjcmVlbi5fdGl0bGUuc2NhbGUsICAgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LnNjYWxlLCAgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3Jld2FyZFNjcmVlbi5fdGl0bGUuc2NhbGUsICAgICAgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnNjYWxlLCAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9lcnJvclNjcmVlbi5fbWVzc2FnZUJveC5zY2FsZSwgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNvZGVPdmVybGF5LnByb3RvdHlwZS51cGRhdGVDb2RlID0gZnVuY3Rpb24oY29kZSlcclxue1xyXG5cdHRoaXMuX2NvZGUgPSBjb2RlO1xyXG5cclxuXHR0aGlzLl9jb2RlU2NyZWVuLl9jb2RlQm94LmNvZGUudGV4dCA9IHRoaXMuX2NvZGU7XHJcblx0dGhpcy5fY29kZVNjcmVlbi5fY29kZUJveC5jb2RlLnZhbGlkYXRlKCk7XHJcblx0dGhpcy5fY29kZVNjcmVlbi5fY29kZUJveC5jb2RlLnggPSAtIHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guY29kZS50ZXh0V2lkdGgvMjtcclxufVxyXG5cclxuQ29kZU92ZXJsYXkucHJvdG90eXBlLnNob3dSZXN1bHRzID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHR0bC50byh0aGlzLl9jb2RlU2NyZWVuLl90aXRsZS5zY2FsZSwgICAgICAgIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2NvZGVTY3JlZW4uX2NvZGVCb3guc2NhbGUsICAgICAgLjMsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xyXG5cclxuXHRcclxuXHRcclxuXHQvLyBWYWxpZCBjb2RlXHJcblx0aWYoQ29tbW9uLnNhdmVkRGF0YS5pc0NvZGVWYWxpZCh0aGlzLl9jb2RlKSAmJiAhQ29tbW9uLnNhdmVkRGF0YS5pc0NvZGVSZWRlZW1lZCh0aGlzLl9jb2RlKSlcclxuXHR7XHJcblx0XHR2YXIgcHJpemUgPSBDb21tb24uc2F2ZWREYXRhLmdldENvZGVWYWx1ZSh0aGlzLl9jb2RlKTtcclxuXHRcdENvbW1vbi5zYXZlZERhdGEuY29pbnMgKz0gcHJpemU7XHJcblx0XHRDb21tb24uc2F2ZWREYXRhLnNldENvZGVBc1VzZWQodGhpcy5fY29kZSk7XHJcblx0XHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxuXHRcdFxyXG5cdFx0Ly8gQ2hhbmdlIHZhbHVlc1x0XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUueCArPSB0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUudGV4dFdpZHRoLzI7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUudGV4dCA9IHByaXplLnRvU3RyaW5nKCk7XHJcblx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gudmFsdWUudmFsaWRhdGUoKTtcclxuXHRcdHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC52YWx1ZS54IC09IHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC52YWx1ZS50ZXh0V2lkdGgvMjtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCAgICs9IHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0ID0gdGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dC5yZXBsYWNlKFwie3ZhbHVlfVwiLCBwcml6ZS50b1N0cmluZygpKTtcclxuXHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudmFsaWRhdGUoKTtcclxuXHRcdFx0dGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCAgIC09IHRoaXMuX3Jld2FyZFNjcmVlbi5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRXaWR0aC8yO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9yZXdhcmRTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0ID0gdGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dC5yZXBsYWNlKFwie3ZhbHVlfVwiLCBwcml6ZS50b1N0cmluZygpKTtcclxuXHRcdH1cdFx0XHJcblx0XHRcclxuXHRcdC8vIEFuaW1hdGlvblxyXG5cdFx0dGwudG8odGhpcy5fcmV3YXJkU2NyZWVuLl90aXRsZS5zY2FsZSwgICAgICAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgLjMpO1xyXG5cdFx0dGwudG8odGhpcy5fcmV3YXJkU2NyZWVuLl9tZXNzYWdlQm94LnNjYWxlLCAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgLjMpO1xyXG5cdFx0dGwudG8odGhpcy5fcmV3YXJkU2NyZWVuLl9jbG9zZUJ1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgLjYgKyAuMyk7XHJcblx0fVxyXG5cdC8vIEludmFsaWQgY29kZVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHQvLyBBbHJlYWR5IHJlZGVlbWVkXHJcblx0XHRpZihDb21tb24uc2F2ZWREYXRhLmlzQ29kZVZhbGlkKHRoaXMuX2NvZGUpKVxyXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkNPREVfVVNFRFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdC8vIFdyb25nXHJcblx0XHRlbHNlXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiQ09ERV9XUk9OR1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdFxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dCA9IGNvcHk7XHJcblx0XHRcdHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudmFsaWRhdGUoKTtcclxuXHRcdFx0dGhpcy5fZXJyb3JTY3JlZW4uX21lc3NhZ2VCb3gubWVzc2FnZS54ID0gLXRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dFdpZHRoLzI7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHRsLnRvKHRoaXMuX2Vycm9yU2NyZWVuLl9tZXNzYWdlQm94LnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAuMyk7XHJcblx0XHR0bC50byh0aGlzLl9lcnJvclNjcmVlbi5fY2xvc2VCdXR0b24uc2NhbGUsICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIC42ICsgLjMpO1xyXG5cdH1cclxuXHRcclxuXHRcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcdFxyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkNvZGVPdmVybGF5LnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmFuaW1hdGVPdXQoZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwYXRjaCgpO1xyXG5cdH0sIHRoaXMpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuQ29kZU92ZXJsYXkucHJvdG90eXBlLm9uRGlnaXRDbGljayA9IGZ1bmN0aW9uKGUpXHJcbntcclxuXHRpZih0aGlzLl9jb2RlLmxlbmd0aCA+PSB0aGlzLl9tYXhMZW5ndGgpXHJcblx0e1xyXG5cdFx0U291bmRTRlgucGxheShcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV9mYWlsXzAwXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcblx0dGhpcy51cGRhdGVDb2RlKHRoaXMuX2NvZGUgKyBlLmRpZ2l0KTtcclxufVxyXG5cclxuQ29kZU92ZXJsYXkucHJvdG90eXBlLm9uRW50ZXJDbGljayA9IGZ1bmN0aW9uKGUpXHJcbntcclxuXHRpZih0aGlzLl9jb2RlID09IFwiXCIpXHJcblx0e1xyXG5cdFx0U291bmRTRlgucGxheShcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV9mYWlsXzAwXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcblx0dGhpcy5zaG93UmVzdWx0cygpO1xyXG59XHJcblxyXG5Db2RlT3ZlcmxheS5wcm90b3R5cGUub25EZWxldGVDbGljayA9IGZ1bmN0aW9uKGUpXHJcbntcclxuXHRpZih0aGlzLl9jb2RlID09IFwiXCIpXHJcblx0e1xyXG5cdFx0U291bmRTRlgucGxheShcInNmeF9lbHNhX2ljZV9tYWdpY19wbGF0Zm9ybV9mYWlsXzAwXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcblx0dGhpcy51cGRhdGVDb2RlKHRoaXMuX2NvZGUuc3Vic3RyKDAsIHRoaXMuX2NvZGUubGVuZ3RoLTEpKTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4iLCJ2YXIgQ29tbW9uICAgICAgICAgID0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiAgICA9IHJlcXVpcmUoXCIuLi9zY3JlZW5zL1NpbXBsZVNjcmVlblwiKTtcclxudmFyIFdpcmVmcmFtZUJ1dHRvbiA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcclxudmFyIFNvdW5kU0ZYICAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIEVuZEdhbWVPdmVybGF5KGNvbnRlbnQsIGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdHRoaXMuX2NvbnRlbnQgPSBjb250ZW50O1xyXG5cdHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XHJcblx0dGhpcy5fc2NvcGUgPSBzY29wZTtcclxuXHJcblx0dGhpcy5fY2xvc2VCdXR0b24gPSBudWxsO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFbmRHYW1lT3ZlcmxheTtcclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRW5kR2FtZU92ZXJsYXk7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKi9cclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0Ly8gQmFja2dyb3VuZFxyXG5cdHRoaXMuX2JnID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snd2hpdGVTcXVhcmUnXSk7XHJcblx0dGhpcy5fYmcuYWxwaGEgICA9IDAuNzU7XHJcblx0dGhpcy5fYmcud2lkdGggICA9IENvbW1vbi5TVEFHRV9XSURUSDtcclxuXHR0aGlzLl9iZy5oZWlnaHQgID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcclxuXHR0aGlzLl9iZy5oaXRBcmVhID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XHJcblx0dGhpcy5fYmcudGludCAgICA9IDB4MmMzYTY2O1xyXG5cdHRoaXMuX2JnLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2JnKTtcclxuXHJcblx0Ly8gVGl0bGVcclxuXHR0aGlzLl90aXRsZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3RpdGxlX2JnXCIpKTtcclxuXHR0aGlzLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0dGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdHRoaXMuX3RpdGxlLnkgPSAxMDA7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl90aXRsZSk7XHJcblxyXG5cdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJXRUxMX0RPTkVcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjQycHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdHRpdGxlLnggPSAtdGl0bGUudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRpdGxlLnkgPSAtdGl0bGUudGV4dEhlaWdodC8yIC0gNDtcclxuXHRcdFx0dGhpcy5fdGl0bGUuYWRkQ2hpbGQodGl0bGUpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHR0aXRsZS5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XHJcblx0XHRcdHRpdGxlLnkgPSAtNjtcclxuXHRcdFx0dGhpcy5fdGl0bGUuYWRkQ2hpbGQodGl0bGUpO1xyXG5cdFx0fVxyXG5cclxuXHQvLyBQYW5lbCBiYWNrZ3JvdW5kXHJcblx0dGhpcy5fbWVzc2FnZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3BvcHVwX2JnXCIpKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiwgQ29tbW9uLlNUQUdFX0hFSUdIVC8yICsgNzApO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCk7XHJcblxyXG5cdFx0dmFyIGJnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaW1hZ2VfcGFiYmllX2ZvdW5kXCIpKTtcclxuXHRcdGJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdGJnLnBvc2l0aW9uLnNldCgwLCAtODApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZChiZyk7XHJcblxyXG5cdFx0Ly8gV2hhdCBtZXNzYWdlP1xyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93KVxyXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkVOREdBTUVfQ1JZU1RBTFNcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHRlbHNlIGlmKENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UudHJvbGxzLnNob3cpXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5ER0FNRV9UUk9MTFNcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHRlbHNlXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5ER0FNRV9MRVZFTFNcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjMycHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLm1heFdpZHRoID0gNjIwO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudXBkYXRlVGV4dCgpO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCA9IC10aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS55ID0gLXRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0SGVpZ2h0LzIgKyAxMzA7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjMycHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NzAwfSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS5wb3NpdGlvbi5zZXQoMCwgMTMwKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UpO1xyXG5cdFx0fVxyXG5cclxuXHR0aGlzLl9jbG9zZUJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfY3Jvc3NcIilcclxuXHQpO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi54ID0gcjJsID8gLTQwMCA6IDQwMDtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi55ID0gLTI0MDtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi5zaWduYWxzLmRvd24uYWRkT25jZSh0aGlzLm9uQ2xvc2UsIHRoaXMpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3ggLmFkZENoaWxkKHRoaXMuX2Nsb3NlQnV0dG9uKTtcclxuXHJcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZS5zZXQoMCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2NhbGUuc2V0KDApO1xyXG5cclxuXHQvLyBEb24ndCBzaG93IGFnYWluXHJcblx0Q29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5sZXZlbHMuc2hvd24gICA9IENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UubGV2ZWxzLnNob3c7XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93biA9IENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UuY3J5c3RhbHMuc2hvdztcclxuXHRDb21tb24uc2F2ZWREYXRhLmVuZEdhbWVNZXNzYWdlLnRyb2xscy5zaG93biAgID0gQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS50cm9sbHMuc2hvdztcclxuXHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5FbmRHYW1lT3ZlcmxheS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkVuZEdhbWVPdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5FbmRHYW1lT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fdGl0bGUuc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHJcblx0dGhpcy5fYmcuYWxwaGEgPSAwO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xyXG5cdFx0dGwudG8odGhpcy5fYmcsICAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MC43NSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9jbG9zZUJ1dHRvbi5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sICAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuRW5kR2FtZU92ZXJsYXkucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmFuaW1hdGVPdXQoZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwYXRjaCgpO1xyXG5cdH0sIHRoaXMpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgXHRcdD0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiBcdFx0PSByZXF1aXJlKFwiLi4vc2NyZWVucy9TaW1wbGVTY3JlZW5cIik7XHJcbnZhciBXaXJlZnJhbWVCdXR0b24gXHQ9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcclxudmFyIFNvdW5kU0ZYICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBFbmRsZXNzT3ZlcmxheShpc0xvY2tlZClcclxue1xyXG5cdHRoaXMuX2lzTG9ja2VkID0gaXNMb2NrZWQ7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IG51bGw7XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEVuZGxlc3NPdmVybGF5O1xyXG5FbmRsZXNzT3ZlcmxheS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5FbmRsZXNzT3ZlcmxheS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBFbmRsZXNzT3ZlcmxheTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5FbmRsZXNzT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xyXG5cdHRoaXMuX2JnLmFscGhhICAgICAgID0gMC43NTtcclxuXHR0aGlzLl9iZy53aWR0aCAgICAgICA9IENvbW1vbi5TVEFHRV9XSURUSDtcclxuXHR0aGlzLl9iZy5oZWlnaHQgICAgICA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XHJcblx0dGhpcy5fYmcuaGl0QXJlYSAgICAgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuXHR0aGlzLl9iZy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9iZyk7XHJcblxyXG5cclxuXHR0aGlzLl90aXRsZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3RpdGxlX2JnXCIpKTtcclxuXHR0aGlzLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0dGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdHRoaXMuX3RpdGxlLnkgPSAxMDA7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl90aXRsZSk7XHJcblxyXG5cdFx0aWYodGhpcy5faXNMb2NrZWQpXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiTE9DS0VEXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlVOTE9DS0VEXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aXRsZS54ID0gLXRpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aXRsZS55ID0gLXRpdGxlLnRleHRIZWlnaHQvMiAtIDQ7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjM2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuXHRcdFx0dGl0bGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aXRsZS55ID0gLTY7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHJcbiAgICB0aGlzLl9tZXNzYWdlQm94ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfYmdcIikpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guYW5jaG9yLnNldCgwLjUpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3gueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3gueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIDcwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94KTtcclxuXHJcblx0XHR2YXIgZGVjbyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fZGVjb1wiKSk7XHJcblx0XHRkZWNvLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdGRlY28ucG9zaXRpb24uc2V0KC0xNjAsIC0xMzApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZChkZWNvKTtcclxuXHJcblx0XHR2YXIgbG9jayA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbG9ja1wiKSk7XHJcblx0XHRsb2NrLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdGxvY2sucG9zaXRpb24gPSBkZWNvLnBvc2l0aW9uO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZChsb2NrKTtcclxuXHJcblx0XHRpZih0aGlzLl9pc0xvY2tlZClcclxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJMT0NLRURcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHRlbHNlXHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5ETEVTU1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0ZXh0LnggPSAtMTYwIC10ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0ZXh0LnkgPSAtMTAgLXRleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0ZXh0LnBvc2l0aW9uLnNldCgtMTYwLCAtMTApO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMuX2lzTG9ja2VkKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgbGV2ZWxSZXF1aXJlZCA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLmVuZGxlc3MubGV2ZWxSZXF1aXJlZDtcclxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJFTkRMRVNTX0xPQ0tFRFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdFx0Y29weSA9IGNvcHkucmVwbGFjZShcInt2YWx1ZX1cIiwgbGV2ZWxSZXF1aXJlZCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5ETEVTU19VTkxPQ0tFRFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIyNHB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCIsIHRpbnQ6IDB4NmQzOGFifSk7XHJcblx0XHRcdHRleHQueCA9IC0xNjAgLXRleHQudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRleHQueSA9ICs4MCAtdGV4dC50ZXh0SGVpZ2h0LzI7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGV4dCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6MjcwfSk7XHJcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0ZXh0LnBvc2l0aW9uLnNldCgtMTYwLCA4MCk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGV4dCk7XHJcblx0XHR9XHJcblxyXG5cclxuXHQvLyB0aGlzLl9jaGFyYWN0ZXIgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9jaGFyX29sYWZcIikpO1xyXG5cdC8vIHRoaXMuX2NoYXJhY3Rlci5hbmNob3Iuc2V0KDAuNSwgMSk7XHJcblx0Ly8gdGhpcy5fY2hhcmFjdGVyLnggPSAxNzA7XHJcblx0Ly8gdGhpcy5fY2hhcmFjdGVyLnkgPSB0aGlzLl9tZXNzYWdlQm94LmhlaWdodC8yICsgMzU7XHJcbiAgICAvLyB0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2NoYXJhY3Rlcik7XHJcblxyXG5cdHRoaXMuX2NoYXIgPSBuZXcgUElYSS5zcGluZS5TcGluZShDb21tb24uY2hhcmFjdGVyQW5pbWF0aW9uRGF0YVtcIm9sYWZcIl0pO1xyXG5cdHRoaXMuX2NoYXIuc2tlbGV0b24uc2V0VG9TZXR1cFBvc2UoKTtcclxuXHR0aGlzLl9jaGFyLnNrZWxldG9uLnNldFNraW4obnVsbCk7XHJcblx0dGhpcy5fY2hhci5za2VsZXRvbi5zZXRTa2luQnlOYW1lKFwiZGVmYXVsdFwiKTtcclxuXHR0aGlzLl9jaGFyLnggPSAxNzA7XHJcblx0dGhpcy5fY2hhci55ID0gdGhpcy5fbWVzc2FnZUJveC5oZWlnaHQvMiArIDM1O1xyXG5cdHRoaXMuX2NoYXIuYXV0b1VwZGF0ZSA9IHRydWU7XHJcblx0dGhpcy5fY2hhci5zY2FsZS5zZXQoMC41KTtcclxuXHR0aGlzLl9jaGFyLnN0YXRlLnNldEFuaW1hdGlvbkJ5TmFtZSgwLCBcImxvb2tfbGVmdFwiLCB0cnVlLCAwKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2NoYXIpO1xyXG5cclxuXHR0aGlzLl9jbG9zZUJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfY3Jvc3NcIilcclxuXHQpO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi54ID0gcjJsID8gLTQwMCA6IDQwMDtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnkgPSAtMjQwO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMub25DbG9zZUNsaWNrLCB0aGlzKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Nsb3NlQnV0dG9uKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuRW5kbGVzc092ZXJsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5FbmRsZXNzT3ZlcmxheS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkVuZGxlc3NPdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5FbmRsZXNzT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fYmcuYWxwaGEgPSAwO1xyXG5cdHRoaXMuX3RpdGxlLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MC43NSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuRW5kbGVzc092ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sICAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuRW5kbGVzc092ZXJsYXkucHJvdG90eXBlLm9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuYW5pbWF0ZU91dChmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmRpc3BhdGNoKCk7XHJcblx0fSwgdGhpcyk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgXHRcdD0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiBcdFx0PSByZXF1aXJlKFwiLi4vc2NyZWVucy9TaW1wbGVTY3JlZW5cIik7XHJcbnZhciBXaXJlZnJhbWVCdXR0b24gXHQ9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcclxudmFyIFNvdW5kU0ZYICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBFeGl0T3ZlcmxheShsaW5rLCBpc0Rpc25leVNpdGUpXHJcbntcclxuXHR0aGlzLl9saW5rICAgICAgICAgPSBsaW5rO1xyXG4gICAgdGhpcy5faXNEaXNuZXlTaXRlID0gaXNEaXNuZXlTaXRlO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFeGl0T3ZlcmxheTtcclxuRXhpdE92ZXJsYXkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuRXhpdE92ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRXhpdE92ZXJsYXk7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKi9cclxuRXhpdE92ZXJsYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fYm94Q29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9ib3hDb250YWluZXIpO1xyXG5cclxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xyXG5cdHRoaXMuX2JnLmFscGhhICAgICAgID0gMC43NTtcclxuXHR0aGlzLl9iZy53aWR0aCAgICAgICA9IENvbW1vbi5TVEFHRV9XSURUSDtcclxuXHR0aGlzLl9iZy5oZWlnaHQgICAgICA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XHJcblx0dGhpcy5fYmcuaGl0QXJlYSAgICAgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuXHR0aGlzLl9iZy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JnKTtcclxuXHJcblx0dGhpcy5fYm9yZGVyID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snd2hpdGVTcXVhcmUnXSk7XHJcblx0dGhpcy5fYm9yZGVyLnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiwgQ29tbW9uLlNUQUdFX0hFSUdIVC8yKTtcclxuXHR0aGlzLl9ib3JkZXIuYW5jaG9yLnNldCgwLjUpXHJcblx0dGhpcy5fYm9yZGVyLndpZHRoICA9IDYwMjtcclxuXHR0aGlzLl9ib3JkZXIuaGVpZ2h0ID0gMjYyO1xyXG5cdHRoaXMuX2JvcmRlci50aW50ID0gMHg5OTk5OTk7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JvcmRlcik7XHJcblxyXG5cdHRoaXMuX2JveCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xyXG5cdHRoaXMuX2JveC5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMik7XHJcblx0dGhpcy5fYm94LmFuY2hvci5zZXQoMC41KVxyXG5cdHRoaXMuX2JveC53aWR0aCA9IHRoaXMuX2JvcmRlci53aWR0aC0yO1xyXG5cdHRoaXMuX2JveC5oZWlnaHQgPSB0aGlzLl9ib3JkZXIuaGVpZ2h0LTI7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JveCk7XHJcblxyXG5cdHRoaXMuX2lubmVyQm94ID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snd2hpdGVTcXVhcmUnXSk7XHJcblx0dGhpcy5faW5uZXJCb3gucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yLCBDb21tb24uU1RBR0VfSEVJR0hULzIpO1xyXG5cdHRoaXMuX2lubmVyQm94LmFuY2hvci5zZXQoMC41KVxyXG5cdHRoaXMuX2lubmVyQm94LndpZHRoICA9IHRoaXMuX2JveC53aWR0aC0yMDtcclxuXHR0aGlzLl9pbm5lckJveC5oZWlnaHQgPSB0aGlzLl9ib3guaGVpZ2h0LTIwO1xyXG5cdHRoaXMuX2JveENvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9pbm5lckJveCk7XHJcblxyXG5cdC8vIFRleHRcclxuXHRpZih0aGlzLl9pc0Rpc25leVNpdGUpXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkVYSVRfRElTTkVZXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdGVsc2VcclxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRVhJVF9OT1RfRElTTkVZXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCJib2xkIDE2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2xlZnQnLCB3b3JkV3JhcDp0cnVlLCB3b3JkV3JhcFdpZHRoOnRoaXMuX2JveC53aWR0aC0xMDB9KTtcclxuXHR0ZXh0LnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiAtIHRoaXMuX2lubmVyQm94LndpZHRoLzIgKyAyMCwgQ29tbW9uLlNUQUdFX0hFSUdIVC8yIC0gdGhpcy5faW5uZXJCb3guaGVpZ2h0LzIgKyAyMClcclxuXHR0aGlzLl9ib3hDb250YWluZXIuYWRkQ2hpbGQodGV4dCk7XHJcblxyXG5cdGlmKCF0aGlzLl9pc0Rpc25leVNpdGUpXHJcblx0e1xyXG5cdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJFWElUX05PVF9ESVNORVlfREVTQ1JJUFRJT05cIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblxyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMTNweCBBcmlhbFwiLCBmaWxsOjB4NTU1NTU1LCBhbGlnbjonbGVmdCcsIGxpbmVIZWlnaHQ6IDIwLCB3b3JkV3JhcDp0cnVlLCB3b3JkV3JhcFdpZHRoOnRoaXMuX2JveC53aWR0aC0xMDB9KTtcclxuXHRcdHRleHQucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yIC0gdGhpcy5faW5uZXJCb3gud2lkdGgvMiArIDIwLCBDb21tb24uU1RBR0VfSEVJR0hULzIgLSB0aGlzLl9pbm5lckJveC5oZWlnaHQvMiArIDUwKVxyXG5cdFx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRleHQpO1xyXG5cdH1cclxuXHJcblx0Ly8gQnV0dG9uc1xyXG5cdHRoaXMuX2JhY2tCdXR0b24gPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fZXhpdF93aGl0ZVwiKSk7XHJcblx0dGhpcy5fYmFja0J1dHRvbi5hbmNob3Iuc2V0KDAsMSk7XHJcblx0dGhpcy5fYmFja0J1dHRvbi5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIgLSB0aGlzLl9pbm5lckJveC53aWR0aC8yICsgMjAsIENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIHRoaXMuX2lubmVyQm94LmhlaWdodC8yIC0gMjApO1xyXG5cdHRoaXMuX2JhY2tCdXR0b24uaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuX2JhY2tCdXR0b24udG91Y2hzdGFydCA9IHRoaXMuX2JhY2tCdXR0b24ubW91c2Vkb3duID0gZnVuY3Rpb24oZSl7dGhpcy5vbkNsb3NlQ2xpY2soZSl9LmJpbmQodGhpcyk7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JhY2tCdXR0b24pO1xyXG5cclxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRVhJVF9OT1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjE0cHggQXJpYWxcIiwgZmlsbDoweDJhOWJmZSwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6dGhpcy5fYm94LndpZHRoLTEwMH0pO1xyXG5cdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0ZXh0LnBvc2l0aW9uLnNldCh0aGlzLl9iYWNrQnV0dG9uLndpZHRoLzIsIC10aGlzLl9iYWNrQnV0dG9uLmhlaWdodC8yKVxyXG5cdFx0dGhpcy5fYmFja0J1dHRvbi5hZGRDaGlsZCh0ZXh0KTtcclxuXHJcblx0dGhpcy5fbGlua0J1dHRvbiA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9leGl0X2JsdWVcIikpO1xyXG5cdHRoaXMuX2xpbmtCdXR0b24uYW5jaG9yLnNldCgwLDEpO1xyXG5cdHRoaXMuX2xpbmtCdXR0b24ucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yIC0gdGhpcy5faW5uZXJCb3gud2lkdGgvMiArIDIwICsgdGhpcy5fYmFja0J1dHRvbi53aWR0aCArIDEwLCBDb21tb24uU1RBR0VfSEVJR0hULzIgKyB0aGlzLl9pbm5lckJveC5oZWlnaHQvMiAtIDIwKTtcclxuXHR0aGlzLl9saW5rQnV0dG9uLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuXHR0aGlzLl9saW5rQnV0dG9uLnRvdWNoc3RhcnQgPSB0aGlzLl9saW5rQnV0dG9uLm1vdXNlZG93biA9IGZ1bmN0aW9uKGUpe3RoaXMub25MaW5rQ2xpY2soZSl9LmJpbmQodGhpcyk7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2xpbmtCdXR0b24pO1xyXG5cclxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRVhJVF9ZRVNcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIxNHB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInLCB3b3JkV3JhcDp0cnVlLCB3b3JkV3JhcFdpZHRoOnRoaXMuX2JveC53aWR0aC0xMDB9KTtcclxuXHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0dGV4dC5wb3NpdGlvbi5zZXQodGhpcy5fbGlua0J1dHRvbi53aWR0aC8yLCAtdGhpcy5fbGlua0J1dHRvbi5oZWlnaHQvMilcclxuXHRcdHRoaXMuX2xpbmtCdXR0b24uYWRkQ2hpbGQodGV4dCk7XHJcblxyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5FeGl0T3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkV4aXRPdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuRXhpdE92ZXJsYXkucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbkV4aXRPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xyXG5cclxuXHQvLyB0aGlzLl9iZy5hbHBoYSA9IDA7XHJcblx0dGhpcy5fYm94Q29udGFpbmVyLmFscGhhID0gMDtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdC8vIHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLjc1LCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fYm94Q29udGFpbmVyLCAgICAgICAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlT3V0fSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG5FeGl0T3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dC5jYWxsKHRoaXMpO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xyXG5cdFx0Ly8gdGwudG8odGhpcy5fYmcsICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUlufSwgIDApO1xyXG5cdFx0dGwudG8odGhpcy5fYm94Q29udGFpbmVyLCAgICAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuRXhpdE92ZXJsYXkucHJvdG90eXBlLm9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuYW5pbWF0ZU91dChmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmRpc3BhdGNoKCk7XHJcblx0fSwgdGhpcyk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG5FeGl0T3ZlcmxheS5wcm90b3R5cGUub25MaW5rQ2xpY2sgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZiAoIXAzLkRldmljZS5pc0lmcmFtZSlcclxuXHR7XHJcblx0XHR2YXIgd2luID0gd2luZG93Lm9wZW4odGhpcy5fbGluaywgJ19ibGFuaycpO1xyXG5cdFx0d2luLmZvY3VzKCk7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHRjb25zb2xlLmdyb3VwKFwiT3BlbmluZyBcIiArIHRoaXMuX2xpbmspO1xyXG5cdFx0dHJ5XHJcblx0XHR7XHJcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIlRyeW5nIHRvIG9wZW4gdGhlIHBhZ2Ugbm9ybWFsbHkuXCIpO1xyXG5cdFx0XHQvLyB2YXIgd2luID0gd2luZG93LnBhcmVudC5vcGVuKHRoaXMuX2xpbmssICdfYmxhbmsnKTtcclxuXHRcdFx0Ly8gd2luLmZvY3VzKCk7XHJcblx0XHRcdHdpbmRvdy5vcGVuKHRoaXMuX2xpbmssICdfYmxhbmsnKTtcclxuXHRcdH1cclxuXHRcdGNhdGNoKGUpXHJcblx0XHR7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcIkNvdWxkbid0IG9wZW4gdGhlIHBhZ2UgYXMgaXQncyBub3Qgb24gdGhlIHNhbWUgZG9tYWluLlwiKTtcclxuXHRcdFx0Ly8gY29uc29sZS5pbmZvKFwiVHJ5bmcgdG8gb3BlbiB0aGUgcGFnZSB0aHJvdWdoICdwb3N0TWVzc2FnZScuXCIpO1xyXG5cdFx0XHQvLyB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHRoaXMuX2xpbmssICcqJyk7XHJcblx0XHR9XHJcblx0XHRjb25zb2xlLmdyb3VwRW5kKFwiT3BlbmluZyBcIiArIHRoaXMuX2xpbmspO1xyXG5cdH1cclxuXHJcblx0dGhpcy5hbmltYXRlT3V0KGZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcclxuXHR9LCB0aGlzKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn1cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xudmFyIFNpbXBsZVNjcmVlbiA9IHJlcXVpcmUoXCIuLi9zY3JlZW5zL1NpbXBsZVNjcmVlblwiKTtcbnZhciBOZXh0QnV0dG9uICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9OZXh0QnV0dG9uXCIpO1xudmFyIFNvdW5kU0ZYICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xudmFyIE11dGVCdXR0b24gICA9IHJlcXVpcmUoXCIuLi9saWIvTXV0ZUJ1dHRvblwiKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUUlVDVE9SXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBHYW1lT3Zlck92ZXJsYXkobGV2ZWwpXG57XG5cdHRoaXMubGV2ZWwgPSBsZXZlbDtcblxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcblxuXHR0aGlzLmhhbmRsZUFjdGl2ZSA9IGZhbHNlO1xuXHR0aGlzLmhhbmRsZU1pblkgICA9IC0gMTgwO1xuXHR0aGlzLmhhbmRsZU1heFkgICA9ICsgMjAwO1xuXHR0aGlzLmhhbmRsZVkgICAgICA9IHRoaXMuaGFuZGxlTWluWTtcblx0dGhpcy5oYW5kbGVTRlggPSBudWxsO1xuXHR0aGlzLmhhbmRsZVNGWENvdW50ZG93biA9IDA7XG5cblx0dGhpcy5fY2hhcmFjdGVyRGF0YSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLmNoYXJhY3RlcnNbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJdO1xuXG5cdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRDdXJyZW50U2NyZWVuID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG59XG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVPdmVyT3ZlcmxheTtcbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdhbWVPdmVyT3ZlcmxheTtcblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdGNvbnNvbGUubG9nKFwiUEFVU0UgSU5JVElBTElaRURcIik7XG5cblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XG5cblx0Ly8gQmdcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9iZ19tYWluX21lbnVcIikpO1xuXHR0aGlzLl9iZy5hbHBoYSAgICAgICA9IDE7XG5cdHRoaXMuX2JnLndpZHRoICAgICAgID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xuXHR0aGlzLl9iZy5oZWlnaHQgICAgICA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuX2JnLmhpdEFyZWEgICAgID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XG5cdHRoaXMuX2JnLmludGVyYWN0aXZlID0gdHJ1ZTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9iZyk7XG5cblx0Ly8gR09BTFMgU0NSRUVOXG5cdHRoaXMuX2dvYWxzU2NyZWVuID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fZ29hbHNTY3JlZW4pO1xuXG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX3RpdGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdGl0bGVfYmdcIikpO1xuXHRcdHRoaXMuX2dvYWxzU2NyZWVuLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX3RpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcblx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fdGl0bGUueSA9IDEwMDtcblx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5hZGRDaGlsZCh0aGlzLl9nb2Fsc1NjcmVlbi5fdGl0bGUpO1xuXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkdPQUxTXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0XHRpZighd2ViZm9udClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNTBweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcblx0XHRcdFx0dGl0bGUueSA9IC10aXRsZS50ZXh0SGVpZ2h0LzIgLSA0O1xuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fdGl0bGUuYWRkQ2hpbGQodGl0bGUpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0XHR0aXRsZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdHRpdGxlLnkgPSAtNjtcblx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNDb250YWluZXIucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yIC0gMTAsIENvbW1vbi5TVEFHRV9IRUlHSFQvMiAtIDE0MCk7XG5cdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5hZGRDaGlsZCh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNDb250YWluZXIpO1xuXG5cdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHMgPSBbXTtcblxuXHRcdFx0XHR2YXIgYWN0aXZlR29hbHMgPSBDb21tb24uZ29hbHNNYW5hZ2VyLmdldEFjdGl2ZUdvYWxzKCk7XG5cblx0XHRcdFx0Zm9yKHZhciBhY3RpdmUgPSAxOyBhY3RpdmUgPj0gMDsgYWN0aXZlLS0pXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgQ29tbW9uLmdvYWxzTWFuYWdlci5nb2Fscy5sZW5ndGg7IGkrKylcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHR2YXIgaWQgPSBDb21tb24uZ29hbHNNYW5hZ2VyLmdvYWxzW2ldLmlkO1xuXHRcdFx0XHRcdFx0dmFyIGdvYWxTdGF0dXMgPSBDb21tb24uZ29hbHNNYW5hZ2VyLmdldEdvYWxTdGF0dXMoaWQpO1xuXG5cdFx0XHRcdFx0XHQvLyBTaG93IHRoZSBhY3RpdmUgZ29hbHMgZmlyc3QsIHRoZW4gdGhlIHJlc3Rcblx0XHRcdFx0XHRcdHZhciBrZWVwID0gKGFjdGl2ZSA9PSAwKTtcblxuXHRcdFx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGFjdGl2ZUdvYWxzLmxlbmd0aDsgaisrKVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRpZihhY3RpdmVHb2Fsc1tqXS5pZCA9PSBpZClcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdGtlZXAgPSAha2VlcDtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZigha2VlcCkgY29udGludWU7XG5cblxuXHRcdFx0XHRcdFx0dmFyIGdvYWwgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19cIiArICgoaSU0KSsxKSkpO1xuXHRcdFx0XHRcdFx0Z29hbC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRnb2FsLnkgPSBpICogMTAwO1xuXHRcdFx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzQ29udGFpbmVyLmFkZENoaWxkKGdvYWwpO1xuXHRcdFx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzLnB1c2goZ29hbCk7XG5cblx0XHRcdFx0XHRcdHZhciBpY29uID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKENvbW1vbi5nb2Fsc01hbmFnZXIuZ29hbHNbaV0uaWNvbikpO1xuXHRcdFx0XHRcdFx0aWNvbi5hbmNob3Iuc2V0KDAsIDAuNSk7XG5cdFx0XHRcdFx0XHRpY29uLnggPSAtIDM2MDtcblx0XHRcdFx0XHRcdGdvYWwuYWRkQ2hpbGQoaWNvbik7XG5cblx0XHRcdFx0XHRcdGlmKCF3ZWJmb250KVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KENvbW1vbi5nb2Fsc01hbmFnZXIuZ29hbHNbaV0ubGFiZWwsIHtmb250OiBcIjI4cHggTWlrYWRhbiBUaXRsZVwiLCBhbGlnbjogXCJsZWZ0XCJ9KTtcblx0XHRcdFx0XHRcdFx0dGV4dC5tYXhXaWR0aCA9IDQwMDtcblx0XHRcdFx0XHRcdFx0dGV4dC51cGRhdGVUZXh0KCk7XG5cdFx0XHRcdFx0XHRcdHRleHQueCA9IC0xODA7XG5cdFx0XHRcdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMjtcblx0XHRcdFx0XHRcdFx0Z29hbC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KENvbW1vbi5nb2Fsc01hbmFnZXIuZ29hbHNbaV0ubGFiZWwsIHtmb250OlwiMjhweCBBcmlhbFwiLCBmaWxsOjB4RkZGRkZGLCBhbGlnbjoocjJsID8gJ3JpZ2h0JyA6ICdsZWZ0JyksIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NDAwfSk7XG5cdFx0XHRcdFx0XHRcdHRleHQueCA9IHIybCA/IDIyMCA6IC0xODA7XG5cdFx0XHRcdFx0XHRcdHRleHQuYW5jaG9yLnNldChyMmwgPyAxIDogMCwgMC41KTtcblx0XHRcdFx0XHRcdFx0Z29hbC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdFx0XHRcdFx0XHRwcm9ncmVzcy54ID0gMzAwXG5cdFx0XHRcdFx0XHRnb2FsLmFkZENoaWxkKHByb2dyZXNzKTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgaWQgPSBDb21tb24uZ29hbHNNYW5hZ2VyLmdvYWxzW2ldLmlkO1xuXHRcdFx0XHRcdFx0XHR2YXIgZ29hbFN0YXR1cyA9IENvbW1vbi5nb2Fsc01hbmFnZXIuZ2V0R29hbFN0YXR1cyhpZCk7XG5cblx0XHRcdFx0XHRcdFx0aWYoZ29hbFN0YXR1cyA9PSAxKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19jb21wbGV0ZVwiKSk7XG5cdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3NCZy5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCZyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19iYXJcIikpO1xuXHRcdFx0XHRcdFx0XHRcdHByb2dyZXNzQmcuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHRcdFx0XHRcdHByb2dyZXNzLmFkZENoaWxkKHByb2dyZXNzQmcpO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYoZ29hbFN0YXR1cyA+IDApXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzQmFyID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfZ29hbHNfZmlsbFwiKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzc0Jhci5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzcy5hZGRDaGlsZChwcm9ncmVzc0Jhcik7XG5cblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYW52YXMud2lkdGggID0gMTI4O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYW52YXMuaGVpZ2h0ID0gMTI4O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdHgubW92ZVRvKGNhbnZhcy53aWR0aC8yLCBjYW52YXMuaGVpZ2h0LzIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdHguYXJjKGNhbnZhcy53aWR0aC8yLCBjYW52YXMuaGVpZ2h0LzIsIGNhbnZhcy53aWR0aC8yLCAtTWF0aC5QSS8yLCAyKk1hdGguUEkqZ29hbFN0YXR1cy1NYXRoLlBJLzIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdHgubGluZVRvKGNhbnZhcy53aWR0aC8yLCBjYW52YXMuaGVpZ2h0LzIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gJ3doaXRlJztcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3R4LmZpbGwoKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgbWFzayA9IG5ldyBQSVhJLlNwcml0ZShQSVhJLlRleHR1cmUuZnJvbUNhbnZhcyhjYW52YXMpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bWFzay5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHByb2dyZXNzQmFyLmFkZENoaWxkKG1hc2spO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzc0Jhci5tYXNrID0gbWFzaztcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBzbm93ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc25vd190b3BcIikpO1xuXHRcdFx0XHRzbm93LmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHRcdFx0c25vdy55ID0gLTE1O1xuXHRcdFx0XHRzbm93LndpZHRoID0gdGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzWzBdLndpZHRoKyAyMDtcblx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzWzBdLmFkZENoaWxkKHNub3cpO1xuXG5cdFx0XHRcdC8vIE1hc2tcblx0XHRcdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRcdFx0XHRjYW52YXMud2lkdGggID0gMjtcblx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IDUxMjtcblx0XHRcdFx0dmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cblx0XHRcdFx0dmFyIGdyYWRpZW50ID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsMCwwLGNhbnZhcy5oZWlnaHQpO1xuXHRcdFx0XHRncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgXCJyZ2JhKDI1NSwyNTUsMjU1LDApXCIpO1xuXHRcdFx0XHRncmFkaWVudC5hZGRDb2xvclN0b3AoMC4wNSwgXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCIpO1xuXHRcdFx0XHRncmFkaWVudC5hZGRDb2xvclN0b3AoMC45MywgXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCIpO1xuXHRcdFx0XHRncmFkaWVudC5hZGRDb2xvclN0b3AoMSwgXCJyZ2JhKDI1NSwyNTUsMjU1LDApXCIpO1xuXG5cdFx0XHRcdGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDtcblx0XHRcdFx0Y3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cblx0XHRcdFx0dmFyIG1hc2sgPSBuZXcgUElYSS5TcHJpdGUoUElYSS5UZXh0dXJlLmZyb21DYW52YXMoY2FudmFzKSk7XG5cdFx0XHRcdG1hc2suYW5jaG9yLnNldCgwLjUsIDApO1xuXHRcdFx0XHRtYXNrLnBvc2l0aW9uLnkgLT0gODU7XG5cdFx0XHRcdG1hc2sud2lkdGggPSA4MDA7XG5cdFx0XHRcdG1hc2suaGVpZ2h0ID0gNTUwO1xuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNDb250YWluZXIuYWRkQ2hpbGQobWFzayk7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc0NvbnRhaW5lci5tYXNrID0gbWFzaztcblxuXHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9zY3JvbGxfcm9wZV9iZ1wiKSk7XG5cdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIgKyA0MDAsIENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIDYwKTtcblx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLmFkZENoaWxkKHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyKTtcblxuXHRcdFx0XHR2YXIgdGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc2Nyb2xsX3JvcGVfdGlsZVwiKTtcblx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuX3JvcGUgPSBuZXcgUElYSS5leHRyYXMuVGlsaW5nU3ByaXRlKHRleHR1cmUsIHRleHR1cmUud2lkdGgsIHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLmhlaWdodCAtIDEwKTtcblx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuX3JvcGUuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5hZGRDaGlsZCh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5fcm9wZSk7XG5cblx0XHRcdFx0dmFyIGNhcCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3Njcm9sbF9yb3BlX3RvcFwiKSk7XG5cdFx0XHRcdGNhcC5hbmNob3Iuc2V0KDAuNSwgMSk7XG5cdFx0XHRcdGNhcC55ID0gLXRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9yb3BlLmhlaWdodC8yICsgMjU7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9yb3BlLmFkZENoaWxkKGNhcCk7XG5cblx0XHRcdFx0dmFyIGNhcCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3Njcm9sbF9yb3BlX2JvdHRvbVwiKSk7XG5cdFx0XHRcdGNhcC5hbmNob3Iuc2V0KDAuNSwgMCk7XG5cdFx0XHRcdGNhcC55ID0gdGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuX3JvcGUuaGVpZ2h0LzIgLSAyMjtcblx0XHRcdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuX3JvcGUuYWRkQ2hpbGQoY2FwKTtcblxuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc2Nyb2xsX2hhbmRsZVwiKSk7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUuYW5jaG9yICAgICAgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUueSAgICAgICAgICAgPSB0aGlzLmhhbmRsZU1pblk7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUueVJlYWwgICAgICAgPSB0aGlzLmhhbmRsZU1pblk7XG5cdFx0XHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUuaW50ZXJhY3RpdmUgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5hZGRDaGlsZCh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlKTtcblxuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnRvdWNoc3RhcnQgPSB0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLm1vdXNlZG93biA9IGZ1bmN0aW9uKGUpe3RoaXMub25IYW5kbGVEb3duKGUpfS5iaW5kKHRoaXMpO1xuXHRcdFx0XHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnRvdWNobW92ZSAgPSB0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGUpe3RoaXMub25IYW5kbGVNb3ZlKGUpfS5iaW5kKHRoaXMpO1xuXG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9jcm9zc1wiKVxuXHRcdCk7XG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkNsb3NlR29hbHNDbGljaywgdGhpcyk7XG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uYWRkQ2hpbGQodGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uKTtcblxuXHQvLyBSRVNVTFRTIFNDUkVFTlxuXHR0aGlzLl9yZXN1bHRzU2NyZWVuID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fcmVzdWx0c1NjcmVlbik7XG5cblx0XHQvLyBIb21lIGJ1dHRvblxuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX291dFwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdmVyXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX2hvbWVcIilcblx0XHQpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9ob21lQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMub25Ib21lQ2xpY2ssIHRoaXMpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uYWRkQ2hpbGQodGhpcy5fcmVzdWx0c1NjcmVlbi5faG9tZUJ1dHRvbik7XG5cblx0XHQvLyBHb2FscyBidXR0b25cblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9nb2Fsc0J1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0XHQoXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fZG93blwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fZ29hbHNcIilcblx0XHQpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2dvYWxzQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uR29hbHNDbGljaywgdGhpcyk7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uYWRkQ2hpbGQodGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24pO1xuXG5cdFx0Ly8gTXV0ZSBidXR0b25cblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cblx0XHQoXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fZG93blwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fc291bmRfb25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX3NvdW5kX29mZlwiKVxuXHRcdCk7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fbXV0ZUJ1dHRvbi5pZCA9IFwibXV0ZVwiO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9tdXRlQnV0dG9uLmluaXQoKTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLmFkZENoaWxkKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24pO1xuXG5cdFx0Ly8gVGl0bGVcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVsodGhpcy5sZXZlbC5jb21wbGV0ZWQgfHwgdGhpcy5sZXZlbC5lbmRsZXNzKSA/IFwiV0VMTF9ET05FXCIgOiBcIk5JQ0VfVFJZXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0aWYoIXdlYmZvbnQpXG5cdFx0e1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3RpdGxlLnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiArIDEwMCwgMTAwKVxuXHRcdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9yZXN1bHRzU2NyZWVuLl90aXRsZSk7XG5cblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjQ4cHggU3VwZXJjbGFyZW5kb24gVGl0bGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRpdGxlLnggPSAtIHRpdGxlLnRleHRXaWR0aC8yO1xuXHRcdFx0dGl0bGUueSA9IC0gdGl0bGUudGV4dEhlaWdodC8yO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUuYWRkQ2hpbGQodGl0bGUpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4ZmZmZmZmLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yICsgMTAwLCAxMDApO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5hZGRDaGlsZCh0aGlzLl9yZXN1bHRzU2NyZWVuLl90aXRsZSk7XG5cdFx0fVxuXG5cblx0XHQvLyBDb2luc1xuXHRcdHRoaXMuaW5pdENvaW5Db2ludGFpbmVyKENvbW1vbi5zYXZlZERhdGEuY29pbnMgLSB0aGlzLmxldmVsLnNub3dmbGFrZXMpO1xuXHRcdHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5fY29pbnNDb250YWluZXIpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvaW5zQ29udGFpbmVyID0gdGhpcy5fY29pbnNDb250YWluZXI7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5hZGRDaGlsZCh0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb2luc0NvbnRhaW5lcik7XG5cblx0XHRcdC8vIENvaW5zIHRleHQgYW5pbWF0aW9uXG5cdFx0XHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0XHRcdFx0dGwuY29pbnMgPSBDb21tb24uc2F2ZWREYXRhLmNvaW5zIC0gdGhpcy5sZXZlbC5zbm93Zmxha2VzO1xuXHRcdFx0XHR0bC50byh0bCwgMS4xLCB7Y29pbnM6Q29tbW9uLnNhdmVkRGF0YS5jb2lucywgZWFzZTpMaW5lYXIuZWFzZU5vbmUsIG9uVXBkYXRlU2NvcGU6dGhpcywgb25VcGRhdGU6ZnVuY3Rpb24oKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhpcy5pbml0Q29pbkNvaW50YWluZXIoTWF0aC5yb3VuZCh0bC5jb2lucykpO1xuXHRcdFx0XHR9fSwgMS44KTtcblx0XHRcdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cblx0XHQvLyBTY3JvbGxzXG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcmVzdWx0X2JnXCIpKTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuYW5jaG9yLnNldCgwLjUpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzIgKyAxMDA7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzIgKyA2MDtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLmFkZENoaWxkKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbCk7XG5cblx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudCA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLmFkZENoaWxkKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudCk7XG5cblx0XHRcdC8vIExldmVsXG5cdFx0XHRpZighdGhpcy5sZXZlbC5lbmRsZXNzKVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkxFVkVMXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0XHRcdGlmKCF3ZWJmb250KVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LnJlcGxhY2UoXCJ7dmFsdWV9XCIsIChDb21tb24uc2F2ZWREYXRhLmxldmVsICsgMSkpLCB7Zm9udDogXCIzNnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCIsIHRpbnQ6IDB4NmQ1MzRhfSk7XG5cdFx0XHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yIC0gMTgwO1xuXHRcdFx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weS5yZXBsYWNlKFwie3ZhbHVlfVwiLCAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCArIDEpKSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHg2ZDUzNGEsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0dGV4dC55ID0gLTE4MDtcblx0XHRcdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LnkgLT0gMzA7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEZpcnN0IGNvbHVtblxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbdGhpcy5sZXZlbC5lbmRsZXNzID8gXCJESVNUQU5DRVwiIDogKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwicGFiYmllXCIgPyBcIlRST0xMU1wiIDogXCJDUllTVEFMU1wiKV1bQ29tbW9uLkNPVU5UUllfQ09ERV07XG5cblx0XHRcdGlmKCF3ZWJmb250KVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjI2cHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHgwZmEwZTR9KTtcblx0XHRcdFx0dGV4dC54ID0gLSB0ZXh0LnRleHRXaWR0aC8yICAtIDIwMDtcblx0XHRcdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiAtIDEyNTtcblx0XHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwZmEwZTQsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHR0ZXh0LnggPSAtMjAwO1xuXHRcdFx0XHR0ZXh0LnkgPSAtMTMwO1xuXHRcdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKCEhdGhpcy5sZXZlbC5lbmRsZXNzKVxuXHRcdFx0XHR2YXIgdCA9IFwidWlfaWNvbl9yZXN1bHRzX2Rpc3RhbmNlXCI7XG5cdFx0XHRlbHNlIGlmKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwicGFiYmllXCIpXG5cdFx0XHRcdHZhciB0ID0gXCJ1aV9pY29uX3Jlc3VsdHNfdHJvbGxcIjtcblx0XHRcdGVsc2Vcblx0XHRcdFx0dmFyIHQgPSBcInVpX2ljb25fcmVzdWx0c19jcnlzdGFsX1wiICsgdGhpcy5fY2hhcmFjdGVyRGF0YS5jb2xvcjtcblxuXHRcdFx0dmFyIGljb24gPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodCkpO1xuXHRcdFx0aWNvbi5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRpY29uLnggPSAtMjAwO1xuXHRcdFx0aWNvbi55ID0gLTQ1O1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKGljb24pO1xuXG5cblx0XHRcdHZhciBwYXJ0aWNsZSA9IFwicGFydGljbGVfc3BhcmtsZV9yZXN1bHRzX3BpbmtcIjtcblx0XHRcdGlmKCF0aGlzLmxldmVsLmVuZGxlc3MgJiYgKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwia3Jpc3RvZmZcIiB8fCBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcInBhYmJpZVwiKSlcblx0XHRcdFx0cGFydGljbGUgPSBcInBhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19ncmVlblwiO1xuXHRcdFx0ZWxzZSBpZih0aGlzLmxldmVsLmVuZGxlc3MgfHwgKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyID09IFwib2xhZlwiKSlcblx0XHRcdFx0cGFydGljbGUgPSBcInBhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19ibHVlXCI7XG5cdFx0XHRlbHNlIGlmKHRoaXMubGV2ZWwuZW5kbGVzcyB8fCAoQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgPT0gXCJlbHNhXCIpKVxuXHRcdFx0XHRwYXJ0aWNsZSA9IFwicGFydGljbGVfc3BhcmtsZV9yZXN1bHRzX3B1cnBsZVwiO1xuXG5cdFx0XHR0aGlzLmNyeXN0YWxTcGFya2xlUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcihpY29uLFxuXHRcdFx0W1xuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAwXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAxXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAyXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAzXCIpXG5cdFx0XHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihwYXJ0aWNsZSkpO1xuXHRcdFx0dGhpcy5jcnlzdGFsU3BhcmtsZVBTLmVtaXQgPSB0cnVlO1xuXG5cdFx0XHRpZighIXRoaXMubGV2ZWwuZW5kbGVzcylcblx0XHRcdFx0dmFyIGNvcHkgPSB0aGlzLmxldmVsLmF2YXRhci5kaXN0YW5jZSArIFwibVwiO1xuXHRcdFx0ZWxzZSBpZihDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcInBhYmJpZVwiKVxuXHRcdFx0XHR2YXIgY29weSA9IENvbW1vbi5zYXZlZERhdGEuZ2V0TGV2ZWxDb2xsZWN0ZWRUcm9sbENvdW50KENvbW1vbi5zYXZlZERhdGEubGV2ZWwpICsgXCIvM1wiO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHR2YXIgY29weSA9IENvbW1vbi5zYXZlZERhdGEuZ2V0TGV2ZWxDaGFyYWN0ZXJDcnlzdGFsQ291bnQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCwgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpICsgXCIvM1wiO1xuXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjM2cHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XG5cdFx0XHR0ZXh0LnggPSAtIHRleHQudGV4dFdpZHRoLzIgLSAyMDA7XG5cdFx0XHR0ZXh0LnkgPSAtIHRleHQudGV4dEhlaWdodC8yICsgNDA7XG5cdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cblx0XHRcdC8vIHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdC8vIHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0Ly8gdGV4dC54ID0gLTIwMDtcblx0XHRcdC8vIHRleHQueSA9IDQwO1xuXHRcdFx0Ly8gdGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXG5cdFx0XHQvLyBTZWNvbmQgY29sdW1uXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlNUWUxFX1BPSU5UU1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdFx0aWYoIXdlYmZvbnQpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjZweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwiLCB0aW50OiAweDBmYTBlNH0pO1xuXHRcdFx0XHR0ZXh0LnggPSAtIHRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHRcdHRleHQueSA9IC0gdGV4dC50ZXh0SGVpZ2h0LzIgLSAxMjU7XG5cdFx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MGZhMGU0LCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcblx0XHRcdFx0dGV4dC54ID0gMDtcblx0XHRcdFx0dGV4dC55ID0gLTEzMDtcblx0XHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgaWNvbiA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fcmVzdWx0c19zdHlsZVwiKSk7XG5cdFx0XHRpY29uLmFuY2hvci5zZXQoMC41KTtcblx0XHRcdGljb24ueCA9IDA7XG5cdFx0XHRpY29uLnkgPSAtNDU7XG5cdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQoaWNvbik7XG5cblx0XHRcdHRoaXMuc3R5bGVTcGFya2xlUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcihpY29uLFxuXHRcdFx0W1xuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAwXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAxXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAyXCIpLFxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3NwYXJrbGVfb2Zmc2V0XzAzXCIpXG5cdFx0XHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX3NwYXJrbGVfcmVzdWx0c19waW5rXCIpKTtcblx0XHRcdHRoaXMuc3R5bGVTcGFya2xlUFMuZW1pdCA9IHRydWU7XG5cblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiU1RZTEVfUE9JTlRTXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh0aGlzLmxldmVsLnN0eWxlU2NvcmUudG9TdHJpbmcoKSwge2ZvbnQ6IFwiMzZweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMjtcblx0XHRcdHRleHQueSA9IC0gdGV4dC50ZXh0SGVpZ2h0LzIgKyA0MDtcblx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZCh0ZXh0KTtcblxuXHRcdFx0Ly8gdmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KHRoaXMubGV2ZWwuc3R5bGVTY29yZSArIFwiXCIsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0Ly8gdGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHQvLyB0ZXh0LnggPSAwO1xuXHRcdFx0Ly8gdGV4dC55ID0gNDA7XG5cdFx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cblx0XHRcdC8vIFRoaXJkIGNvbHVtblxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJTTk9XRkxBS0VTXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0XHRpZighd2ViZm9udClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIyNnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCIsIHRpbnQ6IDB4MGZhMGU0fSk7XG5cdFx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMiArIDIwMDtcblx0XHRcdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiAtIDEyNTtcblx0XHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwZmEwZTQsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHR0ZXh0LnggPSAyMDA7XG5cdFx0XHRcdHRleHQueSA9IC0xMzA7XG5cdFx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fc25vd2ZsYWtlSWNvbiA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fcmVzdWx0c19zbm93Zmxha2VcIikpO1xuXHRcdFx0dGhpcy5fc25vd2ZsYWtlSWNvbi5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9zbm93Zmxha2VJY29uLnggPSAyMDA7XG5cdFx0XHR0aGlzLl9zbm93Zmxha2VJY29uLnkgPSAtNDU7XG5cdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGhpcy5fc25vd2ZsYWtlSWNvbik7XG5cblx0XHRcdHRoaXMuc25vd2ZsYWtlU3BhcmtsZVBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5fc25vd2ZsYWtlSWNvbixcblx0XHRcdFtcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wMFwiKSxcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wMVwiKSxcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wMlwiKSxcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zcGFya2xlX29mZnNldF8wM1wiKVxuXHRcdFx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9zcGFya2xlX3Jlc3VsdHNfYmx1ZVwiKSk7XG5cdFx0XHR0aGlzLnNub3dmbGFrZVNwYXJrbGVQUy5lbWl0ID0gdHJ1ZTtcblxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh0aGlzLmxldmVsLnNub3dmbGFrZXMudG9TdHJpbmcoKSwge2ZvbnQ6IFwiMzZweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMiAgKyAyMDA7XG5cdFx0XHR0ZXh0LnkgPSAtIHRleHQudGV4dEhlaWdodC8yICsgNDA7XG5cdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cblx0XHRcdC8vIHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dCh0aGlzLmxldmVsLnNub3dmbGFrZXMgKyBcIlwiLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdC8vIHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0Ly8gdGV4dC54ID0gMjAwO1xuXHRcdFx0Ly8gdGV4dC55ID0gNDA7XG5cdFx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cblx0XHRcdC8vIFRvdGFsIHRpdGxlXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlRPVEFMXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXG5cdFx0XHRpZighd2ViZm9udClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIyNnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCIsIHRpbnQ6IDB4MGZhMGU0fSk7XG5cdFx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMjtcblx0XHRcdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiArIDkwO1xuXHRcdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjMwcHggQXJpYWxcIiwgZmlsbDoweDBmYTBlNCwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdHRleHQueCA9IDA7XG5cdFx0XHRcdHRleHQueSA9IDkwO1xuXHRcdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9yZXN1bHRfZWxlbWVudF8xXCIpKTtcblx0XHRcdHNwcml0ZS5hbmNob3Iuc2V0KDAsIDAuNSk7XG5cdFx0XHRzcHJpdGUucG9zaXRpb24uc2V0KCs2MCwgOTApO1xuXHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHNwcml0ZSk7XG5cblx0XHRcdHZhciBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9yZXN1bHRfZWxlbWVudF8xXCIpKTtcblx0XHRcdHNwcml0ZS5hbmNob3Iuc2V0KDAsIDAuNSk7XG5cdFx0XHRzcHJpdGUucG9zaXRpb24uc2V0KC02MCwgOTApO1xuXHRcdFx0c3ByaXRlLnJvdGF0aW9uID0gTWF0aC5QSTtcblx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZChzcHJpdGUpO1xuXG5cblx0XHRcdC8vIFRvdGFsXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KHRoaXMubGV2ZWwuc2NvcmUudG9TdHJpbmcoKSwge2ZvbnQ6IFwiNTZweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMjtcblx0XHRcdHRleHQueSA9IC0gdGV4dC50ZXh0SGVpZ2h0LzIgKyAxNDA7XG5cdFx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9zY3JvbGwuX2NvbnRlbnQuYWRkQ2hpbGQodGV4dCk7XG5cblx0XHRcdC8vIHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dCh0aGlzLmxldmVsLnNjb3JlLnRvU3RyaW5nKCksIHtmb250OlwiNDhweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0Ly8gdGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHQvLyB0ZXh0LnggPSAwO1xuXHRcdFx0Ly8gdGV4dC55ID0gMTQwO1xuXHRcdFx0Ly8gdGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXG5cdFx0XHQvLyBIaWdoc2NvcmVcblx0XHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiSElTQ09SRVwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblx0XHRcdGNvcHkgPSBjb3B5LnJlcGxhY2UoXCJ7dmFsdWV9XCIsIENvbW1vbi5zYXZlZERhdGEuZ2V0SGlnaHNjb3JlKHRoaXMubGV2ZWwuZW5kbGVzcyA/IFwiZW5kbGVzc1wiIDogQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCkpO1xuXG5cdFx0XHRpZighd2ViZm9udClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIyNnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCIsIHRpbnQ6IDB4MGZhMGU0fSk7XG5cdFx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMjtcblx0XHRcdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiArIDE5MDtcblx0XHRcdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwZmEwZTQsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHR0ZXh0LnggPSAwO1xuXHRcdFx0XHR0ZXh0LnkgPSAxOTA7XG5cdFx0XHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5fY29udGVudC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblxuXHRcdC8vIENoYXJhY3RlclxuXHRcdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9jaGFyX1wiICsgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpKTtcblx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMiAtIDMzMDtcblx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLnhFbmQgPSB0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLng7XG5cdFx0Ly8gdGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcblx0XHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLmFkZENoaWxkKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIpO1xuXG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhciA9IG5ldyBQSVhJLnNwaW5lLlNwaW5lKENvbW1vbi5jaGFyYWN0ZXJBbmltYXRpb25EYXRhW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXSk7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzIgLSAzMzA7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci54RW5kID0gdGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci54O1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci5hdXRvVXBkYXRlID0gdHJ1ZTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLnNjYWxlLnNldCgwLjUpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIuc3RhdGUuc2V0QW5pbWF0aW9uQnlOYW1lKDAsIFwibG9va19yaWdodFwiLCB0cnVlLCAwKTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLmFkZENoaWxkKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIpO1xuXG5cdFx0Ly8gUmVzdGFydCBidXR0b25cblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9yZXN0YXJ0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9yZXN0YXJ0XCIpXG5cdFx0KTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9yZXN0YXJ0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9yZXN0YXJ0QnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC0gMTIwO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vblJlc3RhcnRDbGljaywgdGhpcyk7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5hZGRDaGlsZCh0aGlzLl9yZXN1bHRzU2NyZWVuLl9yZXN0YXJ0QnV0dG9uKTtcblxuXHRcdC8vIENvbnRpbnVlIGJ1dHRvblxuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvbnRpbnVlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRfYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X292ZXJfYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25fYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9wbGF5XCIpXG5cdFx0KTtcblx0XHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb250aW51ZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY29udGludWVCdXR0b24ueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLSAxMjA7XG5cdFx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY29udGludWVCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNvbnRpbnVlQ2xpY2ssIHRoaXMpO1xuXHRcdHRoaXMuX3Jlc3VsdHNTY3JlZW4uYWRkQ2hpbGQodGhpcy5fcmVzdWx0c1NjcmVlbi5fY29udGludWVCdXR0b24pO1xuXG5cdC8vIFNub3dmbGFrZXNcblx0dGhpcy5fZ29hbFNub3dmbGFrZXMgPSBbXTtcblx0Zm9yKHZhciBpID0gMDsgaSA8IDEwOyBpKyspXG5cdHtcblx0XHR2YXIgc25vd2ZsYWtlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zbm93Zmxha2VcIikpO1xuXHRcdHNub3dmbGFrZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0c25vd2ZsYWtlLmFscGhhID0gMDtcblx0XHR0aGlzLmFkZENoaWxkKHNub3dmbGFrZSk7XG5cblx0XHR0aGlzLl9nb2FsU25vd2ZsYWtlcy5wdXNoKHNub3dmbGFrZSk7XG5cdH1cblxuXHQvLyBNdXNpY1xuXHRpZighIUNvbW1vbi5iZ011c2ljKVxuXHR7XG5cdFx0Q29tbW9uLmJnTXVzaWMuc3RvcCgpO1xuXHRcdENvbW1vbi5iZ011c2ljLmZhZGVPdXQoKTtcblx0fVxuXHRDb21tb24uYmdNdXNpYyA9IFNvdW5kU0ZYLnBsYXkoJ214X2Zyb3plbl8wNV9zY29yZV9scCcsIHtsb29wOnRydWUsIHZvbHVtZTowfSk7XG5cdENvbW1vbi5iZ011c2ljLmZhZGVJbihDb21tb24uYmdNdXNpY1ZvbHVtZSwgMTAwMCk7XG5cblx0Ly8gRXZlbnQgVHJhY2tpbmdcblx0Q29tbW9uLmN0b3cudHJhY2tFdmVudChcblx0e1xuXHRcdGV2ZW50ICAgICAgOiBcImdhbWVfZW5kXCIsXG5cdFx0Z2FtZV9sZXZlbCA6IENvbW1vbi5zYXZlZERhdGEuZW5kbGVzcyA/IG51bGwgOiAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSxcblx0XHRnYW1lX3RpZXIxIDogXCJwbGF5X2VuZFwiLFxuXHRcdGdhbWVfdGllcjIgOiAodGhpcy5sZXZlbC5jb21wbGV0ZWQgfHwgdGhpcy5sZXZlbC5lbmRsZXNzKSA/IFwic3VjY2Vzc1wiIDogXCJmYWlsXCIsXG5cdFx0Z2FtZV9tZXRhICA6IFwie1wiICtcblx0XHRcdFx0XHRcdCBcIkNoYXJhY3Rlck5hbWU9XCIgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciArIFwiLFwiICtcblx0XHRcdFx0XHRcdCBcInR1bWJsZT1cIiAgICAgICAgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlcltDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcl1bMF0gKyBcIixcIiArXG5cdFx0XHRcdFx0XHQgXCJtYWduZXQ9XCIgICAgICAgICsgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJdWzFdICsgXCIsXCIgK1xuXHRcdFx0XHRcdFx0IFwibWFnaWM9XCIgICAgICAgICArIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXVsyXSArIFwiLFwiICtcblx0XHRcdFx0XHRcdCBcImNyeXN0YWxzPVwiICAgICAgKyAodGhpcy5sZXZlbC5lbmRsZXNzID8gMCA6IChDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcInBhYmJpZVwiID8gQ29tbW9uLnNhdmVkRGF0YS5nZXRMZXZlbENvbGxlY3RlZFRyb2xsQ291bnQoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCkgOiBDb21tb24uc2F2ZWREYXRhLmdldExldmVsQ2hhcmFjdGVyQ3J5c3RhbENvdW50KENvbW1vbi5zYXZlZERhdGEubGV2ZWwsIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyKSkpICsgXCIsXCIgK1xuXHRcdFx0XHRcdFx0IFwiZ29hbHM9W1wiICAgICAgICAgKyBDb21tb24uZ29hbHNNYW5hZ2VyLmdldFJ1bkNvbXBsZXRlZEdvYWxzSWRzKCkuam9pbigpICsgXCJdLFwiICtcblx0XHRcdFx0XHRcdCBcImNvaW5zPVwiICAgICAgICAgKyBDb21tb24uc2F2ZWREYXRhLmNvaW5zICsgXCIsXCIgK1xuXHRcdFx0XHRcdFx0IFwiZGlzdGFuY2U9XCIgICAgICArIHRoaXMubGV2ZWwuYXZhdGFyLmRpc3RhbmNlICtcblx0XHRcdFx0XHQgXCJ9XCJcblx0fSk7XG59O1xuXG4vKipcbiAqL1xuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvaW5zQ29udGFpbmVyLnggPSB0aGlzLl9nZXRTZWNvbmRCdXR0b25Qb3NpdGlvbkxlZnQoKTtcblxuXHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9ob21lQnV0dG9uLnggICA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24ueCAgID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2dvYWxzQnV0dG9uLnggID0gdGhpcy5fZ2V0U2Vjb25kQnV0dG9uUG9zaXRpb25SaWdodCgpO1xuXG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24ueCAgID0gcjJsID8gKHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCgpIC0gMjApIDogKHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCkgKyAxMCk7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvbnRpbnVlQnV0dG9uLnggID0gcjJsID8gKHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCkgKyAyMCkgOiAodGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCkgLSAyMCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24ueCAgID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvbkxlZnQoKSArIDEwO1xuXHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb250aW51ZUJ1dHRvbi54ICA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCgpIC0gMjA7XG5cblx0dGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLnggPSByMmwgPyB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpIDogdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG5cblx0dGhpcy5jcnlzdGFsU3BhcmtsZVBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xuXHR0aGlzLnN0eWxlU3BhcmtsZVBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xuXHR0aGlzLnNub3dmbGFrZVNwYXJrbGVQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcblxuXHRpZighIXRoaXMuaGFuZGxlU0ZYICYmIHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duID4gMClcblx0e1xuXHRcdHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duIC09IHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcblxuXHRcdGlmKHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duIDw9IDApXG5cdFx0e1xuXHRcdFx0dGhpcy5oYW5kbGVTRlguc3RvcCgpO1xuXHRcdFx0dGhpcy5oYW5kbGVTRlhDb3VudGRvd24gPSAwO1xuXHRcdH1cblx0fVxuXHQvLyB0aGlzLl9leGl0QnV0dG9uLnggPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpO1xuXHQvLyB0aGlzLl9tdXRlQnV0dG9uLnggPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKTtcbn07XG5cbi8qKlxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcbn07XG5cbi8qKlxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXG57XG5cbn1cblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19c2NvcGVcbiAqL1xuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXHRcdHRsLnRvKHRoaXMuX2JnLCAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW59LCAwKTtcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG5cblx0dGhpcy5fYmcuYWxwaGEgPSAwO1xuXG5cdHRoaXMuc2hvd1Jlc3VsdHMoY2FsbGJhY2ssIHNjb3BlKVxuXHQvLyB0aGlzLnNob3dHb2FscyhjYWxsYmFjaywgc2NvcGUpXG5cblx0Ly8gU25vd2ZsYWtlcyBwYXJ0aWNsZXNcblx0dmFyIGNvdW50ICAgID0gMDtcblx0dmFyIGNvdW50TWF4ID0gMTA7XG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXHRmb3IodmFyIHAgPSAwOyBwIDwgdGhpcy5fZ29hbFNub3dmbGFrZXMubGVuZ3RoICYmIGNvdW50IDwgY291bnRNYXg7IHArKylcblx0e1xuXHRcdHZhciBzID0gdGhpcy5fZ29hbFNub3dmbGFrZXNbcF07XG5cdFx0aWYocy5hbHBoYSA+IDApIGNvbnRpbnVlO1xuXG5cdFx0cy5wb3NpdGlvbi5zZXQodGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLnggKyB0aGlzLl9zbm93Zmxha2VJY29uLngsIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC55ICsgdGhpcy5fc25vd2ZsYWtlSWNvbi55ICsgdGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLl9jb250ZW50LnkpO1xuXHRcdHMuc2NhbGUuc2V0KDEuNSk7XG5cdFx0cy5hbHBoYSA9IDA7XG5cblx0XHR0bC50byhzLnNjYWxlLCAxLCAgICB7eDogMSwgeTogMSwgZWFzZTpRdWFydC5lYXNlT3V0fSwgICAgICAgICAgICAxICsgY291bnQgKiAwLjEpO1xuXHRcdHRsLnRvKHMsICAgICAgIDEsICAgIHthbHBoYToxLCBlYXNlOlF1YXJ0LmVhc2VPdXR9LCAgICAgICAgICAgICAgIDEgKyBjb3VudCAqIDAuMSk7XG5cdFx0dGwudG8ocywgICAgICAgMSwgICAge3JvdGF0aW9uOjIgKiBNYXRoLlBJLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMSArIGNvdW50ICogMC4xKTtcblx0XHR0bC50byhzLCAgICAgICAxLCAgICB7eDogdGhpcy5fY29pbnNDb250YWluZXIueCArIHRoaXMuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UueCxcblx0XHQgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5fY29pbnNDb250YWluZXIueSArIHRoaXMuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UueSxcblx0XHRcdFx0XHRcdFx0ICBlYXNlIDogU2luZS5lYXNlSW5PdXR9LCAxICsgY291bnQgKiAwLjEpO1xuXHRcdHRsLnRvKHMsICAgICAgIDAuMDEsIHthbHBoYTogMCwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9KTtcblxuXHRcdGNvdW50Kys7XG5cdH1cblxufTtcblxuXG4vKipcbiAqIEBwYXJhbSB7RnVuY3Rpb249fSBjYWxsYmFja1xuICogQHBhcmFtIHsqPX0gc2NvcGVcbiAqL1xuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUuZXhpdEdhbWUgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24uaW50ZXJhY3RpdmUgICAgID0gZmFsc2U7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2dvYWxzQnV0dG9uLmludGVyYWN0aXZlICAgID0gZmFsc2U7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24uaW50ZXJhY3RpdmUgICAgID0gZmFsc2U7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24uaW50ZXJhY3RpdmUgID0gZmFsc2U7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvbnRpbnVlQnV0dG9uLmludGVyYWN0aXZlID0gZmFsc2U7XG5cblx0aWYoY2FsbGJhY2spIGNhbGxiYWNrLmNhbGwoc2NvcGUpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUuc2hvd0dvYWxzID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHR0aGlzLl9nb2Fsc1NjcmVlbi52aXNpYmxlID0gdHJ1ZTtcblx0dGhpcy5fcmVzdWx0c1NjcmVlbi52aXNpYmxlID0gZmFsc2U7XG5cblx0dGhpcy5fZ29hbHNTY3JlZW4uX3RpdGxlLnNjYWxlLnNldCgwKTtcblx0dGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLnNjYWxlLnNldCgwKTtcblx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzQ29udGFpbmVyLnNjYWxlLnNldCgxKTtcblx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuc2NhbGUuc2V0KDApO1xuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzLmxlbmd0aDsgaSsrKVxuXHRcdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1tpXS5zY2FsZS5zZXQoMCk7XG5cblx0Ly8gdGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLmludGVyYWN0aXZlID0gdHJ1ZTtcblxuXHR0aGlzLm1vdmVIYW5kbGUoLTEwMDApO1xuXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XG5cdFx0dGwudG8odGhpcy5fZ29hbHNTY3JlZW4uX3RpdGxlLnNjYWxlLCAgICAgICAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMC4yKTtcblx0XHR0bC50byh0aGlzLl9nb2Fsc1NjcmVlbi5fY2xvc2VCdXR0b24uc2NhbGUsICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xuXHRcdHRsLnRvKHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDEpO1xuXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fscy5sZW5ndGg7IGkrKylcblx0XHRcdHRsLnRvKHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1tpXS5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCBNYXRoLm1pbigwLjQgKyBpICogMC4xLCAyKSk7XG5cblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG5cbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLmhpZGVHb2FscyA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0Ly8gdGhpcy5fZ29hbHNTY3JlZW4uX2Nsb3NlQnV0dG9uLmludGVyYWN0aXZlID0gZmFsc2U7XG5cblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcblx0XHR0bC50byh0aGlzLl9nb2Fsc1NjcmVlbi5fdGl0bGUuc2NhbGUsICAgICAgIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAgICAgICAwKTtcblx0XHR0bC50byh0aGlzLl9nb2Fsc1NjcmVlbi5fY2xvc2VCdXR0b24uc2NhbGUsIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAgICAgICAwKTtcblx0XHR0bC50byh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5zY2FsZSwgICAgIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcblx0XHR0bC50byh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNDb250YWluZXIuc2NhbGUsIC4zLCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAgICAwLjIpO1xuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLnNob3dSZXN1bHRzID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHR0aGlzLl9nb2Fsc1NjcmVlbi52aXNpYmxlID0gZmFsc2U7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4udmlzaWJsZSA9IHRydWU7XG5cblx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fdGl0bGUuc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb2luc0NvbnRhaW5lci5zY2FsZS5zZXQoMCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5zY2FsZS5zZXQoMCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24uc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9nb2Fsc0J1dHRvbi5zY2FsZS5zZXQoMCk7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24uc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9yZXN1bHRzU2NyZWVuLl9yZXN0YXJ0QnV0dG9uLnNjYWxlLnNldCgwKTtcblx0dGhpcy5fcmVzdWx0c1NjcmVlbi5fY29udGludWVCdXR0b24uc2NhbGUuc2V0KDApO1xuXG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24uaW50ZXJhY3RpdmUgICAgID0gdHJ1ZTtcblx0Ly8gdGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24uaW50ZXJhY3RpdmUgICAgPSB0cnVlO1xuXHQvLyB0aGlzLl9yZXN1bHRzU2NyZWVuLl9tdXRlQnV0dG9uLmludGVyYWN0aXZlICAgICA9IHRydWU7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24uaW50ZXJhY3RpdmUgID0gdHJ1ZTtcblx0Ly8gdGhpcy5fcmVzdWx0c1NjcmVlbi5fY29udGludWVCdXR0b24uaW50ZXJhY3RpdmUgPSB0cnVlO1xuXG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIueCA9IDA7XG5cdHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIuYWxwaGEgPSAwO1xuXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XG5cblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl90aXRsZS5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb2luc0NvbnRhaW5lci5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjQpO1xuXHRcdHRsLnRvKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Njcm9sbC5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjIpO1xuXG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24uc2NhbGUsIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMC40KTtcblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9tdXRlQnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNSk7XG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5faG9tZUJ1dHRvbi5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjUpO1xuXG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fcmVzdGFydEJ1dHRvbi5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xuXHRcdHRsLnRvKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvbnRpbnVlQnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuOCk7XG5cblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9jaGFyLCAuNSwge2FscGhhOjEsIHg6IHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NoYXIueEVuZCwgZWFzZTpTaW5lLkVhc2VPdXR9LCAwLjMpO1xuXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUuaGlkZVJlc3VsdHMgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2hvbWVCdXR0b24uaW50ZXJhY3RpdmUgICAgID0gZmFsc2U7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2dvYWxzQnV0dG9uLmludGVyYWN0aXZlICAgID0gZmFsc2U7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX211dGVCdXR0b24uaW50ZXJhY3RpdmUgICAgID0gZmFsc2U7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3Jlc3RhcnRCdXR0b24uaW50ZXJhY3RpdmUgID0gZmFsc2U7XG5cdC8vIHRoaXMuX3Jlc3VsdHNTY3JlZW4uX2NvbnRpbnVlQnV0dG9uLmludGVyYWN0aXZlID0gZmFsc2U7XG5cblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcblxuXHRcdHRsLnRvKHRoaXMuX3Jlc3VsdHNTY3JlZW4uX3RpdGxlLnNjYWxlLCAgICAgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMC4xKTtcblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb2luc0NvbnRhaW5lci5zY2FsZSwgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDAuMik7XG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fc2Nyb2xsLnNjYWxlLCAgICAgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwLjMpO1xuXG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fZ29hbHNCdXR0b24uc2NhbGUsICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9tdXRlQnV0dG9uLnNjYWxlLCAgICAgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDAuMSk7XG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5faG9tZUJ1dHRvbi5zY2FsZSwgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwLjIpO1xuXG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fcmVzdGFydEJ1dHRvbi5zY2FsZSwgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwLjA1KTtcblx0XHR0bC50byh0aGlzLl9yZXN1bHRzU2NyZWVuLl9jb250aW51ZUJ1dHRvbi5zY2FsZSwgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDAuMTUpO1xuXG5cdFx0dGwudG8odGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhciwgICAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgeDogdGhpcy5fcmVzdWx0c1NjcmVlbi5fY2hhci54LTIwMCwgZWFzZTpTaW5lLkVhc2VJbn0sIDAuMzUpO1xuXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xufTtcblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUklWQVRFIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLm9uQ2xvc2VHb2Fsc0NsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmhpZGVHb2FscyhmdW5jdGlvbigpe3RoaXMuc2hvd1Jlc3VsdHMoKX0sIHRoaXMpO1xufVxuXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLm9uUmVzdGFydENsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmV4aXRHYW1lKGZ1bmN0aW9uKClcblx0e1xuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRDdXJyZW50U2NyZWVuLmRpc3BhdGNoKCk7XG5cdH0sIHRoaXMpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufVxuXG5cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUub25Db250aW51ZUNsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmV4aXRHYW1lKGZ1bmN0aW9uKClcblx0e1xuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmRpc3BhdGNoKCk7XG5cdH0sIHRoaXMpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufVxuXG5cblxuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS5vbkhvbWVDbGljayA9IGZ1bmN0aW9uKClcbntcblx0dGhpcy5leGl0R2FtZShmdW5jdGlvbigpXG5cdHtcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcblx0fSwgdGhpcyk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59XG5cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUub25Hb2Fsc0NsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmhpZGVSZXN1bHRzKGZ1bmN0aW9uKCl7dGhpcy5zaG93R29hbHMoKX0sIHRoaXMpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufVxuXG4vKipcbiAqL1xuR2FtZU92ZXJPdmVybGF5LnByb3RvdHlwZS5vbkhhbmRsZURvd24gPSBmdW5jdGlvbihlKVxue1xuXHR0aGlzLmhhbmRsZUFjdGl2ZSA9IHRydWU7XG5cdHRoaXMuaGFuZGxlWSA9IGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLnk7XG5cdHRoaXMuaGFuZGxlVXAgPSBmdW5jdGlvbigpe3RoaXMub25IYW5kbGVVcCgpO30uYmluZCh0aGlzKVxuXG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLmhhbmRsZVVwKTtcblx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVVcCk7XG59XG5cbi8qKlxuICovXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLm9uSGFuZGxlVXAgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuaGFuZGxlQWN0aXZlID0gZmFsc2U7XG5cdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgIHRoaXMuaGFuZGxlVXApO1xuXHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLmhhbmRsZVVwKTtcbn1cblxuLyoqXG4gKi9cbkdhbWVPdmVyT3ZlcmxheS5wcm90b3R5cGUub25IYW5kbGVNb3ZlID0gZnVuY3Rpb24oZSlcbntcblx0aWYoIXRoaXMuaGFuZGxlQWN0aXZlKSByZXR1cm47XG5cblx0dmFyIG5ld1kgID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueTtcblx0dmFyIGRlbHRhID0gbmV3WSAtIHRoaXMuaGFuZGxlWTtcblx0dGhpcy5tb3ZlSGFuZGxlKGRlbHRhKTtcblxuXHRpZih0aGlzLmhhbmRsZVNGWENvdW50ZG93biA9PSAwKVxuXHR7XG5cdFx0dGhpcy5oYW5kbGVTRlggPSBTb3VuZFNGWC5wbGF5KFwic2Z4X3B1bGxleV9kb3duX2xvb3BfMDRcIiwge2xvb3A6dHJ1ZX0pO1xuXHR9XG5cdHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duID0gMC4yO1xufVxuXG5HYW1lT3Zlck92ZXJsYXkucHJvdG90eXBlLm1vdmVIYW5kbGUgPSBmdW5jdGlvbihkZWx0YSlcbntcblx0aWYodGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55ICsgZGVsdGEgPCB0aGlzLmhhbmRsZU1pblkpXG5cdFx0ZGVsdGEgPSB0aGlzLmhhbmRsZU1pblkgLSB0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnlcblx0ZWxzZSBpZih0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnkgKyBkZWx0YSA+IHRoaXMuaGFuZGxlTWF4WSlcblx0XHRkZWx0YSA9IHRoaXMuaGFuZGxlTWF4WSAtIHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUueVxuXG5cdHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fsc1Njcm9sbGVyLl9yb3BlLnRpbGVQb3NpdGlvbi55ICs9IGRlbHRhO1xuXHR0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnkgKz0gZGVsdGE7XG5cblx0dmFyIHBlcmMgICA9ICh0aGlzLl9nb2Fsc1NjcmVlbi5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnkgLSB0aGlzLmhhbmRsZU1pblkpLyggdGhpcy5oYW5kbGVNYXhZIC0gdGhpcy5oYW5kbGVNaW5ZKTtcblx0dmFyIG5TdGVwcyA9IHRoaXMuX2dvYWxzU2NyZWVuLl9nb2Fscy5sZW5ndGggLSA0O1xuXHR2YXIgc3RlcCAgID0gKHBlcmMgLygxLyhuU3RlcHMtMSkpKTtcblxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzLmxlbmd0aDsgaSsrKVxuXHR7XG5cdFx0dGhpcy5fZ29hbHNTY3JlZW4uX2dvYWxzW2ldLnkgPSAxMDAgKiAoaS1zdGVwKTtcblx0fVxuXG5cdHRoaXMuaGFuZGxlWSArPSBkZWx0YTtcbn1cblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VUVEVSUy9TRVRURVJTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiIsInZhciBDb21tb24gICAgICAgXHRcdD0gcmVxdWlyZShcIi4uL0NvbW1vblwiKTtcclxudmFyIFNpbXBsZVNjcmVlbiBcdFx0PSByZXF1aXJlKFwiLi4vc2NyZWVucy9TaW1wbGVTY3JlZW5cIik7XHJcbnZhciBXaXJlZnJhbWVCdXR0b24gXHQ9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBHZW5lcmljUG9wdXBPdmVybGF5KGNvbnRlbnQsIGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG4gICAgdGhpcy5fY29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgdGhpcy5fc2NvcGUgPSBzY29wZTtcclxuXHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IG51bGw7XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdlbmVyaWNQb3B1cE92ZXJsYXk7XHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmljUG9wdXBPdmVybGF5O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICovXHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB2YXIgYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFjayddKTtcclxuICAgIGJnLndpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xyXG4gICAgYmcuaGVpZ2h0ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcclxuICAgIGJnLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuICAgIGJnLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuICAgIGJnLmFscGhhID0gMC43NTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoYmcpO1xyXG5cclxuICAgIHZhciBtZXNzYWdlQm94ID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcclxuICAgIG1lc3NhZ2VCb3guYmVnaW5GaWxsKDB4RkZGRkZGKTtcclxuICAgIG1lc3NhZ2VCb3guZHJhd1JlY3QoLTMwMCwgLTIwMCwgNjAwLCA0MDApO1xyXG4gICAgbWVzc2FnZUJveC54ID0gQ29tbW9uLlNUQUdFX1dJRFRIIC8gMjtcclxuICAgIG1lc3NhZ2VCb3gueSA9IChDb21tb24uU1RBR0VfSEVJR0hUIC8gMik7XHJcbiAgICB0aGlzLmFkZENoaWxkKG1lc3NhZ2VCb3gpO1xyXG5cclxuICAgIG1lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fY29udGVudCk7XHJcblxyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSBuZXcgV2lyZWZyYW1lQnV0dG9uKFwiQ2xvc2VcIik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi54ID0gcjJsID8gLTMwMCA6IDMwMDtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnkgPSAtMjAwO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5jbGlja2VkLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xyXG4gICAgbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9jbG9zZUJ1dHRvbik7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5HZW5lcmljUG9wdXBPdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufVxyXG5cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUub25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5fY2FsbGJhY2suY2FsbCh0aGlzLl9zY29wZSk7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICBcdFx0PSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU2ltcGxlU2NyZWVuIFx0XHQ9IHJlcXVpcmUoXCIuLi9zY3JlZW5zL1NpbXBsZVNjcmVlblwiKTtcclxudmFyIFdpcmVmcmFtZUJ1dHRvbiBcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uXCIpO1xyXG52YXIgU291bmRTRlggICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIEdlbmVyaWNQb3B1cE92ZXJsYXkoc2VjdGlvbilcclxue1xyXG5cdHRoaXMuX3NlY3Rpb24gPSBzZWN0aW9uO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSBudWxsO1xyXG5cclxuXHR0aGlzLl9zY3JlZW5JbmRleCA9IDA7XHJcblxyXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdlbmVyaWNQb3B1cE92ZXJsYXk7XHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmljUG9wdXBPdmVybGF5O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICovXHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFja1NxdWFyZSddKTtcclxuXHR0aGlzLl9iZy5hbHBoYSAgICAgICA9IDAuNzU7XHJcblx0dGhpcy5fYmcud2lkdGggICAgICAgPSBDb21tb24uU1RBR0VfV0lEVEg7XHJcblx0dGhpcy5fYmcuaGVpZ2h0ICAgICAgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG5cdHRoaXMuX2JnLmhpdEFyZWEgICAgID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XHJcblx0dGhpcy5fYmcuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHJcblx0Ly8gVGl0bGVcclxuXHR0aGlzLl90aXRsZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3RpdGxlX2JnXCIpKTtcclxuXHR0aGlzLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0dGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xyXG5cdHRoaXMuX3RpdGxlLnkgPSAxMDA7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl90aXRsZSk7XHJcblxyXG5cdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJIRUxQXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aXRsZS54ID0gLXRpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aXRsZS55ID0gLXRpdGxlLnRleHRIZWlnaHQvMiAtIDQ7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjM2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuXHRcdFx0dGl0bGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aXRsZS55ID0gLTY7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHJcblx0Ly8gQ29udGVudFxyXG4gICAgdGhpcy5fbWVzc2FnZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3BvcHVwX2JnXCIpKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzIgKyA3MDtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCk7XHJcblxyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdXRcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NlY25hdl9jcm9zc1wiKVxyXG5cdCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnggPSByMmwgPyAtNDAwIDogNDAwO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24ueSA9IC0yNDA7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fY2xvc2VCdXR0b24pO1xyXG5cclxuXHQvLyBIZWxwIHNjcmVlbnNcclxuXHR0aGlzLl9jb250ZW50ID0gW107XHJcblxyXG5cdHN3aXRjaCh0aGlzLl9zZWN0aW9uKVxyXG5cdHtcclxuXHRcdGNhc2UgXCJzcGxhc2hcIjpcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX21haW5fbWVudV9iZ1wiLCBcInVpX2hlbHBfbWFpbl9tZW51X3N0b3J5XCJdLCB0ZXh0OlwiSEVMUF9NQUlOXzBcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfbWFpbl9tZW51X2JnXCIsIFwidWlfaGVscF9tYWluX21lbnVfZW5kbGVzc1wiXSwgdGV4dDpcIkhFTFBfTUFJTl8xXCJ9KTtcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX21haW5fbWVudV9iZ1wiLCBcInVpX2hlbHBfbWFpbl9tZW51X2hpX3Njb3JlXCJdLCB0ZXh0OlwiSEVMUF9NQUlOXzJcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfZ29hbHNcIl0sIHRleHQ6XCJIRUxQX0dPQUxTXzBcIn0pO1xyXG5cdFx0XHRicmVhaztcclxuXHJcblx0XHRjYXNlIFwibGV2ZWxTZWxlY3RcIjpcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX21hcF9jbGVhbl9iZ1wiXSwgdGV4dDpcIkhFTFBfTUFQXzBcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfbWFwX2JnXCIsIFwidWlfaGVscF9tYXBfY2hhcmFjdGVyc1wiXSwgdGV4dDpcIkhFTFBfTUFQXzFcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfbWFwX3BhYmJpZVwiXSwgdGV4dDpcIkhFTFBfTUFQXzJcIn0pO1xyXG5cdFx0XHRicmVhaztcclxuXHJcblx0XHRjYXNlIFwiY2hhcmFjdGVyU2VsZWN0XCI6XHJcblx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfaGVscF9jaGFyYWN0ZXJzX2JnXCIsIFwidWlfaGVscF9jaGFyYWN0ZXJzX2Fycm93c1wiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSXzBcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfY2hhcmFjdGVyc19iZ1wiLCBcInVpX2hlbHBfY2hhcmFjdGVyc191cGdyYWRlXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfMVwifSk7XHJcblx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfaGVscF9jaGFyYWN0ZXJzX2JnXCIsIFwidWlfaGVscF9jaGFyYWN0ZXJzX3R1bWJsZVwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSXzJcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfY2hhcmFjdGVyc19iZ1wiLCBcInVpX2hlbHBfY2hhcmFjdGVyc19tYWduZXRcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl8zXCJ9KTtcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2NoYXJhY3RlcnNfYmdcIiwgXCJ1aV9oZWxwX2NoYXJhY3RlcnNfbWFnaWNcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl80XCJ9KTtcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2NoYXJhY3RlcnNfYmdcIiwgXCJ1aV9oZWxwX2NoYXJhY3RlcnNfY3J5c3RhbHNcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl81XCJ9KTtcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX2FubmFcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl82XCJ9KTtcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2NoYXJhY3RlcnNfYmdcIiwgXCJ1aV9oZWxwX2NoYXJhY3RlcnNfY3J5c3RhbHNcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl83XCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG5cclxuXHR0aGlzLl9zY3JlZW5zID0gW107XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX2NvbnRlbnQubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIHNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0c2NyZWVuLmFscGhhID0gaSA9PSAwID8gMSA6IDA7XHJcblxyXG5cdFx0Zm9yKHZhciBtID0gMDsgbSA8IHRoaXMuX2NvbnRlbnRbaV0uaW1hZ2UubGVuZ3RoOyBtKyspXHJcblx0XHR7XHJcblx0XHRcdHZhciBpbWFnZSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLl9jb250ZW50W2ldLmltYWdlW21dKSk7XHJcblx0XHRcdGltYWdlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0aW1hZ2UueSA9IC0zMDtcclxuXHRcdFx0c2NyZWVuLmFkZENoaWxkKGltYWdlKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVt0aGlzLl9jb250ZW50W2ldLnRleHRdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjI0cHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcclxuXHRcdFx0dGV4dC5tYXhXaWR0aCA9IDYyMDtcclxuXHRcdFx0dGV4dC51cGRhdGVUZXh0KCk7XHJcblx0XHRcdHRleHQueCA9IC10ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0ZXh0LnkgPSAtdGV4dC50ZXh0SGVpZ2h0LzIgKyAxODU7XHJcblx0XHRcdHNjcmVlbi5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHkucmVwbGFjZSgvXFxuL2dpLCBcIlwiKSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInLCB3b3JkV3JhcDp0cnVlLCBsaW5lSGVpZ2h0OjMyLCB3b3JkV3JhcFdpZHRoOjYyMH0pO1xyXG5cdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGV4dC55ID0gMTgwO1xyXG5cdFx0XHRzY3JlZW4uYWRkQ2hpbGQodGV4dCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fc2NyZWVucy5wdXNoKHNjcmVlbik7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHNjcmVlbik7XHJcblx0fVxyXG5cclxuXHQvLyBQcmV2L05leHQgYnV0dG9uc1xyXG5cdGlmKHRoaXMuX2NvbnRlbnQubGVuZ3RoID4gMSlcclxuXHR7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0KFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3V0XCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfYXJyb3dcIilcclxuXHRcdCk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24uY2hpbGRyZW5bMV0ueCA9IC01O1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5jaGlsZHJlblsxXS5zY2FsZS54ID0gLTE7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLnBvc2l0aW9uLnNldCgtMzg1LCAyMTApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5hbHBoYSA9IDA7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vblByZXYsIHRoaXMpO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uKTtcclxuXHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHRcdChcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X292ZXJcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X2Fycm93XCIpXHJcblx0XHQpO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fcmlnaHRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fcmlnaHRCdXR0b24ucG9zaXRpb24uc2V0KDM4NSwgMjEwKTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbk5leHQsIHRoaXMpO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbik7XHJcblxyXG5cdFx0aWYocjJsKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLnNjYWxlLnNldCgtMSwxKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5wb3NpdGlvbi5zZXQoMzg1LCAyMTApO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbi5zY2FsZS5zZXQoLTEsMSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uLnBvc2l0aW9uLnNldCgtMzg1LCAyMTApO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkdlbmVyaWNQb3B1cE92ZXJsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5HZW5lcmljUG9wdXBPdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufVxyXG5cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fYmcuYWxwaGEgPSAwO1xyXG5cdHRoaXMuX3RpdGxlLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MC43NSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dC5jYWxsKHRoaXMpO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xyXG5cdFx0dGwudG8odGhpcy5fYmcsICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUlufSwgIDApO1xyXG5cdFx0dGwudG8odGhpcy5fdGl0bGUuc2NhbGUsICAgICAgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5zY2FsZSwgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5HZW5lcmljUG9wdXBPdmVybGF5LnByb3RvdHlwZS5vblByZXYgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLl9zY3JlZW5JbmRleCA9PSAwKSByZXR1cm47XHJcblxyXG5cdG5leHRTY3JlZW4gPSB0aGlzLl9zY3JlZW5JbmRleC0xO1xyXG5cdGlmKG5leHRTY3JlZW4gPCAwKSBuZXh0U2NyZWVuID0gdGhpcy5fc2NyZWVucy5sZW5ndGggLTE7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0dGwudG8odGhpcy5fc2NyZWVuc1t0aGlzLl9zY3JlZW5JbmRleF0sICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3NjcmVlbnNbbmV4dFNjcmVlbl0sICAgICAgICAgICAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHJcblx0XHRpZih0aGlzLl9zY3JlZW5JbmRleCA9PSB0aGlzLl9zY3JlZW5zLmxlbmd0aC0xKVxyXG5cdFx0e1xyXG5cdFx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbiwgIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYobmV4dFNjcmVlbiA9PSAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLCAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24uaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG5cclxuXHR0aGlzLl9zY3JlZW5JbmRleCA9IG5leHRTY3JlZW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5fc2NyZWVuSW5kZXggPT0gdGhpcy5fc2NyZWVucy5sZW5ndGgtMSkgcmV0dXJuO1xyXG5cclxuXHRuZXh0U2NyZWVuID0gdGhpcy5fc2NyZWVuSW5kZXgrMTtcclxuXHRpZihuZXh0U2NyZWVuID49IHRoaXMuX3NjcmVlbnMubGVuZ3RoKSBuZXh0U2NyZWVuID0gMDtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHR0bC50byh0aGlzLl9zY3JlZW5zW3RoaXMuX3NjcmVlbkluZGV4XSwgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fc2NyZWVuc1tuZXh0U2NyZWVuXSwgICAgICAgICAgIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cclxuXHRcdGlmKG5leHRTY3JlZW4gPT0gdGhpcy5fc2NyZWVucy5sZW5ndGgtMSlcclxuXHRcdHtcclxuXHRcdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5fcmlnaHRCdXR0b24sICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5fcmlnaHRCdXR0b24uaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0aGlzLl9zY3JlZW5JbmRleCA9PSAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLCAgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24uaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcblxyXG5cdHRoaXMuX3NjcmVlbkluZGV4ID0gbmV4dFNjcmVlbjtcclxufVxyXG5cclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuR2VuZXJpY1BvcHVwT3ZlcmxheS5wcm90b3R5cGUub25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5hbmltYXRlT3V0KGZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcclxuXHR9LCB0aGlzKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICBcdFx0PSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU2ltcGxlU2NyZWVuIFx0XHQ9IHJlcXVpcmUoXCIuLi9zY3JlZW5zL1NpbXBsZVNjcmVlblwiKTtcclxudmFyIFdpcmVmcmFtZUJ1dHRvbiBcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uXCIpO1xyXG52YXIgU291bmRTRlggICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBJbnN0cnVjdGlvbnNPdmVybGF5KHdoYXQpXHJcbntcclxuXHR0aGlzLl93aGF0ID0gd2hhdDtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gbnVsbDtcclxuXHJcblx0dGhpcy5fc2NyZWVuSW5kZXggPSAwO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBJbnN0cnVjdGlvbnNPdmVybGF5O1xyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcbkluc3RydWN0aW9uc092ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSW5zdHJ1Y3Rpb25zT3ZlcmxheTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG5cdHRoaXMuX2JnID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snYmxhY2tTcXVhcmUnXSk7XHJcblx0dGhpcy5fYmcuYWxwaGEgICAgICAgPSAwLjc1O1xyXG5cdHRoaXMuX2JnLndpZHRoICAgICAgID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xyXG5cdHRoaXMuX2JnLmhlaWdodCAgICAgID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcclxuXHR0aGlzLl9iZy5oaXRBcmVhICAgICA9IG5ldyBQSVhJLlJlY3RhbmdsZSgwLCAwLCBDb21tb24uU1RBR0VfV0lEVEgsIENvbW1vbi5TVEFHRV9IRUlHSFQpO1xyXG5cdHRoaXMuX2JnLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2JnKTtcclxuXHJcblx0dGhpcy5fdGl0bGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV90aXRsZV9iZ1wiKSk7XHJcblx0dGhpcy5fdGl0bGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdHRoaXMuX3RpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHR0aGlzLl90aXRsZS55ID0gMTAwO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fdGl0bGUpO1xyXG5cclxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiSEVMUFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDJweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGl0bGUueSA9IC10aXRsZS50ZXh0SGVpZ2h0LzIgLSA0O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRpdGxlLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGl0bGUueSA9IC02O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblxyXG4gICAgdGhpcy5fbWVzc2FnZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3BvcHVwX2JnXCIpKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnkgPSBDb21tb24uU1RBR0VfSEVJR0hULzIgKyA3MDtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCk7XHJcblxyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdXRcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NlY25hdl9jcm9zc1wiKVxyXG5cdCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnggPSByMmwgPyAtNDAwIDogNDAwO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24ueSA9IC0yNDA7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fY2xvc2VCdXR0b24pO1xyXG5cclxuXHQvLyBIZWxwIHNjcmVlbnNcclxuXHR0aGlzLl9jb250ZW50ID0gW107XHJcblxyXG5cdHN3aXRjaCh0aGlzLl93aGF0KVxyXG5cdHtcclxuXHRcdGRlZmF1bHQ6XHJcblx0XHRjYXNlIFwiYW5uYVwiOlxyXG5cdFx0XHRpZihwMy5EZXZpY2UuaXNNb2JpbGUpXHJcblx0XHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX2FubmFcIiwgXCJ1aV9oZWxwX3RhcF9oaWdobGlnaHRfclwiLCBcInVpX2hlbHBfZ2FtZXBsYXlfaGFuZF9yXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfQU5OQV8wXCJ9KTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9hbm5hXCIsXCJ1aV9oZWxwX2dhbWVwbGF5X21vdXNlXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfQU5OQV8wXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0Y2FzZSBcImtyaXN0b2ZmXCI6XHJcblx0XHRcdGlmKHAzLkRldmljZS5pc01vYmlsZSlcclxuXHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfa3Jpc3RvZmZcIiwgXCJ1aV9oZWxwX3RhcF9oaWdobGlnaHRfbFwiLCBcInVpX2hlbHBfZ2FtZXBsYXlfaGFuZF9sXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfS1JJU1RPRkZfMFwifSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfa3Jpc3RvZmZcIixcInVpX2hlbHBfZ2FtZXBsYXlfZW50ZXJcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl9LUklTVE9GRl8wXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0Y2FzZSBcIm9sYWZcIjpcclxuXHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxyXG5cdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9vbGFmXCIsIFwidWlfaGVscF90YXBfaGlnaGxpZ2h0X2xcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X2hhbmRfbFwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX09MQUZfMFwifSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfb2xhZlwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlcl9vbGFmXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfT0xBRl8wXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0Y2FzZSBcImVsc2FcIjpcclxuXHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxyXG5cdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9lbHNhXCIsIFwidWlfaGVscF90YXBfaGlnaGxpZ2h0X2xcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X2hhbmRfbFwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX0VMU0FfMFwifSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfZWxzYVwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlclwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX0VMU0FfMFwifSk7XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdGNhc2UgXCJwYWJiaWVcIjpcclxuXHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxyXG5cdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9wYWJiaWVcIiwgXCJ1aV9oZWxwX3RhcF9oaWdobGlnaHRfbFwiLCBcInVpX2hlbHBfZ2FtZXBsYXlfaGFuZF9sXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfUEFCQklFXzBcIn0pO1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX3BhYmJpZVwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlclwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX1BBQkJJRV8wXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0Y2FzZSBcImVuZGxlc3NcIjpcclxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX2Rpc3RhbmNlXCJdLCB0ZXh0OlwiSEVMUF9FTkRMRVNTXzBcIn0pO1xyXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfcGVyc29uYWxfYmVzdFwiXSwgdGV4dDpcIkhFTFBfRU5ETEVTU18xXCJ9KTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG5cclxuXHR0aGlzLl9zY3JlZW5zID0gW107XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX2NvbnRlbnQubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIHNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdFx0Ly8gc2NyZWVuLnkgPSAtNzA7XHJcblx0XHRzY3JlZW4uYWxwaGEgPSBpID09IDAgPyAxIDogMDtcclxuXHJcblx0XHRmb3IodmFyIG0gPSAwOyBtIDwgdGhpcy5fY29udGVudFtpXS5pbWFnZS5sZW5ndGg7IG0rKylcclxuXHRcdHtcclxuXHRcdFx0dmFyIGltYWdlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuX2NvbnRlbnRbaV0uaW1hZ2VbbV0pKTtcclxuXHRcdFx0aW1hZ2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRpbWFnZS55ID0gLTMwO1xyXG5cdFx0XHRzY3JlZW4uYWRkQ2hpbGQoaW1hZ2UpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVt0aGlzLl9jb250ZW50W2ldLnRleHRdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjJweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwiLCB0aW50OiAweDZkMzhhYn0pO1xyXG5cdFx0XHQvLyB0ZXh0Lm1heFdpZHRoID0gNjUwO1xyXG5cdFx0XHQvLyB0ZXh0LnVwZGF0ZVRleHQoKTtcclxuXHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiArIDE4MDtcclxuXHRcdFx0c2NyZWVuLmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVt0aGlzLl9jb250ZW50W2ldLnRleHRdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weS5yZXBsYWNlKC9cXG4vZ2ksIFwiXCIpLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NjIwfSk7XHJcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0ZXh0LnkgPSAxODA7XHJcblx0XHRcdHNjcmVlbi5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9zY3JlZW5zLnB1c2goc2NyZWVuKTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQoc2NyZWVuKTtcclxuXHR9XHJcblxyXG5cdC8vIFByZXYvTmV4dCBidXR0b25zXHJcblx0aWYodGhpcy5fY29udGVudC5sZW5ndGggPiAxKVxyXG5cdHtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0XHQoXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfZG93blwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9hcnJvd1wiKVxyXG5cdFx0KTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5jaGlsZHJlblsxXS54ID0gLTU7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLnNjYWxlLnggPSAtMTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24ucG9zaXRpb24uc2V0KC0zODUsIDIxMCk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9sZWZ0QnV0dG9uLmFscGhhID0gMDtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uUHJldiwgdGhpcyk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24pO1xyXG5cclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0KFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3V0XCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfYXJyb3dcIilcclxuXHRcdCk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbi5wb3NpdGlvbi5zZXQoMzg1LCAyMTApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5fcmlnaHRCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uTmV4dCwgdGhpcyk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uKTtcclxuXHR9XHJcblxyXG5cdENvbW1vbi5iZ011c2ljLnN0b3AoKTtcclxuXHRDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDUwMCk7XHJcblx0Q29tbW9uLmJnTXVzaWMgPSBTb3VuZFNGWC5wbGF5KCdteF9mcm96ZW5fMDRfcGF1c2VfbHAnLCB7bG9vcDp0cnVlLCB2b2x1bWU6MH0pO1xyXG5cdENvbW1vbi5iZ011c2ljLmZhZGVJbihDb21tb24uYmdNdXNpY1ZvbHVtZSwgNTAwKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuSW5zdHJ1Y3Rpb25zT3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkluc3RydWN0aW9uc092ZXJsYXkucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl9iZy5hbHBoYSA9IDA7XHJcblx0dGhpcy5fdGl0bGUuc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLjc1LCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fdGl0bGUuc2NhbGUsICAgICAgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5zY2FsZSwgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fY2xvc2VCdXR0b24uc2NhbGUsICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNik7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0LmNhbGwodGhpcyk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW59LCAgMCk7XHJcblx0XHR0bC50byh0aGlzLl90aXRsZS5zY2FsZSwgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkluc3RydWN0aW9uc092ZXJsYXkucHJvdG90eXBlLm9uUHJldiA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuX3NjcmVlbkluZGV4ID09IDApIHJldHVybjtcclxuXHJcblx0bmV4dFNjcmVlbiA9IHRoaXMuX3NjcmVlbkluZGV4LTE7XHJcblx0aWYobmV4dFNjcmVlbiA8IDApIG5leHRTY3JlZW4gPSB0aGlzLl9zY3JlZW5zLmxlbmd0aCAtMTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHR0bC50byh0aGlzLl9zY3JlZW5zW3RoaXMuX3NjcmVlbkluZGV4XSwgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fc2NyZWVuc1tuZXh0U2NyZWVuXSwgICAgICAgICAgIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cclxuXHRcdGlmKHRoaXMuX3NjcmVlbkluZGV4ID09IHRoaXMuX3NjcmVlbnMubGVuZ3RoLTEpXHJcblx0XHR7XHJcblx0XHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uLCAgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guX3JpZ2h0QnV0dG9uLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihuZXh0U2NyZWVuID09IDApXHJcblx0XHR7XHJcblx0XHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24sICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcblxyXG5cdHRoaXMuX3NjcmVlbkluZGV4ID0gbmV4dFNjcmVlbjtcclxufVxyXG5cclxuLyoqXHJcbiAqL1xyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbigpXHJcbntcclxuXHRpZih0aGlzLl9zY3JlZW5JbmRleCA9PSB0aGlzLl9zY3JlZW5zLmxlbmd0aC0xKSByZXR1cm47XHJcblxyXG5cdG5leHRTY3JlZW4gPSB0aGlzLl9zY3JlZW5JbmRleCsxO1xyXG5cdGlmKG5leHRTY3JlZW4gPj0gdGhpcy5fc2NyZWVucy5sZW5ndGgpIG5leHRTY3JlZW4gPSAwO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdHRsLnRvKHRoaXMuX3NjcmVlbnNbdGhpcy5fc2NyZWVuSW5kZXhdLCAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9zY3JlZW5zW25leHRTY3JlZW5dLCAgICAgICAgICAgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblxyXG5cdFx0aWYobmV4dFNjcmVlbiA9PSB0aGlzLl9zY3JlZW5zLmxlbmd0aC0xKVxyXG5cdFx0e1xyXG5cdFx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbiwgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Ll9yaWdodEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMuX3NjcmVlbkluZGV4ID09IDApXHJcblx0XHR7XHJcblx0XHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guX2xlZnRCdXR0b24sICAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5fbGVmdEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxuXHJcblx0dGhpcy5fc2NyZWVuSW5kZXggPSBuZXh0U2NyZWVuO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5JbnN0cnVjdGlvbnNPdmVybGF5LnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpXHJcbntcclxuXHRDb21tb24uc2F2ZWREYXRhLmhhc1NlZW5UdXRvcmlhbFt0aGlzLl93aGF0XSA9IHRydWU7XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XHJcblxyXG5cdHRoaXMuYW5pbWF0ZU91dChmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uZGlzcGF0Y2goKTtcclxuXHR9LCB0aGlzKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG52YXIgU2ltcGxlU2NyZWVuID0gcmVxdWlyZShcIi4uL3NjcmVlbnMvU2ltcGxlU2NyZWVuXCIpO1xudmFyIE5leHRCdXR0b24gICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL05leHRCdXR0b25cIik7XG52YXIgU291bmRTRlggICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XG52YXIgTXV0ZUJ1dHRvbiAgID0gcmVxdWlyZShcIi4uL2xpYi9NdXRlQnV0dG9uXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFBhdXNlT3ZlcmxheShsZXZlbClcbntcblx0U2ltcGxlU2NyZWVuLmNhbGwodGhpcyk7XG5cblx0dGhpcy5fbGV2ZWwgPSBsZXZlbDtcblx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZEN1cnJlbnRTY3JlZW4gPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcbn1cbm1vZHVsZS5leHBvcnRzID0gUGF1c2VPdmVybGF5O1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGF1c2VPdmVybGF5O1xuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQVUJMSUMgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcblx0Y29uc29sZS5sb2coXCJQQVVTRSBJTklUSUFMSVpFRFwiKTtcblxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcblxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHR0aGlzLl9iZy5hbHBoYSAgICAgICA9IDA7XG5cdHRoaXMuX2JnLndpZHRoICAgICAgID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xuXHR0aGlzLl9iZy5oZWlnaHQgICAgICA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuX2JnLmhpdEFyZWEgICAgID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XG5cdHRoaXMuX2JnLmludGVyYWN0aXZlID0gdHJ1ZTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9iZyk7XG5cblx0dGhpcy5fdGl0bGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV90aXRsZV9iZ1wiKSk7XG5cdHRoaXMuX3RpdGxlLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcblx0dGhpcy5fdGl0bGUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl90aXRsZS55ID0gMTAwO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcblxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiUEFVU0VcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XG5cblx0XHRpZighd2ViZm9udClcblx0XHR7XG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcblx0XHRcdHRpdGxlLnkgPSAtdGl0bGUudGV4dEhlaWdodC8yIC0gNDtcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLlRleHQoXCJQYXVzZVwiLCB7Zm9udDpcIjM2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdHRpdGxlLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcblx0XHRcdHRpdGxlLnkgPSAtNjtcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcblx0XHR9XG5cbiAgICB0aGlzLl9tZXNzYWdlQm94ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfYmdcIikpO1xuXHR0aGlzLl9tZXNzYWdlQm94IC5hbmNob3IgPSBuZXcgUElYSS5Qb2ludCgwLjUsIDAuNSk7XG5cdHRoaXMuX21lc3NhZ2VCb3ggLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcblx0dGhpcy5fbWVzc2FnZUJveCAueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIDcwO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCApO1xuXG5cdHZhciBjbG9zZUJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0KFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdXRcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X2Rvd25cIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NlY25hdl9jcm9zc1wiKVxuXHQpO1xuXHRjbG9zZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdGNsb3NlQnV0dG9uLnggPSByMmwgPyAtNDAwIDogNDAwO1xuICAgIGNsb3NlQnV0dG9uLnkgPSAtMjQwO1xuXHRjbG9zZUJ1dHRvbi5zaWduYWxzLmRvd24uYWRkT25jZSh0aGlzLnJlc3VtZUNsaWNrZWQsIHRoaXMpO1xuXHR0aGlzLl9tZXNzYWdlQm94IC5hZGRDaGlsZChjbG9zZUJ1dHRvbik7XG5cblxuXHR0aGlzLl9tYWluU2NyZWVuID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdHRoaXMuX21haW5TY3JlZW4ueSA9IC03MDtcblx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tYWluU2NyZWVuKTtcblxuXG5cdFx0Ly8gUGxheSBidXR0b25cblx0XHR0aGlzLl9tYWluU2NyZWVuLl9yZXN1bWVCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dF9iaWdcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3Zlcl9iaWdcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfZG93bl9iaWdcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X3BsYXlcIilcblx0XHQpO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX3Jlc3VtZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdW1lQnV0dG9uLnkgPSAtMjA7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdW1lQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5yZXN1bWVDbGlja2VkLCB0aGlzKTtcblx0XHR0aGlzLl9tYWluU2NyZWVuLmFkZENoaWxkKHRoaXMuX21haW5TY3JlZW4uX3Jlc3VtZUJ1dHRvbik7XG5cblx0XHR2YXIgaW1hZ2UgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2RlY29fMlwiKSk7XG5cdFx0aW1hZ2UuYW5jaG9yLnNldCgwLjUpO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX3Jlc3VtZUJ1dHRvbi5hZGRDaGlsZChpbWFnZSk7XG5cblx0XHQvLyBIb21lIGJ1dHRvblxuXHRcdHRoaXMuX21haW5TY3JlZW4uX2hvbWVCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X291dFwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdmVyXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X2Rvd25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X2hvbWVcIilcblx0XHQpO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX2hvbWVCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX2hvbWVCdXR0b24ueCA9IC0yMjU7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5faG9tZUJ1dHRvbi55ID0gKzE4MDtcblx0XHR0aGlzLl9tYWluU2NyZWVuLl9ob21lQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5ob21lU2NyZWVuQ2xpY2tlZCwgdGhpcyk7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5hZGRDaGlsZCh0aGlzLl9tYWluU2NyZWVuLl9ob21lQnV0dG9uKTtcblxuXHRcdC8vIFJlc3RhcnQgYnV0dG9uXG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdGFydEJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0XHQoXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfZG93blwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfcmVzdGFydFwiKVxuXHRcdCk7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdGFydEJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdGFydEJ1dHRvbi54ID0gLTc1O1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX3Jlc3RhcnRCdXR0b24ueSA9ICsxODA7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fcmVzdGFydEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMucmVzdGFydFNjcmVlbkNsaWNrZWQsIHRoaXMpO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uYWRkQ2hpbGQodGhpcy5fbWFpblNjcmVlbi5fcmVzdGFydEJ1dHRvbik7XG5cblx0XHQvLyBBdWRpbyBidXR0b25cblx0XHR0aGlzLl9tYWluU2NyZWVuLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cblx0XHQoXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3V0XCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X292ZXJcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfZG93blwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zZWNuYXZfc291bmRfb25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X3NvdW5kX29mZlwiKVxuXHRcdCk7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fbXV0ZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5fbXV0ZUJ1dHRvbi5pZCA9IFwibXV0ZVwiO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX211dGVCdXR0b24ueCA9ICs3NTtcblx0XHR0aGlzLl9tYWluU2NyZWVuLl9tdXRlQnV0dG9uLnkgPSArMTgwO1xuXHRcdC8vIHRoaXMuX21haW5TY3JlZW4uX211dGVCdXR0b24uc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcblx0XHQvLyB0aGlzLl9tdXRlQnV0dG9uLnNpZ25hbHMub3Zlci5hZGQodGhpcy5idXR0b25PdmVyLCB0aGlzKTtcblx0XHR0aGlzLl9tYWluU2NyZWVuLl9tdXRlQnV0dG9uLmluaXQoKTtcblx0XHR0aGlzLl9tYWluU2NyZWVuLmFkZENoaWxkKHRoaXMuX21haW5TY3JlZW4uX211dGVCdXR0b24pO1xuXG5cdFx0Ly8gSGVscCBidXR0b25cblx0XHR0aGlzLl9tYWluU2NyZWVuLl9oZWxwQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NlY25hdl9oZWxwXCIpXG5cdFx0KTtcblx0XHR0aGlzLl9tYWluU2NyZWVuLl9oZWxwQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHR0aGlzLl9tYWluU2NyZWVuLl9oZWxwQnV0dG9uLnggPSArMjI1O1xuXHRcdHRoaXMuX21haW5TY3JlZW4uX2hlbHBCdXR0b24ueSA9ICsxODA7XG5cdFx0dGhpcy5fbWFpblNjcmVlbi5faGVscEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMuaGVscFNjcmVlbkNsaWNrZWQsIHRoaXMpO1xuXHRcdHRoaXMuX21haW5TY3JlZW4uYWRkQ2hpbGQodGhpcy5fbWFpblNjcmVlbi5faGVscEJ1dHRvbik7XG5cblx0Ly8gSE9NRSBTQ1JFRU5cblx0dGhpcy5faG9tZVNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9ob21lU2NyZWVuLnkgPSAtNzA7XG5cdHRoaXMuX2hvbWVTY3JlZW4udmlzaWJsZSA9IGZhbHNlO1xuXHR0aGlzLl9ob21lU2NyZWVuLmFscGhhID0gMDtcblx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9ob21lU2NyZWVuKTtcblxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiUEFVU0VfRVhJVFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdGlmKCF3ZWJmb250KVxuXHRcdHtcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjM2cHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcblx0XHRcdHRpdGxlLnggPSAtIHRpdGxlLnRleHRXaWR0aC8yO1xuXHRcdFx0dGl0bGUueSA9IC0gdGl0bGUudGV4dEhlaWdodC8yO1xuXHRcdFx0dGhpcy5faG9tZVNjcmVlbi5hZGRDaGlsZCh0aXRsZSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGl0bGUuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xuXHRcdFx0dGl0bGUueSA9IC02O1xuXHRcdFx0dGhpcy5faG9tZVNjcmVlbi5hZGRDaGlsZCh0aXRsZSk7XG5cdFx0fVxuXG5cdFx0Ly8gSG9tZSBjb25maXJtIGJ1dHRvblxuXHRcdHRoaXMuX2hvbWVTY3JlZW4uX2hvbWVCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X3RpY2tcIilcblx0XHQpO1xuXHRcdHRoaXMuX2hvbWVTY3JlZW4uX2hvbWVCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX2hvbWVTY3JlZW4uX2hvbWVCdXR0b24ueCA9IChyMmwgPyAtMSA6IDEpICogMTI1O1xuXHRcdHRoaXMuX2hvbWVTY3JlZW4uX2hvbWVCdXR0b24ueSA9ICsxNjA7XG5cdFx0dGhpcy5faG9tZVNjcmVlbi5faG9tZUJ1dHRvbi5zaWduYWxzLmRvd24uYWRkT25jZSh0aGlzLmhvbWVDbGlja2VkLCB0aGlzKTtcblx0XHR0aGlzLl9ob21lU2NyZWVuLmFkZENoaWxkKHRoaXMuX2hvbWVTY3JlZW4uX2hvbWVCdXR0b24pO1xuXG5cdFx0Ly8gSG9tZSBjYW5jZWwgYnV0dG9uXG5cdFx0dGhpcy5faG9tZVNjcmVlbi5fcmVzdW1lQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9jcm9zc1wiKVxuXHRcdCk7XG5cdFx0dGhpcy5faG9tZVNjcmVlbi5fcmVzdW1lQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHR0aGlzLl9ob21lU2NyZWVuLl9yZXN1bWVCdXR0b24ueCA9IChyMmwgPyAtMSA6IDEpICogLTEyNTtcblx0XHR0aGlzLl9ob21lU2NyZWVuLl9yZXN1bWVCdXR0b24ueSA9ICsxNjA7XG5cdFx0dGhpcy5faG9tZVNjcmVlbi5fcmVzdW1lQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMucmVzdW1lQ2xpY2tlZCwgdGhpcyk7XG5cdFx0dGhpcy5faG9tZVNjcmVlbi5hZGRDaGlsZCh0aGlzLl9ob21lU2NyZWVuLl9yZXN1bWVCdXR0b24pO1xuXG5cblx0Ly8gUkVTVEFSVCBTQ1JFRU5cblx0dGhpcy5fcmVzdGFydFNjcmVlbiA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9yZXN0YXJ0U2NyZWVuLnkgPSAtNzA7XG5cdHRoaXMuX3Jlc3RhcnRTY3JlZW4udmlzaWJsZSA9IGZhbHNlO1xuXHR0aGlzLl9yZXN0YXJ0U2NyZWVuLmFscGhhID0gMDtcblx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9yZXN0YXJ0U2NyZWVuKTtcblxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiUEFVU0VfUkVTVEFSVFwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdGlmKCF3ZWJmb250KVxuXHRcdHtcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjM2cHggTWlrYWRhbiBXaGl0ZVwiLCBhbGlnbjogXCJjZW50ZXJcIiwgdGludDogMHg2ZDM4YWJ9KTtcblx0XHRcdHRpdGxlLnggPSAtIHRpdGxlLnRleHRXaWR0aC8yO1xuXHRcdFx0dGl0bGUueSA9IC0gdGl0bGUudGV4dEhlaWdodC8yO1xuXHRcdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5hZGRDaGlsZCh0aXRsZSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGl0bGUuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xuXHRcdFx0dGl0bGUueSA9IC02O1xuXHRcdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5hZGRDaGlsZCh0aXRsZSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmVzdGFydCBjb25maXJtIGJ1dHRvblxuXHRcdHRoaXMuX3Jlc3RhcnRTY3JlZW4uX3Jlc3RhcnRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X3RpY2tcIilcblx0XHQpO1xuXHRcdHRoaXMuX3Jlc3RhcnRTY3JlZW4uX3Jlc3RhcnRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX3Jlc3RhcnRTY3JlZW4uX3Jlc3RhcnRCdXR0b24ueCA9IChyMmwgPyAtMSA6IDEpICogMTI1O1xuXHRcdHRoaXMuX3Jlc3RhcnRTY3JlZW4uX3Jlc3RhcnRCdXR0b24ueSA9ICsxNjA7XG5cdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5fcmVzdGFydEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkT25jZSh0aGlzLnJlc3RhcnRDbGlja2VkLCB0aGlzKTtcblx0XHR0aGlzLl9yZXN0YXJ0U2NyZWVuLmFkZENoaWxkKHRoaXMuX3Jlc3RhcnRTY3JlZW4uX3Jlc3RhcnRCdXR0b24pO1xuXG5cdFx0Ly8gUmVzdGFydCBjYW5jZWwgYnV0dG9uXG5cdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5fcmVzdW1lQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9jcm9zc1wiKVxuXHRcdCk7XG5cdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5fcmVzdW1lQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHR0aGlzLl9yZXN0YXJ0U2NyZWVuLl9yZXN1bWVCdXR0b24ueCA9IChyMmwgPyAtMSA6IDEpICogLTEyNTtcblx0XHR0aGlzLl9yZXN0YXJ0U2NyZWVuLl9yZXN1bWVCdXR0b24ueSA9ICsxNjA7XG5cdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5fcmVzdW1lQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMucmVzdW1lQ2xpY2tlZCwgdGhpcyk7XG5cdFx0dGhpcy5fcmVzdGFydFNjcmVlbi5hZGRDaGlsZCh0aGlzLl9yZXN0YXJ0U2NyZWVuLl9yZXN1bWVCdXR0b24pO1xuXG5cdC8vIEhFTFAgU0NSRUVOXG5cdHRoaXMuX2hlbHBTY3JlZW4gPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0dGhpcy5faGVscFNjcmVlbi52aXNpYmxlID0gZmFsc2U7XG5cdHRoaXMuX2hlbHBTY3JlZW4uYWxwaGEgPSAwO1xuXHR0aGlzLl9oZWxwU2NyZWVuLnBhZ2UgID0gMDtcblx0dGhpcy5faGVscFNjcmVlbi5wYWdlcyA9IFtdO1xuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2hlbHBTY3JlZW4pO1xuXG5cdFx0Ly8gUHJldiBidXR0b25cblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRcIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9hcnJvd1wiKVxuXHRcdCk7XG5cdFx0dGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbi54ID0gLTM4Nztcblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uLnkgPSArMjEwO1xuXHRcdHRoaXMuX2hlbHBTY3JlZW4uX3ByZXZCdXR0b24uYWxwaGEgPSAwO1xuXHRcdHRoaXMuX2hlbHBTY3JlZW4uX3ByZXZCdXR0b24uaW50ZXJhY3RpdmUgPSBmYWxzZTtcblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5oZWxwUHJldkNsaWNrZWQsIHRoaXMpO1xuXHRcdHRoaXMuX2hlbHBTY3JlZW4uYWRkQ2hpbGQodGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbik7XG5cdFx0dGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbi5jaGlsZHJlblsxXS5zY2FsZS54ID0gLTE7XG5cdFx0dGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbi5jaGlsZHJlblsxXS54ID0gLTU7XG5cblx0XHQvLyBOZXh0IGJ1dHRvblxuXHRcdHRoaXMuX2hlbHBTY3JlZW4uX25leHRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0KFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X2Fycm93XCIpXG5cdFx0KTtcblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9uZXh0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9uZXh0QnV0dG9uLnggPSAzODc7XG5cdFx0dGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbi55ID0gKzIxMDtcblx0XHR0aGlzLl9oZWxwU2NyZWVuLl9uZXh0QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5oZWxwTmV4dENsaWNrZWQsIHRoaXMpO1xuXHRcdHRoaXMuX2hlbHBTY3JlZW4uYWRkQ2hpbGQodGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbik7XG5cdFx0XG5cdFx0aWYocjJsKVxuXHRcdHtcblx0XHRcdHRoaXMuX2hlbHBTY3JlZW4uX3ByZXZCdXR0b24uc2NhbGUuc2V0KC0xLDEpO1xuXHRcdFx0dGhpcy5faGVscFNjcmVlbi5fcHJldkJ1dHRvbi5wb3NpdGlvbi5zZXQoMzg3LCAyMTApO1xuXHRcdFx0dGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbi5zY2FsZS5zZXQoLTEsMSk7XG5cdFx0XHR0aGlzLl9oZWxwU2NyZWVuLl9uZXh0QnV0dG9uLnBvc2l0aW9uLnNldCgtMzg3LCAyMTApO1xuXHRcdH1cdFx0XG5cblx0XHQvLyBTY3JlZW5zXG5cdFx0dGhpcy5fY29udGVudCA9IFtdO1xuXHRcdFxuXHRcdGlmKHAzLkRldmljZS5pc01vYmlsZSlcblx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfaGVscF9nYW1lcGxheV9iZ1wiLCBcInVpX2hlbHBfZ2FtZXBsYXlfanVtcFwiLCBcInVpX2hlbHBfdGFwX2hpZ2hsaWdodF9yXCIsIFwidWlfaGVscF9nYW1lcGxheV9oYW5kX3JcIl0sIHRleHQ6XCJIRUxQX0dFTkVSSUNfMFwiICsgKHAzLkRldmljZS5pc01vYmlsZSA/IFwiX01PQlwiIDogXCJfUENcIil9KTtcblx0XHRlbHNlXG5cdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX2hlbHBfZ2FtZXBsYXlfYmdcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X2p1bXBcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X21vdXNlXCJdLCB0ZXh0OlwiSEVMUF9HRU5FUklDXzBcIiArIChwMy5EZXZpY2UuaXNNb2JpbGUgPyBcIl9NT0JcIiA6IFwiX1BDXCIpfSk7XG5cdFx0XG5cdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2dhbWVwbGF5X2JnXCIsIFwidWlfaGVscF9nYW1lcGxheV90dW1ibGVcIiwgXCJ1aV9oZWxwX3RhcF9oaWdobGlnaHRfclwiLCBcInVpX2hlbHBfZ2FtZXBsYXlfaGFuZF9yXCJdLCB0ZXh0OlwiSEVMUF9HRU5FUklDXzFcIiArIChwMy5EZXZpY2UuaXNNb2JpbGUgPyBcIl9NT0JcIiA6IFwiX1BDXCIpfSk7XG5cdFx0ZWxzZVxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2dhbWVwbGF5X2JnXCIsIFwidWlfaGVscF9nYW1lcGxheV90dW1ibGVcIixcInVpX2hlbHBfZ2FtZXBsYXlfbW91c2VcIl0sIHRleHQ6XCJIRUxQX0dFTkVSSUNfMVwiICsgKHAzLkRldmljZS5pc01vYmlsZSA/IFwiX01PQlwiIDogXCJfUENcIil9KTtcblxuXHRcdHN3aXRjaChDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcilcblx0XHR7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0Y2FzZSBcImFubmFcIjpcblx0XHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9hbm5hXCIsIFwidWlfaGVscF90YXBfaGlnaGxpZ2h0X3JcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X2hhbmRfclwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX0FOTkFfMFwifSk7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfYW5uYVwiLFwidWlfaGVscF9nYW1lcGxheV9tb3VzZVwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX0FOTkFfMFwifSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwia3Jpc3RvZmZcIjpcblx0XHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9rcmlzdG9mZlwiLCBcInVpX2hlbHBfdGFwX2hpZ2hsaWdodF9sXCIsIFwidWlfaGVscF9nYW1lcGxheV9oYW5kX2xcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl9LUklTVE9GRl8wXCJ9KTtcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9rcmlzdG9mZlwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlclwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX0tSSVNUT0ZGXzBcIn0pO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcIm9sYWZcIjpcblx0XHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9vbGFmXCIsIFwidWlfaGVscF90YXBfaGlnaGxpZ2h0X2xcIiwgXCJ1aV9oZWxwX2dhbWVwbGF5X2hhbmRfbFwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX09MQUZfMFwifSk7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfb2xhZlwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlcl9vbGFmXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfT0xBRl8wXCJ9KTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJlbHNhXCI6XG5cdFx0XHRcdGlmKHAzLkRldmljZS5pc01vYmlsZSlcblx0XHRcdFx0XHR0aGlzLl9jb250ZW50LnB1c2goe2ltYWdlOltcInVpX3R1dG9yaWFsX2JnXCIsIFwidWlfdHV0b3JpYWxfZWxzYVwiLCBcInVpX2hlbHBfdGFwX2hpZ2hsaWdodF9sXCIsIFwidWlfaGVscF9nYW1lcGxheV9oYW5kX2xcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl9FTFNBXzBcIn0pO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX2Vsc2FcIixcInVpX2hlbHBfZ2FtZXBsYXlfZW50ZXJcIl0sIHRleHQ6XCJIRUxQX0NIQVJBQ1RFUl9FTFNBXzBcIn0pO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJwYWJiaWVcIjpcblx0XHRcdFx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHRcdFx0XHRcdHRoaXMuX2NvbnRlbnQucHVzaCh7aW1hZ2U6W1widWlfdHV0b3JpYWxfYmdcIiwgXCJ1aV90dXRvcmlhbF9wYWJiaWVcIiwgXCJ1aV9oZWxwX3RhcF9oaWdobGlnaHRfbFwiLCBcInVpX2hlbHBfZ2FtZXBsYXlfaGFuZF9sXCJdLCB0ZXh0OlwiSEVMUF9DSEFSQUNURVJfUEFCQklFXzBcIn0pO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV90dXRvcmlhbF9iZ1wiLCBcInVpX3R1dG9yaWFsX3BhYmJpZVwiLFwidWlfaGVscF9nYW1lcGxheV9lbnRlclwiXSwgdGV4dDpcIkhFTFBfQ0hBUkFDVEVSX1BBQkJJRV8wXCJ9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2dhbWVwbGF5X2JnXCIsIFwidWlfaGVscF9nYW1lcGxheV9zdmVuX3NsZWRcIl0sIHRleHQ6XCJIRUxQX0dFTkVSSUNfM1wifSk7XG5cdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2dhbWVwbGF5X2JnXCIsIFwidWlfaGVscF9nYW1lcGxheV9tYXJzaG1hbGxvd1wiXSwgdGV4dDpcIkhFTFBfR0VORVJJQ180XCJ9KTtcblxuXHRcdGlmKCF0aGlzLl9sZXZlbC5lbmRsZXNzKVxuXHRcdFx0dGhpcy5fY29udGVudC5wdXNoKHtpbWFnZTpbXCJ1aV9oZWxwX2dhbWVwbGF5X2JnXCIsIFwidWlfaGVscF9nYW1lcGxheV9jcnlzdGFsc1wiXSwgdGV4dDpcIkhFTFBfU1RPUllfMFwifSk7XG5cblxuXG5cblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fY29udGVudC5sZW5ndGg7IGkrKylcblx0XHR7XG5cdFx0XHR2YXIgcGFnZSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHRcdFx0cGFnZS5hbHBoYSA9IChpID09IDApID8gMSA6IDA7XG5cdFx0XHR0aGlzLl9oZWxwU2NyZWVuLnBhZ2VzLnB1c2gocGFnZSk7XG5cdFx0XHR0aGlzLl9oZWxwU2NyZWVuLmFkZENoaWxkKHBhZ2UpO1xuXG5cdFx0XHRmb3IodmFyIG0gPSAwOyBtIDwgdGhpcy5fY29udGVudFtpXS5pbWFnZS5sZW5ndGg7IG0rKylcblx0XHRcdHtcblx0XHRcdFx0dmFyIGltYWdlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuX2NvbnRlbnRbaV0uaW1hZ2VbbV0pKTtcblx0XHRcdFx0aW1hZ2UuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHRpbWFnZS55ID0gLTMwO1xuXHRcdFx0XHRwYWdlLmFkZENoaWxkKGltYWdlKTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbdGhpcy5fY29udGVudFtpXS50ZXh0XVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdFx0aWYoIXdlYmZvbnQpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjJweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwiLCB0aW50OiAweDZkMzhhYn0pO1xuXHRcdFx0XHQvLyB0ZXh0Lm1heFdpZHRoID0gNjIwO1xuXHRcdFx0XHQvLyB0ZXh0LnVwZGF0ZVRleHQoKTtcblx0XHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiArIDE4MDtcblx0XHRcdFx0cGFnZS5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbdGhpcy5fY29udGVudFtpXS50ZXh0XVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHkucmVwbGFjZSgvXFxuL2dpLCBcIlwiKSwge2ZvbnQ6XCIyNHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInLCB3b3JkV3JhcDp0cnVlLCB3b3JkV3JhcFdpZHRoOjYyMH0pO1xuXHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcblx0XHRcdFx0dGV4dC55ID0gMTgwO1xuXHRcdFx0XHRwYWdlLmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHQvLyB0aGlzLl9jaGFyID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfY2hhcl9cIiArIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyKSk7XG5cdC8vIHRoaXMuX2NoYXIuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHQvLyB0aGlzLl9jaGFyLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMiAtIDM5MDtcblx0Ly8gdGhpcy5fY2hhci55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcblx0Ly8gdGhpcy5fY2hhci52aXNpYmxlID0gZmFsc2U7XG5cdC8vIHRoaXMuX2NoYXIuc2NhbGUueCA9IC0xO1xuXHQvLyB0aGlzLmFkZENoaWxkKHRoaXMuX2NoYXIpO1xuXG5cdENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgNTAwKTtcblx0Q29tbW9uLmJnTXVzaWMgPSBTb3VuZFNGWC5wbGF5KCdteF9mcm96ZW5fMDRfcGF1c2VfbHAnLCB7bG9vcDp0cnVlLCB2b2x1bWU6MH0pO1xuXHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDUwMCk7XG59O1xuXG4vKipcbiAqL1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXG57XG5cdC8vIHRoaXMuX2V4aXRCdXR0b24ueCA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCk7XG5cdC8vIHRoaXMuX211dGVCdXR0b24ueCA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCgpO1xufTtcblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xufTtcblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcbntcblxufVxuXG4vKipcbiAqL1xuIC8qXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLnNldEludHJvSGVscE1vZGUgPSBmdW5jdGlvbigpXG57XG5cdGlmKENvbW1vbi5zYXZlZERhdGEuaGFzVmlld2VkSW5zdHJ1Y3Rpb25zKSByZXR1cm47XG5cblx0aWYodGhpcy5fY29udGVudHMubGVuZ3RoID4gMSApXG5cdHtcblx0XHR0aGlzLl9yZXN1bWVCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xuXHR9XG4gICAgdGhpcy5faW50cm9IZWxwTW9kZSA9IHRydWU7XG59Ki9cblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19c2NvcGVcbiAqL1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdHRoaXMuX3RpdGxlLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XG5cdHRoaXMuX21haW5TY3JlZW4uX3Jlc3VtZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XG5cdHRoaXMuX21haW5TY3JlZW4uX2hvbWVCdXR0b24uc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xuXHR0aGlzLl9tYWluU2NyZWVuLl9yZXN0YXJ0QnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwwKTtcblx0dGhpcy5fbWFpblNjcmVlbi5fbXV0ZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XG5cdHRoaXMuX21haW5TY3JlZW4uX2hlbHBCdXR0b24uc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xuXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXG5cdFx0dGwudG8odGhpcy5fYmcsICAgICAgICAgIC41LCB7YWxwaGE6MC43NSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcblx0XHR0bC50byh0aGlzLl90aXRsZS5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcblxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XG5cdFx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLl9yZXN1bWVCdXR0b24uc2NhbGUsICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuMyk7XG5cdFx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLl9ob21lQnV0dG9uLnNjYWxlLCAgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNSk7XG5cdFx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLl9yZXN0YXJ0QnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNik7XG5cdFx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLl9tdXRlQnV0dG9uLnNjYWxlLCAgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNyk7XG5cdFx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLl9oZWxwQnV0dG9uLnNjYWxlLCAgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuOCk7XG5cblx0XHQvLyB0bC50byh0aGlzLl9jaGFyLCAgICAgICAgIC41LCB7YWxwaGE6MSwgeDogdGhpcy5fY2hhci54LCBlYXNlOlNpbmUuRWFzZUlufSwgMC4xKTtcblxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcblxuXHQvLyB0aGlzLl9jaGFyLnggPSAwO1xuXHQvLyB0aGlzLl9jaGFyLmFscGhhID0gMDtcbn07XG5cblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcblx0XHR0bC50byh0aGlzLl90aXRsZS5zY2FsZSwgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdFx0dGwudG8odGhpcy5fbWVzc2FnZUJveC5zY2FsZSwgLjUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sIDApO1xuXHRcdC8vIHRsLnRvKHRoaXMuX2NoYXIsICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgeDogMCwgZWFzZTpTaW5lLkVhc2VJbn0sMCk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgNTAwKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLmV4aXRHYW1lID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHQvLyB2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xuXHRcdC8vIHRsLnRvKHRoaXMuX292ZXJsYXksIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbn0sIDApO1xuXHQvLyBDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcblx0aWYoY2FsbGJhY2spIGNhbGxiYWNrLmNhbGwoc2NvcGUpO1xufTtcblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUklWQVRFIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4vKipcbiAqL1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5yZXN1bWVDbGlja2VkID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmFuaW1hdGVPdXQoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uZGlzcGF0Y2goKTtcblx0fSwgdGhpcyk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59O1xuXG4vKipcbiAqL1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5ob21lU2NyZWVuQ2xpY2tlZCA9IGZ1bmN0aW9uKClcbntcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XG5cdFx0dGwudG8odGhpcy5fbWFpblNjcmVlbiwgMC4yNSwge2FscGhhOjAsIGVhc2U6U2luZS5FYXNlSW4sIG9uQ29tcGxldGVTY29wZTp0aGlzLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7dGhpcy5faG9tZVNjcmVlbi52aXNpYmxlID0gdHJ1ZTsgdGhpcy5fbWFpblNjcmVlbi52aXNpYmxlID0gZmFsc2U7fX0sIDApO1xuXHRcdHRsLnRvKHRoaXMuX2hvbWVTY3JlZW4sIDAuMjUsIHthbHBoYToxLCBlYXNlOlNpbmUuRWFzZU91dH0pO1xuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcblxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcbn07XG5cbi8qKlxuICovXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLnJlc3RhcnRTY3JlZW5DbGlja2VkID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0XHR0bC50byh0aGlzLl9tYWluU2NyZWVuLCAgICAwLjI1LCB7YWxwaGE6MCwgZWFzZTpTaW5lLkVhc2VJbiwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLl9yZXN0YXJ0U2NyZWVuLnZpc2libGUgPSB0cnVlOyB0aGlzLl9tYWluU2NyZWVuLnZpc2libGUgPSBmYWxzZTt9fSwgMCk7XG5cdFx0dGwudG8odGhpcy5fcmVzdGFydFNjcmVlbiwgMC4yNSwge2FscGhhOjEsIGVhc2U6U2luZS5FYXNlT3V0fSk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufTtcblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuaGVscFNjcmVlbkNsaWNrZWQgPSBmdW5jdGlvbigpXG57XG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXHRcdHRsLnRvKHRoaXMuX21haW5TY3JlZW4sIDAuMjUsIHthbHBoYTowLCBlYXNlOlNpbmUuRWFzZUluLCBvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuX2hlbHBTY3JlZW4udmlzaWJsZSA9IHRydWU7IHRoaXMuX21haW5TY3JlZW4udmlzaWJsZSA9IGZhbHNlO319LCAwKTtcblx0XHR0bC50byh0aGlzLl9oZWxwU2NyZWVuLCAwLjI1LCB7YWxwaGE6MSwgZWFzZTpTaW5lLkVhc2VPdXR9KTtcblx0XHQvLyB0bC50byh0aGlzLl9jaGFyLCAwLjUsIHthbHBoYTowLCB4OiAwLCBlYXNlOlNpbmUuRWFzZUlufSwwKTtcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59O1xuXG5cbi8qKlxuICovXG5QYXVzZU92ZXJsYXkucHJvdG90eXBlLmhvbWVDbGlja2VkID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmV4aXRHYW1lKGZ1bmN0aW9uKClcblx0e1xuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwYXRjaCgpO1xuXHR9LCB0aGlzKTtcblxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcbn07XG5cblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUucmVzdGFydENsaWNrZWQgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuZXhpdEdhbWUoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZEN1cnJlbnRTY3JlZW4uZGlzcGF0Y2goKTtcblx0fSwgdGhpcyk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59O1xuXG4vKipcbiAqL1xuUGF1c2VPdmVybGF5LnByb3RvdHlwZS5oZWxwUHJldkNsaWNrZWQgPSBmdW5jdGlvbigpXG57XG5cdGlmKHRoaXMuX2hlbHBTY3JlZW4ucGFnZSA9PSAwKSByZXR1cm47XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG5cblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XG5cblx0XHR0bC50byh0aGlzLl9oZWxwU2NyZWVuLnBhZ2VzW3RoaXMuX2hlbHBTY3JlZW4ucGFnZV0sIDAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5FYXNlSW5PdXR9LCAwKTtcblx0XHR0bC50byh0aGlzLl9oZWxwU2NyZWVuLnBhZ2VzW3RoaXMuX2hlbHBTY3JlZW4ucGFnZS0xXSwgMC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLkVhc2VJbk91dH0sIDApO1xuXG5cdFx0aWYodGhpcy5faGVscFNjcmVlbi5wYWdlID09IHRoaXMuX2hlbHBTY3JlZW4ucGFnZXMubGVuZ3RoLTEpXG5cdFx0e1xuXHRcdFx0dGwudG8odGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbiwgMC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLkVhc2VJbk91dCwgb25Db21wbGV0ZVNjb3BlOnRoaXMuX2hlbHBTY3JlZW4uX25leHRCdXR0b24sIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLmludGVyYWN0aXZlID0gdHJ1ZX19LCAwKTtcblx0XHR9XG5cdFx0ZWxzZSBpZih0aGlzLl9oZWxwU2NyZWVuLnBhZ2UgPT0gMSlcblx0XHR7XG5cdFx0XHR0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uLmludGVyYWN0aXZlID0gZmFsc2U7XG5cdFx0XHR0bC50byh0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uLCAwLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuRWFzZUluT3V0fSwgMCk7XG5cdFx0fVxuXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdHRoaXMuX2hlbHBTY3JlZW4ucGFnZS0tO1xufTtcblxuLyoqXG4gKi9cblBhdXNlT3ZlcmxheS5wcm90b3R5cGUuaGVscE5leHRDbGlja2VkID0gZnVuY3Rpb24oKVxue1xuXHRpZih0aGlzLl9oZWxwU2NyZWVuLnBhZ2UgPT0gdGhpcy5faGVscFNjcmVlbi5wYWdlcy5sZW5ndGgtMSkgcmV0dXJuO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xuXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXG5cdFx0dGwudG8odGhpcy5faGVscFNjcmVlbi5wYWdlc1t0aGlzLl9oZWxwU2NyZWVuLnBhZ2VdLCAwLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuRWFzZUluT3V0fSwgMCk7XG5cdFx0dGwudG8odGhpcy5faGVscFNjcmVlbi5wYWdlc1t0aGlzLl9oZWxwU2NyZWVuLnBhZ2UrMV0sIDAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5FYXNlSW5PdXR9LCAwKTtcblxuXHRcdGlmKHRoaXMuX2hlbHBTY3JlZW4ucGFnZSA9PSAwKVxuXHRcdHtcblx0XHRcdHRsLnRvKHRoaXMuX2hlbHBTY3JlZW4uX3ByZXZCdXR0b24sIDAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5FYXNlSW5PdXQsIG9uQ29tcGxldGVTY29wZTp0aGlzLl9oZWxwU2NyZWVuLl9wcmV2QnV0dG9uLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7dGhpcy5pbnRlcmFjdGl2ZSA9IHRydWV9fSwgMCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYodGhpcy5faGVscFNjcmVlbi5wYWdlID09IHRoaXMuX2hlbHBTY3JlZW4ucGFnZXMubGVuZ3RoLTIpXG5cdFx0e1xuXHRcdFx0dGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbi5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXHRcdFx0dGwudG8odGhpcy5faGVscFNjcmVlbi5fbmV4dEJ1dHRvbiwgMC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLkVhc2VJbk91dH0sIDApO1xuXHRcdH1cblxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcblxuXHR0aGlzLl9oZWxwU2NyZWVuLnBhZ2UrKztcblxufTtcblxuXG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEdFVFRFUlMvU0VUVEVSU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4iLCJ2YXIgQ29tbW9uICAgICAgIFx0XHQ9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gXHRcdD0gcmVxdWlyZShcIi4uL3NjcmVlbnMvU2ltcGxlU2NyZWVuXCIpO1xyXG52YXIgV2lyZWZyYW1lQnV0dG9uIFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9XaXJlZnJhbWVCdXR0b25cIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gUG93ZXJ1cFB1cmNoYXNlT3ZlcmxheShwcmV2aW91c1NjcmVlbiwgY29zdClcclxue1xyXG5cdHRoaXMuX3ByZXZTY3JlZW4gID0gcHJldmlvdXNTY3JlZW47XHJcblx0dGhpcy5fY29zdCAgICAgICAgPSBjb3N0O1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSBudWxsO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQb3dlcnVwUHVyY2hhc2VPdmVybGF5O1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcblBvd2VydXBQdXJjaGFzZU92ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUG93ZXJ1cFB1cmNoYXNlT3ZlcmxheTtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemF0aW9uXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG5cdC8vIEJnXHJcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFja1NxdWFyZSddKTtcclxuXHR0aGlzLl9iZy5hbHBoYSAgICAgICA9IDAuNzU7XHJcblx0dGhpcy5fYmcud2lkdGggICAgICAgPSBDb21tb24uU1RBR0VfV0lEVEg7XHJcblx0dGhpcy5fYmcuaGVpZ2h0ICAgICAgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG5cdHRoaXMuX2JnLmhpdEFyZWEgICAgID0gbmV3IFBJWEkuUmVjdGFuZ2xlKDAsIDAsIENvbW1vbi5TVEFHRV9XSURUSCwgQ29tbW9uLlNUQUdFX0hFSUdIVCk7XHJcblx0dGhpcy5fYmcuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHQvLyBQYW5lbCBiYWNrZ3JvdW5kXHJcbiAgICB0aGlzLl9tZXNzYWdlQm94ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfYmdcIikpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guYW5jaG9yLnNldCgwLjUpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3gucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSC8yLCBDb21tb24uU1RBR0VfSEVJR0hULzIpO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94KTtcclxuXHJcblx0XHR2YXIgYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9zbm93Zmxha2VzX2JnXCIpKTtcclxuXHRcdGJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdGJnLnBvc2l0aW9uLnNldCgwLCAtNDApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZChiZyk7XHJcblxyXG5cdFx0Ly8gQ29zdFxyXG5cdFx0dmFyIGNvcHkgPSBcIi1cIiArIHRoaXMuX2Nvc3Q7XHJcblx0XHRcclxuXHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNTZweCBTdXBlcmNsYXJlbmRvbiBOdW1iZXJzXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHRcclxuXHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMiAtIDEwO1xyXG5cdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiAtIDYyO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0ZXh0KTtcclxuXHJcblx0XHQvLyB2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoXCItXCIgKyB0aGlzLl9jb3N0LCB7Zm9udDpcIjQ4cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuXHRcdC8vIHRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0Ly8gdGV4dC5wb3NpdGlvbi5zZXQoLTEwLCAtNjUpO1xyXG5cdFx0Ly8gdGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcclxuXHJcblx0XHQvLyBBcmUgeW91IHN1cmU/XHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkFSRV9ZT1VfU1VSRVwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHRcdFxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDBweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwiLCB0aW50OiAweDZkMzhhYn0pO1x0XHJcblx0XHRcdHRleHQueCA9IC0gdGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGV4dC55ID0gLSB0ZXh0LnRleHRIZWlnaHQvMiArIDEwMDtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0ZXh0KTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0dGV4dC5wb3NpdGlvbi5zZXQoMCwgOTApO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRleHQpO1xyXG5cdFx0fVxyXG5cclxuXHQvLyBDYW5jZWwgYnV0dG9uXHJcblx0dGhpcy5fY2xvc2VCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0KFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X2Nyb3NzXCIpXHJcblx0KTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24ucG9zaXRpb24uc2V0KC0xNTAsIDIwMCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlQ2xpY2ssIHRoaXMpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fY2xvc2VCdXR0b24pO1xyXG5cclxuXHQvLyBDb25maXJtIGJ1dHRvblxyXG5cdHRoaXMuX2J1eUJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X292ZXJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfdGlja1wiKVxyXG5cdCk7XHJcblx0dGhpcy5fYnV5QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLl9idXlCdXR0b24ucG9zaXRpb24uc2V0KDE1MCwgMjAwKTtcclxuXHR0aGlzLl9idXlCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkJ1eUNsaWNrLCB0aGlzKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2J1eUJ1dHRvbik7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcblBvd2VydXBQdXJjaGFzZU92ZXJsYXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcbn1cclxuXHJcbi8qKlxyXG4gKi9cclxuUG93ZXJ1cFB1cmNoYXNlT3ZlcmxheS5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fYmcuYWxwaGEgPSAwO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3guc2NhbGUuc2V0KDApO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLnNldCgwKTtcclxuXHR0aGlzLl9idXlCdXR0b24uc2NhbGUuc2V0KDApO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xyXG5cdFx0dGwudG8odGhpcy5fYmcsICAgICAgICAgICAgICAgICAuNSwge2FscGhhOjAuNzUsIGVhc2U6U2luZS5lYXNlT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9jbG9zZUJ1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMC41KTtcclxuXHRcdHRsLnRvKHRoaXMuX2J1eUJ1dHRvbi5zY2FsZSwgICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwLjYpO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0LmNhbGwodGhpcyk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW59LCAgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQUklWQVRFIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRVZFTlRTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogUHVyY2hhc2UgY2FuY2VsXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpXHJcbntcdFxyXG5cdHRoaXMuYW5pbWF0ZU91dChmdW5jdGlvbigpXHJcblx0e1xyXG5cdFx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmRpc3BhdGNoKCk7XHJcblx0fSwgdGhpcyk7XHJcblx0XHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHRcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBQdXJjaGFzZSBjb25maXJtXHJcbiAqL1xyXG5Qb3dlcnVwUHVyY2hhc2VPdmVybGF5LnByb3RvdHlwZS5vbkJ1eUNsaWNrID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5fcHJldlNjcmVlbi5idXkoKTtcclxuXHJcblx0dGhpcy5hbmltYXRlT3V0KGZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcclxuXHR9LCB0aGlzKTtcclxuXHRcclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4iLCJ2YXIgQ29tbW9uICAgICAgIFx0XHQ9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gXHRcdD0gcmVxdWlyZShcIi4uL3NjcmVlbnMvU2ltcGxlU2NyZWVuXCIpO1xyXG52YXIgV2lyZWZyYW1lQnV0dG9uIFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9XaXJlZnJhbWVCdXR0b25cIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvU291bmRTRlhcIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gUHJvbW9PdmVybGF5KClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xyXG5cclxuXHQvLyBQaWNrIG9uZSBwcm9tbyBhdCByYW5kb21cclxuXHR0aGlzLl9wcm9tb0RhdGEgPSBDb21tb24uc2F2ZWREYXRhLmdldE5ld1Byb21vKCk7XHJcblxyXG5cdHRoaXMuc2lnbmFscy5saW5rQ2xpY2sgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcm9tb092ZXJsYXk7XHJcblByb21vT3ZlcmxheS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5Qcm9tb092ZXJsYXkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHJvbW9PdmVybGF5O1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICovXHJcblByb21vT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHQvLyBCYWNrZ3JvdW5kXHJcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWyd3aGl0ZVNxdWFyZSddKTtcclxuXHR0aGlzLl9iZy5hbHBoYSAgID0gMC43NTtcclxuXHR0aGlzLl9iZy53aWR0aCAgID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xyXG5cdHRoaXMuX2JnLmhlaWdodCAgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG5cdHRoaXMuX2JnLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuXHR0aGlzLl9iZy50aW50ICAgID0gMHgyYzNhNjY7XHJcblx0dGhpcy5fYmcuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHQvLyBUaXRsZVxyXG5cdHRoaXMuX3RpdGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdGl0bGVfYmdcIikpO1xyXG5cdHRoaXMuX3RpdGxlLmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl90aXRsZS54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzI7XHJcblx0dGhpcy5fdGl0bGUueSA9IDEwMDtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX3Byb21vRGF0YS50aXRsZTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDJweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGl0bGUueSA9IC10aXRsZS50ZXh0SGVpZ2h0LzIgLSA0O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRpdGxlLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdFx0dGl0bGUueSA9IC02O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblxyXG5cdC8vIFBhbmVsIGJhY2tncm91bmRcclxuICAgIHRoaXMuX21lc3NhZ2VCb3ggPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9iZ1wiKSk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIDcwKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCk7XHJcblxyXG5cdC8vIHRoaXMuX21lc3NhZ2VCb3gueSAtPSA3MDtcclxuXHJcblx0XHR2YXIgcHJvbW8gPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQocHJvbW8pO1xyXG5cclxuXHRcdHByb21vLmltYWdlID0gbmV3IFBJWEkuU3ByaXRlKFBJWEkuVGV4dHVyZS5mcm9tSW1hZ2UoJ2Fzc2V0cy9pbWFnZXMvaGQvY29tbXMvJyArIHRoaXMuX3Byb21vRGF0YS5pbWFnZSkpO1xyXG5cdFx0cHJvbW8uaW1hZ2UuYW5jaG9yLnNldCgwLjUsIDApO1xyXG5cdFx0cHJvbW8uaW1hZ2UueSA9IC0yMDU7XHJcblx0XHRwcm9tby5pbWFnZS5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0XHRwcm9tby5pbWFnZS5idXR0b25Nb2RlID0gdHJ1ZTtcclxuXHRcdHByb21vLmFkZENoaWxkKHByb21vLmltYWdlKTtcclxuXHJcblx0XHRwcm9tby5pbWFnZS50b3VjaHN0YXJ0ID0gcHJvbW8uaW1hZ2UubW91c2Vkb3duID0gZnVuY3Rpb24oZSlcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5vblByb21vQ2xpY2soKTtcclxuXHRcdH0uYmluZCh0aGlzKTtcclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX3Byb21vRGF0YS50ZXh0O1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHRwcm9tby50ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjhweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwiLCB0aW50OiAweDZkMzhhYn0pO1xyXG5cdFx0XHRwcm9tby50ZXh0Lm1heFdpZHRoID0gNjIwO1xyXG5cdFx0XHRwcm9tby50ZXh0LnVwZGF0ZVRleHQoKTtcclxuXHRcdFx0cHJvbW8udGV4dC54ID0gLXByb21vLnRleHQudGV4dFdpZHRoLzI7XHJcblx0XHRcdHByb21vLnRleHQueSA9IC1wcm9tby50ZXh0LnRleHRIZWlnaHQvMiArIDE3MDtcclxuXHRcdFx0cHJvbW8uYWRkQ2hpbGQocHJvbW8udGV4dCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHByb21vLnRleHQgPSBuZXcgUElYSS5UZXh0KHRoaXMuX3Byb21vRGF0YS50ZXh0LCB7Zm9udDpcIjI4cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NTQwfSk7XHJcblx0XHRcdHByb21vLnRleHQuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRwcm9tby50ZXh0LnkgPSAxNzA7XHJcblx0XHRcdHByb21vLmFkZENoaWxkKHByb21vLnRleHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHByb21vLmxpbmsgPSBuZXcgUElYSS5UZXh0KHRoaXMuX3Byb21vRGF0YS51cmwucmVwbGFjZShcImh0dHBzOi8vXCIsIFwiXCIpLnJlcGxhY2UoXCJodHRwOi8vXCIsIFwiXCIpLCB7Zm9udDpcIjI4cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcicsIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NDAwfSk7XHJcblx0XHQvLyBwcm9tby5saW5rLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdC8vIHByb21vLmxpbmsueSA9IDE5MjtcclxuXHRcdC8vIHByb21vLmxpbmsuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdFx0Ly8gcHJvbW8ubGluay5idXR0b25Nb2RlID0gdHJ1ZTtcclxuXHRcdC8vIHByb21vLmFkZENoaWxkKHByb21vLmxpbmspO1xyXG5cclxuXHRcdC8vIHByb21vLmxpbmsudG91Y2hzdGFydCA9IHByb21vLmxpbmsubW91c2Vkb3duID0gZnVuY3Rpb24oZSlcclxuXHRcdC8vIHtcclxuXHRcdFx0Ly8gdGhpcy5vblByb21vQ2xpY2soKTtcclxuXHRcdC8vIH0uYmluZCh0aGlzKTtcclxuXHJcblx0XHQvLyB0aGlzLl9saW5rQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0Ly8gKFxyXG5cdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3V0XCIpLFxyXG5cdFx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcclxuXHRcdFx0Ly8gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25cIiksXHJcblx0XHRcdC8vIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfYXJyb3dcIilcclxuXHRcdC8vICk7XHJcblx0XHQvLyB0aGlzLl9saW5rQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHRcdC8vIHRoaXMuX2xpbmtCdXR0b24ucG9zaXRpb24uc2V0KDMzMCwgMTAwKTtcclxuXHRcdC8vIHRoaXMuX2xpbmtCdXR0b24uc2lnbmFscy51cC5hZGQodGhpcy5vblByb21vQ2xpY2ssIHRoaXMpO1xyXG5cdFx0Ly8gcHJvbW8uYWRkQ2hpbGQodGhpcy5fbGlua0J1dHRvbik7XHJcblxyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdXRcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zZWNuYXZfb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NlY25hdl9jcm9zc1wiKVxyXG5cdCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnggPSByMmwgPyAtNDAwIDogNDAwO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24ueSA9IC0yNDA7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlLCB0aGlzKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX2Nsb3NlQnV0dG9uKTtcclxuXHJcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZS5zZXQoMCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2NhbGUuc2V0KDApO1xyXG5cclxuXHQvLyBEb24ndCBzaG93IGFnYWluXHJcblx0Q29tbW9uLnNhdmVkRGF0YS5zZXRQcm9tb0FzU2hvd24odGhpcy5fcHJvbW9EYXRhKTtcclxuXHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuUHJvbW9PdmVybGF5LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXHJcbntcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuUHJvbW9PdmVybGF5LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuUHJvbW9PdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5Qcm9tb092ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdC8vIERpcnR5IGZpeFxyXG5cdGlmKCEhdGhpcy5zaG93bikgcmV0dXJuO1xyXG5cdHRoaXMuc2hvd24gPSB0cnVlO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl90aXRsZS5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cclxuXHR0aGlzLl9iZy5hbHBoYSA9IDA7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLjc1LCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fdGl0bGUuc2NhbGUsICAgICAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNik7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG5Qcm9tb092ZXJsYXkucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcclxuXHJcblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcclxuXHRcdHRsLnRvKHRoaXMuX2JnLCAgICAgICAgICAgICAgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbn0sICAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX3RpdGxlLnNjYWxlLCAgICAgIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsIC41LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxufTtcclxuXHJcblxyXG4vKipcclxuICovXHJcblByb21vT3ZlcmxheS5wcm90b3R5cGUub25Qcm9tb0NsaWNrID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gRXZlbnQgVHJhY2tpbmdcclxuXHQvLyBDb21tb24uY3Rvdy50cmFja0V2ZW50KFxyXG5cdC8vIHtcclxuXHRcdC8vIGV2ZW50ICAgICAgOiBcImdhbWVfYWN0aW9uXCIsXHJcblx0XHQvLyBnYW1lX3RpZXIxIDogXCJjb21fc2NyZWVuXCIsXHJcblx0XHQvLyBnYW1lX3RpZXIyIDogXCJzbGlkZVwiICsgKHRoaXMuX2N1cnJlbnRjb21tKzEpXHJcblx0Ly8gfSk7XHJcblxyXG5cdC8vIE9wZW4gYSBuZXcgd2luZG93XHJcblx0Ly8gdmFyIHdpbiA9IHdpbmRvdy5vcGVuKHRoaXMuX3Byb21vRGF0YS51cmwsICdfc3lzdGVtJyk7XHJcblx0Ly8gd2luLmZvY3VzKCk7XHJcblxyXG5cdHRoaXMuc2lnbmFscy5saW5rQ2xpY2suZGlzcGF0Y2godGhpcy5fcHJvbW9EYXRhLnVybCwgISF0aGlzLl9wcm9tb0RhdGEuZGlzbmV5KTtcclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuUHJvbW9PdmVybGF5LnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5hbmltYXRlT3V0KGZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcclxuXHR9LCB0aGlzKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIiwidmFyIENvbW1vbiAgICAgICBcdFx0PSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU2ltcGxlU2NyZWVuIFx0XHQ9IHJlcXVpcmUoXCIuLi9zY3JlZW5zL1NpbXBsZVNjcmVlblwiKTtcclxudmFyIFdpcmVmcmFtZUJ1dHRvbiBcdD0gcmVxdWlyZShcIi4uL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIFJld2FyZE92ZXJsYXkoY29udGVudCwgY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcbiAgICB0aGlzLl9jb250ZW50ID0gY29udGVudDtcclxuICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgICB0aGlzLl9zY29wZSA9IHNjb3BlO1xyXG5cclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gbnVsbDtcclxuXHJcblx0U2ltcGxlU2NyZWVuLmNhbGwodGhpcyk7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUmV3YXJkT3ZlcmxheTtcclxuUmV3YXJkT3ZlcmxheS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5SZXdhcmRPdmVybGF5LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFJld2FyZE92ZXJsYXk7XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKi9cclxuUmV3YXJkT3ZlcmxheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHQvLyBCYWNrZ3JvdW5kXHJcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWyd3aGl0ZVNxdWFyZSddKTtcclxuXHR0aGlzLl9iZy5hbHBoYSAgID0gMC43NTtcclxuXHR0aGlzLl9iZy53aWR0aCAgID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xyXG5cdHRoaXMuX2JnLmhlaWdodCAgPSBDb21tb24uU1RBR0VfSEVJR0hUO1xyXG5cdHRoaXMuX2JnLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgQ29tbW9uLlNUQUdFX1dJRFRILCBDb21tb24uU1RBR0VfSEVJR0hUKTtcclxuXHR0aGlzLl9iZy50aW50ICAgID0gMHgyYzNhNjY7XHJcblx0dGhpcy5fYmcuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHQvLyBUaXRsZVxyXG5cdHRoaXMuX3RpdGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdGl0bGVfYmdcIikpO1xyXG5cdHRoaXMuX3RpdGxlLmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl90aXRsZS54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzI7XHJcblx0dGhpcy5fdGl0bGUueSA9IDEwMDtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlNVUlBSSVNFXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCI0MnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aXRsZS54ID0gLXRpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aXRsZS55ID0gLXRpdGxlLnRleHRIZWlnaHQvMiAtIDQ7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuVGV4dChjb3B5LCB7Zm9udDpcIjM2cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcclxuXHRcdFx0dGl0bGUuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aXRsZS55ID0gLTY7XHJcblx0XHRcdHRoaXMuX3RpdGxlLmFkZENoaWxkKHRpdGxlKTtcclxuXHRcdH1cclxuXHJcblx0Ly8gUGFuZWwgYmFja2dyb3VuZFxyXG4gICAgdGhpcy5fbWVzc2FnZUJveCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3BvcHVwX2JnXCIpKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LmFuY2hvci5zZXQoMC41KTtcclxuXHR0aGlzLl9tZXNzYWdlQm94LnBvc2l0aW9uLnNldChDb21tb24uU1RBR0VfV0lEVEgvMiwgQ29tbW9uLlNUQUdFX0hFSUdIVC8yICsgNzApO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94KTtcclxuXHJcblx0XHR2YXIgYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9zbm93Zmxha2VzX2JnXCIpKTtcclxuXHRcdGJnLmFuY2hvci5zZXQoMC41KTtcclxuXHRcdGJnLnBvc2l0aW9uLnNldCgwLCAtNDApO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZChiZyk7XHJcblxyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KFwiXCIgKyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5sb3NzU3RyZWFrLnJld2FyZCwge2ZvbnQ6IFwiNTZweCBTdXBlcmNsYXJlbmRvbiBOdW1iZXJzXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnggPSAtIHRoaXMuX21lc3NhZ2VCb3gudmFsdWUudGV4dFdpZHRoLzI7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnkgPSAtIHRoaXMuX21lc3NhZ2VCb3gudmFsdWUudGV4dEhlaWdodC8yIC0gNjI7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX21lc3NhZ2VCb3gudmFsdWUpO1xyXG5cclxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiUkVXQVJEX01FU1NBR0VcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHRjb3B5ID0gY29weS5yZXBsYWNlKFwie3ZhbHVlfVwiLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5sb3NzU3RyZWFrLnJld2FyZCk7XHJcblxyXG5cdFx0aWYoIXdlYmZvbnQpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjM2cHggU3VwZXJjbGFyZW5kb24gVGl0bGUgUHVycGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS54ID0gLSB0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dFdpZHRoLzI7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS55ID0gLSB0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dEhlaWdodC8yICsgMTQwO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94LmFkZENoaWxkKHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS5wb3NpdGlvbi5zZXQoMCwgMTUwKTtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UpO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0dGhpcy5fY2xvc2VCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0KFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X2Rvd25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X2Nyb3NzXCIpXHJcblx0KTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi54ID0gcjJsID8gLTQwMCA6IDQwMDtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnkgPSAtMjQwO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGRPbmNlKHRoaXMub25DbG9zZSwgdGhpcyk7XHJcblx0dGhpcy5fbWVzc2FnZUJveCAuYWRkQ2hpbGQodGhpcy5fY2xvc2VCdXR0b24pO1xyXG5cclxuXHR0aGlzLl9tZXNzYWdlQm94LnNjYWxlLnNldCgwKTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi5zY2FsZS5zZXQoMCk7XHJcblxyXG5cdC8vIEFjdHVhbCByZXdhcmRcclxuXHRDb21tb24uc2F2ZWREYXRhLmNvaW5zICs9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLmxvc3NTdHJlYWsucmV3YXJkO1xyXG5cdENvbW1vbi5zYXZlZERhdGEubG9zc1N0cmVhay5hd2FyZGVkID0gdHJ1ZTtcclxuXHRDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuUmV3YXJkT3ZlcmxheS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcblJld2FyZE92ZXJsYXkucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqL1xyXG5SZXdhcmRPdmVybGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG5SZXdhcmRPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLl90aXRsZS5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAsMCk7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2NhbGUgPSBuZXcgUElYSS5Qb2ludCgwLDApO1xyXG5cclxuXHR0aGlzLl9iZy5hbHBoYSA9IDA7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAgLjUsIHthbHBoYTowLjc1LCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cdFx0dGwudG8odGhpcy5fdGl0bGUuc2NhbGUsICAgICAgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAwKTtcclxuXHRcdHRsLnRvKHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDAuNik7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG5SZXdhcmRPdmVybGF5LnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0LmNhbGwodGhpcyk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XHJcblx0XHR0bC50byh0aGlzLl9iZywgICAgICAgICAgICAgICAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW59LCAgMCk7XHJcblx0XHR0bC50byh0aGlzLl90aXRsZS5zY2FsZSwgICAgICAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0XHR0bC50byh0aGlzLl9tZXNzYWdlQm94LnNjYWxlLCAuNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XHJcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblJld2FyZE92ZXJsYXkucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLmFuaW1hdGVPdXQoZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwYXRjaCgpO1xyXG5cdH0sIHRoaXMpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgXHRcdCA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gXHRcdCA9IHJlcXVpcmUoXCIuL1NpbXBsZVNjcmVlblwiKTtcclxudmFyIFdpcmVmcmFtZUJ1dHRvbiBcdCA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcclxudmFyIENoYXJhY3RlclNlbGVjdFBhbmVsID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvQ2hhcmFjdGVyU2VsZWN0UGFuZWxcIik7XHJcbnZhciBTb3VuZFNGWCAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09OU1RSVUNUT1JcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIENoYXJhY3RlclNlbGVjdFNjcmVlbihsZXZlbClcclxue1xyXG5cdHRoaXMuX2xldmVsID0gISFsZXZlbCA/IGxldmVsIDogMDtcclxuXHJcblx0dGhpcy5fY2hhcmFjdGVySG9sZGVyICA9IG51bGw7XHJcblx0dGhpcy5fY2hhcmFjdGVyUGFuZWxzICA9IFtdO1xyXG4gICAgdGhpcy5fY3VycmVudENoYXJhY3RlciA9IDA7XHJcblx0dGhpcy5faXNBbmltYXRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLl9sZWZ0QnV0dG9uICAgID0gbnVsbDtcclxuICAgIHRoaXMuX3JpZ2h0QnV0dG9uICAgPSBudWxsO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5zaWduYWxzLmJ1eVByZXNzZWQgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxuXHR0aGlzLnNpZ25hbHMuY2hhcmFjdGVyVW5sb2NrZWQgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDaGFyYWN0ZXJTZWxlY3RTY3JlZW47XHJcbkNoYXJhY3RlclNlbGVjdFNjcmVlbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xyXG5DaGFyYWN0ZXJTZWxlY3RTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hhcmFjdGVyU2VsZWN0U2NyZWVuO1xyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVQkxJQyBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6YXRpb25cclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFNjcmVlbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHQvLyBTaG93IHVubG9ja2VkIGNoYXJhY3RlclxyXG5cdC8vIENvbW1vbi5zYXZlZERhdGEuc2hvd1VubG9ja2VkQ2hhcmFjdGVyID0gXCJvbGFmXCI7IC8vIERFQlVHXHJcblx0aWYoISFDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZENoYXJhY3RlcilcclxuXHR7XHJcblx0XHRDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9IENvbW1vbi5zYXZlZERhdGEuc2hvd1VubG9ja2VkQ2hhcmFjdGVyO1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnNpZ25hbHMuY2hhcmFjdGVyVW5sb2NrZWQuZGlzcGF0Y2goQ29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRDaGFyYWN0ZXIpO1xyXG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZENoYXJhY3RlciA9IG51bGw7XHJcblx0XHRcdENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xyXG5cdFx0fSwwLjgsIHRoaXMpXHJcblx0fVxyXG5cclxuXHQvLyBCYWNrZ3JvdW5kXHJcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9iZ19jaGFyYWN0ZXJzXCIpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHQvLyBDaGFyYWN0ZXIgcGFuZWxzXHJcbiAgICB0aGlzLl9jaGFyYWN0ZXJIb2xkZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgIHRoaXMuX2NoYXJhY3RlckhvbGRlci54ID0gQ29tbW9uLlNUQUdFX1dJRFRIIC8gMjtcclxuICAgIHRoaXMuX2NoYXJhY3RlckhvbGRlci55ID0gKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSArIDQwO1xyXG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9jaGFyYWN0ZXJIb2xkZXIpO1xyXG5cclxuXHR0aGlzLl9wbGF5YWJsZUNoYXJhY3RlcnMgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5wbGF5YWJsZUNoYXJhY3RlcnM7XHJcblx0dGhpcy5fY2hhcmFjdGVyRGF0YSAgICAgID0gJC5leHRlbmQodHJ1ZSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuY2hhcmFjdGVycywgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpLmNoYXJhY3RlcnMpO1xyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fcGxheWFibGVDaGFyYWN0ZXJzLmxlbmd0aDsgaSsrKVxyXG5cdHtcclxuXHRcdGlmKCFDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNVbmxvY2tlZFt0aGlzLl9wbGF5YWJsZUNoYXJhY3RlcnNbaV1dKSBicmVhaztcclxuXHJcblx0XHR2YXIgY2hhcmFjdGVyUGFuZWwgPSBuZXcgQ2hhcmFjdGVyU2VsZWN0UGFuZWwodGhpcywgdGhpcy5fY2hhcmFjdGVyRGF0YVt0aGlzLl9wbGF5YWJsZUNoYXJhY3RlcnNbaV1dKTtcclxuXHRcdHRoaXMuX2NoYXJhY3RlckhvbGRlci5hZGRDaGlsZChjaGFyYWN0ZXJQYW5lbCk7XHJcblxyXG5cdFx0Ly8gU2V0IHRoZSBjdXJyZW50IGNoYXJhY3RlciBhcyBkZWZhdWx0XHJcblx0XHRpZih0aGlzLl9wbGF5YWJsZUNoYXJhY3RlcnNbaV0gPT0gQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2N1cnJlbnRDaGFyYWN0ZXIgPSBpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHRjaGFyYWN0ZXJQYW5lbC5hbHBoYSA9IDA7XHJcblx0XHRcdGNoYXJhY3RlclBhbmVsLnZpc2libGUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9jaGFyYWN0ZXJQYW5lbHMucHVzaChjaGFyYWN0ZXJQYW5lbCk7XHJcblx0fVxyXG5cclxuXHQvLyBUaXRsZSAoY2hhcmFjdGVyIG5hbWUpXHJcblx0aWYoIXdlYmZvbnQpXHJcblx0e1xyXG5cdFx0dGhpcy5fdGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh0aGlzLl9jaGFyYWN0ZXJEYXRhW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXS5uYW1lW0NvbW1vbi5DT1VOVFJZX0NPREVdLCB7Zm9udDogXCI2NHB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0aGlzLl90aXRsZS54ID0gLSB0aGlzLl90aXRsZS50ZXh0V2lkdGgvMiAgKyBDb21tb24uU1RBR0VfV0lEVEgvMjtcclxuXHRcdHRoaXMuX3RpdGxlLnkgPSAtIHRoaXMuX3RpdGxlLnRleHRIZWlnaHQvMiArIDEwMDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fdGl0bGUpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy5fdGl0bGUgPSBuZXcgUElYSS5UZXh0KHRoaXMuX2NoYXJhY3RlckRhdGFbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJdLm5hbWVbQ29tbW9uLkNPVU5UUllfQ09ERV0sIHtmb250OlwiNjBweCBBcmlhbFwiLCBmaWxsOjB4ZmZmZmZmLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0dGhpcy5fdGl0bGUucG9zaXRpb24uc2V0KENvbW1vbi5TVEFHRV9XSURUSCAvIDIsIDEwMCk7XHJcblx0XHR0aGlzLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHR9XHJcblxyXG5cdC8vIENvaW5zXHJcblx0dGhpcy5pbml0Q29pbkNvaW50YWluZXIoKTtcclxuXHJcblx0Ly8gTGVmdC9yaWdodCBidXR0b24gLSBpZiBtb3JlIHRoYW4gb25lIGNoYXJhY3RlciBoYXMgYmVlbiB1bmxvY2tlZFxyXG5cdGlmKENvbW1vbi5zYXZlZERhdGEuZ2V0VW5sb2NrZWRDaGFyYWN0ZXJDb3VudCgpID4gMSlcclxuXHR7XHJcblx0XHR0aGlzLl9sZWZ0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdFx0KFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X291dFwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9vdmVyXCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X2Rvd25cIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zaWRlbmF2X2Fycm93XCIpXHJcblx0XHQpO1xyXG5cdFx0dGhpcy5fbGVmdEJ1dHRvbi5jaGlsZHJlblswXS5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0XHR0aGlzLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHRcdHRoaXMuX2xlZnRCdXR0b24ueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyO1xyXG5cdFx0dGhpcy5fbGVmdEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25MZWZ0RG93biwgdGhpcyk7XHJcblx0XHR0aGlzLl9sZWZ0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fbGVmdEJ1dHRvbik7XHJcblxyXG5cdFx0dGhpcy5fcmlnaHRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0XHQoXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfb3V0XCIpLFxyXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X292ZXJcIiksXHJcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfZG93blwiKSxcclxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NpZGVuYXZfYXJyb3dcIilcclxuXHRcdCk7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbi5zY2FsZS54ID0gLTE7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbi5jaGlsZHJlblswXS5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbi5jaGlsZHJlblsxXS5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbi55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDI7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25SaWdodERvd24sIHRoaXMpO1xyXG5cdFx0dGhpcy5fcmlnaHRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9yaWdodEJ1dHRvbik7XHJcblx0fVxyXG5cclxuXHJcblx0Ly8gVUlcclxuXHJcblx0Ly8gUGxheSBidXR0b25cclxuXHR0aGlzLl9wbGF5QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRfYmlnXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X292ZXJfYmlnXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25fYmlnXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9wbGF5XCIpXHJcblx0KTtcclxuXHR0aGlzLl9wbGF5QnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hULTEyMDtcclxuXHR0aGlzLl9wbGF5QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vblBsYXlQcmVzc2VkLCB0aGlzKTtcclxuXHR0aGlzLl9wbGF5QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3BsYXlCdXR0b24pO1xyXG5cclxuXHQvLyBCYWNrIGJ1dHRvblxyXG5cdHRoaXMuX2JhY2tCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0KFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX2JhY2tcIilcclxuXHQpO1xyXG5cdHRoaXMuX2JhY2tCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcclxuXHR0aGlzLl9iYWNrQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMSwgMSk7XHJcblx0dGhpcy5fYmFja0J1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25CYWNrUHJlc3NlZCwgdGhpcyk7XHJcblx0dGhpcy5fYmFja0J1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9iYWNrQnV0dG9uKTtcclxuXHJcblx0Ly8gSGVscCBidXR0b25cclxuXHR0aGlzLl9oZWxwQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9oZWxwXCIpXHJcblx0KTtcclxuXHR0aGlzLl9oZWxwQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XHJcblx0dGhpcy5faGVscEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25IZWxwUHJlc3NlZCwgdGhpcyk7XHJcblx0dGhpcy5faGVscEJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oZWxwQnV0dG9uKTtcclxuXHJcblx0Ly8gTXV0ZSBidXR0b25cclxuXHR0aGlzLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fc291bmRfb25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX3NvdW5kX29mZlwiKVxyXG5cdCk7XHJcblx0dGhpcy5fbXV0ZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5fbXV0ZUJ1dHRvbi5pZCA9IFwibXV0ZVwiO1xyXG5cdHRoaXMuX211dGVCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcclxuXHR0aGlzLl9tdXRlQnV0dG9uLmluaXQoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX211dGVCdXR0b24pO1xyXG5cclxuXHQvLyBNdXNpY1xyXG5cdGlmKCEhQ29tbW9uLmJnTXVzaWMpIENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgNTAwKTtcclxuXHRDb21tb24uYmdNdXNpYyA9IFNvdW5kU0ZYLnBsYXkoJ214X2Zyb3plbl8wMl9jaGFyYWN0ZXJfc2VsZWN0aW9uJywge2xvb3A6dHJ1ZSwgdm9sdW1lOjB9KTtcclxuXHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDUwMCk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFNjcmVlbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5fY2hhcmFjdGVyUGFuZWxzW3RoaXMuX2N1cnJlbnRDaGFyYWN0ZXJdLnVwZ3JhZGVQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xyXG5cclxuXHRpZighIXRoaXMuX2xlZnRCdXR0b24pXHJcblx0XHR0aGlzLl9sZWZ0QnV0dG9uLnggID0gdGhpcy5fZ2V0Qm9yZGVyQnV0dG9uUG9zaXRpb25MZWZ0KCk7XHJcblx0aWYoISF0aGlzLl9yaWdodEJ1dHRvbilcclxuXHRcdHRoaXMuX3JpZ2h0QnV0dG9uLnggPSB0aGlzLl9nZXRCb3JkZXJCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XHJcblx0dGhpcy5fYmFja0J1dHRvbi54ICA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCk7XHJcblx0dGhpcy5fbXV0ZUJ1dHRvbi54ICA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCgpO1xyXG5cdHRoaXMuX2hlbHBCdXR0b24ueCAgPSB0aGlzLl9nZXRTZWNvbmRCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XHJcblx0Ly8gdGhpcy5fcGxheUJ1dHRvbi54ICA9IHIybCA/ICh0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpKzMwKSA6ICh0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKS0zMCk7XHJcblx0dGhpcy5fcGxheUJ1dHRvbi54ID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCktMzA7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFNjcmVlbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cclxufVxyXG5cclxuLyoqXHJcbiAqL1xyXG5DaGFyYWN0ZXJTZWxlY3RTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkNoYXJhY3RlclNlbGVjdFNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dC5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFNob3cgdGhlIHByZXZpb3VzIGNoYXJhY3RlclxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5vbkxlZnREb3duID0gZnVuY3Rpb24oKVxyXG57XHJcblx0aWYodGhpcy5faXNBbmltYXRpbmcpIHJldHVybjtcclxuXHR0aGlzLl9pc0FuaW1hdGluZyA9IHRydWU7XHJcblxyXG5cdGlmKCFyMmwpXHJcblx0e1xyXG5cdFx0dmFyIG5leHRDaGFyYWN0ZXIgPSAgdGhpcy5fY3VycmVudENoYXJhY3Rlci0xO1xyXG5cdFx0aWYobmV4dENoYXJhY3RlciA8IDApXHJcblx0XHRcdG5leHRDaGFyYWN0ZXIgPSB0aGlzLl9jaGFyYWN0ZXJQYW5lbHMubGVuZ3RoLTE7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHR2YXIgbmV4dENoYXJhY3RlciA9ICB0aGlzLl9jdXJyZW50Q2hhcmFjdGVyKzE7XHJcblx0XHRpZihuZXh0Q2hhcmFjdGVyID49IHRoaXMuX2NoYXJhY3RlclBhbmVscy5sZW5ndGgpXHJcblx0XHRcdG5leHRDaGFyYWN0ZXIgPSAwO1xyXG5cdH1cclxuXHJcblx0dGhpcy5fY2hhcmFjdGVyUGFuZWxzW25leHRDaGFyYWN0ZXJdLnggPSAtcDMuVmlldy53aWR0aDtcclxuXHR0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbbmV4dENoYXJhY3Rlcl0udmlzaWJsZSA9IHRydWU7XHJcblxyXG5cdHRoaXMuX2NoYXJhY3RlclBhbmVsc1t0aGlzLl9jdXJyZW50Q2hhcmFjdGVyXS5jbG9zZVN1YlBhbmVsKCk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heChcclxuXHR7XHJcblx0XHRvbkNvbXBsZXRlU2NvcGU6dGhpcyxcclxuXHRcdG9uQ29tcGxldGU6ZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbdGhpcy5fY3VycmVudENoYXJhY3Rlcl0udmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLl9jdXJyZW50Q2hhcmFjdGVyID0gbmV4dENoYXJhY3RlcjtcclxuXHRcdFx0dGhpcy5faXNBbmltYXRpbmcgPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHR0bC50byh0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbdGhpcy5fY3VycmVudENoYXJhY3Rlcl0sICAuNSwge3g6K3AzLlZpZXcud2lkdGgsIGFscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHR0bC50byh0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbbmV4dENoYXJhY3Rlcl0sICAuNSwge3g6MCwgYWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHR0bC50byh0aGlzLl90aXRsZSwgIC4yNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uQ29tcGxldGVTY29wZTp0aGlzLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHR0aGlzLl90aXRsZS54ICs9IHRoaXMuX3RpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0dGhpcy5fdGl0bGUudGV4dCA9IHRoaXMuX2NoYXJhY3RlckRhdGFbdGhpcy5fcGxheWFibGVDaGFyYWN0ZXJzW25leHRDaGFyYWN0ZXJdXS5uYW1lW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0dGhpcy5fdGl0bGUudmFsaWRhdGUoKTsgLy8gRm9yY2VzIHRoZSB0ZXh0IHRvIHVwZGF0ZSB0aGUgc2l6ZXNcclxuXHRcdHRoaXMuX3RpdGxlLnggLT0gdGhpcy5fdGl0bGUudGV4dFdpZHRoLzI7XHJcblx0fX0sIDApO1xyXG5cdHRsLnRvKHRoaXMuX3RpdGxlLCAgLjI1LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0pO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxuXHJcblx0Q29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgPSB0aGlzLl9jaGFyYWN0ZXJEYXRhW3RoaXMuX3BsYXlhYmxlQ2hhcmFjdGVyc1tuZXh0Q2hhcmFjdGVyXV0uaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IHRoZSBuZXh0IGNoYXJhY3RlclxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5vblJpZ2h0RG93biA9IGZ1bmN0aW9uKClcclxue1xyXG5cdGlmKHRoaXMuX2lzQW5pbWF0aW5nKSByZXR1cm47XHJcblx0dGhpcy5faXNBbmltYXRpbmcgPSB0cnVlO1xyXG5cclxuXHRpZighcjJsKVxyXG5cdHtcclxuXHRcdHZhciBuZXh0Q2hhcmFjdGVyID0gIHRoaXMuX2N1cnJlbnRDaGFyYWN0ZXIrMTtcclxuXHRcdGlmKG5leHRDaGFyYWN0ZXIgPj0gdGhpcy5fY2hhcmFjdGVyUGFuZWxzLmxlbmd0aClcclxuXHRcdFx0bmV4dENoYXJhY3RlciA9IDA7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHR2YXIgbmV4dENoYXJhY3RlciA9ICB0aGlzLl9jdXJyZW50Q2hhcmFjdGVyLTE7XHJcblx0XHRpZihuZXh0Q2hhcmFjdGVyIDwgMClcclxuXHRcdFx0bmV4dENoYXJhY3RlciA9IHRoaXMuX2NoYXJhY3RlclBhbmVscy5sZW5ndGgtMTtcclxuXHR9XHJcblxyXG5cdHRoaXMuX2NoYXJhY3RlclBhbmVsc1tuZXh0Q2hhcmFjdGVyXS54ID0gcDMuVmlldy53aWR0aDtcclxuXHR0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbbmV4dENoYXJhY3Rlcl0udmlzaWJsZSA9IHRydWU7XHJcblxyXG5cdHRoaXMuX2NoYXJhY3RlclBhbmVsc1t0aGlzLl9jdXJyZW50Q2hhcmFjdGVyXS5jbG9zZVN1YlBhbmVsKCk7XHJcblxyXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heChcclxuXHR7XHJcblx0XHRvbkNvbXBsZXRlU2NvcGU6dGhpcyxcclxuXHRcdG9uQ29tcGxldGU6ZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbdGhpcy5fY3VycmVudENoYXJhY3Rlcl0udmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLl9jdXJyZW50Q2hhcmFjdGVyID0gbmV4dENoYXJhY3RlcjtcclxuXHRcdFx0dGhpcy5faXNBbmltYXRpbmcgPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHR0bC50byh0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbdGhpcy5fY3VycmVudENoYXJhY3Rlcl0sICAuNSwge3g6LXAzLlZpZXcud2lkdGgsIGFscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAwKTtcclxuXHR0bC50byh0aGlzLl9jaGFyYWN0ZXJQYW5lbHNbbmV4dENoYXJhY3Rlcl0sICAuNSwge3g6MCwgYWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHR0bC50byh0aGlzLl90aXRsZSwgIC4yNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uQ29tcGxldGVTY29wZTp0aGlzLCBvbkNvbXBsZXRlOmZ1bmN0aW9uKClcclxuXHR7XHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fdGl0bGUueCArPSB0aGlzLl90aXRsZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGhpcy5fdGl0bGUudGV4dCA9IHRoaXMuX2NoYXJhY3RlckRhdGFbdGhpcy5fcGxheWFibGVDaGFyYWN0ZXJzW25leHRDaGFyYWN0ZXJdXS5uYW1lW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdFx0XHR0aGlzLl90aXRsZS52YWxpZGF0ZSgpO1xyXG5cdFx0XHR0aGlzLl90aXRsZS54IC09IHRoaXMuX3RpdGxlLnRleHRXaWR0aC8yO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl90aXRsZS50ZXh0ID0gdGhpcy5fY2hhcmFjdGVyRGF0YVt0aGlzLl9wbGF5YWJsZUNoYXJhY3RlcnNbbmV4dENoYXJhY3Rlcl1dLm5hbWVbQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0XHR9XHJcblx0fX0sIDApO1xyXG5cdHRsLnRvKHRoaXMuX3RpdGxlLCAgLjI1LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0pO1xyXG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xyXG5cclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxuXHJcblx0Q29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXIgPSB0aGlzLl9jaGFyYWN0ZXJEYXRhW3RoaXMuX3BsYXlhYmxlQ2hhcmFjdGVyc1tuZXh0Q2hhcmFjdGVyXV0uaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm4gdG8gdGhlIHByZXZpb3VzIHNjcmVlblxyXG4gKi9cclxuQ2hhcmFjdGVyU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkID0gZnVuY3Rpb24oKVxyXG57XHJcblx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZFByZXZpb3VzU2NyZWVuLmRpc3BhdGNoKFwiYmFja1wiKTtcclxuXHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn07XHJcblxyXG4vKipcclxuICogU2hvdyB0aGUgaGVscCBvdmVybGF5XHJcbiAqL1xyXG5DaGFyYWN0ZXJTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uSGVscFByZXNzZWQgPSBmdW5jdGlvbihlKVxyXG57XHJcblx0dGhpcy5zaWduYWxzLkdVSUJ1dHRvbkNsaWNrZWQuZGlzcGF0Y2goXCJoZWxwXCIpO1xyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogU3RhcnQgdGhlIGxldmVsXHJcbiAqL1xyXG5DaGFyYWN0ZXJTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uUGxheVByZXNzZWQgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCgpO1xyXG5cclxuXHQvLyBNdXNpYyBlbmRcclxuXHRDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDYwMCk7XHJcblxyXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xyXG59XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gR0VUVEVSUy9TRVRURVJTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4iLCJ2YXIgQ29tbW9uICAgICAgIFx0XHQ9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XHJcbnZhciBTaW1wbGVTY3JlZW4gXHRcdD0gcmVxdWlyZShcIi4vU2ltcGxlU2NyZWVuXCIpO1xyXG52YXIgV2lyZWZyYW1lQnV0dG9uIFx0PSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9XaXJlZnJhbWVCdXR0b25cIik7XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBDT05TVFJVQ1RPUlxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKi9cclxuZnVuY3Rpb24gRGFpbHlCb251c1NjcmVlbigpXHJcbntcclxuXHR0aGlzLl9zbm93Rmxha2VQcml6ZXMgPSBudWxsO1xyXG5cclxuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5zaWduYWxzLnByaXplU2VsZWN0ZWQgPSBuZXcgc2lnbmFscy5TaWduYWwoKTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBEYWlseUJvbnVzU2NyZWVuO1xyXG5EYWlseUJvbnVzU2NyZWVuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRGFpbHlCb251c1NjcmVlbjtcclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQVUJMSUMgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqL1xyXG5EYWlseUJvbnVzU2NyZWVuLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG5cdC8vIEJhY2tncm91bmRcclxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2JnX2RhaWx5X2JvbnVzXCIpKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xyXG5cclxuXHQvLyBUaXRsZVxyXG5cdHRoaXMuX3RpdGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdGl0bGVfYmdcIikpO1xyXG5cdHRoaXMuX3RpdGxlLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHR0aGlzLl90aXRsZS54ID0gQ29tbW9uLlNUQUdFX1dJRFRILzI7XHJcblx0dGhpcy5fdGl0bGUueSA9IDEwMDtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX3RpdGxlKTtcclxuXHJcblx0XHR2YXIgY29weSAgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJEQUlMWV9CT05VU1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0XHRpZighd2ViZm9udClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHRpdGxlID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNDJweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdFx0dGl0bGUueCA9IC10aXRsZS50ZXh0V2lkdGgvMjtcclxuXHRcdFx0dGl0bGUueSA9IC10aXRsZS50ZXh0SGVpZ2h0LzIgLSA0O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHZhciB0aXRsZSA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHRcdHRpdGxlLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdFx0dGl0bGUueSA9IC02O1xyXG5cdFx0XHR0aGlzLl90aXRsZS5hZGRDaGlsZCh0aXRsZSk7XHJcblx0XHR9XHJcblxyXG5cdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiREFJTFlfQk9OVVNfREVTQ1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcclxuXHJcblx0aWYoIXdlYmZvbnQpXHJcblx0e1xyXG5cdFx0dGhpcy5fZGVzY3JpcHRpb24gID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjhweCBNaWthZGFuIFRpdGxlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0aGlzLl9kZXNjcmlwdGlvbiAueCA9IC10aGlzLl9kZXNjcmlwdGlvbi50ZXh0V2lkdGgvMiAgKyBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xyXG5cdFx0dGhpcy5fZGVzY3JpcHRpb24gLnkgPSAtdGhpcy5fZGVzY3JpcHRpb24udGV4dEhlaWdodC8yICsgKENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKSAtIDE5MDtcclxuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5fZGVzY3JpcHRpb24pO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy5fZGVzY3JpcHRpb24gPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzBweCBBcmlhbFwiLCBmaWxsOjB4RkZGRkZGLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0dGhpcy5fZGVzY3JpcHRpb24uYW5jaG9yLnggPSAwLjU7XHJcblx0XHR0aGlzLl9kZXNjcmlwdGlvbi54ID0gQ29tbW9uLlNUQUdFX1dJRFRIIC8gMjtcclxuXHRcdHRoaXMuX2Rlc2NyaXB0aW9uLnkgPSAoQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDIpIC0gMjIwO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9kZXNjcmlwdGlvbik7XHJcblx0fVxyXG5cclxuXHQvLyBTbm93Zmxha2VzXHJcbiAgICB0aGlzLl9zbm93Zmxha2VIb2xkZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgIHRoaXMuX3Nub3dmbGFrZUhvbGRlci5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRIIC8gMiwgQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDIgKyA1MCk7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3Nub3dmbGFrZUhvbGRlcik7XHJcblxyXG4gICAgdmFyIHNub3dmbGFrZVByaXplcyAgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5kYWlseUJvbnVzO1xyXG5cdHZhciByYW5kb21Qcml6ZUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc25vd2ZsYWtlUHJpemVzLmxlbmd0aCk7XHJcblx0dGhpcy5fc25vd2ZsYWtlcyA9IFtdO1xyXG5cclxuXHR2YXIgY29vcmRzID1cclxuXHRbXHJcblx0XHR7eCA6IC0yMjAsIHk6IC0xMDB9LFxyXG5cdFx0e3ggOiAwLCAgICB5OiAtNTB9LFxyXG5cdFx0e3ggOiAyNTAsICB5OiAtNzV9LFxyXG5cdFx0e3ggOiAtMjkwLCB5OiAxNDB9LFxyXG5cdFx0e3ggOiA1MCwgICB5OiAxODB9LFxyXG5cdFx0e3ggOiAzMDAsICB5OiAxNTB9XHJcblx0XVxyXG5cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCA2OyBpKyspXHJcbiAgICB7XHJcbiAgICBcdHZhciBzbm93Zmxha2UgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHRcdHNub3dmbGFrZS5wb3NpdGlvbiA9IGNvb3Jkc1tpXTtcclxuXHRcdHNub3dmbGFrZS5zY2FsZS5zZXQoMCk7XHJcblx0XHRzbm93Zmxha2UucHJpemUgPSBzbm93Zmxha2VQcml6ZXNbKHJhbmRvbVByaXplSW5kZXggKyBpKSAlIHNub3dmbGFrZVByaXplcy5sZW5ndGhdO1xyXG5cclxuXHRcdHNub3dmbGFrZS5zcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9ib251c19zbm93Zmxha2VfXCIgKyAoaSsxKSkpO1xyXG5cdFx0c25vd2ZsYWtlLnNwcml0ZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRzbm93Zmxha2UuYWRkQ2hpbGQoc25vd2ZsYWtlLnNwcml0ZSk7XHJcblxyXG5cdFx0dGhpcy5fc25vd2ZsYWtlSG9sZGVyLmFkZENoaWxkKHNub3dmbGFrZSk7XHJcblx0XHR0aGlzLl9zbm93Zmxha2VzLnB1c2goc25vd2ZsYWtlKTtcclxuXHJcblx0XHRzbm93Zmxha2UudGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KFwiXCIgKyBzbm93Zmxha2UucHJpemUsIHtmb250OiBcIjQ4cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0c25vd2ZsYWtlLnRleHQueCAtPSBzbm93Zmxha2UudGV4dC50ZXh0V2lkdGgvMjtcclxuXHRcdHNub3dmbGFrZS50ZXh0LnkgLT0gc25vd2ZsYWtlLnRleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0c25vd2ZsYWtlLnRleHQuYWxwaGEgPSAwO1xyXG5cdFx0c25vd2ZsYWtlLmFkZENoaWxkKHNub3dmbGFrZS50ZXh0KTtcclxuXHJcblx0XHQvLyBzbm93Zmxha2UudGV4dCA9IG5ldyBQSVhJLlRleHQoXCJcIiArIHNub3dmbGFrZS5wcml6ZSwge2ZvbnQ6XCI0OHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHQvLyBzbm93Zmxha2UudGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHQvLyBzbm93Zmxha2UudGV4dC5hbHBoYSA9IDA7XHJcblx0XHQvLyBzbm93Zmxha2UuYWRkQ2hpbGQoc25vd2ZsYWtlLnRleHQpO1xyXG5cclxuXHRcdHNub3dmbGFrZS50d2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cclxuXHRcdFx0dmFyIGRlbGF5ID0gMC41ICsgMC4yNSAqIGk7XHJcblx0XHRcdHZhciBkdXJhdGlvbiA9IDE7XHJcblx0XHRcdHNub3dmbGFrZS50d2Vlbi50byhzbm93Zmxha2Uuc2NhbGUsIGR1cmF0aW9uLCB7eDogMSwgeTogMSwgZWFzZTpFbGFzdGljLmVhc2VPdXR9LCBkZWxheSk7XHJcblx0XHRcdHNub3dmbGFrZS50d2Vlbi50byhzbm93Zmxha2Uuc2NhbGUsIDIgKyBNYXRoLnJhbmRvbSgpICogNCwge3g6IDAuNzUsIHk6IDAuNzUsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgZGVsYXkgKyBkdXJhdGlvbik7XHJcblx0XHRcdHNub3dmbGFrZS50d2Vlbi50byhzbm93Zmxha2UsIDIgKyBNYXRoLnJhbmRvbSgpKiAzLCB7eDogc25vd2ZsYWtlLnggKyA0MCAqICgtMSArIDIgKiBNYXRoLnJhbmRvbSgpKSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgcmVwZWF0Oi0xLCB5b3lvOnRydWV9LCAwKTtcclxuXHRcdFx0c25vd2ZsYWtlLnR3ZWVuLnRvKHNub3dmbGFrZSwgMiArIE1hdGgucmFuZG9tKCkqIDMsIHt5OiBzbm93Zmxha2UueSArIDQwICogKC0xICsgMiAqIE1hdGgucmFuZG9tKCkpLCBlYXNlOlNpbmUuZWFzZUluT3V0LCByZXBlYXQ6LTEsIHlveW86dHJ1ZX0sIDApO1xyXG5cdFx0XHRzbm93Zmxha2UudHdlZW4udG8oc25vd2ZsYWtlLnNwcml0ZSwgMzAgKyBNYXRoLnJhbmRvbSgpKiAzMCwge3JvdGF0aW9uOiBNYXRoLlBJKjIgKiAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjIpKjItMSksIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgMCk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHNub3dmbGFrZS50d2Vlbik7XHJcbiAgICB9XHJcblxyXG5cdC8vIFBhbmVsIGJhY2tncm91bmRcclxuICAgIHRoaXMuX21lc3NhZ2VCb3ggPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9wb3B1cF9iZ1wiKSk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0dGhpcy5fbWVzc2FnZUJveC5wb3NpdGlvbi5zZXQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMiArIDcwKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveCk7XHJcblxyXG5cdFx0dmFyIGJnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfc25vd2ZsYWtlc19iZ1wiKSk7XHJcblx0XHRiZy5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRiZy5wb3NpdGlvbi5zZXQoMCwgLTQwKTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQoYmcpO1xyXG5cclxuXHRcdHRoaXMuX21lc3NhZ2VCb3gudmFsdWUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIj8/XCIsIHtmb250OiBcIjU2cHggU3VwZXJjbGFyZW5kb24gTnVtYmVyc1wiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZS54ID0gLSB0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnRleHRXaWR0aC8yO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZS55ID0gLSB0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnRleHRIZWlnaHQvMiAtIDYyO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94LnZhbHVlKTtcclxuXHJcblx0XHQvLyB0aGlzLl9tZXNzYWdlQm94LnZhbHVlID0gbmV3IFBJWEkuVGV4dChcIj8/XCIsIHtmb250OlwiNDhweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0Ly8gdGhpcy5fbWVzc2FnZUJveC52YWx1ZS5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHQvLyB0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnBvc2l0aW9uLnNldCgwLCAtNjUpO1xyXG5cdFx0Ly8gdGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94LnZhbHVlKTtcclxuXHJcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlJFV0FSRF9NRVNTQUdFXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cclxuXHRcdGlmKCF3ZWJmb250KVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIzNnB4IFN1cGVyY2xhcmVuZG9uIFRpdGxlIFB1cnBsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCA9IC0gdGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRXaWR0aC8yO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UueSA9IC0gdGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRIZWlnaHQvMiArIDE0MDtcclxuXHRcdFx0dGhpcy5fbWVzc2FnZUJveC5hZGRDaGlsZCh0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UucG9zaXRpb24uc2V0KDAsIDE1MCk7XHJcblx0XHRcdHRoaXMuX21lc3NhZ2VCb3guYWRkQ2hpbGQodGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlKTtcclxuXHRcdH1cclxuXHJcblx0dGhpcy5fY2xvc2VCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0KFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NlY25hdl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2VjbmF2X2Rvd25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2VjbmF2X2Nyb3NzXCIpXHJcblx0KTtcclxuXHR0aGlzLl9jbG9zZUJ1dHRvbi54ID0gNDAwO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24ueSA9IC0yNDA7XHJcblx0dGhpcy5fY2xvc2VCdXR0b24uc2lnbmFscy5kb3duLmFkZE9uY2UodGhpcy5vbkNsb3NlLCB0aGlzKTtcclxuXHR0aGlzLl9tZXNzYWdlQm94IC5hZGRDaGlsZCh0aGlzLl9jbG9zZUJ1dHRvbik7XHJcblxyXG5cdHRoaXMuX21lc3NhZ2VCb3guc2NhbGUuc2V0KDApO1xyXG5cdHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLnNldCgwKTtcclxuXHJcblx0Ly8gSGl0QXJlYVxyXG5cdHRoaXMuX2hpdEFyZWEgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFja1NxdWFyZSddKTtcclxuXHR0aGlzLl9oaXRBcmVhLmFscGhhID0gMDtcclxuXHR0aGlzLl9oaXRBcmVhLndpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xyXG5cdHRoaXMuX2hpdEFyZWEuaGVpZ2h0ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcclxuXHR0aGlzLl9oaXRBcmVhLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuXHR0aGlzLl9oaXRBcmVhLnRvdWNoc3RhcnQgID0gdGhpcy5faGl0QXJlYS5tb3VzZWRvd24gPSB0aGlzLm9uVG91Y2guYmluZCh0aGlzKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2hpdEFyZWEpO1xyXG5cclxuXHQvLyBFdmVudCBUcmFja2luZ1xyXG5cdENvbW1vbi5jdG93LnRyYWNrRXZlbnQoXHJcblx0e1xyXG5cdFx0ZXZlbnQgICAgICA6IFwiZ2FtZV9hY3Rpb25cIixcclxuXHRcdGdhbWVfdGllcjEgOiBcImRhaWx5X2JvbnVzXCJcclxuXHR9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKi9cclxuRGFpbHlCb251c1NjcmVlbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcblx0Ly8gUGFydGljbGVzIHVwZGF0ZVxyXG5cdGlmKCEhdGhpcy5yZXdhcmRQUylcclxuXHRcdHRoaXMucmV3YXJkUFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG4vKipcclxuICovXHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHJcbn1cclxuXHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcclxue1xyXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluLmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5EYWlseUJvbnVzU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxyXG57XHJcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0LmNhbGwodGhpcyk7XHJcbn07XHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBSSVZBVEUgTUVUSE9EU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLm9uVG91Y2ggPSBmdW5jdGlvbihlKVxyXG57XHJcblx0dmFyIGNsaWNrUG9zaXRpb24gPSBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzLl9zbm93Zmxha2VIb2xkZXIpO1xyXG5cdHRoaXMuX2hpdEFyZWEuaW50ZXJhY3RpdmUgPSBmYWxzZTtcclxuXHJcblx0Ly8gRmluZCB0aGUgY2xvc2VzdCBzbm93Zmxha2VcclxuXHR2YXIgbWluRGlzdGFuY2UgPSAwO1xyXG5cdHZhciBpbmRleCA9IC0xO1xyXG5cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fc25vd2ZsYWtlcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5wb3codGhpcy5fc25vd2ZsYWtlc1tpXS54IC0gY2xpY2tQb3NpdGlvbi54LDIpICsgTWF0aC5wb3codGhpcy5fc25vd2ZsYWtlc1tpXS55IC0gY2xpY2tQb3NpdGlvbi55LCAyKSk7XHJcblxyXG5cdFx0aWYoaW5kZXggPT0gLTEgfHwgZGlzdGFuY2UgPCBtaW5EaXN0YW5jZSlcclxuXHRcdHtcclxuXHRcdFx0aW5kZXggPSBpO1xyXG5cdFx0XHRtaW5EaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdC8vIE1ha2UgYWxsIHRoZSBzbm93Zmxha2UgZmFsbCBleGNlcHQgdGhlIGNob3NlbiBvbmVcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fc25vd2ZsYWtlcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLmtpbGwoKTtcclxuXHJcblx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblxyXG5cdFx0aWYoaSAhPSBpbmRleClcclxuXHRcdHtcclxuXHRcdFx0Ly8gT3RoZXIgc25vd2ZsYWtlc1xyXG5cdFx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLnRvKHRoaXMuX3Nub3dmbGFrZXNbaV0sIDEuNSwge2FscGhhOiAwLCBlYXNlOlF1YWQuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRcdHRoaXMuX3Nub3dmbGFrZXNbaV0udHdlZW4udG8odGhpcy5fc25vd2ZsYWtlc1tpXSwgMS41LCB7eTogdGhpcy5fc25vd2ZsYWtlc1tpXS55ICsgMTAwICsgMzAwICogTWF0aC5yYW5kb20oKSwgZWFzZTpTaW5lLmVhc2VJbn0sIDApO1xyXG5cdFx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLnRvKHRoaXMuX3Nub3dmbGFrZXNbaV0uc2NhbGUsICAxLjUsIHt4OiAwLjUsIHk6IDAuNSwgZWFzZTpTaW5lLmVhc2VJbn0sIDApO1xyXG5cdFx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLnRvKHRoaXMuX3Nub3dmbGFrZXNbaV0udGV4dCwgMC4xLCB7YWxwaGE6IDEsIGVhc2U6U2luZS5lYXNlT3V0fSwgMCk7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdC8vIENsaWNrZWQgc25vd2ZsYWtlXHJcblx0XHRcdHRoaXMuX3Nub3dmbGFrZXNbaV0udHdlZW4udG8odGhpcy5fc25vd2ZsYWtlc1tpXSwgMSwge3g6IDAsIHk6IDIwLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XHJcblx0XHRcdHRoaXMuX3Nub3dmbGFrZXNbaV0udHdlZW4udG8odGhpcy5fc25vd2ZsYWtlc1tpXS5zY2FsZSwgIDEsIHt4OiAxLjYsIHk6IDEuNiwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xyXG5cdFx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLnRvKHRoaXMuX3Nub3dmbGFrZXNbaV0udGV4dCwgMSwge2FscGhhOiAxLCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xyXG5cclxuXHRcdFx0dGhpcy5fc25vd2ZsYWtlc1tpXS50d2Vlbi50byh0aGlzLl9zbm93Zmxha2VzW2ldLnNjYWxlLCAxLCB7eDogMS40LCB5OiAxLjQsIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgMSk7XHJcblx0XHRcdHRoaXMuX3Nub3dmbGFrZXNbaV0udHdlZW4udG8odGhpcy5fc25vd2ZsYWtlc1tpXS5zcHJpdGUsIDMwLCB7cm90YXRpb246IHRoaXMuX3Nub3dmbGFrZXNbaV0ucm90YXRpb24gKyBNYXRoLlBJKjIgKiAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjIpKjItMSksIGVhc2U6U2luZS5lYXNlSW5PdXQsIHJlcGVhdDotMSwgeW95bzp0cnVlfSwgMCk7XHJcblxyXG5cdFx0XHR0aGlzLl9zbm93Zmxha2VzW2ldLnR3ZWVuLnRvKHRoaXMuX3Nub3dmbGFrZXNbaV0sIDAuNSwge2FscGhhOiAwLCBlYXNlOlNpbmUuZWFzZU91dH0sIDEuNzUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5fc25vd2ZsYWtlc1tpXS50d2Vlbik7XHJcblx0fVxyXG5cclxuXHJcblx0dGhpcy5yZXdhcmRQUyA9IG5ldyBjbG91ZGtpZC5FbWl0dGVyKHRoaXMuX3Nub3dmbGFrZXNbaW5kZXhdLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wMFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wMVwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wM1wiKVxyXG5cdF0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfcmV3YXJkXCIpKTtcclxuXHJcblx0dGhpcy5yZXdhcmRQUy5lbWl0ID0gdHJ1ZTtcclxuXHJcblx0Ly8gU2hvdyB0aGUgbm90aWNlXHJcblx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZS54ICs9IHRoaXMuX21lc3NhZ2VCb3gudmFsdWUudGV4dFdpZHRoLzI7XHJcblx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZS50ZXh0ID0gdGhpcy5fc25vd2ZsYWtlc1tpbmRleF0ucHJpemU7XHJcblx0dGhpcy5fbWVzc2FnZUJveC52YWx1ZS52YWxpZGF0ZSgpO1xyXG5cdHRoaXMuX21lc3NhZ2VCb3gudmFsdWUueCAtPSB0aGlzLl9tZXNzYWdlQm94LnZhbHVlLnRleHRXaWR0aC8yO1xyXG5cclxuXHRpZighd2ViZm9udClcclxuXHR7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UueCArPSB0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dFdpZHRoLzI7XHJcblx0XHR0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dCA9IHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS50ZXh0LnJlcGxhY2UoXCJ7dmFsdWV9XCIsIHRoaXMuX3Nub3dmbGFrZXNbaW5kZXhdLnByaXplKTtcclxuXHRcdHRoaXMuX21lc3NhZ2VCb3gubWVzc2FnZS52YWxpZGF0ZSgpO1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLnggLT0gdGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHRXaWR0aC8yO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dGhpcy5fbWVzc2FnZUJveC5tZXNzYWdlLnRleHQgPSB0aGlzLl9tZXNzYWdlQm94Lm1lc3NhZ2UudGV4dC5yZXBsYWNlKFwie3ZhbHVlfVwiLCB0aGlzLl9zbm93Zmxha2VzW2luZGV4XS5wcml6ZSk7XHJcblx0fVxyXG5cclxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdHRsLnRvKHRoaXMuX2Rlc2NyaXB0aW9uLCAgICAgICAgLjUsIHthbHBoYTogMCwgZWFzZTpTaW5lLmVhc2VPdXR9LCAxLjc1KTtcclxuXHRcdHRsLnRvKHRoaXMuX21lc3NhZ2VCb3guc2NhbGUsICAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAxLjc1KTtcclxuXHRcdHRsLnRvKHRoaXMuX2Nsb3NlQnV0dG9uLnNjYWxlLCAgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAyLjI1KTtcclxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0Ly8gU3RvcmVcclxuXHRDb21tb24uc2F2ZWREYXRhLmF3YXJkRGFpbHlCb251cyh0aGlzLl9zbm93Zmxha2VzW2luZGV4XS5wcml6ZSk7XHJcblx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XHJcbn1cclxuXHJcbkRhaWx5Qm9udXNTY3JlZW4ucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbigpXHJcbntcclxuXHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCgpO1xyXG59XHJcblxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHRVRURVJTL1NFVFRFUlNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiIsInZhciBDb21tb24gICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG52YXIgRWRpdG9yICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZWRpdG9yL0VkaXRvclwiKTtcbnZhciBTaW1wbGVTY3JlZW4gICAgICAgICAgICA9IHJlcXVpcmUoXCIuL1NpbXBsZVNjcmVlblwiKTtcblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIEVkaXRvclNjcmVlbigpXG57XG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFZGl0b3JTY3JlZW47XG5FZGl0b3JTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcbkVkaXRvclNjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBFZGl0b3JTY3JlZW47XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBVQkxJQyBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqL1xuRWRpdG9yU2NyZWVuLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKVxue1xuXHRjb25zb2xlLmxvZyhcIkVESVRPUiBJTklUSUFMSVpFRFwiKTtcblxuXHQvLyBIaXRBcmVhXG5cdHRoaXMuaGl0QXJlYSA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHR0aGlzLmhpdEFyZWEuYWxwaGEgID0gMDtcblx0dGhpcy5oaXRBcmVhLndpZHRoICA9IENvbW1vbi5TVEFHRV9XSURUSDtcblx0dGhpcy5oaXRBcmVhLmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuaGl0QXJlYS5pbnRlcmFjdGl2ZSA9IHRydWU7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5oaXRBcmVhKTtcblxuXHR0aGlzLm1vdXNlID1cblx0e1xuXHRcdHBvc2l0aW9uICAgICAgICAgOiBuZXcgUElYSS5Qb2ludCgwLDApLFxuXHRcdGxhc3RQb3NpdGlvbiAgICAgOiBuZXcgUElYSS5Qb2ludCgwLDApLFxuXHRcdG1vdmVtZW50ICAgICAgICAgOiBuZXcgUElYSS5Qb2ludCgwLDApLFxuXHRcdGxlZnRQcmVzc2VkICAgICAgOiBmYWxzZSxcblx0XHRsZWZ0SnVzdFByZXNzZWQgIDogZmFsc2UsXG5cdFx0Y2VudGVyUHJlc3NlZCAgICA6IGZhbHNlLFxuXHRcdHJpZ2h0UHJlc3NlZCAgICAgOiBmYWxzZSxcblx0XHRyaWdodEp1c3RQcmVzc2VkIDogZmFsc2UsXG5cdFx0dXBkYXRlICAgICAgICAgICA6IGZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHR0aGlzLmxlZnRKdXN0UHJlc3NlZCA9IGZhbHNlO1xuXHRcdFx0dGhpcy5yaWdodEp1c3RQcmVzc2VkID0gZmFsc2U7XG5cdFx0XHR0aGlzLm1vdmVtZW50LnggPSB0aGlzLnBvc2l0aW9uLnggLSB0aGlzLmxhc3RQb3NpdGlvbi54O1xuXHRcdFx0dGhpcy5tb3ZlbWVudC55ID0gdGhpcy5wb3NpdGlvbi55IC0gdGhpcy5sYXN0UG9zaXRpb24ueTtcblx0XHRcdHRoaXMubGFzdFBvc2l0aW9uLnggPSB0aGlzLnBvc2l0aW9uLng7XG5cdFx0XHR0aGlzLmxhc3RQb3NpdGlvbi55ID0gdGhpcy5wb3NpdGlvbi55O1xuXHRcdH1cblx0fVxuXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5vbm1vdXNlZG93biA9IGZ1bmN0aW9uKGUpXG5cdHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0c3dpdGNoKGUud2hpY2gpXG5cdFx0e1xuXHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHR0aGlzLm1vdXNlLmxlZnRQcmVzc2VkID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5tb3VzZS5sZWZ0SnVzdFByZXNzZWQgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgMjpcblx0XHRcdFx0dGhpcy5tb3VzZS5jZW50ZXJQcmVzc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIDM6XG5cdFx0XHRcdHRoaXMubW91c2UucmlnaHRQcmVzc2VkID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy5tb3VzZS5yaWdodEp1c3RQcmVzc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fTtcblxuXHR9LmJpbmQodGhpcyk7XG5cblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpLm9ubW91c2V1cCA9IGZ1bmN0aW9uKGUpXG5cdHtcblx0XHRzd2l0Y2goZS53aGljaClcblx0XHR7XG5cdFx0XHRjYXNlIDE6XG5cdFx0XHRcdHRoaXMubW91c2UubGVmdFByZXNzZWQgPSBmYWxzZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIDI6XG5cdFx0XHRcdHRoaXMubW91c2UuY2VudGVyUHJlc3NlZCA9IGZhbHNlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgMzpcblx0XHRcdFx0dGhpcy5tb3VzZS5yaWdodFByZXNzZWQgPSBmYWxzZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fTtcblx0fS5iaW5kKHRoaXMpO1xuXG5cdHRoaXMuaGl0QXJlYS5tb3VzZW1vdmUgPSBmdW5jdGlvbihlKVxuXHR7XG5cdFx0dGhpcy5tb3VzZS5wb3NpdGlvbi54ID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueDtcblx0XHR0aGlzLm1vdXNlLnBvc2l0aW9uLnkgPSBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzKS55O1xuXHR9LmJpbmQodGhpcyk7XG5cblxuXHR0aGlzLmVkaXRvciA9IG5ldyBFZGl0b3IoKTtcblx0dGhpcy5lZGl0b3IubW91c2UgPSB0aGlzLm1vdXNlO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuZWRpdG9yKTtcblx0dGhpcy5lZGl0b3IuaW5pdCgpO1xuXG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xufVxuXG5cbi8qKlxuICovXG5FZGl0b3JTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcbntcblx0dGhpcy5lZGl0b3IudXBkYXRlKCk7XG5cblx0dGhpcy5tb3VzZS51cGRhdGUoKTtcbn1cblxuLyoqXG4gKi9cbkVkaXRvclNjcmVlbi5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xufVxuXG4vKipcbiAqL1xuRWRpdG9yU2NyZWVuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxue1xuXG59XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fXNjb3BlXG4gKi9cbkVkaXRvclNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbi5jYWxsKHRoaXMpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7RnVuY3Rpb249fSBjYWxsYmFja1xuICogQHBhcmFtIHsqPX0gc2NvcGVcbiAqL1xuRWRpdG9yU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcbn1cblxuXG4vKipcbiAqL1xuRWRpdG9yU2NyZWVuLnByb3RvdHlwZS5oaWRlR1VJID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHR0aGlzLl9wYXVzZWQgPSB0cnVlO1xuXHRUd2Vlbk1heC5wYXVzZUFsbCgpO1xufVxuXG4vKipcbiAqL1xuRWRpdG9yU2NyZWVuLnByb3RvdHlwZS5zaG93R1VJID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLl9wYXVzZWQgPSBmYWxzZTtcblx0VHdlZW5NYXgucmVzdW1lQWxsKCk7XG59XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBSSVZBVEUgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVRURVJTL1NFVFRFUlNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiIsInZhciBDb21tb24gICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG52YXIgU2ltcGxlU2NyZWVuICAgICAgICAgICAgPSByZXF1aXJlKFwiLi9TaW1wbGVTY3JlZW5cIik7XG52YXIgU291bmRTRlggICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcbnZhciBMZXZlbCAgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nYW1lL0xldmVsXCIpO1xudmFyIEdhbWVVSSAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcIi4uL2dhbWUvR2FtZVVJXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIEdhbWVTY3JlZW4oKVxue1xuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcblxuXHR0aGlzLl9wYXVzZWQgPSBmYWxzZTtcblxuXHR0aGlzLnNpZ25hbHMucGF1c2VQcmVzc2VkICAgICA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuXHR0aGlzLnNpZ25hbHMuc2hvd0luc3RydWN0aW9ucyA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBHYW1lU2NyZWVuO1xuR2FtZVNjcmVlbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xuR2FtZVNjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHYW1lU2NyZWVuO1xuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQVUJMSUMgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdGNvbnNvbGUubG9nKFwiR0FNRSBJTklUSUFMSVpFRFwiKTtcblxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcblxuXHQvLyBMZXZlbFxuXHRpZihDb21tb24uc2F2ZWREYXRhLmxldmVsRGVidWcgIT0gXCJcIilcblx0e1xuXHRcdHZhciBjb25maWcgPSBKU09OLnBhcnNlKENvbW1vbi5zYXZlZERhdGEubGV2ZWxEZWJ1Zyk7XG5cblx0XHRpZihjb25maWcubGVuZ3RoKVxuXHRcdHtcblx0XHRcdHRoaXMuX2xldmVsID0gbmV3IExldmVsKGZhbHNlLCBcIlwiLCBcInRoZW1lXzAxX1wiKTtcblx0XHRcdHRoaXMuX2xldmVsLmNvbmZpZyA9IEpTT04ucGFyc2UoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbERlYnVnKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoaXMuX2xldmVsID0gbmV3IExldmVsKHRydWUsXG5cdFx0XHR7XG5cdFx0XHRcdHN0YXJ0IDogW1wiZW5kbGVzc19zdGFydF8wMDBcIl0sXG5cdFx0XHRcdHBhcnRzIDogW10sXG5cdFx0XHRcdHBhcnREZWJ1ZyA6IGNvbmZpZ1xuXHRcdFx0fSwgXCJ0aGVtZV8wMV9cIik7XG5cblx0XHR9XG5cblx0XHRDb21tb24uc2F2ZWREYXRhLmxldmVsRGVidWcgPSBcIlwiO1xuXHRcdENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xuXHR9XG5cdGVsc2UgaWYoIUNvbW1vbi5zYXZlZERhdGEuZW5kbGVzcylcblx0e1xuXHRcdHZhciBsZXZlbE5hbWUgPSBcIlwiO1xuXG5cdFx0c3dpdGNoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwpXG5cdFx0e1xuXHRcdFx0Y2FzZSAwOlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8wMFwiLCBcInRoZW1lXzAxX1wiKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRjYXNlIDE6XG5cdFx0XHRcdHRoaXMuX2xldmVsID0gbmV3IExldmVsKGZhbHNlLCBcImxldmVsXzAxXCIsIFwidGhlbWVfMFwiICsgKCgoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbC0xKSUzKSsxKSArIFwiX1wiKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjpcblx0XHRcdFx0dGhpcy5fbGV2ZWwgPSBuZXcgTGV2ZWwoZmFsc2UsIFwibGV2ZWxfMDJcIiwgXCJ0aGVtZV8wXCIgKyAoKChDb21tb24uc2F2ZWREYXRhLmxldmVsLTEpJTMpKzEpICsgXCJfXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAzOlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8wM1wiLCBcInRoZW1lXzBcIiArICgoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwtMSklMykrMSkgKyBcIl9cIik7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDQ6XG5cdFx0XHRcdHRoaXMuX2xldmVsID0gbmV3IExldmVsKGZhbHNlLCBcImxldmVsXzA0XCIsIFwidGhlbWVfMFwiICsgKCgoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbC0xKSUzKSsxKSArIFwiX1wiKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgNTpcblx0XHRcdFx0dGhpcy5fbGV2ZWwgPSBuZXcgTGV2ZWwoZmFsc2UsIFwibGV2ZWxfMDVcIiwgXCJ0aGVtZV8wXCIgKyAoKChDb21tb24uc2F2ZWREYXRhLmxldmVsLTEpJTMpKzEpICsgXCJfXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSA2OlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8wNlwiLCBcInRoZW1lXzBcIiArICgoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwtMSklMykrMSkgKyBcIl9cIik7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDc6XG5cdFx0XHRcdHRoaXMuX2xldmVsID0gbmV3IExldmVsKGZhbHNlLCBcImxldmVsXzA3XCIsIFwidGhlbWVfMFwiICsgKCgoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbC0xKSUzKSsxKSArIFwiX1wiKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgODpcblx0XHRcdFx0dGhpcy5fbGV2ZWwgPSBuZXcgTGV2ZWwoZmFsc2UsIFwibGV2ZWxfMDhcIiwgXCJ0aGVtZV8wXCIgKyAoKChDb21tb24uc2F2ZWREYXRhLmxldmVsLTEpJTMpKzEpICsgXCJfXCIpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSA5OlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8wOVwiLCBcInRoZW1lXzBcIiArICgoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwtMSklMykrMSkgKyBcIl9cIik7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDEwOlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8xMFwiLCBcInRoZW1lXzBcIiArICgoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwtMSklMykrMSkgKyBcIl9cIik7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDExOlxuXHRcdFx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbChmYWxzZSwgXCJsZXZlbF8xMVwiLCBcInRoZW1lXzBcIiArICgoKENvbW1vbi5zYXZlZERhdGEubGV2ZWwtMSklMykrMSkgKyBcIl9cIik7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXHRlbHNlXG5cdHtcblx0XHR0aGlzLl9sZXZlbCA9IG5ldyBMZXZlbCh0cnVlLFxuXHRcdHtcblx0XHRcdHN0YXJ0IDogW1wiZW5kbGVzc19zdGFydF8wMDBcIl0sXG5cdFx0XHRwYXJ0cyA6XG5cdFx0XHRbXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAwMFwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMDFcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDAyXCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAwM1wiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMDRcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDA1XCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAwNlwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMDdcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDA4XCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAwOVwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMTBcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDExXCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAxMlwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMTNcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDE0XCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAxNVwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMTZcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDE3XCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAxOFwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMTlcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDIwXCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAyMVwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMjJcIixcblx0XHRcdFx0XCJlbmRsZXNzX3BhcnRfMDIzXCIsXG5cdFx0XHRcdFwiZW5kbGVzc19wYXJ0XzAyNFwiLFxuXHRcdFx0XHRcImVuZGxlc3NfcGFydF8wMjVcIlxuXHRcdFx0XSxcblx0XHR9LCBcInRoZW1lXzAxX1wiKTtcblx0fVxuXG5cdC8vIEV2ZW50IFRyYWNraW5nXG5cdENvbW1vbi5jdG93LnRyYWNrRXZlbnQoXG5cdHtcblx0XHRldmVudCAgICAgIDogXCJnYW1lX3N0YXJ0XCIsXG5cdFx0Z2FtZV9sZXZlbCA6IENvbW1vbi5zYXZlZERhdGEuZW5kbGVzcyA/IG51bGwgOiAoQ29tbW9uLnNhdmVkRGF0YS5sZXZlbCsxKSxcblx0XHRnYW1lX3RpZXIxIDogXCJwbGF5X3N0YXJ0XCIsXG5cdFx0Z2FtZV9tZXRhICA6IFwie1wiICtcblx0XHRcdFx0XHRcdCBcIkNoYXJhY3Rlck5hbWU9XCIgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciArIFwiLFwiICtcblx0XHRcdFx0XHRcdCBcInR1bWJsZT1cIiAgICAgICAgKyBDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlcnNQb3dlcltDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcl1bMF0gKyBcIixcIiArXG5cdFx0XHRcdFx0XHQgXCJtYWduZXQ9XCIgICAgICAgICsgQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJzUG93ZXJbQ29tbW9uLnNhdmVkRGF0YS5jaGFyYWN0ZXJdWzFdICsgXCIsXCIgK1xuXHRcdFx0XHRcdFx0IFwibWFnaWM9XCIgICAgICAgICArIENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyc1Bvd2VyW0NvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyXVsyXSArXG5cdFx0XHRcdFx0IFwifVwiXG5cdH0pO1xuXG5cblx0dGhpcy5fbGV2ZWwuaW5pdCgpO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2xldmVsKTtcblxuXHQvLyBMZXZlbCBVSVxuXHR0aGlzLmdhbWVVSSA9IG5ldyBHYW1lVUkodGhpcy5fbGV2ZWwpO1xuXHR0aGlzLmdhbWVVSS5pbml0KCk7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5nYW1lVUkpO1xuXG5cdC8vIEhpdEFyZWEgbGVmdDogYWJpbGl0eVxuXHR0aGlzLl9oaXRBcmVhTGVmdCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHR0aGlzLl9oaXRBcmVhTGVmdC5hbHBoYSA9IDA7XG5cdHRoaXMuX2hpdEFyZWFMZWZ0LndpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRILzI7XG5cdHRoaXMuX2hpdEFyZWFMZWZ0LmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuX2hpdEFyZWFMZWZ0LmludGVyYWN0aXZlID0gdHJ1ZTtcblxuXHQvLyBIaXRBcmVhIHJpZ2h0OiBqdW1wXG5cdHRoaXMuX2hpdEFyZWFSaWdodCA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHR0aGlzLl9oaXRBcmVhUmlnaHQuYWxwaGEgPSAwO1xuXHR0aGlzLl9oaXRBcmVhUmlnaHQueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl9oaXRBcmVhUmlnaHQud2lkdGggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcblx0dGhpcy5faGl0QXJlYVJpZ2h0LmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuX2hpdEFyZWFSaWdodC5pbnRlcmFjdGl2ZSA9IHRydWU7XG5cblx0aWYocDMuRGV2aWNlLmlzTW9iaWxlKVxuXHR7XG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oaXRBcmVhUmlnaHQpO1xuXG5cdFx0Ly8gQW5uYSBhbmQgcGFiYmllIGRvbid0IGhhdmUgcG93ZXJzLCB0aGV5IGNhbiBvbmx5IGp1bXBcblx0XHRpZihDb21tb24uc2F2ZWREYXRhLmNoYXJhY3RlciA9PSBcImFubmFcIilcblx0XHR7XG5cdFx0XHR0aGlzLl9oaXRBcmVhUmlnaHQueCA9IDA7XG5cdFx0XHR0aGlzLl9oaXRBcmVhUmlnaHQud2lkdGggPSBDb21tb24uU1RBR0VfV0lEVEg7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGlzLmFkZENoaWxkKHRoaXMuX2hpdEFyZWFMZWZ0KTtcblx0XHR9XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oaXRBcmVhUmlnaHQpO1xuXHRcdHRoaXMuX2hpdEFyZWFSaWdodC54ID0gMDtcblx0XHR0aGlzLl9oaXRBcmVhUmlnaHQud2lkdGggPSBDb21tb24uU1RBR0VfV0lEVEg7XG5cdH1cblxuXG5cdC8vVUlcblx0dGhpcy5fcGF1c2VCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdChcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdmVyXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9kb3duXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fcGF1c2VcIilcblx0KTtcblx0dGhpcy5fcGF1c2VCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbiAtIDIwO1xuXHR0aGlzLl9wYXVzZUJ1dHRvbi5zY2FsZS5zZXQoMCk7XG5cdHRoaXMuX3BhdXNlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vblBhdXNlUHJlc3NlZCwgdGhpcyk7XG5cdHRoaXMuX3BhdXNlQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9wYXVzZUJ1dHRvbik7XG5cblx0Ly8gdGhpcy5fbXV0ZUJ1dHRvbiA9IG5ldyBwMy5NdXRlQnV0dG9uXG5cdC8vIChcblx0XHQvLyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxuXHRcdC8vIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdmVyXCIpLFxuXHRcdC8vIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9kb3duXCIpLFxuXHRcdC8vIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fc291bmRfb25cIiksXG5cdFx0Ly8gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9zb3VuZF9vZmZcIilcblx0Ly8gKTtcblxuXHQvLyB0aGlzLl9tdXRlQnV0dG9uLmlkID0gXCJtdXRlXCI7XG5cdC8vIHRoaXMuX211dGVCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcblx0Ly8gdGhpcy5fbXV0ZUJ1dHRvbi5zY2FsZS5zZXQoMCk7XG5cdC8vIHRoaXMuX211dGVCdXR0b24uc2lnbmFscy5vdmVyLmFkZCh0aGlzLmJ1dHRvbk92ZXIsIHRoaXMpO1xuXHQvLyB0aGlzLl9tdXRlQnV0dG9uLmluaXQoKTtcblx0Ly8gdGhpcy5hZGRDaGlsZCh0aGlzLl9tdXRlQnV0dG9uKTtcblxuXHQvLyBUb3VjaCBhcmVhc1xuXHR0aGlzLl9sZXZlbC5hdmF0YXIua0FiaWxpdHkgPSBmYWxzZTtcblx0dGhpcy5faGl0QXJlYUxlZnQudG91Y2hzdGFydCAgPSB0aGlzLl9oaXRBcmVhTGVmdC5tb3VzZWRvd24gID0gdGhpcy5vblRvdWNoTGVmdFN0YXJ0LmJpbmQodGhpcyk7XG5cdC8vIHRoaXMuX2hpdEFyZWFMZWZ0LnRvdWNoZW5kICAgID0gdGhpcy5faGl0QXJlYUxlZnQubW91c2V1cCAgICA9IHRoaXMub25Ub3VjaExlZnRFbmQuYmluZCh0aGlzKTtcblxuXHR0aGlzLl9oaXRBcmVhUmlnaHQudG91Y2hzdGFydCA9IHRoaXMuX2hpdEFyZWFSaWdodC5tb3VzZWRvd24gPSB0aGlzLm9uVG91Y2hSaWdodFN0YXJ0LmJpbmQodGhpcyk7XG5cdHRoaXMuX2hpdEFyZWFSaWdodC50b3VjaGVuZCAgID0gdGhpcy5faGl0QXJlYVJpZ2h0Lm1vdXNldXAgICA9IHRoaXMub25Ub3VjaFJpZ2h0RW5kLmJpbmQodGhpcyk7XG5cblx0Q29tbW9uLmdvYWxzTWFuYWdlci5zdGFydFJ1bih0aGlzKTtcblx0dGhpcy5zdGFydEdhbWUoKTtcblxuXHQvLyBDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpXG5cdC8vIHtcblx0XHQvLyB0aGlzLmVuZEdhbWUoKTtcblx0Ly8gfSwgMS4yLCB0aGlzKTtcblxuXG5cdGlmKENvbW1vbi5zYXZlZERhdGEuZW5kbGVzcyAmJiAhQ29tbW9uLnNhdmVkRGF0YS5oYXNTZWVuVHV0b3JpYWxbXCJlbmRsZXNzXCJdKVxuXHR7XG5cdFx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxuXHRcdHtcblx0XHRcdHRoaXMuc2hvd0luc3RydWN0aW9ucyhcImVuZGxlc3NcIik7XG5cdFx0fSwgMS4yLCB0aGlzKTtcblx0fVxuXHRpZihDb21tb24uc2F2ZWREYXRhLmhhc1NlZW5UdXRvcmlhbFtDb21tb24uc2F2ZWREYXRhLmNoYXJhY3Rlcl0gPT0gZmFsc2UpXG5cdHtcblx0XHRDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpXG5cdFx0e1xuXHRcdFx0dGhpcy5zaG93SW5zdHJ1Y3Rpb25zKENvbW1vbi5zYXZlZERhdGEuY2hhcmFjdGVyKTtcblx0XHR9LCAxLjIsIHRoaXMpO1xuXHR9XG59XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5zdGFydEdhbWUgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuc2hvd0dVSSgpO1xuXG5cdENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKClcblx0e1xuXHRcdHRoaXMuZ2FtZVVJLnNob3dHb2FscyhmYWxzZSk7XG5cdH0sIDAuMjUsIHRoaXMpO1xufVxuXG4vKipcbiAqL1xuR2FtZVNjcmVlbi5wcm90b3R5cGUuZW5kR2FtZSA9IGZ1bmN0aW9uKClcbntcblx0dGhpcy5fcGF1c2VkID0gdHJ1ZTtcblxuXHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCh0aGlzLl9sZXZlbCk7XG59XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXG57XG5cdC8vIGlmKENvbW1vbi5rZXlib2FyZC5nZXRLZXlKdXN0UHJlc3NlZChDb21tb24ua2V5Ym9hcmQuS0VZX1EpKVxuXHQvLyB7XG5cdFx0Ly8gdGhpcy5fcGF1c2VkID0gIXRoaXMuX3BhdXNlZDtcblxuXHRcdC8vIGlmKHRoaXMuX3BhdXNlZClcblx0XHRcdC8vIFR3ZWVuTWF4LnBhdXNlQWxsKCk7XG5cdFx0Ly8gZWxzZVxuXHRcdFx0Ly8gVHdlZW5NYXgucmVzdW1lQWxsKCk7XG5cdC8vIH1cblxuXHQvLyBpZihDb21tb24ua2V5Ym9hcmQuZ2V0S2V5SnVzdFByZXNzZWQoQ29tbW9uLmtleWJvYXJkLktFWV9aKSlcblx0Ly8ge1xuXHRcdC8vIHRoaXMuX2xldmVsLmF2YXRhci5rQWJpbGl0eSA9IHRydWU7XG5cdC8vIH1cblxuXHRpZighdGhpcy5fcGF1c2VkKVxuXHR7XG5cdFx0dGhpcy5fbGV2ZWwudXBkYXRlKCk7XG5cdFx0dGhpcy5nYW1lVUkudXBkYXRlKCk7XG5cdH1cbn1cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcblxuXHR0aGlzLmdhbWVVSS5yZXNpemUoKTtcblx0Ly8gdGhpcy5fbXV0ZUJ1dHRvbi54ICAgPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKTtcblx0dGhpcy5fcGF1c2VCdXR0b24ueCAgPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKTtcbn1cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuX2xldmVsLmRpc3Bvc2UoKTtcblx0U291bmRTRlguc3RvcCgnbXhfZnJvemVuXzAxX2dhbWVwbGF5X2xwJyk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fXNjb3BlXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0Ly8gTXVzaWNcblx0aWYoISFDb21tb24uYmdNdXNpYylcblx0e1xuXHRcdENvbW1vbi5iZ011c2ljLnN0b3AoKTtcblx0XHRDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDUwMCk7XG5cdH1cblx0Q29tbW9uLmJnTXVzaWMgPSBTb3VuZFNGWC5wbGF5KCdteF9mcm96ZW5fMDFfZ2FtZXBsYXlfbHAnLCB7bG9vcDp0cnVlLCB2b2x1bWU6MH0pO1xuXHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDUwMCk7XG5cblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcblxuXHRpZihjYWxsYmFjaykgY2FsbGJhY2suY2FsbChzY29wZSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0ID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbCh0aGlzKTtcblxuXHRpZihjYWxsYmFjaykgY2FsbGJhY2suY2FsbChzY29wZSk7XG59XG5cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLmhpZGVHVUkgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdHRoaXMuX3BhdXNlZCA9IHRydWU7XG5cdFR3ZWVuTWF4LnBhdXNlQWxsKCk7XG5cblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KHtvbkNvbXBsZXRlU2NvcGU6c2NvcGUsIG9uQ29tcGxldGU6Y2FsbGJhY2t9KTtcblx0dGwudG8odGhpcy5fcGF1c2VCdXR0b24uc2NhbGUsIC4zNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdC8vIHRsLnRvKHRoaXMuX211dGVCdXR0b24uc2NhbGUsICAuMzUsIHt4OjAsIHk6MCwgZWFzZTpCYWNrLmVhc2VJbn0sIDApO1xuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcbn1cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLnNob3dHVUkgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuXHRUd2Vlbk1heC5yZXN1bWVBbGwoKTtcblxuXHQvLyBVZ2x5IHdheSB0byB1cGRhdGUgbXV0ZSBidXR0b24gaWYgY2hhbmdlZCBpbiB0aGUgcGF1c2Ugc2NyZWVuXG5cdC8vIHRoaXMuX211dGVCdXR0b24uX2VuYWJsZWQgPSBwMy5CdXR0b24uYXVkaW8uX2lzTXV0ZTtcblx0Ly8gdGhpcy5fbXV0ZUJ1dHRvbi5fY3VycmVudEljb25UZXh0dXJlID0gcDMuQnV0dG9uLmF1ZGlvLl9pc011dGUgPyB0aGlzLl9tdXRlQnV0dG9uLl9vZmZJY29uVGV4dHVyZSA6IHRoaXMuX211dGVCdXR0b24uX29uSWNvblRleHR1cmU7XG5cdC8vIHRoaXMuX211dGVCdXR0b24uX2ljb24udGV4dHVyZSAgICAgICA9IHRoaXMuX211dGVCdXR0b24uX2N1cnJlbnRJY29uVGV4dHVyZTtcblxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0Ly8gdGwudG8odGhpcy5fbXV0ZUJ1dHRvbi5zY2FsZSwgICAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDApO1xuXHR0bC50byh0aGlzLl9wYXVzZUJ1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMS41KTtcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG59XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5nYW1lT3ZlciA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0Ly8gU2hvdyBnb2Fsc1xuXHR0aGlzLmdhbWVVSS5zaG93R29hbHModHJ1ZSk7XG5cblx0Ly8gSGlkZSBVSVxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoe29uQ29tcGxldGVTY29wZTpzY29wZSwgb25Db21wbGV0ZTpjYWxsYmFja30pO1xuXHRcdHRsLnRvKHRoaXMuX3BhdXNlQnV0dG9uLnNjYWxlLCAgLjM1LCB7eDowLCB5OjAsIGVhc2U6QmFjay5lYXNlSW59LCAwKTtcblx0XHQvLyB0bC50byh0aGlzLl9tdXRlQnV0dG9uLnNjYWxlLCAgIC4zNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdHRoaXMuZ2FtZVVJLmdhbWVPdmVyKCk7XG5cblx0Ly8gU2hvdyByZXN1bHRzIGFmdGVyIGEgZGVsYXlcblx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxuXHR7XG5cdFx0dGhpcy5fbGV2ZWwuc3RvcExvb3BzKCk7XG5cblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCh0aGlzLl9sZXZlbCk7XG5cdH0sIDIsIHRoaXMpO1xuXG5cdC8vIE11c2ljXG5cdENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgMjAwMCk7XG59XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5zaG93SW5zdHJ1Y3Rpb25zID0gZnVuY3Rpb24od2hhdClcbntcblx0dGhpcy5fbGV2ZWwuc3RvcExvb3BzKCk7XG5cdC8vIHRoaXMuX3BhdXNlZCA9IHRydWU7XG5cdHRoaXMuc2lnbmFscy5zaG93SW5zdHJ1Y3Rpb25zLmRpc3BhdGNoKHdoYXQpO1xufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFJJVkFURSBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqL1xuR2FtZVNjcmVlbi5wcm90b3R5cGUub25QYXVzZVByZXNzZWQgPSBmdW5jdGlvbigpXG57XG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xuXG5cdGlmKHRoaXMuX2xldmVsLmF2YXRhci5pc0RlYWQpIHJldHVybjtcblx0dGhpcy5zaWduYWxzLnBhdXNlUHJlc3NlZC5kaXNwYXRjaCh0aGlzLl9sZXZlbCk7XG5cblx0dGhpcy5fbGV2ZWwuc3RvcExvb3BzKCk7XG59XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5idXR0b25PdmVyID0gZnVuY3Rpb24oKVxue1xuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiKTtcbn1cblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLm9uVG91Y2hMZWZ0U3RhcnQgPSBmdW5jdGlvbihldmVudCwgaWQpXG57XG5cdHRoaXMuX2xldmVsLmF2YXRhci5rQWJpbGl0eSA9IHRydWU7XG59O1xuXG4vKipcbiAqL1xuR2FtZVNjcmVlbi5wcm90b3R5cGUub25Ub3VjaExlZnRFbmQgPSBmdW5jdGlvbihldmVudCwgaWQpXG57XG5cbn07XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5vblRvdWNoUmlnaHRTdGFydCA9IGZ1bmN0aW9uKGV2ZW50LCBpZClcbntcblx0dGhpcy5fbGV2ZWwuYXZhdGFyLmtKdW1wU3RhcnQgPSB0cnVlO1xufTtcblxuLyoqXG4gKi9cbkdhbWVTY3JlZW4ucHJvdG90eXBlLm9uVG91Y2hSaWdodEVuZCA9IGZ1bmN0aW9uKGV2ZW50LCBpZClcbntcblx0dGhpcy5fbGV2ZWwuYXZhdGFyLmtKdW1wRW5kID0gdHJ1ZTtcbn07XG5cbi8qKlxuICovXG5HYW1lU2NyZWVuLnByb3RvdHlwZS5yZXN0YXJ0ID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goKTtcbn07XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVRURVJTL1NFVFRFUlNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiIsInZhciBDb21tb24gICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xudmFyIFNpbXBsZVNjcmVlbiA9IHJlcXVpcmUoXCIuL1NpbXBsZVNjcmVlblwiKTtcbnZhciBTb3VuZFNGWCAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUUlVDVE9SXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBJbnRyb1NjcmVlbih0eXBlKVxue1xuXHRTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcblxuXHR0aGlzLl90eXBlID0gdHlwZTtcblxuXHRzd2l0Y2godGhpcy5fdHlwZSlcblx0e1xuXHRcdGNhc2UgXCJpbnRyb1wiOlxuXHRcdFx0dGhpcy5fc3BpbmUgPSBDb21tb24uaW50cm9BbmltYXRpb25EYXRhXG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJvdXRyb1wiOlxuXHRcdFx0dGhpcy5fc3BpbmUgPSBDb21tb24ub3V0cm9BbmltYXRpb25EYXRhXG5cdFx0XHRicmVhaztcblx0fVxufVxubW9kdWxlLmV4cG9ydHMgPSBJbnRyb1NjcmVlbjtcbkludHJvU2NyZWVuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XG5JbnRyb1NjcmVlbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBJbnRyb1NjcmVlbjtcblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5JbnRyb1NjcmVlbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbntcblx0Y29uc29sZS5sb2coXCJJTlRSTyBJTklUSUFMSVpFRFwiKTtcblxuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcblxuXHQvLyBCZ1xuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ3doaXRlU3F1YXJlJ10pO1xuXHR0aGlzLl9iZy5hbHBoYSA9IDE7XG5cdHRoaXMuX2JnLndpZHRoICA9IENvbW1vbi5TVEFHRV9XSURUSDtcblx0dGhpcy5fYmcuaGVpZ2h0ID0gQ29tbW9uLlNUQUdFX0hFSUdIVDtcblx0dGhpcy5fYmcudGludCAgID0gMHg0NzZGQTY7XG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpXG5cblx0Ly8gQW5pbWF0aW9uXG5cdHZhciBiYXJTaXplID0gMTYwO1xuXG5cdHRoaXMuc3BpbmUgPSBuZXcgUElYSS5zcGluZS5TcGluZSh0aGlzLl9zcGluZSk7XG5cdHRoaXMuc3BpbmUueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLnNwaW5lLnkgPSBDb21tb24uU1RBR0VfSEVJR0hULWJhclNpemUrMTtcblx0dGhpcy5zcGluZS5hdXRvVXBkYXRlID0gdHJ1ZTtcblx0dGhpcy5zcGluZS5zY2FsZS5zZXQoMC41KTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLnNwaW5lKTtcblx0dGhpcy5zcGluZS5zdGF0ZS5zZXRBbmltYXRpb25CeU5hbWUoMCwgXCJhbmltYXRpb25cIiwgZmFsc2UsIDApO1xuXG5cblx0dmFyIGJhciA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHRiYXIuYWxwaGEgPSAxO1xuXHRiYXIud2lkdGggID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xuXHRiYXIuaGVpZ2h0ID0gYmFyU2l6ZTtcblx0dGhpcy5hZGRDaGlsZChiYXIpXG5cblx0dmFyIGJhciA9IG5ldyBQSVhJLlNwcml0ZShDb21tb24uZ2VuZXJhdGVkVGV4dHVyZXNbJ2JsYWNrU3F1YXJlJ10pO1xuXHRiYXIuYWxwaGEgPSAxO1xuXHRiYXIud2lkdGggID0gQ29tbW9uLlNUQUdFX1dJRFRIO1xuXHRiYXIuaGVpZ2h0ID0gYmFyU2l6ZTtcblx0YmFyLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC0gYmFyLmhlaWdodDtcblx0dGhpcy5hZGRDaGlsZChiYXIpO1xuXG5cdHZhciBiYXIgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWydibGFja1NxdWFyZSddKTtcblx0YmFyLmFscGhhID0gMTtcblx0YmFyLndpZHRoICA9IDQ0MTtcblx0YmFyLmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuYWRkQ2hpbGQoYmFyKTtcblxuXHR2YXIgYmFyID0gbmV3IFBJWEkuU3ByaXRlKENvbW1vbi5nZW5lcmF0ZWRUZXh0dXJlc1snYmxhY2tTcXVhcmUnXSk7XG5cdGJhci5hbHBoYSAgPSAxO1xuXHRiYXIud2lkdGggID0gNDQxO1xuXHRiYXIueCAgICAgID0gQ29tbW9uLlNUQUdFX1dJRFRILWJhci53aWR0aDtcblx0YmFyLmhlaWdodCA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuYWRkQ2hpbGQoYmFyKTtcblxuXHQvLyBBdWRpb1xuXHRpZighIUNvbW1vbi5iZ011c2ljKSBDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDUwMCk7XG5cblx0Ly8gU3VidGl0bGVzXG5cdGlmKCF3ZWJmb250KVxuXHR7XG5cdFx0dGhpcy5fc3VidGl0bGUgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChcIlRFU1RcIiwge2ZvbnQ6IFwiMzhweCBTdXBlcmNsYXJlbmRvbiBUaXRsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdHRoaXMuX3N1YnRpdGxlLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMiAgLSB0aGlzLl9zdWJ0aXRsZS50ZXh0V2lkdGgvMjtcblx0XHR0aGlzLl9zdWJ0aXRsZS55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAtIHRoaXMuX3N1YnRpdGxlLnRleHRIZWlnaHQvMiAtODA7XG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9zdWJ0aXRsZSk7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0dGhpcy5fc3VidGl0bGUgPSBuZXcgUElYSS5UZXh0KFwiVEVTVFwiLCB7Zm9udDpcIjM4cHggQXJpYWxcIiwgZmlsbDoweGZmZmZmZiwgYWxpZ246J2NlbnRlcid9KTtcblx0XHR0aGlzLl9zdWJ0aXRsZS5wb3NpdGlvbi5zZXQoIENvbW1vbi5TVEFHRV9XSURUSC8yLCBDb21tb24uU1RBR0VfSEVJR0hUIC0gODApO1xuXHRcdHRoaXMuX3N1YnRpdGxlLmFuY2hvci5zZXQoMC41KTtcblx0XHR0aGlzLmFkZENoaWxkKHRoaXMuX3N1YnRpdGxlKTtcblx0fVxuXHR0aGlzLl9zdWJ0aXRsZS5hbHBoYSA9IDA7XG5cblxuXHR0aGlzLl9zdWJ0aXRsZVRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XG5cblx0c3dpdGNoKHRoaXMuX3R5cGUpXG5cdHtcblx0XHRjYXNlIFwiaW50cm9cIjpcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnNldFN1YnRpdGxlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIklOVFJPXzBcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV0pfX0sIDAuNSk7XG5cdFx0XHR0aGlzLl9zdWJ0aXRsZVRsLnRvKHRoaXMuX3N1YnRpdGxlLCAuNSwge2FscGhhOjAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAzKTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnNldFN1YnRpdGxlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIklOVFJPXzFcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV0pfX0sIDQpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgNi41KTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnNldFN1YnRpdGxlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIklOVFJPXzJcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV0pfX0sIDcpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMTUuNSk7XG5cdFx0XHR0aGlzLl9zdWJ0aXRsZVRsLnRvKHRoaXMuX3N1YnRpdGxlLCAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5zZXRTdWJ0aXRsZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJJTlRST18zXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdKX19LCAxNi41KTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDE5KTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnNldFN1YnRpdGxlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIklOVFJPXzRcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV0pfX0sIDIwKTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLmFuaW1hdGVPdXQoKX19LCAzMCk7XG5cblx0XHRcdENvbW1vbi5iZ011c2ljID0gU291bmRTRlgucGxheSgnc2Z4X2ludHJvX2F1ZGlvXzAxJywge2xvb3A6ZmFsc2UsIHZvbHVtZTowfSk7XG5cdFx0XHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDUwMCk7XG5cblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcIm91dHJvXCI6XG5cdFx0XHR0aGlzLl9zdWJ0aXRsZVRsLnRvKHRoaXMuX3N1YnRpdGxlLCAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5zZXRTdWJ0aXRsZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJPVVRST18wXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdKX19LCAwLjUpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgNC41KTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnNldFN1YnRpdGxlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIk9VVFJPXzFcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV0pfX0sIDUpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgOSk7XG5cdFx0XHR0aGlzLl9zdWJ0aXRsZVRsLnRvKHRoaXMuX3N1YnRpdGxlLCAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5zZXRTdWJ0aXRsZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJPVVRST18yXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdKX19LCAxNC41KTtcblx0XHRcdHRoaXMuX3N1YnRpdGxlVGwudG8odGhpcy5fc3VidGl0bGUsIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDE4LjUpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0LCBvblN0YXJ0U2NvcGU6dGhpcywgb25TdGFydDpmdW5jdGlvbigpe3RoaXMuc2V0U3VidGl0bGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiT1VUUk9fM1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXSl9fSwgMTkpO1xuXHRcdFx0dGhpcy5fc3VidGl0bGVUbC50byh0aGlzLl9zdWJ0aXRsZSwgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0LCBvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuYW5pbWF0ZU91dCgpfX0sIDI0KTtcblxuXHRcdFx0Q29tbW9uLmJnTXVzaWMgPSBTb3VuZFNGWC5wbGF5KCdzZnhfb3V0cm9fYXVkaW9fMDEnLCB7bG9vcDpmYWxzZSwgdm9sdW1lOjB9KTtcblx0XHRcdENvbW1vbi5iZ011c2ljLmZhZGVJbihDb21tb24uYmdNdXNpY1ZvbHVtZSwgNTAwKTtcblxuXHRcdFx0YnJlYWs7XG5cdH1cblxuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRoaXMuX3N1YnRpdGxlVGwpO1xuXG5cdC8vIEJ1dHRvbnNcblx0dGhpcy5fbmV4dEJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0KFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRfYmlnXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyX2JpZ1wiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfZG93bl9iaWdcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9za2lwXCIpXG5cdCk7XG5cblx0dGhpcy5fbmV4dEJ1dHRvbi55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAtIDI1MDtcblx0dGhpcy5fbmV4dEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMubmV4dENsaWNrZWQsIHRoaXMpO1xuXHR0aGlzLl9uZXh0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9uZXh0QnV0dG9uKTtcblxuXHQvLyBNdXRlIGJ1dHRvblxuXHR0aGlzLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cblx0KFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9zb3VuZF9vblwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX3NvdW5kX29mZlwiKVxuXHQpO1xuXG5cdHRoaXMuX211dGVCdXR0b24uaWQgPSBcIm11dGVcIjtcblx0dGhpcy5fbXV0ZUJ1dHRvbi55ID0gdGhpcy5fZ3VpQnV0dG9uVG9wTWFyZ2luO1xuXHQvLyB0aGlzLl9tdXRlQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMCwgMCk7XG5cdHRoaXMuX211dGVCdXR0b24uaW5pdCgpO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX211dGVCdXR0b24pO1xufTtcblxuLyoqXG4gKi9cbkludHJvU2NyZWVuLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpXG57XG5cbn07XG5cbi8qKlxuICovXG5JbnRyb1NjcmVlbi5wcm90b3R5cGUucmVzaXplID0gZnVuY3Rpb24oKVxue1xuXHRTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZS5jYWxsKHRoaXMpO1xuXG5cdC8vIHRoaXMuX25leHRCdXR0b24ueCA9IHIybCA/ICh0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpICsgMzApIDogKHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCgpIC0gMzApO1xuXHR0aGlzLl9uZXh0QnV0dG9uLnggPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKSAtIDMwO1xuXHRcblx0dGhpcy5fbXV0ZUJ1dHRvbi54ID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG59O1xuXG4vKipcbiAqL1xuSW50cm9TY3JlZW4ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXG57XG5cbn1cblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19c2NvcGVcbiAqL1xuSW50cm9TY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcblxuXHQvLyBCdXR0b25zXG5cdC8vIHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXHQvLyB0bC50byh0aGlzLl9uZXh0QnV0dG9uLnNjYWxlLCAxLCB7eDoxLCB5OjEsIGVhc2U6RWxhc3RpYy5lYXNlT3V0fSwgMCk7XG5cdC8vIENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdC8vIENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKClcblx0Ly8ge1xuXHRcdC8vIENvbW1vbi5zYXZlZERhdGEuaGFzU2VlbkludHJvID0gdHJ1ZTtcblx0XHQvLyBDb21tb24uc2F2ZWREYXRhLnNhdmUoKTtcblx0XHQvLyB0aGlzLmFuaW1hdGVPdXQoKTtcblx0Ly8gfSwgNC41LCB0aGlzKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5JbnRyb1NjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlT3V0LmNhbGwodGhpcyk7XG5cblx0dGhpcy5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uZGlzcGF0Y2goKTtcbn07XG5cbkludHJvU2NyZWVuLnByb3RvdHlwZS5zZXRTdWJ0aXRsZSA9IGZ1bmN0aW9uKHRleHQpXG57XG5cdGlmKCF3ZWJmb250KVxuXHR7XG5cdFx0dGhpcy5fc3VidGl0bGUueCArPSB0aGlzLl9zdWJ0aXRsZS50ZXh0V2lkdGgvMjtcblx0XHR0aGlzLl9zdWJ0aXRsZS55ICs9IHRoaXMuX3N1YnRpdGxlLnRleHRIZWlnaHQvMjtcblx0XHR0aGlzLl9zdWJ0aXRsZS50ZXh0ID0gdGV4dDtcblx0XHR0aGlzLl9zdWJ0aXRsZS52YWxpZGF0ZSgpO1xuXHRcdHRoaXMuX3N1YnRpdGxlLnggLT0gdGhpcy5fc3VidGl0bGUudGV4dFdpZHRoLzI7XG5cdFx0dGhpcy5fc3VidGl0bGUueSAtPSB0aGlzLl9zdWJ0aXRsZS50ZXh0SGVpZ2h0LzI7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0dGhpcy5fc3VidGl0bGUudGV4dCA9IHRleHQ7XG5cdH1cbn07XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUklWQVRFIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cbkludHJvU2NyZWVuLnByb3RvdHlwZS5uZXh0Q2xpY2tlZCA9IGZ1bmN0aW9uKClcbntcblx0dGhpcy5hbmltYXRlT3V0KCk7XG5cblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XG59O1xuXG4vKipcbiAqL1xuSW50cm9TY3JlZW4ucHJvdG90eXBlLmJ1dHRvbk92ZXIgPSBmdW5jdGlvbigpXG57XG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCIpO1xufTtcblxuLyoqXG4gKi9cbkludHJvU2NyZWVuLnByb3RvdHlwZS5uZXh0Q2xpY2tGaW5pc2ggPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmRpc3BhdGNoKCk7XG59O1xuXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVRURVJTL1NFVFRFUlNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4iLCJ2YXIgQ29tbW9uICAgICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xyXG52YXIgU2ltcGxlU2NyZWVuICAgICAgPSByZXF1aXJlKFwiLi9TaW1wbGVTY3JlZW5cIik7XHJcbnZhciBMZXZlbFNlbGVjdEJ1dHRvbiA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL0xldmVsU2VsZWN0QnV0dG9uXCIpO1xyXG52YXIgU291bmRTRlggICAgICAgICAgPSByZXF1aXJlKFwiLi4vZ2VuZXJhbC9Tb3VuZFNGWFwiKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTlNUUlVDVE9SXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBMZXZlbFNlbGVjdFNjcmVlbihsYXN0TGV2ZWwpXHJcbntcclxuICAgIHRoaXMuX2JnICAgICAgICAgICAgICAgID0gbnVsbDtcclxuICAgIHRoaXMuX2xlZnRCdXR0b25IZWxkICAgID0gZmFsc2U7XHJcbiAgICB0aGlzLl9yaWdodEJ1dHRvbkhlbGQgICA9IGZhbHNlO1xyXG5cdHRoaXMuX3Njcm9sbFBlcmNlbnRhZ2UgID0gMDtcclxuXHR0aGlzLl9zcGVlZCAgICAgICAgID0gMDtcclxuXHR0aGlzLl9zcGVlZE1heCAgICAgID0gMS41O1xyXG5cdHRoaXMuX2FjY2VsbGVyYXRpb24gPSAzO1xyXG5cdHRoaXMuX2RlY2VsbGVyYXRpb24gPSA0O1xyXG5cclxuICAgIHRoaXMuX3Njcm9sbEVuYWJsZWQgICAgID0gdHJ1ZTtcclxuICAgIHRoaXMuX21hcEhvbGRlckJ1ZmZlciAgID0gNzU7XHJcblxyXG5cdHRoaXMuaXNUb3VjaFNjcm9sbGluZyAgPSBmYWxzZTtcclxuXHR0aGlzLnRvdWNoUG9zaXRpb24gICAgID0gMDtcclxuXHJcbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5zaWduYWxzLmhlbHBQcmVzc2VkID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSBMZXZlbFNlbGVjdFNjcmVlbjtcclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTaW1wbGVTY3JlZW4ucHJvdG90eXBlKTtcclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTGV2ZWxTZWxlY3RTY3JlZW47XHJcblxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFVCTElDIE1FVEhPRFNcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKi9cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGNvbnNvbGUubG9nKFwiU1BMQVNIIElOSVRJQUxJWkVEXCIpO1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG5cdC8vIEJhY2tncm91bmRcclxuXHR0aGlzLl9iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2JnX21haW5fbWVudVwiKSk7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2JnKTtcclxuXHJcblx0Ly8gQmFja2dyb3VuZCBwYXJ0aWNsZXNcclxuXHR0aGlzLl9iYWNrZ3JvdW5kUFNDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmRQU0NvbnRhaW5lcik7XHJcblxyXG5cdHRoaXMuYmFja2dyb3VuZFBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5fYmFja2dyb3VuZFBTQ29udGFpbmVyLFxyXG5cdFtcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAwXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2VfMDFcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlXzAzXCIpXHJcblx0XSwgdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJwYXJ0aWNsZV9tZW51X3Nub3dcIikpO1xyXG5cclxuXHR0aGlzLmJhY2tncm91bmRQUy51cGRhdGVTcGF3blBvcyhDb21tb24uU1RBR0VfV0lEVEgvMiwgMCk7XHJcblx0dGhpcy5iYWNrZ3JvdW5kUFMudXBkYXRlKDUpO1xyXG5cdHRoaXMuYmFja2dyb3VuZFBTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHQvLyBNYXBcclxuICAgIHRoaXMuX21hcEhvbGRlciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG4gICAgdGhpcy5fbWFwSG9sZGVyLnggPSB0aGlzLl9jZW50cmUueCAtIChwMy5WaWV3LndpZHRoLzIpICsgdGhpcy5fbWFwSG9sZGVyQnVmZmVyO1xyXG4gICAgdGhpcy5fbWFwSG9sZGVyLnkgPSAxNzU7XHJcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX21hcEhvbGRlcik7XHJcblxyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfYmdfMVwiKSk7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMS5hbmNob3Iuc2V0KDApO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEuc2NhbGUuc2V0KDEvMC44LCAxLzAuOCk7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQodGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEpO1xyXG5cclxuXHRcdHRoaXMuX21hcEhvbGRlci5fbWFwUGllY2UyID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWFwX2JnXzJcIikpO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTIuYW5jaG9yLnNldCgwKTtcclxuXHRcdHRoaXMuX21hcEhvbGRlci5fbWFwUGllY2UyLnNjYWxlLnNldCgxLzAuOCwgMS8wLjgpO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTIueCArPSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMS53aWR0aC0xO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKHRoaXMuX21hcEhvbGRlci5fbWFwUGllY2UyKTtcclxuXHJcblx0XHR0aGlzLl9iZy5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0XHR0aGlzLl9iZy50b3VjaHN0YXJ0ID0gdGhpcy5fYmcubW91c2Vkb3duID0gZnVuY3Rpb24oZSl7dGhpcy5vblRvdWNoU3RhcnQoZSl9LmJpbmQodGhpcyk7XHJcblx0XHR0aGlzLl9iZy50b3VjaG1vdmUgID0gdGhpcy5fYmcubW91c2Vtb3ZlID0gZnVuY3Rpb24oZSl7dGhpcy5vblRvdWNoTW92ZShlKX0uYmluZCh0aGlzKTtcclxuXHRcdHRoaXMuX2JnLnRvdWNoZW5kICAgPSB0aGlzLl9iZy5tb3VzZXVwICAgPSBmdW5jdGlvbihlKXt0aGlzLm9uVG91Y2hFbmQoZSl9LmJpbmQodGhpcyk7XHJcblxyXG5cclxuXHQvLyB0aGlzLl9tYXBIb2xkZXIueE1heCA9IHRoaXMuX21hcEhvbGRlci54O1xyXG5cdC8vIHRoaXMuX21hcEhvbGRlci54TWluID0gdGhpcy5fbWFwSG9sZGVyLnggLSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMS53aWR0aCAtIHRoaXMuX21hcEhvbGRlci5fbWFwUGllY2UyLndpZHRoICsgcDMuVmlldy53aWR0aCAtIDIgKiB0aGlzLl9tYXBIb2xkZXJCdWZmZXI7XHJcblxyXG5cdFx0Ly8gRGV2IGNvZGUgZm9yIGRvdHMgcGxhY2VtZW50XHJcblx0XHQvKlxyXG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEubW91c2Vkb3duID0gZnVuY3Rpb24oZSlcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCIlaSAlaVwiLCBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzKS54LCBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzKS55KTtcclxuXHJcblx0XHRcdHZhciBkb3QgPSBuZXcgUElYSS5TcHJpdGUodGhhdC5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfcGF0aF9vZmZcIikpO1xyXG5cdFx0XHRkb3QuYW5jaG9yID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xyXG5cdFx0XHRkb3QueCA9IGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLng7XHJcblx0XHRcdGRvdC55ID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueTtcclxuXHJcblx0XHRcdHRoYXQuX21hcEhvbGRlci5hZGRDaGlsZChkb3QpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMi5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMi5tb3VzZWRvd24gPSBmdW5jdGlvbihlKVxyXG5cdFx0e1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiVpICVpXCIsIHRoaXMuX21hcEhvbGRlci5fbWFwUGllY2UxLndpZHRoICsgZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueCwgZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueSk7XHJcblxyXG5cdFx0XHR2YXIgZG90ID0gbmV3IFBJWEkuU3ByaXRlKHRoYXQuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWFwX3BhdGhfb2ZmXCIpKTtcclxuXHRcdFx0ZG90LmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdFx0ZG90LnggPSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMS53aWR0aCArIGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLng7XHJcblx0XHRcdGRvdC55ID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueTtcclxuXHJcblx0XHRcdHRoYXQuX21hcEhvbGRlci5hZGRDaGlsZChkb3QpO1xyXG5cdFx0fTtcclxuXHRcdCovXHJcblxyXG5cdC8vIE1hcCBkZWNvXHJcblx0dmFyIGJpcmRzID0gW1xyXG5cdCAgICAgICAgICAgICB7eDo1MDAsIHk6MzIwfSxcclxuXHQgICAgICAgICAgICAge3g6NjcwLCB5OjM2MH0sIHt4OjcxMCwgeTozNzB9LCB7eDo2OTAsIHk6MzgwfSxcclxuXHRcdFx0XHQge3g6OTAwLCB5OjcwfSwge3g6OTQwLCB5OjgwfSxcclxuXHRcdFx0XHQge3g6MTQxMCwgeTozNzB9LCB7eDoxNDMwLCB5OjM4MH1cclxuXHRcdFx0XHRdO1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBiaXJkcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR2YXIgYW5pbWF0aW9uID0gbmV3IHAzLk1vdmllQ2xpcCh0aGlzLl9nZW5lcmF0ZUFuaW1hdGlvblNlcXVlbmNlKFwibWFwX2JpcmRcIiwgNCkpO1xyXG5cdFx0YW5pbWF0aW9uLmFuaW1hdGlvblNwZWVkID0gYW5pbWF0aW9uLnRvdGFsRnJhbWVzLzE7XHJcblx0XHRhbmltYXRpb24uYW5jaG9yICA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcclxuXHRcdGFuaW1hdGlvbi5sb29waW5nID0gdHJ1ZTtcclxuXHRcdGFuaW1hdGlvbi5wb3NpdGlvbiA9IGJpcmRzW2ldO1xyXG5cdFx0YW5pbWF0aW9uLmdvdG9BbmRQbGF5KHAzLlV0aWxzLnJhbmRvbUludCgwLGFuaW1hdGlvbi50b3RhbEZyYW1lcykpO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKGFuaW1hdGlvbik7XHJcblx0fVxyXG5cclxuXHR0aGlzLnJpcHBsZXNMb3dlclBTSG9sZGVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5yaXBwbGVzTG93ZXJQU0hvbGRlci5wb3NpdGlvbi5zZXQoNTAwLCA0ODApO1xyXG5cdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0aGlzLnJpcHBsZXNMb3dlclBTSG9sZGVyKTtcclxuXHR0aGlzLnJpcHBsZXNMb3dlclBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5yaXBwbGVzTG93ZXJQU0hvbGRlcixcclxuXHRbXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcIm1hcF93YXZlXzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtYXBfd2F2ZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWFwX3dhdmVfMDNcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21hcF9yaXBwbGVzX2xvd2VyXCIpKTtcclxuXHR0aGlzLnJpcHBsZXNMb3dlclBTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHR0aGlzLnJpcHBsZXNVcHBlclBTSG9sZGVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5yaXBwbGVzVXBwZXJQU0hvbGRlci5wb3NpdGlvbi5zZXQoMzgwLCA0MTApO1xyXG5cdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0aGlzLnJpcHBsZXNVcHBlclBTSG9sZGVyKTtcclxuXHR0aGlzLnJpcHBsZXNVcHBlclBTID0gbmV3IGNsb3Vka2lkLkVtaXR0ZXIodGhpcy5yaXBwbGVzVXBwZXJQU0hvbGRlcixcclxuXHRbXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcIm1hcF93YXZlXzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtYXBfd2F2ZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWFwX3dhdmVfMDNcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21hcF9yaXBwbGVzX3VwcGVyXCIpKTtcclxuXHR0aGlzLnJpcHBsZXNVcHBlclBTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHR0aGlzLnJpcHBsZXNCcmlkZ2VQU0hvbGRlciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xyXG5cdHRoaXMucmlwcGxlc0JyaWRnZVBTSG9sZGVyLnBvc2l0aW9uLnNldCgxNTcwLCAzOTUpO1xyXG5cdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0aGlzLnJpcHBsZXNCcmlkZ2VQU0hvbGRlcik7XHJcblx0dGhpcy5yaXBwbGVzQnJpZGdlUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLnJpcHBsZXNCcmlkZ2VQU0hvbGRlcixcclxuXHRbXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcIm1hcF93YXZlXzAxXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtYXBfd2F2ZV8wMlwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWFwX3dhdmVfMDNcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21hcF9yaXBwbGVzX2JyaWRnZVwiKSk7XHJcblx0dGhpcy5yaXBwbGVzQnJpZGdlUFMuZW1pdCA9IHRydWU7XHRcclxuXHRcclxuXHR0aGlzLnBvb2xTcGFya2xlc1BTSG9sZGVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0dGhpcy5wb29sU3BhcmtsZXNQU0hvbGRlci5wb3NpdGlvbi5zZXQoMTkyMCwgMTcwKTtcclxuXHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQodGhpcy5wb29sU3BhcmtsZXNQU0hvbGRlcik7XHJcblx0dGhpcy5wb29sU3BhcmtsZXNQUyA9IG5ldyBjbG91ZGtpZC5FbWl0dGVyKHRoaXMucG9vbFNwYXJrbGVzUFNIb2xkZXIsXHJcblx0W1xyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtYXBfc3Rhcl8wMVwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWFwX3N0YXJfMDJcIilcclxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21hcF90cm9sbF9wb29sX3NwYXJrbGVzXCIpKTtcclxuXHR0aGlzLnBvb2xTcGFya2xlc1BTLmVtaXQgPSB0cnVlO1xyXG5cclxuXHJcblx0Ly8gVGV4dDogVGhlIHN0b3J5XHJcblx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJUSEVfU1RPUllcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0aWYoIXdlYmZvbnQpXHJcblx0e1xyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIzNnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdHRleHQudGludCA9IDB4NzE1OTUxO1xyXG5cdFx0dGV4dC54ID0gMTUwLXRleHQudGV4dFdpZHRoLzI7XHJcblx0XHR0ZXh0LnkgPSAxMDUtdGV4dC50ZXh0SGVpZ2h0LzI7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQodGV4dCk7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzNnB4IEFyaWFsXCIsIGZpbGw6MHg3MTU5NTEsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRleHQueCA9IDE1MDtcclxuXHRcdHRleHQueSA9IDEwNTtcclxuXHRcdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0ZXh0KTtcclxuXHR9XHJcblxyXG5cdC8vIFRleHQ6IEFyZW5kZWxsZVxyXG5cdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiQVJFTkRFTExFXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xyXG5cdGlmKCF3ZWJmb250KVxyXG5cdHtcclxuXHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMzJweCBNaWthZGFuIFdoaXRlXCIsIGFsaWduOiBcImNlbnRlclwifSk7XHJcblx0XHR0ZXh0LnRpbnQgPSAweDg5Nzc3MDtcclxuXHRcdHRleHQueCA9IDY2MC10ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0dGV4dC55ID0gMzI1LXRleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKHRleHQpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzJweCBBcmlhbFwiLCBmaWxsOjB4ODk3NzcwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0ZXh0LnggPSA2NjA7XHJcblx0XHR0ZXh0LnkgPSAzMjU7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQodGV4dCk7XHJcblx0fVxyXG5cclxuXHQvLyBUZXh0OiBPYWtlblxyXG5cdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiT0FLRU5cIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0aWYoIXdlYmZvbnQpXHJcblx0e1xyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIzMnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdHRleHQudGludCA9IDB4ODk3NzcwO1xyXG5cdFx0dGV4dC54ID0gMTIyMC10ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0dGV4dC55ID0gMTY1LXRleHQudGV4dEhlaWdodC8yO1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKHRleHQpO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzJweCBBcmlhbFwiLCBmaWxsOjB4ODk3NzcwLCBhbGlnbjonY2VudGVyJ30pO1xyXG5cdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHR0ZXh0LnggPSAxMjIwO1xyXG5cdFx0dGV4dC55ID0gMTY1O1xyXG5cdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKHRleHQpO1xyXG5cdH1cclxuXHJcblx0Ly8gVGV4dDogVHJvbGwncyBkZW5cclxuXHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIlRST0xMU19ERU5cIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XHJcblx0aWYoIXdlYmZvbnQpXHJcblx0e1xyXG5cdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dChjb3B5LCB7Zm9udDogXCIzMnB4IE1pa2FkYW4gV2hpdGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcclxuXHRcdHRleHQudGludCA9IDB4ODk3NzcwO1xyXG5cdFx0dGV4dC54ID0gMTk1MC10ZXh0LnRleHRXaWR0aC8yO1xyXG5cdFx0dGV4dC55ID0gOTAtdGV4dC50ZXh0SGVpZ2h0LzI7XHJcblx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQodGV4dCk7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIzMnB4IEFyaWFsXCIsIGZpbGw6MHg4OTc3NzAsIGFsaWduOidjZW50ZXInfSk7XHJcblx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdHRleHQueCA9IDE5NTA7XHJcblx0XHR0ZXh0LnkgPSA5NTtcclxuXHRcdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0ZXh0KTtcclxuXHR9XHJcblxyXG5cdC8vIENoYXJhY3RlcnNcclxuXHR2YXIga3Jpc3RvZmYgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfY2hhcl9rcmlzdG9mZlwiKSk7XHJcblx0a3Jpc3RvZmYuYW5jaG9yLnNldCgwLjUsIDEpO1xyXG5cdGtyaXN0b2ZmLnBvc2l0aW9uLnNldCgzNTUsIDE5MCk7XHJcblx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKGtyaXN0b2ZmKTtcclxuXHJcblx0dmFyIG9sYWYgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tYXBfY2hhcl9vbGFmXCIpKTtcclxuXHRvbGFmLmFuY2hvci5zZXQoMC41LCAxKTtcclxuXHRvbGFmLnBvc2l0aW9uLnNldCg3NzAsIDE0MCk7XHJcblx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKG9sYWYpO1xyXG5cclxuXHR2YXIgZWxzYSA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX21hcF9jaGFyX2Vsc2FcIikpO1xyXG5cdGVsc2EuYW5jaG9yLnNldCgwLjUsIDEpO1xyXG5cdGVsc2EucG9zaXRpb24uc2V0KDEwMTAsIDQwMCk7XHJcblx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkKGVsc2EpO1xyXG5cclxuXHJcbiBcdC8vIE1hcCBidXR0b25zXHJcblx0dGhpcy5fYnV0dG9ucyA9IFtdO1xyXG5cdHZhciBidXR0b25Db29yZHMgPVxyXG5cdFtcclxuXHRcdHt4OiAxODAsIHk6IDM2MH0sXHJcblx0XHR7eDogMzEwLCB5OiAxNjB9LFxyXG5cdFx0e3g6IDUyMCwgeTogMTUwfSxcclxuXHRcdHt4OiA3MTAsIHk6IDE0NX0sXHJcblx0XHR7eDogODYwLCB5OiAyNjB9LFxyXG5cdFx0e3g6IDk4MCwgeTogNDAwfSxcclxuXHRcdHt4OiAxMTYwLCB5OiA0MTB9LFxyXG5cdFx0e3g6IDEzMDAsIHk6IDMyMH0sXHJcblx0XHR7eDogMTQyMCwgeTogMTYwfSxcclxuXHRcdHt4OiAxNTkwLCB5OiAyMjB9LFxyXG5cdFx0e3g6IDE3NzAsIHk6IDM1MH0sXHJcblx0XHR7eDogMTk2MCwgeTogMzAwfVxyXG5cdF07XHJcblxyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBidXR0b25Db29yZHMubGVuZ3RoOyBpKyspXHJcblx0e1xyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRMZXZlbCAmJiBpID09IENvbW1vbi5zYXZlZERhdGEubGV2ZWxzVW5sb2NrZWQtMSlcclxuXHRcdHtcclxuXHRcdFx0dmFyIGJ1dHRvbiA9IG5ldyBMZXZlbFNlbGVjdEJ1dHRvbihpLCBmYWxzZSk7XHJcblx0XHRcdGJ1dHRvbi5wb3NpdGlvbiA9IGJ1dHRvbkNvb3Jkc1tpXTtcclxuXHRcdFx0YnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkxldmVsQ2xpY2tlZCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuX2J1dHRvbnMucHVzaChidXR0b24pO1xyXG5cdFx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQoYnV0dG9uKTtcclxuXHJcblx0XHRcdHZhciBidXR0b24gPSBuZXcgTGV2ZWxTZWxlY3RCdXR0b24oaSwgdHJ1ZSk7XHJcblx0XHRcdGJ1dHRvbi5wb3NpdGlvbiA9IGJ1dHRvbkNvb3Jkc1tpXTtcclxuXHRcdFx0YnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkxldmVsQ2xpY2tlZCwgdGhpcyk7XHJcblx0XHRcdGJ1dHRvbi5zY2FsZS5zZXQoMCk7XHJcblx0XHRcdHRoaXMuX2J1dHRvbnMucHVzaChidXR0b24pO1xyXG5cdFx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQoYnV0dG9uKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dmFyIGJ1dHRvbiA9IG5ldyBMZXZlbFNlbGVjdEJ1dHRvbihpLCBDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkID4gaSk7XHJcblx0XHRcdGJ1dHRvbi5wb3NpdGlvbiA9IGJ1dHRvbkNvb3Jkc1tpXTtcclxuXHRcdFx0YnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkxldmVsQ2xpY2tlZCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuX2J1dHRvbnMucHVzaChidXR0b24pO1xyXG5cdFx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGQoYnV0dG9uKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIE1hcCBkb3RzXHJcblx0dGhpcy5fZG90cyA9IFtdXHJcblx0dmFyIGNvb3JkcyA9IFtdO1xyXG5cdGNvb3Jkc1swXSA9XHJcblx0W1xyXG5cdFx0WzIxMiwgMjk4XSxcclxuXHRcdFsyMjgsIDI3NF0sXHJcblx0XHRbMjM2LCAyNDhdLFxyXG5cdFx0WzI0MCwgMjIxXSxcclxuXHRcdFsyNDQsIDE5MV1cclxuXHRdO1xyXG5cdGNvb3Jkc1sxXSA9XHJcblx0W1xyXG5cdFx0WzM3MywgMTE5XSxcclxuXHRcdFszOTksIDExMV0sXHJcblx0XHRbNDI3LCAxMTFdLFxyXG5cdFx0WzQ1MSwgMTIwXVxyXG5cdF07XHJcblx0Y29vcmRzWzJdID1cclxuXHRbXHJcblx0XHRbNTgwLCAxODddLFxyXG5cdFx0WzYwMCwgMTk4XSxcclxuXHRcdFs2MjUsIDE5N10sXHJcblx0XHRbNjQ1LCAxODJdXHJcblx0XTtcclxuXHRjb29yZHNbM10gPVxyXG5cdFtcclxuXHRcdFs3NzUsIDE0M10sXHJcblx0XHRbNzk4LCAxNTVdLFxyXG5cdFx0WzgxNCwgMTc3XSxcclxuXHRcdFs4MjYsIDIwMF1cclxuXHRdO1xyXG5cdGNvb3Jkc1s0XSA9XHJcblx0W1xyXG5cdFx0WzkxNywgMzA2XSxcclxuXHRcdFs5MjgsIDMyNV0sXHJcblx0XHRbOTM0LCAzNDldXHJcblx0XTtcclxuXHRjb29yZHNbNV0gPVxyXG5cdFtcclxuXHRcdFsxMDM1LCA0NDFdLFxyXG5cdFx0WzEwNTUsIDQ0OF0sXHJcblx0XHRbMTA3OCwgNDQ2XSxcclxuXHRcdFsxMDk3LCA0MzRdXHJcblx0XTtcclxuXHRjb29yZHNbNl0gPVxyXG5cdFtcclxuXHRcdFsxMjI0LCA0MDRdLFxyXG5cdFx0WzEyMzksIDM4N10sXHJcblx0XHRbMTI0OCwgMzY3XVxyXG5cdF07XHJcblx0Y29vcmRzWzddID1cclxuXHRbXHJcblx0XHRbMTMyMywgMjU2XSxcclxuXHRcdFsxMzI0LCAyMzBdLFxyXG5cdFx0WzEzMjcsIDIwM10sXHJcblx0XHRbMTMzNiwgMTc3XSxcclxuXHRcdFsxMzUzLCAxNThdXHJcblx0XTtcclxuXHRjb29yZHNbOF0gPVxyXG5cdFtcclxuXHRcdFsxNDg3LCAxNDddLFxyXG5cdFx0WzE1MTIsIDE1OF0sXHJcblx0XHRbMTUzMiwgMTc2XVxyXG5cdF07XHJcblx0Y29vcmRzWzldID1cclxuXHRbXHJcblx0XHRbMTY0OSwgMjcxXSxcclxuXHRcdFsxNjYyLCAyOTJdLFxyXG5cdFx0WzE2NzksIDMxMV0sXHJcblx0XHRbMTcwMCwgMzI0XVxyXG5cdF07XHJcblx0Y29vcmRzWzEwXSA9XHJcblx0W1xyXG5cdFx0WzE4MzYsIDM0OF0sXHJcblx0XHRbMTg2MCwgMzM5XSxcclxuXHRcdFsxODc5LCAzMjVdLFxyXG5cdFx0WzE4OTQsIDMwNl1cclxuXHRdO1xyXG5cclxuXHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0aGlzLl9kb3RzW2ldID0gW107XHJcblxyXG5cdFx0aWYoQ29tbW9uLnNhdmVkRGF0YS5zaG93VW5sb2NrZWRMZXZlbCAmJiBpID09IChDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkLTIpKVxyXG5cdFx0e1xyXG5cdFx0XHRmb3IodmFyIHAgPSAwOyBwIDwgY29vcmRzW2ldLmxlbmd0aDsgcCsrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIGRvdCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX21hcF9wYXRoX29mZlwiKSk7XHJcblx0XHRcdFx0ZG90LmFuY2hvci5zZXQoMC41KTtcclxuXHRcdFx0XHRkb3QucG9zaXRpb24uc2V0KGNvb3Jkc1tpXVtwXVswXSwgY29vcmRzW2ldW3BdWzFdKTtcclxuXHRcdFx0XHR0aGlzLl9kb3RzW2ldLnB1c2goZG90KTtcclxuXHRcdFx0XHR0aGlzLl9tYXBIb2xkZXIuYWRkQ2hpbGRBdChkb3QsMik7XHJcblxyXG5cdFx0XHRcdHZhciBkb3RGdWxsID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWFwX3BhdGhfb25cIikpO1xyXG5cdFx0XHRcdGRvdEZ1bGwuYW5jaG9yLnNldCgwLjUpO1xyXG5cdFx0XHRcdGRvdEZ1bGwucG9zaXRpb24uc2V0KGNvb3Jkc1tpXVtwXVswXSwgY29vcmRzW2ldW3BdWzFdKTtcclxuXHRcdFx0XHRkb3RGdWxsLmFscGhhID0gMDtcclxuXHRcdFx0XHR0aGlzLl9kb3RzW2ldLnB1c2goZG90RnVsbCk7XHJcblx0XHRcdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkQXQoZG90RnVsbCwyKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHRmb3IodmFyIHAgPSAwOyBwIDwgY29vcmRzW2ldLmxlbmd0aDsgcCsrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIGRvdCA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkID4gaSsxID8gXCJ1aV9tYXBfcGF0aF9vblwiIDogXCJ1aV9tYXBfcGF0aF9vZmZcIikpO1xyXG5cdFx0XHRcdGRvdC5hbmNob3Iuc2V0KDAuNSk7XHJcblx0XHRcdFx0ZG90LnBvc2l0aW9uLnNldChjb29yZHNbaV1bcF1bMF0sIGNvb3Jkc1tpXVtwXVsxXSk7XHJcblx0XHRcdFx0dGhpcy5fbWFwSG9sZGVyLmFkZENoaWxkQXQoZG90LDIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBDb2luc1xyXG5cdHRoaXMuaW5pdENvaW5Db2ludGFpbmVyKCk7XHJcblxyXG5cdC8vIFVJXHJcblx0dGhpcy5fbGVmdEJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zaWRlbmF2X2Fycm93XCIpXHJcblx0KTtcclxuXHR0aGlzLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzBdLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHR0aGlzLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLmFuY2hvci5zZXQoMCwgMC41KTtcclxuXHR0aGlzLl9sZWZ0QnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcclxuXHR0aGlzLl9sZWZ0QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkxlZnREb3duLCB0aGlzKTtcclxuXHR0aGlzLl9sZWZ0QnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25MZWZ0VXAsIHRoaXMpO1xyXG5cdHRoaXMuX2xlZnRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xyXG5cdHRoaXMuX2xlZnRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG5cdHRoaXMuX2xlZnRCdXR0b24uYWxwaGEgPSAwO1xyXG5cdHRoaXMuYWRkQ2hpbGQodGhpcy5fbGVmdEJ1dHRvbik7XHJcblxyXG5cdHRoaXMuX3JpZ2h0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3NpZGVuYXZfYXJyb3dcIilcclxuXHQpO1xyXG5cdHRoaXMuX3JpZ2h0QnV0dG9uLnNjYWxlLnggPSAtMTtcclxuXHR0aGlzLl9yaWdodEJ1dHRvbi5jaGlsZHJlblswXS5hbmNob3Iuc2V0KDAsIDAuNSk7XHJcblx0dGhpcy5fcmlnaHRCdXR0b24uY2hpbGRyZW5bMV0uYW5jaG9yLnNldCgwLCAwLjUpO1xyXG5cdHRoaXMuX3JpZ2h0QnV0dG9uLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcclxuXHR0aGlzLl9yaWdodEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25SaWdodERvd24sIHRoaXMpO1xyXG5cdHRoaXMuX3JpZ2h0QnV0dG9uLnNpZ25hbHMudXAuYWRkKHRoaXMub25SaWdodFVwLCB0aGlzKTtcclxuXHR0aGlzLl9yaWdodEJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9yaWdodEJ1dHRvbik7XHJcblxyXG5cdC8vIEJhY2sgYnV0dG9uXHJcblx0dGhpcy5fYmtCdXR0b24gPSBuZXcgcDMuQnV0dG9uXHJcblx0KFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX291dFwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdmVyXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX2JhY2tcIilcclxuXHQpO1xyXG5cdHRoaXMuX2JrQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XHJcblx0dGhpcy5fYmtCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uQmFja1ByZXNzZWQsIHRoaXMpO1xyXG5cdHRoaXMuX2JrQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2JrQnV0dG9uKTtcclxuXHJcblx0Ly8gSGVscCBidXR0b25cclxuXHR0aGlzLl9oZWxwQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxyXG5cdChcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3ZlclwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9kb3duXCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9oZWxwXCIpXHJcblx0KTtcclxuXHR0aGlzLl9oZWxwQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcclxuXHR0aGlzLl9oZWxwQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XHJcblx0dGhpcy5faGVscEJ1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25IZWxwUHJlc3NlZCwgdGhpcyk7XHJcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oZWxwQnV0dG9uKTtcclxuXHJcblx0Ly8gTXV0ZSBidXR0b25cclxuXHR0aGlzLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cclxuXHQoXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fb3V0XCIpLFxyXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9jb25fZG93blwiKSxcclxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9jb25fc291bmRfb25cIiksXHJcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX3NvdW5kX29mZlwiKVxyXG5cdCk7XHJcblx0dGhpcy5fbXV0ZUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XHJcblx0dGhpcy5fbXV0ZUJ1dHRvbi5pZCA9IFwibXV0ZVwiO1xyXG5cdHRoaXMuX211dGVCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcclxuXHR0aGlzLl9tdXRlQnV0dG9uLmluaXQoKTtcclxuXHR0aGlzLmFkZENoaWxkKHRoaXMuX211dGVCdXR0b24pO1xyXG5cclxuXHQvLyBTaG93IG5ldyB1bmxvY2tlZCBsZXZlbCBhbmltYXRpb25cclxuXHRpZihDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZExldmVsKVxyXG5cdHtcclxuXHRcdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHRDb21tb24uc2F2ZWREYXRhLnNob3dVbmxvY2tlZExldmVsID0gZmFsc2U7XHJcblx0XHRcdENvbW1vbi5zYXZlZERhdGEuc2F2ZSgpO1xyXG5cdFx0fX0pO1xyXG5cclxuXHRcdFx0Ly8gU2Nyb2xsIHRoZSB2aWV3XHJcblx0XHRcdHZhciB4TWluID0gdGhpcy5fY2VudHJlLnggLSAoTWF0aC5taW4oQ29tbW9uLlNUQUdFX1dJRFRILCBwMy5WaWV3LndpZHRoKS8yKSArIHRoaXMuX21hcEhvbGRlckJ1ZmZlcjtcclxuXHRcdFx0dmFyIHhNYXggPSB4TWluIC0gdGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEud2lkdGggLSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMi53aWR0aCArIE1hdGgubWluKENvbW1vbi5TVEFHRV9XSURUSCwgcDMuVmlldy53aWR0aCkgLSAyICogdGhpcy5fbWFwSG9sZGVyQnVmZmVyO1xyXG5cdFx0XHR2YXIgeFRhcmdldCA9IHRoaXMuX2NlbnRyZS54IC0gYnV0dG9uQ29vcmRzW0NvbW1vbi5zYXZlZERhdGEubGV2ZWxzVW5sb2NrZWQtMV0ueDtcclxuXHRcdFx0dmFyIHNjcm9sbFBlcmNlbnRhZ2VUYXJnZXQgPSBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCh4VGFyZ2V0LXhNaW4pLyh4TWF4LXhNaW4pKSk7XHJcblx0XHRcdHZhciBkZWxheSA9IDAuMjU7XHJcblx0XHRcdHZhciBzY3JvbGxEdXJhdGlvbiA9IHNjcm9sbFBlcmNlbnRhZ2VUYXJnZXQgKiAyO1xyXG5cdFx0XHRpZihzY3JvbGxEdXJhdGlvbiAhPSAwICYmIHNjcm9sbER1cmF0aW9uIDwgMC41KSBzY3JvbGxEdXJhdGlvbiA9IDAuNTtcclxuXHJcblx0XHRcdHRsLnRvKHRoaXMsIHNjcm9sbER1cmF0aW9uLCB7X3Njcm9sbFBlcmNlbnRhZ2U6c2Nyb2xsUGVyY2VudGFnZVRhcmdldCwgZWFzZTpTaW5lLmVhc2VJbk91dCwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy51bmxvY2tQUy51cGRhdGVTcGF3blBvcyh0aGlzLl9idXR0b25zW0NvbW1vbi5zYXZlZERhdGEubGV2ZWxzVW5sb2NrZWRdLngsIHRoaXMuX2J1dHRvbnNbQ29tbW9uLnNhdmVkRGF0YS5sZXZlbHNVbmxvY2tlZF0ueSk7XHJcblx0XHRcdFx0dGhpcy51bmxvY2tQUy5lbWl0ID0gdHJ1ZTtcclxuXHRcdFx0fX0sIGRlbGF5KTtcclxuXHJcblxyXG5cdFx0XHQvLyBSdW4gdGhlIHBhcnRpY2xlIGVmZmVjdFxyXG5cdFx0XHR0aGlzLnVubG9ja1BTQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcblx0XHRcdHRoaXMuX21hcEhvbGRlci5hZGRDaGlsZCh0aGlzLnVubG9ja1BTQ29udGFpbmVyKTtcclxuXHJcblx0XHRcdHRoaXMudW5sb2NrUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLnVubG9ja1BTQ29udGFpbmVyLFxyXG5cdFx0XHRbXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2Vfb2Zmc2V0XzAwXCIpLFxyXG5cdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwicGFydGljbGVfc25vd2ZsYWtlX29mZnNldF8wMVwiKSxcclxuXHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV9vZmZzZXRfMDJcIiksXHJcblx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJwYXJ0aWNsZV9zbm93Zmxha2Vfb2Zmc2V0XzAzXCIpXHJcblx0XHRcdF0sIHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwicGFydGljbGVfbGV2ZWxfdW5sb2NrXCIpKTtcclxuXHJcblx0XHRcdHRoaXMudW5sb2NrUFMuZW1pdCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0Ly8gU2hvdyB0aGUgZG90c1xyXG5cdFx0XHRmb3IodmFyIGQgPSAwOyBkIDwgdGhpcy5fZG90c1tDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkLTJdLmxlbmd0aDsgZCs9MilcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHRsLnRvKHRoaXMuX2RvdHNbQ29tbW9uLnNhdmVkRGF0YS5sZXZlbHNVbmxvY2tlZC0yXVtkXSwgICAwLjI1LCB7YWxwaGE6MCwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCBkZWxheSArIHNjcm9sbER1cmF0aW9uICogMC44ICsgKGQvMisxKSogMC4yNSk7XHJcblx0XHRcdFx0dGwudG8odGhpcy5fZG90c1tDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkLTJdW2QrMV0sIDAuMjUsIHthbHBoYToxLCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sIGRlbGF5ICsgc2Nyb2xsRHVyYXRpb24gKiAwLjggKyAoZC8yKSAgKiAwLjI1KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU2hvdyB0aGUgbGV2ZWwgYnV0dG9uXHJcblx0XHRcdHRsLnRvKHRoaXMuX2J1dHRvbnNbQ29tbW9uLnNhdmVkRGF0YS5sZXZlbHNVbmxvY2tlZF0uc2NhbGUsIDEuMjUsIHt4OjEsIHk6MSwgZWFzZTpFbGFzdGljLmVhc2VPdXQsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7U291bmRTRlgucGxheShcInNmeF91aV9tYXBfbGV2ZWxfdW5sb2NrXzAyXCIpO319KTtcclxuXHJcblx0XHRcdC8vIFNob3cgc2lkZSBidXR0b25zXHJcblx0XHRcdHRoaXMuX2xlZnRCdXR0b24uYWxwaGEgICAgPSAwO1xyXG5cdFx0XHR0aGlzLl9yaWdodEJ1dHRvbi5hbHBoYSAgID0gMDtcclxuXHRcdFx0dGhpcy5fbGVmdEJ1dHRvbi52aXNpYmxlICA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLl9yaWdodEJ1dHRvbi52aXNpYmxlID0gZmFsc2U7XHJcblxyXG5cdFx0XHRpZihzY3JvbGxQZXJjZW50YWdlVGFyZ2V0IDwgMSlcclxuXHRcdFx0XHR0bC50byh0aGlzLl9yaWdodEJ1dHRvbiwgIC4yLCB7YWxwaGE6MSwgZWFzZTpMaW5lYXIuZWFzZU5vbmUsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZT10cnVlO319LCBkZWxheSArIHNjcm9sbER1cmF0aW9uICsgMS4yNSk7XHJcblxyXG5cdFx0XHRpZihzY3JvbGxQZXJjZW50YWdlVGFyZ2V0ID4gMClcclxuXHRcdFx0XHR0bC50byh0aGlzLl9sZWZ0QnV0dG9uLCAgLjIsIHthbHBoYToxLCBlYXNlOkxpbmVhci5lYXNlTm9uZSwgb25TdGFydFNjb3BlOnRoaXMsIG9uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLl9sZWZ0QnV0dG9uLnZpc2libGU9dHJ1ZTt9fSwgZGVsYXkgKyBzY3JvbGxEdXJhdGlvbiArIDEuMjUpO1xyXG5cclxuXHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHR9XHJcblx0ZWxzZVxyXG5cdHtcclxuXHRcdC8vIFNjcm9sbCB0aGUgdmlld1xyXG5cdFx0dmFyIHhNaW4gPSB0aGlzLl9jZW50cmUueCAtIChNYXRoLm1pbihDb21tb24uU1RBR0VfV0lEVEgsIHAzLlZpZXcud2lkdGgpLzIpICsgdGhpcy5fbWFwSG9sZGVyQnVmZmVyO1xyXG5cdFx0dmFyIHhNYXggPSB4TWluIC0gdGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEud2lkdGggLSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMi53aWR0aCArIE1hdGgubWluKENvbW1vbi5TVEFHRV9XSURUSCwgcDMuVmlldy53aWR0aCkgLSAyICogdGhpcy5fbWFwSG9sZGVyQnVmZmVyO1xyXG5cdFx0dmFyIHhUYXJnZXQgPSB0aGlzLl9jZW50cmUueCAtIGJ1dHRvbkNvb3Jkc1tDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkLTFdLng7XHJcblx0XHR2YXIgc2Nyb2xsUGVyY2VudGFnZVRhcmdldCA9IE1hdGgubWluKDEsIE1hdGgubWF4KDAsKHhUYXJnZXQteE1pbikvKHhNYXgteE1pbikpKTtcclxuXHRcdHZhciBkZWxheSA9IDAuMjU7XHJcblx0XHR2YXIgc2Nyb2xsRHVyYXRpb24gPSBzY3JvbGxQZXJjZW50YWdlVGFyZ2V0ICogMjtcclxuXHRcdGlmKHNjcm9sbER1cmF0aW9uICE9IDAgJiYgc2Nyb2xsRHVyYXRpb24gPCAwLjUpIHNjcm9sbER1cmF0aW9uID0gMC41O1xyXG5cclxuXHRcdFR3ZWVuTWF4LnRvKHRoaXMsIHNjcm9sbER1cmF0aW9uLCB7X3Njcm9sbFBlcmNlbnRhZ2U6c2Nyb2xsUGVyY2VudGFnZVRhcmdldCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIGRlbGF5KTtcclxuXHRcdC8vIFNob3cgc2lkZSBidXR0b25zXHJcblx0XHR0aGlzLl9sZWZ0QnV0dG9uLmFscGhhICAgID0gMDtcclxuXHRcdHRoaXMuX3JpZ2h0QnV0dG9uLmFscGhhICAgPSAwO1xyXG5cdFx0dGhpcy5fbGVmdEJ1dHRvbi52aXNpYmxlICA9IGZhbHNlO1xyXG5cdFx0dGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZSA9IGZhbHNlO1xyXG5cclxuXHRcdGlmKHNjcm9sbFBlcmNlbnRhZ2VUYXJnZXQgPCAxKVxyXG5cdFx0XHRUd2Vlbk1heC50byh0aGlzLl9yaWdodEJ1dHRvbiwgIC4yLCB7YWxwaGE6MSwgZWFzZTpMaW5lYXIuZWFzZU5vbmUsIG9uU3RhcnRTY29wZTp0aGlzLCBvblN0YXJ0OmZ1bmN0aW9uKCl7dGhpcy5fcmlnaHRCdXR0b24udmlzaWJsZT10cnVlO319LCBkZWxheSArIHNjcm9sbER1cmF0aW9uICsgMS4yNSk7XHJcblxyXG5cdFx0aWYoc2Nyb2xsUGVyY2VudGFnZVRhcmdldCA+IDApXHJcblx0XHRcdFR3ZWVuTWF4LnRvKHRoaXMuX2xlZnRCdXR0b24sICAuMiwge2FscGhhOjEsIGVhc2U6TGluZWFyLmVhc2VOb25lLCBvblN0YXJ0U2NvcGU6dGhpcywgb25TdGFydDpmdW5jdGlvbigpe3RoaXMuX2xlZnRCdXR0b24udmlzaWJsZT10cnVlO319LCBkZWxheSArIHNjcm9sbER1cmF0aW9uICsgMS4yNSk7XHJcblx0fVxyXG5cclxuXHQvLyBNdXNpY1xyXG5cdGlmKCEhQ29tbW9uLmJnTXVzaWMpIENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgNTAwKTtcclxuXHRDb21tb24uYmdNdXNpYyA9IFNvdW5kU0ZYLnBsYXkoJ214X2Zyb3plbl8wNV9tYXBfbHAnLCB7bG9vcDp0cnVlLCB2b2x1bWU6MH0pO1xyXG5cdENvbW1vbi5iZ011c2ljLmZhZGVJbihDb21tb24uYmdNdXNpY1ZvbHVtZSwgNTAwKTtcclxuXHJcblx0Ly8gTG9zcyBzdHJlYWsgcmV3YXJkXHJcblx0aWYoQ29tbW9uLnNhdmVkRGF0YS5sb3NzU3RyZWFrLmNvdW50ID49IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLmxvc3NTdHJlYWsubG9zc2VzICYmICFDb21tb24uc2F2ZWREYXRhLmxvc3NTdHJlYWsuYXdhcmRlZClcclxuXHR7XHJcblx0XHRDb21tb24uYW5pbWF0b3Iuc2V0VGltZW91dChmdW5jdGlvbigpXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkLmRpc3BhdGNoKFwicmV3YXJkXCIpO1xyXG5cdFx0fSwgMSwgdGhpcyk7XHJcblxyXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQudGV4dCA9IENvbW1vbi5zYXZlZERhdGEuY29pbnMgKyB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcImNvbmZpZ1wiKS5sb3NzU3RyZWFrLnJld2FyZDtcclxuXHR9XHJcblx0Ly8gU2hvdyBjb2xsZWN0IGFsbCBjcnlzdGFscyBtZXNzYWdlP1xyXG5cdGVsc2UgaWYoQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5sZXZlbHMuc2hvdyAgICYmICFDb21tb24uc2F2ZWREYXRhLmVuZEdhbWVNZXNzYWdlLmxldmVscy5zaG93biB8fFxyXG5cdCAgICAgICAgQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5jcnlzdGFscy5zaG93ICYmICFDb21tb24uc2F2ZWREYXRhLmVuZEdhbWVNZXNzYWdlLmNyeXN0YWxzLnNob3duIHx8XHJcblx0XHRcdENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UudHJvbGxzLnNob3cgICAmJiAhQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS50cm9sbHMuc2hvd24pXHJcblx0e1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnNpZ25hbHMuR1VJQnV0dG9uQ2xpY2tlZC5kaXNwYXRjaChcImVuZGdhbWVcIik7XHJcblx0XHR9LCAxLCB0aGlzKTtcclxuXHR9XHJcblx0Ly8gU2hvdyBwcm9tbz9cclxuXHRlbHNlIGlmKENvbW1vbi5zYXZlZERhdGEuY2FuU2hvd1Byb21vKCkpXHJcblx0e1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLnNldFRpbWVvdXQoZnVuY3Rpb24oKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLnNpZ25hbHMuR1VJQnV0dG9uQ2xpY2tlZC5kaXNwYXRjaChcInByb21vXCIpO1xyXG5cdFx0fSwgMSwgdGhpcyk7XHJcblx0fVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIERpc3Bvc2VcclxuICovXHJcbkxldmVsU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxyXG57XHJcblxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlXHJcbiAqL1xyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHRoaXMpO1xyXG5cclxuXHR0aGlzLmJhY2tncm91bmRQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHR0aGlzLnJpcHBsZXNMb3dlclBTLnVwZGF0ZShwMy5UaW1lc3RlcC5kZWx0YVRpbWUpO1xyXG5cdHRoaXMucmlwcGxlc1VwcGVyUFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcblx0dGhpcy5yaXBwbGVzQnJpZGdlUFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XHJcblx0dGhpcy5wb29sU3BhcmtsZXNQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0aWYoISF0aGlzLnVubG9ja1BTKVxyXG5cdFx0dGhpcy51bmxvY2tQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcclxuXHJcblx0aWYodGhpcy5fcmlnaHRCdXR0b25IZWxkKVxyXG5cdHtcclxuXHRcdHRoaXMuX3NwZWVkICs9IHRoaXMuX2FjY2VsbGVyYXRpb24gKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHRpZih0aGlzLl9zcGVlZCA+IHRoaXMuX3NwZWVkTWF4KSB0aGlzLl9zcGVlZCA9IHRoaXMuX3NwZWVkTWF4O1xyXG5cdH1cclxuXHRlbHNlIGlmKHRoaXMuX2xlZnRCdXR0b25IZWxkKVxyXG5cdHtcclxuXHRcdHRoaXMuX3NwZWVkIC09IHRoaXMuX2FjY2VsbGVyYXRpb24gKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHRpZih0aGlzLl9zcGVlZCA8IC10aGlzLl9zcGVlZE1heCkgdGhpcy5fc3BlZWQgPSAtdGhpcy5fc3BlZWRNYXg7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHRpZih0aGlzLl9zcGVlZCA8IDApXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX3NwZWVkICs9IHRoaXMuX2RlY2VsbGVyYXRpb24gKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblx0XHRcdGlmKHRoaXMuX3NwZWVkID4gMClcclxuXHRcdFx0XHR0aGlzLl9zcGVlZCA9IDA7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMuX3NwZWVkID4gMClcclxuXHRcdHtcclxuXHRcdFx0dGhpcy5fc3BlZWQgLT0gdGhpcy5fZGVjZWxsZXJhdGlvbiAqIHAzLlRpbWVzdGVwLmRlbHRhVGltZTtcclxuXHRcdFx0aWYodGhpcy5fc3BlZWQgPCAwKVxyXG5cdFx0XHRcdHRoaXMuX3NwZWVkID0gMDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHRoaXMuX3Njcm9sbFBlcmNlbnRhZ2UgKz0gdGhpcy5fc3BlZWQgKiBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XHJcblxyXG5cdGlmKHRoaXMuX3Njcm9sbFBlcmNlbnRhZ2UgPCAwKVxyXG5cdHtcclxuXHRcdHRoaXMuX3Njcm9sbFBlcmNlbnRhZ2UgPSAwO1xyXG5cdFx0dGhpcy5fbGVmdEJ1dHRvbkhlbGQgPSBmYWxzZTtcclxuXHJcblx0XHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdHRsLnRvKHRoaXMuX2xlZnRCdXR0b24sICAuMiwge2FscGhhOjAsIGVhc2U6TGluZWFyLmVhc2VOb25lLCBvbkNvbXBsZXRlU2NvcGU6dGhpcywgb25Db21wbGV0ZTpmdW5jdGlvbigpe3RoaXMuX2xlZnRCdXR0b24udmlzaWJsZSA9IGZhbHNlfX0sIDApO1xyXG5cdFx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5fc2Nyb2xsUGVyY2VudGFnZSA+IDEpXHJcblx0e1xyXG5cdFx0dGhpcy5fc2Nyb2xsUGVyY2VudGFnZSA9IDE7XHJcblx0XHR0aGlzLl9yaWdodEJ1dHRvbkhlbGQgPSBmYWxzZTtcclxuXHJcblx0XHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcclxuXHRcdHRsLnRvKHRoaXMuX3JpZ2h0QnV0dG9uLCAgLjIsIHthbHBoYTowLCBlYXNlOkxpbmVhci5lYXNlTm9uZSwgb25Db21wbGV0ZVNjb3BlOnRoaXMsIG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLl9yaWdodEJ1dHRvbi52aXNpYmxlID0gZmFsc2V9fSwgMCk7XHJcblx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy5fc3BlZWQgIT0gMClcclxuXHR7XHJcblx0XHRpZih0aGlzLl9yaWdodEJ1dHRvbi5hbHBoYSA9PSAwKVxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLl9yaWdodEJ1dHRvbi52aXNpYmxlID0gdHJ1ZTtcclxuXHRcdFx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0XHRcdHRsLnRvKHRoaXMuX3JpZ2h0QnV0dG9uLCAgLjIsIHthbHBoYToxLCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sIDApO1xyXG5cdFx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0aGlzLl9sZWZ0QnV0dG9uLmFscGhhID09IDApXHJcblx0XHR7XHJcblx0XHRcdHRoaXMuX2xlZnRCdXR0b24udmlzaWJsZSA9IHRydWU7XHJcblx0XHRcdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xyXG5cdFx0XHR0bC50byh0aGlzLl9sZWZ0QnV0dG9uLCAgLjIsIHthbHBoYToxLCBlYXNlOkxpbmVhci5lYXNlTm9uZX0sIDApO1xyXG5cdFx0XHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHZhciB4TWluID0gdGhpcy5fY2VudHJlLnggLSAoTWF0aC5taW4oQ29tbW9uLlNUQUdFX1dJRFRILCBwMy5WaWV3LndpZHRoKS8yKSArIHRoaXMuX21hcEhvbGRlckJ1ZmZlcjs7XHJcblx0dmFyIHhNYXggPSB4TWluIC0gdGhpcy5fbWFwSG9sZGVyLl9tYXBQaWVjZTEud2lkdGggLSB0aGlzLl9tYXBIb2xkZXIuX21hcFBpZWNlMi53aWR0aCArIE1hdGgubWluKENvbW1vbi5TVEFHRV9XSURUSCwgcDMuVmlldy53aWR0aCkgLSAyICogdGhpcy5fbWFwSG9sZGVyQnVmZmVyO1xyXG5cdHRoaXMuX21hcEhvbGRlci54ID0geE1pbiArICh4TWF4IC0geE1pbikgKiB0aGlzLl9zY3JvbGxQZXJjZW50YWdlO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9uIHJlc2l6ZSBjYWxsYmFja1xyXG4gKi9cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcclxuXHJcblx0dGhpcy5fbGVmdEJ1dHRvbi54ICA9IHRoaXMuX2dldEJvcmRlckJ1dHRvblBvc2l0aW9uTGVmdCgpO1xyXG5cdHRoaXMuX3JpZ2h0QnV0dG9uLnggPSB0aGlzLl9nZXRCb3JkZXJCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XHJcblx0dGhpcy5fYmtCdXR0b24ueCAgPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpO1xyXG5cdHRoaXMuX211dGVCdXR0b24ueCAgPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKTtcclxuXHR0aGlzLl9oZWxwQnV0dG9uLnggID0gdGhpcy5fZ2V0U2Vjb25kQnV0dG9uUG9zaXRpb25SaWdodCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb249fSBjYWxsYmFja1xyXG4gKiBAcGFyYW0geyo9fXNjb3BlXHJcbiAqL1xyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKSB7XHJcblxyXG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcclxuXHJcblx0Ly8gdmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KCk7XHJcblx0Ly8gdGwudG8odGhpcy5faGVscEJ1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMSk7XHJcblx0Ly8gdGwudG8odGhpcy5fbXV0ZUJ1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMS4xKTtcclxuXHQvLyB0bC50byh0aGlzLl9ia0J1dHRvbi5zY2FsZSwgIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMSk7XHJcblx0Ly8gQ29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXHJcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXHJcbiAqL1xyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSkge1xyXG5cclxuICAgIFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dC5jYWxsKHRoaXMpO1xyXG59O1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJJVkFURSBNRVRIT0RTXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7IVN0cmluZ30gY2hhcmFjdGVyXHJcbiAqIEBwYXJhbSB7IU51bWJlcn0gZnJhbWVMaW1pdFxyXG4gKiBAcmV0dXJucyB7IXAzLk1vdmllQ2xpcFNlcXVlbmNlfVxyXG4gKi9cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLl9nZW5lcmF0ZUFuaW1hdGlvblNlcXVlbmNlID0gZnVuY3Rpb24oY2hhcmFjdGVyLCBmcmFtZUxpbWl0LCBmcmFtZVN0YXJ0KVxyXG57XHJcblx0aWYoIWZyYW1lU3RhcnQpIGZyYW1lU3RhcnQgPSAwO1xyXG5cclxuXHR2YXIgdGV4dHVyZUFyciA9IFtdO1xyXG5cdGZvcih2YXIgaSA9IGZyYW1lU3RhcnQgKyAxOyBpIDw9IGZyYW1lU3RhcnQgKyBmcmFtZUxpbWl0OyBpKyspXHJcblx0e1xyXG5cdFx0dmFyIG4gPSBcIlwiICsgaTtcclxuXHRcdHdoaWxlKG4ubGVuZ3RoIDwgMikgbiA9IFwiMFwiICsgbjtcclxuXHRcdHRleHR1cmVBcnIucHVzaChjaGFyYWN0ZXIgKyBcIl9cIiArIG4pO1xyXG5cdH1cclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGV4dHVyZUFyci5sZW5ndGg7IGkrKylcclxuXHR7XHJcblx0XHR0ZXh0dXJlQXJyW2ldID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUodGV4dHVyZUFycltpXSk7XHJcblx0fVxyXG5cdHZhciBzZXF1ZW5jZSA9IG5ldyBwMy5Nb3ZpZUNsaXBTZXF1ZW5jZSgpO1xyXG5cdHNlcXVlbmNlLmFkZFRleHR1cmVzKHRleHR1cmVBcnIpO1xyXG5cclxuXHRyZXR1cm4gc2VxdWVuY2U7XHJcbn1cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVWRU5UU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uTGV2ZWxDbGlja2VkID0gZnVuY3Rpb24oYnV0dG9uKVxyXG57XHJcblx0Y29uc29sZS5sb2coXCJTZWxlY3RlZCBsZXZlbCAlaVwiLCBidXR0b24uX2lkKTtcclxuXHRDb21tb24uc2F2ZWREYXRhLmxldmVsID0gYnV0dG9uLl9pZDtcclxuICAgIHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmRpc3BhdGNoKGJ1dHRvbi5pZCk7XHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn1cclxuXHJcbkxldmVsU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5vbkhlbHBQcmVzc2VkID0gZnVuY3Rpb24oZSlcclxue1xyXG5cdHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkLmRpc3BhdGNoKFwiaGVscFwiKTtcclxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcclxufVxyXG5cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uTGVmdERvd24gPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmKHRoaXMuX3Njcm9sbEVuYWJsZWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fbGVmdEJ1dHRvbkhlbGQgPSB0cnVlO1xyXG4gICAgfVxyXG59O1xyXG5cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uTGVmdFVwID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBpZih0aGlzLl9zY3JvbGxFbmFibGVkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2xlZnRCdXR0b25IZWxkID0gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblxyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUub25SaWdodERvd24gPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmKHRoaXMuX3Njcm9sbEVuYWJsZWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fcmlnaHRCdXR0b25IZWxkID0gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuXHJcbkxldmVsU2VsZWN0U2NyZWVuLnByb3RvdHlwZS5vblJpZ2h0VXAgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGlmKHRoaXMuX3Njcm9sbEVuYWJsZWQpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fcmlnaHRCdXR0b25IZWxkID0gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblxyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwYXRjaChcImJhY2tcIik7XHJcblx0U291bmRTRlgucGxheShcInNmeF9idG5fcHJlc3NfMDBcIik7XHJcbn07XHJcblxyXG5cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGUpXHJcbntcclxuXHR0aGlzLmlzVG91Y2hTY3JvbGxpbmcgPSB0cnVlO1xyXG5cdHRoaXMudG91Y2hQb3NpdGlvbiA9IGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLng7XHJcbn07XHJcblxyXG5MZXZlbFNlbGVjdFNjcmVlbi5wcm90b3R5cGUub25Ub3VjaE1vdmUgPSBmdW5jdGlvbihlKVxyXG57XHJcblx0aWYodGhpcy5pc1RvdWNoU2Nyb2xsaW5nKVxyXG5cdHtcclxuXHRcdHZhciBkZWx0YSAgID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueCAtIHRoaXMudG91Y2hQb3NpdGlvbjtcclxuXHRcdHRoaXMuX3NwZWVkID0gLWRlbHRhLzIwOyAvL21hZ2ljIG51bWJlcnMsIHlheVxyXG5cclxuXHRcdHRoaXMudG91Y2hQb3NpdGlvbiA9IGUuZGF0YS5nZXRMb2NhbFBvc2l0aW9uKHRoaXMpLng7XHJcblx0fVxyXG59O1xyXG5cclxuTGV2ZWxTZWxlY3RTY3JlZW4ucHJvdG90eXBlLm9uVG91Y2hFbmQgPSBmdW5jdGlvbihlKVxyXG57XHJcblx0dGhpcy5pc1RvdWNoU2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICB0aGlzLl9sZWZ0QnV0dG9uSGVsZCAgICA9IGZhbHNlO1xyXG4gICAgdGhpcy5fcmlnaHRCdXR0b25IZWxkICAgPSBmYWxzZTtcclxufTtcclxuXHJcblxyXG5cclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVFRFUlMvU0VUVEVSU1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcbiIsIi8qKlxuICogIFByZWxvYWRlclxuICpcbiAqICBDcmVhdGVkIGJ5IExlZ21hbiBvbiA1LzA0LzIwMTUuXG4gKlxuICovXG5cbnZhciBTaW1wbGVTY3JlZW4gICAgICAgID0gcmVxdWlyZShcIi4vU2ltcGxlU2NyZWVuXCIpO1xuXG52YXIgQ29tbW9uICAgICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05TVFJVQ1RPUlxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gUHJlbG9hZGVyKClcbntcbiAgICB0aGlzLmxvYWRlZFBlcmNlbnRhZ2UgICA9IDAuMDtcblxuXHR0aGlzLl9jcnlzdGFsc0NvbnRhaW5lciA9IG51bGw7XG5cdHRoaXMuX2NyeXN0YWxzICAgICAgICAgID0gW107XG4gICAgdGhpcy5fbG9hZGluZ1RleHQgICAgICAgPSBudWxsO1xuXHR0aGlzLl9pbmRleCAgICAgICAgICAgICA9IDA7XG5cbiAgICBTaW1wbGVTY3JlZW4uY2FsbCh0aGlzKTtcbn1cbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xuUHJlbG9hZGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU2ltcGxlU2NyZWVuLnByb3RvdHlwZSk7XG5QcmVsb2FkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHJlbG9hZGVyO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5QcmVsb2FkZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG4gICAgY29uc29sZS5sb2coXCJQUkVMT0FERVIgSU5JVElBTElaRURcIik7XG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XG5cblx0Ly8gQmFja2dyb3VuZFxuICAgIHZhciBiZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInByZWxvYWRlcl9iZ1wiKSk7XG4gICAgdGhpcy5hZGRDaGlsZChiZyk7XG5cblx0Ly8gQ3J5c3RhbCBjb250YWluZXJcbiAgICB0aGlzLl9jcnlzdGFsc0NvbnRhaW5lciA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2xvYWRpbmdfY3J5c3RhbHNfYmdcIikpO1xuICAgIHRoaXMuX2NyeXN0YWxzQ29udGFpbmVyLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcbiAgICB0aGlzLl9jcnlzdGFsc0NvbnRhaW5lci54ID0gKENvbW1vbi5TVEFHRV9XSURUSCAvIDIpO1xuICAgIHRoaXMuX2NyeXN0YWxzQ29udGFpbmVyLnkgPSAoQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDIpICsgMTIwO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fY3J5c3RhbHNDb250YWluZXIpO1xuXG5cdGZvcih2YXIgaSA9IDE7IGkgPD0gMTI7IGkrKylcblx0e1xuXHRcdHZhciBjcnlzdGFsID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbG9hZGluZ19jcnlzdGFsc19cIiArIGkpKTtcblx0XHRjcnlzdGFsLmFuY2hvciA9IG5ldyBQSVhJLlBvaW50KDAuNSwgMC41KTtcblx0XHRjcnlzdGFsLnZpc2libGUgPSBmYWxzZTtcblx0XHR0aGlzLl9jcnlzdGFsc0NvbnRhaW5lci5hZGRDaGlsZChjcnlzdGFsKTtcblx0XHR0aGlzLl9jcnlzdGFscy5wdXNoKGNyeXN0YWwpO1xuXHR9XG5cblxuICAgIHRoaXMubG9hZGVkUGVyY2VudGFnZSA9IDAuMDtcblxuICAgIHRoaXMuX2xvYWRpbmdUZXh0ID0gbmV3IFBJWEkuVGV4dChcIjAlXCIsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4RkZGRkZGLCBhbGlnbjonY2VudGVyJ30pO1xuICAgIHRoaXMuX2xvYWRpbmdUZXh0LnggPSBDb21tb24uU1RBR0VfV0lEVEggLyAyO1xuICAgIHRoaXMuX2xvYWRpbmdUZXh0LnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcbiAgICAvLyB0aGlzLmFkZENoaWxkKHRoaXMuX2xvYWRpbmdUZXh0KTtcbn07XG5cbi8qKlxuICovXG5QcmVsb2FkZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpXG57XG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG59O1xuXG4vKipcbiAqL1xuUHJlbG9hZGVyLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXG57XG4gICAgU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5yZXNpemUuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMueCA9IChwMy5WaWV3LndpZHRoIC0gQ29tbW9uLlNUQUdFX1dJRFRIKSAqIDAuNTtcbiAgICB0aGlzLnkgPSAocDMuVmlldy5oZWlnaHQgLSBDb21tb24uU1RBR0VfSEVJR0hUKSAqIDAuNTtcbn07XG5cbi8qKlxuICovXG5QcmVsb2FkZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcbntcbiAgICAvLyBjb25zb2xlLmxvZyhcIkxPQURJTkc6IFwiICsgdGhpcy5sb2FkZWRQZXJjZW50YWdlKTtcbiAgICAvLyB0aGlzLmxvYWRlZFBlcmNlbnRhZ2UgKz0gMC4xO1xuXG4gICAgLy8gaWYodGhpcy5sb2FkZWRQZXJjZW50YWdlID4gMTAwKVxuICAgICAgICAvLyB0aGlzLmxvYWRlZFBlcmNlbnRhZ2UgPSAwOyovXG5cbiAgICB0aGlzLl9sb2FkaW5nVGV4dC50ZXh0ID0gTWF0aC5yb3VuZCh0aGlzLmxvYWRlZFBlcmNlbnRhZ2UpO1xuXG5cdGZvcih2YXIgaSA9IDA7IGkgPCAodGhpcy5sb2FkZWRQZXJjZW50YWdlICogKHRoaXMuX2NyeXN0YWxzLmxlbmd0aCkpLzEwMDsgaSsrKVxuXHR7XHRcblx0XHR0aGlzLl9jcnlzdGFsc1tpXS52aXNpYmxlID0gdHJ1ZTtcblx0fVxufTtcblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19IHNjb3BlXG4gKi9cblByZWxvYWRlci5wcm90b3R5cGUuYW5pbWF0ZUluID0gZnVuY3Rpb24oY2FsbGJhY2ssIHNjb3BlKVxue1xuICAgIFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZUluLmNhbGwoY2FsbGJhY2ssIHNjb3BlKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5QcmVsb2FkZXIucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpIHtcbiAgICBTaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQuY2FsbChjYWxsYmFjaywgc2NvcGUpO1xuXG4gICAgdmFyIHRpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KHtcbiAgICAgICAgb25Db21wbGV0ZTogY2FsbGJhY2ssXG4gICAgICAgIG9uQ29tcGxldGVTY29wZTogc2NvcGVcbiAgICB9KTtcbiAgICB0aGlzLl90d2VlbnMucHVzaCh0aW1lbGluZSk7XG59O1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFJJVkFURSBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVZFTlRTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VUVEVSUy9TRVRURVJTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4iLCJcbnZhciBDb21tb24gICAgICAgICAgPSByZXF1aXJlKFwiLi4vQ29tbW9uXCIpO1xudmFyIFNjZW5lICAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9saWIvU2NlbmVcIik7XG52YXIgV2lyZWZyYW1lQnV0dG9uID0gcmVxdWlyZShcIi4uL2dlbmVyYWwvV2lyZWZyYW1lQnV0dG9uXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFNpbXBsZVNjcmVlbigpIFxue1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzaWduYWxzLlNpZ25hbH1cbiAgICAgKi9cbiAgICB0aGlzLnNpZ25hbHMgPSB7fTtcbiAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbiA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbiA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkID0gbmV3IHNpZ25hbHMuU2lnbmFsKCk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7cDMuQXNzZXRNYW5hZ2VyfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB0aGlzLl9hc3NldE1hbmFnZXIgPSBwMy5Bc3NldE1hbmFnZXIuaW5zdGFuY2U7XG5cdFxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtBcnJheS48VHdlZW5NYXg+fVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB0aGlzLl90d2VlbnMgPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge1BJWEkuUG9pbnR9XG4gICAgICovXG4gICAgdGhpcy5fY2VudHJlID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAgICovXG4gICAgdGhpcy5fbGVmdEVkZ2UgPSAwO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge051bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl9yaWdodEVkZ2UgPSAwO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge051bWJlcn1cbiAgICAgKi9cbiAgICB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW4gPSAxMDA7XG5cdFxuICAgIHAzLlNjcmVlbi5jYWxsKHRoaXMpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBTaW1wbGVTY3JlZW47XG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTY2VuZS5wcm90b3R5cGUpO1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFNpbXBsZVNjcmVlbjtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBVQkxJQyBNRVRIT0RTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fdHdlZW5zID0gW107XG4gICAgdGhpcy5fY2VudHJlID0gbmV3IFBJWEkuUG9pbnQoQ29tbW9uLlNUQUdFX1dJRFRILzIsIENvbW1vbi5TVEFHRV9IRUlHSFQvMik7XG59O1xuXG4vKipcbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zaWduYWxzLnJlcXVlc3RlZE5leHRTY3JlZW4uZGlzcG9zZSgpO1xuICAgIHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWRQcmV2aW91c1NjcmVlbi5kaXNwb3NlKCk7XG5cbiAgICB2YXIgdHdlZW47XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl90d2VlbnMubGVuZ3RoOyArKyBpKSB7XG4gICAgICAgIHR3ZWVuID0gdGhpcy5fdHdlZW5zW2ldO1xuICAgICAgICBpZiAodHdlZW4pIHtcbiAgICAgICAgICAgIHR3ZWVuLmtpbGwoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl90d2VlbnMubGVuZ3RoID0gMDtcblxuICAgIGNvbnNvbGUubG9nKFwic2NyZWVuIGRpc3Bvc2VkXCIpO1xuXG4gICAgVHdlZW5NYXgua2lsbEFsbCgpO1xuICAgIENvbW1vbi5hbmltYXRvci5yZW1vdmVBbGwoKTtcbn07XG5cbi8qKlxuICovXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgdGhpcy54ID0gKHAzLlZpZXcud2lkdGggLSBDb21tb24uU1RBR0VfV0lEVEgpICogMC41O1xuXG4gICAgdGhpcy5fcmlnaHRFZGdlID0gdGhpcy5fY2VudHJlLnggKyAocDMuVmlldy53aWR0aC8yKTtcbiAgICB0aGlzLl9sZWZ0RWRnZSA9IHRoaXMuX2NlbnRyZS54IC0gKHAzLlZpZXcud2lkdGgvMik7XG5cblx0aWYodGhpcy5fY29pbnNDb250YWluZXIpXG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIueCA9IHRoaXMuX2dldFNlY29uZEJ1dHRvblBvc2l0aW9uTGVmdCgpO1xuXG5cdC8qXG4gICAgaWYodGhpcy5fYmFja0J1dHRvbilcbiAgICB7XG4gICAgICAgIHRoaXMuX2JhY2tCdXR0b24ueCA9IHRoaXMuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25MZWZ0KCk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5fcGF1c2VCdXR0b24pXG4gICAge1xuICAgICAgICB0aGlzLl9wYXVzZUJ1dHRvbi54ID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5faGVscEJ1dHRvbilcbiAgICB7XG4gICAgICAgIHRoaXMuX2hlbHBCdXR0b24ueCA9IHRoaXMuX2dldFNlY29uZEJ1dHRvblBvc2l0aW9uUmlnaHQoKTtcbiAgICB9XG5cbiAgICBpZih0aGlzLl9tdXRlQnV0dG9uKVxuICAgIHtcbiAgICAgICAgdGhpcy5fbXV0ZUJ1dHRvbi54ID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG4gICAgfVxuXHQqL1xufTtcblxuLyoqXG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmFuaW1hdGVJbihmdW5jdGlvbigpIHtcblxuICAgIH0sIHRoaXMpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7Kj19c2NvcGVcbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4gPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpIHtcbiAgICBzY29wZSA9IHNjb3BlIHx8IHdpbmRvdztcbn07XG5cbi8qKlxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNhbGxiYWNrXG4gKiBAcGFyYW0geyo9fSBzY29wZVxuICovXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpIHtcbiAgICBzY29wZSA9IHNjb3BlIHx8IHdpbmRvdztcbn07XG5cbi8qXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLmluaXRQYXVzZUJ1dHRvbiA9IGZ1bmN0aW9uKClcbntcbiAgICB0aGlzLl9wYXVzZUJ1dHRvbiA9IG5ldyBXaXJlZnJhbWVCdXR0b24oXCJQYXVzZVwiKTtcbiAgICB0aGlzLl9wYXVzZUJ1dHRvbi5pZCA9IFwicGF1c2VcIjtcbiAgICB0aGlzLl9wYXVzZUJ1dHRvbi55ID0gdGhpcy5fZ3VpQnV0dG9uVG9wTWFyZ2luO1xuICAgIHRoaXMuX3BhdXNlQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMC42LCAwLjYpO1xuICAgIHRoaXMuX3BhdXNlQnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkdVSUJ1dHRvbkNsaWNrZWQsIHRoaXMpO1xuICAgIC8vdGhpcy5fcGF1c2VCdXR0b24uZG93blNvdW5kTmFtZSA9IFwic2Z4X2J0bl9wcmVzc19md2RfMDBcIjtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX3BhdXNlQnV0dG9uKTtcbn07XG5cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdEhlbHBCdXR0b24gPSBmdW5jdGlvbigpXG57XG4gICAgdGhpcy5faGVscEJ1dHRvbiA9IG5ldyBXaXJlZnJhbWVCdXR0b24oXCJIZWxwXCIpO1xuICAgIHRoaXMuX2hlbHBCdXR0b24uaWQgPSBcImhlbHBcIjtcbiAgICB0aGlzLl9oZWxwQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG4gICAgdGhpcy5faGVscEJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAuNiwgMC42KTtcbiAgICB0aGlzLl9oZWxwQnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkdVSUJ1dHRvbkNsaWNrZWQsIHRoaXMpO1xuICAgIC8vdGhpcy5fcGF1c2VCdXR0b24uZG93blNvdW5kTmFtZSA9IFwic2Z4X2J0bl9wcmVzc19md2RfMDBcIjtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2hlbHBCdXR0b24pO1xufTtcblxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0QmFja0J1dHRvbiA9IGZ1bmN0aW9uKGhvbWUpXG57XG4gICAgdGhpcy5fYmFja0J1dHRvbiA9IG5ldyBXaXJlZnJhbWVCdXR0b24oaG9tZSA/IFwiSG9tZVwiIDogXCJCYWNrXCIpO1xuICAgIHRoaXMuX2JhY2tCdXR0b24uaWQgPSBcImJhY2tcIjtcbiAgICB0aGlzLl9iYWNrQnV0dG9uLnNjYWxlID0gbmV3IFBJWEkuUG9pbnQoMC42LCAwLjYpO1xuICAgIHRoaXMuX2JhY2tCdXR0b24ueSA9IHRoaXMuX2d1aUJ1dHRvblRvcE1hcmdpbjtcbiAgICB0aGlzLl9iYWNrQnV0dG9uLnNpZ25hbHMuY2xpY2tlZC5hZGQodGhpcy5vbkdVSUJ1dHRvbkNsaWNrZWQsIHRoaXMpO1xuICAgIC8vdGhpcy5fcGF1c2VCdXR0b24uZG93blNvdW5kTmFtZSA9IFwic2Z4X2J0bl9wcmVzc19md2RfMDBcIjtcbiAgICB0aGlzLmFkZENoaWxkKHRoaXMuX2JhY2tCdXR0b24pO1xufTtcblxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5pbml0TXV0ZUJ1dHRvbiA9IGZ1bmN0aW9uKClcbntcbiAgICB2YXIgc291bmRPbiA9IG5ldyBXaXJlZnJhbWVCdXR0b24oXCJTb3VuZCBPblwiKTtcbiAgICB2YXIgc291bmRPZmYgPSBuZXcgV2lyZWZyYW1lQnV0dG9uKFwiU291bmQgT2ZmXCIpO1xuXG4gICAgdmFyIGJsYW5rID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgdmFyIGJsYW5rVGV4dHVyZSA9IGJsYW5rLmdlbmVyYXRlVGV4dHVyZShDb21tb24ucmVuZGVyZXIsIDEuMCwgUElYSS5TQ0FMRV9NT0RFUy5MSU5FQVIpO1xuXG4gICAgdGhpcy5fbXV0ZUJ1dHRvbiA9IG5ldyBwMy5NdXRlQnV0dG9uKGJsYW5rVGV4dHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFua1RleHR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxhbmtUZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdW5kT24udGV4dHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VuZE9mZi50ZXh0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICB0aGlzLl9tdXRlQnV0dG9uLmlkID0gXCJtdXRlXCI7XG4gICAgdGhpcy5fbXV0ZUJ1dHRvbi5zY2FsZSA9IG5ldyBQSVhJLlBvaW50KDAuNiwgMC42KTtcbiAgICB0aGlzLl9tdXRlQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG4gICAgdGhpcy5hZGRDaGlsZCh0aGlzLl9tdXRlQnV0dG9uKTtcbn07XG4qL1xuXG5cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdENvaW5Db2ludGFpbmVyID0gZnVuY3Rpb24odmFsdWUpXG57XG5cdHZhbHVlID0gKHR5cGVvZih2YWx1ZSkgIT0gXCJ1bmRlZmluZWRcIikgPyB2YWx1ZSA6IENvbW1vbi5zYXZlZERhdGEuY29pbnM7XG5cdFxuXHRpZighdGhpcy5fY29pbnNDb250YWluZXIpXG5cdHtcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLl9jb2luc0NvbnRhaW5lcik7XG5cblx0XHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl9iZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3Nub3dmbGFrZV9iZ1wiKSk7XG5cdFx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fYmcuYW5jaG9yLnNldCgwLCAwLjUpO1xuXHRcdFx0dGhpcy5fY29pbnNDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fY29pbnNDb250YWluZXIuX2JnKTtcblxuXHRcdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh2YWx1ZS50b1N0cmluZygpLCB7Zm9udDogXCIzMnB4IFN1cGVyY2xhcmVuZG9uIE51bWJlcnNcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnggPSAtdGhpcy5fY29pbnNDb250YWluZXIuX3RleHQudGV4dFdpZHRoLzIgICsgdGhpcy5fY29pbnNDb250YWluZXIud2lkdGgvMiArIDE1O1xuXHRcdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueSA9IC10aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0SGVpZ2h0LzI7XG5cdFx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dCk7XG5cblx0XHRcdC8vIHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0ID0gbmV3IFBJWEkuVGV4dChDb21tb24uc2F2ZWREYXRhLmNvaW5zLCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweGZmZmZmZiwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdC8vIHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnggPSB0aGlzLl9jb2luc0NvbnRhaW5lci53aWR0aC8yICsgMTA7XG5cdFx0XHQvLyB0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHQvLyB0aGlzLl9jb2luc0NvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dCk7XG5cblx0XHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX3Nub3dmbGFrZVwiKSk7XG5cdFx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fc25vd2ZsYWtlLnggPSAyMDtcblx0XHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl9zbm93Zmxha2UuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0dGhpcy5fY29pbnNDb250YWluZXIuYWRkQ2hpbGQodGhpcy5fY29pbnNDb250YWluZXIuX3Nub3dmbGFrZSk7XG5cdH1cblx0ZWxzZVxuXHR7XHRcblx0XHR0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC54ICs9IHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnRleHRXaWR0aC8yO1xuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnRleHQgPSB2YWx1ZS50b1N0cmluZygpO1xuXHRcdHRoaXMuX2NvaW5zQ29udGFpbmVyLl90ZXh0LnZhbGlkYXRlKCk7XG5cdFx0dGhpcy5fY29pbnNDb250YWluZXIuX3RleHQueCAtPSB0aGlzLl9jb2luc0NvbnRhaW5lci5fdGV4dC50ZXh0V2lkdGgvMjtcblx0fVxufTtcblxuLyoqXG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaGlkZUdVSSA9IGZ1bmN0aW9uKCkge1xuXG59O1xuXG4vKipcbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5zaG93R1VJID0gZnVuY3Rpb24oKSB7XG5cbn07XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBSSVZBVEUgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4vKipcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuX2dldEZpcnN0QnV0dG9uUG9zaXRpb25SaWdodCA9IGZ1bmN0aW9uKClcbntcblx0cmV0dXJuIHRoaXMuX2dldEJvcmRlckJ1dHRvblBvc2l0aW9uUmlnaHQoKSAtIDkwO1xufVxuXG4vKipcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuX2dldFNlY29uZEJ1dHRvblBvc2l0aW9uUmlnaHQgPSBmdW5jdGlvbigpXG57XG5cdHJldHVybiB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uUmlnaHQoKSAtIDEwMDtcbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7TnVtYmVyfVxuICovXG5TaW1wbGVTY3JlZW4ucHJvdG90eXBlLl9nZXRCb3JkZXJCdXR0b25Qb3NpdGlvblJpZ2h0ID0gZnVuY3Rpb24oKVxue1xuXHRyZXR1cm4gTWF0aC5taW4oTWF0aC5yb3VuZCgoQ29tbW9uLlNUQUdFX1dJRFRIICsgcDMuVmlldy53aWR0aCkgKiAwLjUpLCBDb21tb24uU1RBR0VfV0lEVEggLSAxNTApO1xufVxuXG5cbi8qKlxuICogQHJldHVybnMge051bWJlcn1cbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvbkxlZnQgPSBmdW5jdGlvbigpXG57XG4gICAgcmV0dXJuIHRoaXMuX2dldEJvcmRlckJ1dHRvblBvc2l0aW9uTGVmdCgpICsgOTA7XG59XG5cbi8qKlxuICogQHJldHVybnMge051bWJlcn1cbiAqL1xuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5fZ2V0U2Vjb25kQnV0dG9uUG9zaXRpb25MZWZ0ID0gZnVuY3Rpb24oKVxue1xuICAgIHJldHVybiB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpICsgMTAwO1xufVxuXG4vKipcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUuX2dldEJvcmRlckJ1dHRvblBvc2l0aW9uTGVmdCA9IGZ1bmN0aW9uKClcbntcbiAgIHJldHVybiBNYXRoLm1heChNYXRoLnJvdW5kKChDb21tb24uU1RBR0VfV0lEVEggLSBwMy5WaWV3LndpZHRoKSAqIDAuNSksIDE1MCk7XG59XG5cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuU2ltcGxlU2NyZWVuLnByb3RvdHlwZS5vbkdVSUJ1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbihidXR0b24pXG57XG4gICAgaWYoYnV0dG9uLmlkID09IFwiYmFja1wiKVxuICAgICAgICB0aGlzLnNpZ25hbHMucmVxdWVzdGVkUHJldmlvdXNTY3JlZW4uZGlzcGF0Y2goYnV0dG9uLmlkKTtcbiAgICBlbHNlXG4gICAgICAgIHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkLmRpc3BhdGNoKGJ1dHRvbi5pZCk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7IXAzLkJ1dHRvbn0gYnV0dG9uXG4gKi9cblNpbXBsZVNjcmVlbi5wcm90b3R5cGUub25CdXR0b25DbGlja2VkUHJldmlvdXMgPSBmdW5jdGlvbihidXR0b24pIHtcblxufTtcblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VUVEVSUy9TRVRURVJTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4iLCJ2YXIgQ29tbW9uICAgICAgIFx0ICA9IHJlcXVpcmUoXCIuLi9Db21tb25cIik7XG52YXIgU2ltcGxlU2NyZWVuIFx0ICA9IHJlcXVpcmUoXCIuL1NpbXBsZVNjcmVlblwiKTtcbnZhciBXaXJlZnJhbWVCdXR0b24gICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1dpcmVmcmFtZUJ1dHRvblwiKTtcbnZhciBTb3VuZFNGWCAgICAgICAgICA9IHJlcXVpcmUoXCIuLi9nZW5lcmFsL1NvdW5kU0ZYXCIpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OU1RSVUNUT1Jcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFNwbGFzaFNjcmVlbigpXG57XG5cdHRoaXMuem9vbSA9IDE7XG5cdHRoaXMuZm9jdXNQb3NpdGlvbiAgICA9IG5ldyBQSVhJLlBvaW50KENvbW1vbi5TVEFHRV9XSURUSCAvIDIsIENvbW1vbi5TVEFHRV9IRUlHSFQgLyAyKTtcblx0dGhpcy5vbGRGb2N1c1Bvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQodGhpcy5mb2N1c1Bvc2l0aW9uLngsIHRoaXMuZm9jdXNQb3NpdGlvbi55KTtcblx0dGhpcy5mb2N1c1BvaW50ICAgID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xuXG5cdHRoaXMuX21haW5Db250YWluZXIgPSBudWxsO1xuXHR0aGlzLl9jZW50cmFsQXJlYSAgID0gbnVsbDtcblx0dGhpcy5fbGVmdEFyZWEgICAgICA9IG51bGw7XG5cdHRoaXMuX3JpZ2h0QXJlYSAgICAgPSBudWxsO1xuXG5cdHRoaXMuX2xlZnRCdXR0b24gID0gbnVsbDtcblx0dGhpcy5fcmlnaHRCdXR0b24gPSBudWxsO1xuXG5cdHRoaXMuX2N1cnJlbnRTY3JlZW4gPSAxO1xuXHR0aGlzLl9jdXJyZW50Y29tbSAgID0gMDtcblx0dGhpcy5fY29tbXNEYXRhID0gbnVsbDtcblx0dGhpcy5fY29tbXMgPSBbXTtcblxuXHR0aGlzLmhhbmRsZUFjdGl2ZSA9IGZhbHNlO1xuXHR0aGlzLmhhbmRsZVkgICAgICA9IDA7XG5cdHRoaXMuaGFuZGxlTWluWSAgID0gLSAxODA7XG5cdHRoaXMuaGFuZGxlTWF4WSAgID0gKyAyMDA7XG5cblx0dGhpcy5oYW5kbGVTRlggPSBudWxsO1xuXHR0aGlzLmhhbmRsZVNGWENvdW50ZG93biA9IDA7XG5cblx0dGhpcy5wYXJhbGxheExheWVycyA9IFtdO1xuXG5cdFNpbXBsZVNjcmVlbi5jYWxsKHRoaXMpO1xuXG5cdHRoaXMuaXNFbmRsZXNzVW5sb2NrZWQgPSBDb21tb24uc2F2ZWREYXRhLmxldmVsc1VubG9ja2VkID4gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJjb25maWdcIikuZW5kbGVzcy5sZXZlbFJlcXVpcmVkXG5cdHRoaXMuc2hvd0ludHJvID0gQ29tbW9uLnNhdmVkRGF0YS5zaG93U3BsYXNoSW50cm87XG5cdENvbW1vbi5zYXZlZERhdGEuc2hvd1NwbGFzaEludHJvID0gZmFsc2U7XG5cblx0dGhpcy5zaWduYWxzLmxpbmtDbGljayA9IG5ldyBzaWduYWxzLlNpZ25hbCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaFNjcmVlbjtcblNwbGFzaFNjcmVlbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNpbXBsZVNjcmVlbi5wcm90b3R5cGUpO1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFNwbGFzaFNjcmVlbjtcblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFVCTElDIE1FVEhPRFNcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpXG57XG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMpO1xuXG5cdC8vIEJhY2tncm91bmRcblx0dGhpcy5fYmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9iZ19tYWluX21lbnVcIikpO1xuICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5fYmcpO1xuXG5cdC8vIE5vcnRoZXJuIGxpZ2h0c1xuXHR0aGlzLl9ub3J0aGVybkxpZ2h0cyA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXG5cdFx0dmFyIGxheWVycyA9IFtdO1xuXHRcdGxheWVycy5wdXNoKHtpbWFnZTpcIm5vcnRoZXJuX2xpZ2h0c19ibHVlXCIsICB4U2NhbGU6NCwgICB5U2NhbGU6MiwgICB5Oi0xODAsICB4VGlsaW5nOjE1LH0pO1xuXHRcdGxheWVycy5wdXNoKHtpbWFnZTpcIm5vcnRoZXJuX2xpZ2h0c19ncmVlblwiLCB4U2NhbGU6NCwgICB5U2NhbGU6MiwgICB5Oi0yMTUsICB4VGlsaW5nOi0yMH0pO1xuXHRcdGxheWVycy5wdXNoKHtpbWFnZTpcIm5vcnRoZXJuX2xpZ2h0c19waW5rXCIsICB4U2NhbGU6NCwgICB5U2NhbGU6MiwgICB5Oi0yNTAsICB4VGlsaW5nOjEwLCB9KTtcblxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsYXllcnMubGVuZ3RoOyBpKyspXG5cdFx0e1xuXHRcdFx0dmFyIHRleHR1cmUgID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUobGF5ZXJzW2ldLmltYWdlKTtcblx0XHRcdHZhciBiZyAgICAgICA9IG5ldyBQSVhJLmV4dHJhcy5UaWxpbmdTcHJpdGUodGV4dHVyZSwgQ29tbW9uLlNUQUdFX1dJRFRILCB0ZXh0dXJlLmNyb3AuaGVpZ2h0ICogbGF5ZXJzW2ldLnlTY2FsZSk7XG5cdFx0XHRiZy50aWxlU2NhbGUgPSBuZXcgUElYSS5Qb2ludChsYXllcnNbaV0ueFNjYWxlLCBsYXllcnNbaV0ueVNjYWxlKTtcblx0XHRcdGJnLnkgICAgICAgICA9IGxheWVyc1tpXS55O1xuXHRcdFx0YmcuYWxwaGEgICAgID0gQ29tbW9uLnNhdmVkRGF0YS5nZXRDb2xsZWN0ZWRDcnlzdGFsQ291bnQoKSAvIENvbW1vbi5zYXZlZERhdGEuZ2V0Q3J5c3RhbENvdW50KCk7XG5cdFx0XHRiZy54VGlsaW5nICAgPSBsYXllcnNbaV0ueFRpbGluZztcblx0XHRcdHRoaXMuX25vcnRoZXJuTGlnaHRzLmFkZENoaWxkKGJnKTtcblx0XHR9XG5cblx0dGhpcy5fYmcuYWRkQ2hpbGQodGhpcy5fbm9ydGhlcm5MaWdodHMpO1xuXG5cblx0Ly8gTWFpbiBjb250YWluZXJcblx0dGhpcy5fbWFpbkNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX21haW5Db250YWluZXIpO1xuXG5cdC8vIEJhY2tncm91bmQgZWxlbWVudHNcblx0dGhpcy5fYmFja2dyb3VuZCA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9iYWNrZ3JvdW5kLnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcblx0dGhpcy5fYmFja2dyb3VuZC55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAtMTAwO1xuXHR0aGlzLl9tYWluQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQpO1xuXG5cdFx0Ly8gdGhpcy5fYmFja2dyb3VuZC5fYmx1ciA9IG5ldyBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlcigpO1xuXHRcdC8vIHRoaXMuX2JhY2tncm91bmQuX2JsdXIuYmx1clggPSA2O1xuXHRcdC8vIHRoaXMuX2JhY2tncm91bmQuX2JsdXIuYmx1clkgPSA2O1xuXHRcdC8vIHRoaXMuX2JhY2tncm91bmQuZmlsdGVycyA9IFt0aGlzLl9iYWNrZ3JvdW5kLl9ibHVyXTtcblxuXHRcdHRoaXMuX2JhY2tncm91bmQuX3JvY2tfMDAgPSAgbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWVudV9yb2NrXzAwXCIpKTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLl9yb2NrXzAwLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLl9yb2NrXzAwLnggLT0gMzUwO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuYWRkQ2hpbGQodGhpcy5fYmFja2dyb3VuZC5fcm9ja18wMCk7XG5cblx0XHR0aGlzLl9iYWNrZ3JvdW5kLl90cmVlXzAwID0gIG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcIm1lbnVfdHJlZV8wNVwiKSk7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMC5hbmNob3Iuc2V0KDAuNSwgMSk7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMC54IC09IDUwMDtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDApO1xuXG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMSA9ICBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtZW51X3RyZWVfMDZcIikpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDEuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDEueCArPSA0ODA7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMS55ICs9IDEwMDtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDEpO1xuXG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMiA9ICBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtZW51X3RyZWVfMDVcIikpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDIuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDIueCArPSA5NTA7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMi5zY2FsZS5zZXQoLTAuOCwgMC44KTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDIpO1xuXG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMyA9ICBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJtZW51X3RyZWVfMDZcIikpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDMuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDMueCAtPSA5ODA7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMy55ICs9IDQwO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDMuc2NhbGUuc2V0KDAuNywgMC43KTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDMpO1xuXG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fY2FycmlhZ2VfMDAgPSAgbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwibWVudV9jYXJyaWFnZV8wMFwiKSk7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fY2FycmlhZ2VfMDAuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX2NhcnJpYWdlXzAwLnggKz0gNDIwO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuX2NhcnJpYWdlXzAwLnkgKz0gLTExMDtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmQuX2NhcnJpYWdlXzAwKTtcblxuXHRcdHZhciB0ZXh0dXJlID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tZW51X3Nub3dcIik7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fYmcgPSBuZXcgUElYSS5leHRyYXMuVGlsaW5nU3ByaXRlKHRleHR1cmUsIENvbW1vbi5TVEFHRV9XSURUSCAqIDMsIHRleHR1cmUuaGVpZ2h0KTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLl9iZy5hbmNob3Iuc2V0KDAuNSwgMSk7XG5cdFx0dGhpcy5fYmFja2dyb3VuZC5fYmcudGlsZVBvc2l0aW9uLnggKz0gdGV4dHVyZS53aWR0aC8yO1xuXHRcdHRoaXMuX2JhY2tncm91bmQuYWRkQ2hpbGQodGhpcy5fYmFja2dyb3VuZC5fYmcpO1xuXG5cdFx0dmFyIGZpbGwgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWyd3aGl0ZVNxdWFyZSddKTtcblx0XHRmaWxsLndpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRIICogMztcblx0XHRmaWxsLmhlaWdodCA9IDMwMDtcblx0XHRmaWxsLnRpbnQgPSAweDliYzZlNTtcblx0XHRmaWxsLmFuY2hvci5zZXQoMC41LCAwKTtcblx0XHR0aGlzLl9iYWNrZ3JvdW5kLmFkZENoaWxkKGZpbGwpO1xuXG5cdC8vIEJhY2tncm91bmQgcGFydGljbGVzXG5cdHRoaXMuX2JhY2tncm91bmRQU0NvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9iYWNrZ3JvdW5kUFNDb250YWluZXIueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl9iYWNrZ3JvdW5kUFNDb250YWluZXIuYWxwaGEgPSB0aGlzLnNob3dJbnRybyA/IDAgOiAxO1xuXHR0aGlzLl9tYWluQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2JhY2tncm91bmRQU0NvbnRhaW5lcik7XG5cblx0dGhpcy5iYWNrZ3JvdW5kUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLl9iYWNrZ3JvdW5kUFNDb250YWluZXIsXG5cdFtcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMVwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21lbnVfc25vd1wiKSk7XG5cblx0dGhpcy5iYWNrZ3JvdW5kUFMudXBkYXRlKDUpO1xuXHR0aGlzLmJhY2tncm91bmRQUy5lbWl0ID0gdHJ1ZTtcblxuXHQvLyBMZWZ0IGFyZWFcbiAgICB0aGlzLl9sZWZ0QXJlYSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIHRoaXMuX2xlZnRBcmVhLnggPSAoQ29tbW9uLlNUQUdFX1dJRFRIIC8gMikgLSAxMDAwO1xuICAgIHRoaXMuX2xlZnRBcmVhLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcbiAgICB0aGlzLl9tYWluQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2xlZnRBcmVhKTtcblxuXHRcdC8vIFRpdGxlXG5cdFx0dGhpcy5fbGVmdEFyZWEuX3RpdGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfdGl0bGVfYmdcIikpO1xuXHRcdHRoaXMuX2xlZnRBcmVhLl90aXRsZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0dGhpcy5fbGVmdEFyZWEuX3RpdGxlLnBvc2l0aW9uLnNldCgtIDEwMCwgLTI5MCk7XG5cdFx0dGhpcy5fbGVmdEFyZWEuYWRkQ2hpbGQodGhpcy5fbGVmdEFyZWEuX3RpdGxlKTtcblxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJHT0FMU1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdFx0aWYoIXdlYmZvbnQpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiNTBweCBTdXBlcmNsYXJlbmRvbiBUaXRsZSBQdXJwbGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMiAtIDQ7XG5cdFx0XHRcdHRoaXMuX2xlZnRBcmVhLl90aXRsZS5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJHT0FMU1wiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMzZweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcblx0XHRcdFx0dGV4dC55IC09IDU7XG5cdFx0XHRcdHRoaXMuX2xlZnRBcmVhLl90aXRsZS5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblxuXHRcdC8vIEdvYWxzIGxpc3Rcblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNDb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNDb250YWluZXIucG9zaXRpb24uc2V0KC0xMDAsIC0xNDApO1xuXHRcdHRoaXMuX2xlZnRBcmVhLmFkZENoaWxkKHRoaXMuX2xlZnRBcmVhLl9nb2Fsc0NvbnRhaW5lcik7XG5cblx0XHR0aGlzLl9sZWZ0QXJlYS5fYmx1ciA9IG5ldyBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlcigpO1xuXHRcdHRoaXMuX2xlZnRBcmVhLl9ibHVyLmJsdXJYID0gMDtcblx0XHR0aGlzLl9sZWZ0QXJlYS5fYmx1ci5ibHVyWSA9IDA7XG5cdFx0dGhpcy5fbGVmdEFyZWEuZmlsdGVycyA9IFt0aGlzLl9sZWZ0QXJlYS5fYmx1cl07XG5cblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHMgPSBbXTtcblxuXHRcdFx0dmFyIGFjdGl2ZUdvYWxzID0gQ29tbW9uLmdvYWxzTWFuYWdlci5nZXRBY3RpdmVHb2FscygpO1xuXG5cdFx0XHRmb3IodmFyIGFjdGl2ZSA9IDE7IGFjdGl2ZSA+PSAwOyBhY3RpdmUtLSlcblx0XHRcdHtcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IENvbW1vbi5nb2Fsc01hbmFnZXIuZ29hbHMubGVuZ3RoOyBpKyspXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgaWQgPSBDb21tb24uZ29hbHNNYW5hZ2VyLmdvYWxzW2ldLmlkO1xuXHRcdFx0XHRcdHZhciBnb2FsU3RhdHVzID0gQ29tbW9uLmdvYWxzTWFuYWdlci5nZXRHb2FsU3RhdHVzKGlkKTtcblxuXHRcdFx0XHRcdC8vIFNob3cgdGhlIGFjdGl2ZSBnb2FscyBmaXJzdCwgdGhlbiB0aGUgcmVzdFxuXHRcdFx0XHRcdHZhciBrZWVwID0gKGFjdGl2ZSA9PSAwKTtcblxuXHRcdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBhY3RpdmVHb2Fscy5sZW5ndGg7IGorKylcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRpZihhY3RpdmVHb2Fsc1tqXS5pZCA9PSBpZClcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0a2VlcCA9ICFrZWVwO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZigha2VlcCkgY29udGludWU7XG5cblx0XHRcdFx0XHQvLyBHb2FsXG5cdFx0XHRcdFx0dmFyIGdvYWwgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19cIiArICgoaSU0KSsxKSkpO1xuXHRcdFx0XHRcdGdvYWwuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHRcdGdvYWwueSA9IHRoaXMuX2xlZnRBcmVhLl9nb2Fscy5sZW5ndGggKiAxMDA7XG5cdFx0XHRcdFx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzQ29udGFpbmVyLmFkZENoaWxkKGdvYWwpO1xuXHRcdFx0XHRcdHRoaXMuX2xlZnRBcmVhLl9nb2Fscy5wdXNoKGdvYWwpO1xuXG5cdFx0XHRcdFx0dmFyIGljb24gPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoQ29tbW9uLmdvYWxzTWFuYWdlci5nb2Fsc1tpXS5pY29uKSk7XG5cdFx0XHRcdFx0aWNvbi5hbmNob3Iuc2V0KDAsIDAuNSk7XG5cdFx0XHRcdFx0aWNvbi54ID0gLSAzNjA7XG5cdFx0XHRcdFx0Z29hbC5hZGRDaGlsZChpY29uKTtcblxuXHRcdFx0XHRcdGlmKCF3ZWJmb250KVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoQ29tbW9uLmdvYWxzTWFuYWdlci5nb2Fsc1tpXS5sYWJlbCwge2ZvbnQ6IFwiMjhweCBNaWthZGFuIFRpdGxlXCIsIGFsaWduOiBcImxlZnRcIn0pO1xuXHRcdFx0XHRcdFx0dGV4dC5tYXhXaWR0aCA9IDQwMDtcblx0XHRcdFx0XHRcdHRleHQudXBkYXRlVGV4dCgpO1xuXHRcdFx0XHRcdFx0dGV4dC54ID0gLTE4MDtcblx0XHRcdFx0XHRcdHRleHQueSA9IC10ZXh0LnRleHRIZWlnaHQvMjtcblx0XHRcdFx0XHRcdGdvYWwuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoQ29tbW9uLmdvYWxzTWFuYWdlci5nb2Fsc1tpXS5sYWJlbCwge2ZvbnQ6XCIyOHB4IEFyaWFsXCIsIGZpbGw6MHhGRkZGRkYsIGFsaWduOiAocjJsID8gJ3JpZ2h0JyA6ICdsZWZ0JyksIHdvcmRXcmFwOnRydWUsIHdvcmRXcmFwV2lkdGg6NDAwfSk7XG5cdFx0XHRcdFx0XHR0ZXh0LnggPSByMmwgPyAyMjAgOiAtMTgwO1xuXHRcdFx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KHIybCA/IDEgOiAwLCAwLjUpO1xuXHRcdFx0XHRcdFx0Z29hbC5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgcHJvZ3Jlc3MgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0XHRcdFx0XHRwcm9ncmVzcy54ID0gMzAwXG5cdFx0XHRcdFx0Z29hbC5hZGRDaGlsZChwcm9ncmVzcyk7XG5cblx0XHRcdFx0XHRcdGlmKGdvYWxTdGF0dXMgPT0gMSlcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19jb21wbGV0ZVwiKSk7XG5cdFx0XHRcdFx0XHRcdHByb2dyZXNzQmcuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHRcdFx0XHRwcm9ncmVzcy5hZGRDaGlsZChwcm9ncmVzc0JnKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0dmFyIHByb2dyZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19iYXJcIikpO1xuXHRcdFx0XHRcdFx0XHRwcm9ncmVzc0JnLmFuY2hvci5zZXQoMC41KTtcblx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCZyk7XG5cblx0XHRcdFx0XHRcdFx0aWYoZ29hbFN0YXR1cyA+IDApXG5cdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcHJvZ3Jlc3NCYXIgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9nb2Fsc19maWxsXCIpKTtcblx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzc0Jhci5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3MuYWRkQ2hpbGQocHJvZ3Jlc3NCYXIpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRjYW52YXMud2lkdGggID0gMTI4O1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2FudmFzLmhlaWdodCA9IDEyODtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRjdHgubW92ZVRvKGNhbnZhcy53aWR0aC8yLCBjYW52YXMuaGVpZ2h0LzIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Y3R4LmFyYyhjYW52YXMud2lkdGgvMiwgY2FudmFzLmhlaWdodC8yLCBjYW52YXMud2lkdGgvMiwgLU1hdGguUEkvMiwgMipNYXRoLlBJKmdvYWxTdGF0dXMtTWF0aC5QSS8yKTtcblx0XHRcdFx0XHRcdFx0XHRcdGN0eC5saW5lVG8oY2FudmFzLndpZHRoLzIsIGNhbnZhcy5oZWlnaHQvMik7XG5cdFx0XHRcdFx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gJ3doaXRlJztcblx0XHRcdFx0XHRcdFx0XHRcdGN0eC5maWxsKCk7XG5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBtYXNrID0gbmV3IFBJWEkuU3ByaXRlKFBJWEkuVGV4dHVyZS5mcm9tQ2FudmFzKGNhbnZhcykpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFzay5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzc0Jhci5hZGRDaGlsZChtYXNrKTtcblx0XHRcdFx0XHRcdFx0XHRcdHByb2dyZXNzQmFyLm1hc2sgPSBtYXNrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dmFyIHNub3cgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9zbm93X3RvcFwiKSk7XG5cdFx0XHRzbm93LmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHRcdHNub3cueSA9IC0xNTtcblx0XHRcdHNub3cud2lkdGggPSB0aGlzLl9sZWZ0QXJlYS5fZ29hbHNbMF0ud2lkdGgrIDIwO1xuXHRcdFx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzWzBdLmFkZENoaWxkKHNub3cpO1xuXG5cdFx0XHQvLyBNYXNrXG5cdFx0XHR2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cdFx0XHRjYW52YXMud2lkdGggID0gMjtcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSA1MTI7XG5cdFx0XHR2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblxuXHRcdFx0dmFyIGdyYWRpZW50ID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsMCwwLGNhbnZhcy5oZWlnaHQpO1xuXHRcdFx0Z3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIFwicmdiYSgyNTUsMjU1LDI1NSwwKVwiKTtcblx0XHRcdGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjA1LCBcInJnYmEoMjU1LDI1NSwyNTUsMSlcIik7XG5cdFx0XHRncmFkaWVudC5hZGRDb2xvclN0b3AoMC45MywgXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCIpO1xuXHRcdFx0Z3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIFwicmdiYSgyNTUsMjU1LDI1NSwwKVwiKTtcblxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IGdyYWRpZW50O1xuXHRcdFx0Y3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cblx0XHRcdHZhciBtYXNrID0gbmV3IFBJWEkuU3ByaXRlKFBJWEkuVGV4dHVyZS5mcm9tQ2FudmFzKGNhbnZhcykpO1xuXHRcdFx0bWFzay5hbmNob3Iuc2V0KDAuNSwgMCk7XG5cdFx0XHRtYXNrLnBvc2l0aW9uLnkgLT0gODU7XG5cdFx0XHRtYXNrLndpZHRoID0gODAwO1xuXHRcdFx0bWFzay5oZWlnaHQgPSA1NTA7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNDb250YWluZXIuYWRkQ2hpbGQobWFzayk7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNDb250YWluZXIubWFzayA9IG1hc2s7XG5cblx0XHQvLyBHb2FscyBzY3JvbGxiYXJcblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlciA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX3Njcm9sbF9yb3BlX2JnXCIpKTtcblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIueCA9IDMzMDtcblx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci55ID0gNjA7XG5cdFx0dGhpcy5fbGVmdEFyZWEuYWRkQ2hpbGQodGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIpO1xuXG5cdFx0XHR2YXIgdGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc2Nyb2xsX3JvcGVfdGlsZVwiKTtcblx0XHRcdHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9yb3BlID0gbmV3IFBJWEkuZXh0cmFzLlRpbGluZ1Nwcml0ZSh0ZXh0dXJlLCB0ZXh0dXJlLndpZHRoLCB0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5oZWlnaHQgLSAxMCk7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5fcm9wZS5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5hZGRDaGlsZCh0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5fcm9wZSk7XG5cblx0XHRcdHZhciBjYXAgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9zY3JvbGxfcm9wZV90b3BcIikpO1xuXHRcdFx0Y2FwLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHRcdGNhcC55ID0gLXRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9yb3BlLmhlaWdodC8yICsgMjU7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5fcm9wZS5hZGRDaGlsZChjYXApO1xuXG5cdFx0XHR2YXIgY2FwID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc2Nyb2xsX3JvcGVfYm90dG9tXCIpKTtcblx0XHRcdGNhcC5hbmNob3Iuc2V0KDAuNSwgMCk7XG5cdFx0XHRjYXAueSA9IHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9yb3BlLmhlaWdodC8yIC0gMjI7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5fcm9wZS5hZGRDaGlsZChjYXApO1xuXG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc2Nyb2xsX2hhbmRsZVwiKSk7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlLmFuY2hvciAgICAgID0gbmV3IFBJWEkuUG9pbnQoMC41LCAwLjUpO1xuXHRcdFx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55ICAgICAgICAgICA9IHRoaXMuaGFuZGxlTWluWTtcblx0XHRcdHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUueVJlYWwgICAgICAgPSB0aGlzLmhhbmRsZU1pblk7XG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlLmludGVyYWN0aXZlID0gdHJ1ZTtcblx0XHRcdHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLmFkZENoaWxkKHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUpO1xuXG5cdFx0XHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnRvdWNoc3RhcnQgPSB0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlLm1vdXNlZG93biA9IGZ1bmN0aW9uKGUpe3RoaXMub25IYW5kbGVEb3duKGUpfS5iaW5kKHRoaXMpO1xuXHRcdFx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS50b3VjaG1vdmUgID0gdGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS5tb3VzZW1vdmUgPSBmdW5jdGlvbihlKXt0aGlzLm9uSGFuZGxlTW92ZShlKX0uYmluZCh0aGlzKTtcblxuXG5cdC8vIFJpZ2h0IGFyZWFcbiAgICB0aGlzLl9yaWdodEFyZWEgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICB0aGlzLl9yaWdodEFyZWEueCA9IChDb21tb24uU1RBR0VfV0lEVEggLyAyKSArIDEwMDA7XG4gICAgdGhpcy5fcmlnaHRBcmVhLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcbiAgICB0aGlzLl9tYWluQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX3JpZ2h0QXJlYSk7XG5cblx0XHR0aGlzLl9yaWdodEFyZWEuX2JnID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfcG9wdXBfYmdcIikpO1xuXHRcdHRoaXMuX3JpZ2h0QXJlYS5fYmcuYW5jaG9yLnNldCgwLjUpO1xuXHRcdHRoaXMuX3JpZ2h0QXJlYS5fYmcueSA9IDUwO1xuXHRcdHRoaXMuX3JpZ2h0QXJlYS5hZGRDaGlsZCh0aGlzLl9yaWdodEFyZWEuX2JnKTtcblxuXHRcdHZhciBzbm93ID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfc25vd190b3BcIikpO1xuXHRcdHNub3cuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHNub3cueSA9IC0gMjMzO1xuXHRcdHRoaXMuX3JpZ2h0QXJlYS5fYmcuYWRkQ2hpbGQoc25vdyk7XG5cblx0XHR0aGlzLl9yaWdodEFyZWEuX2NvbW1Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0XHR0aGlzLl9yaWdodEFyZWEuX2NvbW1Db250YWluZXIueSA9IDUwO1xuXHRcdHRoaXMuX3JpZ2h0QXJlYS5hZGRDaGlsZCh0aGlzLl9yaWdodEFyZWEuX2NvbW1Db250YWluZXIpO1xuXG5cdFx0XHR0aGlzLl9jb21tc0RhdGEgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIikuY29tbXM7XG5cblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLl9jb21tc0RhdGEubGVuZ3RoOyBpKyspXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBjb21tID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdFx0XHRcdGNvbW0uYWxwaGEgPSAoaSA9PSAwKSA/IDEgOiAwO1xuXG5cdFx0XHRcdGNvbW0uaW1hZ2UgPSBuZXcgUElYSS5TcHJpdGUoUElYSS5UZXh0dXJlLmZyb21JbWFnZSgnYXNzZXRzL2ltYWdlcy9oZC9jb21tcy8nICsgdGhpcy5fY29tbXNEYXRhW2ldLmltYWdlKSk7XG5cdFx0XHRcdGNvbW0uaW1hZ2UuYW5jaG9yLnNldCgwLjUsIDApO1xuXHRcdFx0XHRjb21tLmltYWdlLnkgPSAtMjA1O1xuXHRcdFx0XHRjb21tLmltYWdlLmludGVyYWN0aXZlID0gKGkgPT0gMCk7XG5cdFx0XHRcdGNvbW0uaW1hZ2UuYnV0dG9uTW9kZSA9IHRydWU7XG5cdFx0XHRcdGNvbW0uaW1hZ2UudG91Y2hzdGFydCA9IGNvbW0uaW1hZ2UubW91c2Vkb3duID0gZnVuY3Rpb24oZSl7dGhpcy5vbkNvbW1DbGljaygpO30uYmluZCh0aGlzKTtcblx0XHRcdFx0Y29tbS5hZGRDaGlsZChjb21tLmltYWdlKTtcblxuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX2NvbW1Db250YWluZXIuYWRkQ2hpbGQoY29tbSk7XG5cdFx0XHRcdHRoaXMuX2NvbW1zLnB1c2goY29tbSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKHRoaXMuX2NvbW1zRGF0YS5sZW5ndGggPiAxKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX2xlZnRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdFx0XHRcdChcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3V0XCIpLFxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdmVyXCIpLFxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9kb3duXCIpLFxuXHRcdFx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9uYXZfYXJyb3dcIilcblx0XHRcdFx0KTtcblx0XHRcdFx0dGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0XHRcdFx0dGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLnggPSAtNTtcblx0XHRcdFx0dGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLnNjYWxlLnggPSAtMTtcblx0XHRcdFx0dGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uLnBvc2l0aW9uLnNldCgtMzg1LCAyNjApO1xuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX2xlZnRCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uQ29tbVByZXYsIHRoaXMpO1xuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuYWRkQ2hpbGQodGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uKTtcblxuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX3JpZ2h0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdFx0XHQoXG5cdFx0XHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X291dFwiKSxcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfb3ZlclwiKSxcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9uYXZfZG93blwiKSxcblx0XHRcdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fbmF2X2Fycm93XCIpXG5cdFx0XHRcdCk7XG5cdFx0XHRcdHRoaXMuX3JpZ2h0QXJlYS5fcmlnaHRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX3JpZ2h0QnV0dG9uLnBvc2l0aW9uLnNldCgzODUsIDI2MCk7XG5cdFx0XHRcdHRoaXMuX3JpZ2h0QXJlYS5fcmlnaHRCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uQ29tbU5leHQsIHRoaXMpO1xuXHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuYWRkQ2hpbGQodGhpcy5fcmlnaHRBcmVhLl9yaWdodEJ1dHRvbik7XG5cblx0XHRcdFx0aWYocjJsKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhpcy5fcmlnaHRBcmVhLl9sZWZ0QnV0dG9uLnNjYWxlLnNldCgtMSwxKTtcblx0XHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX2xlZnRCdXR0b24ucG9zaXRpb24uc2V0KDM4NSwgMjYwKTtcblx0XHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX3JpZ2h0QnV0dG9uLnNjYWxlLnNldCgtMSwxKTtcblx0XHRcdFx0XHR0aGlzLl9yaWdodEFyZWEuX3JpZ2h0QnV0dG9uLnBvc2l0aW9uLnNldCgtMzg1LCAyNjApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0Ly8gQ2hhcmFjdGVyc1xuXHR0aGlzLl9jaGFyYWN0ZXJzID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG5cdHRoaXMuX2NoYXJhY3RlcnMueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XG5cdHRoaXMuX2NoYXJhY3RlcnMueSA9IENvbW1vbi5TVEFHRV9IRUlHSFQ7XG5cdHRoaXMuX21haW5Db250YWluZXIuYWRkQ2hpbGQodGhpcy5fY2hhcmFjdGVycyk7XG5cblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9hbm5hID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWVudV9jaGFyYWN0ZXJfYW5uYV9lbHNhXCIpKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9hbm5hLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9hbm5hLnggPSA0MjA7XG5cdFx0dGhpcy5fY2hhcmFjdGVycy5fYW5uYS55ID0gMTUwO1xuXHRcdHRoaXMuX2NoYXJhY3RlcnMuYWRkQ2hpbGQodGhpcy5fY2hhcmFjdGVycy5fYW5uYSk7XG5cblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9rcmlzdG9mZiA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX21lbnVfY2hhcmFjdGVyX2tyaXN0b2ZmXCIpKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9rcmlzdG9mZi5hbmNob3Iuc2V0KDAuNSwgMSk7XG5cdFx0dGhpcy5fY2hhcmFjdGVycy5fa3Jpc3RvZmYueCA9IC0yMDA7XG5cdFx0dGhpcy5fY2hhcmFjdGVycy5fa3Jpc3RvZmYueSA9IDExMDtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLmFkZENoaWxkKHRoaXMuX2NoYXJhY3RlcnMuX2tyaXN0b2ZmKTtcblxuXHRcdHRoaXMuX2NoYXJhY3RlcnMuX29sYWYgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tZW51X2NoYXJhY3Rlcl9vbGFmXCIpKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9vbGFmLmFuY2hvci5zZXQoMC41LCAxKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9vbGFmLnggPSAzMjA7XG5cdFx0dGhpcy5fY2hhcmFjdGVycy5fb2xhZi55ID0gMDtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLmFkZENoaWxkKHRoaXMuX2NoYXJhY3RlcnMuX29sYWYpO1xuXG5cdFx0dGhpcy5fY2hhcmFjdGVycy5fcGFiYmllID0gbmV3IFBJWEkuU3ByaXRlKHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWVudV9jaGFyYWN0ZXJfcGFiYmllXCIpKTtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9wYWJiaWUuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX2NoYXJhY3RlcnMuX3BhYmJpZS54ID0gLTM3MDtcblx0XHR0aGlzLl9jaGFyYWN0ZXJzLl9wYWJiaWUueSA9IDA7XG5cdFx0dGhpcy5fY2hhcmFjdGVycy5hZGRDaGlsZCh0aGlzLl9jaGFyYWN0ZXJzLl9wYWJiaWUpO1xuXG5cblx0Ly8gQ2VudGVyIGFyZWFcblx0dGhpcy5fY2VudHJhbEFyZWEgPSBuZXcgUElYSS5Db250YWluZXIoKTtcblx0dGhpcy5fY2VudHJhbEFyZWEueCA9IENvbW1vbi5TVEFHRV9XSURUSCAvIDI7XG5cdHRoaXMuX2NlbnRyYWxBcmVhLnkgPSBDb21tb24uU1RBR0VfSEVJR0hUIC8gMjtcblx0dGhpcy5fY2VudHJhbEFyZWEuYWxwaGEgPSB0aGlzLnNob3dJbnRybyA/IDAuMDAxIDogMTtcblx0dGhpcy5fbWFpbkNvbnRhaW5lci5hZGRDaGlsZCh0aGlzLl9jZW50cmFsQXJlYSk7XG5cblx0XHQvLyBTdG9yeSBtb2RlXG5cdFx0dmFyIGNyeXN0YWxDb3VudCAgICAgPSBDb21tb24uc2F2ZWREYXRhLmdldENyeXN0YWxDb3VudCgpO1xuXHRcdHZhciBjcnlzdGFsQ29sbGVjdGVkID0gQ29tbW9uLnNhdmVkRGF0YS5nZXRDb2xsZWN0ZWRDcnlzdGFsQ291bnQoKTtcblxuXHRcdHRoaXMuX3N0b3J5QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHRcdChcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX25hdl9vdXRfYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X292ZXJfYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fbmF2X2Rvd25fYmlnXCIpLFxuXHRcdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX25hdl9wbGF5XCIpXG5cdFx0KTtcblx0XHR0aGlzLl9zdG9yeUJ1dHRvbi5vdmVyU291bmROYW1lID0gXCJzZnhfYnRuX3JvbGxvdmVyXzAwXCI7XG5cdFx0dGhpcy5fc3RvcnlCdXR0b24ucG9zaXRpb24uc2V0KC0xNjAsIDkwICsgKGNyeXN0YWxDb2xsZWN0ZWQgPT0gY3J5c3RhbENvdW50ID8gLTIwIDogMCkpO1xuXHRcdHRoaXMuX3N0b3J5QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vblN0b3J5Q2xpY2ssIHRoaXMpO1xuXHRcdHRoaXMuX2NlbnRyYWxBcmVhLmFkZENoaWxkKHRoaXMuX3N0b3J5QnV0dG9uKTtcblxuXHRcdC8vIFN0b3J5IGxhYmVsXG5cdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJTVE9SWVwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblx0XHRpZighd2ViZm9udClcblx0XHR7XG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjUwcHggU3VwZXJjbGFyZW5kb24gVGl0bGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRleHQueCA9IHRoaXMuX3N0b3J5QnV0dG9uLnBvc2l0aW9uLnggLSB0ZXh0LnRleHRXaWR0aC8yO1xuXHRcdFx0dGV4dC55ID0gdGhpcy5fc3RvcnlCdXR0b24ucG9zaXRpb24ueSArIDExMCAtIHRleHQudGV4dEhlaWdodC8yO1xuXHRcdFx0dGhpcy5fY2VudHJhbEFyZWEuYWRkQ2hpbGQodGV4dCk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCI0OHB4IEFyaWFsXCIsIGZpbGw6MHhmZmZmZmYsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHR0ZXh0LnBvc2l0aW9uLnNldCh0aGlzLl9zdG9yeUJ1dHRvbi5wb3NpdGlvbi54LCB0aGlzLl9zdG9yeUJ1dHRvbi5wb3NpdGlvbi55ICsgMTEwKTtcblx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0dGhpcy5fY2VudHJhbEFyZWEuYWRkQ2hpbGQodGV4dCk7XG5cdFx0fVxuXG5cdFx0Ly8gVHJvbGwgY291bnRcblx0XHRpZihjcnlzdGFsQ29sbGVjdGVkID09IGNyeXN0YWxDb3VudClcblx0XHR7XG5cdFx0XHR2YXIgdHJvbGxDb2xsZWN0ZWQgPSBDb21tb24uc2F2ZWREYXRhLmdldENvbGxlY3RlZFRyb2xsQ291bnQoKTtcblx0XHRcdHZhciB0cm9sbENvdW50ICAgICA9IENvbW1vbi5zYXZlZERhdGEuZ2V0VHJvbGxDb3VudCgpO1xuXG5cdFx0XHR2YXIgdHJvbGxCZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX21lbnVfdHJvbGxzXCIpKTtcblx0XHRcdHRyb2xsQmcuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdFx0dHJvbGxCZy54ID0gdGhpcy5fc3RvcnlCdXR0b24ueDtcblx0XHRcdHRyb2xsQmcueSA9IDM5NTtcblx0XHRcdHRoaXMuX2NlbnRyYWxBcmVhLmFkZENoaWxkKHRyb2xsQmcpO1xuXG5cdFx0XHRpZighd2ViZm9udClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5leHRyYXMuQml0bWFwVGV4dCh0cm9sbENvbGxlY3RlZCArIFwiL1wiICsgdHJvbGxDb3VudCwge2ZvbnQ6IFwiMjBweCBTdXBlcmNsYXJlbmRvbiBMZXZlbFwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0XHR0ZXh0LnggPSAtdGV4dC50ZXh0V2lkdGgvMiArIDQ2O1xuXHRcdFx0XHR0ZXh0LnkgPSAtdGV4dC50ZXh0SGVpZ2h0LzIgLSA4MDtcblx0XHRcdFx0dHJvbGxCZy5hZGRDaGlsZCh0ZXh0KTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KHRyb2xsQ29sbGVjdGVkICsgXCIvXCIgKyB0cm9sbENvdW50LCB7Zm9udDpcIjI0cHggQXJpYWxcIiwgZmlsbDoweDAwMDAwMCwgYWxpZ246J2NlbnRlcid9KTtcblx0XHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHRcdHRleHQueCArPSA0NTtcblx0XHRcdFx0dGV4dC55IC09IDc4O1xuXHRcdFx0XHR0cm9sbEJnLmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENyeXN0YWwgY291bnRcblx0XHR2YXIgc3RvcnlCZyA9IG5ldyBQSVhJLlNwcml0ZSh0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX21lbnVfY3J5c3RhbHNfYmdcIikpO1xuXHRcdHN0b3J5QmcuYW5jaG9yLnNldCgwLjUpO1xuXHRcdHN0b3J5QmcueCA9IHRoaXMuX3N0b3J5QnV0dG9uLng7XG5cdFx0c3RvcnlCZy55ID0gdGhpcy5fc3RvcnlCdXR0b24ueSArIDIwMCAtIDY7XG5cdFx0dGhpcy5fY2VudHJhbEFyZWEuYWRkQ2hpbGQoc3RvcnlCZyk7XG5cblx0XHRcdGlmKCF3ZWJmb250KVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNyeXN0YWxDb2xsZWN0ZWQgKyBcIi9cIiArIGNyeXN0YWxDb3VudCwge2ZvbnQ6IFwiMjBweCBTdXBlcmNsYXJlbmRvbiBMZXZlbFwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0XHR0ZXh0LnggPSAtdGV4dC50ZXh0V2lkdGgvMiAgLSA0Njtcblx0XHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yIC0gMTY7XG5cdFx0XHRcdHN0b3J5QmcuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuVGV4dChjcnlzdGFsQ29sbGVjdGVkICsgXCIvXCIgKyBjcnlzdGFsQ291bnQsIHtmb250OlwiMjRweCBBcmlhbFwiLCBmaWxsOjB4MDAwMDAwLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0XHR0ZXh0LmFuY2hvci5zZXQoMC41KTtcblx0XHRcdFx0dGV4dC54IC09IDQ1O1xuXHRcdFx0XHR0ZXh0LnkgLT0gMTI7XG5cdFx0XHRcdHN0b3J5QmcuYWRkQ2hpbGQodGV4dCk7XG5cdFx0XHR9XG5cblxuXG5cdFx0Ly8gRW5kbGVzcyBtb2RlXG5cdFx0dGhpcy5fZW5kbGVzc0J1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0XHQoXG5cdFx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZSh0aGlzLmlzRW5kbGVzc1VubG9ja2VkID8gXCJ1aV9idG5fbmF2X291dF9iaWdcIiAgOiBcInVpX2J0bl9uYXZfb3V0X2JpZ19pbmFjdGl2ZVwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuaXNFbmRsZXNzVW5sb2NrZWQgPyBcInVpX2J0bl9uYXZfb3Zlcl9iaWdcIiA6IFwidWlfYnRuX25hdl9vdmVyX2JpZ19pbmFjdGl2ZVwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuaXNFbmRsZXNzVW5sb2NrZWQgPyBcInVpX2J0bl9uYXZfZG93bl9iaWdcIiA6IFwidWlfYnRuX25hdl9kb3duX2JpZ19pbmFjdGl2ZVwiKSxcblx0XHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKHRoaXMuaXNFbmRsZXNzVW5sb2NrZWQgPyBcInVpX2ljb25fbmF2X3BsYXlcIiAgICA6IFwidWlfaWNvbl9uYXZfbG9ja1wiKVxuXHRcdCk7XG5cdFx0dGhpcy5fZW5kbGVzc0J1dHRvbi54ID0gMTEwO1xuXHRcdHRoaXMuX2VuZGxlc3NCdXR0b24ueSA9IHRoaXMuX3N0b3J5QnV0dG9uLnBvc2l0aW9uLnk7XG5cdFx0dGhpcy5fZW5kbGVzc0J1dHRvbi5zaWduYWxzLmRvd24uYWRkKHRoaXMub25FbmRsZXNzQ2xpY2ssIHRoaXMpO1xuXHRcdHRoaXMuX2VuZGxlc3NCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHRcdHRoaXMuX2NlbnRyYWxBcmVhLmFkZENoaWxkKHRoaXMuX2VuZGxlc3NCdXR0b24pO1xuXG5cdFx0aWYoIXRoaXMuaXNFbmRsZXNzVW5sb2NrZWQpXG5cdFx0XHR0aGlzLl9lbmRsZXNzQnV0dG9uLmNoaWxkcmVuWzFdLnBvc2l0aW9uLnNldCgtMiwgLTMpO1xuXG5cblxuXHRcdC8vIEVuZGxlc3MgbGFiZWxcblx0XHR2YXIgY29weSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwic3RyaW5nc1wiKVtcIkVORExFU1NcIl1bQ29tbW9uLkNPVU5UUllfQ09ERV07XG5cblx0XHRpZighd2ViZm9udClcblx0XHR7XG5cdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLmV4dHJhcy5CaXRtYXBUZXh0KGNvcHksIHtmb250OiBcIjUwcHggU3VwZXJjbGFyZW5kb24gVGl0bGVcIiwgYWxpZ246IFwiY2VudGVyXCJ9KTtcblx0XHRcdHRleHQueCA9IHRoaXMuX2VuZGxlc3NCdXR0b24ucG9zaXRpb24ueCAtIHRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHR0ZXh0LnkgPSB0aGlzLl9lbmRsZXNzQnV0dG9uLnBvc2l0aW9uLnkgKyAxMTAgLSB0ZXh0LnRleHRIZWlnaHQvMjtcblx0XHRcdHRoaXMuX2NlbnRyYWxBcmVhLmFkZENoaWxkKHRleHQpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiNDhweCBBcmlhbFwiLCBmaWxsOjB4ZmZmZmZmLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGV4dC5wb3NpdGlvbi5zZXQodGhpcy5fZW5kbGVzc0J1dHRvbi5wb3NpdGlvbi54LCB0aGlzLl9lbmRsZXNzQnV0dG9uLnBvc2l0aW9uLnkgKyAxMTApO1xuXHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9jZW50cmFsQXJlYS5hZGRDaGlsZCh0ZXh0KTtcblx0XHR9XG5cblx0XHQvLyBFbmRsZXNzIHJlY29yZFxuXHRcdHZhciBlbmRsZXNzQmcgPSBuZXcgUElYSS5TcHJpdGUodGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9tZW51X2hpc2NvcmVfYmdcIikpO1xuXHRcdGVuZGxlc3NCZy5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0ZW5kbGVzc0JnLnggPSB0aGlzLl9lbmRsZXNzQnV0dG9uLng7XG5cdFx0ZW5kbGVzc0JnLnkgPSB0aGlzLl9lbmRsZXNzQnV0dG9uLnkgKyAxODU7XG5cdFx0dGhpcy5fY2VudHJhbEFyZWEuYWRkQ2hpbGQoZW5kbGVzc0JnKTtcblxuXHRcdFx0dmFyIGNvcHkgPSB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInN0cmluZ3NcIilbXCJISVNDT1JFXCJdW0NvbW1vbi5DT1VOVFJZX0NPREVdO1xuXHRcdFx0Y29weSA9IGNvcHkucmVwbGFjZShcInt2YWx1ZX1cIiwgQ29tbW9uLnNhdmVkRGF0YS5nZXRIaWdoc2NvcmUoXCJlbmRsZXNzXCIpKTtcblxuXHRcdFx0aWYoIXdlYmZvbnQpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjBweCBTdXBlcmNsYXJlbmRvbiBMZXZlbFwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0XHR0ZXh0LnggPSAtdGV4dC50ZXh0V2lkdGgvMjtcblx0XHRcdFx0dGV4dC55ID0gLXRleHQudGV4dEhlaWdodC8yIC0gNjtcblx0XHRcdFx0ZW5kbGVzc0JnLmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgdGV4dCA9IG5ldyBQSVhJLlRleHQoY29weSwge2ZvbnQ6XCIyMHB4IEFyaWFsXCIsIGZpbGw6MHgwMDAwMDAsIGFsaWduOidjZW50ZXInfSk7XG5cdFx0XHRcdHRleHQuYW5jaG9yLnNldCgwLjUpO1xuXHRcdFx0XHR0ZXh0LnkgLT0gNDtcblx0XHRcdFx0ZW5kbGVzc0JnLmFkZENoaWxkKHRleHQpO1xuXHRcdFx0fVxuXG5cdC8vIEZvcmVncm91bmQgcGFydGljbGVzXG5cdHRoaXMuX2ZvcmVncm91bmRQU0NvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9mb3JlZ3JvdW5kUFNDb250YWluZXIueCA9IENvbW1vbi5TVEFHRV9XSURUSC8yO1xuXHR0aGlzLl9mb3JlZ3JvdW5kUFNDb250YWluZXIuYWxwaGEgPSB0aGlzLnNob3dJbnRybyA/IDAgOiAxO1xuXHR0aGlzLl9tYWluQ29udGFpbmVyLmFkZENoaWxkKHRoaXMuX2ZvcmVncm91bmRQU0NvbnRhaW5lcik7XG5cblx0dGhpcy5mb3JlZ3JvdW5kUFMgPSBuZXcgY2xvdWRraWQuRW1pdHRlcih0aGlzLl9mb3JlZ3JvdW5kUFNDb250YWluZXIsXG5cdFtcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMFwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMVwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wMlwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInBhcnRpY2xlX3Nub3dmbGFrZV8wM1wiKVxuXHRdLCB0aGlzLl9hc3NldE1hbmFnZXIuZ2V0SlNPTihcInBhcnRpY2xlX21lbnVfc25vd1wiKSk7XG5cblx0dGhpcy5mb3JlZ3JvdW5kUFMudXBkYXRlKDUpO1xuXHR0aGlzLmZvcmVncm91bmRQUy5lbWl0ID0gdHJ1ZTtcblxuXHQvLyBTbm93IG92ZXJsYXlcblx0dGhpcy5fb3ZlcmxheSA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuXHR0aGlzLl9vdmVybGF5LnggPSBDb21tb24uU1RBR0VfV0lEVEgvMjtcblx0dGhpcy5fb3ZlcmxheS55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCArIDkwO1xuXG5cdHRoaXMuX21haW5Db250YWluZXIuYWRkQ2hpbGQodGhpcy5fb3ZlcmxheSk7XG5cblx0XHR2YXIgdGV4dHVyZSA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfbWVudV9zbm93XCIpO1xuXHRcdHRoaXMuX292ZXJsYXkuX2JnID0gbmV3IFBJWEkuZXh0cmFzLlRpbGluZ1Nwcml0ZSh0ZXh0dXJlLCBDb21tb24uU1RBR0VfV0lEVEggKiAzLCB0ZXh0dXJlLmhlaWdodCk7XG5cdFx0dGhpcy5fb3ZlcmxheS5fYmcuYW5jaG9yLnNldCgwLjUsIDEpO1xuXHRcdHRoaXMuX292ZXJsYXkuYWRkQ2hpbGQodGhpcy5fb3ZlcmxheS5fYmcpO1xuXG5cdFx0dmFyIGZpbGwgPSBuZXcgUElYSS5TcHJpdGUoQ29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWyd3aGl0ZVNxdWFyZSddKTtcblx0XHRmaWxsLndpZHRoID0gQ29tbW9uLlNUQUdFX1dJRFRIICogMztcblx0XHRmaWxsLmhlaWdodCA9IDMwMDtcblx0XHRmaWxsLnRpbnQgPSAweDliYzZlNTtcblx0XHRmaWxsLmFuY2hvci5zZXQoMC41LCAwKTtcblx0XHR0aGlzLl9vdmVybGF5LmFkZENoaWxkQXQoZmlsbCwgMCk7XG5cblxuXHQvL1VJXG5cdHRoaXMuX2xlZnRCdXR0b24gPSBuZXcgcDMuQnV0dG9uXG5cdChcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X291dFwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2J0bl9zaWRlbmF2X292ZXJcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9kb3duXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfaWNvbl9zaWRlbmF2X2Fycm93XCIpXG5cdCk7XG5cdHRoaXMuX2xlZnRCdXR0b24uY2hpbGRyZW5bMF0uYW5jaG9yLnNldCgwLCAwLjUpO1xuXHR0aGlzLl9sZWZ0QnV0dG9uLmNoaWxkcmVuWzFdLmFuY2hvci5zZXQoMCwgMC41KTtcblx0dGhpcy5fbGVmdEJ1dHRvbi55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDI7XG5cdHRoaXMuX2xlZnRCdXR0b24uYWxwaGEgPSB0aGlzLnNob3dJbnRybyA/IDAgOiAxO1xuXHR0aGlzLl9sZWZ0QnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkxlZnRDbGljaywgdGhpcyk7XG5cdHRoaXMuX2xlZnRCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHR0aGlzLmFkZENoaWxkKHRoaXMuX2xlZnRCdXR0b24pO1xuXG5cdHRoaXMuX3JpZ2h0QnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHQoXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9vdXRcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fc2lkZW5hdl9vdmVyXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX3NpZGVuYXZfZG93blwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fc2lkZW5hdl9hcnJvd1wiKVxuXHQpO1xuXHR0aGlzLl9yaWdodEJ1dHRvbi5zY2FsZS54ID0gLTE7XG5cdHRoaXMuX3JpZ2h0QnV0dG9uLmNoaWxkcmVuWzBdLmFuY2hvci5zZXQoMCwgMC41KTtcblx0dGhpcy5fcmlnaHRCdXR0b24uY2hpbGRyZW5bMV0uYW5jaG9yLnNldCgwLCAwLjUpO1xuXHR0aGlzLl9yaWdodEJ1dHRvbi55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAvIDI7XG5cdHRoaXMuX3JpZ2h0QnV0dG9uLmFscGhhID0gdGhpcy5zaG93SW50cm8gPyAwIDogMTtcblx0dGhpcy5fcmlnaHRCdXR0b24uc2lnbmFscy5kb3duLmFkZCh0aGlzLm9uUmlnaHRDbGljaywgdGhpcyk7XG5cdHRoaXMuX3JpZ2h0QnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9yaWdodEJ1dHRvbik7XG5cblx0Ly8gSGVscCBidXR0b25cblx0dGhpcy5faGVscEJ1dHRvbiA9IG5ldyBwMy5CdXR0b25cblx0KFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9oZWxwXCIpXG5cdCk7XG5cdHRoaXMuX2hlbHBCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHR0aGlzLl9oZWxwQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdHRoaXMuX2hlbHBCdXR0b24uc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9oZWxwQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkhlbHBQcmVzc2VkLCB0aGlzKTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9oZWxwQnV0dG9uKTtcblxuXHQvLyBNdXRlIGJ1dHRvblxuXHR0aGlzLl9tdXRlQnV0dG9uID0gbmV3IHAzLk11dGVCdXR0b25cblx0KFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2Nvbl9vdXRcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX292ZXJcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29uX2Rvd25cIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9pY29uX2Nvbl9zb3VuZF9vblwiKSxcblx0XHR0aGlzLl9hc3NldE1hbmFnZXIuZ2V0VGV4dHVyZShcInVpX2ljb25fY29uX3NvdW5kX29mZlwiKVxuXHQpO1xuXHR0aGlzLl9tdXRlQnV0dG9uLm92ZXJTb3VuZE5hbWUgPSBcInNmeF9idG5fcm9sbG92ZXJfMDBcIjtcblx0dGhpcy5fbXV0ZUJ1dHRvbi5pZCA9IFwibXV0ZVwiO1xuXHR0aGlzLl9tdXRlQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdHRoaXMuX211dGVCdXR0b24uc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9tdXRlQnV0dG9uLmluaXQoKTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9tdXRlQnV0dG9uKTtcblxuXHQvLyBDb2RlIGJ1dHRvblxuXHR0aGlzLl9jb2RlQnV0dG9uID0gbmV3IHAzLkJ1dHRvblxuXHQoXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29kZV9ub3JtYWxcIiksXG5cdFx0dGhpcy5fYXNzZXRNYW5hZ2VyLmdldFRleHR1cmUoXCJ1aV9idG5fY29kZV9vdmVyXCIpLFxuXHRcdHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRUZXh0dXJlKFwidWlfYnRuX2NvZGVfcHJlc3NcIiksXG5cdFx0Q29tbW9uLmdlbmVyYXRlZFRleHR1cmVzWyd3aGl0ZVNxdWFyZSddXG5cdCk7XG5cdHRoaXMuX2NvZGVCdXR0b24ub3ZlclNvdW5kTmFtZSA9IFwic2Z4X2J0bl9yb2xsb3Zlcl8wMFwiO1xuXHR0aGlzLl9jb2RlQnV0dG9uLnkgPSB0aGlzLl9ndWlCdXR0b25Ub3BNYXJnaW47XG5cdHRoaXMuX2NvZGVCdXR0b24uc2NhbGUuc2V0KDApO1xuXHR0aGlzLl9jb2RlQnV0dG9uLnNpZ25hbHMuZG93bi5hZGQodGhpcy5vbkNvZGVQcmVzc2VkLCB0aGlzKTtcblx0dGhpcy5hZGRDaGlsZCh0aGlzLl9jb2RlQnV0dG9uKTtcblxuXHRcdHZhciBjb3B5ID0gdGhpcy5fYXNzZXRNYW5hZ2VyLmdldEpTT04oXCJzdHJpbmdzXCIpW1wiRU5URVJfQ09ERVwiXVtDb21tb24uQ09VTlRSWV9DT0RFXTtcblxuXHRcdGlmKCF3ZWJmb250KVxuXHRcdHtcblx0XHRcdHZhciB0ZXh0ID0gbmV3IFBJWEkuZXh0cmFzLkJpdG1hcFRleHQoY29weSwge2ZvbnQ6IFwiMjhweCBTdXBlcmNsYXJlbmRvbiBUaXRsZVwiLCBhbGlnbjogXCJjZW50ZXJcIn0pO1xuXHRcdFx0dGV4dC54ID0gLXRleHQudGV4dFdpZHRoLzI7XG5cdFx0XHR0ZXh0LnkgPSAtdGV4dC50ZXh0SGVpZ2h0LzI7XG5cdFx0XHR0aGlzLl9jb2RlQnV0dG9uLmNoaWxkcmVuWzBdLmFkZENoaWxkKHRleHQpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dmFyIHRleHQgPSBuZXcgUElYSS5UZXh0KGNvcHksIHtmb250OlwiMjhweCBBcmlhbFwiLCBmaWxsOjB4ZmZmZmZmLCBhbGlnbjonY2VudGVyJ30pO1xuXHRcdFx0dGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cdFx0XHR0aGlzLl9jb2RlQnV0dG9uLmNoaWxkcmVuWzBdLmFkZENoaWxkKHRleHQpO1xuXHRcdH1cblxuXG5cdC8vIE11c2ljXG5cdGlmKCEhQ29tbW9uLmJnTXVzaWMpIENvbW1vbi5iZ011c2ljLmZhZGVPdXQoMCwgNTAwKTtcblx0Q29tbW9uLmJnTXVzaWMgPSBTb3VuZFNGWC5wbGF5KCdteF9mcm96ZW5fMDNfbWFpbl9tZW51X2VkaXQnLCB7bG9vcDp0cnVlLCB2b2x1bWU6MH0pO1xuXHRDb21tb24uYmdNdXNpYy5mYWRlSW4oQ29tbW9uLmJnTXVzaWNWb2x1bWUsIDUwMCk7XG5cblx0Ly8gRXZlbnQgVHJhY2tpbmdcblx0Q29tbW9uLmN0b3cudHJhY2tFdmVudChcblx0e1xuXHRcdGV2ZW50ICAgICAgOiBcImdhbWVfZW50ZXJcIixcblx0XHRnYW1lX3RpZXIxIDogXCJlbnRlclwiLFxuXHRcdGdhbWVfdGllcjIgOiBcIm1haW5tZW51XCJcblx0fSk7XG5cblx0Ly8gU2hvdyBlbmRsZXNzIG1vZGUgdW5sb2NrZWRcblx0aWYoQ29tbW9uLnNhdmVkRGF0YS5lbmRHYW1lTWVzc2FnZS5lbmRsZXNzLnNob3cgJiYgIUNvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UuZW5kbGVzcy5zaG93bilcblx0e1xuXHRcdENvbW1vbi5hbmltYXRvci5zZXRUaW1lb3V0KGZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHR0aGlzLnNpZ25hbHMuR1VJQnV0dG9uQ2xpY2tlZC5kaXNwYXRjaChcImVuZGxlc3NfdW5sb2NrZWRcIik7XG5cdFx0fSwgMS4yLCB0aGlzKTtcblxuXHRcdENvbW1vbi5zYXZlZERhdGEuZW5kR2FtZU1lc3NhZ2UuZW5kbGVzcy5zaG93biA9IHRydWU7XG5cdFx0Q29tbW9uLnNhdmVkRGF0YS5zYXZlKCk7XG5cdH1cblxuXHQvLyBQYXJhbGxheCBsYXllcnNcblx0dGhpcy5wYXJhbGxheExheWVycy5wdXNoKHtsYXllcjp0aGlzLl9iYWNrZ3JvdW5kLl9yb2NrXzAwLCAgICAgcGFyYWxsYXg6e3g6LTAuMiwgICB5OjAsIHNjYWxlOjF9fSk7XG5cdHRoaXMucGFyYWxsYXhMYXllcnMucHVzaCh7bGF5ZXI6dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMCwgICAgIHBhcmFsbGF4Ont4Oi0wLjE1LCAgeTowLCBzY2FsZToxfX0pO1xuXHR0aGlzLnBhcmFsbGF4TGF5ZXJzLnB1c2goe2xheWVyOnRoaXMuX2JhY2tncm91bmQuX3RyZWVfMDEsICAgICBwYXJhbGxheDp7eDotMC4xMjUsIHk6MCwgc2NhbGU6MX19KTtcblx0dGhpcy5wYXJhbGxheExheWVycy5wdXNoKHtsYXllcjp0aGlzLl9iYWNrZ3JvdW5kLl90cmVlXzAyLCAgICAgcGFyYWxsYXg6e3g6LTAuMTUsICB5OjAsIHNjYWxlOjF9fSk7XG5cdHRoaXMucGFyYWxsYXhMYXllcnMucHVzaCh7bGF5ZXI6dGhpcy5fYmFja2dyb3VuZC5fdHJlZV8wMywgICAgIHBhcmFsbGF4Ont4Oi0wLjEyNSwgeTowLCBzY2FsZToxfX0pO1xuXHR0aGlzLnBhcmFsbGF4TGF5ZXJzLnB1c2goe2xheWVyOnRoaXMuX2JhY2tncm91bmQuX2NhcnJpYWdlXzAwLCBwYXJhbGxheDp7eDotMC4xMywgIHk6MCwgc2NhbGU6MX19KTtcblx0dGhpcy5wYXJhbGxheExheWVycy5wdXNoKHtsYXllcjp0aGlzLl9iYWNrZ3JvdW5kLl9iZywgICAgICAgICAgcGFyYWxsYXg6e3g6LTAuMSwgICB5OjAsIHNjYWxlOjF9fSk7XG5cdHRoaXMucGFyYWxsYXhMYXllcnMucHVzaCh7bGF5ZXI6dGhpcy5fY2hhcmFjdGVycy5fa3Jpc3RvZmYsICAgIHBhcmFsbGF4Ont4OjAuMTUsICAgeTowLCBzY2FsZToxfX0pO1xuXHR0aGlzLnBhcmFsbGF4TGF5ZXJzLnB1c2goe2xheWVyOnRoaXMuX2NoYXJhY3RlcnMuX2FubmEsICAgICAgICBwYXJhbGxheDp7eDowLjE1LCAgIHk6MCwgc2NhbGU6MX19KTtcblx0dGhpcy5wYXJhbGxheExheWVycy5wdXNoKHtsYXllcjp0aGlzLl9jaGFyYWN0ZXJzLl9vbGFmLCAgICAgICAgcGFyYWxsYXg6e3g6MC4wNSwgICB5OjAsIHNjYWxlOjF9fSk7XG5cdHRoaXMucGFyYWxsYXhMYXllcnMucHVzaCh7bGF5ZXI6dGhpcy5fY2hhcmFjdGVycy5fcGFiYmllLCAgICAgIHBhcmFsbGF4Ont4OjAuMDUsICAgeTowLCBzY2FsZToxfX0pO1xuXHR0aGlzLnBhcmFsbGF4TGF5ZXJzLnB1c2goe2xheWVyOnRoaXMuX2ZvcmVncm91bmRQU0NvbnRhaW5lciwgICBwYXJhbGxheDp7eDowLjI1LCAgIHk6MCwgc2NhbGU6MX19KTtcblx0dGhpcy5wYXJhbGxheExheWVycy5wdXNoKHtsYXllcjp0aGlzLl9jZW50cmFsQXJlYSwgICAgICAgICAgICAgcGFyYWxsYXg6e3g6MC40MCwgICB5OjAsIHNjYWxlOjF9fSk7XG5cdHRoaXMucGFyYWxsYXhMYXllcnMucHVzaCh7bGF5ZXI6dGhpcy5fb3ZlcmxheSwgICAgICAgICAgICAgICAgIHBhcmFsbGF4Ont4OjAuNSwgICAgeTowLCBzY2FsZTo0fX0pO1xuXG5cdC8vIEFuaW1hdGlvblxuXHR0aGlzLl9sZWZ0QXJlYS5zY2FsZS5zZXQoMSk7XG5cdC8vIHRoaXMuX2xlZnRBcmVhLnggKz0gMzAwO1xuXG5cdHRoaXMuX3JpZ2h0QXJlYS5zY2FsZS5zZXQoMSk7XG5cdC8vIHRoaXMuX3JpZ2h0QXJlYS54IC09IDMwMDtcblxuXHRpZih0aGlzLnNob3dJbnRybylcblx0e1xuXHRcdHRoaXMuc2V0Wm9vbSgwLjYpO1xuXHRcdHRoaXMuY2hhbmdlWm9vbSgxL3RoaXMuX2NlbnRyYWxBcmVhLnNjYWxlLngsIDIsIDEpXG5cblx0XHQvLyB2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0XHQvLyB0bC50byh0aGlzLl9sZWZ0QXJlYSwgIDIsIHt4OiB0aGlzLl9sZWZ0QXJlYS54ICAtIDEwMCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDEpO1xuXHRcdC8vIHRsLnRvKHRoaXMuX2xlZnRBcmVhLCAgMiwge3g6IHRoaXMuX2xlZnRBcmVhLnggIC0gMTAwLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMSk7XG5cdFx0Ly8gdGwudG8odGhpcy5fcmlnaHRBcmVhLnNjYWxlLCAyLCB7eDogdGhpcy5fcmlnaHRBcmVhLnggKyAxMDAsIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAxKTtcblx0XHQvLyB0bC50byh0aGlzLl9yaWdodEFyZWEsIDIsIHt4OiB0aGlzLl9yaWdodEFyZWEueCArIDEwMCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDEpO1xuXHRcdC8vIENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXHRcdC8vIHRoaXMuX2xlZnRBcmVhLnggLT0gMTAwO1xuXHRcdC8vIHRoaXMuX3JpZ2h0QXJlYS54ICs9IDEwMDtcblx0fVxuXHRlbHNlXG5cdHtcblx0XHR0aGlzLl9sZWZ0QXJlYS54IC09IDEwMDtcblx0XHR0aGlzLl9yaWdodEFyZWEueCArPSAxMDA7XG5cdH1cbn07XG5cbi8qKlxuICogVXBkYXRlXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLl9tYWluQ29udGFpbmVyLnggPSBDb21tb24uU1RBR0VfV0lEVEggICogdGhpcy5mb2N1c1BvaW50LnggLSB0aGlzLmZvY3VzUG9zaXRpb24ueCAqIHRoaXMuem9vbTtcblx0dGhpcy5fbWFpbkNvbnRhaW5lci55ID0gQ29tbW9uLlNUQUdFX0hFSUdIVCAqIHRoaXMuZm9jdXNQb2ludC55IC0gdGhpcy5mb2N1c1Bvc2l0aW9uLnkgKiB0aGlzLnpvb207XG5cdHRoaXMuX21haW5Db250YWluZXIuc2NhbGUuc2V0KHRoaXMuem9vbSwgdGhpcy56b29tKTtcblxuXHR0aGlzLmJhY2tncm91bmRQUy51cGRhdGUocDMuVGltZXN0ZXAuZGVsdGFUaW1lKTtcblx0dGhpcy5mb3JlZ3JvdW5kUFMudXBkYXRlKHAzLlRpbWVzdGVwLmRlbHRhVGltZSk7XG5cblx0aWYoISF0aGlzLmhhbmRsZVNGWCAmJiB0aGlzLmhhbmRsZVNGWENvdW50ZG93biA+IDApXG5cdHtcblx0XHR0aGlzLmhhbmRsZVNGWENvdW50ZG93biAtPSBwMy5UaW1lc3RlcC5kZWx0YVRpbWU7XG5cblx0XHRpZih0aGlzLmhhbmRsZVNGWENvdW50ZG93biA8PSAwKVxuXHRcdHtcblx0XHRcdHRoaXMuaGFuZGxlU0ZYLnN0b3AoKTtcblx0XHRcdHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duID0gMDtcblx0XHR9XG5cdH1cblxuXHQvLyBOb3J0aGVybiBsaWdodHNcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX25vcnRoZXJuTGlnaHRzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKVxuXHR7XG5cdFx0dGhpcy5fbm9ydGhlcm5MaWdodHMuY2hpbGRyZW5baV0udGlsZVBvc2l0aW9uLnggKz0gcDMuVGltZXN0ZXAuZGVsdGFUaW1lICogdGhpcy5fbm9ydGhlcm5MaWdodHMuY2hpbGRyZW5baV0ueFRpbGluZztcblx0fVxufTtcblxuLyoqXG4gKiBPbiByZXNpemUgY2FsbGJhY2tcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpXG57XG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUucmVzaXplLmNhbGwodGhpcyk7XG5cblx0dGhpcy5fbGVmdEJ1dHRvbi54ICA9IHRoaXMuX2dldEJvcmRlckJ1dHRvblBvc2l0aW9uTGVmdCgpO1xuXHR0aGlzLl9yaWdodEJ1dHRvbi54ID0gdGhpcy5fZ2V0Qm9yZGVyQnV0dG9uUG9zaXRpb25SaWdodCgpO1xuXHR0aGlzLl9tdXRlQnV0dG9uLnggID0gdGhpcy5fZ2V0Rmlyc3RCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG5cdHRoaXMuX2hlbHBCdXR0b24ueCAgPSB0aGlzLl9nZXRTZWNvbmRCdXR0b25Qb3NpdGlvblJpZ2h0KCk7XG5cdHRoaXMuX2NvZGVCdXR0b24ueCAgPSB0aGlzLl9nZXRGaXJzdEJ1dHRvblBvc2l0aW9uTGVmdCgpICsgODA7XG59O1xuXG4vKipcbiAqIERpc3Bvc2VcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKVxue1xufVxuXG4vKipcbiAqIEBwYXJhbSB7RnVuY3Rpb249fSBjYWxsYmFja1xuICogQHBhcmFtIHsqPX1zY29wZVxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVJbiA9IGZ1bmN0aW9uKGNhbGxiYWNrLCBzY29wZSlcbntcblx0U2ltcGxlU2NyZWVuLnByb3RvdHlwZS5hbmltYXRlSW4uY2FsbCh0aGlzKTtcblxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0dGwudG8odGhpcy5faGVscEJ1dHRvbi5zY2FsZSwgLjUsIHt4OjEsIHk6MSwgZWFzZTpCYWNrLmVhc2VPdXR9LCAxLjMpO1xuXHR0bC50byh0aGlzLl9tdXRlQnV0dG9uLnNjYWxlLCAuNSwge3g6MSwgeToxLCBlYXNlOkJhY2suZWFzZU91dH0sIDEuNCk7XG5cdHRsLnRvKHRoaXMuX2NvZGVCdXR0b24uc2NhbGUsIC41LCB7eDoxLCB5OjEsIGVhc2U6QmFjay5lYXNlT3V0fSwgMS41KTtcblxuXHRpZih0aGlzLnNob3dJbnRybylcblx0e1xuXHRcdHRsLnRvKHRoaXMuX2NlbnRyYWxBcmVhLCAxLCB7YWxwaGE6IDEsIGVhc2U6TGluZWFyLmVhc2VOb25lfSwgMSk7XG5cdFx0dGwudG8odGhpcy5fYmFja2dyb3VuZFBTQ29udGFpbmVyLCAxLCB7YWxwaGE6IDEsIGVhc2U6TGluZWFyLmVhc2VOb25lfSwgMC41KTtcblx0XHR0bC50byh0aGlzLl9mb3JlZ3JvdW5kUFNDb250YWluZXIsIDEsIHthbHBoYTogMSwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCAwLjUpO1xuXHRcdHRsLnRvKHRoaXMuX2xlZnRCdXR0b24sICAwLjUsIHthbHBoYTogMSwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCAxLjUpO1xuXHRcdHRsLnRvKHRoaXMuX3JpZ2h0QnV0dG9uLCAwLjUsIHthbHBoYTogMSwgZWFzZTpMaW5lYXIuZWFzZU5vbmV9LCAxLjUpO1xuXHR9XG5cblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7RnVuY3Rpb249fSBjYWxsYmFja1xuICogQHBhcmFtIHsqPX1zY29wZVxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLmFuaW1hdGVPdXQgPSBmdW5jdGlvbihjYWxsYmFjaywgc2NvcGUpXG57XG5cdFNpbXBsZVNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZU91dC5jYWxsKHRoaXMpO1xuXG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCh7b25Db21wbGV0ZVNjb3BlOnNjb3BlLCBvbkNvbXBsZXRlOmNhbGxiYWNrfSk7XG5cdHRsLnRvKHRoaXMuX2hlbHBCdXR0b24uc2NhbGUsIC4zNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdHRsLnRvKHRoaXMuX211dGVCdXR0b24uc2NhbGUsIC4zNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdHRsLnRvKHRoaXMuX2NvZGVCdXR0b24uc2NhbGUsIC4zNSwge3g6MCwgeTowLCBlYXNlOkJhY2suZWFzZUlufSwgMCk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBSSVZBVEUgTUVUSE9EU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uKGRpcmVjdGlvbilcbntcblx0aWYoVHdlZW5NYXguaXNUd2VlbmluZyh0aGlzKSkgcmV0dXJuO1xuXHRpZihUd2Vlbk1heC5pc1R3ZWVuaW5nKHRoaXMuZm9jdXNQb3NpdGlvbikpIHJldHVybjtcblxuXHRpZihNYXRoLnNpZ24oZGlyZWN0aW9uKSA9PSAxKVxuXHR7XG5cdFx0dGhpcy5fY3VycmVudFNjcmVlbi0tO1xuXG5cdFx0Ly8gRXZlbnQgVHJhY2tpbmdcblx0XHRDb21tb24uY3Rvdy50cmFja0V2ZW50KFxuXHRcdHtcblx0XHRcdGV2ZW50ICAgICAgOiBcImdhbWVfZW50ZXJcIixcblx0XHRcdGdhbWVfdGllcjEgOiBcImVudGVyXCIsXG5cdFx0XHRnYW1lX3RpZXIyIDogIHRoaXMuX2N1cnJlbnRTY3JlZW4gPT0gMCA/IFwiZ29hbHNcIiA6IFwibWFpbm1lbnVcIlxuXHRcdH0pO1xuXHR9XG5cdGVsc2Vcblx0e1xuXHRcdHRoaXMuX2N1cnJlbnRTY3JlZW4rKztcblxuXHRcdC8vIEV2ZW50IFRyYWNraW5nXG5cdFx0Q29tbW9uLmN0b3cudHJhY2tFdmVudChcblx0XHR7XG5cdFx0XHRldmVudCAgICAgIDogXCJnYW1lX2VudGVyXCIsXG5cdFx0XHRnYW1lX3RpZXIxIDogXCJlbnRlclwiLFxuXHRcdFx0Z2FtZV90aWVyMiA6ICB0aGlzLl9jdXJyZW50U2NyZWVuID09IDIgPyBcImNvbXNjcmVlblwiIDogXCJtYWlubWVudVwiXG5cdFx0fSk7XG5cdH1cblxuXG5cdHN3aXRjaCh0aGlzLl9jdXJyZW50U2NyZWVuKVxuXHR7XG5cdFx0Y2FzZSAwOlxuXHRcdFx0U291bmRTRlgucGxheShcInNmeF9nb2Fsc19zY3JlZW5fc3BvdGZ4XzAwXCIpO1xuXHRcdFx0dGhpcy5jaGFuZ2Vab29tKDEvdGhpcy5fbGVmdEFyZWEuc2NhbGUueCwgMSlcblx0XHRcdHRoaXMuY2hhbmdlRm9jdXNQb3NpdGlvbihuZXcgUElYSS5Qb2ludCh0aGlzLl9sZWZ0QXJlYS54LCB0aGlzLl9sZWZ0QXJlYS55KSwgMSk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgMTpcblx0XHRcdFNvdW5kU0ZYLnBsYXkoXCJzZnhfbWFpbl9zY3JlZW5fc3BvdGZ4XzAxXCIpO1xuXHRcdFx0dGhpcy5jaGFuZ2Vab29tKDEvdGhpcy5fY2VudHJhbEFyZWEuc2NhbGUueCwgMSlcblx0XHRcdHRoaXMuY2hhbmdlRm9jdXNQb3NpdGlvbihuZXcgUElYSS5Qb2ludChDb21tb24uU1RBR0VfV0lEVEggLyAyLCBDb21tb24uU1RBR0VfSEVJR0hUIC8gMiksIDEpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIDI6XG5cdFx0XHRTb3VuZFNGWC5wbGF5KFwic2Z4X3Byb21vX3NjcmVlbl9zcG90ZnhfMDBcIik7XG5cdFx0XHR0aGlzLmNoYW5nZVpvb20oMS90aGlzLl9yaWdodEFyZWEuc2NhbGUueCwgMSlcblx0XHRcdHRoaXMuY2hhbmdlRm9jdXNQb3NpdGlvbihuZXcgUElYSS5Qb2ludCh0aGlzLl9yaWdodEFyZWEueCwgdGhpcy5fcmlnaHRBcmVhLnkpLCAxKTtcblx0XHRcdGJyZWFrO1xuXHR9XG59XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLnNldExlZnRSaWdodEJ1dHRvbnMgPSBmdW5jdGlvbigpXG57XG5cdHZhciB0bCA9IG5ldyBUaW1lbGluZU1heCgpO1xuXG5cdGlmKHRoaXMuX2N1cnJlbnRTY3JlZW4gPD0gMClcblx0XHR0bC50byh0aGlzLl9sZWZ0QnV0dG9uLCAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZU91dH0sIDApO1xuXHRlbHNlXG5cdFx0dGwudG8odGhpcy5fbGVmdEJ1dHRvbiwgIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcblxuXHRpZih0aGlzLl9jdXJyZW50U2NyZWVuID49IDIpXG5cdFx0dGwudG8odGhpcy5fcmlnaHRCdXR0b24sIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VPdXR9LCAwKTtcblx0ZWxzZVxuXHRcdHRsLnRvKHRoaXMuX3JpZ2h0QnV0dG9uLCAuNSwge2FscGhhOjEsIGVhc2U6U2luZS5lYXNlT3V0fSwgMCk7XG5cblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0bCk7XG5cblx0dGhpcy5fbGVmdEJ1dHRvbi5pbnRlcmFjdGl2ZSAgPSB0aGlzLl9jdXJyZW50U2NyZWVuID4gMDtcblx0dGhpcy5fcmlnaHRCdXR0b24uaW50ZXJhY3RpdmUgPSB0aGlzLl9jdXJyZW50U2NyZWVuIDwgMjtcbn1cblxuLyoqXG4gKiBTZXQgem9vbVxuICogQHBhcmFtIHtOdW1iZXJ9IHpvb20gKDE6IDEwMCUpXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUuc2V0Wm9vbSA9IGZ1bmN0aW9uKHpvb20pXG57XG5cdHRoaXMuem9vbSA9IHpvb207XG59XG5cbi8qKlxuICogQ2hhbmdlIHpvb20gb3ZlciB0aW1lXG4gKiBAcGFyYW0ge051bWJlcn0gem9vbSAoMTogMTAwJSlcbiAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lXG4gKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5jaGFuZ2Vab29tID0gZnVuY3Rpb24oem9vbSwgdGltZSwgZGVsYXkpXG57XG5cdGlmKHRoaXMuem9vbVR3ZWVuICE9IG51bGwpXG5cdFx0dGhpcy56b29tVHdlZW4ua2lsbCgpO1xuXG5cdGlmKHpvb20gPT0gdGhpcy56b29tKSByZXR1cm47XG5cblx0dGhpcy56b29tVHdlZW4gPSBuZXcgVGltZWxpbmVNYXgoKTtcblx0dGhpcy56b29tVHdlZW4udG8odGhpcywgdGltZSwge3pvb206IHpvb20sIGVhc2U6U2luZS5lYXNlSW5PdXR9LCAhIWRlbGF5ID8gZGVsYXkgOiAwKTtcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLnpvb21Ud2Vlbik7XG5cblx0dGhpcy56b29tVGFyZ2V0ID0gem9vbTtcbn1cblxuLyoqXG4gKiBDaGFuZ2UgdGhlIGZvY3VzIHBvaW50IG92ZXIgdGltZVxuICogQHBhcmFtIHtQSVhJLlBvaW50fSBmb2N1c1BvaW50XG4gKiBAcGFyYW0ge051bWJlcn0gdGltZVxuICogQHBhcmFtIHtOdW1iZXJ9IGRlbGF5XG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUuY2hhbmdlRm9jdXNQb2ludCA9IGZ1bmN0aW9uKGZvY3VzUG9pbnQsIHRpbWUsIGRlbGF5KVxue1xuXHRpZih0aGlzLmZvY3VzUG9pbnRUd2VlbiAhPSBudWxsKVxuXHRcdHRoaXMuZm9jdXNQb2ludFR3ZWVuLmtpbGwoKTtcblxuXHRpZih0aGlzLmZvY3VzUG9pbnQuZXF1YWwoZm9jdXNQb2ludCkpIHJldHVybjtcblxuXHR0aGlzLmZvY3VzUG9pbnRUd2VlbiA9IG5ldyBUaW1lbGluZU1heCgpO1xuXHR0aGlzLmZvY3VzUG9pbnRUd2Vlbi50byh0aGlzLmZvY3VzUG9pbnQsIHRpbWUsIHt4OiBmb2N1c1BvaW50LngsIHk6Zm9jdXNQb2ludC55LCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgISFkZWxheSA/IGRlbGF5IDogMCk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGhpcy5mb2N1c1BvaW50VHdlZW4pO1xufVxuXG4vKipcbiAqIENoYW5nZSB0aGUgZm9jdXMgcG9zaXRpb24gb3ZlciB0aW1lXG4gKiBAcGFyYW0ge1BJWEkuUG9pbnR9IGZvY3VzUG9pbnRcbiAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lXG4gKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5jaGFuZ2VGb2N1c1Bvc2l0aW9uID0gZnVuY3Rpb24oZm9jdXNQb3NpdGlvbiwgdGltZSwgZGVsYXkpXG57XG5cdGlmKHRoaXMuZm9jdXNQb2ludFR3ZWVuICE9IG51bGwpXG5cdFx0dGhpcy5mb2N1c1BvaW50VHdlZW4ua2lsbCgpO1xuXG5cdGlmKHRoaXMuZm9jdXNQb3NpdGlvbi5lcXVhbChmb2N1c1Bvc2l0aW9uKSkgcmV0dXJuO1xuXG5cdHRoaXMuZm9jdXNQb2ludFR3ZWVuID0gbmV3IFRpbWVsaW5lTWF4KCk7XG5cdHRoaXMuZm9jdXNQb2ludFR3ZWVuLnRvKHRoaXMuZm9jdXNQb3NpdGlvbiwgdGltZSwge3g6IGZvY3VzUG9zaXRpb24ueCwgeTpmb2N1c1Bvc2l0aW9uLnksIGVhc2U6U2luZS5lYXNlSW5PdXQsIG9uVXBkYXRlU2NvcGU6dGhpcywgb25VcGRhdGU6ZnVuY3Rpb24oKVxuXHRcdHtcblx0XHRcdHZhciBkZWx0YVBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQodGhpcy5mb2N1c1Bvc2l0aW9uLnggLSB0aGlzLm9sZEZvY3VzUG9zaXRpb24ueCwgdGhpcy5mb2N1c1Bvc2l0aW9uLnkgLSB0aGlzLm9sZEZvY3VzUG9zaXRpb24ueSk7XG5cblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnBhcmFsbGF4TGF5ZXJzLmxlbmd0aDsgaSsrKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGlzLnBhcmFsbGF4TGF5ZXJzW2ldLmxheWVyLnggLT0gZGVsdGFQb3NpdGlvbi54ICogdGhpcy5wYXJhbGxheExheWVyc1tpXS5wYXJhbGxheC54O1xuXHRcdFx0XHR0aGlzLnBhcmFsbGF4TGF5ZXJzW2ldLmxheWVyLnkgLT0gZGVsdGFQb3NpdGlvbi55ICogdGhpcy5wYXJhbGxheExheWVyc1tpXS5wYXJhbGxheC55O1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLm9sZEZvY3VzUG9zaXRpb24uc2V0KHRoaXMuZm9jdXNQb3NpdGlvbi54LCB0aGlzLmZvY3VzUG9zaXRpb24ueSk7XG5cdFx0fVxuXHR9LCAhIWRlbGF5ID8gZGVsYXkgOiAwKTtcblx0Q29tbW9uLmFuaW1hdG9yLmFkZCh0aGlzLmZvY3VzUG9pbnRUd2Vlbik7XG59XG5cblxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVZFTlRTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5vblN0b3J5Q2xpY2sgPSBmdW5jdGlvbigpXG57XG5cdENvbW1vbi5zYXZlZERhdGEuZW5kbGVzcyA9IGZhbHNlO1xuXG5cdGlmKENvbW1vbi5zYXZlZERhdGEubGV2ZWxzVW5sb2NrZWQgPT0gMSlcblx0e1xuXHRcdGlmKCFDb21tb24uc2F2ZWREYXRhLmhhc1NlZW5JbnRybylcblx0XHR7XG5cdFx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCgnaW50cm8nKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmRpc3BhdGNoKCd0dXRvcmlhbCcpO1xuXHRcdH1cblx0fVxuXHRlbHNlXG5cdHtcblx0XHR0aGlzLnNpZ25hbHMucmVxdWVzdGVkTmV4dFNjcmVlbi5kaXNwYXRjaCgnc3RvcnknKTtcblx0fVxuXG5cdENvbW1vbi5jdG93LnRyYWNrRXZlbnQoXG5cdHtcblx0XHRldmVudCAgICAgIDogXCJnYW1lX2VudGVyXCIsXG5cdFx0Z2FtZV90aWVyMSA6IFwiZW50ZXJcIixcblx0XHRnYW1lX3RpZXIyIDogXCJzdG9yeVwiXG5cdH0pO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xuXG5cdC8vIE11c2ljIGVuZFxuXHQvLyBDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDYwMCk7XG59XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLm9uRW5kbGVzc0NsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR2YXIgbGV2ZWxSZXF1aXJlZCA9IHRoaXMuX2Fzc2V0TWFuYWdlci5nZXRKU09OKFwiY29uZmlnXCIpLmVuZGxlc3MubGV2ZWxSZXF1aXJlZDtcblxuXHRpZighdGhpcy5pc0VuZGxlc3NVbmxvY2tlZClcblx0e1xuXHRcdHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkLmRpc3BhdGNoKFwiZW5kbGVzc1wiKTtcblx0fVxuXHRlbHNlXG5cdHtcblx0XHRDb21tb24uc2F2ZWREYXRhLmVuZGxlc3MgPSB0cnVlO1xuXHRcdHRoaXMuc2lnbmFscy5yZXF1ZXN0ZWROZXh0U2NyZWVuLmRpc3BhdGNoKCdlbmRsZXNzJyk7XG5cdH1cblxuXHRDb21tb24uY3Rvdy50cmFja0V2ZW50KFxuXHR7XG5cdFx0ZXZlbnQgICAgICA6IFwiZ2FtZV9lbnRlclwiLFxuXHRcdGdhbWVfdGllcjEgOiBcImVudGVyXCIsXG5cdFx0Z2FtZV90aWVyMiA6IFwiZW5kbGVzc1wiXG5cdH0pO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xuXG5cdC8vIE11c2ljIGVuZFxuXHQvLyBDb21tb24uYmdNdXNpYy5mYWRlT3V0KDAsIDYwMCk7XG59XG5cblxuLyoqXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUub25IZWxwUHJlc3NlZCA9IGZ1bmN0aW9uKGUpXG57XG5cdHRoaXMuc2lnbmFscy5HVUlCdXR0b25DbGlja2VkLmRpc3BhdGNoKFwiaGVscFwiKTtcblxuXHRDb21tb24uY3Rvdy50cmFja0V2ZW50KFxuXHR7XG5cdFx0ZXZlbnQgICAgICA6IFwiZ2FtZV9lbnRlclwiLFxuXHRcdGdhbWVfdGllcjEgOiBcImVudGVyXCIsXG5cdFx0Z2FtZV90aWVyMiA6IFwiaGVscFwiXG5cdH0pO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufVxuXG4vKipcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5vbkNvZGVQcmVzc2VkID0gZnVuY3Rpb24oZSlcbntcblx0dGhpcy5zaWduYWxzLkdVSUJ1dHRvbkNsaWNrZWQuZGlzcGF0Y2goXCJjb2RlXCIpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xufVxuXG4vKipcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5vbkxlZnRDbGljayA9IGZ1bmN0aW9uKClcbntcblx0dGhpcy5hbmltYXRlKDEpO1xuXHR0aGlzLnNldExlZnRSaWdodEJ1dHRvbnMoKTtcbn1cblxuLyoqXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUub25SaWdodENsaWNrID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmFuaW1hdGUoLTEpO1xuXHR0aGlzLnNldExlZnRSaWdodEJ1dHRvbnMoKTtcbn1cblxuLyoqXG4gKi9cblNwbGFzaFNjcmVlbi5wcm90b3R5cGUub25IYW5kbGVEb3duID0gZnVuY3Rpb24oZSlcbntcblx0dGhpcy5oYW5kbGVBY3RpdmUgPSB0cnVlO1xuXHR0aGlzLmhhbmRsZVkgPSBlLmRhdGEuZ2V0TG9jYWxQb3NpdGlvbih0aGlzKS55O1xuXHR0aGlzLmhhbmRsZVVwID0gZnVuY3Rpb24oKXt0aGlzLm9uSGFuZGxlVXAoKTt9LmJpbmQodGhpcylcblxuXHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5oYW5kbGVVcCk7XG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlVXApO1xufVxuXG4vKipcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5vbkhhbmRsZVVwID0gZnVuY3Rpb24oKVxue1xuXHR0aGlzLmhhbmRsZUFjdGl2ZSA9IGZhbHNlO1xuXHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsICB0aGlzLmhhbmRsZVVwKTtcblx0ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgdGhpcy5oYW5kbGVVcCk7XG59XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLm9uSGFuZGxlTW92ZSA9IGZ1bmN0aW9uKGUpXG57XG5cdGlmKCF0aGlzLmhhbmRsZUFjdGl2ZSkgcmV0dXJuO1xuXG5cdHZhciBuZXdZID0gZS5kYXRhLmdldExvY2FsUG9zaXRpb24odGhpcykueTtcblxuXHR2YXIgZGVsdGEgPSBuZXdZIC0gdGhpcy5oYW5kbGVZO1xuXG5cdGlmKHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1Njcm9sbGVyLl9oYW5kbGUueSArIGRlbHRhIDwgdGhpcy5oYW5kbGVNaW5ZKVxuXHRcdGRlbHRhID0gdGhpcy5oYW5kbGVNaW5ZIC0gdGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55XG5cdGVsc2UgaWYodGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55ICsgZGVsdGEgPiB0aGlzLmhhbmRsZU1heFkpXG5cdFx0ZGVsdGEgPSB0aGlzLmhhbmRsZU1heFkgLSB0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5faGFuZGxlLnlcblxuXHR0aGlzLl9sZWZ0QXJlYS5fZ29hbHNTY3JvbGxlci5fcm9wZS50aWxlUG9zaXRpb24ueSArPSBkZWx0YTtcblx0dGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55ICs9IGRlbHRhO1xuXG5cdHZhciBwZXJjICAgPSAodGhpcy5fbGVmdEFyZWEuX2dvYWxzU2Nyb2xsZXIuX2hhbmRsZS55IC0gdGhpcy5oYW5kbGVNaW5ZKS8oIHRoaXMuaGFuZGxlTWF4WSAtIHRoaXMuaGFuZGxlTWluWSk7XG5cdHZhciBuU3RlcHMgPSB0aGlzLl9sZWZ0QXJlYS5fZ29hbHMubGVuZ3RoIC0gNDtcblx0dmFyIHN0ZXAgICA9IChwZXJjIC8oMS8oblN0ZXBzLTEpKSk7XG5cblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuX2xlZnRBcmVhLl9nb2Fscy5sZW5ndGg7IGkrKylcblx0e1xuXHRcdHRoaXMuX2xlZnRBcmVhLl9nb2Fsc1tpXS55ID0gMTAwICogKGktc3RlcCk7XG5cdH1cblxuXHR0aGlzLmhhbmRsZVkgPSBuZXdZO1xuXG5cdGlmKHRoaXMuaGFuZGxlU0ZYQ291bnRkb3duID09IDApXG5cdHtcblx0XHR0aGlzLmhhbmRsZVNGWCA9IFNvdW5kU0ZYLnBsYXkoXCJzZnhfcHVsbGV5X2Rvd25fbG9vcF8wNFwiLCB7bG9vcDp0cnVlfSk7XG5cdH1cblx0dGhpcy5oYW5kbGVTRlhDb3VudGRvd24gPSAwLjI7XG59XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLm9uQ29tbVByZXYgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuX2NvbW1zW3RoaXMuX2N1cnJlbnRjb21tXS5pbWFnZS5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXHQvLyB0aGlzLl9jb21tc1t0aGlzLl9jdXJyZW50Y29tbV0ubGluay5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXG5cdG5leHRjb21tID0gdGhpcy5fY3VycmVudGNvbW0tMTtcblx0aWYobmV4dGNvbW0gPCAwKSBuZXh0Y29tbSA9IHRoaXMuX2NvbW1zLmxlbmd0aCAtMTtcblxuXHR2YXIgdGwgPSBuZXcgVGltZWxpbmVNYXgoXG5cdHtcblx0XHRvbkNvbXBsZXRlU2NvcGU6dGhpcyxcblx0XHRvbkNvbXBsZXRlOmZ1bmN0aW9uKClcblx0XHR7XG5cdFx0XHR0aGlzLl9jb21tc1tuZXh0Y29tbV0uaW1hZ2UuaW50ZXJhY3RpdmUgPSB0cnVlO1xuXHRcdFx0Ly8gdGhpcy5fY29tbXNbbmV4dGNvbW1dLmxpbmsuaW50ZXJhY3RpdmUgPSB0cnVlO1xuXHRcdH1cblx0fSk7XG5cdFx0dGwudG8odGhpcy5fY29tbXNbdGhpcy5fY3VycmVudGNvbW1dLCAgLjUsIHthbHBoYTowLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XG5cdFx0dGwudG8odGhpcy5fY29tbXNbbmV4dGNvbW1dLCAgICAgICAgICAgLjUsIHthbHBoYToxLCBlYXNlOlNpbmUuZWFzZUluT3V0fSwgMCk7XG5cdENvbW1vbi5hbmltYXRvci5hZGQodGwpO1xuXG5cdFNvdW5kU0ZYLnBsYXkoXCJzZnhfYnRuX3ByZXNzXzAwXCIpO1xuXG5cdHRoaXMuX2N1cnJlbnRjb21tID0gbmV4dGNvbW07XG59XG5cbi8qKlxuICovXG5TcGxhc2hTY3JlZW4ucHJvdG90eXBlLm9uQ29tbU5leHQgPSBmdW5jdGlvbigpXG57XG5cdHRoaXMuX2NvbW1zW3RoaXMuX2N1cnJlbnRjb21tXS5pbWFnZS5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXHQvLyB0aGlzLl9jb21tc1t0aGlzLl9jdXJyZW50Y29tbV0ubGluay5pbnRlcmFjdGl2ZSA9IGZhbHNlO1xuXG5cdG5leHRjb21tID0gdGhpcy5fY3VycmVudGNvbW0rMTtcblx0aWYobmV4dGNvbW0gPj0gdGhpcy5fY29tbXMubGVuZ3RoKSBuZXh0Y29tbSA9IDA7XG5cblx0dmFyIHRsID0gbmV3IFRpbWVsaW5lTWF4KFxuXHR7XG5cdFx0b25Db21wbGV0ZVNjb3BlOnRoaXMsXG5cdFx0b25Db21wbGV0ZTpmdW5jdGlvbigpXG5cdFx0e1xuXHRcdFx0dGhpcy5fY29tbXNbbmV4dGNvbW1dLmltYWdlLmludGVyYWN0aXZlID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMuX2NvbW1zW25leHRjb21tXS5saW5rLmludGVyYWN0aXZlID0gdHJ1ZTtcblx0XHR9XG5cdH0pO1xuXHRcdHRsLnRvKHRoaXMuX2NvbW1zW3RoaXMuX2N1cnJlbnRjb21tXSwgIC41LCB7YWxwaGE6MCwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xuXHRcdHRsLnRvKHRoaXMuX2NvbW1zW25leHRjb21tXSwgICAgICAgICAgIC41LCB7YWxwaGE6MSwgZWFzZTpTaW5lLmVhc2VJbk91dH0sIDApO1xuXHRDb21tb24uYW5pbWF0b3IuYWRkKHRsKTtcblxuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcblxuXHR0aGlzLl9jdXJyZW50Y29tbSA9IG5leHRjb21tO1xufVxuXG4vKipcbiAqL1xuU3BsYXNoU2NyZWVuLnByb3RvdHlwZS5vbkNvbW1DbGljayA9IGZ1bmN0aW9uKClcbntcblx0Ly8gRXZlbnQgVHJhY2tpbmdcblx0Q29tbW9uLmN0b3cudHJhY2tFdmVudChcblx0e1xuXHRcdGV2ZW50ICAgICAgOiBcImdhbWVfYWN0aW9uXCIsXG5cdFx0Z2FtZV90aWVyMSA6IFwiY29tX3NjcmVlblwiLFxuXHRcdGdhbWVfdGllcjIgOiBcInNsaWRlXCIgKyAodGhpcy5fY3VycmVudGNvbW0rMSlcblx0fSk7XG5cblx0Ly8gdGhpcy5fYmx1ciA9IG5ldyBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlcigpO1xuXHQvLyB0aGlzLl9ibHVyLmJsdXJYID0gMztcblx0Ly8gdGhpcy5fYmx1ci5ibHVyWSA9IDM7XG5cdC8vIHRoaXMuZmlsdGVycyA9IFt0aGlzLl9ibHVyXTtcblxuXHQvLyBPcGVuIGEgbmV3IHdpbmRvd1xuXHQvLyB2YXIgdXJsID0gdGhpcy5fY29tbXNEYXRhW3RoaXMuX2N1cnJlbnRjb21tXS51cmw7XG5cdC8vIHZhciB3aW4gPSB3aW5kb3cub3Blbih1cmwsICdfc3lzdGVtJyk7XG5cdC8vIHdpbi5mb2N1cygpO1xuXG5cdHRoaXMuc2lnbmFscy5saW5rQ2xpY2suZGlzcGF0Y2godGhpcy5fY29tbXNEYXRhW3RoaXMuX2N1cnJlbnRjb21tXS51cmwsICEhdGhpcy5fY29tbXNEYXRhW3RoaXMuX2N1cnJlbnRjb21tXS5kaXNuZXkpO1xuXHRTb3VuZFNGWC5wbGF5KFwic2Z4X2J0bl9wcmVzc18wMFwiKTtcbn0iXX0=
